var component = (function (exports, React) {
  'use strict';

  function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

  var React__default = /*#__PURE__*/_interopDefaultLegacy(React);

  function _defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties(Constructor, staticProps);
    return Constructor;
  }

  function _extends() {
    _extends = Object.assign || function (target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i];

        for (var key in source) {
          if (Object.prototype.hasOwnProperty.call(source, key)) {
            target[key] = source[key];
          }
        }
      }

      return target;
    };

    return _extends.apply(this, arguments);
  }

  function _inheritsLoose(subClass, superClass) {
    subClass.prototype = Object.create(superClass.prototype);
    subClass.prototype.constructor = subClass;
    subClass.__proto__ = superClass;
  }

  function _assertThisInitialized(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  var laya_core=function(exports){var Config=function Config(){};Config.animationInterval=50;Config.isAntialias=false;Config.isAlpha=false;Config.premultipliedAlpha=true;Config.isStencil=true;Config.preserveDrawingBuffer=false;Config.webGL2D_MeshAllocMaxMem=true;Config.is2DPixelArtGame=false;Config.useWebGL2=true;Config.allowGPUInstanceDynamicBatch=true;Config.useRetinalCanvas=false;window.Config=Config;var ILaya=/*#__PURE__*/function(){function ILaya(){}ILaya.regClass=function regClass(c){ILaya.__classMap[c.name]=c;};return ILaya;}();ILaya.Laya=null;ILaya.Timer=null;ILaya.WorkerLoader=null;ILaya.Dragging=null;ILaya.GraphicsBounds=null;ILaya.Sprite=null;ILaya.TextRender=null;ILaya.TextAtlas=null;ILaya.timer=null;ILaya.systemTimer=null;ILaya.startTimer=null;ILaya.updateTimer=null;ILaya.lateTimer=null;ILaya.physicsTimer=null;ILaya.stage=null;ILaya.Loader=null;ILaya.loader=null;ILaya.TTFLoader=null;ILaya.SoundManager=null;ILaya.WebAudioSound=null;ILaya.AudioSound=null;ILaya.ShaderCompile=null;ILaya.ClassUtils=null;ILaya.SceneUtils=null;ILaya.Context=null;ILaya.Render=null;ILaya.MouseManager=null;ILaya.Text=null;ILaya.Browser=null;ILaya.WebGL=null;ILaya.Pool=null;ILaya.Utils=null;ILaya.Graphics=null;ILaya.Submit=null;ILaya.Stage=null;ILaya.Resource=null;ILaya.__classMap={};var Pool=/*#__PURE__*/function(){function Pool(){}Pool.getPoolBySign=function getPoolBySign(sign){return Pool._poolDic[sign]||(Pool._poolDic[sign]=[]);};Pool.clearBySign=function clearBySign(sign){if(Pool._poolDic[sign])Pool._poolDic[sign].length=0;};Pool.recover=function recover(sign,item){if(item[Pool.POOLSIGN])return;item[Pool.POOLSIGN]=true;Pool.getPoolBySign(sign).push(item);};Pool.recoverByClass=function recoverByClass(instance){if(instance){var className=instance["__className"]||instance.constructor._$gid;if(className)Pool.recover(className,instance);}};Pool._getClassSign=function _getClassSign(cla){var className=cla["__className"]||cla["_$gid"];if(!className){cla["_$gid"]=className=Pool._CLSID+"";Pool._CLSID++;}return className;};Pool.createByClass=function createByClass(cls){return Pool.getItemByClass(Pool._getClassSign(cls),cls);};Pool.getItemByClass=function getItemByClass(sign,cls){if(!Pool._poolDic[sign])return new cls();var pool=Pool.getPoolBySign(sign);if(pool.length){var rst=pool.pop();rst[Pool.POOLSIGN]=false;}else {rst=new cls();}return rst;};Pool.getItemByCreateFun=function getItemByCreateFun(sign,createFun,caller){if(caller===void 0){caller=null;}var pool=Pool.getPoolBySign(sign);var rst=pool.length?pool.pop():createFun.call(caller);rst[Pool.POOLSIGN]=false;return rst;};Pool.getItem=function getItem(sign){var pool=Pool.getPoolBySign(sign);var rst=pool.length?pool.pop():null;if(rst){rst[Pool.POOLSIGN]=false;}return rst;};return Pool;}();Pool._CLSID=0;Pool.POOLSIGN="__InPool";Pool._poolDic={};var AlphaCmd=/*#__PURE__*/function(){function AlphaCmd(){}AlphaCmd.create=function create(alpha){var cmd=Pool.getItemByClass("AlphaCmd",AlphaCmd);cmd.alpha=alpha;return cmd;};var _proto=AlphaCmd.prototype;_proto.recover=function recover(){Pool.recover("AlphaCmd",this);};_proto.run=function run(context,gx,gy){context.alpha(this.alpha);};_createClass(AlphaCmd,[{key:"cmdID",get:function get(){return AlphaCmd.ID;}}]);return AlphaCmd;}();AlphaCmd.ID="Alpha";var DrawCircleCmd=/*#__PURE__*/function(){function DrawCircleCmd(){}DrawCircleCmd.create=function create(x,y,radius,fillColor,lineColor,lineWidth,vid){var cmd=Pool.getItemByClass("DrawCircleCmd",DrawCircleCmd);cmd.x=x;cmd.y=y;cmd.radius=radius;cmd.fillColor=fillColor;cmd.lineColor=lineColor;cmd.lineWidth=lineWidth;cmd.vid=vid;return cmd;};var _proto2=DrawCircleCmd.prototype;_proto2.recover=function recover(){this.fillColor=null;this.lineColor=null;Pool.recover("DrawCircleCmd",this);};_proto2.run=function run(context,gx,gy){context._drawCircle(this.x+gx,this.y+gy,this.radius,this.fillColor,this.lineColor,this.lineWidth,this.vid);};_createClass(DrawCircleCmd,[{key:"cmdID",get:function get(){return DrawCircleCmd.ID;}}]);return DrawCircleCmd;}();DrawCircleCmd.ID="DrawCircle";var DrawCurvesCmd=/*#__PURE__*/function(){function DrawCurvesCmd(){}DrawCurvesCmd.create=function create(x,y,points,lineColor,lineWidth){var cmd=Pool.getItemByClass("DrawCurvesCmd",DrawCurvesCmd);cmd.x=x;cmd.y=y;cmd.points=points;cmd.lineColor=lineColor;cmd.lineWidth=lineWidth;return cmd;};var _proto3=DrawCurvesCmd.prototype;_proto3.recover=function recover(){this.points=null;this.lineColor=null;Pool.recover("DrawCurvesCmd",this);};_proto3.run=function run(context,gx,gy){if(this.points)context.drawCurves(this.x+gx,this.y+gy,this.points,this.lineColor,this.lineWidth);};_createClass(DrawCurvesCmd,[{key:"cmdID",get:function get(){return DrawCurvesCmd.ID;}}]);return DrawCurvesCmd;}();DrawCurvesCmd.ID="DrawCurves";var DrawImageCmd=/*#__PURE__*/function(){function DrawImageCmd(){}DrawImageCmd.create=function create(texture,x,y,width,height){var cmd=Pool.getItemByClass("DrawImageCmd",DrawImageCmd);cmd.texture=texture;texture._addReference();cmd.x=x;cmd.y=y;cmd.width=width;cmd.height=height;return cmd;};var _proto4=DrawImageCmd.prototype;_proto4.recover=function recover(){this.texture&&this.texture._removeReference();this.texture=null;Pool.recover("DrawImageCmd",this);};_proto4.run=function run(context,gx,gy){if(this.texture)context.drawTexture(this.texture,this.x+gx,this.y+gy,this.width,this.height);};_createClass(DrawImageCmd,[{key:"cmdID",get:function get(){return DrawImageCmd.ID;}}]);return DrawImageCmd;}();DrawImageCmd.ID="DrawImage";var DrawLineCmd=/*#__PURE__*/function(){function DrawLineCmd(){}DrawLineCmd.create=function create(fromX,fromY,toX,toY,lineColor,lineWidth,vid){var cmd=Pool.getItemByClass("DrawLineCmd",DrawLineCmd);cmd.fromX=fromX;cmd.fromY=fromY;cmd.toX=toX;cmd.toY=toY;cmd.lineColor=lineColor;cmd.lineWidth=lineWidth;cmd.vid=vid;return cmd;};var _proto5=DrawLineCmd.prototype;_proto5.recover=function recover(){Pool.recover("DrawLineCmd",this);};_proto5.run=function run(context,gx,gy){context._drawLine(gx,gy,this.fromX,this.fromY,this.toX,this.toY,this.lineColor,this.lineWidth,this.vid);};_createClass(DrawLineCmd,[{key:"cmdID",get:function get(){return DrawLineCmd.ID;}}]);return DrawLineCmd;}();DrawLineCmd.ID="DrawLine";var DrawLinesCmd=/*#__PURE__*/function(){function DrawLinesCmd(){}DrawLinesCmd.create=function create(x,y,points,lineColor,lineWidth,vid){var cmd=Pool.getItemByClass("DrawLinesCmd",DrawLinesCmd);cmd.x=x;cmd.y=y;cmd.points=points;cmd.lineColor=lineColor;cmd.lineWidth=lineWidth;cmd.vid=vid;return cmd;};var _proto6=DrawLinesCmd.prototype;_proto6.recover=function recover(){this.points=null;this.lineColor=null;Pool.recover("DrawLinesCmd",this);};_proto6.run=function run(context,gx,gy){this.points&&context._drawLines(this.x+gx,this.y+gy,this.points,this.lineColor,this.lineWidth,this.vid);};_createClass(DrawLinesCmd,[{key:"cmdID",get:function get(){return DrawLinesCmd.ID;}}]);return DrawLinesCmd;}();DrawLinesCmd.ID="DrawLines";var DrawPathCmd=/*#__PURE__*/function(){function DrawPathCmd(){}DrawPathCmd.create=function create(x,y,paths,brush,pen){var cmd=Pool.getItemByClass("DrawPathCmd",DrawPathCmd);cmd.x=x;cmd.y=y;cmd.paths=paths;cmd.brush=brush;cmd.pen=pen;return cmd;};var _proto7=DrawPathCmd.prototype;_proto7.recover=function recover(){this.paths=null;this.brush=null;this.pen=null;Pool.recover("DrawPathCmd",this);};_proto7.run=function run(context,gx,gy){this.paths&&context._drawPath(this.x+gx,this.y+gy,this.paths,this.brush,this.pen);};_createClass(DrawPathCmd,[{key:"cmdID",get:function get(){return DrawPathCmd.ID;}}]);return DrawPathCmd;}();DrawPathCmd.ID="DrawPath";var DrawPieCmd=/*#__PURE__*/function(){function DrawPieCmd(){}DrawPieCmd.create=function create(x,y,radius,startAngle,endAngle,fillColor,lineColor,lineWidth,vid){var cmd=Pool.getItemByClass("DrawPieCmd",DrawPieCmd);cmd.x=x;cmd.y=y;cmd.radius=radius;cmd._startAngle=startAngle;cmd._endAngle=endAngle;cmd.fillColor=fillColor;cmd.lineColor=lineColor;cmd.lineWidth=lineWidth;cmd.vid=vid;return cmd;};var _proto8=DrawPieCmd.prototype;_proto8.recover=function recover(){this.fillColor=null;this.lineColor=null;Pool.recover("DrawPieCmd",this);};_proto8.run=function run(context,gx,gy){context._drawPie(this.x+gx,this.y+gy,this.radius,this._startAngle,this._endAngle,this.fillColor,this.lineColor,this.lineWidth,this.vid);};_createClass(DrawPieCmd,[{key:"cmdID",get:function get(){return DrawPieCmd.ID;}},{key:"startAngle",get:function get(){return this._startAngle*180/Math.PI;},set:function set(value){this._startAngle=value*Math.PI/180;}},{key:"endAngle",get:function get(){return this._endAngle*180/Math.PI;},set:function set(value){this._endAngle=value*Math.PI/180;}}]);return DrawPieCmd;}();DrawPieCmd.ID="DrawPie";var DrawPolyCmd=/*#__PURE__*/function(){function DrawPolyCmd(){}DrawPolyCmd.create=function create(x,y,points,fillColor,lineColor,lineWidth,isConvexPolygon,vid){var cmd=Pool.getItemByClass("DrawPolyCmd",DrawPolyCmd);cmd.x=x;cmd.y=y;cmd.points=points;cmd.fillColor=fillColor;cmd.lineColor=lineColor;cmd.lineWidth=lineWidth;cmd.isConvexPolygon=isConvexPolygon;cmd.vid=vid;return cmd;};var _proto9=DrawPolyCmd.prototype;_proto9.recover=function recover(){this.points=null;this.fillColor=null;this.lineColor=null;Pool.recover("DrawPolyCmd",this);};_proto9.run=function run(context,gx,gy){this.points&&context._drawPoly(this.x+gx,this.y+gy,this.points,this.fillColor,this.lineColor,this.lineWidth,this.isConvexPolygon,this.vid);};_createClass(DrawPolyCmd,[{key:"cmdID",get:function get(){return DrawPolyCmd.ID;}}]);return DrawPolyCmd;}();DrawPolyCmd.ID="DrawPoly";var DrawRectCmd=/*#__PURE__*/function(){function DrawRectCmd(){}DrawRectCmd.create=function create(x,y,width,height,fillColor,lineColor,lineWidth){var cmd=Pool.getItemByClass("DrawRectCmd",DrawRectCmd);cmd.x=x;cmd.y=y;cmd.width=width;cmd.height=height;cmd.fillColor=fillColor;cmd.lineColor=lineColor;cmd.lineWidth=lineWidth;return cmd;};var _proto10=DrawRectCmd.prototype;_proto10.recover=function recover(){this.fillColor=null;this.lineColor=null;Pool.recover("DrawRectCmd",this);};_proto10.run=function run(context,gx,gy){context.drawRect(this.x+gx,this.y+gy,this.width,this.height,this.fillColor,this.lineColor,this.lineWidth);};_createClass(DrawRectCmd,[{key:"cmdID",get:function get(){return DrawRectCmd.ID;}}]);return DrawRectCmd;}();DrawRectCmd.ID="DrawRect";var Matrix=/*#__PURE__*/function(){function Matrix(a,b,c,d,tx,ty,nums){if(a===void 0){a=1;}if(b===void 0){b=0;}if(c===void 0){c=0;}if(d===void 0){d=1;}if(tx===void 0){tx=0;}if(ty===void 0){ty=0;}if(nums===void 0){nums=0;}this._bTransform=false;if(Matrix._createFun!=null){return Matrix._createFun(a,b,c,d,tx,ty,nums);}this.a=a;this.b=b;this.c=c;this.d=d;this.tx=tx;this.ty=ty;this._checkTransform();}var _proto11=Matrix.prototype;_proto11.identity=function identity(){this.a=this.d=1;this.b=this.tx=this.ty=this.c=0;this._bTransform=false;return this;};_proto11._checkTransform=function _checkTransform(){return this._bTransform=this.a!==1||this.b!==0||this.c!==0||this.d!==1;};_proto11.setTranslate=function setTranslate(x,y){this.tx=x;this.ty=y;return this;};_proto11.translate=function translate(x,y){this.tx+=x;this.ty+=y;return this;};_proto11.scale=function scale(x,y){this.a*=x;this.d*=y;this.c*=x;this.b*=y;this.tx*=x;this.ty*=y;this._bTransform=true;return this;};_proto11.rotate=function rotate(angle){var cos=Math.cos(angle);var sin=Math.sin(angle);var a1=this.a;var c1=this.c;var tx1=this.tx;this.a=a1*cos-this.b*sin;this.b=a1*sin+this.b*cos;this.c=c1*cos-this.d*sin;this.d=c1*sin+this.d*cos;this.tx=tx1*cos-this.ty*sin;this.ty=tx1*sin+this.ty*cos;this._bTransform=true;return this;};_proto11.skew=function skew(x,y){var tanX=Math.tan(x);var tanY=Math.tan(y);var a1=this.a;var b1=this.b;this.a+=tanY*this.c;this.b+=tanY*this.d;this.c+=tanX*a1;this.d+=tanX*b1;return this;};_proto11.invertTransformPoint=function invertTransformPoint(out){var a1=this.a;var b1=this.b;var c1=this.c;var d1=this.d;var tx1=this.tx;var n=a1*d1-b1*c1;var a2=d1/n;var b2=-b1/n;var c2=-c1/n;var d2=a1/n;var tx2=(c1*this.ty-d1*tx1)/n;var ty2=-(a1*this.ty-b1*tx1)/n;return out.setTo(a2*out.x+c2*out.y+tx2,b2*out.x+d2*out.y+ty2);};_proto11.transformPoint=function transformPoint(out){return out.setTo(this.a*out.x+this.c*out.y+this.tx,this.b*out.x+this.d*out.y+this.ty);};_proto11.transformPointN=function transformPointN(out){return out.setTo(this.a*out.x+this.c*out.y,this.b*out.x+this.d*out.y);};_proto11.getScaleX=function getScaleX(){return this.b===0?this.a:Math.sqrt(this.a*this.a+this.b*this.b);};_proto11.getScaleY=function getScaleY(){return this.c===0?this.d:Math.sqrt(this.c*this.c+this.d*this.d);};_proto11.invert=function invert(){var a1=this.a;var b1=this.b;var c1=this.c;var d1=this.d;var tx1=this.tx;var n=a1*d1-b1*c1;this.a=d1/n;this.b=-b1/n;this.c=-c1/n;this.d=a1/n;this.tx=(c1*this.ty-d1*tx1)/n;this.ty=-(a1*this.ty-b1*tx1)/n;return this;};_proto11.setTo=function setTo(a,b,c,d,tx,ty){this.a=a,this.b=b,this.c=c,this.d=d,this.tx=tx,this.ty=ty;return this;};_proto11.concat=function concat(matrix){var a=this.a;var c=this.c;var tx=this.tx;this.a=a*matrix.a+this.b*matrix.c;this.b=a*matrix.b+this.b*matrix.d;this.c=c*matrix.a+this.d*matrix.c;this.d=c*matrix.b+this.d*matrix.d;this.tx=tx*matrix.a+this.ty*matrix.c+matrix.tx;this.ty=tx*matrix.b+this.ty*matrix.d+matrix.ty;return this;};Matrix.mul=function mul(m1,m2,out){var aa=m1.a,ab=m1.b,ac=m1.c,ad=m1.d,atx=m1.tx,aty=m1.ty;var ba=m2.a,bb=m2.b,bc=m2.c,bd=m2.d,btx=m2.tx,bty=m2.ty;if(bb!==0||bc!==0){out.a=aa*ba+ab*bc;out.b=aa*bb+ab*bd;out.c=ac*ba+ad*bc;out.d=ac*bb+ad*bd;out.tx=ba*atx+bc*aty+btx;out.ty=bb*atx+bd*aty+bty;}else {out.a=aa*ba;out.b=ab*bd;out.c=ac*ba;out.d=ad*bd;out.tx=ba*atx+btx;out.ty=bd*aty+bty;}return out;};Matrix.mul16=function mul16(m1,m2,out){var aa=m1.a,ab=m1.b,ac=m1.c,ad=m1.d,atx=m1.tx,aty=m1.ty;var ba=m2.a,bb=m2.b,bc=m2.c,bd=m2.d,btx=m2.tx,bty=m2.ty;if(bb!==0||bc!==0){out[0]=aa*ba+ab*bc;out[1]=aa*bb+ab*bd;out[4]=ac*ba+ad*bc;out[5]=ac*bb+ad*bd;out[12]=ba*atx+bc*aty+btx;out[13]=bb*atx+bd*aty+bty;}else {out[0]=aa*ba;out[1]=ab*bd;out[4]=ac*ba;out[5]=ad*bd;out[12]=ba*atx+btx;out[13]=bd*aty+bty;}return out;};_proto11.scaleEx=function scaleEx(x,y){var ba=this.a,bb=this.b,bc=this.c,bd=this.d;if(bb!==0||bc!==0){this.a=x*ba;this.b=x*bb;this.c=y*bc;this.d=y*bd;}else {this.a=x*ba;this.b=0*bd;this.c=0*ba;this.d=y*bd;}this._bTransform=true;};_proto11.rotateEx=function rotateEx(angle){var cos=Math.cos(angle);var sin=Math.sin(angle);var ba=this.a,bb=this.b,bc=this.c,bd=this.d;if(bb!==0||bc!==0){this.a=cos*ba+sin*bc;this.b=cos*bb+sin*bd;this.c=-sin*ba+cos*bc;this.d=-sin*bb+cos*bd;}else {this.a=cos*ba;this.b=sin*bd;this.c=-sin*ba;this.d=cos*bd;}this._bTransform=true;};_proto11.clone=function clone(){var dec=Matrix.create();dec.a=this.a;dec.b=this.b;dec.c=this.c;dec.d=this.d;dec.tx=this.tx;dec.ty=this.ty;dec._bTransform=this._bTransform;return dec;};_proto11.copyTo=function copyTo(dec){dec.a=this.a;dec.b=this.b;dec.c=this.c;dec.d=this.d;dec.tx=this.tx;dec.ty=this.ty;dec._bTransform=this._bTransform;return dec;};_proto11.toString=function toString(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty;};_proto11.destroy=function destroy(){this.recover();};_proto11.recover=function recover(){Pool.recover("Matrix",this.identity());};Matrix.create=function create(){return Pool.getItemByClass("Matrix",Matrix);};return Matrix;}();Matrix.EMPTY=new Matrix();Matrix.TEMP=new Matrix();Matrix._createFun=null;var Point=/*#__PURE__*/function(){function Point(x,y){if(x===void 0){x=0;}if(y===void 0){y=0;}this.x=x;this.y=y;}Point.create=function create(){return Pool.getItemByClass("Point",Point);};var _proto12=Point.prototype;_proto12.setTo=function setTo(x,y){this.x=x;this.y=y;return this;};_proto12.reset=function reset(){this.x=this.y=0;return this;};_proto12.recover=function recover(){Pool.recover("Point",this.reset());};_proto12.distance=function distance(x,y){return Math.sqrt((this.x-x)*(this.x-x)+(this.y-y)*(this.y-y));};_proto12.toString=function toString(){return this.x+","+this.y;};_proto12.normalize=function normalize(){var d=Math.sqrt(this.x*this.x+this.y*this.y);if(d>0){var id=1.0/d;this.x*=id;this.y*=id;}};_proto12.copy=function copy(point){return this.setTo(point.x,point.y);};return Point;}();Point.TEMP=new Point();Point.EMPTY=new Point();var Rectangle=/*#__PURE__*/function(){function Rectangle(x,y,width,height){if(x===void 0){x=0;}if(y===void 0){y=0;}if(width===void 0){width=0;}if(height===void 0){height=0;}this.x=x;this.y=y;this.width=width;this.height=height;}var _proto13=Rectangle.prototype;_proto13.setTo=function setTo(x,y,width,height){this.x=x;this.y=y;this.width=width;this.height=height;return this;};_proto13.reset=function reset(){this.x=this.y=this.width=this.height=0;return this;};_proto13.recover=function recover(){if(this==Rectangle.TEMP||this==Rectangle.EMPTY){console.log("recover Temp or Empty:",this);return;}Pool.recover("Rectangle",this.reset());};Rectangle.create=function create(){return Pool.getItemByClass("Rectangle",Rectangle);};_proto13.copyFrom=function copyFrom(source){this.x=source.x;this.y=source.y;this.width=source.width;this.height=source.height;return this;};_proto13.contains=function contains(x,y){if(this.width<=0||this.height<=0)return false;if(x>=this.x&&x<this.right){if(y>=this.y&&y<this.bottom){return true;}}return false;};_proto13.intersects=function intersects(rect){return !(rect.x>this.x+this.width||rect.x+rect.width<this.x||rect.y>this.y+this.height||rect.y+rect.height<this.y);};_proto13.intersection=function intersection(rect,out){if(out===void 0){out=null;}if(!this.intersects(rect))return null;out||(out=new Rectangle());out.x=Math.max(this.x,rect.x);out.y=Math.max(this.y,rect.y);out.width=Math.min(this.right,rect.right)-out.x;out.height=Math.min(this.bottom,rect.bottom)-out.y;return out;};_proto13.union=function union(source,out){if(out===void 0){out=null;}out||(out=new Rectangle());this.clone(out);if(source.width<=0||source.height<=0)return out;out.addPoint(source.x,source.y);out.addPoint(source.right,source.bottom);return this;};_proto13.clone=function clone(out){if(out===void 0){out=null;}out||(out=new Rectangle());out.x=this.x;out.y=this.y;out.width=this.width;out.height=this.height;return out;};_proto13.toString=function toString(){return this.x+","+this.y+","+this.width+","+this.height;};_proto13.equals=function equals(rect){if(!rect||rect.x!==this.x||rect.y!==this.y||rect.width!==this.width||rect.height!==this.height)return false;return true;};_proto13.addPoint=function addPoint(x,y){this.x>x&&(this.width+=this.x-x,this.x=x);this.y>y&&(this.height+=this.y-y,this.y=y);if(this.width<x-this.x)this.width=x-this.x;if(this.height<y-this.y)this.height=y-this.y;return this;};_proto13._getBoundPoints=function _getBoundPoints(){var rst=Rectangle._temB;rst.length=0;if(this.width==0||this.height==0)return rst;rst.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height);return rst;};Rectangle._getBoundPointS=function _getBoundPointS(x,y,width,height){var rst=Rectangle._temA;rst.length=0;if(width==0||height==0)return rst;rst.push(x,y,x+width,y,x,y+height,x+width,y+height);return rst;};Rectangle._getWrapRec=function _getWrapRec(pointList,rst){if(rst===void 0){rst=null;}if(!pointList||pointList.length<1)return rst?rst.setTo(0,0,0,0):Rectangle.TEMP.setTo(0,0,0,0);rst=rst?rst:Rectangle.create();var i,len=pointList.length,minX,maxX,minY,maxY,tPoint=Point.TEMP;minX=minY=99999;maxX=maxY=-minX;for(i=0;i<len;i+=2){tPoint.x=pointList[i];tPoint.y=pointList[i+1];minX=minX<tPoint.x?minX:tPoint.x;minY=minY<tPoint.y?minY:tPoint.y;maxX=maxX>tPoint.x?maxX:tPoint.x;maxY=maxY>tPoint.y?maxY:tPoint.y;}return rst.setTo(minX,minY,maxX-minX,maxY-minY);};_proto13.isEmpty=function isEmpty(){if(this.width<=0||this.height<=0)return true;return false;};_createClass(Rectangle,[{key:"right",get:function get(){return this.x+this.width;}},{key:"bottom",get:function get(){return this.y+this.height;}}]);return Rectangle;}();Rectangle.EMPTY=new Rectangle();Rectangle.TEMP=new Rectangle();Rectangle._temB=[];Rectangle._temA=[];var LayaGL=function LayaGL(){};LayaGL.ARRAY_BUFFER_TYPE_DATA=0;LayaGL.ARRAY_BUFFER_TYPE_CMD=1;LayaGL.ARRAY_BUFFER_REF_REFERENCE=0;LayaGL.ARRAY_BUFFER_REF_COPY=1;LayaGL.UPLOAD_SHADER_UNIFORM_TYPE_ID=0;LayaGL.UPLOAD_SHADER_UNIFORM_TYPE_DATA=1;var WebGLContext=/*#__PURE__*/function(){function WebGLContext(){}WebGLContext.__init__=function __init__(){var gl=LayaGL.instance;WebGLContext._depthFunc=gl.LESS;WebGLContext._blendEquation=gl.FUNC_ADD;WebGLContext._blendEquationRGB=gl.FUNC_ADD;WebGLContext._blendEquationAlpha=gl.FUNC_ADD;WebGLContext._sFactor=gl.ONE;WebGLContext._dFactor=gl.ZERO;WebGLContext._sFactorAlpha=gl.ONE;WebGLContext._dFactorAlpha=gl.ZERO;WebGLContext._activedTextureID=gl.TEXTURE0;WebGLContext._glTextureIDs=[gl.TEXTURE0,gl.TEXTURE1,gl.TEXTURE2,gl.TEXTURE3,gl.TEXTURE4,gl.TEXTURE5,gl.TEXTURE6,gl.TEXTURE7];};WebGLContext.useProgram=function useProgram(gl,program){if(WebGLContext._useProgram===program)return false;gl.useProgram(program);WebGLContext._useProgram=program;return true;};WebGLContext.setDepthTest=function setDepthTest(gl,value){value!==WebGLContext._depthTest&&(WebGLContext._depthTest=value,value?gl.enable(gl.DEPTH_TEST):gl.disable(gl.DEPTH_TEST));};WebGLContext.setDepthMask=function setDepthMask(gl,value){value!==WebGLContext._depthMask&&(WebGLContext._depthMask=value,gl.depthMask(value));};WebGLContext.setDepthFunc=function setDepthFunc(gl,value){value!==WebGLContext._depthFunc&&(WebGLContext._depthFunc=value,gl.depthFunc(value));};WebGLContext.setBlend=function setBlend(gl,value){value!==WebGLContext._blend&&(WebGLContext._blend=value,value?gl.enable(gl.BLEND):gl.disable(gl.BLEND));};WebGLContext.setBlendEquation=function setBlendEquation(gl,blendEquation){if(blendEquation!==WebGLContext._blendEquation){WebGLContext._blendEquation=blendEquation;WebGLContext._blendEquationRGB=WebGLContext._blendEquationAlpha=null;gl.blendEquation(blendEquation);}};WebGLContext.setBlendEquationSeparate=function setBlendEquationSeparate(gl,blendEquationRGB,blendEquationAlpha){if(blendEquationRGB!==WebGLContext._blendEquationRGB||blendEquationAlpha!==WebGLContext._blendEquationAlpha){WebGLContext._blendEquationRGB=blendEquationRGB;WebGLContext._blendEquationAlpha=blendEquationAlpha;WebGLContext._blendEquation=null;gl.blendEquationSeparate(blendEquationRGB,blendEquationAlpha);}};WebGLContext.setBlendFunc=function setBlendFunc(gl,sFactor,dFactor,force){if(force===void 0){force=false;}if(force||sFactor!==WebGLContext._sFactor||dFactor!==WebGLContext._dFactor){WebGLContext._sFactor=sFactor;WebGLContext._dFactor=dFactor;WebGLContext._sFactorRGB=null;WebGLContext._dFactorRGB=null;WebGLContext._sFactorAlpha=null;WebGLContext._dFactorAlpha=null;gl.blendFunc(sFactor,dFactor);}};WebGLContext.setBlendFuncSeperate=function setBlendFuncSeperate(gl,srcRGB,dstRGB,srcAlpha,dstAlpha){if(srcRGB!==WebGLContext._sFactorRGB||dstRGB!==WebGLContext._dFactorRGB||srcAlpha!==WebGLContext._sFactorAlpha||dstAlpha!==WebGLContext._dFactorAlpha){WebGLContext._sFactorRGB=srcRGB;WebGLContext._dFactorRGB=dstRGB;WebGLContext._sFactorAlpha=srcAlpha;WebGLContext._dFactorAlpha=dstAlpha;WebGLContext._sFactor=null;WebGLContext._dFactor=null;gl.blendFuncSeparate(srcRGB,dstRGB,srcAlpha,dstAlpha);}};WebGLContext.setCullFace=function setCullFace(gl,value){value!==WebGLContext._cullFace&&(WebGLContext._cullFace=value,value?gl.enable(gl.CULL_FACE):gl.disable(gl.CULL_FACE));};WebGLContext.setFrontFace=function setFrontFace(gl,value){value!==WebGLContext._frontFace&&(WebGLContext._frontFace=value,gl.frontFace(value));};WebGLContext.activeTexture=function activeTexture(gl,textureID){if(WebGLContext._activedTextureID!==textureID){gl.activeTexture(textureID);WebGLContext._activedTextureID=textureID;}};WebGLContext.bindTexture=function bindTexture(gl,target,texture){if(WebGLContext._activeTextures[WebGLContext._activedTextureID-gl.TEXTURE0]!==texture){gl.bindTexture(target,texture);WebGLContext._activeTextures[WebGLContext._activedTextureID-gl.TEXTURE0]=texture;}};WebGLContext.__init_native=function __init_native(){if(!ILaya.Render.supportWebGLPlusRendering)return;var webGLContext=WebGLContext;webGLContext.activeTexture=webGLContext.activeTextureForNative;webGLContext.bindTexture=webGLContext.bindTextureForNative;};WebGLContext.useProgramForNative=function useProgramForNative(gl,program){gl.useProgram(program);return true;};WebGLContext.setDepthTestForNative=function setDepthTestForNative(gl,value){if(value)gl.enable(gl.DEPTH_TEST);else gl.disable(gl.DEPTH_TEST);};WebGLContext.setDepthMaskForNative=function setDepthMaskForNative(gl,value){gl.depthMask(value);};WebGLContext.setDepthFuncForNative=function setDepthFuncForNative(gl,value){gl.depthFunc(value);};WebGLContext.setBlendForNative=function setBlendForNative(gl,value){if(value)gl.enable(gl.BLEND);else gl.disable(gl.BLEND);};WebGLContext.setBlendFuncForNative=function setBlendFuncForNative(gl,sFactor,dFactor){gl.blendFunc(sFactor,dFactor);};WebGLContext.setCullFaceForNative=function setCullFaceForNative(gl,value){if(value)gl.enable(gl.CULL_FACE);else gl.disable(gl.CULL_FACE);};WebGLContext.setFrontFaceForNative=function setFrontFaceForNative(gl,value){gl.frontFace(value);};WebGLContext.activeTextureForNative=function activeTextureForNative(gl,textureID){gl.activeTexture(textureID);};WebGLContext.bindTextureForNative=function bindTextureForNative(gl,target,texture){gl.bindTexture(target,texture);};WebGLContext.bindVertexArrayForNative=function bindVertexArrayForNative(gl,vertexArray){gl.bindVertexArray(vertexArray);};return WebGLContext;}();WebGLContext._activeTextures=new Array(8);WebGLContext._useProgram=null;WebGLContext._depthTest=true;WebGLContext._depthMask=true;WebGLContext._blend=false;WebGLContext._cullFace=false;WebGLContext.mainContext=null;var Handler=/*#__PURE__*/function(){function Handler(caller,method,args,once){if(caller===void 0){caller=null;}if(method===void 0){method=null;}if(args===void 0){args=null;}if(once===void 0){once=false;}this.once=false;this._id=0;this.setTo(caller,method,args,once);}var _proto14=Handler.prototype;_proto14.setTo=function setTo(caller,method,args,once){if(once===void 0){once=false;}this._id=Handler._gid++;this.caller=caller;this.method=method;this.args=args;this.once=once;return this;};_proto14.run=function run(){if(this.method==null)return null;var id=this._id;var result=this.method.apply(this.caller,this.args);this._id===id&&this.once&&this.recover();return result;};_proto14.runWith=function runWith(data){if(this.method==null)return null;var id=this._id;if(data==null)var result=this.method.apply(this.caller,this.args);else if(!this.args&&!data.unshift)result=this.method.call(this.caller,data);else if(this.args)result=this.method.apply(this.caller,this.args.concat(data));else result=this.method.apply(this.caller,data);this._id===id&&this.once&&this.recover();return result;};_proto14.clear=function clear(){this.caller=null;this.method=null;this.args=null;return this;};_proto14.recover=function recover(){if(this._id>0){this._id=0;Handler._pool.push(this.clear());}};Handler.create=function create(caller,method,args,once){if(args===void 0){args=null;}if(once===void 0){once=true;}if(Handler._pool.length)return Handler._pool.pop().setTo(caller,method,args,once);return new Handler(caller,method,args,once);};return Handler;}();Handler._pool=[];Handler._gid=1;var EventDispatcher=/*#__PURE__*/function(){function EventDispatcher(){}var _proto15=EventDispatcher.prototype;_proto15.hasListener=function hasListener(type){var listener=this._events&&this._events[type];return !!listener;};_proto15.event=function event(type,data){if(data===void 0){data=null;}if(!this._events||!this._events[type])return false;var listeners=this._events[type];if(listeners.run){if(listeners.once)delete this._events[type];data!=null?listeners.runWith(data):listeners.run();}else {for(var i=0,n=listeners.length;i<n;i++){var listener=listeners[i];if(listener){data!=null?listener.runWith(data):listener.run();}if(!listener||listener.once){listeners.splice(i,1);i--;n--;}}if(listeners.length===0&&this._events)delete this._events[type];}return true;};_proto15.on=function on(type,caller,listener,args){if(args===void 0){args=null;}return this._createListener(type,caller,listener,args,false);};_proto15.once=function once(type,caller,listener,args){if(args===void 0){args=null;}return this._createListener(type,caller,listener,args,true);};_proto15._createListener=function _createListener(type,caller,listener,args,once,offBefore){if(offBefore===void 0){offBefore=true;}offBefore&&this.off(type,caller,listener,once);var handler=EventHandler.create(caller||this,listener,args,once);this._events||(this._events={});var events=this._events;if(!events[type])events[type]=handler;else {if(!events[type].run)events[type].push(handler);else events[type]=[events[type],handler];}return this;};_proto15.off=function off(type,caller,listener,onceOnly){if(onceOnly===void 0){onceOnly=false;}if(!this._events||!this._events[type])return this;var listeners=this._events[type];if(listeners!=null){if(listeners.run){if((!caller||listeners.caller===caller)&&(listener==null||listeners.method===listener)&&(!onceOnly||listeners.once)){delete this._events[type];listeners.recover();}}else {var count=0;for(var i=0,n=listeners.length;i<n;i++){var item=listeners[i];if(!item){count++;continue;}if(item&&(!caller||item.caller===caller)&&(listener==null||item.method===listener)&&(!onceOnly||item.once)){count++;listeners[i]=null;item.recover();}}if(count===n)delete this._events[type];}}return this;};_proto15.offAll=function offAll(type){if(type===void 0){type=null;}var events=this._events;if(!events)return this;if(type){this._recoverHandlers(events[type]);delete events[type];}else {for(var name in events){this._recoverHandlers(events[name]);}this._events=null;}return this;};_proto15.offAllCaller=function offAllCaller(caller){if(caller&&this._events){for(var name in this._events){this.off(name,caller,null);}}return this;};_proto15._recoverHandlers=function _recoverHandlers(arr){if(!arr)return;if(arr.run){arr.recover();}else {for(var i=arr.length-1;i>-1;i--){if(arr[i]){arr[i].recover();arr[i]=null;}}}};_proto15.isMouseEvent=function isMouseEvent(type){return EventDispatcher.MOUSE_EVENTS[type]||false;};return EventDispatcher;}();EventDispatcher.MOUSE_EVENTS={"rightmousedown":true,"rightmouseup":true,"rightclick":true,"mousedown":true,"mouseup":true,"mousemove":true,"mouseover":true,"mouseout":true,"click":true,"doubleclick":true};var EventHandler=/*#__PURE__*/function(_Handler){_inheritsLoose(EventHandler,_Handler);function EventHandler(caller,method,args,once){return _Handler.call(this,caller,method,args,once)||this;}var _proto16=EventHandler.prototype;_proto16.recover=function recover(){if(this._id>0){this._id=0;EventHandler._pool.push(this.clear());}};EventHandler.create=function create(caller,method,args,once){if(args===void 0){args=null;}if(once===void 0){once=true;}if(EventHandler._pool.length)return EventHandler._pool.pop().setTo(caller,method,args,once);return new EventHandler(caller,method,args,once);};return EventHandler;}(Handler);EventHandler._pool=[];var URL=/*#__PURE__*/function(){function URL(url){this._url=URL.formatURL(url);this._path=URL.getPath(url);}URL.formatURL=function formatURL(url){if(!url)return "null path";if(url.indexOf(":")>0)return url;if(URL.customFormat!=null)url=URL.customFormat(url);if(url.indexOf(":")>0)return url;var char1=url.charAt(0);if(char1==="."){return URL._formatRelativePath(URL._basePath+url);}else if(char1==='~'){return URL.rootPath+url.substring(1);}else if(char1==="d"){if(url.indexOf("data:image")===0)return url;}else if(char1==="/"){return url;}return URL._basePath+url;};URL._formatRelativePath=function _formatRelativePath(value){var parts=value.split("/");for(var i=0,len=parts.length;i<len;i++){if(parts[i]=='..'){parts.splice(i-1,2);i-=2;}}return parts.join('/');};URL.getPath=function getPath(url){var ofs=url.lastIndexOf('/');return ofs>0?url.substr(0,ofs+1):"";};URL.getFileName=function getFileName(url){var ofs=url.lastIndexOf('/');return ofs>0?url.substr(ofs+1):url;};URL.getAdptedFilePath=function getAdptedFilePath(url){if(!URL.exportSceneToJson||!url)return url;var i,len;len=URL._adpteTypeList.length;var tArr;for(i=0;i<len;i++){tArr=URL._adpteTypeList[i];url=url.replace(tArr[0],tArr[1]);}return url;};_createClass(URL,[{key:"url",get:function get(){return this._url;}},{key:"path",get:function get(){return this._path;}}],[{key:"basePath",set:function set(value){URL._basePath=ILaya.Laya._getUrlPath();URL._basePath=URL.formatURL(value);},get:function get(){return URL._basePath;}}]);return URL;}();URL.version={};URL.exportSceneToJson=false;URL._basePath="";URL.rootPath="";URL.customFormat=function(url){var newUrl=URL.version[url];if(!window.conch&&newUrl)url+="?v="+newUrl;return url;};URL._adpteTypeList=[[".scene3d",".json"],[".scene",".json"],[".taa",".json"],[".prefab",".json"]];var Resource=/*#__PURE__*/function(_EventDispatcher){_inheritsLoose(Resource,_EventDispatcher);function Resource(){var _this2;_this2=_EventDispatcher.call(this)||this;_this2._id=0;_this2._url=null;_this2._cpuMemory=0;_this2._gpuMemory=0;_this2._destroyed=false;_this2._referenceCount=0;_this2.lock=false;_this2.name=null;_this2._id=++Resource._uniqueIDCounter;_this2._destroyed=false;_this2._referenceCount=0;Resource._idResourcesMap[_this2.id]=_assertThisInitialized(_this2);_this2.lock=false;return _this2;}Resource._addCPUMemory=function _addCPUMemory(size){Resource._cpuMemory+=size;};Resource._addGPUMemory=function _addGPUMemory(size){Resource._gpuMemory+=size;};Resource._addMemory=function _addMemory(cpuSize,gpuSize){Resource._cpuMemory+=cpuSize;Resource._gpuMemory+=gpuSize;};Resource.getResourceByID=function getResourceByID(id){return Resource._idResourcesMap[id];};Resource.getResourceByURL=function getResourceByURL(url,index){if(index===void 0){index=0;}return Resource._urlResourcesMap[url][index];};Resource.destroyUnusedResources=function destroyUnusedResources(){for(var k in Resource._idResourcesMap){var res=Resource._idResourcesMap[k];if(!res.lock&&res._referenceCount===0)res.destroy();}};var _proto17=Resource.prototype;_proto17._setCPUMemory=function _setCPUMemory(value){var offsetValue=value-this._cpuMemory;this._cpuMemory=value;Resource._addCPUMemory(offsetValue);};_proto17._setGPUMemory=function _setGPUMemory(value){var offsetValue=value-this._gpuMemory;this._gpuMemory=value;Resource._addGPUMemory(offsetValue);};_proto17._setCreateURL=function _setCreateURL(url){url=URL.formatURL(url);if(this._url!==url){var resList;if(this._url){resList=Resource._urlResourcesMap[this._url];resList.splice(resList.indexOf(this),1);resList.length===0&&delete Resource._urlResourcesMap[this._url];}if(url){resList=Resource._urlResourcesMap[url];resList||(Resource._urlResourcesMap[url]=resList=[]);resList.push(this);}this._url=url;}};_proto17._addReference=function _addReference(count){if(count===void 0){count=1;}this._referenceCount+=count;};_proto17._removeReference=function _removeReference(count){if(count===void 0){count=1;}this._referenceCount-=count;};_proto17._clearReference=function _clearReference(){this._referenceCount=0;};_proto17._recoverResource=function _recoverResource(){};_proto17._disposeResource=function _disposeResource(){};_proto17._activeResource=function _activeResource(){};_proto17.destroy=function destroy(){if(this._destroyed)return;this._destroyed=true;this.lock=false;this._disposeResource();delete Resource._idResourcesMap[this.id];var resList;if(this._url){resList=Resource._urlResourcesMap[this._url];if(resList){resList.splice(resList.indexOf(this),1);resList.length===0&&delete Resource._urlResourcesMap[this._url];}var resou=ILaya.Loader.loadedMap[this._url];resou==this&&delete ILaya.Loader.loadedMap[this._url];}};_createClass(Resource,[{key:"id",get:function get(){return this._id;}},{key:"url",get:function get(){return this._url;}},{key:"cpuMemory",get:function get(){return this._cpuMemory;}},{key:"gpuMemory",get:function get(){return this._gpuMemory;}},{key:"destroyed",get:function get(){return this._destroyed;}},{key:"referenceCount",get:function get(){return this._referenceCount;}}],[{key:"cpuMemory",get:function get(){return Resource._cpuMemory;}},{key:"gpuMemory",get:function get(){return Resource._gpuMemory;}}]);return Resource;}(EventDispatcher);Resource._uniqueIDCounter=0;Resource._idResourcesMap={};Resource._urlResourcesMap={};Resource._cpuMemory=0;Resource._gpuMemory=0;var Bitmap=/*#__PURE__*/function(_Resource){_inheritsLoose(Bitmap,_Resource);function Bitmap(){var _this3;_this3=_Resource.call(this)||this;_this3._width=-1;_this3._height=-1;return _this3;}var _proto18=Bitmap.prototype;_proto18._getSource=function _getSource(){throw "Bitmap: must override it.";};_createClass(Bitmap,[{key:"width",get:function get(){return this._width;},set:function set(width){this._width=width;}},{key:"height",get:function get(){return this._height;},set:function set(height){this._height=height;}}]);return Bitmap;}(Resource);(function(FilterMode){FilterMode[FilterMode["Point"]=0]="Point";FilterMode[FilterMode["Bilinear"]=1]="Bilinear";FilterMode[FilterMode["Trilinear"]=2]="Trilinear";})(exports.FilterMode||(exports.FilterMode={}));(function(TextureFormat){TextureFormat[TextureFormat["R8G8B8"]=0]="R8G8B8";TextureFormat[TextureFormat["R8G8B8A8"]=1]="R8G8B8A8";TextureFormat[TextureFormat["R5G6B5"]=16]="R5G6B5";TextureFormat[TextureFormat["Alpha8"]=2]="Alpha8";TextureFormat[TextureFormat["DXT1"]=3]="DXT1";TextureFormat[TextureFormat["DXT5"]=4]="DXT5";TextureFormat[TextureFormat["ETC1RGB"]=5]="ETC1RGB";TextureFormat[TextureFormat["PVRTCRGB_2BPPV"]=9]="PVRTCRGB_2BPPV";TextureFormat[TextureFormat["PVRTCRGBA_2BPPV"]=10]="PVRTCRGBA_2BPPV";TextureFormat[TextureFormat["PVRTCRGB_4BPPV"]=11]="PVRTCRGB_4BPPV";TextureFormat[TextureFormat["PVRTCRGBA_4BPPV"]=12]="PVRTCRGBA_4BPPV";TextureFormat[TextureFormat["R32G32B32A32"]=15]="R32G32B32A32";TextureFormat[TextureFormat["R16G16B16A16"]=16]="R16G16B16A16";})(exports.TextureFormat||(exports.TextureFormat={}));(function(WarpMode){WarpMode[WarpMode["Repeat"]=0]="Repeat";WarpMode[WarpMode["Clamp"]=1]="Clamp";})(exports.WarpMode||(exports.WarpMode={}));var BaseTexture=/*#__PURE__*/function(_Bitmap){_inheritsLoose(BaseTexture,_Bitmap);function BaseTexture(format,mipMap){var _this4;_this4=_Bitmap.call(this)||this;_this4._wrapModeU=exports.WarpMode.Repeat;_this4._wrapModeV=exports.WarpMode.Repeat;_this4._filterMode=exports.FilterMode.Bilinear;_this4._readyed=false;_this4._width=-1;_this4._height=-1;_this4._format=format;_this4._mipmap=mipMap;_this4._anisoLevel=1;_this4._glTexture=LayaGL.instance.createTexture();return _this4;}var _proto19=BaseTexture.prototype;_proto19._getFormatByteCount=function _getFormatByteCount(){switch(this._format){case exports.TextureFormat.R8G8B8:return 3;case exports.TextureFormat.R8G8B8A8:return 4;case exports.TextureFormat.R5G6B5:return 1;case exports.TextureFormat.Alpha8:return 1;case exports.TextureFormat.R32G32B32A32:return 4;default:throw "Texture2D: unknown format.";}};_proto19._isPot=function _isPot(size){return (size&size-1)===0;};_proto19._getGLFormat=function _getGLFormat(){var glFormat;var gl=LayaGL.instance;var gpu=LayaGL.layaGPUInstance;switch(this._format){case exports.TextureFormat.R8G8B8:case exports.TextureFormat.R5G6B5:glFormat=gl.RGB;break;case exports.TextureFormat.R8G8B8A8:glFormat=gl.RGBA;break;case exports.TextureFormat.Alpha8:glFormat=gl.ALPHA;break;case exports.TextureFormat.R32G32B32A32:case exports.TextureFormat.R16G16B16A16:glFormat=gl.RGBA;break;case exports.TextureFormat.DXT1:if(gpu._compressedTextureS3tc)glFormat=gpu._compressedTextureS3tc.COMPRESSED_RGB_S3TC_DXT1_EXT;else throw "BaseTexture: not support DXT1 format.";break;case exports.TextureFormat.DXT5:if(gpu._compressedTextureS3tc)glFormat=gpu._compressedTextureS3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;else throw "BaseTexture: not support DXT5 format.";break;case exports.TextureFormat.ETC1RGB:if(gpu._compressedTextureEtc1)glFormat=gpu._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL;else throw "BaseTexture: not support ETC1RGB format.";break;case exports.TextureFormat.PVRTCRGB_2BPPV:if(gpu._compressedTexturePvrtc)glFormat=gpu._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;else throw "BaseTexture: not support PVRTCRGB_2BPPV format.";break;case exports.TextureFormat.PVRTCRGBA_2BPPV:if(gpu._compressedTexturePvrtc)glFormat=gpu._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;else throw "BaseTexture: not support PVRTCRGBA_2BPPV format.";break;case exports.TextureFormat.PVRTCRGB_4BPPV:if(gpu._compressedTexturePvrtc)glFormat=gpu._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;else throw "BaseTexture: not support PVRTCRGB_4BPPV format.";break;case exports.TextureFormat.PVRTCRGBA_4BPPV:if(gpu._compressedTexturePvrtc)glFormat=gpu._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;else throw "BaseTexture: not support PVRTCRGBA_4BPPV format.";break;default:throw "BaseTexture: unknown texture format.";}return glFormat;};_proto19._setFilterMode=function _setFilterMode(value){var gl=LayaGL.instance;WebGLContext.bindTexture(gl,this._glTextureType,this._glTexture);switch(value){case exports.FilterMode.Point:if(this._mipmap)gl.texParameteri(this._glTextureType,gl.TEXTURE_MIN_FILTER,gl.NEAREST_MIPMAP_NEAREST);else gl.texParameteri(this._glTextureType,gl.TEXTURE_MIN_FILTER,gl.NEAREST);gl.texParameteri(this._glTextureType,gl.TEXTURE_MAG_FILTER,gl.NEAREST);break;case exports.FilterMode.Bilinear:if(this._mipmap)gl.texParameteri(this._glTextureType,gl.TEXTURE_MIN_FILTER,gl.LINEAR_MIPMAP_NEAREST);else gl.texParameteri(this._glTextureType,gl.TEXTURE_MIN_FILTER,gl.LINEAR);gl.texParameteri(this._glTextureType,gl.TEXTURE_MAG_FILTER,gl.LINEAR);break;case exports.FilterMode.Trilinear:if(this._mipmap)gl.texParameteri(this._glTextureType,gl.TEXTURE_MIN_FILTER,gl.LINEAR_MIPMAP_LINEAR);else gl.texParameteri(this._glTextureType,gl.TEXTURE_MIN_FILTER,gl.LINEAR);gl.texParameteri(this._glTextureType,gl.TEXTURE_MAG_FILTER,gl.LINEAR);break;default:throw new Error("BaseTexture:unknown filterMode value.");}};_proto19._setWarpMode=function _setWarpMode(orientation,mode){var gl=LayaGL.instance;WebGLContext.bindTexture(gl,this._glTextureType,this._glTexture);if(this._isPot(this._width)&&this._isPot(this._height)){switch(mode){case exports.WarpMode.Repeat:gl.texParameteri(this._glTextureType,orientation,gl.REPEAT);break;case exports.WarpMode.Clamp:gl.texParameteri(this._glTextureType,orientation,gl.CLAMP_TO_EDGE);break;}}else {gl.texParameteri(this._glTextureType,orientation,gl.CLAMP_TO_EDGE);}};_proto19._setAnisotropy=function _setAnisotropy(value){var anisotropic=LayaGL.layaGPUInstance._extTextureFilterAnisotropic;if(anisotropic){value=Math.max(value,1);var gl=LayaGL.instance;WebGLContext.bindTexture(gl,this._glTextureType,this._glTexture);value=Math.min(gl.getParameter(anisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT),value);gl.texParameterf(this._glTextureType,anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,value);}};_proto19._disposeResource=function _disposeResource(){if(this._glTexture){LayaGL.instance.deleteTexture(this._glTexture);this._glTexture=null;this._setGPUMemory(0);}};_proto19._getSource=function _getSource(){if(this._readyed)return this._glTexture;else return null;};_proto19.generateMipmap=function generateMipmap(){if(this._isPot(this.width)&&this._isPot(this.height))LayaGL.instance.generateMipmap(this._glTextureType);};_createClass(BaseTexture,[{key:"mipmap",get:function get(){return this._mipmap;}},{key:"format",get:function get(){return this._format;}},{key:"wrapModeU",get:function get(){return this._wrapModeU;},set:function set(value){if(this._wrapModeU!==value){this._wrapModeU=value;this._width!==-1&&this._setWarpMode(LayaGL.instance.TEXTURE_WRAP_S,value);}}},{key:"wrapModeV",get:function get(){return this._wrapModeV;},set:function set(value){if(this._wrapModeV!==value){this._wrapModeV=value;this._height!==-1&&this._setWarpMode(LayaGL.instance.TEXTURE_WRAP_T,value);}}},{key:"filterMode",get:function get(){return this._filterMode;},set:function set(value){if(value!==this._filterMode){this._filterMode=value;this._width!==-1&&this._height!==-1&&this._setFilterMode(value);}}},{key:"anisoLevel",get:function get(){return this._anisoLevel;},set:function set(value){if(value!==this._anisoLevel){this._anisoLevel=Math.max(1,Math.min(16,value));this._width!==-1&&this._height!==-1&&this._setAnisotropy(value);}}},{key:"mipmapCount",get:function get(){return this._mipmapCount;}},{key:"defaulteTexture",get:function get(){throw "BaseTexture:must override it.";}}]);return BaseTexture;}(Bitmap);BaseTexture._rgbmRange=5.0;BaseTexture.FORMAT_R8G8B8=0;BaseTexture.FORMAT_R8G8B8A8=1;BaseTexture.FORMAT_ALPHA8=2;BaseTexture.FORMAT_DXT1=3;BaseTexture.FORMAT_DXT5=4;BaseTexture.FORMAT_ETC1RGB=5;BaseTexture.FORMAT_PVRTCRGB_2BPPV=9;BaseTexture.FORMAT_PVRTCRGBA_2BPPV=10;BaseTexture.FORMAT_PVRTCRGB_4BPPV=11;BaseTexture.FORMAT_PVRTCRGBA_4BPPV=12;BaseTexture.RENDERTEXTURE_FORMAT_RGBA_HALF_FLOAT=14;BaseTexture.FORMAT_R32G32B32A32=15;BaseTexture.FORMAT_DEPTH_16=0;BaseTexture.FORMAT_STENCIL_8=1;BaseTexture.FORMAT_DEPTHSTENCIL_16_8=2;BaseTexture.FORMAT_DEPTHSTENCIL_NONE=3;BaseTexture.FILTERMODE_POINT=0;BaseTexture.FILTERMODE_BILINEAR=1;BaseTexture.FILTERMODE_TRILINEAR=2;BaseTexture.WARPMODE_REPEAT=0;BaseTexture.WARPMODE_CLAMP=1;var Byte=/*#__PURE__*/function(){function Byte(data){if(data===void 0){data=null;}this._xd_=true;this._allocated_=8;this._pos_=0;this._length=0;if(data){this._u8d_=new Uint8Array(data);this._d_=new DataView(this._u8d_.buffer);this._length=this._d_.byteLength;}else {this._resizeBuffer(this._allocated_);}}Byte.getSystemEndian=function getSystemEndian(){if(!Byte._sysEndian){var buffer=new ArrayBuffer(2);new DataView(buffer).setInt16(0,256,true);Byte._sysEndian=new Int16Array(buffer)[0]===256?Byte.LITTLE_ENDIAN:Byte.BIG_ENDIAN;}return Byte._sysEndian;};var _proto20=Byte.prototype;_proto20._resizeBuffer=function _resizeBuffer(len){try{var newByteView=new Uint8Array(len);if(this._u8d_!=null){if(this._u8d_.length<=len)newByteView.set(this._u8d_);else newByteView.set(this._u8d_.subarray(0,len));}this._u8d_=newByteView;this._d_=new DataView(newByteView.buffer);}catch(err){throw "Invalid typed array length:"+len;}};_proto20.getString=function getString(){return this.readString();};_proto20.readString=function readString(){return this._rUTF(this.getUint16());};_proto20.getFloat32Array=function getFloat32Array(start,len){return this.readFloat32Array(start,len);};_proto20.readFloat32Array=function readFloat32Array(start,len){var end=start+len;end=end>this._length?this._length:end;var v=new Float32Array(this._d_.buffer.slice(start,end));this._pos_=end;return v;};_proto20.getUint8Array=function getUint8Array(start,len){return this.readUint8Array(start,len);};_proto20.readUint8Array=function readUint8Array(start,len){var end=start+len;end=end>this._length?this._length:end;var v=new Uint8Array(this._d_.buffer.slice(start,end));this._pos_=end;return v;};_proto20.getInt16Array=function getInt16Array(start,len){return this.readInt16Array(start,len);};_proto20.readInt16Array=function readInt16Array(start,len){var end=start+len;end=end>this._length?this._length:end;var v=new Int16Array(this._d_.buffer.slice(start,end));this._pos_=end;return v;};_proto20.getFloat32=function getFloat32(){return this.readFloat32();};_proto20.readFloat32=function readFloat32(){if(this._pos_+4>this._length)throw "getFloat32 error - Out of bounds";var v=this._d_.getFloat32(this._pos_,this._xd_);this._pos_+=4;return v;};_proto20.getFloat64=function getFloat64(){return this.readFloat64();};_proto20.readFloat64=function readFloat64(){if(this._pos_+8>this._length)throw "getFloat64 error - Out of bounds";var v=this._d_.getFloat64(this._pos_,this._xd_);this._pos_+=8;return v;};_proto20.writeFloat32=function writeFloat32(value){this._ensureWrite(this._pos_+4);this._d_.setFloat32(this._pos_,value,this._xd_);this._pos_+=4;};_proto20.writeFloat64=function writeFloat64(value){this._ensureWrite(this._pos_+8);this._d_.setFloat64(this._pos_,value,this._xd_);this._pos_+=8;};_proto20.getInt32=function getInt32(){return this.readInt32();};_proto20.readInt32=function readInt32(){if(this._pos_+4>this._length)throw "getInt32 error - Out of bounds";var _float=this._d_.getInt32(this._pos_,this._xd_);this._pos_+=4;return _float;};_proto20.getUint32=function getUint32(){return this.readUint32();};_proto20.readUint32=function readUint32(){if(this._pos_+4>this._length)throw "getUint32 error - Out of bounds";var v=this._d_.getUint32(this._pos_,this._xd_);this._pos_+=4;return v;};_proto20.writeInt32=function writeInt32(value){this._ensureWrite(this._pos_+4);this._d_.setInt32(this._pos_,value,this._xd_);this._pos_+=4;};_proto20.writeUint32=function writeUint32(value){this._ensureWrite(this._pos_+4);this._d_.setUint32(this._pos_,value,this._xd_);this._pos_+=4;};_proto20.getInt16=function getInt16(){return this.readInt16();};_proto20.readInt16=function readInt16(){if(this._pos_+2>this._length)throw "getInt16 error - Out of bounds";var us=this._d_.getInt16(this._pos_,this._xd_);this._pos_+=2;return us;};_proto20.getUint16=function getUint16(){return this.readUint16();};_proto20.readUint16=function readUint16(){if(this._pos_+2>this._length)throw "getUint16 error - Out of bounds";var us=this._d_.getUint16(this._pos_,this._xd_);this._pos_+=2;return us;};_proto20.writeUint16=function writeUint16(value){this._ensureWrite(this._pos_+2);this._d_.setUint16(this._pos_,value,this._xd_);this._pos_+=2;};_proto20.writeInt16=function writeInt16(value){this._ensureWrite(this._pos_+2);this._d_.setInt16(this._pos_,value,this._xd_);this._pos_+=2;};_proto20.getUint8=function getUint8(){return this.readUint8();};_proto20.readUint8=function readUint8(){if(this._pos_+1>this._length)throw "getUint8 error - Out of bounds";return this._u8d_[this._pos_++];};_proto20.writeUint8=function writeUint8(value){this._ensureWrite(this._pos_+1);this._d_.setUint8(this._pos_,value);this._pos_++;};_proto20._getUInt8=function _getUInt8(pos){return this._readUInt8(pos);};_proto20._readUInt8=function _readUInt8(pos){return this._d_.getUint8(pos);};_proto20._getUint16=function _getUint16(pos){return this._readUint16(pos);};_proto20._readUint16=function _readUint16(pos){return this._d_.getUint16(pos,this._xd_);};_proto20._getMatrix=function _getMatrix(){return this._readMatrix();};_proto20._readMatrix=function _readMatrix(){var rst=new Matrix(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32());return rst;};_proto20._rUTF=function _rUTF(len){var max=this._pos_+len,c,c2,c3,f=String.fromCharCode;var u=this._u8d_;var strs=[];var n=0;strs.length=1000;while(this._pos_<max){c=u[this._pos_++];if(c<0x80){if(c!=0)strs[n++]=f(c);}else if(c<0xE0){strs[n++]=f((c&0x3F)<<6|u[this._pos_++]&0x7F);}else if(c<0xF0){c2=u[this._pos_++];strs[n++]=f((c&0x1F)<<12|(c2&0x7F)<<6|u[this._pos_++]&0x7F);}else {c2=u[this._pos_++];c3=u[this._pos_++];var _code=(c&0x0F)<<18|(c2&0x7F)<<12|(c3&0x7F)<<6|u[this._pos_++]&0x7F;if(_code>=0x10000){var _offset=_code-0x10000;var _lead=0xd800|_offset>>10;var _trail=0xdc00|_offset&0x3ff;strs[n++]=f(_lead);strs[n++]=f(_trail);}else {strs[n++]=f(_code);}}}strs.length=n;return strs.join('');};_proto20.getCustomString=function getCustomString(len){return this.readCustomString(len);};_proto20.readCustomString=function readCustomString(len){var v="",ulen=0,c,c2,f=String.fromCharCode;var u=this._u8d_;while(len>0){c=u[this._pos_];if(c<0x80){v+=f(c);this._pos_++;len--;}else {ulen=c-0x80;this._pos_++;len-=ulen;while(ulen>0){c=u[this._pos_++];c2=u[this._pos_++];v+=f(c2<<8|c);ulen--;}}}return v;};_proto20.clear=function clear(){this._pos_=0;this.length=0;};_proto20.__getBuffer=function __getBuffer(){return this._d_.buffer;};_proto20.writeUTFBytes=function writeUTFBytes(value){value=value+"";for(var i=0,sz=value.length;i<sz;i++){var c=value.charCodeAt(i);if(c<=0x7F){this.writeByte(c);}else if(c<=0x7FF){this._ensureWrite(this._pos_+2);this._u8d_.set([0xC0|c>>6,0x80|c&0x3F],this._pos_);this._pos_+=2;}else if(c>=0xD800&&c<=0xDBFF){i++;var c2=value.charCodeAt(i);if(!Number.isNaN(c2)&&c2>=0xDC00&&c2<=0xDFFF){var _p1=(c&0x3FF)+0x40;var _p2=c2&0x3FF;var _b1=0xF0|_p1>>8&0x3F;var _b2=0x80|_p1>>2&0x3F;var _b3=0x80|(_p1&0x3)<<4|_p2>>6&0xF;var _b4=0x80|_p2&0x3F;this._ensureWrite(this._pos_+4);this._u8d_.set([_b1,_b2,_b3,_b4],this._pos_);this._pos_+=4;}}else if(c<=0xFFFF){this._ensureWrite(this._pos_+3);this._u8d_.set([0xE0|c>>12,0x80|c>>6&0x3F,0x80|c&0x3F],this._pos_);this._pos_+=3;}else {this._ensureWrite(this._pos_+4);this._u8d_.set([0xF0|c>>18,0x80|c>>12&0x3F,0x80|c>>6&0x3F,0x80|c&0x3F],this._pos_);this._pos_+=4;}}};_proto20.writeUTFString=function writeUTFString(value){var tPos=this.pos;this.writeUint16(1);this.writeUTFBytes(value);var dPos=this.pos-tPos-2;this._d_.setUint16(tPos,dPos,this._xd_);};_proto20.readUTFString=function readUTFString(){return this.readUTFBytes(this.getUint16());};_proto20.getUTFString=function getUTFString(){return this.readUTFString();};_proto20.readUTFBytes=function readUTFBytes(len){if(len===void 0){len=-1;}if(len===0)return "";var lastBytes=this.bytesAvailable;if(len>lastBytes)throw "readUTFBytes error - Out of bounds";len=len>0?len:lastBytes;return this._rUTF(len);};_proto20.getUTFBytes=function getUTFBytes(len){if(len===void 0){len=-1;}return this.readUTFBytes(len);};_proto20.writeByte=function writeByte(value){this._ensureWrite(this._pos_+1);this._d_.setInt8(this._pos_,value);this._pos_+=1;};_proto20.readByte=function readByte(){if(this._pos_+1>this._length)throw "readByte error - Out of bounds";return this._d_.getInt8(this._pos_++);};_proto20.getByte=function getByte(){return this.readByte();};_proto20._ensureWrite=function _ensureWrite(lengthToEnsure){if(this._length<lengthToEnsure)this._length=lengthToEnsure;if(this._allocated_<lengthToEnsure)this.length=lengthToEnsure;};_proto20.writeArrayBuffer=function writeArrayBuffer(arraybuffer,offset,length){if(offset===void 0){offset=0;}if(length===void 0){length=0;}if(offset<0||length<0)throw "writeArrayBuffer error - Out of bounds";if(length==0)length=arraybuffer.byteLength-offset;this._ensureWrite(this._pos_+length);var uint8array=new Uint8Array(arraybuffer);this._u8d_.set(uint8array.subarray(offset,offset+length),this._pos_);this._pos_+=length;};_proto20.readArrayBuffer=function readArrayBuffer(length){var rst;rst=this._u8d_.buffer.slice(this._pos_,this._pos_+length);this._pos_=this._pos_+length;return rst;};_createClass(Byte,[{key:"buffer",get:function get(){var rstBuffer=this._d_.buffer;if(rstBuffer.byteLength===this._length)return rstBuffer;return rstBuffer.slice(0,this._length);}},{key:"endian",get:function get(){return this._xd_?Byte.LITTLE_ENDIAN:Byte.BIG_ENDIAN;},set:function set(value){this._xd_=value===Byte.LITTLE_ENDIAN;}},{key:"length",set:function set(value){if(this._allocated_<value)this._resizeBuffer(this._allocated_=Math.floor(Math.max(value,this._allocated_*2)));else if(this._allocated_>value)this._resizeBuffer(this._allocated_=value);this._length=value;},get:function get(){return this._length;}},{key:"pos",get:function get(){return this._pos_;},set:function set(value){this._pos_=value;}},{key:"bytesAvailable",get:function get(){return this._length-this._pos_;}}]);return Byte;}();Byte.BIG_ENDIAN="bigEndian";Byte.LITTLE_ENDIAN="littleEndian";Byte._sysEndian=null;var Texture2D=/*#__PURE__*/function(_BaseTexture){_inheritsLoose(Texture2D,_BaseTexture);function Texture2D(width,height,format,mipmap,canRead){var _this5;if(width===void 0){width=0;}if(height===void 0){height=0;}if(format===void 0){format=exports.TextureFormat.R8G8B8A8;}if(mipmap===void 0){mipmap=true;}if(canRead===void 0){canRead=false;}_this5=_BaseTexture.call(this,format,mipmap)||this;var gl=LayaGL.instance;_this5._glTextureType=gl.TEXTURE_2D;_this5._width=width;_this5._height=height;_this5._canRead=canRead;_this5._setWarpMode(gl.TEXTURE_WRAP_S,_this5._wrapModeU);_this5._setWarpMode(gl.TEXTURE_WRAP_T,_this5._wrapModeV);_this5._setFilterMode(_this5._filterMode);_this5._setAnisotropy(_this5._anisoLevel);var compress=_this5._gpuCompressFormat();if(mipmap){var mipCount=Math.max(Math.ceil(Math.log2(width))+1,Math.ceil(Math.log2(height))+1);if(!compress){for(var i=0;i<mipCount;i++){_this5._setPixels(null,i,Math.max(width>>i,1),Math.max(height>>i,1));}}_this5._mipmapCount=mipCount;_this5._setGPUMemory(width*height*4*(1+1/3));}else {if(!compress)_this5._setPixels(null,0,width,height);_this5._mipmapCount=1;_this5._setGPUMemory(width*height*4);}return _this5;}Texture2D.__init__=function __init__(){var pixels=new Uint8Array(3);pixels[0]=128;pixels[1]=128;pixels[2]=128;Texture2D.grayTexture=new Texture2D(1,1,exports.TextureFormat.R8G8B8,false,false);Texture2D.grayTexture.setPixels(pixels);Texture2D.grayTexture.lock=true;pixels[0]=255;pixels[1]=255;pixels[2]=255;Texture2D.whiteTexture=new Texture2D(1,1,exports.TextureFormat.R8G8B8,false,false);Texture2D.whiteTexture.setPixels(pixels);Texture2D.whiteTexture.lock=true;pixels[0]=0;pixels[1]=0;pixels[2]=0;Texture2D.blackTexture=new Texture2D(1,1,exports.TextureFormat.R8G8B8,false,false);Texture2D.blackTexture.setPixels(pixels);Texture2D.blackTexture.lock=true;};Texture2D._parse=function _parse(data,propertyParams,constructParams){if(propertyParams===void 0){propertyParams=null;}if(constructParams===void 0){constructParams=null;}var texture=constructParams?new Texture2D(constructParams[0],constructParams[1],constructParams[2],constructParams[3],constructParams[4]):new Texture2D(0,0);if(propertyParams){texture.wrapModeU=propertyParams.wrapModeU;texture.wrapModeV=propertyParams.wrapModeV;texture.filterMode=propertyParams.filterMode;texture.anisoLevel=propertyParams.anisoLevel;}switch(texture._format){case exports.TextureFormat.R8G8B8:case exports.TextureFormat.R8G8B8A8:texture.loadImageSource(data);break;case exports.TextureFormat.DXT1:case exports.TextureFormat.DXT5:case exports.TextureFormat.ETC1RGB:case exports.TextureFormat.PVRTCRGB_2BPPV:case exports.TextureFormat.PVRTCRGBA_2BPPV:case exports.TextureFormat.PVRTCRGB_4BPPV:case exports.TextureFormat.PVRTCRGBA_4BPPV:texture.setCompressData(data);break;default:throw "Texture2D:unkonwn format.";}return texture;};Texture2D._SimpleAnimatorTextureParse=function _SimpleAnimatorTextureParse(data,propertyParams,constructParams){var _byte=new Byte(data);var version=_byte.readUTFString();if(version!="LAYAANIMATORTEXTURE:0000")throw "Laya3D:unknow version.";var textureWidth=_byte.readInt32();var pixelDataLength=_byte.readInt32();var pixelDataArrays=new Float32Array(textureWidth*textureWidth*4);var usePixelData=new Float32Array(_byte.readArrayBuffer(pixelDataLength*4));pixelDataArrays.set(usePixelData,0);var texture=new Texture2D(textureWidth,textureWidth,exports.TextureFormat.R32G32B32A32,false,false);texture.setPixels(pixelDataArrays,0);texture.filterMode=exports.FilterMode.Point;return texture;};Texture2D.load=function load(url,complete){ILaya.loader.create(url,complete,null,ILaya.Loader.TEXTURE2D);};var _proto21=Texture2D.prototype;_proto21._gpuCompressFormat=function _gpuCompressFormat(){return this._format==exports.TextureFormat.DXT1||this._format==exports.TextureFormat.DXT5||this._format==exports.TextureFormat.ETC1RGB||this._format==exports.TextureFormat.PVRTCRGB_2BPPV||this._format==exports.TextureFormat.PVRTCRGBA_2BPPV||this._format==exports.TextureFormat.PVRTCRGB_4BPPV||this._format==exports.TextureFormat.PVRTCRGBA_4BPPV;};_proto21._setPixels=function _setPixels(pixels,miplevel,width,height){var gl=LayaGL.instance;var textureType=this._glTextureType;var glFormat=this._getGLFormat();WebGLContext.bindTexture(gl,textureType,this._glTexture);switch(this.format){case exports.TextureFormat.R8G8B8:gl.pixelStorei(gl.UNPACK_ALIGNMENT,1);gl.texImage2D(textureType,miplevel,glFormat,width,height,0,glFormat,gl.UNSIGNED_BYTE,pixels);gl.pixelStorei(gl.UNPACK_ALIGNMENT,4);break;case exports.TextureFormat.R5G6B5:gl.pixelStorei(gl.UNPACK_ALIGNMENT,2);gl.texImage2D(textureType,miplevel,glFormat,width,height,0,glFormat,gl.UNSIGNED_SHORT_5_6_5,pixels);gl.pixelStorei(gl.UNPACK_ALIGNMENT,4);break;case exports.TextureFormat.R32G32B32A32:if(LayaGL.layaGPUInstance._isWebGL2)gl.texImage2D(textureType,miplevel,gl.RGBA32F,width,height,0,glFormat,gl.FLOAT,pixels);else gl.texImage2D(textureType,miplevel,gl.RGBA,width,height,0,glFormat,gl.FLOAT,pixels);break;case exports.TextureFormat.R16G16B16A16:if(LayaGL.layaGPUInstance._isWebGL2)gl.texImage2D(textureType,miplevel,gl.RGBA16F,width,height,0,glFormat,gl.HALF_FLOAT,pixels);else gl.texImage2D(textureType,miplevel,gl.RGBA16F,width,height,0,glFormat,LayaGL.layaGPUInstance._oesTextureHalfFloat.HALF_FLOAT_OES,pixels);default:gl.texImage2D(textureType,miplevel,glFormat,width,height,0,glFormat,gl.UNSIGNED_BYTE,pixels);}};_proto21._calcualatesCompressedDataSize=function _calcualatesCompressedDataSize(format,width,height){switch(format){case exports.TextureFormat.DXT1:case exports.TextureFormat.ETC1RGB:return (width+3>>2)*(height+3>>2)*8;case exports.TextureFormat.DXT5:return (width+3>>2)*(height+3>>2)*16;case exports.TextureFormat.PVRTCRGB_4BPPV:case exports.TextureFormat.PVRTCRGBA_4BPPV:return Math.floor((Math.max(width,8)*Math.max(height,8)*4+7)/8);case exports.TextureFormat.PVRTCRGB_2BPPV:case exports.TextureFormat.PVRTCRGBA_2BPPV:return Math.floor((Math.max(width,16)*Math.max(height,8)*2+7)/8);default:return 0;}};_proto21._pharseDDS=function _pharseDDS(arrayBuffer){var FOURCC_DXT1=827611204;var FOURCC_DXT5=894720068;var DDPF_FOURCC=0x4;var DDSD_MIPMAPCOUNT=0x20000;var DDS_MAGIC=0x20534444;var DDS_HEADER_LENGTH=31;var DDS_HEADER_MAGIC=0;var DDS_HEADER_SIZE=1;var DDS_HEADER_FLAGS=2;var DDS_HEADER_HEIGHT=3;var DDS_HEADER_WIDTH=4;var DDS_HEADER_MIPMAPCOUNT=7;var DDS_HEADER_PF_FLAGS=20;var DDS_HEADER_PF_FOURCC=21;var header=new Int32Array(arrayBuffer,0,DDS_HEADER_LENGTH);if(header[DDS_HEADER_MAGIC]!=DDS_MAGIC)throw "Invalid magic number in DDS header";if(!(header[DDS_HEADER_PF_FLAGS]&DDPF_FOURCC))throw "Unsupported format, must contain a FourCC code";var compressedFormat=header[DDS_HEADER_PF_FOURCC];switch(this._format){case exports.TextureFormat.DXT1:if(compressedFormat!==FOURCC_DXT1)throw "the FourCC code is not same with texture format.";break;case exports.TextureFormat.DXT5:if(compressedFormat!==FOURCC_DXT5)throw "the FourCC code is not same with texture format.";break;default:throw "unknown texture format.";}var mipLevels=1;if(header[DDS_HEADER_FLAGS]&DDSD_MIPMAPCOUNT){mipLevels=Math.max(1,header[DDS_HEADER_MIPMAPCOUNT]);if(!this._mipmap)throw "the mipmap is not same with Texture2D.";}else {if(this._mipmap)throw "the mipmap is not same with Texture2D.";}var width=header[DDS_HEADER_WIDTH];var height=header[DDS_HEADER_HEIGHT];this._width=width;this._height=height;var dataOffset=header[DDS_HEADER_SIZE]+4;this._upLoadCompressedTexImage2D(arrayBuffer,width,height,mipLevels,dataOffset,0);};_proto21._pharseKTX=function _pharseKTX(arrayBuffer){var ETC_HEADER_LENGTH=13;var ETC_HEADER_FORMAT=4;var ETC_HEADER_HEIGHT=7;var ETC_HEADER_WIDTH=6;var ETC_HEADER_MIPMAPCOUNT=11;var ETC_HEADER_METADATA=12;var id=new Uint8Array(arrayBuffer,0,12);if(id[0]!=0xAB||id[1]!=0x4B||id[2]!=0x54||id[3]!=0x58||id[4]!=0x20||id[5]!=0x31||id[6]!=0x31||id[7]!=0xBB||id[8]!=0x0D||id[9]!=0x0A||id[10]!=0x1A||id[11]!=0x0A)throw "Invalid fileIdentifier in KTX header";var header=new Int32Array(id.buffer,id.length,ETC_HEADER_LENGTH);var compressedFormat=header[ETC_HEADER_FORMAT];switch(compressedFormat){case LayaGL.layaGPUInstance._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL:this._format=exports.TextureFormat.ETC1RGB;break;default:throw "unknown texture format.";}var mipLevels=header[ETC_HEADER_MIPMAPCOUNT];var width=header[ETC_HEADER_WIDTH];var height=header[ETC_HEADER_HEIGHT];this._width=width;this._height=height;var dataOffset=64+header[ETC_HEADER_METADATA];this._upLoadCompressedTexImage2D(arrayBuffer,width,height,mipLevels,dataOffset,4);};_proto21._pharsePVR=function _pharsePVR(arrayBuffer){var PVR_FORMAT_2BPP_RGB=0;var PVR_FORMAT_2BPP_RGBA=1;var PVR_FORMAT_4BPP_RGB=2;var PVR_FORMAT_4BPP_RGBA=3;var PVR_MAGIC=0x03525650;var PVR_HEADER_LENGTH=13;var PVR_HEADER_MAGIC=0;var PVR_HEADER_FORMAT=2;var PVR_HEADER_HEIGHT=6;var PVR_HEADER_WIDTH=7;var PVR_HEADER_MIPMAPCOUNT=11;var PVR_HEADER_METADATA=12;var header=new Int32Array(arrayBuffer,0,PVR_HEADER_LENGTH);if(header[PVR_HEADER_MAGIC]!=PVR_MAGIC)throw "Invalid magic number in PVR header";var compressedFormat=header[PVR_HEADER_FORMAT];switch(compressedFormat){case PVR_FORMAT_2BPP_RGB:this._format=exports.TextureFormat.PVRTCRGB_2BPPV;break;case PVR_FORMAT_4BPP_RGB:this._format=exports.TextureFormat.PVRTCRGB_4BPPV;break;case PVR_FORMAT_2BPP_RGBA:this._format=exports.TextureFormat.PVRTCRGBA_2BPPV;break;case PVR_FORMAT_4BPP_RGBA:this._format=exports.TextureFormat.PVRTCRGBA_4BPPV;break;default:throw "Texture2D:unknown PVR format.";}var mipLevels=header[PVR_HEADER_MIPMAPCOUNT];var width=header[PVR_HEADER_WIDTH];var height=header[PVR_HEADER_HEIGHT];this._width=width;this._height=height;var dataOffset=header[PVR_HEADER_METADATA]+52;this._upLoadCompressedTexImage2D(arrayBuffer,width,height,mipLevels,dataOffset,0);};_proto21._upLoadCompressedTexImage2D=function _upLoadCompressedTexImage2D(data,width,height,miplevelCount,dataOffset,imageSizeOffset){var gl=LayaGL.instance;var textureType=this._glTextureType;WebGLContext.bindTexture(gl,textureType,this._glTexture);var glFormat=this._getGLFormat();var offset=dataOffset;for(var i=0;i<miplevelCount;i++){offset+=imageSizeOffset;var mipDataSize=this._calcualatesCompressedDataSize(this._format,width,height);var mipData=new Uint8Array(data,offset,mipDataSize);gl.compressedTexImage2D(textureType,i,glFormat,width,height,0,mipData);width=Math.max(width>>1,1.0);height=Math.max(height>>1,1.0);offset+=mipDataSize;}var memory=offset;this._setGPUMemory(memory);this._readyed=true;this._activeResource();};_proto21.loadImageSource=function loadImageSource(source,premultiplyAlpha){if(premultiplyAlpha===void 0){premultiplyAlpha=false;}var gl=LayaGL.instance;var width=source.width;var height=source.height;this._width=width;this._height=height;if(!(this._isPot(width)&&this._isPot(height)))this._mipmap=false;this._setWarpMode(gl.TEXTURE_WRAP_S,this._wrapModeU);this._setWarpMode(gl.TEXTURE_WRAP_T,this._wrapModeV);this._setFilterMode(this._filterMode);WebGLContext.bindTexture(gl,this._glTextureType,this._glTexture);var glFormat=this._getGLFormat();if(ILaya.Render.isConchApp){if(source.setPremultiplyAlpha){source.setPremultiplyAlpha(premultiplyAlpha);}gl.texImage2D(this._glTextureType,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,source);}else {premultiplyAlpha&&gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);if(this.format==exports.TextureFormat.R5G6B5)gl.texImage2D(this._glTextureType,0,gl.RGB,gl.RGB,gl.UNSIGNED_SHORT_5_6_5,source);else gl.texImage2D(this._glTextureType,0,glFormat,glFormat,gl.UNSIGNED_BYTE,source);premultiplyAlpha&&gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,false);}if(this._mipmap){gl.generateMipmap(this._glTextureType);this._setGPUMemory(width*height*4*(1+1/3));}else {this._setGPUMemory(width*height*4);}if(this._canRead){if(ILaya.Render.isConchApp){this._pixels=new Uint8Array(source._nativeObj.getImageData(0,0,width,height));}else {ILaya.Browser.canvas.size(width,height);ILaya.Browser.canvas.clear();ILaya.Browser.context.drawImage(source,0,0,width,height);this._pixels=new Uint8Array(ILaya.Browser.context.getImageData(0,0,width,height).data.buffer);}}this._readyed=true;this._activeResource();};_proto21.setPixels=function setPixels(pixels,miplevel){if(miplevel===void 0){miplevel=0;}if(this._gpuCompressFormat())throw "Texture2D:the format is GPU compression format.";if(!pixels)throw "Texture2D:pixels can't be null.";var width=Math.max(this._width>>miplevel,1);var height=Math.max(this._height>>miplevel,1);var pixelsCount=width*height*this._getFormatByteCount();if(pixels.length<pixelsCount)throw "Texture2D:pixels length should at least "+pixelsCount+".";this._setPixels(pixels,miplevel,width,height);if(this._canRead)this._pixels=pixels;this._readyed=true;this._activeResource();};_proto21.setSubPixels=function setSubPixels(x,y,width,height,pixels,miplevel){if(miplevel===void 0){miplevel=0;}if(this._gpuCompressFormat())throw "Texture2D:the format is GPU compression format.";if(!pixels)throw "Texture2D:pixels can't be null.";var gl=LayaGL.instance;var textureType=this._glTextureType;WebGLContext.bindTexture(gl,textureType,this._glTexture);var glFormat=this._getGLFormat();switch(this.format){case exports.TextureFormat.R8G8B8:gl.pixelStorei(gl.UNPACK_ALIGNMENT,1);gl.texSubImage2D(textureType,miplevel,x,y,width,height,glFormat,gl.UNSIGNED_BYTE,pixels);gl.pixelStorei(gl.UNPACK_ALIGNMENT,4);break;case exports.TextureFormat.R5G6B5:gl.pixelStorei(gl.UNPACK_ALIGNMENT,2);gl.texSubImage2D(textureType,miplevel,x,y,width,height,glFormat,gl.UNSIGNED_SHORT_5_6_5,pixels);gl.pixelStorei(gl.UNPACK_ALIGNMENT,4);break;case exports.TextureFormat.R32G32B32A32:gl.texSubImage2D(textureType,miplevel,x,y,width,height,glFormat,gl.FLOAT,pixels);break;default:gl.texSubImage2D(textureType,miplevel,x,y,width,height,glFormat,gl.UNSIGNED_BYTE,pixels);}this._readyed=true;this._activeResource();};_proto21.setCompressData=function setCompressData(data){switch(this._format){case exports.TextureFormat.DXT1:case exports.TextureFormat.DXT5:this._pharseDDS(data);break;case exports.TextureFormat.ETC1RGB:this._pharseKTX(data);break;case exports.TextureFormat.PVRTCRGB_2BPPV:case exports.TextureFormat.PVRTCRGBA_2BPPV:case exports.TextureFormat.PVRTCRGB_4BPPV:case exports.TextureFormat.PVRTCRGBA_4BPPV:this._pharsePVR(data);break;default:throw "Texture2D:unkonwn format.";}};_proto21.getPixels=function getPixels(){if(this._canRead)return this._pixels;else throw new Error("Texture2D: must set texture canRead is true.");};_createClass(Texture2D,[{key:"defaulteTexture",get:function get(){return Texture2D.grayTexture;}}]);return Texture2D;}(BaseTexture);Texture2D.TEXTURE2D="TEXTURE2D";Texture2D.grayTexture=null;Texture2D.whiteTexture=null;Texture2D.blackTexture=null;var BaseShader=/*#__PURE__*/function(_Resource2){_inheritsLoose(BaseShader,_Resource2);function BaseShader(){return _Resource2.call(this)||this;}return BaseShader;}(Resource);var RenderState2D=/*#__PURE__*/function(){function RenderState2D(){}RenderState2D.mat2MatArray=function mat2MatArray(mat,matArray){var m=mat;var m4=matArray;m4[0]=m.a;m4[1]=m.b;m4[2]=RenderState2D.EMPTYMAT4_ARRAY[2];m4[3]=RenderState2D.EMPTYMAT4_ARRAY[3];m4[4]=m.c;m4[5]=m.d;m4[6]=RenderState2D.EMPTYMAT4_ARRAY[6];m4[7]=RenderState2D.EMPTYMAT4_ARRAY[7];m4[8]=RenderState2D.EMPTYMAT4_ARRAY[8];m4[9]=RenderState2D.EMPTYMAT4_ARRAY[9];m4[10]=RenderState2D.EMPTYMAT4_ARRAY[10];m4[11]=RenderState2D.EMPTYMAT4_ARRAY[11];m4[12]=m.tx;m4[13]=m.ty;m4[14]=RenderState2D.EMPTYMAT4_ARRAY[14];m4[15]=RenderState2D.EMPTYMAT4_ARRAY[15];return matArray;};RenderState2D.restoreTempArray=function restoreTempArray(){RenderState2D.TEMPMAT4_ARRAY[0]=1;RenderState2D.TEMPMAT4_ARRAY[1]=0;RenderState2D.TEMPMAT4_ARRAY[4]=0;RenderState2D.TEMPMAT4_ARRAY[5]=1;RenderState2D.TEMPMAT4_ARRAY[12]=0;RenderState2D.TEMPMAT4_ARRAY[13]=0;};RenderState2D.clear=function clear(){RenderState2D.worldScissorTest=false;RenderState2D.worldAlpha=1;};return RenderState2D;}();RenderState2D._MAXSIZE=99999999;RenderState2D.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];RenderState2D.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];RenderState2D.worldMatrix4=RenderState2D.TEMPMAT4_ARRAY;RenderState2D.worldMatrix=new Matrix();RenderState2D.matWVP=null;RenderState2D.worldAlpha=1.0;RenderState2D.worldScissorTest=false;RenderState2D.width=0;RenderState2D.height=0;(function(RenderTextureFormat){RenderTextureFormat[RenderTextureFormat["R8G8B8"]=0]="R8G8B8";RenderTextureFormat[RenderTextureFormat["R8G8B8A8"]=1]="R8G8B8A8";RenderTextureFormat[RenderTextureFormat["Alpha8"]=2]="Alpha8";RenderTextureFormat[RenderTextureFormat["R16G16B16A16"]=14]="R16G16B16A16";RenderTextureFormat[RenderTextureFormat["Depth"]=15]="Depth";RenderTextureFormat[RenderTextureFormat["ShadowMap"]=16]="ShadowMap";})(exports.RenderTextureFormat||(exports.RenderTextureFormat={}));(function(RenderTextureDepthFormat){RenderTextureDepthFormat[RenderTextureDepthFormat["DEPTH_16"]=0]="DEPTH_16";RenderTextureDepthFormat[RenderTextureDepthFormat["STENCIL_8"]=1]="STENCIL_8";RenderTextureDepthFormat[RenderTextureDepthFormat["DEPTHSTENCIL_24_8"]=2]="DEPTHSTENCIL_24_8";RenderTextureDepthFormat[RenderTextureDepthFormat["DEPTHSTENCIL_NONE"]=3]="DEPTHSTENCIL_NONE";RenderTextureDepthFormat[RenderTextureDepthFormat["DEPTHSTENCIL_16_8"]=2]="DEPTHSTENCIL_16_8";})(exports.RenderTextureDepthFormat||(exports.RenderTextureDepthFormat={}));var RenderTexture2D=/*#__PURE__*/function(_BaseTexture2){_inheritsLoose(RenderTexture2D,_BaseTexture2);function RenderTexture2D(width,height,format,depthStencilFormat){var _this6;if(format===void 0){format=exports.RenderTextureFormat.R8G8B8;}if(depthStencilFormat===void 0){depthStencilFormat=exports.RenderTextureDepthFormat.DEPTH_16;}_this6=_BaseTexture2.call(this,format,false)||this;_this6._mgrKey=0;_this6._glTextureType=LayaGL.instance.TEXTURE_2D;_this6._width=width;_this6._height=height;_this6._depthStencilFormat=depthStencilFormat;_this6._create(width,height);_this6.lock=true;return _this6;}var _proto22=RenderTexture2D.prototype;_proto22.getIsReady=function getIsReady(){return true;};_proto22._create=function _create(width,height){var gl=LayaGL.instance;this._frameBuffer=gl.createFramebuffer();WebGLContext.bindTexture(gl,this._glTextureType,this._glTexture);var glFormat=this._getGLFormat();gl.texImage2D(this._glTextureType,0,glFormat,width,height,0,glFormat,gl.UNSIGNED_BYTE,null);this._setGPUMemory(width*height*4);gl.bindFramebuffer(gl.FRAMEBUFFER,this._frameBuffer);gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,this._glTexture,0);if(this._depthStencilFormat!==exports.RenderTextureDepthFormat.DEPTHSTENCIL_NONE){this._depthStencilBuffer=gl.createRenderbuffer();gl.bindRenderbuffer(gl.RENDERBUFFER,this._depthStencilBuffer);switch(this._depthStencilFormat){case exports.RenderTextureDepthFormat.DEPTH_16:gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_COMPONENT16,width,height);gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_ATTACHMENT,gl.RENDERBUFFER,this._depthStencilBuffer);break;case exports.RenderTextureDepthFormat.STENCIL_8:gl.renderbufferStorage(gl.RENDERBUFFER,gl.STENCIL_INDEX8,width,height);gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.STENCIL_ATTACHMENT,gl.RENDERBUFFER,this._depthStencilBuffer);break;case exports.RenderTextureDepthFormat.DEPTHSTENCIL_24_8:gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,width,height);gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_STENCIL_ATTACHMENT,gl.RENDERBUFFER,this._depthStencilBuffer);break;}}gl.bindFramebuffer(gl.FRAMEBUFFER,null);gl.bindRenderbuffer(gl.RENDERBUFFER,null);this._setWarpMode(gl.TEXTURE_WRAP_S,this._wrapModeU);this._setWarpMode(gl.TEXTURE_WRAP_T,this._wrapModeV);this._setFilterMode(this._filterMode);this._setAnisotropy(this._anisoLevel);this._readyed=true;this._activeResource();};_proto22.generateMipmap=function generateMipmap(){if(this._isPot(this.width)&&this._isPot(this.height)){this._mipmap=true;LayaGL.instance.generateMipmap(this._glTextureType);this._setFilterMode(this._filterMode);this._setGPUMemory(this.width*this.height*4*(1+1/3));}else {this._mipmap=false;this._setGPUMemory(this.width*this.height*4);}};RenderTexture2D.pushRT=function pushRT(){RenderTexture2D.rtStack.push({rt:RenderTexture2D._currentActive,w:RenderState2D.width,h:RenderState2D.height});};RenderTexture2D.popRT=function popRT(){var gl=LayaGL.instance;var top=RenderTexture2D.rtStack.pop();if(top){if(RenderTexture2D._currentActive!=top.rt){LayaGL.instance.bindFramebuffer(gl.FRAMEBUFFER,top.rt?top.rt._frameBuffer:null);RenderTexture2D._currentActive=top.rt;}gl.viewport(0,0,top.w,top.h);RenderState2D.width=top.w;RenderState2D.height=top.h;}};_proto22.start=function start(){var gl=LayaGL.instance;LayaGL.instance.bindFramebuffer(gl.FRAMEBUFFER,this._frameBuffer);this._lastRT=RenderTexture2D._currentActive;RenderTexture2D._currentActive=this;this._readyed=true;gl.viewport(0,0,this._width,this._height);this._lastWidth=RenderState2D.width;this._lastHeight=RenderState2D.height;RenderState2D.width=this._width;RenderState2D.height=this._height;BaseShader.activeShader=null;};_proto22.end=function end(){var gl=LayaGL.instance;gl.bindFramebuffer(gl.FRAMEBUFFER,null);RenderTexture2D._currentActive=null;this._readyed=true;};_proto22.restore=function restore(){var gl=LayaGL.instance;if(this._lastRT!=RenderTexture2D._currentActive){LayaGL.instance.bindFramebuffer(gl.FRAMEBUFFER,this._lastRT?this._lastRT._frameBuffer:null);RenderTexture2D._currentActive=this._lastRT;}this._readyed=true;gl.viewport(0,0,this._lastWidth,this._lastHeight);RenderState2D.width=this._lastWidth;RenderState2D.height=this._lastHeight;BaseShader.activeShader=null;};_proto22.clear=function clear(r,g,b,a){if(r===void 0){r=0.0;}if(g===void 0){g=0.0;}if(b===void 0){b=0.0;}if(a===void 0){a=1.0;}var gl=LayaGL.instance;gl.clearColor(r,g,b,a);var clearFlag=gl.COLOR_BUFFER_BIT;switch(this._depthStencilFormat){case gl.DEPTH_COMPONENT16:clearFlag|=gl.DEPTH_BUFFER_BIT;break;case gl.STENCIL_INDEX8:clearFlag|=gl.STENCIL_BUFFER_BIT;break;case gl.DEPTH_STENCIL:clearFlag|=gl.DEPTH_BUFFER_BIT;clearFlag|=gl.STENCIL_BUFFER_BIT;break;}gl.clear(clearFlag);};_proto22.getData=function getData(x,y,width,height){if(ILaya.Render.isConchApp&&window.conchConfig.threadMode==2){throw "native 2 thread mode use getDataAsync";}var gl=LayaGL.instance;gl.bindFramebuffer(gl.FRAMEBUFFER,this._frameBuffer);var canRead=gl.checkFramebufferStatus(gl.FRAMEBUFFER)===gl.FRAMEBUFFER_COMPLETE;if(!canRead){gl.bindFramebuffer(gl.FRAMEBUFFER,null);return null;}var pixels=new Uint8Array(this._width*this._height*4);var glFormat=this._getGLFormat();gl.readPixels(x,y,width,height,glFormat,gl.UNSIGNED_BYTE,pixels);gl.bindFramebuffer(gl.FRAMEBUFFER,null);return pixels;};_proto22.getDataAsync=function getDataAsync(x,y,width,height,callBack){var gl=LayaGL.instance;gl.bindFramebuffer(gl.FRAMEBUFFER,this._frameBuffer);gl.readPixelsAsync(x,y,width,height,gl.RGBA,gl.UNSIGNED_BYTE,function(data){callBack(new Uint8Array(data));});gl.bindFramebuffer(gl.FRAMEBUFFER,null);};_proto22.recycle=function recycle(){};_proto22._disposeResource=function _disposeResource(){if(this._frameBuffer){var gl=LayaGL.instance;gl.deleteTexture(this._glTexture);gl.deleteFramebuffer(this._frameBuffer);gl.deleteRenderbuffer(this._depthStencilBuffer);this._glTexture=null;this._frameBuffer=null;this._depthStencilBuffer=null;this._setGPUMemory(0);}};_createClass(RenderTexture2D,[{key:"depthStencilFormat",get:function get(){return this._depthStencilFormat;}},{key:"defaulteTexture",get:function get(){return Texture2D.grayTexture;}},{key:"sourceWidth",get:function get(){return this._width;}},{key:"sourceHeight",get:function get(){return this._height;}},{key:"offsetX",get:function get(){return 0;}},{key:"offsetY",get:function get(){return 0;}}],[{key:"currentActive",get:function get(){return RenderTexture2D._currentActive;}}]);return RenderTexture2D;}(BaseTexture);RenderTexture2D.rtStack=[];RenderTexture2D.defuv=[0,0,1,0,1,1,0,1];RenderTexture2D.flipyuv=[0,1,1,1,1,0,0,0];var WebGLRTMgr=/*#__PURE__*/function(){function WebGLRTMgr(){}WebGLRTMgr.getRT=function getRT(w,h){w=w|0;h=h|0;if(w>=10000){console.error('getRT error! w too big');}var ret;ret=new RenderTexture2D(w,h,exports.RenderTextureFormat.R8G8B8A8,-1);return ret;};WebGLRTMgr.releaseRT=function releaseRT(rt){rt.destroy();return;};return WebGLRTMgr;}();WebGLRTMgr.dict={};var BlendMode=/*#__PURE__*/function(){function BlendMode(){}BlendMode._init_=function _init_(gl){BlendMode.fns=[BlendMode.BlendNormal,BlendMode.BlendAdd,BlendMode.BlendMultiply,BlendMode.BlendScreen,BlendMode.BlendOverlay,BlendMode.BlendLight,BlendMode.BlendMask,BlendMode.BlendDestinationOut];BlendMode.targetFns=[BlendMode.BlendNormalTarget,BlendMode.BlendAddTarget,BlendMode.BlendMultiplyTarget,BlendMode.BlendScreenTarget,BlendMode.BlendOverlayTarget,BlendMode.BlendLightTarget,BlendMode.BlendMask,BlendMode.BlendDestinationOut];};BlendMode.BlendNormal=function BlendNormal(gl){WebGLContext.setBlendFunc(gl,gl.ONE,gl.ONE_MINUS_SRC_ALPHA,true);};BlendMode.BlendAdd=function BlendAdd(gl){WebGLContext.setBlendFunc(gl,gl.ONE,gl.DST_ALPHA,true);};BlendMode.BlendMultiply=function BlendMultiply(gl){WebGLContext.setBlendFunc(gl,gl.DST_COLOR,gl.ONE_MINUS_SRC_ALPHA,true);};BlendMode.BlendScreen=function BlendScreen(gl){WebGLContext.setBlendFunc(gl,gl.ONE,gl.ONE,true);};BlendMode.BlendOverlay=function BlendOverlay(gl){WebGLContext.setBlendFunc(gl,gl.ONE,gl.ONE_MINUS_SRC_COLOR,true);};BlendMode.BlendLight=function BlendLight(gl){WebGLContext.setBlendFunc(gl,gl.ONE,gl.ONE,true);};BlendMode.BlendNormalTarget=function BlendNormalTarget(gl){WebGLContext.setBlendFunc(gl,gl.ONE,gl.ONE_MINUS_SRC_ALPHA,true);};BlendMode.BlendAddTarget=function BlendAddTarget(gl){WebGLContext.setBlendFunc(gl,gl.ONE,gl.DST_ALPHA,true);};BlendMode.BlendMultiplyTarget=function BlendMultiplyTarget(gl){WebGLContext.setBlendFunc(gl,gl.DST_COLOR,gl.ONE_MINUS_SRC_ALPHA,true);};BlendMode.BlendScreenTarget=function BlendScreenTarget(gl){WebGLContext.setBlendFunc(gl,gl.ONE,gl.ONE,true);};BlendMode.BlendOverlayTarget=function BlendOverlayTarget(gl){WebGLContext.setBlendFunc(gl,gl.ONE,gl.ONE_MINUS_SRC_COLOR,true);};BlendMode.BlendLightTarget=function BlendLightTarget(gl){WebGLContext.setBlendFunc(gl,gl.ONE,gl.ONE,true);};BlendMode.BlendMask=function BlendMask(gl){WebGLContext.setBlendFunc(gl,gl.ZERO,gl.SRC_ALPHA,true);};BlendMode.BlendDestinationOut=function BlendDestinationOut(gl){WebGLContext.setBlendFunc(gl,gl.ZERO,gl.ZERO,true);};return BlendMode;}();BlendMode.activeBlendFunction=null;BlendMode.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"];BlendMode.TOINT={"normal":0,"add":1,"multiply":2,"screen":3,"overlay":4,"light":5,"mask":6,"destination-out":7,"lighter":1};BlendMode.NORMAL="normal";BlendMode.ADD="add";BlendMode.MULTIPLY="multiply";BlendMode.SCREEN="screen";BlendMode.OVERLAY="overlay";BlendMode.LIGHT="light";BlendMode.MASK="mask";BlendMode.DESTINATIONOUT="destination-out";BlendMode.LIGHTER="lighter";BlendMode.fns=[];BlendMode.targetFns=[];var ShaderDefinesBase=/*#__PURE__*/function(){function ShaderDefinesBase(name2int,int2name,int2nameMap){this._value=0;this._name2int=name2int;this._int2name=int2name;this._int2nameMap=int2nameMap;}var _proto23=ShaderDefinesBase.prototype;_proto23.add=function add(value){if(typeof value=='string'){this._value|=this._name2int[value];}else {this._value|=value;}return this._value;};_proto23.addInt=function addInt(value){this._value|=value;return this._value;};_proto23.remove=function remove(value){if(typeof value=='string'){this._value&=~this._name2int[value];}else {this._value&=~value;}return this._value;};_proto23.isDefine=function isDefine(def){return (this._value&def)===def;};_proto23.getValue=function getValue(){return this._value;};_proto23.setValue=function setValue(value){this._value=value;};_proto23.toNameDic=function toNameDic(){var r=this._int2nameMap[this._value];return r?r:ShaderDefinesBase._toText(this._value,this._int2name,this._int2nameMap);};ShaderDefinesBase._reg=function _reg(name,value,_name2int,_int2name){_name2int[name]=value;_int2name[value]=name;};ShaderDefinesBase._toText=function _toText(value,_int2name,_int2nameMap){var r=_int2nameMap[value];if(r)return r;var o={};var d=1;for(var i=0;i<32;i++){d=1<<i;if(d>value)break;if(value&d){var name=_int2name[d];name&&(o[name]="");}}_int2nameMap[value]=o;return o;};ShaderDefinesBase._toInt=function _toInt(names,_name2int){var words=names.split('.');var num=0;for(var i=0,n=words.length;i<n;i++){var value=_name2int[words[i]];if(!value)throw new Error("Defines to int err:"+names+"/"+words[i]);num|=value;}return num;};return ShaderDefinesBase;}();var ShaderDefines2D=/*#__PURE__*/function(_ShaderDefinesBase){_inheritsLoose(ShaderDefines2D,_ShaderDefinesBase);function ShaderDefines2D(){return _ShaderDefinesBase.call(this,ShaderDefines2D.__name2int,ShaderDefines2D.__int2name,ShaderDefines2D.__int2nameMap)||this;}ShaderDefines2D.__init__=function __init__(){ShaderDefines2D.reg("TEXTURE2D",ShaderDefines2D.TEXTURE2D);ShaderDefines2D.reg("PRIMITIVE",ShaderDefines2D.PRIMITIVE);ShaderDefines2D.reg("GLOW_FILTER",ShaderDefines2D.FILTERGLOW);ShaderDefines2D.reg("BLUR_FILTER",ShaderDefines2D.FILTERBLUR);ShaderDefines2D.reg("COLOR_FILTER",ShaderDefines2D.FILTERCOLOR);ShaderDefines2D.reg("COLOR_ADD",ShaderDefines2D.COLORADD);ShaderDefines2D.reg("WORLDMAT",ShaderDefines2D.WORLDMAT);ShaderDefines2D.reg("FILLTEXTURE",ShaderDefines2D.FILLTEXTURE);ShaderDefines2D.reg('MVP3D',ShaderDefines2D.MVP3D);};ShaderDefines2D.reg=function reg(name,value){this._reg(name,value,ShaderDefines2D.__name2int,ShaderDefines2D.__int2name);};ShaderDefines2D.toText=function toText(value,int2name,int2nameMap){return this._toText(value,int2name,int2nameMap);};ShaderDefines2D.toInt=function toInt(names){return this._toInt(names,ShaderDefines2D.__name2int);};return ShaderDefines2D;}(ShaderDefinesBase);ShaderDefines2D.TEXTURE2D=0x01;ShaderDefines2D.PRIMITIVE=0x04;ShaderDefines2D.FILTERGLOW=0x08;ShaderDefines2D.FILTERBLUR=0x10;ShaderDefines2D.FILTERCOLOR=0x20;ShaderDefines2D.COLORADD=0x40;ShaderDefines2D.WORLDMAT=0x80;ShaderDefines2D.FILLTEXTURE=0x100;ShaderDefines2D.SKINMESH=0x200;ShaderDefines2D.MVP3D=0x800;ShaderDefines2D.NOOPTMASK=ShaderDefines2D.FILTERGLOW|ShaderDefines2D.FILTERBLUR|ShaderDefines2D.FILTERCOLOR|ShaderDefines2D.FILLTEXTURE;ShaderDefines2D.__name2int={};ShaderDefines2D.__int2name=[];ShaderDefines2D.__int2nameMap=[];var Stat=/*#__PURE__*/function(){function Stat(){}Stat.show=function show(x,y){if(x===void 0){x=0;}if(y===void 0){y=0;}Stat._StatRender.show(x,y);};Stat.enable=function enable(){Stat._StatRender.enable();};Stat.hide=function hide(){Stat._StatRender.hide();};Stat.clear=function clear(){Stat.trianglesFaces=Stat.renderBatches=Stat.savedRenderBatches=Stat.shaderCall=Stat.spriteRenderUseCacheCount=Stat.frustumCulling=Stat.octreeNodeCulling=Stat.canvasNormal=Stat.canvasBitmap=Stat.canvasReCache=0;};_createClass(Stat,null,[{key:"onclick",set:function set(fn){Stat._StatRender.set_onclick(fn);}}]);return Stat;}();Stat.FPS=0;Stat.loopCount=0;Stat.shaderCall=0;Stat.renderBatches=0;Stat.savedRenderBatches=0;Stat.trianglesFaces=0;Stat.spriteCount=0;Stat.spriteRenderUseCacheCount=0;Stat.frustumCulling=0;Stat.octreeNodeCulling=0;Stat.canvasNormal=0;Stat.canvasBitmap=0;Stat.canvasReCache=0;Stat.renderSlow=false;Stat._fpsData=[];Stat._timer=0;Stat._count=0;Stat._StatRender=null;var StringKey=/*#__PURE__*/function(){function StringKey(){this._strsToID={};this._idToStrs=[];this._length=0;}var _proto24=StringKey.prototype;_proto24.add=function add(str){var index=this._strsToID[str];if(index!=null)return index;this._idToStrs[this._length]=str;return this._strsToID[str]=this._length++;};_proto24.getID=function getID(str){var index=this._strsToID[str];return index==null?-1:index;};_proto24.getName=function getName(id){var str=this._idToStrs[id];return str==null?undefined:str;};return StringKey;}();var Shader=/*#__PURE__*/function(_BaseShader){_inheritsLoose(Shader,_BaseShader);function Shader(vs,ps,saveName,nameMap,bindAttrib){var _this7;if(saveName===void 0){saveName=null;}if(nameMap===void 0){nameMap=null;}if(bindAttrib===void 0){bindAttrib=null;}_this7=_BaseShader.call(this)||this;_this7._attribInfo=null;_this7.customCompile=false;_this7._curActTexIndex=0;_this7.tag={};_this7._program=null;_this7._params=null;_this7._paramsMap={};if(!vs||!ps)throw "Shader Error";_this7._attribInfo=bindAttrib;_this7._id=++Shader._count;_this7._vs=vs;_this7._ps=ps;_this7._nameMap=nameMap?nameMap:{};saveName!=null&&(Shader.sharders[saveName]=_assertThisInitialized(_this7));_this7.recreateResource();_this7.lock=true;return _this7;}Shader.getShader=function getShader(name){return Shader.sharders[name];};Shader.create=function create(vs,ps,saveName,nameMap,bindAttrib){if(saveName===void 0){saveName=null;}if(nameMap===void 0){nameMap=null;}if(bindAttrib===void 0){bindAttrib=null;}return new Shader(vs,ps,saveName,nameMap,bindAttrib);};Shader.withCompile=function withCompile(nameID,define,shaderName,createShader){if(shaderName&&Shader.sharders[shaderName])return Shader.sharders[shaderName];var pre=Shader._preCompileShader[Shader.SHADERNAME2ID*nameID];if(!pre)throw new Error("withCompile shader err!"+nameID);return pre.createShader(define,shaderName,createShader,null);};Shader.withCompile2D=function withCompile2D(nameID,mainID,define,shaderName,createShader,bindAttrib){if(bindAttrib===void 0){bindAttrib=null;}if(shaderName&&Shader.sharders[shaderName])return Shader.sharders[shaderName];var pre=Shader._preCompileShader[Shader.SHADERNAME2ID*nameID+mainID];if(!pre)throw new Error("withCompile shader err!"+nameID+" "+mainID);return pre.createShader(define,shaderName,createShader,bindAttrib);};Shader.addInclude=function addInclude(fileName,txt){ILaya.ShaderCompile.addInclude(fileName,txt);};Shader.preCompile=function preCompile(nameID,vs,ps,nameMap){var id=Shader.SHADERNAME2ID*nameID;Shader._preCompileShader[id]=new ILaya.ShaderCompile(vs,ps,nameMap);};Shader.preCompile2D=function preCompile2D(nameID,mainID,vs,ps,nameMap){var id=Shader.SHADERNAME2ID*nameID+mainID;Shader._preCompileShader[id]=new ILaya.ShaderCompile(vs,ps,nameMap);};var _proto25=Shader.prototype;_proto25.recreateResource=function recreateResource(){this._compile();this._setGPUMemory(0);};_proto25._disposeResource=function _disposeResource(){WebGLContext.mainContext.deleteShader(this._vshader);WebGLContext.mainContext.deleteShader(this._pshader);WebGLContext.mainContext.deleteProgram(this._program);this._vshader=this._pshader=this._program=null;this._params=null;this._paramsMap={};this._setGPUMemory(0);this._curActTexIndex=0;};_proto25._compile=function _compile(){if(!this._vs||!this._ps||this._params)return;this._reCompile=true;this._params=[];var result;if(this.customCompile)result=ILaya.ShaderCompile.preGetParams(this._vs,this._ps);var gl=WebGLContext.mainContext;this._program=gl.createProgram();this._vshader=Shader._createShader(gl,this._vs,gl.VERTEX_SHADER);this._pshader=Shader._createShader(gl,this._ps,gl.FRAGMENT_SHADER);gl.attachShader(this._program,this._vshader);gl.attachShader(this._program,this._pshader);var one,i,n,location;var attribDescNum=this._attribInfo?this._attribInfo.length:0;for(i=0;i<attribDescNum;i+=2){gl.bindAttribLocation(this._program,this._attribInfo[i+1],this._attribInfo[i]);}gl.linkProgram(this._program);if(!this.customCompile&&!gl.getProgramParameter(this._program,gl.LINK_STATUS)){throw gl.getProgramInfoLog(this._program);}var nUniformNum=this.customCompile?result.uniforms.length:gl.getProgramParameter(this._program,gl.ACTIVE_UNIFORMS);for(i=0;i<nUniformNum;i++){var uniform=this.customCompile?result.uniforms[i]:gl.getActiveUniform(this._program,i);location=gl.getUniformLocation(this._program,uniform.name);one={vartype:"uniform",glfun:null,ivartype:1,location:location,name:uniform.name,type:uniform.type,isArray:false,isSame:false,preValue:null,indexOfParams:0};if(one.name.indexOf('[0]')>0){one.name=one.name.substr(0,one.name.length-3);one.isArray=true;one.location=gl.getUniformLocation(this._program,one.name);}this._params.push(one);}for(i=0,n=this._params.length;i<n;i++){one=this._params[i];one.indexOfParams=i;one.index=1;one.value=[one.location,null];one.codename=one.name;one.name=this._nameMap[one.codename]?this._nameMap[one.codename]:one.codename;this._paramsMap[one.name]=one;one._this=this;one.uploadedValue=[];switch(one.type){case gl.INT:one.fun=one.isArray?this._uniform1iv:this._uniform1i;break;case gl.FLOAT:one.fun=one.isArray?this._uniform1fv:this._uniform1f;break;case gl.FLOAT_VEC2:one.fun=one.isArray?this._uniform_vec2v:this._uniform_vec2;break;case gl.FLOAT_VEC3:one.fun=one.isArray?this._uniform_vec3v:this._uniform_vec3;break;case gl.FLOAT_VEC4:one.fun=one.isArray?this._uniform_vec4v:this._uniform_vec4;break;case gl.SAMPLER_2D:one.fun=this._uniform_sampler2D;break;case gl.SAMPLER_CUBE:one.fun=this._uniform_samplerCube;break;case gl.FLOAT_MAT4:one.glfun=gl.uniformMatrix4fv;one.fun=this._uniformMatrix4fv;break;case gl.BOOL:one.fun=this._uniform1i;break;case gl.FLOAT_MAT2:case gl.FLOAT_MAT3:throw new Error("compile shader err!");default:throw new Error("compile shader err!");}}};Shader._createShader=function _createShader(gl,str,type){var shader=gl.createShader(type);gl.shaderSource(shader,str);gl.compileShader(shader);if(gl.getShaderParameter(shader,gl.COMPILE_STATUS)){return shader;}else {console.log(gl.getShaderInfoLog(shader));return null;}};_proto25.getUniform=function getUniform(name){return this._paramsMap[name];};_proto25._uniform1f=function _uniform1f(one,value){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value){WebGLContext.mainContext.uniform1f(one.location,uploadedValue[0]=value);return 1;}return 0;};_proto25._uniform1fv=function _uniform1fv(one,value){if(value.length<4){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value[0]||uploadedValue[1]!==value[1]||uploadedValue[2]!==value[2]||uploadedValue[3]!==value[3]){WebGLContext.mainContext.uniform1fv(one.location,value);uploadedValue[0]=value[0];uploadedValue[1]=value[1];uploadedValue[2]=value[2];uploadedValue[3]=value[3];return 1;}return 0;}else {WebGLContext.mainContext.uniform1fv(one.location,value);return 1;}};_proto25._uniform_vec2=function _uniform_vec2(one,value){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value[0]||uploadedValue[1]!==value[1]){WebGLContext.mainContext.uniform2f(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1]);return 1;}return 0;};_proto25._uniform_vec2v=function _uniform_vec2v(one,value){if(value.length<2){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value[0]||uploadedValue[1]!==value[1]||uploadedValue[2]!==value[2]||uploadedValue[3]!==value[3]){WebGLContext.mainContext.uniform2fv(one.location,value);uploadedValue[0]=value[0];uploadedValue[1]=value[1];uploadedValue[2]=value[2];uploadedValue[3]=value[3];return 1;}return 0;}else {WebGLContext.mainContext.uniform2fv(one.location,value);return 1;}};_proto25._uniform_vec3=function _uniform_vec3(one,value){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value[0]||uploadedValue[1]!==value[1]||uploadedValue[2]!==value[2]){WebGLContext.mainContext.uniform3f(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2]);return 1;}return 0;};_proto25._uniform_vec3v=function _uniform_vec3v(one,value){WebGLContext.mainContext.uniform3fv(one.location,value);return 1;};_proto25._uniform_vec4=function _uniform_vec4(one,value){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value[0]||uploadedValue[1]!==value[1]||uploadedValue[2]!==value[2]||uploadedValue[3]!==value[3]){WebGLContext.mainContext.uniform4f(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2],uploadedValue[3]=value[3]);return 1;}return 0;};_proto25._uniform_vec4v=function _uniform_vec4v(one,value){WebGLContext.mainContext.uniform4fv(one.location,value);return 1;};_proto25._uniformMatrix2fv=function _uniformMatrix2fv(one,value){WebGLContext.mainContext.uniformMatrix2fv(one.location,false,value);return 1;};_proto25._uniformMatrix3fv=function _uniformMatrix3fv(one,value){WebGLContext.mainContext.uniformMatrix3fv(one.location,false,value);return 1;};_proto25._uniformMatrix4fv=function _uniformMatrix4fv(one,value){WebGLContext.mainContext.uniformMatrix4fv(one.location,false,value);return 1;};_proto25._uniform1i=function _uniform1i(one,value){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value){WebGLContext.mainContext.uniform1i(one.location,uploadedValue[0]=value);return 1;}return 0;};_proto25._uniform1iv=function _uniform1iv(one,value){WebGLContext.mainContext.uniform1iv(one.location,value);return 1;};_proto25._uniform_ivec2=function _uniform_ivec2(one,value){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value[0]||uploadedValue[1]!==value[1]){WebGLContext.mainContext.uniform2i(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1]);return 1;}return 0;};_proto25._uniform_ivec2v=function _uniform_ivec2v(one,value){WebGLContext.mainContext.uniform2iv(one.location,value);return 1;};_proto25._uniform_vec3i=function _uniform_vec3i(one,value){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value[0]||uploadedValue[1]!==value[1]||uploadedValue[2]!==value[2]){WebGLContext.mainContext.uniform3i(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2]);return 1;}return 0;};_proto25._uniform_vec3vi=function _uniform_vec3vi(one,value){WebGLContext.mainContext.uniform3iv(one.location,value);return 1;};_proto25._uniform_vec4i=function _uniform_vec4i(one,value){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value[0]||uploadedValue[1]!==value[1]||uploadedValue[2]!==value[2]||uploadedValue[3]!==value[3]){WebGLContext.mainContext.uniform4i(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2],uploadedValue[3]=value[3]);return 1;}return 0;};_proto25._uniform_vec4vi=function _uniform_vec4vi(one,value){WebGLContext.mainContext.uniform4iv(one.location,value);return 1;};_proto25._uniform_sampler2D=function _uniform_sampler2D(one,value){var gl=WebGLContext.mainContext;var uploadedValue=one.uploadedValue;if(uploadedValue[0]==null){uploadedValue[0]=this._curActTexIndex;gl.uniform1i(one.location,this._curActTexIndex);WebGLContext.activeTexture(gl,gl.TEXTURE0+this._curActTexIndex);WebGLContext.bindTexture(gl,gl.TEXTURE_2D,value);this._curActTexIndex++;return 1;}else {WebGLContext.activeTexture(gl,gl.TEXTURE0+uploadedValue[0]);WebGLContext.bindTexture(gl,gl.TEXTURE_2D,value);return 0;}};_proto25._uniform_samplerCube=function _uniform_samplerCube(one,value){var gl=WebGLContext.mainContext;var uploadedValue=one.uploadedValue;if(uploadedValue[0]==null){uploadedValue[0]=this._curActTexIndex;gl.uniform1i(one.location,this._curActTexIndex);WebGLContext.activeTexture(gl,gl.TEXTURE0+this._curActTexIndex);WebGLContext.bindTexture(gl,gl.TEXTURE_CUBE_MAP,value);this._curActTexIndex++;return 1;}else {WebGLContext.activeTexture(gl,gl.TEXTURE0+uploadedValue[0]);WebGLContext.bindTexture(gl,gl.TEXTURE_CUBE_MAP,value);return 0;}};_proto25._noSetValue=function _noSetValue(one){console.log("no....:"+one.name);};_proto25.uploadOne=function uploadOne(name,value){WebGLContext.useProgram(WebGLContext.mainContext,this._program);var one=this._paramsMap[name];one.fun.call(this,one,value);};_proto25.uploadTexture2D=function uploadTexture2D(value){var CTX=WebGLContext;if(CTX._activeTextures[0]!==value){CTX.bindTexture(WebGLContext.mainContext,LayaGL.instance.TEXTURE_2D,value);CTX._activeTextures[0]=value;}};_proto25.upload=function upload(shaderValue,params){if(params===void 0){params=null;}BaseShader.activeShader=BaseShader.bindShader=this;var gl=WebGLContext.mainContext;WebGLContext.useProgram(gl,this._program);if(this._reCompile){params=this._params;this._reCompile=false;}else {params=params||this._params;}var one,value,n=params.length,shaderCall=0;for(var i=0;i<n;i++){one=params[i];if((value=shaderValue[one.name])!==null)shaderCall+=one.fun.call(this,one,value);}Stat.shaderCall+=shaderCall;};_proto25.uploadArray=function uploadArray(shaderValue,length,_bufferUsage){BaseShader.activeShader=this;BaseShader.bindShader=this;WebGLContext.useProgram(WebGLContext.mainContext,this._program);var params=this._params,value;var one,shaderCall=0;for(var i=length-2;i>=0;i-=2){one=this._paramsMap[shaderValue[i]];if(!one)continue;value=shaderValue[i+1];if(value!=null){_bufferUsage&&_bufferUsage[one.name]&&_bufferUsage[one.name].bind();shaderCall+=one.fun.call(this,one,value);}}Stat.shaderCall+=shaderCall;};_proto25.getParams=function getParams(){return this._params;};_proto25.setAttributesLocation=function setAttributesLocation(attribDesc){this._attribInfo=attribDesc;};return Shader;}(BaseShader);Shader._count=0;Shader._preCompileShader={};Shader.SHADERNAME2ID=0.0002;Shader.nameKey=new StringKey();Shader.sharders=new Array(0x20);var Shader2X=/*#__PURE__*/function(_Shader){_inheritsLoose(Shader2X,_Shader);function Shader2X(vs,ps,saveName,nameMap,bindAttrib){var _this8;if(saveName===void 0){saveName=null;}if(nameMap===void 0){nameMap=null;}if(bindAttrib===void 0){bindAttrib=null;}_this8=_Shader.call(this,vs,ps,saveName,nameMap,bindAttrib)||this;_this8._params2dQuick2=null;_this8._shaderValueWidth=0;_this8._shaderValueHeight=0;return _this8;}var _proto26=Shader2X.prototype;_proto26._disposeResource=function _disposeResource(){_Shader.prototype._disposeResource.call(this);this._params2dQuick2=null;};_proto26.upload2dQuick2=function upload2dQuick2(shaderValue){this.upload(shaderValue,this._params2dQuick2||this._make2dQuick2());};_proto26._make2dQuick2=function _make2dQuick2(){if(!this._params2dQuick2){this._params2dQuick2=[];var params=this._params,one;for(var i=0,n=params.length;i<n;i++){one=params[i];if(one.name!=="size")this._params2dQuick2.push(one);}}return this._params2dQuick2;};Shader2X.create=function create(vs,ps,saveName,nameMap,bindAttrib){if(saveName===void 0){saveName=null;}if(nameMap===void 0){nameMap=null;}if(bindAttrib===void 0){bindAttrib=null;}return new Shader2X(vs,ps,saveName,nameMap,bindAttrib);};return Shader2X;}(Shader);var Value2D=/*#__PURE__*/function(){function Value2D(mainID,subID){this.defines=new ShaderDefines2D();this.size=[0,0];this.alpha=1.0;this.ALPHA=1.0;this.subID=0;this.ref=1;this._cacheID=0;this.clipMatDir=[ILaya.Context._MAXSIZE,0,0,ILaya.Context._MAXSIZE];this.clipMatPos=[0,0];this.clipOff=[0,0];this.mainID=mainID;this.subID=subID;this.textureHost=null;this.texture=null;this.color=null;this.colorAdd=null;this.u_mmat2=null;this._cacheID=mainID|subID;this._inClassCache=Value2D._cache[this._cacheID];if(mainID>0&&!this._inClassCache){this._inClassCache=Value2D._cache[this._cacheID]=[];this._inClassCache._length=0;}this.clear();}Value2D._initone=function _initone(type,classT){Value2D._typeClass[type]=classT;Value2D._cache[type]=[];Value2D._cache[type]._length=0;};Value2D.__init__=function __init__(){};var _proto27=Value2D.prototype;_proto27.setValue=function setValue(value){};_proto27._ShaderWithCompile=function _ShaderWithCompile(){var ret=Shader.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,Shader2X.create,this._attribLocation);return ret;};_proto27.upload=function upload(){var renderstate2d=RenderState2D;RenderState2D.worldMatrix4===RenderState2D.TEMPMAT4_ARRAY||this.defines.addInt(ShaderDefines2D.WORLDMAT);this.mmat=renderstate2d.worldMatrix4;if(RenderState2D.matWVP){this.defines.addInt(ShaderDefines2D.MVP3D);this.u_MvpMatrix=RenderState2D.matWVP.elements;}var sd=Shader.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();if(sd._shaderValueWidth!==renderstate2d.width||sd._shaderValueHeight!==renderstate2d.height){this.size[0]=renderstate2d.width;this.size[1]=renderstate2d.height;sd._shaderValueWidth=renderstate2d.width;sd._shaderValueHeight=renderstate2d.height;sd.upload(this,null);}else {sd.upload(this,sd._params2dQuick2||sd._make2dQuick2());}};_proto27.setFilters=function setFilters(value){this.filters=value;if(!value)return;var n=value.length,f;for(var i=0;i<n;i++){f=value[i];if(f){this.defines.add(f.type);f.action.setValue(this);}}};_proto27.clear=function clear(){this.defines._value=this.subID;this.clipOff[0]=0;};_proto27.release=function release(){if(--this.ref<1){this._inClassCache&&(this._inClassCache[this._inClassCache._length++]=this);this.clear();this.filters=null;this.ref=1;this.clipOff[0]=0;}};Value2D.create=function create(mainType,subType){var types=Value2D._cache[mainType|subType];if(types._length)return types[--types._length];else return new Value2D._typeClass[mainType|subType](subType);};return Value2D;}();Value2D._cache=[];Value2D._typeClass=[];Value2D.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var SubmitKey=/*#__PURE__*/function(){function SubmitKey(){this.clear();}var _proto28=SubmitKey.prototype;_proto28.clear=function clear(){this.submitType=-1;this.blendShader=this.other=0;};_proto28.copyFrom=function copyFrom(src){this.other=src.other;this.blendShader=src.blendShader;this.submitType=src.submitType;};_proto28.copyFrom2=function copyFrom2(src,submitType,other){this.other=other;this.submitType=submitType;};_proto28.equal3_2=function equal3_2(next,submitType,other){return this.submitType===submitType&&this.other===other&&this.blendShader===next.blendShader;};_proto28.equal4_2=function equal4_2(next,submitType,other){return this.submitType===submitType&&this.other===other&&this.blendShader===next.blendShader;};_proto28.equal_3=function equal_3(next){return this.submitType===next.submitType&&this.blendShader===next.blendShader;};_proto28.equal=function equal(next){return this.other===next.other&&this.submitType===next.submitType&&this.blendShader===next.blendShader;};return SubmitKey;}();var SubmitCMD=/*#__PURE__*/function(){function SubmitCMD(){this._ref=1;this._key=new SubmitKey();}var _proto29=SubmitCMD.prototype;_proto29.renderSubmit=function renderSubmit(){this.fun.apply(this._this,this.args);return 1;};_proto29.getRenderType=function getRenderType(){return 0;};_proto29.releaseRender=function releaseRender(){if(--this._ref<1){var pool=SubmitCMD.POOL;pool[pool._length++]=this;}};SubmitCMD.create=function create(args,fun,thisobj){var o=SubmitCMD.POOL._length?SubmitCMD.POOL[--SubmitCMD.POOL._length]:new SubmitCMD();o.fun=fun;o.args=args;o._this=thisobj;o._ref=1;o._key.clear();return o;};return SubmitCMD;}();SubmitCMD.POOL=[];{SubmitCMD.POOL._length=0;}var Filter=/*#__PURE__*/function(){function Filter(){}_createClass(Filter,[{key:"type",get:function get(){return -1;}}]);return Filter;}();Filter.BLUR=0x10;Filter.COLOR=0x20;Filter.GLOW=0x08;Filter._filter=function(sprite,context,x,y){var webglctx=context;var next=this._next;if(next){var filters=sprite.filters,len=filters.length;if(len==1&&filters[0].type==Filter.COLOR){context.save();context.setColorFilter(filters[0]);next._fun.call(next,sprite,context,x,y);context.restore();return;}var svCP=Value2D.create(ShaderDefines2D.TEXTURE2D,0);var b;var p=Point.TEMP;var tMatrix=webglctx._curMat;var mat=Matrix.create();tMatrix.copyTo(mat);var tPadding=0;var tHalfPadding=0;var tIsHaveGlowFilter=false;var source=null;var out=sprite._cacheStyle.filterCache||null;if(!out||sprite.getRepaint()!=0){tIsHaveGlowFilter=sprite._isHaveGlowFilter();if(tIsHaveGlowFilter){tPadding=50;tHalfPadding=25;}b=new Rectangle();b.copyFrom(sprite.getSelfBounds());b.x+=sprite.x;b.y+=sprite.y;b.x-=sprite.pivotX+4;b.y-=sprite.pivotY+4;var tSX=b.x;var tSY=b.y;b.width+=tPadding+8;b.height+=tPadding+8;p.x=b.x*mat.a+b.y*mat.c;p.y=b.y*mat.d+b.x*mat.b;b.x=p.x;b.y=p.y;p.x=b.width*mat.a+b.height*mat.c;p.y=b.height*mat.d+b.width*mat.b;b.width=p.x;b.height=p.y;if(b.width<=0||b.height<=0){return;}out&&WebGLRTMgr.releaseRT(out);source=WebGLRTMgr.getRT(b.width,b.height);var outRT=out=WebGLRTMgr.getRT(b.width,b.height);sprite._getCacheStyle().filterCache=out;webglctx.pushRT();webglctx.useRT(source);var tX=sprite.x-tSX+tHalfPadding;var tY=sprite.y-tSY+tHalfPadding;next._fun.call(next,sprite,context,tX,tY);webglctx.useRT(outRT);for(var i=0;i<len;i++){if(i!=0){webglctx.useRT(source);webglctx.drawTarget(outRT,0,0,b.width,b.height,Matrix.TEMP.identity(),svCP,null,BlendMode.TOINT.overlay);webglctx.useRT(outRT);}var fil=filters[i];switch(fil.type){case Filter.BLUR:fil._glRender&&fil._glRender.render(source,context,b.width,b.height,fil);break;case Filter.GLOW:fil._glRender&&fil._glRender.render(source,context,b.width,b.height,fil);break;case Filter.COLOR:webglctx.setColorFilter(fil);webglctx.drawTarget(source,0,0,b.width,b.height,Matrix.EMPTY.identity(),Value2D.create(ShaderDefines2D.TEXTURE2D,0));webglctx.setColorFilter(null);break;}}webglctx.popRT();}else {tIsHaveGlowFilter=sprite._cacheStyle.hasGlowFilter||false;if(tIsHaveGlowFilter){tPadding=50;tHalfPadding=25;}b=sprite.getBounds();if(b.width<=0||b.height<=0){return;}b.width+=tPadding;b.height+=tPadding;p.x=b.x*mat.a+b.y*mat.c;p.y=b.y*mat.d+b.x*mat.b;b.x=p.x;b.y=p.y;p.x=b.width*mat.a+b.height*mat.c;p.y=b.height*mat.d+b.width*mat.b;b.width=p.x;b.height=p.y;}x=x-tHalfPadding-sprite.x;y=y-tHalfPadding-sprite.y;p.setTo(x,y);mat.transformPoint(p);x=p.x+b.x;y=p.y+b.y;webglctx._drawRenderTexture(out,x,y,b.width,b.height,Matrix.TEMP.identity(),1.0,RenderTexture2D.defuv);if(source){var submit=SubmitCMD.create([source],function(s){s.destroy();},this);source=null;context.addRenderObject(submit);}mat.destroy();}};var Utils=/*#__PURE__*/function(){function Utils(){}Utils.toRadian=function toRadian(angle){return angle*Utils._pi2;};Utils.toAngle=function toAngle(radian){return radian*Utils._pi;};Utils.toHexColor=function toHexColor(color){if(color<0||isNaN(color))return null;var str=color.toString(16);while(str.length<6){str="0"+str;}return "#"+str;};Utils.getGID=function getGID(){return Utils._gid++;};Utils.concatArray=function concatArray(source,array){if(!array)return source;if(!source)return array;var i,len=array.length;for(i=0;i<len;i++){source.push(array[i]);}return source;};Utils.clearArray=function clearArray(array){if(!array)return array;array.length=0;return array;};Utils.copyArray=function copyArray(source,array){source||(source=[]);if(!array)return source;source.length=array.length;var i,len=array.length;for(i=0;i<len;i++){source[i]=array[i];}return source;};Utils.getGlobalRecByPoints=function getGlobalRecByPoints(sprite,x0,y0,x1,y1){var newLTPoint;newLTPoint=Point.create().setTo(x0,y0);newLTPoint=sprite.localToGlobal(newLTPoint);var newRBPoint;newRBPoint=Point.create().setTo(x1,y1);newRBPoint=sprite.localToGlobal(newRBPoint);var rst=Rectangle._getWrapRec([newLTPoint.x,newLTPoint.y,newRBPoint.x,newRBPoint.y]);newLTPoint.recover();newRBPoint.recover();return rst;};Utils.getGlobalPosAndScale=function getGlobalPosAndScale(sprite){return Utils.getGlobalRecByPoints(sprite,0,0,1,1);};Utils.bind=function bind(fun,scope){var rst=fun;rst=fun.bind(scope);return rst;};Utils.updateOrder=function updateOrder(array){if(!array||array.length<2)return false;var i=1,j,len=array.length,key,c;while(i<len){j=i;c=array[j];key=array[j]._zOrder;while(--j>-1){if(array[j]._zOrder>key)array[j+1]=array[j];else break;}array[j+1]=c;i++;}return true;};Utils.transPointList=function transPointList(points,x,y){var i,len=points.length;for(i=0;i<len;i+=2){points[i]+=x;points[i+1]+=y;}};Utils.parseInt=function(_parseInt){function parseInt(_x2){return _parseInt.apply(this,arguments);}parseInt.toString=function(){return _parseInt.toString();};return parseInt;}(function(str,radix){if(radix===void 0){radix=0;}var result=parseInt(str,radix);if(isNaN(result))return 0;return result;});Utils.getFileExtension=function getFileExtension(path){Utils._extReg.lastIndex=path.lastIndexOf(".");var result=Utils._extReg.exec(path);if(result&&result.length>1){return result[1].toLowerCase();}return null;};Utils.getFilecompatibleExtension=function getFilecompatibleExtension(path){var result=path.split(".");var resultlen=result.length;if(result.length>2)return result[resultlen-2]+"."+result[resultlen-1];else return null;};Utils.getTransformRelativeToWindow=function getTransformRelativeToWindow(coordinateSpace,x,y){var stage=Utils.gStage;var globalTransform=Utils.getGlobalPosAndScale(coordinateSpace);var canvasMatrix=stage._canvasTransform.clone();var canvasLeft=canvasMatrix.tx;var canvasTop=canvasMatrix.ty;canvasMatrix.rotate(-Math.PI/180*stage.canvasDegree);canvasMatrix.scale(stage.clientScaleX,stage.clientScaleY);var perpendicular=stage.canvasDegree%180!=0;var tx,ty;if(perpendicular){tx=y+globalTransform.y;ty=x+globalTransform.x;tx*=canvasMatrix.d;ty*=canvasMatrix.a;if(stage.canvasDegree==90){tx=canvasLeft-tx;ty+=canvasTop;}else {tx+=canvasLeft;ty=canvasTop-ty;}}else {tx=x+globalTransform.x;ty=y+globalTransform.y;tx*=canvasMatrix.a;ty*=canvasMatrix.d;tx+=canvasLeft;ty+=canvasTop;}ty+=stage['_safariOffsetY'];var domScaleX,domScaleY;if(perpendicular){domScaleX=canvasMatrix.d*globalTransform.height;domScaleY=canvasMatrix.a*globalTransform.width;}else {domScaleX=canvasMatrix.a*globalTransform.width;domScaleY=canvasMatrix.d*globalTransform.height;}return {x:tx,y:ty,scaleX:domScaleX,scaleY:domScaleY};};Utils.fitDOMElementInArea=function fitDOMElementInArea(dom,coordinateSpace,x,y,width,height){if(!dom._fitLayaAirInitialized){dom._fitLayaAirInitialized=true;dom.style.transformOrigin=dom.style.webKittransformOrigin="left top";dom.style.position="absolute";}var transform=Utils.getTransformRelativeToWindow(coordinateSpace,x,y);dom.style.transform=dom.style.webkitTransform="scale("+transform.scaleX+","+transform.scaleY+") rotate("+Utils.gStage.canvasDegree+"deg)";dom.style.width=width+'px';dom.style.height=height+'px';dom.style.left=transform.x+'px';dom.style.top=transform.y+'px';};Utils.isOkTextureList=function isOkTextureList(textureList){if(!textureList)return false;var i,len=textureList.length;var tTexture;for(i=0;i<len;i++){tTexture=textureList[i];if(!tTexture||!tTexture._getSource())return false;}return true;};Utils.isOKCmdList=function isOKCmdList(cmds){if(!cmds)return false;var i,len=cmds.length;var cmd;for(i=0;i<len;i++){cmd=cmds[i];}return true;};Utils.getQueryString=function getQueryString(name){if(ILaya.Browser.onMiniGame)return null;if(!window.location||!window.location.search)return null;var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)");var r=window.location.search.substr(1).match(reg);if(r!=null)return unescape(r[2]);return null;};return Utils;}();Utils.gStage=null;Utils._gid=1;Utils._pi=180/Math.PI;Utils._pi2=Math.PI/180;Utils._extReg=/\.(\w+)\??/g;Utils.parseXMLFromString=function(value){var rst;value=value.replace(/>\s+</g,'><');rst=new DOMParser().parseFromString(value,'text/xml');if(rst.firstChild.textContent.indexOf("This page contains the following errors")>-1){throw new Error(rst.firstChild.firstChild.textContent);}return rst;};var ColorUtils=/*#__PURE__*/function(){function ColorUtils(value){this.arrColor=[];if(value==null){this.strColor="#00000000";this.numColor=0;this.arrColor=[0,0,0,0];return;}var i,len;var color;if(typeof value=='string'){if(value.indexOf("rgba(")>=0||value.indexOf("rgb(")>=0){var tStr=value;var beginI,endI;beginI=tStr.indexOf("(");endI=tStr.indexOf(")");tStr=tStr.substring(beginI+1,endI);this.arrColor=tStr.split(",");len=this.arrColor.length;for(i=0;i<len;i++){this.arrColor[i]=parseFloat(this.arrColor[i]);if(i<3){this.arrColor[i]=Math.round(this.arrColor[i]);}}if(this.arrColor.length==4){color=((this.arrColor[0]*256+this.arrColor[1])*256+this.arrColor[2])*256+Math.round(this.arrColor[3]*255);}else {color=(this.arrColor[0]*256+this.arrColor[1])*256+this.arrColor[2];}this.strColor=value;}else {this.strColor=value;value.charAt(0)==='#'&&(value=value.substr(1));len=value.length;if(len===3||len===4){var temp="";for(i=0;i<len;i++){temp+=value[i]+value[i];}value=temp;}color=parseInt(value,16);}}else {color=value;this.strColor=Utils.toHexColor(color);}if(this.strColor.indexOf("rgba")>=0||this.strColor.length===9){this.arrColor=[((0xFF000000&color)>>>24)/255,((0xFF0000&color)>>16)/255,((0xFF00&color)>>8)/255,(0xFF&color)/255];this.numColor=(0xff000000&color)>>>24|(color&0xff0000)>>8|(color&0x00ff00)<<8|(color&0xff)<<24;}else {this.arrColor=[((0xFF0000&color)>>16)/255,((0xFF00&color)>>8)/255,(0xFF&color)/255,1];this.numColor=0xff000000|(color&0xff0000)>>16|color&0x00ff00|(color&0xff)<<16;}this.arrColor.__id=++ColorUtils._COLODID;}ColorUtils._initDefault=function _initDefault(){ColorUtils._DEFAULT={};for(var i in ColorUtils._COLOR_MAP){ColorUtils._SAVE[i]=ColorUtils._DEFAULT[i]=new ColorUtils(ColorUtils._COLOR_MAP[i]);}return ColorUtils._DEFAULT;};ColorUtils._initSaveMap=function _initSaveMap(){ColorUtils._SAVE_SIZE=0;ColorUtils._SAVE={};for(var i in ColorUtils._DEFAULT){ColorUtils._SAVE[i]=ColorUtils._DEFAULT[i];}};ColorUtils.create=function create(value){var key=value+"";var color=ColorUtils._SAVE[key];if(color!=null)return color;if(ColorUtils._SAVE_SIZE<1000)ColorUtils._initSaveMap();return ColorUtils._SAVE[key]=new ColorUtils(value);};return ColorUtils;}();ColorUtils._SAVE={};ColorUtils._SAVE_SIZE=0;ColorUtils._COLOR_MAP={"purple":"#800080","orange":"#ffa500","white":'#FFFFFF',"red":'#FF0000',"green":'#00FF00',"blue":'#0000FF',"black":'#000000',"yellow":'#FFFF00','gray':'#808080'};ColorUtils._DEFAULT=ColorUtils._initDefault();ColorUtils._COLODID=1;var ColorFilter=/*#__PURE__*/function(_Filter){_inheritsLoose(ColorFilter,_Filter);function ColorFilter(mat){var _this9;if(mat===void 0){mat=null;}_this9=_Filter.call(this)||this;if(!mat)mat=_this9._copyMatrix(ColorFilter.IDENTITY_MATRIX);_this9._mat=new Float32Array(16);_this9._alpha=new Float32Array(4);_this9.setByMatrix(mat);return _this9;}var _proto30=ColorFilter.prototype;_proto30.gray=function gray(){return this.setByMatrix(ColorFilter.GRAY_MATRIX);};_proto30.color=function color(red,green,blue,alpha){if(red===void 0){red=0;}if(green===void 0){green=0;}if(blue===void 0){blue=0;}if(alpha===void 0){alpha=1;}return this.setByMatrix([1,0,0,0,red,0,1,0,0,green,0,0,1,0,blue,0,0,0,1,alpha]);};_proto30.setColor=function setColor(color){var arr=ColorUtils.create(color).arrColor;var mt=[0,0,0,0,256*arr[0],0,0,0,0,256*arr[1],0,0,0,0,256*arr[2],0,0,0,1,0];return this.setByMatrix(mt);};_proto30.setByMatrix=function setByMatrix(matrix){if(this._matrix!=matrix)this._copyMatrix(matrix);var j=0;var z=0;for(var i=0;i<20;i++){if(i%5!=4){this._mat[j++]=matrix[i];}else {this._alpha[z++]=matrix[i];}}return this;};_proto30.adjustColor=function adjustColor(brightness,contrast,saturation,hue){this.adjustHue(hue);this.adjustContrast(contrast);this.adjustBrightness(brightness);this.adjustSaturation(saturation);return this;};_proto30.adjustBrightness=function adjustBrightness(brightness){brightness=this._clampValue(brightness,100);if(brightness==0||isNaN(brightness))return this;return this._multiplyMatrix([1,0,0,0,brightness,0,1,0,0,brightness,0,0,1,0,brightness,0,0,0,1,0,0,0,0,0,1]);};_proto30.adjustContrast=function adjustContrast(contrast){contrast=this._clampValue(contrast,100);if(contrast==0||isNaN(contrast))return this;var x;if(contrast<0){x=127+contrast/100*127;}else {x=contrast%1;if(x==0){x=ColorFilter.DELTA_INDEX[contrast];}else {x=ColorFilter.DELTA_INDEX[contrast<<0]*(1-x)+ColorFilter.DELTA_INDEX[(contrast<<0)+1]*x;}x=x*127+127;}var x1=x/127;var x2=(127-x)*0.5;return this._multiplyMatrix([x1,0,0,0,x2,0,x1,0,0,x2,0,0,x1,0,x2,0,0,0,1,0,0,0,0,0,1]);};_proto30.adjustSaturation=function adjustSaturation(saturation){saturation=this._clampValue(saturation,100);if(saturation==0||isNaN(saturation))return this;var x=1+(saturation>0?3*saturation/100:saturation/100);var dx=1-x;var r=0.3086*dx;var g=0.6094*dx;var b=0.0820*dx;return this._multiplyMatrix([r+x,g,b,0,0,r,g+x,b,0,0,r,g,b+x,0,0,0,0,0,1,0,0,0,0,0,1]);};_proto30.adjustHue=function adjustHue(hue){hue=this._clampValue(hue,180)/180*Math.PI;if(hue==0||isNaN(hue))return this;var cos=Math.cos(hue);var sin=Math.sin(hue);var r=0.213;var g=0.715;var b=0.072;return this._multiplyMatrix([r+cos*(1-r)+sin*-r,g+cos*-g+sin*-g,b+cos*-b+sin*(1-b),0,0,r+cos*-r+sin*0.143,g+cos*(1-g)+sin*0.140,b+cos*-b+sin*-0.283,0,0,r+cos*-r+sin*-(1-r),g+cos*-g+sin*g,b+cos*(1-b)+sin*b,0,0,0,0,0,1,0,0,0,0,0,1]);};_proto30.reset=function reset(){return this.setByMatrix(this._copyMatrix(ColorFilter.IDENTITY_MATRIX));};_proto30._multiplyMatrix=function _multiplyMatrix(matrix){var col=[];this._matrix=this._fixMatrix(this._matrix);for(var i=0;i<5;i++){for(var j=0;j<5;j++){col[j]=this._matrix[j+i*5];}for(j=0;j<5;j++){var val=0;for(var k=0;k<5;k++){val+=matrix[j+k*5]*col[k];}this._matrix[j+i*5]=val;}}return this.setByMatrix(this._matrix);};_proto30._clampValue=function _clampValue(val,limit){return Math.min(limit,Math.max(-limit,val));};_proto30._fixMatrix=function _fixMatrix(matrix){if(matrix===void 0){matrix=null;}if(matrix==null)return ColorFilter.IDENTITY_MATRIX;if(matrix.length<ColorFilter.LENGTH)matrix=matrix.slice(0,matrix.length).concat(ColorFilter.IDENTITY_MATRIX.slice(matrix.length,ColorFilter.LENGTH));else if(matrix.length>ColorFilter.LENGTH)matrix=matrix.slice(0,ColorFilter.LENGTH);return matrix;};_proto30._copyMatrix=function _copyMatrix(matrix){var len=ColorFilter.LENGTH;if(!this._matrix)this._matrix=[];for(var i=0;i<len;i++){this._matrix[i]=matrix[i];}return this._matrix;};_createClass(ColorFilter,[{key:"type",get:function get(){return Filter.COLOR;}}]);return ColorFilter;}(Filter);ColorFilter.DELTA_INDEX=[0,0.01,0.02,0.04,0.05,0.06,0.07,0.08,0.1,0.11,0.12,0.14,0.15,0.16,0.17,0.18,0.20,0.21,0.22,0.24,0.25,0.27,0.28,0.30,0.32,0.34,0.36,0.38,0.40,0.42,0.44,0.46,0.48,0.5,0.53,0.56,0.59,0.62,0.65,0.68,0.71,0.74,0.77,0.80,0.83,0.86,0.89,0.92,0.95,0.98,1.0,1.06,1.12,1.18,1.24,1.30,1.36,1.42,1.48,1.54,1.60,1.66,1.72,1.78,1.84,1.90,1.96,2.0,2.12,2.25,2.37,2.50,2.62,2.75,2.87,3.0,3.2,3.4,3.6,3.8,4.0,4.3,4.7,4.9,5.0,5.5,6.0,6.5,6.8,7.0,7.3,7.5,7.8,8.0,8.4,8.7,9.0,9.4,9.6,9.8,10.0];ColorFilter.GRAY_MATRIX=[0.3086,0.6094,0.082,0,0,0.3086,0.6094,0.082,0,0,0.3086,0.6094,0.082,0,0,0,0,0,1,0];ColorFilter.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1];ColorFilter.LENGTH=25;var DrawTextureCmd=/*#__PURE__*/function(){function DrawTextureCmd(){this.colorFlt=null;this.uv=null;}DrawTextureCmd.create=function create(texture,x,y,width,height,matrix,alpha,color,blendMode,uv){var cmd=Pool.getItemByClass("DrawTextureCmd",DrawTextureCmd);cmd.texture=texture;texture._addReference();cmd.x=x;cmd.y=y;cmd.width=width;cmd.height=height;cmd.matrix=matrix;cmd.alpha=alpha;cmd.color=color;cmd.blendMode=blendMode;cmd.uv=uv==undefined?null:uv;if(color){cmd.colorFlt=new ColorFilter();cmd.colorFlt.setColor(color);}return cmd;};var _proto31=DrawTextureCmd.prototype;_proto31.recover=function recover(){this.texture&&this.texture._removeReference();this.texture=null;this.matrix=null;Pool.recover("DrawTextureCmd",this);};_proto31.run=function run(context,gx,gy){this.texture&&context.drawTextureWithTransform(this.texture,this.x,this.y,this.width,this.height,this.matrix,gx,gy,this.alpha,this.blendMode,this.colorFlt,this.uv);};_createClass(DrawTextureCmd,[{key:"cmdID",get:function get(){return DrawTextureCmd.ID;}}]);return DrawTextureCmd;}();DrawTextureCmd.ID="DrawTexture";var FillTextureCmd=/*#__PURE__*/function(){function FillTextureCmd(){}FillTextureCmd.create=function create(texture,x,y,width,height,type,offset,other){var cmd=Pool.getItemByClass("FillTextureCmd",FillTextureCmd);cmd.texture=texture;cmd.x=x;cmd.y=y;cmd.width=width;cmd.height=height;cmd.type=type;cmd.offset=offset;cmd.other=other;return cmd;};var _proto32=FillTextureCmd.prototype;_proto32.recover=function recover(){this.texture=null;this.offset=null;this.other=null;Pool.recover("FillTextureCmd",this);};_proto32.run=function run(context,gx,gy){context.fillTexture(this.texture,this.x+gx,this.y+gy,this.width,this.height,this.type,this.offset,this.other);};_createClass(FillTextureCmd,[{key:"cmdID",get:function get(){return FillTextureCmd.ID;}}]);return FillTextureCmd;}();FillTextureCmd.ID="FillTexture";var RestoreCmd=/*#__PURE__*/function(){function RestoreCmd(){}RestoreCmd.create=function create(){var cmd=Pool.getItemByClass("RestoreCmd",RestoreCmd);return cmd;};var _proto33=RestoreCmd.prototype;_proto33.recover=function recover(){Pool.recover("RestoreCmd",this);};_proto33.run=function run(context,gx,gy){context.restore();};_createClass(RestoreCmd,[{key:"cmdID",get:function get(){return RestoreCmd.ID;}}]);return RestoreCmd;}();RestoreCmd.ID="Restore";var RotateCmd=/*#__PURE__*/function(){function RotateCmd(){}RotateCmd.create=function create(angle,pivotX,pivotY){var cmd=Pool.getItemByClass("RotateCmd",RotateCmd);cmd.angle=angle;cmd.pivotX=pivotX;cmd.pivotY=pivotY;return cmd;};var _proto34=RotateCmd.prototype;_proto34.recover=function recover(){Pool.recover("RotateCmd",this);};_proto34.run=function run(context,gx,gy){context._rotate(this.angle,this.pivotX+gx,this.pivotY+gy);};_createClass(RotateCmd,[{key:"cmdID",get:function get(){return RotateCmd.ID;}}]);return RotateCmd;}();RotateCmd.ID="Rotate";var ScaleCmd=/*#__PURE__*/function(){function ScaleCmd(){}ScaleCmd.create=function create(scaleX,scaleY,pivotX,pivotY){var cmd=Pool.getItemByClass("ScaleCmd",ScaleCmd);cmd.scaleX=scaleX;cmd.scaleY=scaleY;cmd.pivotX=pivotX;cmd.pivotY=pivotY;return cmd;};var _proto35=ScaleCmd.prototype;_proto35.recover=function recover(){Pool.recover("ScaleCmd",this);};_proto35.run=function run(context,gx,gy){context._scale(this.scaleX,this.scaleY,this.pivotX+gx,this.pivotY+gy);};_createClass(ScaleCmd,[{key:"cmdID",get:function get(){return ScaleCmd.ID;}}]);return ScaleCmd;}();ScaleCmd.ID="Scale";var TransformCmd=/*#__PURE__*/function(){function TransformCmd(){}TransformCmd.create=function create(matrix,pivotX,pivotY){var cmd=Pool.getItemByClass("TransformCmd",TransformCmd);cmd.matrix=matrix;cmd.pivotX=pivotX;cmd.pivotY=pivotY;return cmd;};var _proto36=TransformCmd.prototype;_proto36.recover=function recover(){this.matrix=null;Pool.recover("TransformCmd",this);};_proto36.run=function run(context,gx,gy){context._transform(this.matrix,this.pivotX+gx,this.pivotY+gy);};_createClass(TransformCmd,[{key:"cmdID",get:function get(){return TransformCmd.ID;}}]);return TransformCmd;}();TransformCmd.ID="Transform";var TranslateCmd=/*#__PURE__*/function(){function TranslateCmd(){}TranslateCmd.create=function create(tx,ty){var cmd=Pool.getItemByClass("TranslateCmd",TranslateCmd);cmd.tx=tx;cmd.ty=ty;return cmd;};var _proto37=TranslateCmd.prototype;_proto37.recover=function recover(){Pool.recover("TranslateCmd",this);};_proto37.run=function run(context,gx,gy){context.translate(this.tx,this.ty);};_createClass(TranslateCmd,[{key:"cmdID",get:function get(){return TranslateCmd.ID;}}]);return TranslateCmd;}();TranslateCmd.ID="Translate";var Bezier=/*#__PURE__*/function(){function Bezier(){this._controlPoints=[new Point(),new Point(),new Point()];this._calFun=this.getPoint2;}var _proto38=Bezier.prototype;_proto38._switchPoint=function _switchPoint(x,y){var tPoint=this._controlPoints.shift();tPoint.setTo(x,y);this._controlPoints.push(tPoint);};_proto38.getPoint2=function getPoint2(t,rst){var p1=this._controlPoints[0];var p2=this._controlPoints[1];var p3=this._controlPoints[2];var lineX=Math.pow(1-t,2)*p1.x+2*t*(1-t)*p2.x+Math.pow(t,2)*p3.x;var lineY=Math.pow(1-t,2)*p1.y+2*t*(1-t)*p2.y+Math.pow(t,2)*p3.y;rst.push(lineX,lineY);};_proto38.getPoint3=function getPoint3(t,rst){var p1=this._controlPoints[0];var p2=this._controlPoints[1];var p3=this._controlPoints[2];var p4=this._controlPoints[3];var lineX=Math.pow(1-t,3)*p1.x+3*p2.x*t*(1-t)*(1-t)+3*p3.x*t*t*(1-t)+p4.x*Math.pow(t,3);var lineY=Math.pow(1-t,3)*p1.y+3*p2.y*t*(1-t)*(1-t)+3*p3.y*t*t*(1-t)+p4.y*Math.pow(t,3);rst.push(lineX,lineY);};_proto38.insertPoints=function insertPoints(count,rst){var i;count=count>0?count:5;var dLen;dLen=1/count;for(i=0;i<=1;i+=dLen){this._calFun(i,rst);}};_proto38.getBezierPoints=function getBezierPoints(pList,inSertCount,count){if(inSertCount===void 0){inSertCount=5;}if(count===void 0){count=2;}var i,len;len=pList.length;if(len<(count+1)*2)return [];var rst=[];switch(count){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return [];}while(this._controlPoints.length<=count){this._controlPoints.push(Point.create());}for(i=0;i<count*2;i+=2){this._switchPoint(pList[i],pList[i+1]);}for(i=count*2;i<len;i+=2){this._switchPoint(pList[i],pList[i+1]);if(i/2%count==0)this.insertPoints(inSertCount,rst);}return rst;};return Bezier;}();Bezier.I=new Bezier();var GrahamScan=/*#__PURE__*/function(){function GrahamScan(){}GrahamScan.multiply=function multiply(p1,p2,p0){return (p1.x-p0.x)*(p2.y-p0.y)-(p2.x-p0.x)*(p1.y-p0.y);};GrahamScan.dis=function dis(p1,p2){return (p1.x-p2.x)*(p1.x-p2.x)+(p1.y-p2.y)*(p1.y-p2.y);};GrahamScan._getPoints=function _getPoints(count,tempUse,rst){if(tempUse===void 0){tempUse=false;}if(rst===void 0){rst=null;}if(!GrahamScan._mPointList)GrahamScan._mPointList=[];while(GrahamScan._mPointList.length<count){GrahamScan._mPointList.push(new Point());}if(!rst)rst=[];rst.length=0;if(tempUse){GrahamScan.getFrom(rst,GrahamScan._mPointList,count);}else {GrahamScan.getFromR(rst,GrahamScan._mPointList,count);}return rst;};GrahamScan.getFrom=function getFrom(rst,src,count){var i;for(i=0;i<count;i++){rst.push(src[i]);}return rst;};GrahamScan.getFromR=function getFromR(rst,src,count){var i;for(i=0;i<count;i++){rst.push(src.pop());}return rst;};GrahamScan.pListToPointList=function pListToPointList(pList,tempUse){if(tempUse===void 0){tempUse=false;}var i,len=pList.length/2,rst=GrahamScan._getPoints(len,tempUse,GrahamScan._tempPointList);for(i=0;i<len;i++){rst[i].setTo(pList[i+i],pList[i+i+1]);}return rst;};GrahamScan.pointListToPlist=function pointListToPlist(pointList){var i,len=pointList.length,rst=GrahamScan._temPList,tPoint;rst.length=0;for(i=0;i<len;i++){tPoint=pointList[i];rst.push(tPoint.x,tPoint.y);}return rst;};GrahamScan.scanPList=function scanPList(pList){return Utils.copyArray(pList,GrahamScan.pointListToPlist(GrahamScan.scan(GrahamScan.pListToPointList(pList,true))));};GrahamScan.scan=function scan(PointSet){var i,j,k=0,tmp,n=PointSet.length,ch;var _tmpDic={};var key;ch=GrahamScan._temArr;ch.length=0;n=PointSet.length;for(i=n-1;i>=0;i--){tmp=PointSet[i];key=tmp.x+"_"+tmp.y;if(!(key in _tmpDic)){_tmpDic[key]=true;ch.push(tmp);}}n=ch.length;Utils.copyArray(PointSet,ch);for(i=1;i<n;i++){if(PointSet[i].y<PointSet[k].y||PointSet[i].y==PointSet[k].y&&PointSet[i].x<PointSet[k].x)k=i;}tmp=PointSet[0];PointSet[0]=PointSet[k];PointSet[k]=tmp;for(i=1;i<n-1;i++){k=i;for(j=i+1;j<n;j++){if(GrahamScan.multiply(PointSet[j],PointSet[k],PointSet[0])>0||GrahamScan.multiply(PointSet[j],PointSet[k],PointSet[0])==0&&GrahamScan.dis(PointSet[0],PointSet[j])<GrahamScan.dis(PointSet[0],PointSet[k]))k=j;}tmp=PointSet[i];PointSet[i]=PointSet[k];PointSet[k]=tmp;}ch=GrahamScan._temArr;ch.length=0;if(PointSet.length<3){return Utils.copyArray(ch,PointSet);}ch.push(PointSet[0],PointSet[1],PointSet[2]);for(i=3;i<n;i++){while(ch.length>=2&&GrahamScan.multiply(PointSet[i],ch[ch.length-1],ch[ch.length-2])>=0){ch.pop();}PointSet[i]&&ch.push(PointSet[i]);}return ch;};return GrahamScan;}();GrahamScan._tempPointList=[];GrahamScan._temPList=[];GrahamScan._temArr=[];var DrawStyle=/*#__PURE__*/function(){function DrawStyle(value){this.setValue(value);}DrawStyle.create=function create(value){if(value){var color=value instanceof ColorUtils?value:ColorUtils.create(value);return color._drawStyle||(color._drawStyle=new DrawStyle(value));}return DrawStyle.DEFAULT;};var _proto39=DrawStyle.prototype;_proto39.setValue=function setValue(value){if(value){this._color=value instanceof ColorUtils?value:ColorUtils.create(value);}else this._color=ColorUtils.create("#000000");};_proto39.reset=function reset(){this._color=ColorUtils.create("#000000");};_proto39.toInt=function toInt(){return this._color.numColor;};_proto39.equal=function equal(value){if(typeof value=='string')return this._color.strColor===value;if(value instanceof ColorUtils)return this._color.numColor===value.numColor;return false;};_proto39.toColorStr=function toColorStr(){return this._color.strColor;};return DrawStyle;}();DrawStyle.DEFAULT=new DrawStyle("#000000");var Path=/*#__PURE__*/function(){function Path(){this._lastOriX=0;this._lastOriY=0;this.paths=[];this._curPath=null;}var _proto40=Path.prototype;_proto40.beginPath=function beginPath(convex){this.paths.length=1;this._curPath=this.paths[0]=new renderPath();this._curPath.convex=convex;};_proto40.closePath=function closePath(){this._curPath.loop=true;};_proto40.newPath=function newPath(){this._curPath=new renderPath();this.paths.push(this._curPath);};_proto40.addPoint=function addPoint(pointX,pointY){this._curPath.path.push(pointX,pointY);};_proto40.push=function push(points,convex){if(!this._curPath){this._curPath=new renderPath();this.paths.push(this._curPath);}else if(this._curPath.path.length>0){this._curPath=new renderPath();this.paths.push(this._curPath);}var rp=this._curPath;rp.path=points.slice();rp.convex=convex;};_proto40.reset=function reset(){this.paths.length=0;};return Path;}();var renderPath=function renderPath(){this.path=[];this.loop=false;this.convex=false;};var SubmitBase=/*#__PURE__*/function(){function SubmitBase(renderType){if(renderType===void 0){renderType=SubmitBase.TYPE_2D;}this.clipInfoID=-1;this._mesh=null;this._blendFn=null;this._id=0;this._renderType=0;this._parent=null;this._key=new SubmitKey();this._startIdx=0;this._numEle=0;this._ref=1;this.shaderValue=null;this._renderType=renderType;this._id=++SubmitBase.ID;}SubmitBase.__init__=function __init__(){var s=SubmitBase.RENDERBASE=new SubmitBase(-1);s.shaderValue=new Value2D(0,0);s.shaderValue.ALPHA=1;s._ref=0xFFFFFFFF;};var _proto41=SubmitBase.prototype;_proto41.getID=function getID(){return this._id;};_proto41.getRenderType=function getRenderType(){return this._renderType;};_proto41.toString=function toString(){return "ibindex:"+this._startIdx+" num:"+this._numEle+" key="+this._key;};_proto41.renderSubmit=function renderSubmit(){return 1;};_proto41.releaseRender=function releaseRender(){};return SubmitBase;}();SubmitBase.TYPE_2D=10000;SubmitBase.TYPE_CANVAS=10003;SubmitBase.TYPE_CMDSETRT=10004;SubmitBase.TYPE_CUSTOM=10005;SubmitBase.TYPE_BLURRT=10006;SubmitBase.TYPE_CMDDESTORYPRERT=10007;SubmitBase.TYPE_DISABLESTENCIL=10008;SubmitBase.TYPE_OTHERIBVB=10009;SubmitBase.TYPE_PRIMITIVE=10010;SubmitBase.TYPE_RT=10011;SubmitBase.TYPE_BLUR_RT=10012;SubmitBase.TYPE_TARGET=10013;SubmitBase.TYPE_CHANGE_VALUE=10014;SubmitBase.TYPE_SHAPE=10015;SubmitBase.TYPE_TEXTURE=10016;SubmitBase.TYPE_FILLTEXTURE=10017;SubmitBase.KEY_ONCE=-1;SubmitBase.KEY_FILLRECT=1;SubmitBase.KEY_DRAWTEXTURE=2;SubmitBase.KEY_VG=3;SubmitBase.KEY_TRIANGLES=4;SubmitBase.ID=1;SubmitBase.preRender=null;var SaveBase=/*#__PURE__*/function(){function SaveBase(){}SaveBase._createArray=function _createArray(){var value=[];value._length=0;return value;};SaveBase._init=function _init(){var namemap=SaveBase._namemap={};namemap[SaveBase.TYPE_ALPHA]="ALPHA";namemap[SaveBase.TYPE_FILESTYLE]="fillStyle";namemap[SaveBase.TYPE_FONT]="font";namemap[SaveBase.TYPE_LINEWIDTH]="lineWidth";namemap[SaveBase.TYPE_STROKESTYLE]="strokeStyle";namemap[SaveBase.TYPE_ENABLEMERGE]="_mergeID";namemap[SaveBase.TYPE_MARK]=namemap[SaveBase.TYPE_TRANSFORM]=namemap[SaveBase.TYPE_TRANSLATE]=[];namemap[SaveBase.TYPE_TEXTBASELINE]="textBaseline";namemap[SaveBase.TYPE_TEXTALIGN]="textAlign";namemap[SaveBase.TYPE_GLOBALCOMPOSITEOPERATION]="_nBlendType";namemap[SaveBase.TYPE_SHADER]="shader";namemap[SaveBase.TYPE_FILTERS]="filters";namemap[SaveBase.TYPE_COLORFILTER]='_colorFiler';return namemap;};var _proto42=SaveBase.prototype;_proto42.isSaveMark=function isSaveMark(){return false;};_proto42.restore=function restore(context){this._dataObj[this._valueName]=this._value;SaveBase.POOL[SaveBase.POOL._length++]=this;this._newSubmit&&(context._curSubmit=SubmitBase.RENDERBASE);};SaveBase.save=function save(context,type,dataObj,newSubmit){if((context._saveMark._saveuse&type)!==type){context._saveMark._saveuse|=type;var cache=SaveBase.POOL;var o=cache._length>0?cache[--cache._length]:new SaveBase();o._value=dataObj[o._valueName=SaveBase._namemap[type]];o._dataObj=dataObj;o._newSubmit=newSubmit;var _save=context._save;_save[_save._length++]=o;}};return SaveBase;}();SaveBase.TYPE_ALPHA=0x1;SaveBase.TYPE_FILESTYLE=0x2;SaveBase.TYPE_FONT=0x8;SaveBase.TYPE_LINEWIDTH=0x100;SaveBase.TYPE_STROKESTYLE=0x200;SaveBase.TYPE_MARK=0x400;SaveBase.TYPE_TRANSFORM=0x800;SaveBase.TYPE_TRANSLATE=0x1000;SaveBase.TYPE_ENABLEMERGE=0x2000;SaveBase.TYPE_TEXTBASELINE=0x4000;SaveBase.TYPE_TEXTALIGN=0x8000;SaveBase.TYPE_GLOBALCOMPOSITEOPERATION=0x10000;SaveBase.TYPE_CLIPRECT=0x20000;SaveBase.TYPE_CLIPRECT_STENCIL=0x40000;SaveBase.TYPE_IBVB=0x80000;SaveBase.TYPE_SHADER=0x100000;SaveBase.TYPE_FILTERS=0x200000;SaveBase.TYPE_FILTERS_TYPE=0x400000;SaveBase.TYPE_COLORFILTER=0x800000;SaveBase.POOL=SaveBase._createArray();SaveBase._namemap=SaveBase._init();var SaveClipRect=/*#__PURE__*/function(){function SaveClipRect(){this._globalClipMatrix=new Matrix();this._clipInfoID=-1;this._clipRect=new Rectangle();this.incache=false;}var _proto43=SaveClipRect.prototype;_proto43.isSaveMark=function isSaveMark(){return false;};_proto43.restore=function restore(context){this._globalClipMatrix.copyTo(context._globalClipMatrix);this._clipRect.clone(context._clipRect);context._clipInfoID=this._clipInfoID;SaveClipRect.POOL[SaveClipRect.POOL._length++]=this;context._clipInCache=this.incache;};SaveClipRect.save=function save(context){if((context._saveMark._saveuse&SaveBase.TYPE_CLIPRECT)==SaveBase.TYPE_CLIPRECT)return;context._saveMark._saveuse|=SaveBase.TYPE_CLIPRECT;var cache=SaveClipRect.POOL;var o=cache._length>0?cache[--cache._length]:new SaveClipRect();context._globalClipMatrix.copyTo(o._globalClipMatrix);context._clipRect.clone(o._clipRect);o._clipInfoID=context._clipInfoID;o.incache=context._clipInCache;var _save=context._save;_save[_save._length++]=o;};return SaveClipRect;}();SaveClipRect.POOL=SaveBase._createArray();var SaveMark=/*#__PURE__*/function(){function SaveMark(){this._saveuse=0;}var _proto44=SaveMark.prototype;_proto44.isSaveMark=function isSaveMark(){return true;};_proto44.restore=function restore(context){context._saveMark=this._preSaveMark;SaveMark.POOL[SaveMark.POOL._length++]=this;};SaveMark.Create=function Create(context){var no=SaveMark.POOL;var o=no._length>0?no[--no._length]:new SaveMark();o._saveuse=0;o._preSaveMark=context._saveMark;context._saveMark=o;return o;};return SaveMark;}();SaveMark.POOL=SaveBase._createArray();var SaveTransform=/*#__PURE__*/function(){function SaveTransform(){this._matrix=new Matrix();}var _proto45=SaveTransform.prototype;_proto45.isSaveMark=function isSaveMark(){return false;};_proto45.restore=function restore(context){context._curMat=this._savematrix;SaveTransform.POOL[SaveTransform.POOL._length++]=this;};SaveTransform.save=function save(context){var _saveMark=context._saveMark;if((_saveMark._saveuse&SaveBase.TYPE_TRANSFORM)===SaveBase.TYPE_TRANSFORM)return;_saveMark._saveuse|=SaveBase.TYPE_TRANSFORM;var no=SaveTransform.POOL;var o=no._length>0?no[--no._length]:new SaveTransform();o._savematrix=context._curMat;context._curMat=context._curMat.copyTo(o._matrix);var _save=context._save;_save[_save._length++]=o;};return SaveTransform;}();SaveTransform.POOL=SaveBase._createArray();var SaveTranslate=/*#__PURE__*/function(){function SaveTranslate(){this._mat=new Matrix();}var _proto46=SaveTranslate.prototype;_proto46.isSaveMark=function isSaveMark(){return false;};_proto46.restore=function restore(context){this._mat.copyTo(context._curMat);SaveTranslate.POOL[SaveTranslate.POOL._length++]=this;};SaveTranslate.save=function save(context){var no=SaveTranslate.POOL;var o=no._length>0?no[--no._length]:new SaveTranslate();context._curMat.copyTo(o._mat);var _save=context._save;_save[_save._length++]=o;};return SaveTranslate;}();SaveTranslate.POOL=SaveBase._createArray();var BufferStateBase=/*#__PURE__*/function(){function BufferStateBase(){this._nativeVertexArrayObject=LayaGL.layaGPUInstance.createVertexArray();}var _proto47=BufferStateBase.prototype;_proto47.bind=function bind(){if(BufferStateBase._curBindedBufferState!==this){LayaGL.layaGPUInstance.bindVertexArray(this._nativeVertexArrayObject);BufferStateBase._curBindedBufferState=this;}};_proto47.unBind=function unBind(){if(BufferStateBase._curBindedBufferState===this){LayaGL.layaGPUInstance.bindVertexArray(null);BufferStateBase._curBindedBufferState=null;}else {throw "BufferState: must call bind() function first.";}};_proto47.destroy=function destroy(){LayaGL.layaGPUInstance.deleteVertexArray(this._nativeVertexArrayObject);};_proto47.bindForNative=function bindForNative(){LayaGL.instance.bindVertexArray(this._nativeVertexArrayObject);BufferStateBase._curBindedBufferState=this;};_proto47.unBindForNative=function unBindForNative(){LayaGL.instance.bindVertexArray(null);BufferStateBase._curBindedBufferState=null;};return BufferStateBase;}();var BufferState2D=/*#__PURE__*/function(_BufferStateBase){_inheritsLoose(BufferState2D,_BufferStateBase);function BufferState2D(){return _BufferStateBase.call(this)||this;}return BufferState2D;}(BufferStateBase);var Buffer=/*#__PURE__*/function(){function Buffer(){this._byteLength=0;this._glBuffer=LayaGL.instance.createBuffer();}var _proto48=Buffer.prototype;_proto48._bindForVAO=function _bindForVAO(){};_proto48.bind=function bind(){return false;};_proto48.destroy=function destroy(){if(this._glBuffer){LayaGL.instance.deleteBuffer(this._glBuffer);this._glBuffer=null;}};_createClass(Buffer,[{key:"bufferUsage",get:function get(){return this._bufferUsage;}}]);return Buffer;}();var RenderInfo=function RenderInfo(){};RenderInfo.loopStTm=0;RenderInfo.loopCount=0;var Buffer2D=/*#__PURE__*/function(_Buffer){_inheritsLoose(Buffer2D,_Buffer);function Buffer2D(){var _this10;_this10=_Buffer.call(this)||this;_this10._maxsize=0;_this10._upload=true;_this10._uploadSize=0;_this10._bufferSize=0;_this10._u8Array=null;return _this10;}Buffer2D.__int__=function __int__(gl){};var _proto49=Buffer2D.prototype;_proto49.setByteLength=function setByteLength(value){if(this._byteLength!==value){value<=this._bufferSize||this._resizeBuffer(value*2+256,true);this._byteLength=value;}};_proto49.needSize=function needSize(sz){var old=this._byteLength;if(sz){var needsz=this._byteLength+sz;needsz<=this._bufferSize||this._resizeBuffer(needsz<<1,true);this._byteLength=needsz;}return old;};_proto49._bufferData=function _bufferData(){this._maxsize=Math.max(this._maxsize,this._byteLength);if(RenderInfo.loopCount%30==0){if(this._buffer.byteLength>this._maxsize+64){this._buffer=this._buffer.slice(0,this._maxsize+64);this._bufferSize=this._buffer.byteLength;this._checkArrayUse();}this._maxsize=this._byteLength;}if(this._uploadSize<this._buffer.byteLength){this._uploadSize=this._buffer.byteLength;LayaGL.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage);}LayaGL.instance.bufferSubData(this._bufferType,0,new Uint8Array(this._buffer,0,this._byteLength));};_proto49._bufferSubData=function _bufferSubData(offset,dataStart,dataLength){if(offset===void 0){offset=0;}if(dataStart===void 0){dataStart=0;}if(dataLength===void 0){dataLength=0;}this._maxsize=Math.max(this._maxsize,this._byteLength);if(RenderInfo.loopCount%30==0){if(this._buffer.byteLength>this._maxsize+64){this._buffer=this._buffer.slice(0,this._maxsize+64);this._bufferSize=this._buffer.byteLength;this._checkArrayUse();}this._maxsize=this._byteLength;}if(this._uploadSize<this._buffer.byteLength){this._uploadSize=this._buffer.byteLength;LayaGL.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage);}if(dataStart||dataLength){var subBuffer=this._buffer.slice(dataStart,dataLength);LayaGL.instance.bufferSubData(this._bufferType,offset,subBuffer);}else {LayaGL.instance.bufferSubData(this._bufferType,offset,this._buffer);}};_proto49._checkArrayUse=function _checkArrayUse(){};_proto49._bind_uploadForVAO=function _bind_uploadForVAO(){if(!this._upload)return false;this._upload=false;this._bindForVAO();this._bufferData();return true;};_proto49._bind_upload=function _bind_upload(){if(!this._upload)return false;this._upload=false;this.bind();this._bufferData();return true;};_proto49._bind_subUpload=function _bind_subUpload(offset,dataStart,dataLength){if(offset===void 0){offset=0;}if(dataStart===void 0){dataStart=0;}if(dataLength===void 0){dataLength=0;}if(!this._upload)return false;this._upload=false;this.bind();this._bufferSubData(offset,dataStart,dataLength);return true;};_proto49._resizeBuffer=function _resizeBuffer(nsz,copy){var buff=this._buffer;if(nsz<=buff.byteLength)return this;var u8buf=this._u8Array;if(copy&&buff&&buff.byteLength>0){var newbuffer=new ArrayBuffer(nsz);var oldU8Arr=u8buf&&u8buf.buffer==buff?u8buf:new Uint8Array(buff);u8buf=this._u8Array=new Uint8Array(newbuffer);u8buf.set(oldU8Arr,0);buff=this._buffer=newbuffer;}else {buff=this._buffer=new ArrayBuffer(nsz);this._u8Array=null;}this._checkArrayUse();this._upload=true;this._bufferSize=buff.byteLength;return this;};_proto49.append=function append(data){this._upload=true;var byteLen,n;byteLen=data.byteLength;if(data instanceof Uint8Array){this._resizeBuffer(this._byteLength+byteLen,true);n=new Uint8Array(this._buffer,this._byteLength);}else if(data instanceof Uint16Array){this._resizeBuffer(this._byteLength+byteLen,true);n=new Uint16Array(this._buffer,this._byteLength);}else if(data instanceof Float32Array){this._resizeBuffer(this._byteLength+byteLen,true);n=new Float32Array(this._buffer,this._byteLength);}n.set(data,0);this._byteLength+=byteLen;this._checkArrayUse();};_proto49.appendU16Array=function appendU16Array(data,len){this._resizeBuffer(this._byteLength+len*2,true);var u=new Uint16Array(this._buffer,this._byteLength,len);if(len==6){u[0]=data[0];u[1]=data[1];u[2]=data[2];u[3]=data[3];u[4]=data[4];u[5]=data[5];}else if(len>=100){u.set(new Uint16Array(data.buffer,0,len));}else {for(var i=0;i<len;i++){u[i]=data[i];}}this._byteLength+=len*2;this._checkArrayUse();};_proto49.appendEx=function appendEx(data,type){this._upload=true;var byteLen,n;byteLen=data.byteLength;this._resizeBuffer(this._byteLength+byteLen,true);n=new type(this._buffer,this._byteLength);n.set(data,0);this._byteLength+=byteLen;this._checkArrayUse();};_proto49.appendEx2=function appendEx2(data,type,dataLen,perDataLen){if(perDataLen===void 0){perDataLen=1;}this._upload=true;var byteLen,n;byteLen=dataLen*perDataLen;this._resizeBuffer(this._byteLength+byteLen,true);n=new type(this._buffer,this._byteLength);var i;for(i=0;i<dataLen;i++){n[i]=data[i];}this._byteLength+=byteLen;this._checkArrayUse();};_proto49.getBuffer=function getBuffer(){return this._buffer;};_proto49.setNeedUpload=function setNeedUpload(){this._upload=true;};_proto49.getNeedUpload=function getNeedUpload(){return this._upload;};_proto49.upload=function upload(){var gl=LayaGL.instance;var scuess=this._bind_upload();gl.bindBuffer(this._bufferType,null);if(this._bufferType==gl.ARRAY_BUFFER)Buffer._bindedVertexBuffer=null;if(this._bufferType==gl.ELEMENT_ARRAY_BUFFER)Buffer._bindedIndexBuffer=null;BaseShader.activeShader=null;return scuess;};_proto49.subUpload=function subUpload(offset,dataStart,dataLength){var gl=LayaGL.instance;var scuess=this._bind_subUpload();gl.bindBuffer(this._bufferType,null);if(this._bufferType==gl.ARRAY_BUFFER)Buffer._bindedVertexBuffer=null;if(this._bufferType==gl.ELEMENT_ARRAY_BUFFER)Buffer._bindedIndexBuffer=null;BaseShader.activeShader=null;return scuess;};_proto49._disposeResource=function _disposeResource(){this._upload=true;this._uploadSize=0;};_proto49.clear=function clear(){this._byteLength=0;this._upload=true;};_createClass(Buffer2D,[{key:"bufferLength",get:function get(){return this._buffer.byteLength;}},{key:"byteLength",set:function set(value){this.setByteLength(value);}}]);return Buffer2D;}(Buffer);Buffer2D.FLOAT32=4;Buffer2D.SHORT=2;var IndexBuffer2D=/*#__PURE__*/function(_Buffer2D){_inheritsLoose(IndexBuffer2D,_Buffer2D);function IndexBuffer2D(bufferUsage){var _this11;if(bufferUsage===void 0){bufferUsage=0x88e4;}_this11=_Buffer2D.call(this)||this;_this11._bufferUsage=bufferUsage;_this11._bufferType=LayaGL.instance.ELEMENT_ARRAY_BUFFER;_this11._buffer=new ArrayBuffer(8);return _this11;}var _proto50=IndexBuffer2D.prototype;_proto50._checkArrayUse=function _checkArrayUse(){this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer));};_proto50.getUint16Array=function getUint16Array(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer));};_proto50._bindForVAO=function _bindForVAO(){var gl=LayaGL.instance;gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this._glBuffer);};_proto50.bind=function bind(){if(Buffer._bindedIndexBuffer!==this._glBuffer){var gl=LayaGL.instance;gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this._glBuffer);Buffer._bindedIndexBuffer=this._glBuffer;return true;}return false;};_proto50.destory=function destory(){this._uint16Array=null;this._buffer=null;};_proto50.disposeResource=function disposeResource(){this._disposeResource();};return IndexBuffer2D;}(Buffer2D);IndexBuffer2D.create=function(bufferUsage){if(bufferUsage===void 0){bufferUsage=0x88e4;}return new IndexBuffer2D(bufferUsage);};var VertexBuffer2D=/*#__PURE__*/function(_Buffer2D2){_inheritsLoose(VertexBuffer2D,_Buffer2D2);function VertexBuffer2D(vertexStride,bufferUsage){var _this12;_this12=_Buffer2D2.call(this)||this;_this12._vertexStride=vertexStride;_this12._bufferUsage=bufferUsage;_this12._bufferType=LayaGL.instance.ARRAY_BUFFER;_this12._buffer=new ArrayBuffer(8);_this12._floatArray32=new Float32Array(_this12._buffer);_this12._uint32Array=new Uint32Array(_this12._buffer);return _this12;}var _proto51=VertexBuffer2D.prototype;_proto51.getFloat32Array=function getFloat32Array(){return this._floatArray32;};_proto51.appendArray=function appendArray(data){var oldoff=this._byteLength>>2;this.setByteLength(this._byteLength+data.length*4);var vbdata=this.getFloat32Array();vbdata.set(data,oldoff);this._upload=true;};_proto51._checkArrayUse=function _checkArrayUse(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer));this._uint32Array&&(this._uint32Array=new Uint32Array(this._buffer));};_proto51.deleteBuffer=function deleteBuffer(){_Buffer2D2.prototype._disposeResource.call(this);};_proto51._bindForVAO=function _bindForVAO(){var gl=LayaGL.instance;gl.bindBuffer(gl.ARRAY_BUFFER,this._glBuffer);};_proto51.bind=function bind(){if(Buffer._bindedVertexBuffer!==this._glBuffer){var gl=LayaGL.instance;gl.bindBuffer(gl.ARRAY_BUFFER,this._glBuffer);Buffer._bindedVertexBuffer=this._glBuffer;return true;}return false;};_proto51.destroy=function destroy(){_Buffer2D2.prototype.destroy.call(this);this._byteLength=0;this._upload=true;this._buffer=null;this._floatArray32=null;};_createClass(VertexBuffer2D,[{key:"vertexStride",get:function get(){return this._vertexStride;}}]);return VertexBuffer2D;}(Buffer2D);VertexBuffer2D.create=function(vertexStride,bufferUsage){if(bufferUsage===void 0){bufferUsage=0x88e8;}return new VertexBuffer2D(vertexStride,bufferUsage);};var Mesh2D=/*#__PURE__*/function(){function Mesh2D(stride,vballoc,iballoc){this._stride=0;this.vertNum=0;this.indexNum=0;this._applied=false;this._quadNum=0;this.canReuse=false;this._stride=stride;this._vb=new VertexBuffer2D(stride,LayaGL.instance.DYNAMIC_DRAW);if(vballoc){this._vb._resizeBuffer(vballoc,false);}else {Config.webGL2D_MeshAllocMaxMem&&this._vb._resizeBuffer(64*1024*stride,false);}this._ib=new IndexBuffer2D();if(iballoc){this._ib._resizeBuffer(iballoc,false);}}var _proto52=Mesh2D.prototype;_proto52.cloneWithNewVB=function cloneWithNewVB(){var mesh=new Mesh2D(this._stride,0,0);mesh._ib=this._ib;mesh._quadNum=this._quadNum;mesh._attribInfo=this._attribInfo;return mesh;};_proto52.cloneWithNewVBIB=function cloneWithNewVBIB(){var mesh=new Mesh2D(this._stride,0,0);mesh._attribInfo=this._attribInfo;return mesh;};_proto52.getVBW=function getVBW(){this._vb.setNeedUpload();return this._vb;};_proto52.getVBR=function getVBR(){return this._vb;};_proto52.getIBR=function getIBR(){return this._ib;};_proto52.getIBW=function getIBW(){this._ib.setNeedUpload();return this._ib;};_proto52.createQuadIB=function createQuadIB(QuadNum){this._quadNum=QuadNum;this._ib._resizeBuffer(QuadNum*6*2,false);this._ib.byteLength=this._ib.bufferLength;var bd=this._ib.getUint16Array();var idx=0;var curvert=0;for(var i=0;i<QuadNum;i++){bd[idx++]=curvert;bd[idx++]=curvert+2;bd[idx++]=curvert+1;bd[idx++]=curvert;bd[idx++]=curvert+3;bd[idx++]=curvert+2;curvert+=4;}this._ib.setNeedUpload();};_proto52.setAttributes=function setAttributes(attribs){this._attribInfo=attribs;if(this._attribInfo.length%3!=0){throw 'Mesh2D setAttributes error!';}};_proto52.configVAO=function configVAO(gl){if(this._applied)return;this._applied=true;if(!this._vao){this._vao=new BufferState2D();}this._vao.bind();this._vb._bindForVAO();this._ib.setNeedUpload();this._ib._bind_uploadForVAO();var attribNum=this._attribInfo.length/3;var idx=0;for(var i=0;i<attribNum;i++){var _size=this._attribInfo[idx+1];var _type=this._attribInfo[idx];var _off=this._attribInfo[idx+2];gl.enableVertexAttribArray(i);gl.vertexAttribPointer(i,_size,_type,false,this._stride,_off);idx+=3;}this._vao.unBind();};_proto52.useMesh=function useMesh(gl){this._applied||this.configVAO(gl);this._vao.bind();this._vb.bind();this._ib._bind_upload()||this._ib.bind();this._vb._bind_upload()||this._vb.bind();};_proto52.getEleNum=function getEleNum(){return this._ib.getBuffer().byteLength/2;};_proto52.releaseMesh=function releaseMesh(){};_proto52.destroy=function destroy(){};_proto52.clearVB=function clearVB(){this._vb.clear();};return Mesh2D;}();Mesh2D._gvaoid=0;var MeshQuadTexture=/*#__PURE__*/function(_Mesh2D){_inheritsLoose(MeshQuadTexture,_Mesh2D);function MeshQuadTexture(){var _this13;_this13=_Mesh2D.call(this,MeshQuadTexture.const_stride,4,4)||this;_this13.canReuse=true;_this13.setAttributes(MeshQuadTexture._fixattriInfo);if(!MeshQuadTexture._fixib){_this13.createQuadIB(MeshQuadTexture._maxIB);MeshQuadTexture._fixib=_this13._ib;}else {_this13._ib=MeshQuadTexture._fixib;_this13._quadNum=MeshQuadTexture._maxIB;}return _this13;}MeshQuadTexture.__int__=function __int__(){MeshQuadTexture._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20];};MeshQuadTexture.getAMesh=function getAMesh(mainctx){var ret=null;if(MeshQuadTexture._POOL.length){ret=MeshQuadTexture._POOL.pop();}else ret=new MeshQuadTexture();mainctx&&ret._vb._resizeBuffer(64*1024*MeshQuadTexture.const_stride,false);return ret;};var _proto53=MeshQuadTexture.prototype;_proto53.releaseMesh=function releaseMesh(){this._vb.setByteLength(0);this.vertNum=0;this.indexNum=0;MeshQuadTexture._POOL.push(this);};_proto53.destroy=function destroy(){this._vb.destroy();this._vb.deleteBuffer();};_proto53.addQuad=function addQuad(pos,uv,color,useTex){var vb=this._vb;var vpos=vb._byteLength>>2;vb.setByteLength(vpos+MeshQuadTexture.const_stride<<2);var vbdata=vb._floatArray32||vb.getFloat32Array();var vbu32Arr=vb._uint32Array;var cpos=vpos;var useTexVal=useTex?0xff:0;vbdata[cpos++]=pos[0];vbdata[cpos++]=pos[1];vbdata[cpos++]=uv[0];vbdata[cpos++]=uv[1];vbu32Arr[cpos++]=color;vbu32Arr[cpos++]=useTexVal;vbdata[cpos++]=pos[2];vbdata[cpos++]=pos[3];vbdata[cpos++]=uv[2];vbdata[cpos++]=uv[3];vbu32Arr[cpos++]=color;vbu32Arr[cpos++]=useTexVal;vbdata[cpos++]=pos[4];vbdata[cpos++]=pos[5];vbdata[cpos++]=uv[4];vbdata[cpos++]=uv[5];vbu32Arr[cpos++]=color;vbu32Arr[cpos++]=useTexVal;vbdata[cpos++]=pos[6];vbdata[cpos++]=pos[7];vbdata[cpos++]=uv[6];vbdata[cpos++]=uv[7];vbu32Arr[cpos++]=color;vbu32Arr[cpos++]=useTexVal;vb._upload=true;};return MeshQuadTexture;}(Mesh2D);MeshQuadTexture.const_stride=24;MeshQuadTexture._maxIB=16*1024;MeshQuadTexture._POOL=[];var MeshTexture=/*#__PURE__*/function(_Mesh2D2){_inheritsLoose(MeshTexture,_Mesh2D2);function MeshTexture(){var _this14;_this14=_Mesh2D2.call(this,MeshTexture.const_stride,4,4)||this;_this14.canReuse=true;_this14.setAttributes(MeshTexture._fixattriInfo);return _this14;}MeshTexture.__init__=function __init__(){MeshTexture._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20];};MeshTexture.getAMesh=function getAMesh(mainctx){var ret;if(MeshTexture._POOL.length){ret=MeshTexture._POOL.pop();}else ret=new MeshTexture();mainctx&&ret._vb._resizeBuffer(64*1024*MeshTexture.const_stride,false);return ret;};var _proto54=MeshTexture.prototype;_proto54.addData=function addData(vertices,uvs,idx,matrix,rgba){var vb=this._vb;var ib=this._ib;var vertsz=vertices.length>>1;var startpos=vb.needSize(vertsz*MeshTexture.const_stride);var f32pos=startpos>>2;var vbdata=vb._floatArray32||vb.getFloat32Array();var vbu32Arr=vb._uint32Array;var ci=0;var m00=matrix.a;var m01=matrix.b;var m10=matrix.c;var m11=matrix.d;var tx=matrix.tx;var ty=matrix.ty;var i=0;for(i=0;i<vertsz;i++){var x=vertices[ci],y=vertices[ci+1];vbdata[f32pos]=x*m00+y*m10+tx;vbdata[f32pos+1]=x*m01+y*m11+ty;vbdata[f32pos+2]=uvs[ci];vbdata[f32pos+3]=uvs[ci+1];vbu32Arr[f32pos+4]=rgba;vbu32Arr[f32pos+5]=0xff;f32pos+=6;ci+=2;}vb.setNeedUpload();var vertN=this.vertNum;var sz=idx.length;var stib=ib.needSize(idx.byteLength);var cidx=ib.getUint16Array();var stibid=stib>>1;if(vertN>0){var end=stibid+sz;var si=0;for(i=stibid;i<end;i++,si++){cidx[i]=idx[si]+vertN;}}else {cidx.set(idx,stibid);}ib.setNeedUpload();this.vertNum+=vertsz;this.indexNum+=idx.length;};_proto54.releaseMesh=function releaseMesh(){this._vb.setByteLength(0);this._ib.setByteLength(0);this.vertNum=0;this.indexNum=0;MeshTexture._POOL.push(this);};_proto54.destroy=function destroy(){this._ib.destroy();this._vb.destroy();this._ib.disposeResource();this._vb.deleteBuffer();};return MeshTexture;}(Mesh2D);MeshTexture.const_stride=24;MeshTexture._POOL=[];var MeshVG=/*#__PURE__*/function(_Mesh2D3){_inheritsLoose(MeshVG,_Mesh2D3);function MeshVG(){var _this15;_this15=_Mesh2D3.call(this,MeshVG.const_stride,4,4)||this;_this15.canReuse=true;_this15.setAttributes(MeshVG._fixattriInfo);return _this15;}MeshVG.__init__=function __init__(){MeshVG._fixattriInfo=[5126,2,0,5121,4,8];};MeshVG.getAMesh=function getAMesh(mainctx){var ret;if(MeshVG._POOL.length){ret=MeshVG._POOL.pop();}else ret=new MeshVG();mainctx&&ret._vb._resizeBuffer(64*1024*MeshVG.const_stride,false);return ret;};var _proto55=MeshVG.prototype;_proto55.addVertAndIBToMesh=function addVertAndIBToMesh(ctx,points,rgba,ib){var startpos=this._vb.needSize(points.length/2*MeshVG.const_stride);var f32pos=startpos>>2;var vbdata=this._vb._floatArray32||this._vb.getFloat32Array();var vbu32Arr=this._vb._uint32Array;var ci=0;var sz=points.length/2;for(var i=0;i<sz;i++){vbdata[f32pos++]=points[ci];vbdata[f32pos++]=points[ci+1];ci+=2;vbu32Arr[f32pos++]=rgba;}this._vb.setNeedUpload();this._ib.append(new Uint16Array(ib));this._ib.setNeedUpload();this.vertNum+=sz;this.indexNum+=ib.length;};_proto55.releaseMesh=function releaseMesh(){this._vb.setByteLength(0);this._ib.setByteLength(0);this.vertNum=0;this.indexNum=0;MeshVG._POOL.push(this);};_proto55.destroy=function destroy(){this._ib.destroy();this._vb.destroy();this._ib.disposeResource();this._vb.deleteBuffer();};return MeshVG;}(Mesh2D);MeshVG.const_stride=12;MeshVG._POOL=[];var WebGLCacheAsNormalCanvas=/*#__PURE__*/function(){function WebGLCacheAsNormalCanvas(ctx,sp){this.submitStartPos=0;this.submitEndPos=0;this.touches=[];this.submits=[];this.sprite=null;this.meshlist=[];this.cachedClipInfo=new Matrix();this.oldTx=0;this.oldTy=0;this.invMat=new Matrix();this.context=ctx;this.sprite=sp;ctx._globalClipMatrix.copyTo(this.cachedClipInfo);}var _proto56=WebGLCacheAsNormalCanvas.prototype;_proto56.startRec=function startRec(){var context=this.context;if(context._charSubmitCache&&context._charSubmitCache._enable){context._charSubmitCache.enable(false,context);context._charSubmitCache.enable(true,context);}context._incache=true;this.touches.length=0;context.touches=this.touches;context._globalClipMatrix.copyTo(this.cachedClipInfo);this.submits.length=0;this.submitStartPos=context._submits._length;for(var i=0,sz=this.meshlist.length;i<sz;i++){var curm=this.meshlist[i];curm.canReuse?curm.releaseMesh():curm.destroy();}this.meshlist.length=0;this._mesh=MeshQuadTexture.getAMesh(false);this._pathMesh=MeshVG.getAMesh(false);this._triangleMesh=MeshTexture.getAMesh(false);this.meshlist.push(this._mesh);this.meshlist.push(this._pathMesh);this.meshlist.push(this._triangleMesh);context._curSubmit=SubmitBase.RENDERBASE;this._oldMesh=context._mesh;this._oldPathMesh=context._pathMesh;this._oldTriMesh=context._triangleMesh;this._oldMeshList=context.meshlist;context._mesh=this._mesh;context._pathMesh=this._pathMesh;context._triangleMesh=this._triangleMesh;context.meshlist=this.meshlist;this.oldTx=context._curMat.tx;this.oldTy=context._curMat.ty;context._curMat.tx=0;context._curMat.ty=0;context._curMat.copyTo(this.invMat);this.invMat.invert();};_proto56.endRec=function endRec(){var context=this.context;if(context._charSubmitCache&&context._charSubmitCache._enable){context._charSubmitCache.enable(false,context);context._charSubmitCache.enable(true,context);}var parsubmits=context._submits;this.submitEndPos=parsubmits._length;var num=this.submitEndPos-this.submitStartPos;for(var i=0;i<num;i++){this.submits.push(parsubmits[this.submitStartPos+i]);}parsubmits._length-=num;context._mesh=this._oldMesh;context._pathMesh=this._oldPathMesh;context._triangleMesh=this._oldTriMesh;context.meshlist=this._oldMeshList;context._curSubmit=SubmitBase.RENDERBASE;context._curMat.tx=this.oldTx;context._curMat.ty=this.oldTy;context.touches=null;context._incache=false;};_proto56.isCacheValid=function isCacheValid(){var curclip=this.context._globalClipMatrix;if(curclip.a!=this.cachedClipInfo.a||curclip.b!=this.cachedClipInfo.b||curclip.c!=this.cachedClipInfo.c||curclip.d!=this.cachedClipInfo.d||curclip.tx!=this.cachedClipInfo.tx||curclip.ty!=this.cachedClipInfo.ty)return false;return true;};_proto56.flushsubmit=function flushsubmit(){var curSubmit=SubmitBase.RENDERBASE;this.submits.forEach(function(subm){if(subm==SubmitBase.RENDERBASE)return;SubmitBase.preRender=curSubmit;curSubmit=subm;subm.renderSubmit();});};_proto56.releaseMem=function releaseMem(){};return WebGLCacheAsNormalCanvas;}();WebGLCacheAsNormalCanvas.matI=new Matrix();var texture_vs="/*\n\ttexture和fillrect使用的。\n*/\nattribute vec4 posuv;\nattribute vec4 attribColor;\nattribute vec4 attribFlags;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\t\t// 这个是全局的，不用再应用矩阵了。\nvarying vec2 cliped;\nuniform vec2 size;\nuniform vec2 clipOff;\t\t\t// 使用要把clip偏移。cacheas normal用. 只用了[0]\n#ifdef WORLDMAT\n\tuniform mat4 mmat;\n#endif\n#ifdef MVP3D\n\tuniform mat4 u_MvpMatrix;\n#endif\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\n\nvoid main() {\n\n\tvec4 pos = vec4(posuv.xy,0.,1.);\n#ifdef WORLDMAT\n\tpos=mmat*pos;\n#endif\n\tvec4 pos1  =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\n#ifdef MVP3D\n\tgl_Position=u_MvpMatrix*pos1;\n#else\n\tgl_Position=pos1;\n#endif\n\tv_texcoordAlpha.xy = posuv.zw;\n\t//v_texcoordAlpha.z = attribColor.a/255.0;\n\tv_color = attribColor/255.0;\n\tv_color.xyz*=v_color.w;//反正后面也要预乘\n\t\n\tv_useTex = attribFlags.r/255.0;\n\tfloat clipw = length(clipMatDir.xy);\n\tfloat cliph = length(clipMatDir.zw);\n\t\n\tvec2 clpos = clipMatPos.xy;\n\t#ifdef WORLDMAT\n\t\t// 如果有mmat，需要修改clipMatPos,因为 这是cacheas normal （如果不是就错了）， clipMatPos被去掉了偏移\n\t\tif(clipOff[0]>0.0){\n\t\t\tclpos.x+=mmat[3].x;\t//tx\t最简单处理\n\t\t\tclpos.y+=mmat[3].y;\t//ty\n\t\t}\n\t#endif\n\tvec2 clippos = pos.xy - clpos;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n\tif(clipw>20000. && cliph>20000.)\n\t\tcliped = vec2(0.5,0.5);\n\telse {\n\t\t//转成0到1之间。/clipw/clipw 表示clippos与normalize之后的clip朝向点积之后，再除以clipw\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n\t}\n\n}";var texture_ps="/*\n\ttexture和fillrect使用的。\n*/\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\nuniform sampler2D texture;\nvarying vec2 cliped;\n\n#ifdef BLUR_FILTER\nuniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoordAlpha.xy-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}\n#endif\n\n#ifdef COLOR_FILTER\nuniform vec4 colorAlpha;\nuniform mat4 colorMat;\n#endif\n\n#ifdef GLOW_FILTER\nuniform vec4 u_color;\nuniform vec4 u_blurInfo1;\nuniform vec4 u_blurInfo2;\n#endif\n\n#ifdef COLOR_ADD\nuniform vec4 colorAdd;\n#endif\n\n#ifdef FILLTEXTURE\t\nuniform vec4 u_TexRange;//startu,startv,urange, vrange\n#endif\nvoid main() {\n\tif(cliped.x<0.) discard;\n\tif(cliped.x>1.) discard;\n\tif(cliped.y<0.) discard;\n\tif(cliped.y>1.) discard;\n\t\n#ifdef FILLTEXTURE\t\n   vec4 color= texture2D(texture, fract(v_texcoordAlpha.xy)*u_TexRange.zw + u_TexRange.xy);\n#else\n   vec4 color= texture2D(texture, v_texcoordAlpha.xy);\n#endif\n\n   if(v_useTex<=0.)color = vec4(1.,1.,1.,1.);\n   color.a*=v_color.w;\n   //color.rgb*=v_color.w;\n   color.rgb*=v_color.rgb;\n   gl_FragColor=color;\n   \n   #ifdef COLOR_ADD\n\tgl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\n\tgl_FragColor.xyz *= colorAdd.a;\n   #endif\n   \n   #ifdef BLUR_FILTER\n\tgl_FragColor =   blur();\n\tgl_FragColor.w*=v_color.w;   \n   #endif\n   \n   #ifdef COLOR_FILTER\n\tmat4 alphaMat =colorMat;\n\n\talphaMat[0][3] *= gl_FragColor.a;\n\talphaMat[1][3] *= gl_FragColor.a;\n\talphaMat[2][3] *= gl_FragColor.a;\n\n\tgl_FragColor = gl_FragColor * alphaMat;\n\tgl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n   #endif\n   \n   #ifdef GLOW_FILTER\n\tconst float c_IterationTime = 10.0;\n\tfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\n\tvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n\tvec2 vec2FilterDir = vec2(-(u_blurInfo1.z)/u_blurInfo2.x,-(u_blurInfo1.w)/u_blurInfo2.y);\n\tvec2 vec2FilterOff = vec2(u_blurInfo1.x/u_blurInfo2.x/c_IterationTime * 2.0,u_blurInfo1.y/u_blurInfo2.y/c_IterationTime * 2.0);\n\tfloat maxNum = u_blurInfo1.x * u_blurInfo1.y;\n\tvec2 vec2Off = vec2(0.0,0.0);\n\tfloat floatOff = c_IterationTime/2.0;\n\tfor(float i = 0.0;i<=c_IterationTime; ++i){\n\t\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\t\tvec4Color += texture2D(texture, v_texcoordAlpha.xy + vec2FilterDir + vec2Off)/floatIterationTotalTime;\n\t\t}\n\t}\n\tgl_FragColor = vec4(u_color.rgb,vec4Color.a * u_blurInfo2.z);\n\tgl_FragColor.rgb *= gl_FragColor.a;   \n   #endif\n   \n}";var prime_vs="attribute vec4 position;\nattribute vec4 attribColor;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\n#ifdef WORLDMAT\n\tuniform mat4 mmat;\n#endif\nuniform mat4 u_mmat2;\n//uniform vec2 u_pos;\nuniform vec2 size;\nvarying vec4 color;\n//vec4 dirxy=vec4(0.9,0.1, -0.1,0.9);\n//vec4 clip=vec4(100.,30.,300.,600.);\nvarying vec2 cliped;\nvoid main(){\n\t\n#ifdef WORLDMAT\n\tvec4 pos=mmat*vec4(position.xy,0.,1.);\n\tgl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n#else\n\tgl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n#endif\t\n\tfloat clipw = length(clipMatDir.xy);\n\tfloat cliph = length(clipMatDir.zw);\n\tvec2 clippos = position.xy - clipMatPos.xy;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n\tif(clipw>20000. && cliph>20000.)\n\t\tcliped = vec2(0.5,0.5);\n\telse {\n\t\t//clipdir是带缩放的方向，由于上面clippos是在缩放后的空间计算的，所以需要把方向先normalize一下\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n\t}\n  //pos2d.x = dot(clippos,dirx);\n  color=attribColor/255.;\n}";var prime_ps="precision mediump float;\n//precision mediump float;\nvarying vec4 color;\n//uniform float alpha;\nvarying vec2 cliped;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor= color;// vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=color.a;\n\tif(cliped.x<0.) discard;\n\tif(cliped.x>1.) discard;\n\tif(cliped.y<0.) discard;\n\tif(cliped.y>1.) discard;\n}";var skin_vs="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}";var skin_ps="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}";var Shader2D=/*#__PURE__*/function(){function Shader2D(){this.ALPHA=1;this.defines=new ShaderDefines2D();this.shaderType=0;this.fillStyle=DrawStyle.DEFAULT;this.strokeStyle=DrawStyle.DEFAULT;}var _proto57=Shader2D.prototype;_proto57.destroy=function destroy(){this.defines=null;this.filters=null;};Shader2D.__init__=function __init__(){Shader.preCompile2D(0,ShaderDefines2D.TEXTURE2D,texture_vs,texture_ps,null);Shader.preCompile2D(0,ShaderDefines2D.PRIMITIVE,prime_vs,prime_ps,null);Shader.preCompile2D(0,ShaderDefines2D.SKINMESH,skin_vs,skin_ps,null);};return Shader2D;}();var SkinMeshBuffer=/*#__PURE__*/function(){function SkinMeshBuffer(){var gl=LayaGL.instance;this.ib=IndexBuffer2D.create(gl.DYNAMIC_DRAW);this.vb=VertexBuffer2D.create(8);}SkinMeshBuffer.getInstance=function getInstance(){return SkinMeshBuffer.instance=SkinMeshBuffer.instance||new SkinMeshBuffer();};var _proto58=SkinMeshBuffer.prototype;_proto58.addSkinMesh=function addSkinMesh(skinMesh){skinMesh.getData2(this.vb,this.ib,this.vb._byteLength/32);};_proto58.reset=function reset(){this.vb.clear();this.ib.clear();};return SkinMeshBuffer;}();var BasePoly=/*#__PURE__*/function(){function BasePoly(){}BasePoly.createLine2=function createLine2(p,indices,lineWidth,indexBase,outVertex,loop){if(p.length<4)return null;var points=BasePoly.tempData.length>p.length+2?BasePoly.tempData:new Array(p.length+2);points[0]=p[0];points[1]=p[1];var newlen=2;var i=0;var length=p.length;for(i=2;i<length;i+=2){if(Math.abs(p[i]-p[i-2])+Math.abs(p[i+1]-p[i-1])>0.01){points[newlen++]=p[i];points[newlen++]=p[i+1];}}if(loop&&Math.abs(p[0]-points[newlen-2])+Math.abs(p[1]-points[newlen-1])>0.01){points[newlen++]=p[0];points[newlen++]=p[1];}var result=outVertex;length=newlen/2;var w=lineWidth/2;var px,py,p1x,p1y,p2x,p2y,p3x,p3y;var perpx,perpy,perp2x,perp2y;var a1,b1,c1,a2,b2,c2;var denom,dist;p1x=points[0];p1y=points[1];p2x=points[2];p2y=points[3];perpx=-(p1y-p2y);perpy=p1x-p2x;dist=Math.sqrt(perpx*perpx+perpy*perpy);perpx=perpx/dist*w;perpy=perpy/dist*w;result.push(p1x-perpx,p1y-perpy,p1x+perpx,p1y+perpy);for(i=1;i<length-1;i++){p1x=points[(i-1)*2];p1y=points[(i-1)*2+1];p2x=points[i*2];p2y=points[i*2+1];p3x=points[(i+1)*2];p3y=points[(i+1)*2+1];perpx=-(p1y-p2y);perpy=p1x-p2x;dist=Math.sqrt(perpx*perpx+perpy*perpy);perpx=perpx/dist*w;perpy=perpy/dist*w;perp2x=-(p2y-p3y);perp2y=p2x-p3x;dist=Math.sqrt(perp2x*perp2x+perp2y*perp2y);perp2x=perp2x/dist*w;perp2y=perp2y/dist*w;a1=-perpy+p1y-(-perpy+p2y);b1=-perpx+p2x-(-perpx+p1x);c1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y);a2=-perp2y+p3y-(-perp2y+p2y);b2=-perp2x+p2x-(-perp2x+p3x);c2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y);denom=a1*b2-a2*b1;if(Math.abs(denom)<0.1){denom+=10.1;result.push(p2x-perpx,p2y-perpy,p2x+perpx,p2y+perpy);continue;}px=(b1*c2-b2*c1)/denom;py=(a2*c1-a1*c2)/denom;result.push(px,py,p2x-(px-p2x),p2y-(py-p2y));}p1x=points[newlen-4];p1y=points[newlen-3];p2x=points[newlen-2];p2y=points[newlen-1];perpx=-(p1y-p2y);perpy=p1x-p2x;dist=Math.sqrt(perpx*perpx+perpy*perpy);perpx=perpx/dist*w;perpy=perpy/dist*w;result.push(p2x-perpx,p2y-perpy,p2x+perpx,p2y+perpy);for(i=1;i<length;i++){indices.push(indexBase+(i-1)*2,indexBase+(i-1)*2+1,indexBase+i*2+1,indexBase+i*2+1,indexBase+i*2,indexBase+(i-1)*2);}return result;};BasePoly.createLineTriangle=function createLineTriangle(path,color,width,loop,outvb,vbstride,outib){var points=path.slice();var ptlen=points.length;var p1x=points[0],p1y=points[1];var p2x=points[2],p2y=points[2];var len=0;var rp=0;var dx=0,dy=0;var pointnum=ptlen/2;if(pointnum<=1)return;if(pointnum==2){return;}var tmpData=new Array(pointnum*4);var realPtNum=0;var ci=0;for(var i=0;i<pointnum-1;i++){p1x=points[ci++],p1y=points[ci++];p2x=points[ci++],p2y=points[ci++];dx=p2x-p1x,dy=p2y-p1y;if(dx!=0&&dy!=0){len=Math.sqrt(dx*dx+dy*dy);if(len>1e-3){rp=realPtNum*4;tmpData[rp]=p1x;tmpData[rp+1]=p1y;tmpData[rp+2]=dx/len;tmpData[rp+3]=dy/len;realPtNum++;}}}if(loop){p1x=points[ptlen-2],p1y=points[ptlen-1];p2x=points[0],p2y=points[1];dx=p2x-p1x,dy=p2y-p1y;if(dx!=0&&dy!=0){len=Math.sqrt(dx*dx+dy*dy);if(len>1e-3){rp=realPtNum*4;tmpData[rp]=p1x;tmpData[rp+1]=p1y;tmpData[rp+2]=dx/len;tmpData[rp+3]=dy/len;realPtNum++;}}}else {rp=realPtNum*4;tmpData[rp]=p1x;tmpData[rp+1]=p1y;tmpData[rp+2]=dx/len;tmpData[rp+3]=dy/len;realPtNum++;}ci=0;for(i=0;i<pointnum;i++){p1x=points[ci],p1y=points[ci+1];p2x=points[ci+2],p2y=points[ci+3];}};return BasePoly;}();BasePoly.tempData=new Array(256);var EarcutNode=function EarcutNode(i,x,y){this.i=i;this.x=x;this.y=y;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false;};var Earcut=/*#__PURE__*/function(){function Earcut(){}Earcut.earcut=function earcut(data,holeIndices,dim){dim=dim||2;var hasHoles=holeIndices&&holeIndices.length,outerLen=hasHoles?holeIndices[0]*dim:data.length,outerNode=Earcut.linkedList(data,0,outerLen,dim,true),triangles=[];if(!outerNode)return triangles;var minX,minY,maxX,maxY,x,y,invSize;if(hasHoles)outerNode=Earcut.eliminateHoles(data,holeIndices,outerNode,dim);if(data.length>80*dim){minX=maxX=data[0];minY=maxY=data[1];for(var i=dim;i<outerLen;i+=dim){x=data[i];y=data[i+1];if(x<minX)minX=x;if(y<minY)minY=y;if(x>maxX)maxX=x;if(y>maxY)maxY=y;}invSize=Math.max(maxX-minX,maxY-minY);invSize=invSize!==0?1/invSize:0;}Earcut.earcutLinked(outerNode,triangles,dim,minX,minY,invSize);return triangles;};Earcut.linkedList=function linkedList(data,start,end,dim,clockwise){var i,last;if(clockwise===Earcut.signedArea(data,start,end,dim)>0){for(i=start;i<end;i+=dim){last=Earcut.insertNode(i,data[i],data[i+1],last);}}else {for(i=end-dim;i>=start;i-=dim){last=Earcut.insertNode(i,data[i],data[i+1],last);}}if(last&&Earcut.equals(last,last.next)){Earcut.removeNode(last);last=last.next;}return last;};Earcut.filterPoints=function filterPoints(start,end){if(!start)return start;if(!end)end=start;var p=start,again;do{again=false;if(!p.steiner&&(Earcut.equals(p,p.next)||Earcut.area(p.prev,p,p.next)===0)){Earcut.removeNode(p);p=end=p.prev;if(p===p.next)break;again=true;}else {p=p.next;}}while(again||p!==end);return end;};Earcut.earcutLinked=function earcutLinked(ear,triangles,dim,minX,minY,invSize,pass){if(pass===void 0){pass=null;}if(!ear)return;if(!pass&&invSize)Earcut.indexCurve(ear,minX,minY,invSize);var stop=ear,prev,next;while(ear.prev!==ear.next){prev=ear.prev;next=ear.next;if(invSize?Earcut.isEarHashed(ear,minX,minY,invSize):Earcut.isEar(ear)){triangles.push(prev.i/dim);triangles.push(ear.i/dim);triangles.push(next.i/dim);Earcut.removeNode(ear);ear=next.next;stop=next.next;continue;}ear=next;if(ear===stop){if(!pass){Earcut.earcutLinked(Earcut.filterPoints(ear,null),triangles,dim,minX,minY,invSize,1);}else if(pass===1){ear=Earcut.cureLocalIntersections(ear,triangles,dim);Earcut.earcutLinked(ear,triangles,dim,minX,minY,invSize,2);}else if(pass===2){Earcut.splitEarcut(ear,triangles,dim,minX,minY,invSize);}break;}}};Earcut.isEar=function isEar(ear){var a=ear.prev,b=ear,c=ear.next;if(Earcut.area(a,b,c)>=0)return false;var p=ear.next.next;while(p!==ear.prev){if(Earcut.pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&Earcut.area(p.prev,p,p.next)>=0)return false;p=p.next;}return true;};Earcut.isEarHashed=function isEarHashed(ear,minX,minY,invSize){var a=ear.prev,b=ear,c=ear.next;if(Earcut.area(a,b,c)>=0)return false;var minTX=a.x<b.x?a.x<c.x?a.x:c.x:b.x<c.x?b.x:c.x,minTY=a.y<b.y?a.y<c.y?a.y:c.y:b.y<c.y?b.y:c.y,maxTX=a.x>b.x?a.x>c.x?a.x:c.x:b.x>c.x?b.x:c.x,maxTY=a.y>b.y?a.y>c.y?a.y:c.y:b.y>c.y?b.y:c.y;var minZ=Earcut.zOrder(minTX,minTY,minX,minY,invSize),maxZ=Earcut.zOrder(maxTX,maxTY,minX,minY,invSize);var p=ear.nextZ;while(p&&p.z<=maxZ){if(p!==ear.prev&&p!==ear.next&&Earcut.pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&Earcut.area(p.prev,p,p.next)>=0)return false;p=p.nextZ;}p=ear.prevZ;while(p&&p.z>=minZ){if(p!==ear.prev&&p!==ear.next&&Earcut.pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&Earcut.area(p.prev,p,p.next)>=0)return false;p=p.prevZ;}return true;};Earcut.cureLocalIntersections=function cureLocalIntersections(start,triangles,dim){var p=start;do{var a=p.prev,b=p.next.next;if(!Earcut.equals(a,b)&&Earcut.intersects(a,p,p.next,b)&&Earcut.locallyInside(a,b)&&Earcut.locallyInside(b,a)){triangles.push(a.i/dim);triangles.push(p.i/dim);triangles.push(b.i/dim);Earcut.removeNode(p);Earcut.removeNode(p.next);p=start=b;}p=p.next;}while(p!==start);return p;};Earcut.splitEarcut=function splitEarcut(start,triangles,dim,minX,minY,invSize){var a=start;do{var b=a.next.next;while(b!==a.prev){if(a.i!==b.i&&Earcut.isValidDiagonal(a,b)){var c=Earcut.splitPolygon(a,b);a=Earcut.filterPoints(a,a.next);c=Earcut.filterPoints(c,c.next);Earcut.earcutLinked(a,triangles,dim,minX,minY,invSize);Earcut.earcutLinked(c,triangles,dim,minX,minY,invSize);return;}b=b.next;}a=a.next;}while(a!==start);};Earcut.eliminateHoles=function eliminateHoles(data,holeIndices,outerNode,dim){var queue=[],i,len,start,end,list;for(i=0,len=holeIndices.length;i<len;i++){start=holeIndices[i]*dim;end=i<len-1?holeIndices[i+1]*dim:data.length;list=Earcut.linkedList(data,start,end,dim,false);if(list===list.next)list.steiner=true;queue.push(Earcut.getLeftmost(list));}queue.sort(Earcut.compareX);for(i=0;i<queue.length;i++){Earcut.eliminateHole(queue[i],outerNode);outerNode=Earcut.filterPoints(outerNode,outerNode.next);}return outerNode;};Earcut.compareX=function compareX(a,b){return a.x-b.x;};Earcut.eliminateHole=function eliminateHole(hole,outerNode){outerNode=Earcut.findHoleBridge(hole,outerNode);if(outerNode){var b=Earcut.splitPolygon(outerNode,hole);Earcut.filterPoints(b,b.next);}};Earcut.findHoleBridge=function findHoleBridge(hole,outerNode){var p=outerNode,hx=hole.x,hy=hole.y,qx=-Infinity,m;do{if(hy<=p.y&&hy>=p.next.y&&p.next.y!==p.y){var x=p.x+(hy-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(x<=hx&&x>qx){qx=x;if(x===hx){if(hy===p.y)return p;if(hy===p.next.y)return p.next;}m=p.x<p.next.x?p:p.next;}}p=p.next;}while(p!==outerNode);if(!m)return null;if(hx===qx)return m.prev;var stop=m,mx=m.x,my=m.y,tanMin=Infinity,tan;p=m.next;while(p!==stop){if(hx>=p.x&&p.x>=mx&&hx!==p.x&&Earcut.pointInTriangle(hy<my?hx:qx,hy,mx,my,hy<my?qx:hx,hy,p.x,p.y)){tan=Math.abs(hy-p.y)/(hx-p.x);if((tan<tanMin||tan===tanMin&&p.x>m.x)&&Earcut.locallyInside(p,hole)){m=p;tanMin=tan;}}p=p.next;}return m;};Earcut.indexCurve=function indexCurve(start,minX,minY,invSize){var p=start;do{if(p.z===null)p.z=Earcut.zOrder(p.x,p.y,minX,minY,invSize);p.prevZ=p.prev;p.nextZ=p.next;p=p.next;}while(p!==start);p.prevZ.nextZ=null;p.prevZ=null;Earcut.sortLinked(p);};Earcut.sortLinked=function sortLinked(list){var i,p,q,e,tail,numMerges,pSize,qSize,inSize=1;do{p=list;list=null;tail=null;numMerges=0;while(p){numMerges++;q=p;pSize=0;for(i=0;i<inSize;i++){pSize++;q=q.nextZ;if(!q)break;}qSize=inSize;while(pSize>0||qSize>0&&q){if(pSize!==0&&(qSize===0||!q||p.z<=q.z)){e=p;p=p.nextZ;pSize--;}else {e=q;q=q.nextZ;qSize--;}if(tail)tail.nextZ=e;else list=e;e.prevZ=tail;tail=e;}p=q;}tail.nextZ=null;inSize*=2;}while(numMerges>1);return list;};Earcut.zOrder=function zOrder(x,y,minX,minY,invSize){x=32767*(x-minX)*invSize;y=32767*(y-minY)*invSize;x=(x|x<<8)&0x00FF00FF;x=(x|x<<4)&0x0F0F0F0F;x=(x|x<<2)&0x33333333;x=(x|x<<1)&0x55555555;y=(y|y<<8)&0x00FF00FF;y=(y|y<<4)&0x0F0F0F0F;y=(y|y<<2)&0x33333333;y=(y|y<<1)&0x55555555;return x|y<<1;};Earcut.getLeftmost=function getLeftmost(start){var p=start,leftmost=start;do{if(p.x<leftmost.x)leftmost=p;p=p.next;}while(p!==start);return leftmost;};Earcut.pointInTriangle=function pointInTriangle(ax,ay,bx,by,cx,cy,px,py){return (cx-px)*(ay-py)-(ax-px)*(cy-py)>=0&&(ax-px)*(by-py)-(bx-px)*(ay-py)>=0&&(bx-px)*(cy-py)-(cx-px)*(by-py)>=0;};Earcut.isValidDiagonal=function isValidDiagonal(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!Earcut.intersectsPolygon(a,b)&&Earcut.locallyInside(a,b)&&Earcut.locallyInside(b,a)&&Earcut.middleInside(a,b);};Earcut.area=function area(p,q,r){return (q.y-p.y)*(r.x-q.x)-(q.x-p.x)*(r.y-q.y);};Earcut.equals=function equals(p1,p2){return p1.x===p2.x&&p1.y===p2.y;};Earcut.intersects=function intersects(p1,q1,p2,q2){if(Earcut.equals(p1,q1)&&Earcut.equals(p2,q2)||Earcut.equals(p1,q2)&&Earcut.equals(p2,q1))return true;return Earcut.area(p1,q1,p2)>0!==Earcut.area(p1,q1,q2)>0&&Earcut.area(p2,q2,p1)>0!==Earcut.area(p2,q2,q1)>0;};Earcut.intersectsPolygon=function intersectsPolygon(a,b){var p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==b.i&&p.next.i!==b.i&&Earcut.intersects(p,p.next,a,b))return true;p=p.next;}while(p!==a);return false;};Earcut.locallyInside=function locallyInside(a,b){return Earcut.area(a.prev,a,a.next)<0?Earcut.area(a,b,a.next)>=0&&Earcut.area(a,a.prev,b)>=0:Earcut.area(a,b,a.prev)<0||Earcut.area(a,a.next,b)<0;};Earcut.middleInside=function middleInside(a,b){var p=a,inside=false,px=(a.x+b.x)/2,py=(a.y+b.y)/2;do{if(p.y>py!==p.next.y>py&&p.next.y!==p.y&&px<(p.next.x-p.x)*(py-p.y)/(p.next.y-p.y)+p.x)inside=!inside;p=p.next;}while(p!==a);return inside;};Earcut.splitPolygon=function splitPolygon(a,b){var a2=new EarcutNode(a.i,a.x,a.y),b2=new EarcutNode(b.i,b.x,b.y),an=a.next,bp=b.prev;a.next=b;b.prev=a;a2.next=an;an.prev=a2;b2.next=a2;a2.prev=b2;bp.next=b2;b2.prev=bp;return b2;};Earcut.insertNode=function insertNode(i,x,y,last){var p=new EarcutNode(i,x,y);if(!last){p.prev=p;p.next=p;}else {p.next=last.next;p.prev=last;last.next.prev=p;last.next=p;}return p;};Earcut.removeNode=function removeNode(p){p.next.prev=p.prev;p.prev.next=p.next;if(p.prevZ)p.prevZ.nextZ=p.nextZ;if(p.nextZ)p.nextZ.prevZ=p.prevZ;};Earcut.signedArea=function signedArea(data,start,end,dim){var sum=0;for(var i=start,j=end-dim;i<end;i+=dim){sum+=(data[j]-data[i])*(data[i+1]+data[j+1]);j=i;}return sum;};return Earcut;}();var CONST3D2D=function CONST3D2D(){};CONST3D2D.BYTES_PE=4;CONST3D2D.BYTES_PIDX=2;CONST3D2D.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];CONST3D2D.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1];CONST3D2D.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0];CONST3D2D._TMPARRAY=[];CONST3D2D._OFFSETX=0;CONST3D2D._OFFSETY=0;var Submit=/*#__PURE__*/function(_SubmitBase){_inheritsLoose(Submit,_SubmitBase);function Submit(renderType){if(renderType===void 0){renderType=SubmitBase.TYPE_2D;}return _SubmitBase.call(this,renderType)||this;}var _proto59=Submit.prototype;_proto59.renderSubmit=function renderSubmit(){if(this._numEle===0||!this._mesh||this._numEle==0)return 1;var _tex=this.shaderValue.textureHost;if(_tex){var source=_tex._getSource();if(!source)return 1;this.shaderValue.texture=source;}var gl=WebGLContext.mainContext;this._mesh.useMesh(gl);this.shaderValue.upload();if(BlendMode.activeBlendFunction!==this._blendFn){WebGLContext.setBlend(gl,true);this._blendFn(gl);BlendMode.activeBlendFunction=this._blendFn;}gl.drawElements(gl.TRIANGLES,this._numEle,gl.UNSIGNED_SHORT,this._startIdx);Stat.renderBatches++;Stat.trianglesFaces+=this._numEle/3;return 1;};_proto59.releaseRender=function releaseRender(){if(SubmitBase.RENDERBASE==this)return;if(--this._ref<1){Submit.POOL[Submit._poolSize++]=this;this.shaderValue.release();this.shaderValue=null;this._mesh=null;this._parent&&(this._parent.releaseRender(),this._parent=null);}};Submit.create=function create(context,mesh,sv){var o=Submit._poolSize?Submit.POOL[--Submit._poolSize]:new Submit();o._ref=1;o._mesh=mesh;o._key.clear();o._startIdx=mesh.indexNum*CONST3D2D.BYTES_PIDX;o._numEle=0;var blendType=context._nBlendType;o._blendFn=context._targets?BlendMode.targetFns[blendType]:BlendMode.fns[blendType];o.shaderValue=sv;o.shaderValue.setValue(context._shader2D);var filters=context._shader2D.filters;filters&&o.shaderValue.setFilters(filters);return o;};Submit.createShape=function createShape(ctx,mesh,numEle,sv){var o=Submit._poolSize?Submit.POOL[--Submit._poolSize]:new Submit();o._mesh=mesh;o._numEle=numEle;o._startIdx=mesh.indexNum*2;o._ref=1;o.shaderValue=sv;o.shaderValue.setValue(ctx._shader2D);var blendType=ctx._nBlendType;o._key.blendShader=blendType;o._blendFn=ctx._targets?BlendMode.targetFns[blendType]:BlendMode.fns[blendType];return o;};return Submit;}(SubmitBase);Submit._poolSize=0;Submit.POOL=[];var SubmitCanvas=/*#__PURE__*/function(_SubmitBase2){_inheritsLoose(SubmitCanvas,_SubmitBase2);function SubmitCanvas(){var _this16;_this16=_SubmitBase2.call(this,SubmitBase.TYPE_2D)||this;_this16._matrix=new Matrix();_this16._matrix4=CONST3D2D.defaultMatrix4.concat();_this16.shaderValue=new Value2D(0,0);return _this16;}SubmitCanvas.create=function create(canvas,alpha,filters){var o=!SubmitCanvas.POOL._length?new SubmitCanvas():SubmitCanvas.POOL[--SubmitCanvas.POOL._length];o.canv=canvas;o._ref=1;o._numEle=0;var v=o.shaderValue;v.alpha=alpha;v.defines.setValue(0);filters&&filters.length&&v.setFilters(filters);return o;};var _proto60=SubmitCanvas.prototype;_proto60.renderSubmit=function renderSubmit(){var preAlpha=RenderState2D.worldAlpha;var preMatrix4=RenderState2D.worldMatrix4;var preMatrix=RenderState2D.worldMatrix;var preFilters=RenderState2D.worldFilters;var preWorldShaderDefines=RenderState2D.worldShaderDefines;var v=this.shaderValue;var m=this._matrix;var m4=this._matrix4;var mout=Matrix.TEMP;Matrix.mul(m,preMatrix,mout);m4[0]=mout.a;m4[1]=mout.b;m4[4]=mout.c;m4[5]=mout.d;m4[12]=mout.tx;m4[13]=mout.ty;RenderState2D.worldMatrix=mout.clone();RenderState2D.worldMatrix4=m4;RenderState2D.worldAlpha=RenderState2D.worldAlpha*v.alpha;if(v.filters&&v.filters.length){RenderState2D.worldFilters=v.filters;RenderState2D.worldShaderDefines=v.defines;}this.canv['flushsubmit']();RenderState2D.worldAlpha=preAlpha;RenderState2D.worldMatrix4=preMatrix4;RenderState2D.worldMatrix.destroy();RenderState2D.worldMatrix=preMatrix;RenderState2D.worldFilters=preFilters;RenderState2D.worldShaderDefines=preWorldShaderDefines;return 1;};_proto60.releaseRender=function releaseRender(){if(--this._ref<1){var cache=SubmitCanvas.POOL;this._mesh=null;cache[cache._length++]=this;}};_proto60.getRenderType=function getRenderType(){return SubmitBase.TYPE_CANVAS;};return SubmitCanvas;}(SubmitBase);SubmitCanvas.POOL=[];{SubmitCanvas.POOL._length=0;}var SubmitTarget=/*#__PURE__*/function(){function SubmitTarget(){this.blendType=0;this._ref=1;this._key=new SubmitKey();}var _proto61=SubmitTarget.prototype;_proto61.renderSubmit=function renderSubmit(){var gl=WebGLContext.mainContext;this._mesh.useMesh(gl);var target=this.srcRT;if(target){this.shaderValue.texture=target._getSource();this.shaderValue.upload();this.blend();Stat.renderBatches++;Stat.trianglesFaces+=this._numEle/3;gl.drawElements(gl.TRIANGLES,this._numEle,gl.UNSIGNED_SHORT,this._startIdx);}return 1;};_proto61.blend=function blend(){if(BlendMode.activeBlendFunction!==BlendMode.fns[this.blendType]){var gl=WebGLContext.mainContext;gl.enable(gl.BLEND);BlendMode.fns[this.blendType](gl);BlendMode.activeBlendFunction=BlendMode.fns[this.blendType];}};_proto61.getRenderType=function getRenderType(){return 0;};_proto61.releaseRender=function releaseRender(){if(--this._ref<1){var pool=SubmitTarget.POOL;pool[pool._length++]=this;}};SubmitTarget.create=function create(context,mesh,sv,rt){var o=SubmitTarget.POOL._length?SubmitTarget.POOL[--SubmitTarget.POOL._length]:new SubmitTarget();o._mesh=mesh;o.srcRT=rt;o._startIdx=mesh.indexNum*CONST3D2D.BYTES_PIDX;o._ref=1;o._key.clear();o._numEle=0;o.blendType=context._nBlendType;o._key.blendShader=o.blendType;o.shaderValue=sv;o.shaderValue.setValue(context._shader2D);if(context._colorFiler){var ft=context._colorFiler;sv.defines.add(ft.type);sv.colorMat=ft._mat;sv.colorAlpha=ft._alpha;}return o;};return SubmitTarget;}();SubmitTarget.POOL=[];{SubmitTarget.POOL._length=0;}var SubmitTexture=/*#__PURE__*/function(_SubmitBase3){_inheritsLoose(SubmitTexture,_SubmitBase3);function SubmitTexture(renderType){if(renderType===void 0){renderType=SubmitBase.TYPE_2D;}return _SubmitBase3.call(this,renderType)||this;}var _proto62=SubmitTexture.prototype;_proto62.releaseRender=function releaseRender(){if(--this._ref<1){SubmitTexture.POOL[SubmitTexture._poolSize++]=this;this.shaderValue.release();this._mesh=null;this._parent&&(this._parent.releaseRender(),this._parent=null);}};_proto62.renderSubmit=function renderSubmit(){if(this._numEle===0)return 1;var tex=this.shaderValue.textureHost;if(tex){var source=tex?tex._getSource():null;if(!source)return 1;}var gl=WebGLContext.mainContext;this._mesh.useMesh(gl);var lastSubmit=SubmitBase.preRender;var prekey=SubmitBase.preRender._key;if(this._key.blendShader===0&&this._key.submitType===prekey.submitType&&this._key.blendShader===prekey.blendShader&&BaseShader.activeShader&&SubmitBase.preRender.clipInfoID==this.clipInfoID&&lastSubmit.shaderValue.defines._value===this.shaderValue.defines._value&&(this.shaderValue.defines._value&ShaderDefines2D.NOOPTMASK)==0){BaseShader.activeShader.uploadTexture2D(source);}else {if(BlendMode.activeBlendFunction!==this._blendFn){WebGLContext.setBlend(gl,true);this._blendFn(gl);BlendMode.activeBlendFunction=this._blendFn;}this.shaderValue.texture=source;this.shaderValue.upload();}gl.drawElements(gl.TRIANGLES,this._numEle,gl.UNSIGNED_SHORT,this._startIdx);Stat.renderBatches++;Stat.trianglesFaces+=this._numEle/3;return 1;};SubmitTexture.create=function create(context,mesh,sv){var o=SubmitTexture._poolSize?SubmitTexture.POOL[--SubmitTexture._poolSize]:new SubmitTexture(SubmitBase.TYPE_TEXTURE);o._mesh=mesh;o._key.clear();o._key.submitType=SubmitBase.KEY_DRAWTEXTURE;o._ref=1;o._startIdx=mesh.indexNum*CONST3D2D.BYTES_PIDX;o._numEle=0;var blendType=context._nBlendType;o._key.blendShader=blendType;o._blendFn=context._targets?BlendMode.targetFns[blendType]:BlendMode.fns[blendType];o.shaderValue=sv;if(context._colorFiler){var ft=context._colorFiler;sv.defines.add(ft.type);sv.colorMat=ft._mat;sv.colorAlpha=ft._alpha;}return o;};return SubmitTexture;}(SubmitBase);SubmitTexture._poolSize=0;SubmitTexture.POOL=[];var CharSubmitCache=/*#__PURE__*/function(){function CharSubmitCache(){this._data=[];this._ndata=0;this._clipid=-1;this._clipMatrix=new Matrix();this._enable=false;}var _proto63=CharSubmitCache.prototype;_proto63.clear=function clear(){this._tex=null;this._imgId=-1;this._ndata=0;this._enable=false;this._colorFiler=null;};_proto63.destroy=function destroy(){this.clear();this._data.length=0;this._data=null;};_proto63.add=function add(ctx,tex,imgid,pos,uv,color){if(this._ndata>0&&(this._tex!=tex||this._imgId!=imgid||this._clipid>=0&&this._clipid!=ctx._clipInfoID)){this.submit(ctx);}this._clipid=ctx._clipInfoID;ctx._globalClipMatrix.copyTo(this._clipMatrix);this._tex=tex;this._imgId=imgid;this._colorFiler=ctx._colorFiler;this._data[this._ndata]=pos;this._data[this._ndata+1]=uv;this._data[this._ndata+2]=color;this._ndata+=3;};_proto63.getPos=function getPos(){if(CharSubmitCache.__nPosPool==0)return new Array(8);return CharSubmitCache.__posPool[--CharSubmitCache.__nPosPool];};_proto63.enable=function enable(value,ctx){if(value===this._enable)return;this._enable=value;this._enable||this.submit(ctx);};_proto63.submit=function submit(ctx){var n=this._ndata;if(!n)return;var _mesh=ctx._mesh;var colorFiler=ctx._colorFiler;ctx._colorFiler=this._colorFiler;var submit=SubmitTexture.create(ctx,_mesh,Value2D.create(ShaderDefines2D.TEXTURE2D,0));ctx._submits[ctx._submits._length++]=ctx._curSubmit=submit;submit.shaderValue.textureHost=this._tex;submit._key.other=this._imgId;ctx._colorFiler=colorFiler;ctx._copyClipInfo(submit,this._clipMatrix);submit.clipInfoID=this._clipid;for(var i=0;i<n;i+=3){_mesh.addQuad(this._data[i],this._data[i+1],this._data[i+2],true);CharSubmitCache.__posPool[CharSubmitCache.__nPosPool++]=this._data[i];}n/=3;submit._numEle+=n*6;_mesh.indexNum+=n*6;_mesh.vertNum+=n*4;ctx._drawCount+=n;this._ndata=0;if(RenderInfo.loopCount%100==0)this._data.length=0;};return CharSubmitCache;}();CharSubmitCache.__posPool=[];CharSubmitCache.__nPosPool=0;var AtlasGrid=/*#__PURE__*/function(){function AtlasGrid(width,height,id){if(width===void 0){width=0;}if(height===void 0){height=0;}if(id===void 0){id=0;}this.atlasID=0;this._width=0;this._height=0;this._texCount=0;this._rowInfo=null;this._cells=null;this._used=0;this._cells=null;this._rowInfo=null;this.atlasID=id;this._init(width,height);}var _proto64=AtlasGrid.prototype;_proto64.addRect=function addRect(type,width,height,pt){if(!this._get(width,height,pt))return false;this._fill(pt.x,pt.y,width,height,type);this._texCount++;return true;};_proto64._release=function _release(){this._cells=null;this._rowInfo=null;};_proto64._init=function _init(width,height){this._width=width;this._height=height;this._release();if(this._width==0)return false;this._cells=new Uint8Array(this._width*this._height*3);this._rowInfo=new Uint8Array(this._height);this._used=0;this._clear();return true;};_proto64._get=function _get(width,height,pt){if(width>this._width||height>this._height){return false;}var rx=-1;var ry=-1;var nWidth=this._width;var nHeight=this._height;var pCellBox=this._cells;for(var y=0;y<nHeight;y++){if(this._rowInfo[y]<width)continue;for(var x=0;x<nWidth;){var tm=(y*nWidth+x)*3;if(pCellBox[tm]!=0||pCellBox[tm+1]<width||pCellBox[tm+2]<height){x+=pCellBox[tm+1];continue;}rx=x;ry=y;for(var xx=0;xx<width;xx++){if(pCellBox[3*xx+tm+2]<height){rx=-1;break;}}if(rx<0){x+=pCellBox[tm+1];continue;}pt.x=rx;pt.y=ry;return true;}}return false;};_proto64._fill=function _fill(x,y,w,h,type){var nWidth=this._width;var nHeghit=this._height;this._check(x+w<=nWidth&&y+h<=nHeghit);for(var yy=y;yy<h+y;++yy){this._check(this._rowInfo[yy]>=w);this._rowInfo[yy]-=w;for(var xx=0;xx<w;xx++){var tm=(x+yy*nWidth+xx)*3;this._check(this._cells[tm]==0);this._cells[tm]=type;this._cells[tm+1]=w;this._cells[tm+2]=h;}}if(x>0){for(yy=0;yy<h;++yy){var s=0;for(xx=x-1;xx>=0;--xx,++s){if(this._cells[((y+yy)*nWidth+xx)*3]!=0)break;}for(xx=s;xx>0;--xx){this._cells[((y+yy)*nWidth+x-xx)*3+1]=xx;this._check(xx>0);}}}if(y>0){for(xx=x;xx<x+w;++xx){s=0;for(yy=y-1;yy>=0;--yy,s++){if(this._cells[(xx+yy*nWidth)*3]!=0)break;}for(yy=s;yy>0;--yy){this._cells[(xx+(y-yy)*nWidth)*3+2]=yy;this._check(yy>0);}}}this._used+=w*h/(this._width*this._height);};_proto64._check=function _check(ret){if(ret==false){console.log("xtexMerger 错误啦");}};_proto64._clear=function _clear(){this._texCount=0;for(var y=0;y<this._height;y++){this._rowInfo[y]=this._width;}for(var i=0;i<this._height;i++){for(var j=0;j<this._width;j++){var tm=(i*this._width+j)*3;this._cells[tm]=0;this._cells[tm+1]=this._width-j;this._cells[tm+2]=this._width-i;}}};return AtlasGrid;}();var TextTexture=/*#__PURE__*/function(_Resource3){_inheritsLoose(TextTexture,_Resource3);function TextTexture(textureW,textureH){var _this17;_this17=_Resource3.call(this)||this;_this17._texW=0;_this17._texH=0;_this17.__destroyed=false;_this17._discardTm=0;_this17.genID=0;_this17.bitmap={id:0,_glTexture:null};_this17.curUsedCovRate=0;_this17.curUsedCovRateAtlas=0;_this17.lastTouchTm=0;_this17.ri=null;_this17._texW=textureW||TextTexture.gTextRender.atlasWidth;_this17._texH=textureH||TextTexture.gTextRender.atlasWidth;_this17.bitmap.id=_this17.id;_this17.lock=true;return _this17;}var _proto65=TextTexture.prototype;_proto65.recreateResource=function recreateResource(){if(this._source)return;var gl=LayaGL.instance;var glTex=this._source=gl.createTexture();this.bitmap._glTexture=glTex;WebGLContext.bindTexture(gl,gl.TEXTURE_2D,glTex);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,this._texW,this._texH,0,gl.RGBA,gl.UNSIGNED_BYTE,null);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);if(TextTexture.gTextRender.debugUV){this.fillWhite();}};_proto65.addChar=function addChar(data,x,y,uv){if(uv===void 0){uv=null;}if(TextTexture.gTextRender.isWan1Wan){return this.addCharCanvas(data,x,y,uv);}!this._source&&this.recreateResource();var gl=LayaGL.instance;WebGLContext.bindTexture(gl,gl.TEXTURE_2D,this._source);!ILaya.Render.isConchApp&&gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);var dt=data.data;if(data.data instanceof Uint8ClampedArray)dt=new Uint8Array(dt.buffer);gl.texSubImage2D(gl.TEXTURE_2D,0,x,y,data.width,data.height,gl.RGBA,gl.UNSIGNED_BYTE,dt);!ILaya.Render.isConchApp&&gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,false);var u0;var v0;var u1;var v1;u0=x/this._texW;v0=y/this._texH;u1=(x+data.width)/this._texW;v1=(y+data.height)/this._texH;uv=uv||new Array(8);uv[0]=u0,uv[1]=v0;uv[2]=u1,uv[3]=v0;uv[4]=u1,uv[5]=v1;uv[6]=u0,uv[7]=v1;return uv;};_proto65.addCharCanvas=function addCharCanvas(canv,x,y,uv){if(uv===void 0){uv=null;}!this._source&&this.recreateResource();var gl=LayaGL.instance;WebGLContext.bindTexture(gl,gl.TEXTURE_2D,this._source);!ILaya.Render.isConchApp&&gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);gl.texSubImage2D(gl.TEXTURE_2D,0,x,y,gl.RGBA,gl.UNSIGNED_BYTE,canv);!ILaya.Render.isConchApp&&gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,false);var u0;var v0;var u1;var v1;if(ILaya.Render.isConchApp){u0=x/this._texW;v0=y/this._texH;u1=(x+canv.width)/this._texW;v1=(y+canv.height)/this._texH;}else {u0=(x+1)/this._texW;v0=(y+1)/this._texH;u1=(x+canv.width-1)/this._texW;v1=(y+canv.height-1)/this._texH;}uv=uv||new Array(8);uv[0]=u0,uv[1]=v0;uv[2]=u1,uv[3]=v0;uv[4]=u1,uv[5]=v1;uv[6]=u0,uv[7]=v1;return uv;};_proto65.fillWhite=function fillWhite(){!this._source&&this.recreateResource();var gl=LayaGL.instance;var dt=new Uint8Array(this._texW*this._texH*4);dt.fill(0xff);gl.texSubImage2D(gl.TEXTURE_2D,0,0,0,this._texW,this._texH,gl.RGBA,gl.UNSIGNED_BYTE,dt);};_proto65.discard=function discard(){ILaya.stage.setGlobalRepaint();this.destroy();return;};TextTexture.getTextTexture=function getTextTexture(w,h){return new TextTexture(w,h);};_proto65.destroy=function destroy(){this.__destroyed=true;var gl=LayaGL.instance;this._source&&gl.deleteTexture(this._source);this._source=null;};TextTexture.clean=function clean(){var curtm=RenderInfo.loopStTm;if(TextTexture.cleanTm===0)TextTexture.cleanTm=curtm;if(curtm-TextTexture.cleanTm>=TextTexture.gTextRender.checkCleanTextureDt){for(var i=0;i<TextTexture.poolLen;i++){var p=TextTexture.pool[i];if(curtm-p._discardTm>=TextTexture.gTextRender.destroyUnusedTextureDt){p.destroy();TextTexture.pool[i]=TextTexture.pool[TextTexture.poolLen-1];TextTexture.poolLen--;i--;}}TextTexture.cleanTm=curtm;}};_proto65.touchRect=function touchRect(ri,curloop){if(this.lastTouchTm!=curloop){this.curUsedCovRate=0;this.curUsedCovRateAtlas=0;this.lastTouchTm=curloop;}var texw2=TextTexture.gTextRender.atlasWidth*TextTexture.gTextRender.atlasWidth;var gridw2=ILaya.TextAtlas.atlasGridW*ILaya.TextAtlas.atlasGridW;this.curUsedCovRate+=ri.bmpWidth*ri.bmpHeight/texw2;this.curUsedCovRateAtlas+=Math.ceil(ri.bmpWidth/ILaya.TextAtlas.atlasGridW)*Math.ceil(ri.bmpHeight/ILaya.TextAtlas.atlasGridW)/(texw2/gridw2);};_proto65._getSource=function _getSource(){return this._source;};_proto65.drawOnScreen=function drawOnScreen(x,y){};_createClass(TextTexture,[{key:"texture",get:function get(){return this;}}]);return TextTexture;}(Resource);TextTexture.gTextRender=null;TextTexture.pool=new Array(10);TextTexture.poolLen=0;TextTexture.cleanTm=0;var TextAtlas=/*#__PURE__*/function(){function TextAtlas(){this.texWidth=1024;this.texHeight=1024;this.texture=null;this.charMaps={};this.texHeight=this.texWidth=ILaya.TextRender.atlasWidth;this.texture=TextTexture.getTextTexture(this.texWidth,this.texHeight);if(this.texWidth/TextAtlas.atlasGridW>256){TextAtlas.atlasGridW=Math.ceil(this.texWidth/256);}this.atlasgrid=new AtlasGrid(this.texWidth/TextAtlas.atlasGridW,this.texHeight/TextAtlas.atlasGridW,this.texture.id);}var _proto66=TextAtlas.prototype;_proto66.setProtecteDist=function setProtecteDist(d){};_proto66.getAEmpty=function getAEmpty(w,h,pt){var find=this.atlasgrid.addRect(1,Math.ceil(w/TextAtlas.atlasGridW),Math.ceil(h/TextAtlas.atlasGridW),pt);if(find){pt.x*=TextAtlas.atlasGridW;pt.y*=TextAtlas.atlasGridW;}return find;};_proto66.destroy=function destroy(){for(var k in this.charMaps){var ri=this.charMaps[k];ri.deleted=true;}this.texture.discard();};_proto66.printDebugInfo=function printDebugInfo(){};_createClass(TextAtlas,[{key:"usedRate",get:function get(){return this.atlasgrid._used;}}]);return TextAtlas;}();TextAtlas.atlasGridW=16;var Event=/*#__PURE__*/function(){function Event(){}var _proto67=Event.prototype;_proto67.setTo=function setTo(type,currentTarget,target){this.type=type;this.currentTarget=currentTarget;this.target=target;return this;};_proto67.stopPropagation=function stopPropagation(){this._stoped=true;};_createClass(Event,[{key:"touches",get:function get(){if(!this.nativeEvent)return null;var arr=this.nativeEvent.touches;if(arr){var stage=ILaya.stage;for(var i=0,n=arr.length;i<n;i++){var e=arr[i];var point=Point.TEMP;point.setTo(e.clientX,e.clientY);stage._canvasTransform.invertTransformPoint(point);stage.transform.invertTransformPoint(point);e.stageX=point.x;e.stageY=point.y;}}return arr;}},{key:"altKey",get:function get(){return this.nativeEvent.altKey;}},{key:"ctrlKey",get:function get(){return this.nativeEvent.ctrlKey;}},{key:"shiftKey",get:function get(){return this.nativeEvent.shiftKey;}},{key:"charCode",get:function get(){return this.nativeEvent.charCode;}},{key:"keyLocation",get:function get(){return this.nativeEvent.location||this.nativeEvent.keyLocation;}},{key:"stageX",get:function get(){return ILaya.stage.mouseX;}},{key:"stageY",get:function get(){return ILaya.stage.mouseY;}}]);return Event;}();Event.EMPTY=new Event();Event.MOUSE_DOWN="mousedown";Event.MOUSE_UP="mouseup";Event.CLICK="click";Event.RIGHT_MOUSE_DOWN="rightmousedown";Event.RIGHT_MOUSE_UP="rightmouseup";Event.RIGHT_CLICK="rightclick";Event.MOUSE_MOVE="mousemove";Event.MOUSE_OVER="mouseover";Event.MOUSE_OUT="mouseout";Event.MOUSE_WHEEL="mousewheel";Event.ROLL_OVER="mouseover";Event.ROLL_OUT="mouseout";Event.DOUBLE_CLICK="doubleclick";Event.CHANGE="change";Event.CHANGED="changed";Event.RESIZE="resize";Event.ADDED="added";Event.REMOVED="removed";Event.DISPLAY="display";Event.UNDISPLAY="undisplay";Event.ERROR="error";Event.COMPLETE="complete";Event.LOADED="loaded";Event.READY="ready";Event.PROGRESS="progress";Event.INPUT="input";Event.RENDER="render";Event.OPEN="open";Event.MESSAGE="message";Event.CLOSE="close";Event.KEY_DOWN="keydown";Event.KEY_PRESS="keypress";Event.KEY_UP="keyup";Event.FRAME="enterframe";Event.DRAG_START="dragstart";Event.DRAG_MOVE="dragmove";Event.DRAG_END="dragend";Event.ENTER="enter";Event.SELECT="select";Event.BLUR="blur";Event.FOCUS="focus";Event.VISIBILITY_CHANGE="visibilitychange";Event.FOCUS_CHANGE="focuschange";Event.PLAYED="played";Event.PAUSED="paused";Event.STOPPED="stopped";Event.START="start";Event.END="end";Event.COMPONENT_ADDED="componentadded";Event.COMPONENT_REMOVED="componentremoved";Event.RELEASED="released";Event.LINK="link";Event.LABEL="label";Event.FULL_SCREEN_CHANGE="fullscreenchange";Event.DEVICE_LOST="devicelost";Event.TRANSFORM_CHANGED="transformchanged";Event.ANIMATION_CHANGED="animationchanged";Event.TRAIL_FILTER_CHANGE="trailfilterchange";Event.TRIGGER_ENTER="triggerenter";Event.TRIGGER_STAY="triggerstay";Event.TRIGGER_EXIT="triggerexit";var Texture=/*#__PURE__*/function(_EventDispatcher2){_inheritsLoose(Texture,_EventDispatcher2);function Texture(bitmap,uv,sourceWidth,sourceHeight){var _this18;if(bitmap===void 0){bitmap=null;}if(uv===void 0){uv=null;}if(sourceWidth===void 0){sourceWidth=0;}if(sourceHeight===void 0){sourceHeight=0;}_this18=_EventDispatcher2.call(this)||this;_this18.uvrect=[0,0,1,1];_this18._destroyed=false;_this18._referenceCount=0;_this18.$_GID=0;_this18.offsetX=0;_this18.offsetY=0;_this18._w=0;_this18._h=0;_this18.sourceWidth=0;_this18.sourceHeight=0;_this18.url=null;_this18.scaleRate=1;_this18.setTo(bitmap,uv,sourceWidth,sourceHeight);return _this18;}Texture.moveUV=function moveUV(offsetX,offsetY,uv){for(var i=0;i<8;i+=2){uv[i]+=offsetX;uv[i+1]+=offsetY;}return uv;};Texture.create=function create(source,x,y,width,height,offsetX,offsetY,sourceWidth,sourceHeight){if(offsetX===void 0){offsetX=0;}if(offsetY===void 0){offsetY=0;}if(sourceWidth===void 0){sourceWidth=0;}if(sourceHeight===void 0){sourceHeight=0;}return Texture._create(source,x,y,width,height,offsetX,offsetY,sourceWidth,sourceHeight);};Texture._create=function _create(source,x,y,width,height,offsetX,offsetY,sourceWidth,sourceHeight,outTexture){if(offsetX===void 0){offsetX=0;}if(offsetY===void 0){offsetY=0;}if(sourceWidth===void 0){sourceWidth=0;}if(sourceHeight===void 0){sourceHeight=0;}if(outTexture===void 0){outTexture=null;}var btex=source instanceof Texture;var uv=btex?source.uv:Texture.DEF_UV;var bitmap=btex?source.bitmap:source;if(bitmap.width&&x+width>bitmap.width)width=bitmap.width-x;if(bitmap.height&&y+height>bitmap.height)height=bitmap.height-y;var tex;if(outTexture){tex=outTexture;tex.setTo(bitmap,null,sourceWidth||width,sourceHeight||height);}else {tex=new Texture(bitmap,null,sourceWidth||width,sourceHeight||height);}tex.width=width;tex.height=height;tex.offsetX=offsetX;tex.offsetY=offsetY;var dwidth=1/bitmap.width;var dheight=1/bitmap.height;x*=dwidth;y*=dheight;width*=dwidth;height*=dheight;var u1=tex.uv[0],v1=tex.uv[1],u2=tex.uv[4],v2=tex.uv[5];var inAltasUVWidth=u2-u1,inAltasUVHeight=v2-v1;var oriUV=Texture.moveUV(uv[0],uv[1],[x,y,x+width,y,x+width,y+height,x,y+height]);tex.uv=new Float32Array([u1+oriUV[0]*inAltasUVWidth,v1+oriUV[1]*inAltasUVHeight,u2-(1-oriUV[2])*inAltasUVWidth,v1+oriUV[3]*inAltasUVHeight,u2-(1-oriUV[4])*inAltasUVWidth,v2-(1-oriUV[5])*inAltasUVHeight,u1+oriUV[6]*inAltasUVWidth,v2-(1-oriUV[7])*inAltasUVHeight]);var bitmapScale=bitmap.scaleRate;if(bitmapScale&&bitmapScale!=1){tex.sourceWidth/=bitmapScale;tex.sourceHeight/=bitmapScale;tex.width/=bitmapScale;tex.height/=bitmapScale;tex.scaleRate=bitmapScale;}else {tex.scaleRate=1;}return tex;};Texture.createFromTexture=function createFromTexture(texture,x,y,width,height){var texScaleRate=texture.scaleRate;if(texScaleRate!=1){x*=texScaleRate;y*=texScaleRate;width*=texScaleRate;height*=texScaleRate;}var rect=Rectangle.TEMP.setTo(x-texture.offsetX,y-texture.offsetY,width,height);var result=rect.intersection(Texture._rect1.setTo(0,0,texture.width,texture.height),Texture._rect2);if(result)var tex=Texture.create(texture,result.x,result.y,result.width,result.height,result.x-rect.x,result.y-rect.y,width,height);else return null;return tex;};var _proto68=Texture.prototype;_proto68._addReference=function _addReference(){this._bitmap&&this._bitmap._addReference();this._referenceCount++;};_proto68._removeReference=function _removeReference(){this._bitmap&&this._bitmap._removeReference();this._referenceCount--;};_proto68._getSource=function _getSource(cb){if(cb===void 0){cb=null;}if(this._destroyed||!this._bitmap)return null;this.recoverBitmap(cb);return this._bitmap.destroyed?null:this.bitmap._getSource();};_proto68._onLoaded=function _onLoaded(complete,context){if(!context);else if(context==this);else if(context instanceof Texture){var tex=context;Texture._create(context,0,0,tex.width,tex.height,0,0,tex.sourceWidth,tex.sourceHeight,this);}else {this.bitmap=context;this.sourceWidth=this._w=context.width;this.sourceHeight=this._h=context.height;}complete&&complete.run();this.event(Event.READY,this);};_proto68.getIsReady=function getIsReady(){return this._destroyed?false:this._bitmap?true:false;};_proto68.setTo=function setTo(bitmap,uv,sourceWidth,sourceHeight){if(bitmap===void 0){bitmap=null;}if(uv===void 0){uv=null;}if(sourceWidth===void 0){sourceWidth=0;}if(sourceHeight===void 0){sourceHeight=0;}this.bitmap=bitmap;this.sourceWidth=sourceWidth;this.sourceHeight=sourceHeight;if(bitmap){this._w=bitmap.width;this._h=bitmap.height;this.sourceWidth=this.sourceWidth||bitmap.width;this.sourceHeight=this.sourceHeight||bitmap.height;}this.uv=uv||Texture.DEF_UV;};_proto68.load=function load(url,complete){if(complete===void 0){complete=null;}if(!this._destroyed)ILaya.loader.load(url,Handler.create(this,this._onLoaded,[complete]),null,"htmlimage",1,true);};_proto68.getTexturePixels=function getTexturePixels(x,y,width,height){var st,dst,i;var tex2d=this.bitmap;var texw=this._w;var texh=this._h;var sourceWidth=this.sourceWidth;var sourceHeight=this.sourceHeight;var tex2dw=tex2d.width;var tex2dh=tex2d.height;var offsetX=this.offsetX;var offsetY=this.offsetY;var draww=width;var drawh=height;if(x+width>texw+offsetX)draww-=x+width-texw-offsetX;if(x+width>sourceWidth)width-=x+width-sourceWidth;if(y+height>texh+offsetY)drawh-=y+height-texh-offsetY;if(y+height>sourceHeight)height-=y+height-sourceHeight;if(width<=0||height<=0)return null;var marginL=offsetX>x?offsetX-x:0;var marginT=offsetY>y?offsetY-y:0;var rePosX=x>offsetX?x-offsetX:0;var rePosY=y>offsetY?y-offsetY:0;draww-=marginL;drawh-=marginT;var wstride=width*4;var pix=null;try{pix=tex2d.getPixels();}catch(e){}if(pix){if(x==0&&y==0&&width==tex2dw&&height==tex2dh)return pix;var _uv=this._uv.slice();var atlasPosX=Math.round(_uv[0]*tex2dw);var atlasPosY=Math.round(_uv[1]*tex2dh);var ret=new Uint8Array(width*height*4);wstride=tex2dw*4;dst=(atlasPosY+rePosY)*wstride;st=atlasPosX*4+rePosX*4+dst;for(i=0;i<drawh;i++){ret.set(pix.slice(st,st+draww*4),width*4*(i+marginT)+marginL*4);st+=wstride;}return ret;}var ctx=new ILaya.Context();ctx.size(width,height);ctx.asBitmap=true;var uv=null;if(x!=0||y!=0||width!=tex2dw||height!=tex2dh){uv=this._uv.slice();var stu=uv[0];var stv=uv[1];var uvw=uv[2]-stu;var uvh=uv[7]-stv;var uk=uvw/texw;var vk=uvh/texh;uv=[stu+rePosX*uk,stv+rePosY*vk,stu+(rePosX+draww)*uk,stv+rePosY*vk,stu+(rePosX+draww)*uk,stv+(rePosY+drawh)*vk,stu+rePosX*uk,stv+(rePosY+drawh)*vk];}ctx._drawTextureM(this,marginL,marginT,draww,drawh,null,1.0,uv);ctx._targets.start();ctx.flush();ctx._targets.end();ctx._targets.restore();var dt=ctx._targets.getData(0,0,width,height);ctx.destroy();ret=new Uint8Array(width*height*4);st=0;dst=(height-1)*wstride;for(i=height-1;i>=0;i--){ret.set(dt.slice(dst,dst+wstride),st);st+=wstride;dst-=wstride;}return ret;};_proto68.getPixels=function getPixels(x,y,width,height){if(window.conch){return this._nativeObj.getImageData(x,y,width,height);}else {return this.getTexturePixels(x,y,width,height);}};_proto68.recoverBitmap=function recoverBitmap(onok){if(onok===void 0){onok=null;}var url=this._bitmap.url;if(!this._destroyed&&(!this._bitmap||this._bitmap.destroyed)&&url){ILaya.loader.load(url,Handler.create(this,function(bit){this.bitmap=bit;onok&&onok();}),null,"htmlimage",1,true);}};_proto68.disposeBitmap=function disposeBitmap(){if(!this._destroyed&&this._bitmap){this._bitmap.destroy();}};_proto68.destroy=function destroy(force){if(force===void 0){force=false;}if(!this._destroyed){this._destroyed=true;var bit=this._bitmap;if(bit){bit._removeReference(this._referenceCount);if(bit.referenceCount===0||force)bit.destroy();bit=null;}if(this.url&&this===ILaya.loader.getRes(this.url))ILaya.Loader.clearRes(this.url);}};_createClass(Texture,[{key:"uv",get:function get(){return this._uv;},set:function set(value){this.uvrect[0]=Math.min(value[0],value[2],value[4],value[6]);this.uvrect[1]=Math.min(value[1],value[3],value[5],value[7]);this.uvrect[2]=Math.max(value[0],value[2],value[4],value[6])-this.uvrect[0];this.uvrect[3]=Math.max(value[1],value[3],value[5],value[7])-this.uvrect[1];this._uv=value;}},{key:"width",get:function get(){if(this._w)return this._w;if(!this.bitmap)return 0;return this.uv&&this.uv!==Texture.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width;},set:function set(value){this._w=value;this.sourceWidth||(this.sourceWidth=value);}},{key:"height",get:function get(){if(this._h)return this._h;if(!this.bitmap)return 0;return this.uv&&this.uv!==Texture.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height;},set:function set(value){this._h=value;this.sourceHeight||(this.sourceHeight=value);}},{key:"bitmap",get:function get(){return this._bitmap;},set:function set(value){this._bitmap&&this._bitmap._removeReference(this._referenceCount);this._bitmap=value;value&&value._addReference(this._referenceCount);}},{key:"destroyed",get:function get(){return this._destroyed;}}]);return Texture;}(EventDispatcher);Texture.DEF_UV=new Float32Array([0,0,1.0,0,1.0,1.0,0,1.0]);Texture.NO_UV=new Float32Array([0,0,0,0,0,0,0,0]);Texture.INV_UV=new Float32Array([0,1,1.0,1,1.0,0.0,0,0.0]);Texture._rect1=new Rectangle();Texture._rect2=new Rectangle();var FontInfo=/*#__PURE__*/function(){function FontInfo(font){this._font="14px Arial";this._family="Arial";this._size=14;this._italic=false;this._bold=false;this._id=FontInfo._gfontID++;this.setFont(font||this._font);}FontInfo.Parse=function Parse(font){if(font===FontInfo._lastFont){return FontInfo._lastFontInfo;}var r=FontInfo._cache[font];if(!r){r=FontInfo._cache[font]=new FontInfo(font);}FontInfo._lastFont=font;FontInfo._lastFontInfo=r;return r;};var _proto69=FontInfo.prototype;_proto69.setFont=function setFont(value){this._font=value;var _words=value.split(' ');var l=_words.length;if(l<2){if(l==1){if(_words[0].indexOf('px')>0){this._size=parseInt(_words[0]);}}return;}var szpos=-1;for(var i=0;i<l;i++){if(_words[i].indexOf('px')>0||_words[i].indexOf('pt')>0){szpos=i;this._size=parseInt(_words[i]);if(this._size<=0){console.error('font parse error:'+value);this._size=14;}break;}}var fpos=szpos+1;var familys=_words[fpos];fpos++;for(;fpos<l;fpos++){familys+=' '+_words[fpos];}this._family=familys.split(',')[0];this._italic=_words.indexOf('italic')>=0;this._bold=_words.indexOf('bold')>=0;};return FontInfo;}();FontInfo.EMPTY=new FontInfo(null);FontInfo._cache={};FontInfo._gfontID=0;FontInfo._lastFont='';var WordText=/*#__PURE__*/function(){function WordText(){this.save=[];this.toUpperCase=null;this.width=-1;this.pageChars=[];this.startID=0;this.startIDStroke=0;this.lastGCCnt=0;this.splitRender=false;this.scalex=1;this.scaley=1;}var _proto70=WordText.prototype;_proto70.setText=function setText(txt){this.changed=true;this._text=txt;this.width=-1;this.cleanCache();};_proto70.toString=function toString(){return this._text;};_proto70.charCodeAt=function charCodeAt(i){return this._text?this._text.charCodeAt(i):NaN;};_proto70.charAt=function charAt(i){return this._text?this._text.charAt(i):null;};_proto70.cleanCache=function cleanCache(){this.pageChars.forEach(function(p){var tex=p.tex;var words=p.words;if(p.words.length==1&&tex&&tex.ri){tex.destroy();}});this.pageChars=[];this.startID=0;this.scalex=1;this.scaley=1;};_createClass(WordText,[{key:"length",get:function get(){return this._text?this._text.length:0;}}]);return WordText;}();var CharRenderInfo=/*#__PURE__*/function(){function CharRenderInfo(){this["char"]='';this.deleted=false;this.uv=new Array(8);this.pos=0;this.orix=0;this.oriy=0;this.touchTick=0;this.isSpace=false;}var _proto71=CharRenderInfo.prototype;_proto71.touch=function touch(){var curLoop=RenderInfo.loopCount;if(this.touchTick!=curLoop){this.tex.touchRect(this,curLoop);}this.touchTick=curLoop;};return CharRenderInfo;}();var ICharRender=/*#__PURE__*/function(){function ICharRender(){this.fontsz=16;}var _proto72=ICharRender.prototype;_proto72.getWidth=function getWidth(font,str){return 0;};_proto72.scale=function scale(sx,sy){};_proto72.getCharBmp=function getCharBmp(_char,font,lineWidth,colStr,strokeColStr,size,margin_left,margin_top,margin_right,margin_bottom,rect){return null;};_createClass(ICharRender,[{key:"canvasWidth",get:function get(){return 0;},set:function set(w){}}]);return ICharRender;}();var Browser=/*#__PURE__*/function(){function Browser(){}Browser.__init__=function __init__(){var Laya=window.Laya||ILaya.Laya;if(Browser._window)return Browser._window;var win=Browser._window=window;var doc=Browser._document=win.document;var u=Browser.userAgent=win.navigator.userAgent;var maxTouchPoints=win.navigator.maxTouchPoints||0;var platform=win.navigator.platform;if(u.indexOf('AlipayMiniGame')>-1&&"my"in Browser.window){window.aliPayMiniGame(Laya,Laya);if(!Laya["ALIMiniAdapter"]){console.error("请先添加阿里小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-6-0");}else {Laya["ALIMiniAdapter"].enable();}}if(u.indexOf('OPPO')==-1&&u.indexOf("MiniGame")>-1&&"wx"in Browser.window){if("tt"in Browser.window){window.ttMiniGame(Laya,Laya);if(!Laya["TTMiniAdapter"]){console.error("请引入字节跳动小游戏的适配库");}else {Laya["TTMiniAdapter"].enable();}}else if("bl"in Browser.window){window.biliMiniGame(Laya,Laya);if(!Laya["BLMiniAdapter"]){console.error("请引入bilibili小游戏的适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-7-0");}else {Laya["BLMiniAdapter"].enable();}}else if("qq"in Browser.window){window.qqMiniGame(Laya,Laya);if(!Laya["QQMiniAdapter"]){console.error("请引入手机QQ小游戏的适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-0-0");}else {Laya["QQMiniAdapter"].enable();}}else {window.wxMiniGame(Laya,Laya);if(!Laya["MiniAdpter"]){console.error("请先添加小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0");}else {Laya["MiniAdpter"].enable();}}}if("hbs"in Browser.window){window.hwMiniGame(Laya,Laya);if(!Laya["HWMiniAdapter"]){console.error("请先添加小游戏适配库!");}else {Laya["HWMiniAdapter"].enable();}}if(u.indexOf("SwanGame")>-1){window.bdMiniGame(Laya,Laya);if(!Laya["BMiniAdapter"]){console.error("请先添加百度小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-1-0");}else {Laya["BMiniAdapter"].enable();}}if(u.indexOf('QuickGame')>-1){window.miMiniGame(Laya,Laya);if(!Laya["KGMiniAdapter"]){console.error("请先添加小米小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-2-0");}else {Laya["KGMiniAdapter"].enable();}}if(u.indexOf('OPPO')>-1&&u.indexOf('MiniGame')>-1){window.qgMiniGame(Laya,Laya);if(!Laya["QGMiniAdapter"]){console.error("请先添加OPPO小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-3-0");}else {Laya["QGMiniAdapter"].enable();}}if(u.indexOf('VVGame')>-1){window.vvMiniGame(Laya,Laya);if(!Laya["VVMiniAdapter"]){console.error("请先添加VIVO小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-4-0");}else {Laya["VVMiniAdapter"].enable();}}win.trace=console.log;win.requestAnimationFrame=win.requestAnimationFrame||win.webkitRequestAnimationFrame||win.mozRequestAnimationFrame||win.oRequestAnimationFrame||win.msRequestAnimationFrame||function(fun){return win.setTimeout(fun,1000/60);};var bodyStyle=doc.body.style;bodyStyle.margin=0;bodyStyle.overflow='hidden';bodyStyle['-webkit-user-select']='none';bodyStyle['-webkit-tap-highlight-color']='rgba(200,200,200,0)';var metas=doc.getElementsByTagName('meta');var i=0,flag=false,content='width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no';while(i<metas.length){var meta=metas[i];if(meta.name=='viewport'){meta.content=content;flag=true;break;}i++;}if(!flag){meta=doc.createElement('meta');meta.name='viewport',meta.content=content;doc.getElementsByTagName('head')[0].appendChild(meta);}Browser.onMobile=window.isConchApp?true:u.indexOf("Mobile")>-1;Browser.onIOS=!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);Browser.onIPhone=u.indexOf("iPhone")>-1;Browser.onMac=u.indexOf("Mac OS X")>-1;Browser.onIPad=u.indexOf("iPad")>-1||platform==='MacIntel'&&maxTouchPoints>1;Browser.onAndroid=u.indexOf('Android')>-1||u.indexOf('Adr')>-1;Browser.onWP=u.indexOf("Windows Phone")>-1;Browser.onQQBrowser=u.indexOf("QQBrowser")>-1;Browser.onMQQBrowser=u.indexOf("MQQBrowser")>-1||u.indexOf("Mobile")>-1&&u.indexOf("QQ")>-1;Browser.onIE=!!win.ActiveXObject||"ActiveXObject"in win;Browser.onWeiXin=u.indexOf('MicroMessenger')>-1;Browser.onSafari=u.indexOf("Safari")>-1;Browser.onPC=!Browser.onMobile;Browser.onMiniGame=u.indexOf('MiniGame')>-1;Browser.onBDMiniGame=u.indexOf('SwanGame')>-1;Browser.onLayaRuntime=!!Browser.window.conch;if(u.indexOf('OPPO')>-1&&u.indexOf('MiniGame')>-1){Browser.onQGMiniGame=true;Browser.onMiniGame=false;}else if("qq"in Browser.window&&u.indexOf('MiniGame')>-1){Browser.onQQMiniGame=true;Browser.onMiniGame=false;}else if("bl"in Browser.window&&u.indexOf('MiniGame')>-1){Browser.onBLMiniGame=true;Browser.onMiniGame=false;}else if("tt"in Browser.window&&u.indexOf('MiniGame')>-1){Browser.onTTMiniGame=true;Browser.onMiniGame=false;}Browser.onHWMiniGame="hbs"in Browser.window;Browser.onVVMiniGame=u.indexOf('VVGame')>-1;Browser.onKGMiniGame=u.indexOf('QuickGame')>-1;if(u.indexOf('AlipayMiniGame')>-1){Browser.onAlipayMiniGame=true;Browser.onMiniGame=false;}return win;};Browser.createElement=function createElement(type){Browser.__init__();return Browser._document.createElement(type);};Browser.getElementById=function getElementById(type){Browser.__init__();return Browser._document.getElementById(type);};Browser.removeElement=function removeElement(ele){if(ele&&ele.parentNode)ele.parentNode.removeChild(ele);};Browser.now=function now(){return Date.now();};_createClass(Browser,null,[{key:"clientWidth",get:function get(){Browser.__init__();return Browser._window.innerWidth||Browser._document.body.clientWidth;}},{key:"clientHeight",get:function get(){Browser.__init__();return Browser._window.innerHeight||Browser._document.body.clientHeight||Browser._document.documentElement.clientHeight;}},{key:"width",get:function get(){Browser.__init__();return (ILaya.stage&&ILaya.stage.canvasRotation?Browser.clientHeight:Browser.clientWidth)*Browser.pixelRatio;}},{key:"height",get:function get(){Browser.__init__();return (ILaya.stage&&ILaya.stage.canvasRotation?Browser.clientWidth:Browser.clientHeight)*Browser.pixelRatio;}},{key:"pixelRatio",get:function get(){if(Browser._pixelRatio<0){Browser.__init__();if(Browser.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")>-1)Browser._pixelRatio=2;else {Browser._pixelRatio=Browser._window.devicePixelRatio||1;if(Browser._pixelRatio<1)Browser._pixelRatio=1;}}return Browser._pixelRatio;}},{key:"container",get:function get(){if(!Browser._container){Browser.__init__();Browser._container=Browser.createElement("div");Browser._container.id="layaContainer";Browser._document.body.appendChild(Browser._container);}return Browser._container;},set:function set(value){Browser._container=value;}},{key:"window",get:function get(){return Browser._window||Browser.__init__();}},{key:"document",get:function get(){Browser.__init__();return Browser._document;}}]);return Browser;}();Browser._pixelRatio=-1;Browser.mainCanvas=null;Browser.hanzi=new RegExp("^[\u4E00-\u9FA5]$");Browser.fontMap=[];Browser.measureText=function(txt,font){var isChinese=Browser.hanzi.test(txt);if(isChinese&&Browser.fontMap[font]){return Browser.fontMap[font];}var ctx=Browser.context;ctx.font=font;var r=ctx.measureText(txt);if(isChinese)Browser.fontMap[font]=r;return r;};var CharRender_Canvas=/*#__PURE__*/function(_ICharRender){_inheritsLoose(CharRender_Canvas,_ICharRender);function CharRender_Canvas(maxw,maxh,scalefont,useImageData,showdbg){var _this19;if(scalefont===void 0){scalefont=true;}if(useImageData===void 0){useImageData=true;}if(showdbg===void 0){showdbg=false;}_this19=_ICharRender.call(this)||this;_this19.ctx=null;_this19.lastScaleX=1.0;_this19.lastScaleY=1.0;_this19.maxTexW=0;_this19.maxTexH=0;_this19.scaleFontSize=true;_this19.showDbgInfo=false;_this19.supportImageData=true;_this19.maxTexW=maxw;_this19.maxTexH=maxh;_this19.scaleFontSize=scalefont;_this19.supportImageData=useImageData;_this19.showDbgInfo=showdbg;if(!CharRender_Canvas.canvas){CharRender_Canvas.canvas=Browser.createElement('canvas');CharRender_Canvas.canvas.width=1024;CharRender_Canvas.canvas.height=512;CharRender_Canvas.canvas.style.left="-10000px";CharRender_Canvas.canvas.style.position="absolute";document.body.appendChild(CharRender_Canvas.canvas);_this19.ctx=CharRender_Canvas.canvas.getContext('2d');}return _this19;}var _proto73=CharRender_Canvas.prototype;_proto73.getWidth=function getWidth(font,str){if(!this.ctx)return 0;if(this.ctx._lastFont!=font){this.ctx.font=font;this.ctx._lastFont=font;}return this.ctx.measureText(str).width;};_proto73.scale=function scale(sx,sy){if(!this.supportImageData){this.lastScaleX=sx;this.lastScaleY=sy;return;}if(this.lastScaleX!=sx||this.lastScaleY!=sy){this.ctx.setTransform(sx,0,0,sy,0,0);this.lastScaleX=sx;this.lastScaleY=sy;}};_proto73.getCharBmp=function getCharBmp(_char2,font,lineWidth,colStr,strokeColStr,cri,margin_left,margin_top,margin_right,margin_bottom,rect){if(rect===void 0){rect=null;}if(!this.supportImageData)return this.getCharCanvas(_char2,font,lineWidth,colStr,strokeColStr,cri,margin_left,margin_top,margin_right,margin_bottom);var ctx=this.ctx;var sz=this.fontsz;if(ctx.font!=font){ctx.font=font;ctx._lastFont=font;}cri.width=ctx.measureText(_char2).width;var w=cri.width*this.lastScaleX;var h=cri.height*this.lastScaleY;w+=(margin_left+margin_right)*this.lastScaleX;h+=(margin_top+margin_bottom)*this.lastScaleY;w=Math.ceil(w);h=Math.ceil(h);w=Math.min(w,CharRender_Canvas.canvas.width);h=Math.min(h,CharRender_Canvas.canvas.height);var clearW=w+lineWidth*2+1;var clearH=h+lineWidth*2+1;if(rect){clearW=Math.max(clearW,rect[0]+rect[2]+1);clearH=Math.max(clearH,rect[1]+rect[3]+1);}ctx.clearRect(0,0,clearW/this.lastScaleX+1,clearH/this.lastScaleY+1);ctx.save();ctx.textBaseline="middle";if(lineWidth>0){ctx.strokeStyle=strokeColStr;ctx.lineWidth=lineWidth;ctx.strokeText(_char2,margin_left,margin_top+sz/2);}if(colStr){ctx.fillStyle=colStr;ctx.fillText(_char2,margin_left,margin_top+sz/2);}if(this.showDbgInfo){ctx.strokeStyle='#ff0000';ctx.strokeRect(1,1,w-2,h-2);ctx.strokeStyle='#00ff00';ctx.strokeRect(margin_left,margin_top,cri.width,cri.height);}if(rect){if(rect[2]==-1)rect[2]=Math.ceil((cri.width+lineWidth*2)*this.lastScaleX);if(rect[2]<=0)rect[2]=1;}var imgdt=rect?ctx.getImageData(rect[0],rect[1],rect[2],rect[3]+1):ctx.getImageData(0,0,w,h+1);ctx.restore();cri.bmpWidth=imgdt.width;cri.bmpHeight=imgdt.height;return imgdt;};_proto73.getCharCanvas=function getCharCanvas(_char3,font,lineWidth,colStr,strokeColStr,cri,margin_left,margin_top,margin_right,margin_bottom){var ctx=this.ctx;if(ctx.font!=font){ctx.font=font;ctx._lastFont=font;}cri.width=ctx.measureText(_char3).width;var w=cri.width*this.lastScaleX;var h=cri.height*this.lastScaleY;w+=(margin_left+margin_right)*this.lastScaleX;h+=(margin_top+margin_bottom)*this.lastScaleY+1;w=Math.min(w,this.maxTexW);h=Math.min(h,this.maxTexH);CharRender_Canvas.canvas.width=Math.min(w+1,this.maxTexW);CharRender_Canvas.canvas.height=Math.min(h+1,this.maxTexH);ctx.font=font;ctx.clearRect(0,0,w+1+lineWidth,h+1+lineWidth);ctx.setTransform(1,0,0,1,0,0);ctx.save();if(this.scaleFontSize){ctx.scale(this.lastScaleX,this.lastScaleY);}ctx.translate(margin_left,margin_top);ctx.textAlign="left";var sz=this.fontsz;ctx.textBaseline="middle";if(lineWidth>0){ctx.strokeStyle=strokeColStr;ctx.fillStyle=colStr;ctx.lineWidth=lineWidth;if(ctx.fillAndStrokeText){ctx.fillAndStrokeText(_char3,0,sz/2);}else {ctx.strokeText(_char3,0,sz/2);ctx.fillText(_char3,0,sz/2);}}else if(colStr){ctx.fillStyle=colStr;ctx.fillText(_char3,0,sz/2);}if(this.showDbgInfo){ctx.strokeStyle='#ff0000';ctx.strokeRect(0,0,w,h);ctx.strokeStyle='#00ff00';ctx.strokeRect(0,0,cri.width,cri.height);}ctx.restore();cri.bmpWidth=CharRender_Canvas.canvas.width;cri.bmpHeight=CharRender_Canvas.canvas.height;return CharRender_Canvas.canvas;};_createClass(CharRender_Canvas,[{key:"canvasWidth",get:function get(){return CharRender_Canvas.canvas.width;},set:function set(w){if(CharRender_Canvas.canvas.width==w)return;CharRender_Canvas.canvas.width=w;if(w>2048){console.warn("画文字设置的宽度太大，超过2048了");}this.ctx.setTransform(1,0,0,1,0,0);this.ctx.scale(this.lastScaleX,this.lastScaleY);}}]);return CharRender_Canvas;}(ICharRender);CharRender_Canvas.canvas=null;var CharRender_Native=/*#__PURE__*/function(_ICharRender2){_inheritsLoose(CharRender_Native,_ICharRender2);function CharRender_Native(){var _this20;_this20=_ICharRender2.call(this)||this;_this20.lastFont='';_this20.lastScaleX=1.0;_this20.lastScaleY=1.0;return _this20;}var _proto74=CharRender_Native.prototype;_proto74.getWidth=function getWidth(font,str){if(!window.conchTextCanvas)return 0;window.conchTextCanvas.font=font;this.lastFont=font;return window.conchTextCanvas.measureText(str).width;};_proto74.scale=function scale(sx,sy){this.lastScaleX=sx;this.lastScaleY=sy;};_proto74.getCharBmp=function getCharBmp(_char4,font,lineWidth,colStr,strokeColStr,size,margin_left,margin_top,margin_right,margin_bottom,rect){if(!window.conchTextCanvas)return null;window.conchTextCanvas.font=font;this.lastFont=font;var w=size.width=window.conchTextCanvas.measureText(_char4).width;var h=size.height;w+=margin_left+margin_right;h+=margin_top+margin_bottom;window.conchTextCanvas.scale&&window.conchTextCanvas.scale(this.lastScaleX,this.lastScaleY);var c1=ColorUtils.create(strokeColStr);var nStrokeColor=c1.numColor;var c2=ColorUtils.create(colStr);var nTextColor=c2.numColor;var textInfo=window.conchTextCanvas.getTextBitmapData(_char4,nTextColor,lineWidth>2?2:lineWidth,nStrokeColor);size.bmpWidth=textInfo.width;size.bmpHeight=textInfo.height;return textInfo;};return CharRender_Native;}(ICharRender);var TextRender=/*#__PURE__*/function(){function TextRender(){this.fontSizeInfo={};this.mapFont={};this.fontID=0;this.mapColor=[];this.colorID=0;this.fontScaleX=1.0;this.fontScaleY=1.0;this._curStrPos=0;this.textAtlases=[];this.isoTextures=[];this.lastFont=null;this.fontSizeW=0;this.fontSizeH=0;this.fontSizeOffX=0;this.fontSizeOffY=0;this.renderPerChar=true;this.tmpAtlasPos=new Point();this.textureMem=0;ILaya.TextAtlas=TextAtlas;var bugIOS=false;var miniadp=ILaya.Laya['MiniAdpter'];if(miniadp&&miniadp.systemInfo&&miniadp.systemInfo.system){bugIOS=miniadp.systemInfo.system.toLowerCase()==='ios 10.1.1';}if((ILaya.Browser.onMiniGame||ILaya.Browser.onTTMiniGame||ILaya.Browser.onBLMiniGame||ILaya.Browser.onAlipayMiniGame)&&!bugIOS)TextRender.isWan1Wan=true;this.charRender=ILaya.Render.isConchApp?new CharRender_Native():new CharRender_Canvas(2048,2048,TextRender.scaleFontWithCtx,!TextRender.isWan1Wan,false);TextRender.textRenderInst=this;ILaya.Laya['textRender']=this;TextRender.atlasWidth2=TextRender.atlasWidth*TextRender.atlasWidth;}var _proto75=TextRender.prototype;_proto75.setFont=function setFont(font){if(this.lastFont==font)return;this.lastFont=font;var fontsz=this.getFontSizeInfo(font._family);var offx=fontsz>>24;var offy=fontsz>>16&0xff;var fw=fontsz>>8&0xff;var fh=fontsz&0xff;var k=font._size/TextRender.standardFontSize;this.fontSizeOffX=Math.ceil(offx*k);this.fontSizeOffY=Math.ceil(offy*k);this.fontSizeW=Math.ceil(fw*k);this.fontSizeH=Math.ceil(fh*k);if(font._font.indexOf('italic')>=0){this.fontStr=font._font.replace('italic','');}else {this.fontStr=font._font;}};_proto75.getNextChar=function getNextChar(str){var len=str.length;var start=this._curStrPos;if(start>=len)return null;var i=start;var state=0;for(;i<len;i++){var c=str.charCodeAt(i);if(c>>>11==0x1b){if(state==1)break;state=1;i++;}else if(c===0xfe0e||c===0xfe0f);else if(c==0x200d){state=2;}else {if(state==0)state=1;else if(state==1)break;}}this._curStrPos=i;return str.substring(start,i);};_proto75.filltext=function filltext(ctx,data,x,y,fontStr,color,strokeColor,lineWidth,textAlign,underLine){if(underLine===void 0){underLine=0;}if(data.length<=0)return;var font=FontInfo.Parse(fontStr);var nTextAlign=0;switch(textAlign){case'center':nTextAlign=ILaya.Context.ENUM_TEXTALIGN_CENTER;break;case'right':nTextAlign=ILaya.Context.ENUM_TEXTALIGN_RIGHT;break;}this._fast_filltext(ctx,data,null,x,y,font,color,strokeColor,lineWidth,nTextAlign,underLine);};_proto75.fillWords=function fillWords(ctx,data,x,y,fontStr,color,strokeColor,lineWidth){if(!data)return;if(data.length<=0)return;var font=typeof fontStr==='string'?FontInfo.Parse(fontStr):fontStr;this._fast_filltext(ctx,null,data,x,y,font,color,strokeColor,lineWidth,0,0);};_proto75._fast_filltext=function _fast_filltext(ctx,data,htmlchars,x,y,font,color,strokeColor,lineWidth,textAlign,underLine){if(data&&data.length<1)return;if(htmlchars&&htmlchars.length<1)return;if(lineWidth<0)lineWidth=0;this.setFont(font);this.fontScaleX=this.fontScaleY=1.0;if(TextRender.scaleFontWithCtx){var sx=1;var sy=1;if(!ILaya.Render.isConchApp||window.conchTextCanvas.scale){sx=ctx.getMatScaleX();sy=ctx.getMatScaleY();}if(sx<1e-4||sy<1e-1)return;if(sx>1)this.fontScaleX=sx;if(sy>1)this.fontScaleY=sy;}font._italic&&(ctx._italicDeg=13);var wt=data;var isWT=!htmlchars&&data instanceof WordText;var str=data;var isHtmlChar=!!htmlchars;var sameTexData=isWT?wt.pageChars:[];var strWidth=0;if(isWT){str=wt._text;strWidth=wt.width;if(strWidth<0){strWidth=wt.width=this.charRender.getWidth(this.fontStr,str);}}else {strWidth=str?this.charRender.getWidth(this.fontStr,str):0;}switch(textAlign){case ILaya.Context.ENUM_TEXTALIGN_CENTER:x-=strWidth/2;break;case ILaya.Context.ENUM_TEXTALIGN_RIGHT:x-=strWidth;break;}if(wt&&sameTexData){if(this.hasFreedText(sameTexData)){sameTexData=wt.pageChars=[];}}var ri=null;var splitTex=this.renderPerChar=!isWT||TextRender.forceSplitRender||isHtmlChar||isWT&&wt.splitRender;if(!sameTexData||sameTexData.length<1){if(isWT){wt.scalex=this.fontScaleX;wt.scaley=this.fontScaleY;}if(splitTex){var stx=0;var sty=0;this._curStrPos=0;var curstr;while(true){if(htmlchars){var chc=htmlchars[this._curStrPos++];if(chc){curstr=chc["char"];stx=chc.x;sty=chc.y;}else {curstr=null;}}else {curstr=this.getNextChar(str);}if(!curstr)break;ri=this.getCharRenderInfo(curstr,font,color,strokeColor,lineWidth,false);if(!ri){break;}if(ri.isSpace);else {var add=sameTexData[ri.tex.id];if(!add){var o1={texgen:ri.tex.genID,tex:ri.tex,words:[]};sameTexData[ri.tex.id]=o1;add=o1.words;}else {add=add.words;}add.push({ri:ri,x:stx,y:sty,w:ri.bmpWidth/this.fontScaleX,h:ri.bmpHeight/this.fontScaleY});stx+=ri.width;}}}else {var margin=ILaya.Render.isConchApp?0:font._size/3|0;var isotex=TextRender.noAtlas||(strWidth+margin+margin)*this.fontScaleX>TextRender.atlasWidth;ri=this.getCharRenderInfo(str,font,color,strokeColor,lineWidth,isotex);sameTexData[0]={texgen:ri.tex.genID,tex:ri.tex,words:[{ri:ri,x:0,y:0,w:ri.bmpWidth/this.fontScaleX,h:ri.bmpHeight/this.fontScaleY}]};}}this._drawResortedWords(ctx,x,y,sameTexData);ctx._italicDeg=0;};_proto75._drawResortedWords=function _drawResortedWords(ctx,startx,starty,samePagesData){var isLastRender=ctx._charSubmitCache?ctx._charSubmitCache._enable:false;var mat=ctx._curMat;var slen=samePagesData.length;for(var id in samePagesData){var dt=samePagesData[id];if(!dt)continue;var pri=dt.words;var pisz=pri.length;if(pisz<=0)continue;var tex=samePagesData[id].tex;for(var j=0;j<pisz;j++){var riSaved=pri[j];var ri=riSaved.ri;if(ri.isSpace)continue;ri.touch();ctx.drawTexAlign=true;if(ILaya.Render.isConchApp){ctx._drawTextureM(tex.texture,startx+riSaved.x-ri.orix,starty+riSaved.y-ri.oriy,riSaved.w,riSaved.h,null,1.0,ri.uv);}else {var t=tex;ctx._inner_drawTexture(t.texture,t.id,startx+riSaved.x-ri.orix,starty+riSaved.y-ri.oriy,riSaved.w,riSaved.h,mat,ri.uv,1.0,isLastRender);}if(ctx.touches){ctx.touches.push(ri);}}}};_proto75.hasFreedText=function hasFreedText(txts){var sz=txts.length;for(var i=0;i<sz;i++){var pri=txts[i];if(!pri)continue;var tex=pri.tex;if(tex.__destroyed||tex.genID!=pri.texgen){return true;}}return false;};_proto75.getCharRenderInfo=function getCharRenderInfo(str,font,color,strokeColor,lineWidth,isoTexture){if(isoTexture===void 0){isoTexture=false;}var fid=this.mapFont[font._family];if(fid==undefined){this.mapFont[font._family]=fid=this.fontID++;}var key=str+'_'+fid+'_'+font._size+'_'+color;if(lineWidth>0)key+='_'+strokeColor+lineWidth;if(font._bold)key+='P';if(this.fontScaleX!=1||this.fontScaleY!=1){key+=(this.fontScaleX*20|0)+'_'+(this.fontScaleY*20|0);}var i=0;var sz=this.textAtlases.length;var ri;var atlas;if(!isoTexture){for(i=0;i<sz;i++){atlas=this.textAtlases[i];ri=atlas.charMaps[key];if(ri){ri.touch();return ri;}}}ri=new CharRenderInfo();this.charRender.scale(this.fontScaleX,this.fontScaleY);ri["char"]=str;ri.height=font._size;var margin=ILaya.Render.isConchApp?0:font._size/3|0;var imgdt=null;if(!lineWidth){lineWidth=0;}var w1=Math.ceil((this.charRender.getWidth(this.fontStr,str)+2*lineWidth)*this.fontScaleX);if(w1>this.charRender.canvasWidth){this.charRender.canvasWidth=Math.min(2048,w1+margin*2);}if(isoTexture){this.charRender.fontsz=font._size;imgdt=this.charRender.getCharBmp(str,this.fontStr,lineWidth,color,strokeColor,ri,margin,margin,margin,margin,null);if(imgdt){var tex=TextTexture.getTextTexture(imgdt.width,imgdt.height);tex.addChar(imgdt,0,0,ri.uv);ri.tex=tex;ri.orix=margin;ri.oriy=margin;tex.ri=ri;this.isoTextures.push(tex);}}else {var len=str.length;var lineExt=lineWidth*1;var fw=Math.ceil((this.fontSizeW+lineExt*2)*this.fontScaleX);var fh=Math.ceil((this.fontSizeH+lineExt*2)*this.fontScaleY);TextRender.imgdtRect[0]=(margin-this.fontSizeOffX-lineExt)*this.fontScaleX|0;TextRender.imgdtRect[1]=(margin-this.fontSizeOffY-lineExt)*this.fontScaleY|0;if(this.renderPerChar||len==1){TextRender.imgdtRect[2]=Math.max(w1,fw);TextRender.imgdtRect[3]=Math.max(w1,fh);}else {TextRender.imgdtRect[2]=-1;TextRender.imgdtRect[3]=fh;}this.charRender.fontsz=font._size;imgdt=this.charRender.getCharBmp(str,this.fontStr,lineWidth,color,strokeColor,ri,margin,margin,margin,margin,TextRender.imgdtRect);if(imgdt){atlas=this.addBmpData(imgdt,ri);if(TextRender.isWan1Wan){ri.orix=margin;ri.oriy=margin;}else {ri.orix=this.fontSizeOffX+lineExt;ri.oriy=this.fontSizeOffY+lineExt;}atlas.charMaps[key]=ri;}}return ri;};_proto75.addBmpData=function addBmpData(data,ri){var w=data.width;var h=data.height;var sz=this.textAtlases.length;var atlas;var find=false;for(var i=0;i<sz;i++){atlas=this.textAtlases[i];find=atlas.getAEmpty(w,h,this.tmpAtlasPos);if(find){break;}}if(!find){atlas=new TextAtlas();this.textAtlases.push(atlas);find=atlas.getAEmpty(w,h,this.tmpAtlasPos);if(!find){throw 'err1';}this.cleanAtlases();}if(find){atlas.texture.addChar(data,this.tmpAtlasPos.x,this.tmpAtlasPos.y,ri.uv);ri.tex=atlas.texture;}return atlas;};_proto75.GC=function GC(){var i=0;var sz=this.textAtlases.length;var dt=0;var destroyDt=TextRender.destroyAtlasDt;var totalUsedRate=0;var totalUsedRateAtlas=0;var curloop=RenderInfo.loopCount;var maxWasteRateID=-1;var maxWasteRate=0;var tex=null;var curatlas=null;for(;i<sz;i++){curatlas=this.textAtlases[i];tex=curatlas.texture;if(tex){totalUsedRate+=tex.curUsedCovRate;totalUsedRateAtlas+=tex.curUsedCovRateAtlas;var waste=curatlas.usedRate-tex.curUsedCovRateAtlas;if(maxWasteRate<waste){maxWasteRate=waste;maxWasteRateID=i;}}dt=curloop-curatlas.texture.lastTouchTm;if(dt>destroyDt){TextRender.showLog&&console.log('TextRender GC delete atlas '+tex?curatlas.texture.id:'unk');curatlas.destroy();this.textAtlases[i]=this.textAtlases[sz-1];sz--;i--;maxWasteRateID=-1;}}this.textAtlases.length=sz;sz=this.isoTextures.length;for(i=0;i<sz;i++){tex=this.isoTextures[i];dt=curloop-tex.lastTouchTm;if(dt>TextRender.destroyUnusedTextureDt){tex.ri.deleted=true;tex.ri.tex=null;tex.destroy();this.isoTextures[i]=this.isoTextures[sz-1];sz--;i--;}}this.isoTextures.length=sz;var needGC=this.textAtlases.length>1&&this.textAtlases.length-totalUsedRateAtlas>=2;if(TextRender.atlasWidth*TextRender.atlasWidth*4*this.textAtlases.length>TextRender.cleanMem||needGC||TextRender.simClean){TextRender.simClean=false;TextRender.showLog&&console.log('清理使用率低的贴图。总使用率:',totalUsedRateAtlas,':',this.textAtlases.length,'最差贴图:'+maxWasteRateID);if(maxWasteRateID>=0){curatlas=this.textAtlases[maxWasteRateID];curatlas.destroy();this.textAtlases[maxWasteRateID]=this.textAtlases[this.textAtlases.length-1];this.textAtlases.length=this.textAtlases.length-1;}}TextTexture.clean();};_proto75.cleanAtlases=function cleanAtlases(){};_proto75.getCharBmp=function getCharBmp(c){};_proto75.checkBmpLine=function checkBmpLine(data,l,sx,ex){if(this.bmpData32.buffer!=data.data.buffer){this.bmpData32=new Uint32Array(data.data.buffer);}var stpos=data.width*l+sx;for(var x=sx;x<ex;x++){if(this.bmpData32[stpos++]!=0)return true;}return false;};_proto75.updateBbx=function updateBbx(data,curbbx,onlyH){if(onlyH===void 0){onlyH=false;}var w=data.width;var h=data.height;var x=0;var sy=curbbx[1];var ey=0;var y=sy;if(this.checkBmpLine(data,sy,0,w)){while(true){y=(sy+ey)/2|0;if(y+1>=sy){curbbx[1]=y;break;}if(this.checkBmpLine(data,y,0,w)){sy=y;}else {ey=y;}}}if(curbbx[3]>h)curbbx[3]=h;else {y=sy=curbbx[3];ey=h;if(this.checkBmpLine(data,sy,0,w)){while(true){y=(sy+ey)/2|0;if(y-1<=sy){curbbx[3]=y;break;}if(this.checkBmpLine(data,y,0,w)){sy=y;}else {ey=y;}}}}if(onlyH)return;var minx=curbbx[0];var stpos=w*curbbx[1];for(y=curbbx[1];y<curbbx[3];y++){for(x=0;x<minx;x++){if(this.bmpData32[stpos+x]!=0){minx=x;break;}}stpos+=w;}curbbx[0]=minx;var maxx=curbbx[2];stpos=w*curbbx[1];for(y=curbbx[1];y<curbbx[3];y++){for(x=maxx;x<w;x++){if(this.bmpData32[stpos+x]!=0){maxx=x;break;}}stpos+=w;}curbbx[2]=maxx;};_proto75.getFontSizeInfo=function getFontSizeInfo(font){var finfo=this.fontSizeInfo[font];if(finfo!=undefined)return finfo;var fontstr='bold '+TextRender.standardFontSize+'px '+font;if(TextRender.isWan1Wan){this.fontSizeW=this.charRender.getWidth(fontstr,'有')*1.5;this.fontSizeH=TextRender.standardFontSize*1.5;var szinfo=this.fontSizeW<<8|this.fontSizeH;this.fontSizeInfo[font]=szinfo;return szinfo;}TextRender.pixelBBX[0]=TextRender.standardFontSize/2;TextRender.pixelBBX[1]=TextRender.standardFontSize/2;TextRender.pixelBBX[2]=TextRender.standardFontSize;TextRender.pixelBBX[3]=TextRender.standardFontSize;var orix=16;var oriy=16;var marginr=16;var marginb=16;this.charRender.scale(1,1);TextRender.tmpRI.height=TextRender.standardFontSize;this.charRender.fontsz=TextRender.standardFontSize;var bmpdt=this.charRender.getCharBmp('g',fontstr,0,'red',null,TextRender.tmpRI,orix,oriy,marginr,marginb);if(ILaya.Render.isConchApp){bmpdt.data=new Uint8ClampedArray(bmpdt.data);}this.bmpData32=new Uint32Array(bmpdt.data.buffer);this.updateBbx(bmpdt,TextRender.pixelBBX,false);bmpdt=this.charRender.getCharBmp('有',fontstr,0,'red',null,TextRender.tmpRI,oriy,oriy,marginr,marginb);if(ILaya.Render.isConchApp){bmpdt.data=new Uint8ClampedArray(bmpdt.data);}this.bmpData32=new Uint32Array(bmpdt.data.buffer);if(TextRender.pixelBBX[2]<orix+TextRender.tmpRI.width)TextRender.pixelBBX[2]=orix+TextRender.tmpRI.width;this.updateBbx(bmpdt,TextRender.pixelBBX,false);if(ILaya.Render.isConchApp){orix=0;oriy=0;}var xoff=Math.max(orix-TextRender.pixelBBX[0],0);var yoff=Math.max(oriy-TextRender.pixelBBX[1],0);var bbxw=TextRender.pixelBBX[2]-TextRender.pixelBBX[0];var bbxh=TextRender.pixelBBX[3]-TextRender.pixelBBX[1];var sizeinfo=xoff<<24|yoff<<16|bbxw<<8|bbxh;this.fontSizeInfo[font]=sizeinfo;return sizeinfo;};_proto75.printDbgInfo=function printDbgInfo(){console.log('图集个数:'+this.textAtlases.length+',每个图集大小:'+TextRender.atlasWidth+'x'+TextRender.atlasWidth,' 用canvas:',TextRender.isWan1Wan);console.log('图集占用空间:'+TextRender.atlasWidth*TextRender.atlasWidth*4/1024/1024*this.textAtlases.length+'M');console.log('缓存用到的字体:');for(var f in this.mapFont){var fontsz=this.getFontSizeInfo(f);var offx=fontsz>>24;var offy=fontsz>>16&0xff;var fw=fontsz>>8&0xff;var fh=fontsz&0xff;console.log('    '+f,' off:',offx,offy,' size:',fw,fh);}var num=0;console.log('缓存数据:');var totalUsedRate=0;var totalUsedRateAtlas=0;this.textAtlases.forEach(function(a){var id=a.texture.id;var dt=RenderInfo.loopCount-a.texture.lastTouchTm;var dtstr=dt>0?''+dt+'帧以前':'当前帧';totalUsedRate+=a.texture.curUsedCovRate;totalUsedRateAtlas+=a.texture.curUsedCovRateAtlas;console.log('--图集(id:'+id+',当前使用率:'+(a.texture.curUsedCovRate*1000|0)+'‰','当前图集使用率:',(a.texture.curUsedCovRateAtlas*100|0)+'%','图集使用率:',a.usedRate*100|0,'%, 使用于:'+dtstr+')--:');for(var k in a.charMaps){var ri=a.charMaps[k];console.log('     off:',ri.orix,ri.oriy,' bmp宽高:',ri.bmpWidth,ri.bmpHeight,'无效:',ri.deleted,'touchdt:',RenderInfo.loopCount-ri.touchTick,'位置:',ri.uv[0]*TextRender.atlasWidth|0,ri.uv[1]*TextRender.atlasWidth|0,'字符:',ri["char"],'key:',k);num++;}});console.log('独立贴图文字('+this.isoTextures.length+'个):');this.isoTextures.forEach(function(tex){console.log('    size:',tex._texW,tex._texH,'touch间隔:',RenderInfo.loopCount-tex.lastTouchTm,'char:',tex.ri["char"]);});console.log('总缓存:',num,'总使用率:',totalUsedRate,'总当前图集使用率:',totalUsedRateAtlas);};_proto75.showAtlas=function showAtlas(n,bgcolor,x,y,w,h){if(!this.textAtlases[n]){console.log('没有这个图集');return null;}var sp=new ILaya.Sprite();var texttex=this.textAtlases[n].texture;var texture={width:TextRender.atlasWidth,height:TextRender.atlasWidth,sourceWidth:TextRender.atlasWidth,sourceHeight:TextRender.atlasWidth,offsetX:0,offsetY:0,getIsReady:function getIsReady(){return true;},_addReference:function _addReference(){},_removeReference:function _removeReference(){},_getSource:function _getSource(){return texttex._getSource();},bitmap:{id:texttex.id},_uv:Texture.DEF_UV};sp.size=function(w,h){this.width=w;this.height=h;sp.graphics.clear();sp.graphics.drawRect(0,0,sp.width,sp.height,bgcolor);sp.graphics.drawTexture(texture,0,0,sp.width,sp.height);return this;};sp.graphics.drawRect(0,0,w,h,bgcolor);sp.graphics.drawTexture(texture,0,0,w,h);sp.pos(x,y);ILaya.stage.addChild(sp);return sp;};_proto75.filltext_native=function filltext_native(ctx,data,htmlchars,x,y,fontStr,color,strokeColor,lineWidth,textAlign,underLine){if(underLine===void 0){underLine=0;}if(data&&data.length<=0)return;if(htmlchars&&htmlchars.length<1)return;var font=FontInfo.Parse(fontStr);var nTextAlign=0;switch(textAlign){case'center':nTextAlign=ILaya.Context.ENUM_TEXTALIGN_CENTER;break;case'right':nTextAlign=ILaya.Context.ENUM_TEXTALIGN_RIGHT;break;}return this._fast_filltext(ctx,data,htmlchars,x,y,font,color,strokeColor,lineWidth,nTextAlign,underLine);};return TextRender;}();TextRender.useOldCharBook=false;TextRender.atlasWidth=1024;TextRender.noAtlas=false;TextRender.forceSplitRender=false;TextRender.forceWholeRender=false;TextRender.scaleFontWithCtx=true;TextRender.standardFontSize=32;TextRender.destroyAtlasDt=10;TextRender.checkCleanTextureDt=2000;TextRender.destroyUnusedTextureDt=3000;TextRender.cleanMem=100*1024*1024;TextRender.isWan1Wan=false;TextRender.showLog=false;TextRender.debugUV=false;TextRender.tmpRI=new CharRenderInfo();TextRender.pixelBBX=[0,0,0,0];TextRender.imgdtRect=[0,0,0,0];TextRender.simClean=false;TextTexture.gTextRender=TextRender;var Context=/*#__PURE__*/function(){function Context(){this._tmpMatrix=new Matrix();this._drawTexToDrawTri_Vert=new Float32Array(8);this._drawTexToDrawTri_Index=new Uint16Array([0,1,2,0,2,3]);this._tempUV=new Float32Array(8);this._drawTriUseAbsMatrix=false;this._id=++Context._COUNT;this._other=null;this._renderNextSubmitIndex=0;this._path=null;this._drawCount=1;this._width=Context._MAXSIZE;this._height=Context._MAXSIZE;this._renderCount=0;this._submits=null;this._curSubmit=null;this._submitKey=new SubmitKey();this._mesh=null;this._pathMesh=null;this._triangleMesh=null;this.meshlist=[];this._transedPoints=new Array(8);this._temp4Points=new Array(8);this._clipRect=Context.MAXCLIPRECT;this._globalClipMatrix=new Matrix(Context._MAXSIZE,0,0,Context._MAXSIZE,0,0);this._clipInCache=false;this._clipInfoID=0;this._clipID_Gen=0;this._lastMatScaleX=1.0;this._lastMatScaleY=1.0;this._lastMat_a=1.0;this._lastMat_b=0.0;this._lastMat_c=0.0;this._lastMat_d=1.0;this._nBlendType=0;this._save=null;this._targets=null;this._charSubmitCache=null;this._saveMark=null;this._shader2D=new Shader2D();this.sprite=null;this._italicDeg=0;this._lastTex=null;this._fillColor=0;this._flushCnt=0;this.defTexture=null;this._colorFiler=null;this.drawTexAlign=false;this._incache=false;this.isMain=false;Context._contextcount++;Context._textRender=Context._textRender||new TextRender();if(!this.defTexture){var defTex2d=new Texture2D(2,2);defTex2d.setPixels(new Uint8Array(16));defTex2d.lock=true;this.defTexture=new Texture(defTex2d);}this._lastTex=this.defTexture;this.clear();}Context.__init__=function __init__(){Context.MAXCLIPRECT=new Rectangle(0,0,Context._MAXSIZE,Context._MAXSIZE);ContextParams.DEFAULT=new ContextParams();};var _proto76=Context.prototype;_proto76.drawImage=function drawImage(){};_proto76.getImageData=function getImageData(){};_proto76.measureText=function measureText(text){return null;};_proto76.setTransform=function setTransform(){};_proto76.$transform=function $transform(a,b,c,d,tx,ty){};_proto76.clearRect=function clearRect(x,y,width,height){};_proto76._drawRect=function _drawRect(x,y,width,height,style){Stat.renderBatches++;style&&(this.fillStyle=style);this.fillRect(x,y,width,height,null);};_proto76.drawTexture2=function drawTexture2(x,y,pivotX,pivotY,m,args2){};_proto76.transformByMatrix=function transformByMatrix(matrix,tx,ty){this.transform(matrix.a,matrix.b,matrix.c,matrix.d,matrix.tx+tx,matrix.ty+ty);};_proto76.saveTransform=function saveTransform(matrix){this.save();};_proto76.restoreTransform=function restoreTransform(matrix){this.restore();};_proto76.drawRect=function drawRect(x,y,width,height,fillColor,lineColor,lineWidth){var ctx=this;if(fillColor!=null){ctx.fillStyle=fillColor;ctx.fillRect(x,y,width,height);}if(lineColor!=null){ctx.strokeStyle=lineColor;ctx.lineWidth=lineWidth;ctx.strokeRect(x,y,width,height);}};_proto76.alpha=function alpha(value){this.globalAlpha*=value;};_proto76._transform=function _transform(mat,pivotX,pivotY){this.translate(pivotX,pivotY);this.transform(mat.a,mat.b,mat.c,mat.d,mat.tx,mat.ty);this.translate(-pivotX,-pivotY);};_proto76._rotate=function _rotate(angle,pivotX,pivotY){this.translate(pivotX,pivotY);this.rotate(angle);this.translate(-pivotX,-pivotY);};_proto76._scale=function _scale(scaleX,scaleY,pivotX,pivotY){this.translate(pivotX,pivotY);this.scale(scaleX,scaleY);this.translate(-pivotX,-pivotY);};_proto76._drawLine=function _drawLine(x,y,fromX,fromY,toX,toY,lineColor,lineWidth,vid){this.beginPath();this.strokeStyle=lineColor;this.lineWidth=lineWidth;this.moveTo(x+fromX,y+fromY);this.lineTo(x+toX,y+toY);this.stroke();};_proto76._drawLines=function _drawLines(x,y,points,lineColor,lineWidth,vid){this.beginPath();this.strokeStyle=lineColor;this.lineWidth=lineWidth;this.addPath(points.slice(),false,false,x,y);this.stroke();};_proto76.drawCurves=function drawCurves(x,y,points,lineColor,lineWidth){this.beginPath();this.strokeStyle=lineColor;this.lineWidth=lineWidth;this.moveTo(x+points[0],y+points[1]);var i=2,n=points.length;while(i<n){this.quadraticCurveTo(x+points[i++],y+points[i++],x+points[i++],y+points[i++]);}this.stroke();};_proto76._fillAndStroke=function _fillAndStroke(fillColor,strokeColor,lineWidth,isConvexPolygon){if(fillColor!=null){this.fillStyle=fillColor;this.fill();}if(strokeColor!=null&&lineWidth>0){this.strokeStyle=strokeColor;this.lineWidth=lineWidth;this.stroke();}};_proto76._drawCircle=function _drawCircle(x,y,radius,fillColor,lineColor,lineWidth,vid){Stat.renderBatches++;this.beginPath(true);this.arc(x,y,radius,0,Context.PI2);this.closePath();this._fillAndStroke(fillColor,lineColor,lineWidth);};_proto76._drawPie=function _drawPie(x,y,radius,startAngle,endAngle,fillColor,lineColor,lineWidth,vid){this.beginPath();this.moveTo(x,y);this.arc(x,y,radius,startAngle,endAngle);this.closePath();this._fillAndStroke(fillColor,lineColor,lineWidth);};_proto76._drawPoly=function _drawPoly(x,y,points,fillColor,lineColor,lineWidth,isConvexPolygon,vid){this.beginPath();this.addPath(points.slice(),true,isConvexPolygon,x,y);this.closePath();this._fillAndStroke(fillColor,lineColor,lineWidth,isConvexPolygon);};_proto76._drawPath=function _drawPath(x,y,paths,brush,pen){this.beginPath();for(var i=0,n=paths.length;i<n;i++){var path=paths[i];switch(path[0]){case"moveTo":this.moveTo(x+path[1],y+path[2]);break;case"lineTo":this.lineTo(x+path[1],y+path[2]);break;case"arcTo":this.arcTo(x+path[1],y+path[2],x+path[3],y+path[4],path[5]);break;case"closePath":this.closePath();break;}}if(brush!=null){this.fillStyle=brush.fillStyle;this.fill();}if(pen!=null){this.strokeStyle=pen.strokeStyle;this.lineWidth=pen.lineWidth||1;this.lineJoin=pen.lineJoin;this.lineCap=pen.lineCap;this.miterLimit=pen.miterLimit;this.stroke();}};Context.set2DRenderConfig=function set2DRenderConfig(){var gl=LayaGL.instance;WebGLContext.setBlend(gl,true);WebGLContext.setBlendEquation(gl,gl.FUNC_ADD);BlendMode.activeBlendFunction=null;WebGLContext.setBlendFunc(gl,gl.ONE,gl.ONE_MINUS_SRC_ALPHA);WebGLContext.setDepthTest(gl,false);WebGLContext.setCullFace(gl,false);WebGLContext.setDepthMask(gl,true);WebGLContext.setFrontFace(gl,gl.CCW);gl.viewport(0,0,RenderState2D.width,RenderState2D.height);};_proto76.clearBG=function clearBG(r,g,b,a){var gl=WebGLContext.mainContext;gl.clearColor(r,g,b,a);gl.clear(gl.COLOR_BUFFER_BIT);};_proto76._getSubmits=function _getSubmits(){return this._submits;};_proto76._releaseMem=function _releaseMem(keepRT){if(keepRT===void 0){keepRT=false;}if(!this._submits)return;this._curMat&&this._curMat.destroy();this._curMat=null;this._shader2D.destroy();this._shader2D=null;this._charSubmitCache.clear();for(var i=0,n=this._submits._length;i<n;i++){this._submits[i].releaseRender();}this._submits.length=0;this._submits._length=0;this._submits=null;this._curSubmit=null;this._path=null;this._save=null;var sz;for(i=0,sz=this.meshlist.length;i<sz;i++){var curm=this.meshlist[i];curm.destroy();}this.meshlist.length=0;this.sprite=null;if(!keepRT){this._targets&&this._targets.destroy();this._targets=null;}};_proto76.destroy=function destroy(keepRT){if(keepRT===void 0){keepRT=false;}--Context._contextcount;this.sprite=null;this._releaseMem(keepRT);this._charSubmitCache.destroy();this._mesh.destroy();if(!keepRT){this._targets&&this._targets.destroy();this._targets=null;}};_proto76.clear=function clear(){if(!this._submits){this._other=ContextParams.DEFAULT;this._curMat=Matrix.create();this._charSubmitCache=new CharSubmitCache();this._mesh=MeshQuadTexture.getAMesh(this.isMain);this.meshlist.push(this._mesh);this._pathMesh=MeshVG.getAMesh(this.isMain);this.meshlist.push(this._pathMesh);this._triangleMesh=MeshTexture.getAMesh(this.isMain);this.meshlist.push(this._triangleMesh);this._submits=[];this._save=[SaveMark.Create(this)];this._save.length=10;this._shader2D=new Shader2D();}this._submitKey.clear();this._mesh.clearVB();this._drawCount=1;this._other=ContextParams.DEFAULT;this._other.lineWidth=this._shader2D.ALPHA=1.0;this._nBlendType=0;this._clipRect=Context.MAXCLIPRECT;this._curSubmit=SubmitBase.RENDERBASE;SubmitBase.RENDERBASE._ref=0xFFFFFF;SubmitBase.RENDERBASE._numEle=0;this._shader2D.fillStyle=this._shader2D.strokeStyle=DrawStyle.DEFAULT;for(var i=0,n=this._submits._length;i<n;i++){this._submits[i].releaseRender();}this._submits._length=0;this._curMat.identity();this._other.clear();this._saveMark=this._save[0];this._save._length=1;};_proto76.size=function size(w,h){if(this._width!=w||this._height!=h){this._width=w;this._height=h;if(this._targets){this._targets.destroy();this._targets=new RenderTexture2D(w,h,exports.RenderTextureFormat.R8G8B8A8,-1);}if(this.isMain){WebGLContext.mainContext.viewport(0,0,w,h);RenderState2D.width=w;RenderState2D.height=h;}}if(w===0&&h===0)this._releaseMem();};_proto76.getMatScaleX=function getMatScaleX(){if(this._lastMat_a==this._curMat.a&&this._lastMat_b==this._curMat.b)return this._lastMatScaleX;this._lastMatScaleX=this._curMat.getScaleX();this._lastMat_a=this._curMat.a;this._lastMat_b=this._curMat.b;return this._lastMatScaleX;};_proto76.getMatScaleY=function getMatScaleY(){if(this._lastMat_c==this._curMat.c&&this._lastMat_d==this._curMat.d)return this._lastMatScaleY;this._lastMatScaleY=this._curMat.getScaleY();this._lastMat_c=this._curMat.c;this._lastMat_d=this._curMat.d;return this._lastMatScaleY;};_proto76.setFillColor=function setFillColor(color){this._fillColor=color;};_proto76.getFillColor=function getFillColor(){return this._fillColor;};_proto76.translate=function translate(x,y){if(x!==0||y!==0){SaveTranslate.save(this);if(this._curMat._bTransform){SaveTransform.save(this);this._curMat.tx+=x*this._curMat.a+y*this._curMat.c;this._curMat.ty+=x*this._curMat.b+y*this._curMat.d;}else {this._curMat.tx=x;this._curMat.ty=y;}}};_proto76.save=function save(){this._save[this._save._length++]=SaveMark.Create(this);};_proto76.restore=function restore(){var sz=this._save._length;var lastBlend=this._nBlendType;if(sz<1)return;for(var i=sz-1;i>=0;i--){var o=this._save[i];o.restore(this);if(o.isSaveMark()){this._save._length=i;return;}}if(lastBlend!=this._nBlendType){this._curSubmit=SubmitBase.RENDERBASE;}};_proto76.fillText=function fillText(txt,x,y,fontStr,color,align,lineWidth,borderColor){if(lineWidth===void 0){lineWidth=0;}if(borderColor===void 0){borderColor="";}Context._textRender.filltext(this,txt,x,y,fontStr,color,borderColor,lineWidth,align);};_proto76.drawText=function drawText(text,x,y,font,color,textAlign){Context._textRender.filltext(this,text,x,y,font,color,null,0,textAlign);};_proto76.fillWords=function fillWords(words,x,y,fontStr,color){Context._textRender.fillWords(this,words,x,y,fontStr,color,null,0);};_proto76.strokeWord=function strokeWord(text,x,y,font,color,lineWidth,textAlign){Context._textRender.filltext(this,text,x,y,font,null,color,lineWidth,textAlign);};_proto76.fillBorderText=function fillBorderText(txt,x,y,font,color,borderColor,lineWidth,textAlign){Context._textRender.filltext(this,txt,x,y,font,color,borderColor,lineWidth,textAlign);};_proto76.fillBorderWords=function fillBorderWords(words,x,y,font,color,borderColor,lineWidth){Context._textRender.fillWords(this,words,x,y,font,color,borderColor,lineWidth);};_proto76._fast_filltext=function _fast_filltext(data,x,y,fontObj,color,strokeColor,lineWidth,textAlign,underLine){if(underLine===void 0){underLine=0;}Context._textRender._fast_filltext(this,data,null,x,y,fontObj,color,strokeColor,lineWidth,textAlign,underLine);};_proto76._fillRect=function _fillRect(x,y,width,height,rgba){var submit=this._curSubmit;var sameKey=submit&&submit._key.submitType===SubmitBase.KEY_DRAWTEXTURE&&submit._key.blendShader===this._nBlendType;if(this._mesh.vertNum+4>Context._MAXVERTNUM){this._mesh=MeshQuadTexture.getAMesh(this.isMain);this.meshlist.push(this._mesh);sameKey=false;}sameKey&&(sameKey=sameKey&&this.isSameClipInfo(submit));this.transformQuad(x,y,width,height,0,this._curMat,this._transedPoints);if(!this.clipedOff(this._transedPoints)){this._mesh.addQuad(this._transedPoints,Texture.NO_UV,rgba,false);if(!sameKey){submit=this._curSubmit=SubmitTexture.create(this,this._mesh,Value2D.create(ShaderDefines2D.TEXTURE2D,0));this._submits[this._submits._length++]=submit;this._copyClipInfo(submit,this._globalClipMatrix);submit.shaderValue.textureHost=this._lastTex;submit._key.other=this._lastTex&&this._lastTex.bitmap?this._lastTex.bitmap.id:-1;submit._renderType=SubmitBase.TYPE_TEXTURE;}this._curSubmit._numEle+=6;this._mesh.indexNum+=6;this._mesh.vertNum+=4;}};_proto76.fillRect=function fillRect(x,y,width,height,fillStyle){var drawstyle=fillStyle?DrawStyle.create(fillStyle):this._shader2D.fillStyle;var rgba=this.mixRGBandAlpha(drawstyle.toInt());this._fillRect(x,y,width,height,rgba);};_proto76.fillTexture=function fillTexture(texture,x,y,width,height,type,offset,other){if(!texture._getSource()){this.sprite&&ILaya.systemTimer.callLater(this,this._repaintSprite);return;}this._fillTexture(texture,texture.width,texture.height,texture.uvrect,x,y,width,height,type,offset.x,offset.y);};_proto76._fillTexture=function _fillTexture(texture,texw,texh,texuvRect,x,y,width,height,type,offsetx,offsety){var submit=this._curSubmit;if(this._mesh.vertNum+4>Context._MAXVERTNUM){this._mesh=MeshQuadTexture.getAMesh(this.isMain);this.meshlist.push(this._mesh);}var repeatx=true;var repeaty=true;switch(type){case"repeat":break;case"repeat-x":repeaty=false;break;case"repeat-y":repeatx=false;break;case"no-repeat":repeatx=repeaty=false;break;}var uv=this._temp4Points;var stu=0;var stv=0;var stx=0,sty=0,edx=0,edy=0;if(offsetx<0){stx=x;stu=-offsetx%texw/texw;}else {stx=x+offsetx;}if(offsety<0){sty=y;stv=-offsety%texh/texh;}else {sty=y+offsety;}edx=x+width;edy=y+height;!repeatx&&(edx=Math.min(edx,x+offsetx+texw));!repeaty&&(edy=Math.min(edy,y+offsety+texh));if(edx<x||edy<y)return;if(stx>edx||sty>edy)return;var edu=(edx-x-offsetx)/texw;var edv=(edy-y-offsety)/texh;this.transformQuad(stx,sty,edx-stx,edy-sty,0,this._curMat,this._transedPoints);uv[0]=stu;uv[1]=stv;uv[2]=edu;uv[3]=stv;uv[4]=edu;uv[5]=edv;uv[6]=stu;uv[7]=edv;if(!this.clipedOff(this._transedPoints)){var rgba=this._mixRGBandAlpha(0xffffffff,this._shader2D.ALPHA);this._mesh.addQuad(this._transedPoints,uv,rgba,true);var sv=Value2D.create(ShaderDefines2D.TEXTURE2D,0);sv.defines.add(ShaderDefines2D.FILLTEXTURE);sv.u_TexRange=texuvRect.concat();submit=this._curSubmit=SubmitTexture.create(this,this._mesh,sv);this._submits[this._submits._length++]=submit;this._copyClipInfo(submit,this._globalClipMatrix);submit.shaderValue.textureHost=texture;submit._renderType=SubmitBase.TYPE_TEXTURE;this._curSubmit._numEle+=6;this._mesh.indexNum+=6;this._mesh.vertNum+=4;}this.breakNextMerge();};_proto76.setColorFilter=function setColorFilter(filter){SaveBase.save(this,SaveBase.TYPE_COLORFILTER,this,true);this._colorFiler=filter;this._curSubmit=SubmitBase.RENDERBASE;};_proto76.drawTexture=function drawTexture(tex,x,y,width,height){this._drawTextureM(tex,x,y,width,height,null,1,null);};_proto76.drawTextures=function drawTextures(tex,pos,tx,ty){if(!tex._getSource()){this.sprite&&ILaya.systemTimer.callLater(this,this._repaintSprite);return;}var n=pos.length/2;var ipos=0;var bmpid=tex.bitmap.id;for(var i=0;i<n;i++){this._inner_drawTexture(tex,bmpid,pos[ipos++]+tx,pos[ipos++]+ty,0,0,null,null,1.0,false);}};_proto76._drawTextureAddSubmit=function _drawTextureAddSubmit(imgid,tex){var submit=null;submit=SubmitTexture.create(this,this._mesh,Value2D.create(ShaderDefines2D.TEXTURE2D,0));this._submits[this._submits._length++]=submit;submit.shaderValue.textureHost=tex;submit._key.other=imgid;submit._renderType=SubmitBase.TYPE_TEXTURE;this._curSubmit=submit;};_proto76._drawTextureM=function _drawTextureM(tex,x,y,width,height,m,alpha,uv){var cs=this.sprite;if(!tex._getSource(function(){if(cs){cs.repaint();}})){return false;}return this._inner_drawTexture(tex,tex.bitmap.id,x,y,width,height,m,uv,alpha,false);};_proto76._drawRenderTexture=function _drawRenderTexture(tex,x,y,width,height,m,alpha,uv){return this._inner_drawTexture(tex,-1,x,y,width,height,m,uv,1.0,false);};_proto76.submitDebugger=function submitDebugger(){this._submits[this._submits._length++]=SubmitCMD.create([],function(){debugger;},this);};_proto76._copyClipInfo=function _copyClipInfo(submit,clipInfo){var cm=submit.shaderValue.clipMatDir;cm[0]=clipInfo.a;cm[1]=clipInfo.b;cm[2]=clipInfo.c;cm[3]=clipInfo.d;var cmp=submit.shaderValue.clipMatPos;cmp[0]=clipInfo.tx;cmp[1]=clipInfo.ty;submit.clipInfoID=this._clipInfoID;if(this._clipInCache){submit.shaderValue.clipOff[0]=1;}};_proto76.isSameClipInfo=function isSameClipInfo(submit){return submit.clipInfoID===this._clipInfoID;};_proto76._useNewTex2DSubmit=function _useNewTex2DSubmit(tex,minVertNum){if(this._mesh.vertNum+minVertNum>Context._MAXVERTNUM){this._mesh=MeshQuadTexture.getAMesh(this.isMain);this.meshlist.push(this._mesh);}var submit=SubmitTexture.create(this,this._mesh,Value2D.create(ShaderDefines2D.TEXTURE2D,0));this._submits[this._submits._length++]=this._curSubmit=submit;submit.shaderValue.textureHost=tex;this._copyClipInfo(submit,this._globalClipMatrix);};_proto76._drawTexRect=function _drawTexRect(x,y,w,h,uv){this.transformQuad(x,y,w,h,this._italicDeg,this._curMat,this._transedPoints);var ops=this._transedPoints;ops[0]=ops[0]+0.5|0;ops[1]=ops[1]+0.5|0;ops[2]=ops[2]+0.5|0;ops[3]=ops[3]+0.5|0;ops[4]=ops[4]+0.5|0;ops[5]=ops[5]+0.5|0;ops[6]=ops[6]+0.5|0;ops[7]=ops[7]+0.5|0;if(!this.clipedOff(this._transedPoints)){this._mesh.addQuad(this._transedPoints,uv,this._fillColor,true);this._curSubmit._numEle+=6;this._mesh.indexNum+=6;this._mesh.vertNum+=4;}};_proto76.drawCallOptimize=function drawCallOptimize(enable){this._charSubmitCache.enable(enable,this);return enable;};_proto76._inner_drawTexture=function _inner_drawTexture(tex,imgid,x,y,width,height,m,uv,alpha,lastRender){if(width<=0||height<=0){return;}var preKey=this._curSubmit._key;uv=uv||tex._uv;if(preKey.submitType===SubmitBase.KEY_TRIANGLES&&preKey.other===imgid){var tv=this._drawTexToDrawTri_Vert;tv[0]=x;tv[1]=y;tv[2]=x+width,tv[3]=y,tv[4]=x+width,tv[5]=y+height,tv[6]=x,tv[7]=y+height;this._drawTriUseAbsMatrix=true;var tuv=this._tempUV;tuv[0]=uv[0];tuv[1]=uv[1];tuv[2]=uv[2];tuv[3]=uv[3];tuv[4]=uv[4];tuv[5]=uv[5];tuv[6]=uv[6];tuv[7]=uv[7];this.drawTriangles(tex,0,0,tv,tuv,this._drawTexToDrawTri_Index,m,alpha,null,null);this._drawTriUseAbsMatrix=false;return true;}var mesh=this._mesh;var submit=this._curSubmit;var ops=lastRender?this._charSubmitCache.getPos():this._transedPoints;this.transformQuad(x,y,width||tex.width,height||tex.height,this._italicDeg,m||this._curMat,ops);if(this.drawTexAlign){var round=Math.round;ops[0]=round(ops[0]);ops[1]=round(ops[1]);ops[2]=round(ops[2]);ops[3]=round(ops[3]);ops[4]=round(ops[4]);ops[5]=round(ops[5]);ops[6]=round(ops[6]);ops[7]=round(ops[7]);this.drawTexAlign=false;}var rgba=this._mixRGBandAlpha(0xffffffff,this._shader2D.ALPHA*alpha);if(lastRender){this._charSubmitCache.add(this,tex,imgid,ops,uv,rgba);return true;}this._drawCount++;var sameKey=imgid>=0&&preKey.submitType===SubmitBase.KEY_DRAWTEXTURE&&preKey.other===imgid;sameKey&&(sameKey=sameKey&&this.isSameClipInfo(submit));this._lastTex=tex;if(mesh.vertNum+4>Context._MAXVERTNUM){mesh=this._mesh=MeshQuadTexture.getAMesh(this.isMain);this.meshlist.push(mesh);sameKey=false;}{mesh.addQuad(ops,uv,rgba,true);if(!sameKey){this._submits[this._submits._length++]=this._curSubmit=submit=SubmitTexture.create(this,mesh,Value2D.create(ShaderDefines2D.TEXTURE2D,0));submit.shaderValue.textureHost=tex;submit._key.other=imgid;this._copyClipInfo(submit,this._globalClipMatrix);}submit._numEle+=6;mesh.indexNum+=6;mesh.vertNum+=4;return true;}};_proto76.transform4Points=function transform4Points(a,m,out){var tx=m.tx;var ty=m.ty;var ma=m.a;var mb=m.b;var mc=m.c;var md=m.d;var a0=a[0];var a1=a[1];var a2=a[2];var a3=a[3];var a4=a[4];var a5=a[5];var a6=a[6];var a7=a[7];if(m._bTransform){out[0]=a0*ma+a1*mc+tx;out[1]=a0*mb+a1*md+ty;out[2]=a2*ma+a3*mc+tx;out[3]=a2*mb+a3*md+ty;out[4]=a4*ma+a5*mc+tx;out[5]=a4*mb+a5*md+ty;out[6]=a6*ma+a7*mc+tx;out[7]=a6*mb+a7*md+ty;}else {out[0]=a0+tx;out[1]=a1+ty;out[2]=a2+tx;out[3]=a3+ty;out[4]=a4+tx;out[5]=a5+ty;out[6]=a6+tx;out[7]=a7+ty;}};_proto76.clipedOff=function clipedOff(pt){if(this._clipRect.width<=0||this._clipRect.height<=0)return true;return false;};_proto76.transformQuad=function transformQuad(x,y,w,h,italicDeg,m,out){var xoff=0;if(italicDeg!=0){xoff=Math.tan(italicDeg*Math.PI/180)*h;}var maxx=x+w;var maxy=y+h;var tx=m.tx;var ty=m.ty;var ma=m.a;var mb=m.b;var mc=m.c;var md=m.d;var a0=x+xoff;var a1=y;var a2=maxx+xoff;var a3=y;var a4=maxx;var a5=maxy;var a6=x;var a7=maxy;if(m._bTransform){out[0]=a0*ma+a1*mc+tx;out[1]=a0*mb+a1*md+ty;out[2]=a2*ma+a3*mc+tx;out[3]=a2*mb+a3*md+ty;out[4]=a4*ma+a5*mc+tx;out[5]=a4*mb+a5*md+ty;out[6]=a6*ma+a7*mc+tx;out[7]=a6*mb+a7*md+ty;}else {out[0]=a0+tx;out[1]=a1+ty;out[2]=a2+tx;out[3]=a3+ty;out[4]=a4+tx;out[5]=a5+ty;out[6]=a6+tx;out[7]=a7+ty;}};_proto76.pushRT=function pushRT(){this.addRenderObject(SubmitCMD.create(null,RenderTexture2D.pushRT,this));};_proto76.popRT=function popRT(){this.addRenderObject(SubmitCMD.create(null,RenderTexture2D.popRT,this));this.breakNextMerge();};_proto76.useRT=function useRT(rt){function _use(rt){if(!rt){throw 'error useRT';}else {rt.start();rt.clear(0,0,0,0);}}this.addRenderObject(SubmitCMD.create([rt],_use,this));this.breakNextMerge();};_proto76.RTRestore=function RTRestore(rt){function _restore(rt){rt.restore();}this.addRenderObject(SubmitCMD.create([rt],_restore,this));this.breakNextMerge();};_proto76.breakNextMerge=function breakNextMerge(){this._curSubmit=SubmitBase.RENDERBASE;};_proto76._repaintSprite=function _repaintSprite(){this.sprite&&this.sprite.repaint();};_proto76.drawTextureWithTransform=function drawTextureWithTransform(tex,x,y,width,height,transform,tx,ty,alpha,blendMode,colorfilter,uv){if(colorfilter===void 0){colorfilter=null;}var oldcomp;var curMat=this._curMat;if(blendMode){oldcomp=this.globalCompositeOperation;this.globalCompositeOperation=blendMode;}var oldColorFilter=this._colorFiler;if(colorfilter){this.setColorFilter(colorfilter);}if(!transform){this._drawTextureM(tex,x+tx,y+ty,width,height,curMat,alpha,uv);if(blendMode){this.globalCompositeOperation=oldcomp;}if(colorfilter){this.setColorFilter(oldColorFilter);}return;}var tmpMat=this._tmpMatrix;tmpMat.a=transform.a;tmpMat.b=transform.b;tmpMat.c=transform.c;tmpMat.d=transform.d;tmpMat.tx=transform.tx+tx;tmpMat.ty=transform.ty+ty;tmpMat._bTransform=transform._bTransform;if(transform&&curMat._bTransform){Matrix.mul(tmpMat,curMat,tmpMat);transform=tmpMat;transform._bTransform=true;}else {tmpMat.tx+=curMat.tx;tmpMat.ty+=curMat.ty;transform=tmpMat;}this._drawTextureM(tex,x,y,width,height,transform,alpha,uv);if(blendMode){this.globalCompositeOperation=oldcomp;}if(colorfilter){this.setColorFilter(oldColorFilter);}};_proto76._flushToTarget=function _flushToTarget(context,target){RenderState2D.worldScissorTest=false;var gl=LayaGL.instance;gl.disable(gl.SCISSOR_TEST);var preAlpha=RenderState2D.worldAlpha;var preMatrix4=RenderState2D.worldMatrix4;var preMatrix=RenderState2D.worldMatrix;RenderState2D.worldMatrix=Matrix.EMPTY;RenderState2D.restoreTempArray();RenderState2D.worldMatrix4=RenderState2D.TEMPMAT4_ARRAY;RenderState2D.worldAlpha=1;BaseShader.activeShader=null;target.start();if(context._submits._length>0)target.clear(0,0,0,0);context._curSubmit=SubmitBase.RENDERBASE;context.flush();context.clear();target.restore();context._curSubmit=SubmitBase.RENDERBASE;BaseShader.activeShader=null;RenderState2D.worldAlpha=preAlpha;RenderState2D.worldMatrix4=preMatrix4;RenderState2D.worldMatrix=preMatrix;};_proto76.drawCanvas=function drawCanvas(canvas,x,y,width,height){if(!canvas)return;var src=canvas.context;var submit;if(src._targets){if(src._submits._length>0){submit=SubmitCMD.create([src,src._targets],this._flushToTarget,this);this._submits[this._submits._length++]=submit;}this._drawRenderTexture(src._targets,x,y,width,height,null,1.0,RenderTexture2D.flipyuv);this._curSubmit=SubmitBase.RENDERBASE;}else {var canv=canvas;if(canv.touches){canv.touches.forEach(function(v){v.touch();});}submit=SubmitCanvas.create(canvas,this._shader2D.ALPHA,this._shader2D.filters);this._submits[this._submits._length++]=submit;submit._key.clear();var mat=submit._matrix;this._curMat.copyTo(mat);var tx=mat.tx,ty=mat.ty;mat.tx=mat.ty=0;mat.transformPoint(Point.TEMP.setTo(x,y));mat.translate(Point.TEMP.x+tx,Point.TEMP.y+ty);Matrix.mul(canv.invMat,mat,mat);this._curSubmit=SubmitBase.RENDERBASE;}};_proto76.drawTarget=function drawTarget(rt,x,y,width,height,m,shaderValue,uv,blend){if(uv===void 0){uv=null;}if(blend===void 0){blend=-1;}this._drawCount++;if(this._mesh.vertNum+4>Context._MAXVERTNUM){this._mesh=MeshQuadTexture.getAMesh(this.isMain);this.meshlist.push(this._mesh);}this.transformQuad(x,y,width,height,0,m||this._curMat,this._transedPoints);if(!this.clipedOff(this._transedPoints)){this._mesh.addQuad(this._transedPoints,uv||Texture.DEF_UV,0xffffffff,true);var submit=this._curSubmit=SubmitTarget.create(this,this._mesh,shaderValue,rt);submit.blendType=blend==-1?this._nBlendType:blend;this._copyClipInfo(submit,this._globalClipMatrix);submit._numEle=6;this._mesh.indexNum+=6;this._mesh.vertNum+=4;this._submits[this._submits._length++]=submit;this._curSubmit=SubmitBase.RENDERBASE;return true;}this._curSubmit=SubmitBase.RENDERBASE;return false;};_proto76.drawTriangles=function drawTriangles(tex,x,y,vertices,uvs,indices,matrix,alpha,color,blendMode,colorNum){if(colorNum===void 0){colorNum=0xffffffff;}if(!tex._getSource()){if(this.sprite){ILaya.systemTimer.callLater(this,this._repaintSprite);}return;}var oldcomp=null;if(blendMode){oldcomp=this.globalCompositeOperation;this.globalCompositeOperation=blendMode;}this._drawCount++;var tmpMat=this._tmpMatrix;var triMesh=this._triangleMesh;var oldColorFilter=null;var needRestorFilter=false;if(color){oldColorFilter=this._colorFiler;this._colorFiler=color;this._curSubmit=SubmitBase.RENDERBASE;needRestorFilter=oldColorFilter!=color;}var webGLImg=tex.bitmap;var preKey=this._curSubmit._key;var sameKey=preKey.submitType===SubmitBase.KEY_TRIANGLES&&preKey.other===webGLImg.id&&preKey.blendShader==this._nBlendType;if(triMesh.vertNum+vertices.length/2>Context._MAXVERTNUM){triMesh=this._triangleMesh=MeshTexture.getAMesh(this.isMain);this.meshlist.push(triMesh);sameKey=false;}if(!sameKey){var submit=this._curSubmit=SubmitTexture.create(this,triMesh,Value2D.create(ShaderDefines2D.TEXTURE2D,0));submit.shaderValue.textureHost=tex;submit._renderType=SubmitBase.TYPE_TEXTURE;submit._key.submitType=SubmitBase.KEY_TRIANGLES;submit._key.other=webGLImg.id;this._copyClipInfo(submit,this._globalClipMatrix);this._submits[this._submits._length++]=submit;}var rgba=this._mixRGBandAlpha(colorNum,this._shader2D.ALPHA*alpha);if(!this._drawTriUseAbsMatrix){if(!matrix){tmpMat.a=1;tmpMat.b=0;tmpMat.c=0;tmpMat.d=1;tmpMat.tx=x;tmpMat.ty=y;}else {tmpMat.a=matrix.a;tmpMat.b=matrix.b;tmpMat.c=matrix.c;tmpMat.d=matrix.d;tmpMat.tx=matrix.tx+x;tmpMat.ty=matrix.ty+y;}Matrix.mul(tmpMat,this._curMat,tmpMat);triMesh.addData(vertices,uvs,indices,tmpMat||this._curMat,rgba);}else {triMesh.addData(vertices,uvs,indices,matrix,rgba);}this._curSubmit._numEle+=indices.length;if(needRestorFilter){this._colorFiler=oldColorFilter;this._curSubmit=SubmitBase.RENDERBASE;}if(blendMode){this.globalCompositeOperation=oldcomp;}};_proto76.transform=function transform(a,b,c,d,tx,ty){SaveTransform.save(this);Matrix.mul(Matrix.TEMP.setTo(a,b,c,d,tx,ty),this._curMat,this._curMat);this._curMat._checkTransform();};_proto76._transformByMatrix=function _transformByMatrix(matrix,tx,ty){matrix.setTranslate(tx,ty);Matrix.mul(matrix,this._curMat,this._curMat);matrix.setTranslate(0,0);this._curMat._bTransform=true;};_proto76.setTransformByMatrix=function setTransformByMatrix(value){value.copyTo(this._curMat);};_proto76.rotate=function rotate(angle){SaveTransform.save(this);this._curMat.rotateEx(angle);};_proto76.scale=function scale(scaleX,scaleY){SaveTransform.save(this);this._curMat.scaleEx(scaleX,scaleY);};_proto76.clipRect=function clipRect(x,y,width,height){SaveClipRect.save(this);if(this._clipRect==Context.MAXCLIPRECT){this._clipRect=new Rectangle(x,y,width,height);}else {this._clipRect.width=width;this._clipRect.height=height;this._clipRect.x=x;this._clipRect.y=y;}this._clipID_Gen++;this._clipID_Gen%=10000;this._clipInfoID=this._clipID_Gen;var cm=this._globalClipMatrix;var minx=cm.tx;var miny=cm.ty;var maxx=minx+cm.a;var maxy=miny+cm.d;if(this._clipRect.width>=Context._MAXSIZE){cm.a=cm.d=Context._MAXSIZE;cm.b=cm.c=cm.tx=cm.ty=0;}else {if(this._curMat._bTransform){cm.tx=this._clipRect.x*this._curMat.a+this._clipRect.y*this._curMat.c+this._curMat.tx;cm.ty=this._clipRect.x*this._curMat.b+this._clipRect.y*this._curMat.d+this._curMat.ty;cm.a=this._clipRect.width*this._curMat.a;cm.b=this._clipRect.width*this._curMat.b;cm.c=this._clipRect.height*this._curMat.c;cm.d=this._clipRect.height*this._curMat.d;}else {cm.tx=this._clipRect.x+this._curMat.tx;cm.ty=this._clipRect.y+this._curMat.ty;cm.a=this._clipRect.width;cm.b=cm.c=0;cm.d=this._clipRect.height;}if(this._incache){this._clipInCache=true;}}if(cm.a>0&&cm.d>0){var cmaxx=cm.tx+cm.a;var cmaxy=cm.ty+cm.d;if(cmaxx<=minx||cmaxy<=miny||cm.tx>=maxx||cm.ty>=maxy){cm.a=-0.1;cm.d=-0.1;}else {if(cm.tx<minx){cm.a-=minx-cm.tx;cm.tx=minx;}if(cmaxx>maxx){cm.a-=cmaxx-maxx;}if(cm.ty<miny){cm.d-=miny-cm.ty;cm.ty=miny;}if(cmaxy>maxy){cm.d-=cmaxy-maxy;}if(cm.a<=0)cm.a=-0.1;if(cm.d<=0)cm.d=-0.1;}}};_proto76.drawMesh=function drawMesh(x,y,ib,vb,numElement,mat,shader,shaderValues,startIndex){};_proto76.addRenderObject=function addRenderObject(o){this._submits[this._submits._length++]=o;};_proto76.submitElement=function submitElement(start,end){var mainCtx=this.isMain;var renderList=this._submits;var ret=renderList._length;end<0&&(end=renderList._length);var submit=SubmitBase.RENDERBASE;while(start<end){this._renderNextSubmitIndex=start+1;if(renderList[start]===SubmitBase.RENDERBASE){start++;continue;}SubmitBase.preRender=submit;submit=renderList[start];start+=submit.renderSubmit();}return ret;};_proto76.flush=function flush(){this._clipID_Gen=0;var ret=this.submitElement(0,this._submits._length);this._path&&this._path.reset();SkinMeshBuffer.instance&&SkinMeshBuffer.getInstance().reset();this._curSubmit=SubmitBase.RENDERBASE;for(var i=0,sz=this.meshlist.length;i<sz;i++){var curm=this.meshlist[i];curm.canReuse?curm.releaseMesh():curm.destroy();}this.meshlist.length=0;this._mesh=MeshQuadTexture.getAMesh(this.isMain);this._pathMesh=MeshVG.getAMesh(this.isMain);this._triangleMesh=MeshTexture.getAMesh(this.isMain);this.meshlist.push(this._mesh,this._pathMesh,this._triangleMesh);this._flushCnt++;if(this._flushCnt%60==0&&this.isMain){if(TextRender.textRenderInst){TextRender.textRenderInst.GC();}}return ret;};_proto76.beginPath=function beginPath(convex){if(convex===void 0){convex=false;}var tPath=this._getPath();tPath.beginPath(convex);};_proto76.closePath=function closePath(){this._path.closePath();};_proto76.addPath=function addPath(points,close,convex,dx,dy){var ci=0;for(var i=0,sz=points.length/2;i<sz;i++){var x1=points[ci]+dx,y1=points[ci+1]+dy;points[ci]=x1;points[ci+1]=y1;ci+=2;}this._getPath().push(points,convex);};_proto76.fill=function fill(){var m=this._curMat;var tPath=this._getPath();var submit=this._curSubmit;var sameKey=submit._key.submitType===SubmitBase.KEY_VG&&submit._key.blendShader===this._nBlendType;sameKey&&(sameKey=sameKey&&this.isSameClipInfo(submit));if(!sameKey){this._curSubmit=this.addVGSubmit(this._pathMesh);}var rgba=this.mixRGBandAlpha(this.fillStyle.toInt());var curEleNum=0;var idx;for(var i=0,sz=tPath.paths.length;i<sz;i++){var p=tPath.paths[i];var vertNum=p.path.length/2;if(vertNum<3||vertNum==3&&!p.convex)continue;var cpath=p.path.concat();var pi=0;var xp,yp;var _x,_y;if(m._bTransform){for(pi=0;pi<vertNum;pi++){xp=pi<<1;yp=xp+1;_x=cpath[xp];_y=cpath[yp];cpath[xp]=m.a*_x+m.c*_y+m.tx;cpath[yp]=m.b*_x+m.d*_y+m.ty;}}else {for(pi=0;pi<vertNum;pi++){xp=pi<<1;yp=xp+1;_x=cpath[xp];_y=cpath[yp];cpath[xp]=_x+m.tx;cpath[yp]=_y+m.ty;}}if(this._pathMesh.vertNum+vertNum>Context._MAXVERTNUM){this._curSubmit._numEle+=curEleNum;curEleNum=0;this._pathMesh=MeshVG.getAMesh(this.isMain);this._curSubmit=this.addVGSubmit(this._pathMesh);}var curvert=this._pathMesh.vertNum;if(p.convex){var faceNum=vertNum-2;idx=new Array(faceNum*3);var idxpos=0;for(var fi=0;fi<faceNum;fi++){idx[idxpos++]=curvert;idx[idxpos++]=fi+1+curvert;idx[idxpos++]=fi+2+curvert;}}else {idx=Earcut.earcut(cpath,null,2);if(curvert>0){for(var ii=0;ii<idx.length;ii++){idx[ii]+=curvert;}}}this._pathMesh.addVertAndIBToMesh(this,cpath,rgba,idx);curEleNum+=idx.length;}this._curSubmit._numEle+=curEleNum;};_proto76.addVGSubmit=function addVGSubmit(mesh){var submit=Submit.createShape(this,mesh,0,Value2D.create(ShaderDefines2D.PRIMITIVE,0));submit._key.submitType=SubmitBase.KEY_VG;this._submits[this._submits._length++]=submit;this._copyClipInfo(submit,this._globalClipMatrix);return submit;};_proto76.stroke=function stroke(){if(this.lineWidth>0){var rgba=this.mixRGBandAlpha(this.strokeStyle._color.numColor);var tPath=this._getPath();var submit=this._curSubmit;var sameKey=submit._key.submitType===SubmitBase.KEY_VG&&submit._key.blendShader===this._nBlendType;sameKey&&(sameKey=sameKey&&this.isSameClipInfo(submit));if(!sameKey){this._curSubmit=this.addVGSubmit(this._pathMesh);}var curEleNum=0;for(var i=0,sz=tPath.paths.length;i<sz;i++){var p=tPath.paths[i];if(p.path.length<=0)continue;var idx=[];var vertex=[];var maxVertexNum=p.path.length*2;if(maxVertexNum<2)continue;if(this._pathMesh.vertNum+maxVertexNum>Context._MAXVERTNUM){this._curSubmit._numEle+=curEleNum;curEleNum=0;this._pathMesh=MeshVG.getAMesh(this.isMain);this.meshlist.push(this._pathMesh);this._curSubmit=this.addVGSubmit(this._pathMesh);}BasePoly.createLine2(p.path,idx,this.lineWidth,this._pathMesh.vertNum,vertex,p.loop);var ptnum=vertex.length/2;var m=this._curMat;var pi=0;var xp,yp;var _x,_y;if(m._bTransform){for(pi=0;pi<ptnum;pi++){xp=pi<<1;yp=xp+1;_x=vertex[xp];_y=vertex[yp];vertex[xp]=m.a*_x+m.c*_y+m.tx;vertex[yp]=m.b*_x+m.d*_y+m.ty;}}else {for(pi=0;pi<ptnum;pi++){xp=pi<<1;yp=xp+1;_x=vertex[xp];_y=vertex[yp];vertex[xp]=_x+m.tx;vertex[yp]=_y+m.ty;}}this._pathMesh.addVertAndIBToMesh(this,vertex,rgba,idx);curEleNum+=idx.length;}this._curSubmit._numEle+=curEleNum;}};_proto76.moveTo=function moveTo(x,y){var tPath=this._getPath();tPath.newPath();tPath._lastOriX=x;tPath._lastOriY=y;tPath.addPoint(x,y);};_proto76.lineTo=function lineTo(x,y){var tPath=this._getPath();if(Math.abs(x-tPath._lastOriX)<1e-3&&Math.abs(y-tPath._lastOriY)<1e-3)return;tPath._lastOriX=x;tPath._lastOriY=y;tPath.addPoint(x,y);};_proto76.arcTo=function arcTo(x1,y1,x2,y2,r){var i=0;var x=0,y=0;var dx=this._path._lastOriX-x1;var dy=this._path._lastOriY-y1;var len1=Math.sqrt(dx*dx+dy*dy);if(len1<=0.000001){return;}var ndx=dx/len1;var ndy=dy/len1;var dx2=x2-x1;var dy2=y2-y1;var len22=dx2*dx2+dy2*dy2;var len2=Math.sqrt(len22);if(len2<=0.000001){return;}var ndx2=dx2/len2;var ndy2=dy2/len2;var odx=ndx+ndx2;var ody=ndy+ndy2;var olen=Math.sqrt(odx*odx+ody*ody);if(olen<=0.000001){return;}var nOdx=odx/olen;var nOdy=ody/olen;var alpha=Math.acos(nOdx*ndx+nOdy*ndy);var halfAng=Math.PI/2-alpha;len1=r/Math.tan(halfAng);var ptx1=len1*ndx+x1;var pty1=len1*ndy+y1;var orilen=Math.sqrt(len1*len1+r*r);var orix=x1+nOdx*orilen;var oriy=y1+nOdy*orilen;var dir=ndx*ndy2-ndy*ndx2;var fChgAng=0;var sinx=0.0;var cosx=0.0;if(dir>=0){fChgAng=halfAng*2;var fda=fChgAng/Context.SEGNUM;sinx=Math.sin(fda);cosx=Math.cos(fda);}else {fChgAng=-halfAng*2;fda=fChgAng/Context.SEGNUM;sinx=Math.sin(fda);cosx=Math.cos(fda);}var lastx=this._path._lastOriX,lasty=this._path._lastOriY;var _x1=ptx1,_y1=pty1;if(Math.abs(_x1-this._path._lastOriX)>0.1||Math.abs(_y1-this._path._lastOriY)>0.1){x=_x1;y=_y1;lastx=_x1;lasty=_y1;this._path._lastOriX=x;this._path._lastOriY=y;this._path.addPoint(x,y);}var cvx=ptx1-orix;var cvy=pty1-oriy;for(i=0;i<Context.SEGNUM;i++){var cx=cvx*cosx+cvy*sinx;var cy=-cvx*sinx+cvy*cosx;x=cx+orix;y=cy+oriy;if(Math.abs(lastx-x)>0.1||Math.abs(lasty-y)>0.1){this._path._lastOriX=x;this._path._lastOriY=y;this._path.addPoint(x,y);lastx=x;lasty=y;}cvx=cx;cvy=cy;}};_proto76.arc=function arc(cx,cy,r,startAngle,endAngle,counterclockwise,b){if(counterclockwise===void 0){counterclockwise=false;}var a=0,da=0;var dx=0,dy=0,x=0,y=0;var i,ndivs;da=endAngle-startAngle;if(!counterclockwise){if(Math.abs(da)>=Math.PI*2){da=Math.PI*2;}else {while(da<0.0){da+=Math.PI*2;}}}else {if(Math.abs(da)>=Math.PI*2){da=-Math.PI*2;}else {while(da>0.0){da-=Math.PI*2;}}}var sx=this.getMatScaleX();var sy=this.getMatScaleY();var sr=r*(sx>sy?sx:sy);var cl=2*Math.PI*sr;ndivs=Math.max(cl/10,10)|0;var tPath=this._getPath();for(i=0;i<=ndivs;i++){a=startAngle+da*(i/ndivs);dx=Math.cos(a);dy=Math.sin(a);x=cx+dx*r;y=cy+dy*r;if(x!=this._path._lastOriX||y!=this._path._lastOriY){tPath.addPoint(x,y);}}dx=Math.cos(endAngle);dy=Math.sin(endAngle);x=cx+dx*r;y=cy+dy*r;if(x!=this._path._lastOriX||y!=this._path._lastOriY){tPath.addPoint(x,y);}};_proto76.quadraticCurveTo=function quadraticCurveTo(cpx,cpy,x,y){var tBezier=Bezier.I;var tArray=tBezier.getBezierPoints([this._path._lastOriX,this._path._lastOriY,cpx,cpy,x,y],30,2);for(var i=0,n=tArray.length/2;i<n;i++){this.lineTo(tArray[i*2],tArray[i*2+1]);}this.lineTo(x,y);};_proto76.mixRGBandAlpha=function mixRGBandAlpha(color){return this._mixRGBandAlpha(color,this._shader2D.ALPHA);};_proto76._mixRGBandAlpha=function _mixRGBandAlpha(color,alpha){if(alpha>=1){return color;}var a=(color&0xff000000)>>>24;if(a!=0){a*=alpha;}else {a=alpha*255;}return color&0x00ffffff|a<<24;};_proto76.strokeRect=function strokeRect(x,y,width,height,parameterLineWidth){if(this.lineWidth>0){var rgba=this.mixRGBandAlpha(this.strokeStyle._color.numColor);var hw=this.lineWidth/2;this._fillRect(x-hw,y-hw,width+this.lineWidth,this.lineWidth,rgba);this._fillRect(x-hw,y-hw+height,width+this.lineWidth,this.lineWidth,rgba);this._fillRect(x-hw,y+hw,this.lineWidth,height-this.lineWidth,rgba);this._fillRect(x-hw+width,y+hw,this.lineWidth,height-this.lineWidth,rgba);}};_proto76.clip=function clip(){};_proto76.drawParticle=function drawParticle(x,y,pt){pt.x=x;pt.y=y;this._submits[this._submits._length++]=pt;};_proto76._getPath=function _getPath(){return this._path||(this._path=new Path());};_proto76._fillTexture_h=function _fillTexture_h(tex,imgid,uv,oriw,orih,x,y,w){if(oriw<=0)console.error('_fillTexture_h error: oriw must>0');var stx=x;var num=Math.floor(w/oriw);var left=w%oriw;for(var i=0;i<num;i++){this._inner_drawTexture(tex,imgid,stx,y,oriw,orih,this._curMat,uv,1,false);stx+=oriw;}if(left>0){var du=uv[2]-uv[0];var uvr=uv[0]+du*(left/oriw);var tuv=Context.tmpuv1;tuv[0]=uv[0];tuv[1]=uv[1];tuv[2]=uvr;tuv[3]=uv[3];tuv[4]=uvr;tuv[5]=uv[5];tuv[6]=uv[6];tuv[7]=uv[7];this._inner_drawTexture(tex,imgid,stx,y,left,orih,this._curMat,tuv,1,false);}};_proto76._fillTexture_v=function _fillTexture_v(tex,imgid,uv,oriw,orih,x,y,h){if(orih<=0)console.error('_fillTexture_v error: orih must>0');var sty=y;var num=Math.floor(h/orih);var left=h%orih;for(var i=0;i<num;i++){this._inner_drawTexture(tex,imgid,x,sty,oriw,orih,this._curMat,uv,1,false);sty+=orih;}if(left>0){var dv=uv[7]-uv[1];var uvb=uv[1]+dv*(left/orih);var tuv=Context.tmpuv1;tuv[0]=uv[0];tuv[1]=uv[1];tuv[2]=uv[2];tuv[3]=uv[3];tuv[4]=uv[4];tuv[5]=uvb;tuv[6]=uv[6];tuv[7]=uvb;this._inner_drawTexture(tex,imgid,x,sty,oriw,left,this._curMat,tuv,1,false);}};_proto76.drawTextureWithSizeGrid=function drawTextureWithSizeGrid(tex,tx,ty,width,height,sizeGrid,gx,gy){if(!tex._getSource())return;tx+=gx;ty+=gy;var uv=tex.uv,w=tex.bitmap.width,h=tex.bitmap.height;var top=sizeGrid[0];var left=sizeGrid[3];var right=sizeGrid[1];var bottom=sizeGrid[2];var repeat=sizeGrid[4];var needClip=false;if(width==w){left=right=0;}if(height==h){top=bottom=0;}var d_top=top/h;var d_left=left/w;var d_right=right/w;var d_bottom=bottom/h;if(left+right>width){var clipWidth=width;needClip=true;width=left+right;this.save();this.clipRect(0+tx,0+ty,clipWidth,height);}var imgid=tex.bitmap.id;var mat=this._curMat;var tuv=this._tempUV;var uvl=uv[0];var uvt=uv[1];var uvr=uv[4];var uvb=uv[5];var uvl_=uvl;var uvt_=uvt;var uvr_=uvr;var uvb_=uvb;if(left&&top){uvr_=uvl+d_left;uvb_=uvt+d_top;tuv[0]=uvl,tuv[1]=uvt,tuv[2]=uvr_,tuv[3]=uvt,tuv[4]=uvr_,tuv[5]=uvb_,tuv[6]=uvl,tuv[7]=uvb_;this._inner_drawTexture(tex,imgid,tx,ty,left,top,mat,tuv,1,false);}if(right&&top){uvl_=uvr-d_right;uvt_=uvt;uvr_=uvr;uvb_=uvt+d_top;tuv[0]=uvl_,tuv[1]=uvt_,tuv[2]=uvr_,tuv[3]=uvt_,tuv[4]=uvr_,tuv[5]=uvb_,tuv[6]=uvl_,tuv[7]=uvb_;this._inner_drawTexture(tex,imgid,width-right+tx,0+ty,right,top,mat,tuv,1,false);}if(left&&bottom){uvl_=uvl;uvt_=uvb-d_bottom;uvr_=uvl+d_left;uvb_=uvb;tuv[0]=uvl_,tuv[1]=uvt_,tuv[2]=uvr_,tuv[3]=uvt_,tuv[4]=uvr_,tuv[5]=uvb_,tuv[6]=uvl_,tuv[7]=uvb_;this._inner_drawTexture(tex,imgid,0+tx,height-bottom+ty,left,bottom,mat,tuv,1,false);}if(right&&bottom){uvl_=uvr-d_right;uvt_=uvb-d_bottom;uvr_=uvr;uvb_=uvb;tuv[0]=uvl_,tuv[1]=uvt_,tuv[2]=uvr_,tuv[3]=uvt_,tuv[4]=uvr_,tuv[5]=uvb_,tuv[6]=uvl_,tuv[7]=uvb_;this._inner_drawTexture(tex,imgid,width-right+tx,height-bottom+ty,right,bottom,mat,tuv,1,false);}if(top){uvl_=uvl+d_left;uvt_=uvt;uvr_=uvr-d_right;uvb_=uvt+d_top;tuv[0]=uvl_,tuv[1]=uvt_,tuv[2]=uvr_,tuv[3]=uvt_,tuv[4]=uvr_,tuv[5]=uvb_,tuv[6]=uvl_,tuv[7]=uvb_;if(repeat){this._fillTexture_h(tex,imgid,tuv,tex.width-left-right,top,left+tx,ty,width-left-right);}else {this._inner_drawTexture(tex,imgid,left+tx,ty,width-left-right,top,mat,tuv,1,false);}}if(bottom){uvl_=uvl+d_left;uvt_=uvb-d_bottom;uvr_=uvr-d_right;uvb_=uvb;tuv[0]=uvl_,tuv[1]=uvt_,tuv[2]=uvr_,tuv[3]=uvt_,tuv[4]=uvr_,tuv[5]=uvb_,tuv[6]=uvl_,tuv[7]=uvb_;if(repeat){this._fillTexture_h(tex,imgid,tuv,tex.width-left-right,bottom,left+tx,height-bottom+ty,width-left-right);}else {this._inner_drawTexture(tex,imgid,left+tx,height-bottom+ty,width-left-right,bottom,mat,tuv,1,false);}}if(left){uvl_=uvl;uvt_=uvt+d_top;uvr_=uvl+d_left;uvb_=uvb-d_bottom;tuv[0]=uvl_,tuv[1]=uvt_,tuv[2]=uvr_,tuv[3]=uvt_,tuv[4]=uvr_,tuv[5]=uvb_,tuv[6]=uvl_,tuv[7]=uvb_;if(repeat){this._fillTexture_v(tex,imgid,tuv,left,tex.height-top-bottom,tx,top+ty,height-top-bottom);}else {this._inner_drawTexture(tex,imgid,tx,top+ty,left,height-top-bottom,mat,tuv,1,false);}}if(right){uvl_=uvr-d_right;uvt_=uvt+d_top;uvr_=uvr;uvb_=uvb-d_bottom;tuv[0]=uvl_,tuv[1]=uvt_,tuv[2]=uvr_,tuv[3]=uvt_,tuv[4]=uvr_,tuv[5]=uvb_,tuv[6]=uvl_,tuv[7]=uvb_;if(repeat){this._fillTexture_v(tex,imgid,tuv,right,tex.height-top-bottom,width-right+tx,top+ty,height-top-bottom);}else {this._inner_drawTexture(tex,imgid,width-right+tx,top+ty,right,height-top-bottom,mat,tuv,1,false);}}uvl_=uvl+d_left;uvt_=uvt+d_top;uvr_=uvr-d_right;uvb_=uvb-d_bottom;tuv[0]=uvl_,tuv[1]=uvt_,tuv[2]=uvr_,tuv[3]=uvt_,tuv[4]=uvr_,tuv[5]=uvb_,tuv[6]=uvl_,tuv[7]=uvb_;if(repeat){var tuvr=Context.tmpUVRect;tuvr[0]=uvl_;tuvr[1]=uvt_;tuvr[2]=uvr_-uvl_;tuvr[3]=uvb_-uvt_;this._fillTexture(tex,tex.width-left-right,tex.height-top-bottom,tuvr,left+tx,top+ty,width-left-right,height-top-bottom,'repeat',0,0);}else {this._inner_drawTexture(tex,imgid,left+tx,top+ty,width-left-right,height-top-bottom,mat,tuv,1,false);}if(needClip)this.restore();};_createClass(Context,[{key:"lineJoin",get:function get(){return '';},set:function set(value){}},{key:"lineCap",get:function get(){return '';},set:function set(value){}},{key:"miterLimit",get:function get(){return '';},set:function set(value){}},{key:"asBitmap",set:function set(value){if(value){var rt=this._targets;if(!this._width||!this._height)throw Error("asBitmap no size!");if(!rt||rt.width!=this._width||rt.height!=this._height){if(rt){rt.destroy();}this._targets=new RenderTexture2D(this._width,this._height,exports.RenderTextureFormat.R8G8B8A8,-1);}}else {this._targets&&this._targets.destroy();this._targets=null;}}},{key:"fillStyle",set:function set(value){if(!this._shader2D.fillStyle.equal(value)){SaveBase.save(this,SaveBase.TYPE_FILESTYLE,this._shader2D,false);this._shader2D.fillStyle=DrawStyle.create(value);this._submitKey.other=-this._shader2D.fillStyle.toInt();}},get:function get(){return this._shader2D.fillStyle;}},{key:"globalAlpha",set:function set(value){value=Math.floor(value*1000)/1000;if(value!=this._shader2D.ALPHA){SaveBase.save(this,SaveBase.TYPE_ALPHA,this._shader2D,false);this._shader2D.ALPHA=value;}},get:function get(){return this._shader2D.ALPHA;}},{key:"textAlign",set:function set(value){this._other.textAlign===value||(this._other=this._other.make(),SaveBase.save(this,SaveBase.TYPE_TEXTALIGN,this._other,false),this._other.textAlign=value);},get:function get(){return this._other.textAlign;}},{key:"textBaseline",set:function set(value){this._other.textBaseline===value||(this._other=this._other.make(),SaveBase.save(this,SaveBase.TYPE_TEXTBASELINE,this._other,false),this._other.textBaseline=value);},get:function get(){return this._other.textBaseline;}},{key:"globalCompositeOperation",set:function set(value){var n=BlendMode.TOINT[value];n==null||this._nBlendType===n||(SaveBase.save(this,SaveBase.TYPE_GLOBALCOMPOSITEOPERATION,this,true),this._curSubmit=SubmitBase.RENDERBASE,this._nBlendType=n);},get:function get(){return BlendMode.NAMES[this._nBlendType];}},{key:"strokeStyle",set:function set(value){this._shader2D.strokeStyle.equal(value)||(SaveBase.save(this,SaveBase.TYPE_STROKESTYLE,this._shader2D,false),this._shader2D.strokeStyle=DrawStyle.create(value),this._submitKey.other=-this._shader2D.strokeStyle.toInt());},get:function get(){return this._shader2D.strokeStyle;}},{key:"lineWidth",set:function set(value){this._other.lineWidth===value||(this._other=this._other.make(),SaveBase.save(this,SaveBase.TYPE_LINEWIDTH,this._other,false),this._other.lineWidth=value);},get:function get(){return this._other.lineWidth;}},{key:"font",set:function set(str){this._other=this._other.make();SaveBase.save(this,SaveBase.TYPE_FONT,this._other,false);}},{key:"canvas",get:function get(){return this._canvas;}}]);return Context;}();Context.ENUM_TEXTALIGN_DEFAULT=0;Context.ENUM_TEXTALIGN_CENTER=1;Context.ENUM_TEXTALIGN_RIGHT=2;Context._SUBMITVBSIZE=32000;Context._MAXSIZE=99999999;Context._MAXVERTNUM=65535;Context.MAXCLIPRECT=null;Context._COUNT=0;Context.SEGNUM=32;Context._contextcount=0;Context.PI2=2*Math.PI;Context._textRender=null;Context.tmpuv1=[0,0,0,0,0,0,0,0];Context.tmpUV=[0,0,0,0,0,0,0,0];Context.tmpUVRect=[0,0,0,0];var ContextParams=/*#__PURE__*/function(){function ContextParams(){this.lineWidth=1;}var _proto77=ContextParams.prototype;_proto77.clear=function clear(){this.lineWidth=1;this.textAlign=this.textBaseline=null;};_proto77.make=function make(){return this===ContextParams.DEFAULT?new ContextParams():this;};return ContextParams;}();var WebGL=/*#__PURE__*/function(){function WebGL(){}WebGL._uint8ArraySlice=function _uint8ArraySlice(){var _this=this;var sz=_this.length;var dec=new Uint8Array(_this.length);for(var i=0;i<sz;i++){dec[i]=_this[i];}return dec;};WebGL._float32ArraySlice=function _float32ArraySlice(){var _this=this;var sz=_this.length;var dec=new Float32Array(_this.length);for(var i=0;i<sz;i++){dec[i]=_this[i];}return dec;};WebGL._uint16ArraySlice=function _uint16ArraySlice(){var _this=this;var sz;var dec;var i;if(arguments.length===0){sz=_this.length;dec=new Uint16Array(sz);for(i=0;i<sz;i++){dec[i]=_this[i];}}else if(arguments.length===2){var start=arguments.length<=0?undefined:arguments[0];var end=arguments.length<=1?undefined:arguments[1];if(end>start){sz=end-start;dec=new Uint16Array(sz);for(i=start;i<end;i++){dec[i-start]=_this[i];}}else {dec=new Uint16Array(0);}}return dec;};WebGL._nativeRender_enable=function _nativeRender_enable(){};WebGL.enable=function enable(){return true;};WebGL.inner_enable=function inner_enable(){Float32Array.prototype.slice||(Float32Array.prototype.slice=WebGL._float32ArraySlice);Uint16Array.prototype.slice||(Uint16Array.prototype.slice=WebGL._uint16ArraySlice);Uint8Array.prototype.slice||(Uint8Array.prototype.slice=WebGL._uint8ArraySlice);return true;};WebGL.onStageResize=function onStageResize(width,height){if(WebGLContext.mainContext==null)return;WebGLContext.mainContext.viewport(0,0,width,height);RenderState2D.width=width;RenderState2D.height=height;};return WebGL;}();WebGL._isWebGL2=false;WebGL.isNativeRender_enable=false;var VertexArrayObject=function VertexArrayObject(){};(function(){var glErrorShadow={};function error(msg){if(window.console&&window.console.error){window.console.error(msg);}}function log(msg){if(window.console&&window.console.log){window.console.log(msg);}}function synthesizeGLError(err,opt_msg){glErrorShadow[err]=true;if(opt_msg!==undefined){error(opt_msg);}}function wrapGLError(gl){var f=gl.getError;gl.getError=function(){var err;do{err=f.apply(gl);if(err!=gl.NO_ERROR){glErrorShadow[err]=true;}}while(err!=gl.NO_ERROR);for(var err1 in glErrorShadow){if(glErrorShadow[err1]){delete glErrorShadow[err1];return parseInt(err1);}}return gl.NO_ERROR;};}var WebGLVertexArrayObjectOES=function WebGLVertexArrayObjectOES(ext){var gl=ext.gl;this.ext=ext;this.isAlive=true;this.hasBeenBound=false;this.elementArrayBuffer=null;this.attribs=new Array(ext.maxVertexAttribs);for(var n=0;n<this.attribs.length;n++){var attrib=new WebGLVertexArrayObjectOES.VertexAttrib(gl);this.attribs[n]=attrib;}this.maxAttrib=0;};WebGLVertexArrayObjectOES.VertexAttrib=function VertexAttrib(gl){this.enabled=false;this.buffer=null;this.size=4;this.type=gl.FLOAT;this.normalized=false;this.stride=16;this.offset=0;this.cached="";this.recache();};WebGLVertexArrayObjectOES.VertexAttrib.prototype.recache=function recache(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":");};var OESVertexArrayObject=function OESVertexArrayObject(gl){var self=this;this.gl=gl;wrapGLError(gl);var original=this.original={getParameter:gl.getParameter,enableVertexAttribArray:gl.enableVertexAttribArray,disableVertexAttribArray:gl.disableVertexAttribArray,bindBuffer:gl.bindBuffer,getVertexAttrib:gl.getVertexAttrib,vertexAttribPointer:gl.vertexAttribPointer};gl.getParameter=function getParameter(pname){if(pname==self.VERTEX_ARRAY_BINDING_OES){if(self.currentVertexArrayObject==self.defaultVertexArrayObject){return null;}else {return self.currentVertexArrayObject;}}return original.getParameter.apply(this,arguments);};gl.enableVertexAttribArray=function enableVertexAttribArray(index){var vao=self.currentVertexArrayObject;vao.maxAttrib=Math.max(vao.maxAttrib,index);var attrib=vao.attribs[index];attrib.enabled=true;return original.enableVertexAttribArray.apply(this,arguments);};gl.disableVertexAttribArray=function disableVertexAttribArray(index){var vao=self.currentVertexArrayObject;vao.maxAttrib=Math.max(vao.maxAttrib,index);var attrib=vao.attribs[index];attrib.enabled=false;return original.disableVertexAttribArray.apply(this,arguments);};gl.bindBuffer=function bindBuffer(target,buffer){switch(target){case gl.ARRAY_BUFFER:self.currentArrayBuffer=buffer;break;case gl.ELEMENT_ARRAY_BUFFER:self.currentVertexArrayObject.elementArrayBuffer=buffer;break;}return original.bindBuffer.apply(this,arguments);};gl.getVertexAttrib=function getVertexAttrib(index,pname){var vao=self.currentVertexArrayObject;var attrib=vao.attribs[index];switch(pname){case gl.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:return attrib.buffer;case gl.VERTEX_ATTRIB_ARRAY_ENABLED:return attrib.enabled;case gl.VERTEX_ATTRIB_ARRAY_SIZE:return attrib.size;case gl.VERTEX_ATTRIB_ARRAY_STRIDE:return attrib.stride;case gl.VERTEX_ATTRIB_ARRAY_TYPE:return attrib.type;case gl.VERTEX_ATTRIB_ARRAY_NORMALIZED:return attrib.normalized;default:return original.getVertexAttrib.apply(this,arguments);}};gl.vertexAttribPointer=function vertexAttribPointer(indx,size,type,normalized,stride,offset){var vao=self.currentVertexArrayObject;vao.maxAttrib=Math.max(vao.maxAttrib,indx);var attrib=vao.attribs[indx];attrib.buffer=self.currentArrayBuffer;attrib.size=size;attrib.type=type;attrib.normalized=normalized;attrib.stride=stride;attrib.offset=offset;attrib.recache();return original.vertexAttribPointer.apply(this,arguments);};if(gl.instrumentExtension){gl.instrumentExtension(this,"OES_vertex_array_object");}gl.canvas.addEventListener('webglcontextrestored',function(){log("OESVertexArrayObject emulation library context restored");self.reset_();},true);this.reset_();};OESVertexArrayObject.prototype.VERTEX_ARRAY_BINDING_OES=0x85B5;OESVertexArrayObject.prototype.reset_=function reset_(){var contextWasLost=this.vertexArrayObjects!==undefined;if(contextWasLost){for(var ii=0;ii<this.vertexArrayObjects.length;++ii){this.vertexArrayObjects.isAlive=false;}}var gl=this.gl;this.maxVertexAttribs=gl.getParameter(gl.MAX_VERTEX_ATTRIBS);this.defaultVertexArrayObject=new WebGLVertexArrayObjectOES(this);this.currentVertexArrayObject=null;this.currentArrayBuffer=null;this.vertexArrayObjects=[this.defaultVertexArrayObject];this.bindVertexArrayOES(null);};OESVertexArrayObject.prototype.createVertexArrayOES=function createVertexArrayOES(){var arrayObject=new WebGLVertexArrayObjectOES(this);this.vertexArrayObjects.push(arrayObject);return arrayObject;};OESVertexArrayObject.prototype.deleteVertexArrayOES=function deleteVertexArrayOES(arrayObject){arrayObject.isAlive=false;this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(arrayObject),1);if(this.currentVertexArrayObject==arrayObject){this.bindVertexArrayOES(null);}};OESVertexArrayObject.prototype.isVertexArrayOES=function isVertexArrayOES(arrayObject){if(arrayObject&&arrayObject instanceof WebGLVertexArrayObjectOES){if(arrayObject.hasBeenBound&&arrayObject.ext==this){return true;}}return false;};OESVertexArrayObject.prototype.bindVertexArrayOES=function bindVertexArrayOES(arrayObject){var gl=this.gl;if(arrayObject&&!arrayObject.isAlive){synthesizeGLError(gl.INVALID_OPERATION,"bindVertexArrayOES: attempt to bind deleted arrayObject");return;}var original=this.original;var oldVAO=this.currentVertexArrayObject;this.currentVertexArrayObject=arrayObject||this.defaultVertexArrayObject;this.currentVertexArrayObject.hasBeenBound=true;var newVAO=this.currentVertexArrayObject;if(oldVAO==newVAO){return;}if(!oldVAO||newVAO.elementArrayBuffer!=oldVAO.elementArrayBuffer){original.bindBuffer.call(gl,gl.ELEMENT_ARRAY_BUFFER,newVAO.elementArrayBuffer);}var currentBinding=this.currentArrayBuffer;var maxAttrib=Math.max(oldVAO?oldVAO.maxAttrib:0,newVAO.maxAttrib);for(var n=0;n<=maxAttrib;n++){var attrib=newVAO.attribs[n];var oldAttrib=oldVAO?oldVAO.attribs[n]:null;if(!oldVAO||attrib.enabled!=oldAttrib.enabled){if(attrib.enabled){original.enableVertexAttribArray.call(gl,n);}else {original.disableVertexAttribArray.call(gl,n);}}if(attrib.enabled){var bufferChanged=false;if(!oldVAO||attrib.buffer!=oldAttrib.buffer){if(currentBinding!=attrib.buffer){original.bindBuffer.call(gl,gl.ARRAY_BUFFER,attrib.buffer);currentBinding=attrib.buffer;}bufferChanged=true;}if(bufferChanged||attrib.cached!=oldAttrib.cached){original.vertexAttribPointer.call(gl,n,attrib.size,attrib.type,attrib.normalized,attrib.stride,attrib.offset);}}}if(this.currentArrayBuffer!=currentBinding){original.bindBuffer.call(gl,gl.ARRAY_BUFFER,this.currentArrayBuffer);}};window._setupVertexArrayObject=function(gl){var original_getSupportedExtensions=gl.getSupportedExtensions;gl.getSupportedExtensions=function getSupportedExtensions(){var list=original_getSupportedExtensions.call(this)||[];if(list.indexOf("OES_vertex_array_object")<0){list.push("OES_vertex_array_object");}return list;};var original_getExtension=gl.getExtension;gl.getExtension=function getExtension(name){var ext=original_getExtension.call(this,name);if(ext){return ext;}if(name!=="OES_vertex_array_object"){return null;}if(!this.__OESVertexArrayObject){console.log("Setup OES_vertex_array_object polyfill");this.__OESVertexArrayObject=new OESVertexArrayObject(this);}return this.__OESVertexArrayObject;};};})();var SystemUtils=/*#__PURE__*/function(){function SystemUtils(){}SystemUtils.supportTextureFormat=function supportTextureFormat(format){switch(format){case exports.TextureFormat.R32G32B32A32:return !LayaGL.layaGPUInstance._oesTextureFloat?false:true;default:return true;}};SystemUtils.supportRenderTextureFormat=function supportRenderTextureFormat(format){switch(format){case exports.RenderTextureFormat.R16G16B16A16:return !!LayaGL.layaGPUInstance._isWebGL2&&!!LayaGL.layaGPUInstance._oesTextureFloat||LayaGL.layaGPUInstance._oesTextureHalfFloat&&LayaGL.layaGPUInstance._oesTextureHalfFloatLinear?true:false;case exports.RenderTextureFormat.Depth:return LayaGL.layaGPUInstance._isWebGL2||LayaGL.layaGPUInstance._webgl_depth_texture?true:false;case exports.RenderTextureFormat.ShadowMap:return LayaGL.layaGPUInstance._isWebGL2?true:false;default:return true;}};_createClass(SystemUtils,null,[{key:"maxTextureCount",get:function get(){return this._maxTextureCount;}},{key:"maxTextureSize",get:function get(){return this._maxTextureSize;}},{key:"shaderCapailityLevel",get:function get(){return this._shaderCapailityLevel;}}]);return SystemUtils;}();var LayaGPU=/*#__PURE__*/function(){function LayaGPU(gl,isWebGL2){this._gl=null;this._vaoExt=null;this._angleInstancedArrays=null;this._isWebGL2=false;this._oesTextureHalfFloat=null;this._oes_element_index_uint=null;this._oesTextureHalfFloatLinear=null;this._oesTextureFloat=null;this._extShaderTextureLod=null;this._extTextureFilterAnisotropic=null;this._compressedTextureS3tc=null;this._compressedTexturePvrtc=null;this._compressedTextureEtc1=null;this._webgl_depth_texture=null;this._gl=gl;this._isWebGL2=isWebGL2;var maxTextureFS=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);var maxTextureSize=gl.getParameter(gl.MAX_TEXTURE_SIZE);if(!isWebGL2){if(!ILaya.Render.isConchApp){if(window._setupVertexArrayObject)window._setupVertexArrayObject(gl);}this._vaoExt=this._getExtension("OES_vertex_array_object");this._angleInstancedArrays=this._getExtension("ANGLE_instanced_arrays");this._oesTextureHalfFloat=this._getExtension("OES_texture_half_float");this._oesTextureHalfFloatLinear=this._getExtension("OES_texture_half_float_linear");this._oesTextureFloat=this._getExtension("OES_texture_float");this._oes_element_index_uint=this._getExtension("OES_element_index_uint");this._extShaderTextureLod=this._getExtension("EXT_shader_texture_lod");this._webgl_depth_texture=this._getExtension("WEBGL_depth_texture");SystemUtils._shaderCapailityLevel=30;}else {this._oesTextureFloat=this._getExtension("EXT_color_buffer_float");SystemUtils._shaderCapailityLevel=35;}this._extTextureFilterAnisotropic=this._getExtension("EXT_texture_filter_anisotropic");this._compressedTextureS3tc=this._getExtension("WEBGL_compressed_texture_s3tc");this._compressedTexturePvrtc=this._getExtension("WEBGL_compressed_texture_pvrtc");this._compressedTextureEtc1=this._getExtension("WEBGL_compressed_texture_etc1");SystemUtils._maxTextureCount=maxTextureFS;SystemUtils._maxTextureSize=maxTextureSize;}var _proto78=LayaGPU.prototype;_proto78._getExtension=function _getExtension(name){var prefixes=LayaGPU._extentionVendorPrefixes;for(var k in prefixes){var ext=this._gl.getExtension(prefixes[k]+name);if(ext)return ext;}return null;};_proto78.createVertexArray=function createVertexArray(){if(this._isWebGL2)return this._gl.createVertexArray();else return this._vaoExt.createVertexArrayOES();};_proto78.bindVertexArray=function bindVertexArray(vertexArray){if(this._isWebGL2)this._gl.bindVertexArray(vertexArray);else this._vaoExt.bindVertexArrayOES(vertexArray);};_proto78.deleteVertexArray=function deleteVertexArray(vertexArray){if(this._isWebGL2)this._gl.deleteVertexArray(vertexArray);else this._vaoExt.deleteVertexArrayOES(vertexArray);};_proto78.isVertexArray=function isVertexArray(vertexArray){if(this._isWebGL2)this._gl.isVertexArray(vertexArray);else this._vaoExt.isVertexArrayOES(vertexArray);};_proto78.drawElementsInstanced=function drawElementsInstanced(mode,count,type,offset,instanceCount){if(this._isWebGL2)this._gl.drawElementsInstanced(mode,count,type,offset,instanceCount);else this._angleInstancedArrays.drawElementsInstancedANGLE(mode,count,type,offset,instanceCount);};_proto78.drawArraysInstanced=function drawArraysInstanced(mode,first,count,instanceCount){if(this._isWebGL2)this._gl.drawArraysInstanced(mode,first,count,instanceCount);else this._angleInstancedArrays.drawArraysInstancedANGLE(mode,first,count,instanceCount);};_proto78.vertexAttribDivisor=function vertexAttribDivisor(index,divisor){if(this._isWebGL2)this._gl.vertexAttribDivisor(index,divisor);else this._angleInstancedArrays.vertexAttribDivisorANGLE(index,divisor);};_proto78.supportInstance=function supportInstance(){if((this._isWebGL2||this._angleInstancedArrays)&&Config.allowGPUInstanceDynamicBatch)return true;else return false;};_proto78.supportElementIndexUint32=function supportElementIndexUint32(){return this._isWebGL2||this._oes_element_index_uint?true:false;};return LayaGPU;}();LayaGPU._extentionVendorPrefixes=["","WEBKIT_","MOZ_"];var Render=/*#__PURE__*/function(){function Render(width,height,mainCanv){this._timeId=0;Render._mainCanvas=mainCanv;var source=Render._mainCanvas.source;source.id="layaCanvas";source.width=width;source.height=height;if(Render.isConchApp){document.body.appendChild(source);}this.initRender(Render._mainCanvas,width,height);window.requestAnimationFrame(loop);function loop(stamp){ILaya.stage._loop();window.requestAnimationFrame(loop);}ILaya.stage.on("visibilitychange",this,this._onVisibilitychange);}var _proto79=Render.prototype;_proto79._onVisibilitychange=function _onVisibilitychange(){if(!ILaya.stage.isVisibility){this._timeId=window.setInterval(this._enterFrame,1000);}else if(this._timeId!=0){window.clearInterval(this._timeId);}};_proto79.initRender=function initRender(canvas,w,h){function getWebGLContext(canvas){var gl;var names=["webgl2","webgl","experimental-webgl","webkit-3d","moz-webgl"];if(!Config.useWebGL2||Browser.onBDMiniGame){names.shift();}for(var i=0;i<names.length;i++){try{gl=canvas.getContext(names[i],{stencil:Config.isStencil,alpha:Config.isAlpha,antialias:Config.isAntialias,premultipliedAlpha:Config.premultipliedAlpha,preserveDrawingBuffer:Config.preserveDrawingBuffer});}catch(e){}if(gl){names[i]==='webgl2'&&(WebGL._isWebGL2=true);return gl;}}return null;}var gl=LayaGL.instance=WebGLContext.mainContext=getWebGLContext(Render._mainCanvas.source);if(!gl)return false;LayaGL.instance=gl;LayaGL.layaGPUInstance=new LayaGPU(gl,WebGL._isWebGL2);canvas.size(w,h);Context.__init__();SubmitBase.__init__();var ctx=new Context();ctx.isMain=true;Render._context=ctx;canvas._setContext(ctx);ShaderDefines2D.__init__();Value2D.__init__();Shader2D.__init__();Buffer2D.__int__(gl);BlendMode._init_(gl);return true;};_proto79._enterFrame=function _enterFrame(e){ILaya.stage._loop();};_createClass(Render,null,[{key:"context",get:function get(){return Render._context;}},{key:"canvas",get:function get(){return Render._mainCanvas.source;}}]);return Render;}();Render.supportWebGLPlusCulling=false;Render.supportWebGLPlusAnimation=false;Render.supportWebGLPlusRendering=false;Render.isConchApp=false;{Render.isConchApp=window.conch!=null;if(Render.isConchApp){Render.supportWebGLPlusCulling=false;Render.supportWebGLPlusAnimation=false;Render.supportWebGLPlusRendering=false;}else if(window.qq!=null&&window.qq.webglPlus!=null){Render.supportWebGLPlusCulling=false;Render.supportWebGLPlusAnimation=false;Render.supportWebGLPlusRendering=false;}}var DrawTrianglesCmd=/*#__PURE__*/function(){function DrawTrianglesCmd(){}DrawTrianglesCmd.create=function create(texture,x,y,vertices,uvs,indices,matrix,alpha,color,blendMode,colorNum){var cmd=Pool.getItemByClass("DrawTrianglesCmd",DrawTrianglesCmd);cmd.texture=texture;cmd.x=x;cmd.y=y;cmd.vertices=vertices;cmd.uvs=uvs;cmd.indices=indices;cmd.matrix=matrix;cmd.alpha=alpha;if(color){cmd.color=new ColorFilter();var c=ColorUtils.create(color).arrColor;cmd.color.color(c[0]*255,c[1]*255,c[2]*255,c[3]*255);}cmd.blendMode=blendMode;cmd.colorNum=colorNum;return cmd;};var _proto80=DrawTrianglesCmd.prototype;_proto80.recover=function recover(){this.texture=null;this.vertices=null;this.uvs=null;this.indices=null;this.matrix=null;Pool.recover("DrawTrianglesCmd",this);};_proto80.run=function run(context,gx,gy){context.drawTriangles(this.texture,this.x+gx,this.y+gy,this.vertices,this.uvs,this.indices,this.matrix,this.alpha,this.color,this.blendMode,this.colorNum);};_createClass(DrawTrianglesCmd,[{key:"cmdID",get:function get(){return DrawTrianglesCmd.ID;}}]);return DrawTrianglesCmd;}();DrawTrianglesCmd.ID="DrawTriangles";var Draw9GridTexture=/*#__PURE__*/function(){function Draw9GridTexture(){}Draw9GridTexture.create=function create(texture,x,y,width,height,sizeGrid){var cmd=Pool.getItemByClass("Draw9GridTexture",Draw9GridTexture);cmd.texture=texture;texture._addReference();cmd.x=x;cmd.y=y;cmd.width=width;cmd.height=height;cmd.sizeGrid=sizeGrid;return cmd;};var _proto81=Draw9GridTexture.prototype;_proto81.recover=function recover(){this.texture._removeReference();Pool.recover("Draw9GridTexture",this);};_proto81.run=function run(context,gx,gy){context.drawTextureWithSizeGrid(this.texture,this.x,this.y,this.width,this.height,this.sizeGrid,gx,gy);};_createClass(Draw9GridTexture,[{key:"cmdID",get:function get(){return Draw9GridTexture.ID;}}]);return Draw9GridTexture;}();Draw9GridTexture.ID="Draw9GridTexture";var SaveCmd=/*#__PURE__*/function(){function SaveCmd(){}SaveCmd.create=function create(){var cmd=Pool.getItemByClass("SaveCmd",SaveCmd);return cmd;};var _proto82=SaveCmd.prototype;_proto82.recover=function recover(){Pool.recover("SaveCmd",this);};_proto82.run=function run(context,gx,gy){context.save();};_createClass(SaveCmd,[{key:"cmdID",get:function get(){return SaveCmd.ID;}}]);return SaveCmd;}();SaveCmd.ID="Save";var GraphicsBounds=/*#__PURE__*/function(){function GraphicsBounds(){this._cacheBoundsType=false;}var _proto83=GraphicsBounds.prototype;_proto83.destroy=function destroy(){this._graphics=null;this._cacheBoundsType=false;if(this._temp)this._temp.length=0;if(this._rstBoundPoints)this._rstBoundPoints.length=0;if(this._bounds)this._bounds.recover();this._bounds=null;Pool.recover("GraphicsBounds",this);};GraphicsBounds.create=function create(){return Pool.getItemByClass("GraphicsBounds",GraphicsBounds);};_proto83.reset=function reset(){this._temp&&(this._temp.length=0);};_proto83.getBounds=function getBounds(realSize){if(realSize===void 0){realSize=false;}if(!this._bounds||!this._temp||this._temp.length<1||realSize!=this._cacheBoundsType){this._bounds=Rectangle._getWrapRec(this.getBoundPoints(realSize),this._bounds);}this._cacheBoundsType=realSize;return this._bounds;};_proto83.getBoundPoints=function getBoundPoints(realSize){if(realSize===void 0){realSize=false;}if(!this._temp||this._temp.length<1||realSize!=this._cacheBoundsType)this._temp=this._getCmdPoints(realSize);this._cacheBoundsType=realSize;return this._rstBoundPoints=Utils.copyArray(this._rstBoundPoints,this._temp);};_proto83._getCmdPoints=function _getCmdPoints(realSize){if(realSize===void 0){realSize=false;}var cmds=this._graphics.cmds;var rst;rst=this._temp||(this._temp=[]);rst.length=0;if(!cmds&&this._graphics._one!=null){GraphicsBounds._tempCmds.length=0;GraphicsBounds._tempCmds.push(this._graphics._one);cmds=GraphicsBounds._tempCmds;}if(!cmds)return rst;var matrixs=GraphicsBounds._tempMatrixArrays;matrixs.length=0;var tMatrix=GraphicsBounds._initMatrix;tMatrix.identity();var tempMatrix=GraphicsBounds._tempMatrix;var cmd;var tex;for(var i=0,n=cmds.length;i<n;i++){cmd=cmds[i];switch(cmd.cmdID){case AlphaCmd.ID:case SaveCmd.ID:matrixs.push(tMatrix);tMatrix=tMatrix.clone();break;case RestoreCmd.ID:tMatrix=matrixs.pop();break;case ScaleCmd.ID:tempMatrix.identity();tempMatrix.translate(-cmd.pivotX,-cmd.pivotY);tempMatrix.scale(cmd.scaleX,cmd.scaleY);tempMatrix.translate(cmd.pivotX,cmd.pivotY);this._switchMatrix(tMatrix,tempMatrix);break;case RotateCmd.ID:tempMatrix.identity();tempMatrix.translate(-cmd.pivotX,-cmd.pivotY);tempMatrix.rotate(cmd.angle);tempMatrix.translate(cmd.pivotX,cmd.pivotY);this._switchMatrix(tMatrix,tempMatrix);break;case TranslateCmd.ID:tempMatrix.identity();tempMatrix.translate(cmd.tx,cmd.ty);this._switchMatrix(tMatrix,tempMatrix);break;case TransformCmd.ID:tempMatrix.identity();tempMatrix.translate(-cmd.pivotX,-cmd.pivotY);tempMatrix.concat(cmd.matrix);tempMatrix.translate(cmd.pivotX,cmd.pivotY);this._switchMatrix(tMatrix,tempMatrix);break;case DrawImageCmd.ID:case FillTextureCmd.ID:GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd.x,cmd.y,cmd.width,cmd.height),tMatrix);break;case DrawTextureCmd.ID:tMatrix.copyTo(tempMatrix);if(cmd.matrix)tempMatrix.concat(cmd.matrix);GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd.x,cmd.y,cmd.width,cmd.height),tempMatrix);break;case DrawImageCmd.ID:tex=cmd.texture;if(realSize){if(cmd.width&&cmd.height){GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd.x,cmd.y,cmd.width,cmd.height),tMatrix);}else {GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd.x,cmd.y,tex.width,tex.height),tMatrix);}}else {var wRate=(cmd.width||tex.sourceWidth)/tex.width;var hRate=(cmd.height||tex.sourceHeight)/tex.height;var oWidth=wRate*tex.sourceWidth;var oHeight=hRate*tex.sourceHeight;var offX=tex.offsetX>0?tex.offsetX:0;var offY=tex.offsetY>0?tex.offsetY:0;offX*=wRate;offY*=hRate;GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd.x-offX,cmd.y-offY,oWidth,oHeight),tMatrix);}break;case FillTextureCmd.ID:if(cmd.width&&cmd.height){GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd.x,cmd.y,cmd.width,cmd.height),tMatrix);}else {tex=cmd.texture;GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd.x,cmd.y,tex.width,tex.height),tMatrix);}break;case DrawTextureCmd.ID:var drawMatrix;if(cmd.matrix){tMatrix.copyTo(tempMatrix);tempMatrix.concat(cmd.matrix);drawMatrix=tempMatrix;}else {drawMatrix=tMatrix;}if(realSize){if(cmd.width&&cmd.height){GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd.x,cmd.y,cmd.width,cmd.height),drawMatrix);}else {tex=cmd.texture;GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd.x,cmd.y,tex.width,tex.height),drawMatrix);}}else {tex=cmd.texture;wRate=(cmd.width||tex.sourceWidth)/tex.width;hRate=(cmd.height||tex.sourceHeight)/tex.height;oWidth=wRate*tex.sourceWidth;oHeight=hRate*tex.sourceHeight;offX=tex.offsetX>0?tex.offsetX:0;offY=tex.offsetY>0?tex.offsetY:0;offX*=wRate;offY*=hRate;GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd.x-offX,cmd.y-offY,oWidth,oHeight),drawMatrix);}break;case DrawRectCmd.ID:GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd.x,cmd.y,cmd.width,cmd.height),tMatrix);break;case DrawCircleCmd.ID:GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd.x-cmd.radius,cmd.y-cmd.radius,cmd.radius+cmd.radius,cmd.radius+cmd.radius),tMatrix);break;case DrawLineCmd.ID:GraphicsBounds._tempPoints.length=0;var lineWidth;lineWidth=cmd.lineWidth*0.5;if(cmd.fromX==cmd.toX){GraphicsBounds._tempPoints.push(cmd.fromX+lineWidth,cmd.fromY,cmd.toX+lineWidth,cmd.toY,cmd.fromX-lineWidth,cmd.fromY,cmd.toX-lineWidth,cmd.toY);}else if(cmd.fromY==cmd.toY){GraphicsBounds._tempPoints.push(cmd.fromX,cmd.fromY+lineWidth,cmd.toX,cmd.toY+lineWidth,cmd.fromX,cmd.fromY-lineWidth,cmd.toX,cmd.toY-lineWidth);}else {GraphicsBounds._tempPoints.push(cmd.fromX,cmd.fromY,cmd.toX,cmd.toY);}GraphicsBounds._addPointArrToRst(rst,GraphicsBounds._tempPoints,tMatrix);break;case DrawCurvesCmd.ID:GraphicsBounds._addPointArrToRst(rst,Bezier.I.getBezierPoints(cmd.points),tMatrix,cmd.x,cmd.y);break;case DrawLinesCmd.ID:case DrawPolyCmd.ID:GraphicsBounds._addPointArrToRst(rst,cmd.points,tMatrix,cmd.x,cmd.y);break;case DrawPathCmd.ID:GraphicsBounds._addPointArrToRst(rst,this._getPathPoints(cmd.paths),tMatrix,cmd.x,cmd.y);break;case DrawPieCmd.ID:GraphicsBounds._addPointArrToRst(rst,this._getPiePoints(cmd.x,cmd.y,cmd.radius,cmd.startAngle,cmd.endAngle),tMatrix);break;case DrawTrianglesCmd.ID:GraphicsBounds._addPointArrToRst(rst,this._getTriAngBBXPoints(cmd.vertices),tMatrix);break;case Draw9GridTexture.ID:GraphicsBounds._addPointArrToRst(rst,this._getDraw9GridBBXPoints(cmd),tMatrix);break;}}if(rst.length>200){rst=Utils.copyArray(rst,Rectangle._getWrapRec(rst)._getBoundPoints());}else if(rst.length>8)rst=GrahamScan.scanPList(rst);return rst;};_proto83._switchMatrix=function _switchMatrix(tMatix,tempMatrix){tempMatrix.concat(tMatix);tempMatrix.copyTo(tMatix);};GraphicsBounds._addPointArrToRst=function _addPointArrToRst(rst,points,matrix,dx,dy){if(dx===void 0){dx=0;}if(dy===void 0){dy=0;}var i,len;len=points.length;for(i=0;i<len;i+=2){GraphicsBounds._addPointToRst(rst,points[i]+dx,points[i+1]+dy,matrix);}};GraphicsBounds._addPointToRst=function _addPointToRst(rst,x,y,matrix){var _tempPoint=Point.TEMP;_tempPoint.setTo(x?x:0,y?y:0);matrix.transformPoint(_tempPoint);rst.push(_tempPoint.x,_tempPoint.y);};_proto83._getPiePoints=function _getPiePoints(x,y,radius,startAngle,endAngle){var rst=GraphicsBounds._tempPoints;GraphicsBounds._tempPoints.length=0;var k=Math.PI/180;var d1=endAngle-startAngle;if(d1>=360||d1<=-360){rst.push(x-radius,y-radius);rst.push(x+radius,y-radius);rst.push(x+radius,y+radius);rst.push(x-radius,y+radius);return rst;}rst.push(x,y);var delta=d1%360;if(delta<0)delta+=360;var end1=startAngle+delta;var st=startAngle*k;var ed=end1*k;rst.push(x+radius*Math.cos(st),y+radius*Math.sin(st));rst.push(x+radius*Math.cos(ed),y+radius*Math.sin(ed));var s1=Math.ceil(startAngle/90)*90;var s2=Math.floor(end1/90)*90;for(var cs=s1;cs<=s2;cs+=90){var csr=cs*k;rst.push(x+radius*Math.cos(csr),y+radius*Math.sin(csr));}return rst;};_proto83._getTriAngBBXPoints=function _getTriAngBBXPoints(vert){var vnum=vert.length;if(vnum<2)return [];var minx=vert[0];var miny=vert[1];var maxx=minx;var maxy=miny;for(var i=2;i<vnum;){var cx=vert[i++];var cy=vert[i++];if(minx>cx)minx=cx;if(miny>cy)miny=cy;if(maxx<cx)maxx=cx;if(maxy<cy)maxy=cy;}return [minx,miny,maxx,miny,maxx,maxy,minx,maxy];};_proto83._getDraw9GridBBXPoints=function _getDraw9GridBBXPoints(cmd){var minx=0;var miny=0;var maxx=cmd.width;var maxy=cmd.height;return [minx,miny,maxx,miny,maxx,maxy,minx,maxy];};_proto83._getPathPoints=function _getPathPoints(paths){var i,len;var rst=GraphicsBounds._tempPoints;rst.length=0;len=paths.length;var tCMD;for(i=0;i<len;i++){tCMD=paths[i];if(tCMD.length>1){rst.push(tCMD[1],tCMD[2]);if(tCMD.length>3){rst.push(tCMD[3],tCMD[4]);}}}return rst;};return GraphicsBounds;}();GraphicsBounds._tempMatrix=new Matrix();GraphicsBounds._initMatrix=new Matrix();GraphicsBounds._tempPoints=[];GraphicsBounds._tempMatrixArrays=[];GraphicsBounds._tempCmds=[];var SpriteConst=function SpriteConst(){};SpriteConst.ALPHA=0x01;SpriteConst.TRANSFORM=0x02;SpriteConst.BLEND=0x04;SpriteConst.CANVAS=0x08;SpriteConst.FILTERS=0x10;SpriteConst.MASK=0x20;SpriteConst.CLIP=0x40;SpriteConst.STYLE=0x80;SpriteConst.TEXTURE=0x100;SpriteConst.GRAPHICS=0x200;SpriteConst.LAYAGL3D=0x400;SpriteConst.CUSTOM=0x800;SpriteConst.ONECHILD=0x1000;SpriteConst.CHILDS=0x2000;SpriteConst.REPAINT_NONE=0;SpriteConst.REPAINT_NODE=0x01;SpriteConst.REPAINT_CACHE=0x02;SpriteConst.REPAINT_ALL=0x03;var ClipRectCmd=/*#__PURE__*/function(){function ClipRectCmd(){}ClipRectCmd.create=function create(x,y,width,height){var cmd=Pool.getItemByClass("ClipRectCmd",ClipRectCmd);cmd.x=x;cmd.y=y;cmd.width=width;cmd.height=height;return cmd;};var _proto84=ClipRectCmd.prototype;_proto84.recover=function recover(){Pool.recover("ClipRectCmd",this);};_proto84.run=function run(context,gx,gy){context.clipRect(this.x+gx,this.y+gy,this.width,this.height);};_createClass(ClipRectCmd,[{key:"cmdID",get:function get(){return ClipRectCmd.ID;}}]);return ClipRectCmd;}();ClipRectCmd.ID="ClipRect";var DrawTexturesCmd=/*#__PURE__*/function(){function DrawTexturesCmd(){}DrawTexturesCmd.create=function create(texture,pos){var cmd=Pool.getItemByClass("DrawTexturesCmd",DrawTexturesCmd);cmd.texture=texture;texture._addReference();cmd.pos=pos;return cmd;};var _proto85=DrawTexturesCmd.prototype;_proto85.recover=function recover(){this.texture._removeReference();this.texture=null;this.pos=null;Pool.recover("DrawTexturesCmd",this);};_proto85.run=function run(context,gx,gy){context.drawTextures(this.texture,this.pos,gx,gy);};_createClass(DrawTexturesCmd,[{key:"cmdID",get:function get(){return DrawTexturesCmd.ID;}}]);return DrawTexturesCmd;}();DrawTexturesCmd.ID="DrawTextures";var FillTextCmd=/*#__PURE__*/function(){function FillTextCmd(){this._textIsWorldText=false;this._fontColor=0xffffffff;this._strokeColor=0;this._fontObj=FillTextCmd._defFontObj;this._nTexAlign=0;}FillTextCmd.create=function create(text,words,x,y,font,color,textAlign,lineWidth,borderColor){var cmd=Pool.getItemByClass("FillTextCmd",FillTextCmd);cmd.text=text;cmd._textIsWorldText=text instanceof WordText;cmd._words=words;cmd.x=x;cmd.y=y;cmd.font=font;cmd.color=color;cmd.textAlign=textAlign;cmd._lineWidth=lineWidth;cmd._borderColor=borderColor;return cmd;};var _proto86=FillTextCmd.prototype;_proto86.recover=function recover(){Pool.recover("FillTextCmd",this);};_proto86.run=function run(context,gx,gy){if(ILaya.stage.isGlobalRepaint()){this._textIsWorldText&&this._text.cleanCache();}if(this._words){Context._textRender.fillWords(context,this._words,this.x+gx,this.y+gy,this._fontObj,this._color,this._borderColor,this._lineWidth);}else {if(this._textIsWorldText){context._fast_filltext(this._text,this.x+gx,this.y+gy,this._fontObj,this._color,this._borderColor,this._lineWidth,this._nTexAlign,0);}else {Context._textRender.filltext(context,this._text,this.x+gx,this.y+gy,this.font,this.color,this._borderColor,this._lineWidth,this._textAlign);}}};_createClass(FillTextCmd,[{key:"cmdID",get:function get(){return FillTextCmd.ID;}},{key:"text",get:function get(){return this._text;},set:function set(value){this._text=value;this._textIsWorldText=value instanceof WordText;this._textIsWorldText&&this._text.cleanCache();}},{key:"font",get:function get(){return this._font;},set:function set(value){this._font=value;this._fontObj=FontInfo.Parse(value);this._textIsWorldText&&this._text.cleanCache();}},{key:"color",get:function get(){return this._color;},set:function set(value){this._color=value;this._fontColor=ColorUtils.create(value).numColor;this._textIsWorldText&&this._text.cleanCache();}},{key:"textAlign",get:function get(){return this._textAlign;},set:function set(value){this._textAlign=value;switch(value){case'center':this._nTexAlign=ILaya.Context.ENUM_TEXTALIGN_CENTER;break;case'right':this._nTexAlign=ILaya.Context.ENUM_TEXTALIGN_RIGHT;break;default:this._nTexAlign=ILaya.Context.ENUM_TEXTALIGN_DEFAULT;}this._textIsWorldText&&this._text.cleanCache();}}]);return FillTextCmd;}();FillTextCmd.ID="FillText";FillTextCmd._defFontObj=new FontInfo(null);var CacheManger=/*#__PURE__*/function(){function CacheManger(){}CacheManger.regCacheByFunction=function regCacheByFunction(disposeFunction,getCacheListFunction){CacheManger.unRegCacheByFunction(disposeFunction,getCacheListFunction);var cache;cache={tryDispose:disposeFunction,getCacheList:getCacheListFunction};CacheManger._cacheList.push(cache);};CacheManger.unRegCacheByFunction=function unRegCacheByFunction(disposeFunction,getCacheListFunction){var i,len;len=CacheManger._cacheList.length;for(i=0;i<len;i++){if(CacheManger._cacheList[i].tryDispose==disposeFunction&&CacheManger._cacheList[i].getCacheList==getCacheListFunction){CacheManger._cacheList.splice(i,1);return;}}};CacheManger.forceDispose=function forceDispose(){var i,len=CacheManger._cacheList.length;for(i=0;i<len;i++){CacheManger._cacheList[i].tryDispose(true);}};CacheManger.beginCheck=function beginCheck(waitTime){if(waitTime===void 0){waitTime=15000;}ILaya.systemTimer.loop(waitTime,null,CacheManger._checkLoop);};CacheManger.stopCheck=function stopCheck(){ILaya.systemTimer.clear(null,CacheManger._checkLoop);};CacheManger._checkLoop=function _checkLoop(){var cacheList=CacheManger._cacheList;if(cacheList.length<1)return;var tTime=ILaya.Browser.now();var count;var len;len=count=cacheList.length;while(count>0){CacheManger._index++;CacheManger._index=CacheManger._index%len;cacheList[CacheManger._index].tryDispose(false);if(ILaya.Browser.now()-tTime>CacheManger.loopTimeLimit)break;count--;}};return CacheManger;}();CacheManger.loopTimeLimit=2;CacheManger._cacheList=[];CacheManger._index=0;var VectorGraphManager=/*#__PURE__*/function(){function VectorGraphManager(){this.useDic={};this.shapeDic={};this.shapeLineDic={};this._id=0;this._checkKey=false;this._freeIdArray=[];CacheManger.regCacheByFunction(this.startDispose.bind(this),this.getCacheList.bind(this));}VectorGraphManager.getInstance=function getInstance(){return VectorGraphManager.instance=VectorGraphManager.instance||new VectorGraphManager();};var _proto87=VectorGraphManager.prototype;_proto87.getId=function getId(){return this._id++;};_proto87.addShape=function addShape(id,shape){this.shapeDic[id]=shape;if(!this.useDic[id]){this.useDic[id]=true;}};_proto87.addLine=function addLine(id,Line){this.shapeLineDic[id]=Line;if(!this.shapeLineDic[id]){this.shapeLineDic[id]=true;}};_proto87.getShape=function getShape(id){if(this._checkKey){if(this.useDic[id]!=null){this.useDic[id]=true;}}};_proto87.deleteShape=function deleteShape(id){if(this.shapeDic[id]){this.shapeDic[id]=null;delete this.shapeDic[id];}if(this.shapeLineDic[id]){this.shapeLineDic[id]=null;delete this.shapeLineDic[id];}if(this.useDic[id]!=null){delete this.useDic[id];}};_proto87.getCacheList=function getCacheList(){var str;var list=[];for(str in this.shapeDic){list.push(this.shapeDic[str]);}for(str in this.shapeLineDic){list.push(this.shapeLineDic[str]);}return list;};_proto87.startDispose=function startDispose(key){var str;for(str in this.useDic){this.useDic[str]=false;}this._checkKey=true;};_proto87.endDispose=function endDispose(){if(this._checkKey){var str;for(str in this.useDic){if(!this.useDic[str]){this.deleteShape(str);}}this._checkKey=false;}};return VectorGraphManager;}();var Graphics=/*#__PURE__*/function(){function Graphics(){this._sp=null;this._one=null;this._render=this._renderEmpty;this._cmds=null;this._vectorgraphArray=null;this._graphicBounds=null;this.autoDestroy=false;this._createData();}var _proto88=Graphics.prototype;_proto88._createData=function _createData(){};_proto88._clearData=function _clearData(){};_proto88._destroyData=function _destroyData(){};_proto88.destroy=function destroy(){this.clear(true);if(this._graphicBounds)this._graphicBounds.destroy();this._graphicBounds=null;this._vectorgraphArray=null;if(this._sp){this._sp._renderType=0;this._sp._setRenderType(0);this._sp=null;}this._destroyData();};_proto88.clear=function clear(recoverCmds){if(recoverCmds===void 0){recoverCmds=true;}if(recoverCmds){var tCmd=this._one;if(this._cmds){var i,len=this._cmds.length;for(i=0;i<len;i++){tCmd=this._cmds[i];tCmd.recover();}this._cmds.length=0;}else if(tCmd){tCmd.recover();}}else {this._cmds=null;}this._one=null;this._render=this._renderEmpty;this._clearData();if(this._sp){this._sp._renderType&=~SpriteConst.GRAPHICS;this._sp._setRenderType(this._sp._renderType);}this._repaint();if(this._vectorgraphArray){for(i=0,len=this._vectorgraphArray.length;i<len;i++){VectorGraphManager.getInstance().deleteShape(this._vectorgraphArray[i]);}this._vectorgraphArray.length=0;}};_proto88._clearBoundsCache=function _clearBoundsCache(){if(this._graphicBounds)this._graphicBounds.reset();};_proto88._initGraphicBounds=function _initGraphicBounds(){if(!this._graphicBounds){this._graphicBounds=GraphicsBounds.create();this._graphicBounds._graphics=this;}};_proto88._repaint=function _repaint(){this._clearBoundsCache();this._sp&&this._sp.repaint();};_proto88._isOnlyOne=function _isOnlyOne(){return !this._cmds||this._cmds.length===0;};_proto88.getBounds=function getBounds(realSize){if(realSize===void 0){realSize=false;}this._initGraphicBounds();return this._graphicBounds.getBounds(realSize);};_proto88.getBoundPoints=function getBoundPoints(realSize){if(realSize===void 0){realSize=false;}this._initGraphicBounds();return this._graphicBounds.getBoundPoints(realSize);};_proto88.drawImage=function drawImage(texture,x,y,width,height){if(x===void 0){x=0;}if(y===void 0){y=0;}if(width===void 0){width=0;}if(height===void 0){height=0;}if(!texture)return null;if(!width)width=texture.sourceWidth;if(!height)height=texture.sourceHeight;if(texture.getIsReady()){var wRate=width/texture.sourceWidth;var hRate=height/texture.sourceHeight;width=texture.width*wRate;height=texture.height*hRate;if(width<=0||height<=0)return null;x+=texture.offsetX*wRate;y+=texture.offsetY*hRate;}if(this._sp){this._sp._renderType|=SpriteConst.GRAPHICS;this._sp._setRenderType(this._sp._renderType);}var args=DrawImageCmd.create.call(this,texture,x,y,width,height);if(this._one==null){this._one=args;this._render=this._renderOneImg;}else {this._saveToCmd(null,args);}this._repaint();return args;};_proto88.drawTexture=function drawTexture(texture,x,y,width,height,matrix,alpha,color,blendMode,uv){if(x===void 0){x=0;}if(y===void 0){y=0;}if(width===void 0){width=0;}if(height===void 0){height=0;}if(matrix===void 0){matrix=null;}if(alpha===void 0){alpha=1;}if(color===void 0){color=null;}if(blendMode===void 0){blendMode=null;}if(!texture||alpha<0.01)return null;if(!texture.getIsReady())return null;if(!width)width=texture.sourceWidth;if(!height)height=texture.sourceHeight;if(texture.getIsReady()){var wRate=width/texture.sourceWidth;var hRate=height/texture.sourceHeight;width=texture.width*wRate;height=texture.height*hRate;if(width<=0||height<=0)return null;x+=texture.offsetX*wRate;y+=texture.offsetY*hRate;}if(this._sp){this._sp._renderType|=SpriteConst.GRAPHICS;this._sp._setRenderType(this._sp._renderType);}var args=DrawTextureCmd.create.call(this,texture,x,y,width,height,matrix,alpha,color,blendMode,uv);this._repaint();return this._saveToCmd(null,args);};_proto88.drawTextures=function drawTextures(texture,pos){if(!texture)return null;return this._saveToCmd(Render._context.drawTextures,DrawTexturesCmd.create.call(this,texture,pos));};_proto88.drawTriangles=function drawTriangles(texture,x,y,vertices,uvs,indices,matrix,alpha,color,blendMode,colorNum){if(matrix===void 0){matrix=null;}if(alpha===void 0){alpha=1;}if(color===void 0){color=null;}if(blendMode===void 0){blendMode=null;}if(colorNum===void 0){colorNum=undefined;}return this._saveToCmd(Render._context.drawTriangles,DrawTrianglesCmd.create.call(this,texture,x,y,vertices,uvs,indices,matrix,alpha,color,blendMode,colorNum));};_proto88.fillTexture=function fillTexture(texture,x,y,width,height,type,offset){if(width===void 0){width=0;}if(height===void 0){height=0;}if(type===void 0){type="repeat";}if(offset===void 0){offset=null;}if(texture&&texture.getIsReady())return this._saveToCmd(Render._context._fillTexture,FillTextureCmd.create.call(this,texture,x,y,width,height,type,offset||Point.EMPTY,{}));else return null;};_proto88._saveToCmd=function _saveToCmd(fun,args){if(this._sp){this._sp._renderType|=SpriteConst.GRAPHICS;this._sp._setRenderType(this._sp._renderType);}if(this._one==null){this._one=args;this._render=this._renderOne;}else {this._render=this._renderAll;(this._cmds||(this._cmds=[])).length===0&&this._cmds.push(this._one);this._cmds.push(args);}this._repaint();return args;};_proto88.clipRect=function clipRect(x,y,width,height){return this._saveToCmd(Render._context.clipRect,ClipRectCmd.create.call(this,x,y,width,height));};_proto88.fillText=function fillText(text,x,y,font,color,textAlign){return this._saveToCmd(Render._context.fillText,FillTextCmd.create.call(this,text,null,x,y,font||ILaya.Text.defaultFontStr(),color,textAlign,0,""));};_proto88.fillBorderText=function fillBorderText(text,x,y,font,fillColor,textAlign,lineWidth,borderColor){return this._saveToCmd(Render._context.fillText,FillTextCmd.create.call(this,text,null,x,y,font||ILaya.Text.defaultFontStr(),fillColor,textAlign,lineWidth,borderColor));};_proto88.fillWords=function fillWords(words,x,y,font,color){return this._saveToCmd(Render._context.fillText,FillTextCmd.create.call(this,null,words,x,y,font||ILaya.Text.defaultFontStr(),color));};_proto88.fillBorderWords=function fillBorderWords(words,x,y,font,fillColor,borderColor,lineWidth){return this._saveToCmd(Render._context.fillText,FillTextCmd.create.call(this,null,words,x,y,font||ILaya.Text.defaultFontStr(),fillColor,"",lineWidth,borderColor));};_proto88.strokeText=function strokeText(text,x,y,font,color,lineWidth,textAlign){return this._saveToCmd(Render._context.fillText,FillTextCmd.create.call(this,text,null,x,y,font||ILaya.Text.defaultFontStr(),null,textAlign,lineWidth,color));};_proto88.alpha=function alpha(_alpha){return this._saveToCmd(Render._context.alpha,AlphaCmd.create.call(this,_alpha));};_proto88.transform=function transform(matrix,pivotX,pivotY){if(pivotX===void 0){pivotX=0;}if(pivotY===void 0){pivotY=0;}return this._saveToCmd(Render._context._transform,TransformCmd.create.call(this,matrix,pivotX,pivotY));};_proto88.rotate=function rotate(angle,pivotX,pivotY){if(pivotX===void 0){pivotX=0;}if(pivotY===void 0){pivotY=0;}return this._saveToCmd(Render._context._rotate,RotateCmd.create.call(this,angle,pivotX,pivotY));};_proto88.scale=function scale(scaleX,scaleY,pivotX,pivotY){if(pivotX===void 0){pivotX=0;}if(pivotY===void 0){pivotY=0;}return this._saveToCmd(Render._context._scale,ScaleCmd.create.call(this,scaleX,scaleY,pivotX,pivotY));};_proto88.translate=function translate(tx,ty){return this._saveToCmd(Render._context.translate,TranslateCmd.create.call(this,tx,ty));};_proto88.save=function save(){return this._saveToCmd(Render._context._save,SaveCmd.create.call(this));};_proto88.restore=function restore(){return this._saveToCmd(Render._context.restore,RestoreCmd.create.call(this));};_proto88.replaceText=function replaceText(text){this._repaint();var cmds=this._cmds;if(!cmds){if(this._one&&this._isTextCmd(this._one)){this._one.text=text;return true;}}else {for(var i=cmds.length-1;i>-1;i--){if(this._isTextCmd(cmds[i])){cmds[i].text=text;return true;}}}return false;};_proto88._isTextCmd=function _isTextCmd(cmd){var cmdID=cmd.cmdID;return cmdID==FillTextCmd.ID;};_proto88.replaceTextColor=function replaceTextColor(color){this._repaint();var cmds=this._cmds;if(!cmds){if(this._one&&this._isTextCmd(this._one)){this._setTextCmdColor(this._one,color);}}else {for(var i=cmds.length-1;i>-1;i--){if(this._isTextCmd(cmds[i])){this._setTextCmdColor(cmds[i],color);}}}};_proto88._setTextCmdColor=function _setTextCmdColor(cmdO,color){var cmdID=cmdO.cmdID;switch(cmdID){case FillTextCmd.ID:cmdO.color=color;break;}};_proto88.loadImage=function loadImage(url,x,y,width,height,complete){if(x===void 0){x=0;}if(y===void 0){y=0;}if(width===void 0){width=0;}if(height===void 0){height=0;}if(complete===void 0){complete=null;}var tex=ILaya.Loader.getRes(url);if(!tex){tex=new Texture();tex.load(url);ILaya.Loader.cacheTexture(url,tex);tex.once(Event.READY,this,this.drawImage,[tex,x,y,width,height]);}else {if(!tex.getIsReady()){tex.once(Event.READY,this,this.drawImage,[tex,x,y,width,height]);}else this.drawImage(tex,x,y,width,height);}if(complete!=null){tex.getIsReady()?complete.call(this._sp):tex.on(Event.READY,this._sp,complete);}};_proto88._renderEmpty=function _renderEmpty(sprite,context,x,y){};_proto88._renderAll=function _renderAll(sprite,context,x,y){var cmds=this._cmds;for(var i=0,n=cmds.length;i<n;i++){cmds[i].run(context,x,y);}};_proto88._renderOne=function _renderOne(sprite,context,x,y){context.sprite=sprite;this._one.run(context,x,y);};_proto88._renderOneImg=function _renderOneImg(sprite,context,x,y){context.sprite=sprite;this._one.run(context,x,y);};_proto88.drawLine=function drawLine(fromX,fromY,toX,toY,lineColor,lineWidth){if(lineWidth===void 0){lineWidth=1;}var offset=lineWidth<1||lineWidth%2===0?0:0.5;return this._saveToCmd(Render._context._drawLine,DrawLineCmd.create.call(this,fromX+offset,fromY+offset,toX+offset,toY+offset,lineColor,lineWidth,0));};_proto88.drawLines=function drawLines(x,y,points,lineColor,lineWidth){if(lineWidth===void 0){lineWidth=1;}if(!points||points.length<4)return null;var offset=lineWidth<1||lineWidth%2===0?0:0.5;return this._saveToCmd(Render._context._drawLines,DrawLinesCmd.create.call(this,x+offset,y+offset,points,lineColor,lineWidth,0));};_proto88.drawCurves=function drawCurves(x,y,points,lineColor,lineWidth){if(lineWidth===void 0){lineWidth=1;}return this._saveToCmd(Render._context.drawCurves,DrawCurvesCmd.create.call(this,x,y,points,lineColor,lineWidth));};_proto88.drawRect=function drawRect(x,y,width,height,fillColor,lineColor,lineWidth){if(lineColor===void 0){lineColor=null;}if(lineWidth===void 0){lineWidth=1;}var offset=lineWidth>=1&&lineColor?lineWidth/2:0;var lineOffset=lineColor?lineWidth:0;return this._saveToCmd(Render._context.drawRect,DrawRectCmd.create.call(this,x+offset,y+offset,width-lineOffset,height-lineOffset,fillColor,lineColor,lineWidth));};_proto88.drawCircle=function drawCircle(x,y,radius,fillColor,lineColor,lineWidth){if(lineColor===void 0){lineColor=null;}if(lineWidth===void 0){lineWidth=1;}var offset=lineWidth>=1&&lineColor?lineWidth/2:0;return this._saveToCmd(Render._context._drawCircle,DrawCircleCmd.create.call(this,x,y,radius-offset,fillColor,lineColor,lineWidth,0));};_proto88.drawPie=function drawPie(x,y,radius,startAngle,endAngle,fillColor,lineColor,lineWidth){if(lineColor===void 0){lineColor=null;}if(lineWidth===void 0){lineWidth=1;}var offset=lineWidth>=1&&lineColor?lineWidth/2:0;var lineOffset=lineColor?lineWidth:0;return this._saveToCmd(Render._context._drawPie,DrawPieCmd.create.call(this,x+offset,y+offset,radius-lineOffset,Utils.toRadian(startAngle),Utils.toRadian(endAngle),fillColor,lineColor,lineWidth,0));};_proto88.drawPoly=function drawPoly(x,y,points,fillColor,lineColor,lineWidth){if(lineColor===void 0){lineColor=null;}if(lineWidth===void 0){lineWidth=1;}var tIsConvexPolygon=false;if(points.length>6){tIsConvexPolygon=false;}else {tIsConvexPolygon=true;}var offset=lineWidth>=1&&lineColor?lineWidth%2===0?0:0.5:0;return this._saveToCmd(Render._context._drawPoly,DrawPolyCmd.create.call(this,x+offset,y+offset,points,fillColor,lineColor,lineWidth,tIsConvexPolygon,0));};_proto88.drawPath=function drawPath(x,y,paths,brush,pen){if(brush===void 0){brush=null;}if(pen===void 0){pen=null;}return this._saveToCmd(Render._context._drawPath,DrawPathCmd.create.call(this,x,y,paths,brush,pen));};_proto88.draw9Grid=function draw9Grid(texture,x,y,width,height,sizeGrid){if(x===void 0){x=0;}if(y===void 0){y=0;}if(width===void 0){width=0;}if(height===void 0){height=0;}if(sizeGrid===void 0){sizeGrid=null;}this._saveToCmd(null,Draw9GridTexture.create(texture,x,y,width,height,sizeGrid));};_createClass(Graphics,[{key:"cmds",get:function get(){return this._cmds;},set:function set(value){if(this._sp){this._sp._renderType|=SpriteConst.GRAPHICS;this._sp._setRenderType(this._sp._renderType);}this._cmds=value;this._render=this._renderAll;this._repaint();}}]);return Graphics;}();var Const=function Const(){};Const.NOT_ACTIVE=0x01;Const.ACTIVE_INHIERARCHY=0x02;Const.AWAKED=0x04;Const.NOT_READY=0x08;Const.DISPLAY=0x10;Const.HAS_ZORDER=0x20;Const.HAS_MOUSE=0x40;Const.DISPLAYED_INSTAGE=0x80;Const.DRAWCALL_OPTIMIZE=0x100;var LayaGLQuickRunner=/*#__PURE__*/function(){function LayaGLQuickRunner(){}LayaGLQuickRunner.__init__=function __init__(){LayaGLQuickRunner.map[SpriteConst.ALPHA|SpriteConst.TRANSFORM|SpriteConst.GRAPHICS]=LayaGLQuickRunner.alpha_transform_drawLayaGL;LayaGLQuickRunner.map[SpriteConst.ALPHA|SpriteConst.GRAPHICS]=LayaGLQuickRunner.alpha_drawLayaGL;LayaGLQuickRunner.map[SpriteConst.TRANSFORM|SpriteConst.GRAPHICS]=LayaGLQuickRunner.transform_drawLayaGL;LayaGLQuickRunner.map[SpriteConst.TRANSFORM|SpriteConst.CHILDS]=LayaGLQuickRunner.transform_drawNodes;LayaGLQuickRunner.map[SpriteConst.ALPHA|SpriteConst.TRANSFORM|SpriteConst.TEXTURE]=LayaGLQuickRunner.alpha_transform_drawTexture;LayaGLQuickRunner.map[SpriteConst.ALPHA|SpriteConst.TEXTURE]=LayaGLQuickRunner.alpha_drawTexture;LayaGLQuickRunner.map[SpriteConst.TRANSFORM|SpriteConst.TEXTURE]=LayaGLQuickRunner.transform_drawTexture;LayaGLQuickRunner.map[SpriteConst.GRAPHICS|SpriteConst.CHILDS]=LayaGLQuickRunner.drawLayaGL_drawNodes;};LayaGLQuickRunner.transform_drawTexture=function transform_drawTexture(sprite,context,x,y){var style=sprite._style;var tex=sprite.texture;context.saveTransform(LayaGLQuickRunner.curMat);context.transformByMatrix(sprite.transform,x,y);var width=sprite._width||tex.sourceWidth;var height=sprite._height||tex.sourceHeight;var wRate=width/tex.sourceWidth;var hRate=height/tex.sourceHeight;width=tex.width*wRate;height=tex.height*hRate;if(width<=0||height<=0)return null;var px=-sprite.pivotX+tex.offsetX*wRate;var py=-sprite.pivotY+tex.offsetY*hRate;context.drawTexture(tex,px,py,width,height);context.restoreTransform(LayaGLQuickRunner.curMat);};LayaGLQuickRunner.alpha_drawTexture=function alpha_drawTexture(sprite,context,x,y){var style=sprite._style;var alpha;var tex=sprite.texture;if((alpha=style.alpha)>0.01||sprite._needRepaint()){var temp=context.globalAlpha;context.globalAlpha*=alpha;context.drawTexture(tex,x-style.pivotX+tex.offsetX,y-style.pivotY+tex.offsetY,sprite._width||tex.width,sprite._height||tex.height);context.globalAlpha=temp;}};LayaGLQuickRunner.alpha_transform_drawTexture=function alpha_transform_drawTexture(sprite,context,x,y){var style=sprite._style;var alpha;var tex=sprite.texture;if((alpha=style.alpha)>0.01||sprite._needRepaint()){var temp=context.globalAlpha;context.globalAlpha*=alpha;context.saveTransform(LayaGLQuickRunner.curMat);context.transformByMatrix(sprite.transform,x,y);context.drawTexture(tex,-style.pivotX+tex.offsetX,-style.pivotY+tex.offsetY,sprite._width||tex.width,sprite._height||tex.height);context.restoreTransform(LayaGLQuickRunner.curMat);context.globalAlpha=temp;}};LayaGLQuickRunner.alpha_transform_drawLayaGL=function alpha_transform_drawLayaGL(sprite,context,x,y){var style=sprite._style;var alpha;if((alpha=style.alpha)>0.01||sprite._needRepaint()){var temp=context.globalAlpha;context.globalAlpha*=alpha;context.saveTransform(LayaGLQuickRunner.curMat);context.transformByMatrix(sprite.transform,x,y);sprite._graphics&&sprite._graphics._render(sprite,context,-style.pivotX,-style.pivotY);context.restoreTransform(LayaGLQuickRunner.curMat);context.globalAlpha=temp;}};LayaGLQuickRunner.alpha_drawLayaGL=function alpha_drawLayaGL(sprite,context,x,y){var style=sprite._style;var alpha;if((alpha=style.alpha)>0.01||sprite._needRepaint()){var temp=context.globalAlpha;context.globalAlpha*=alpha;sprite._graphics&&sprite._graphics._render(sprite,context,x-style.pivotX,y-style.pivotY);context.globalAlpha=temp;}};LayaGLQuickRunner.transform_drawLayaGL=function transform_drawLayaGL(sprite,context,x,y){var style=sprite._style;context.saveTransform(LayaGLQuickRunner.curMat);context.transformByMatrix(sprite.transform,x,y);sprite._graphics&&sprite._graphics._render(sprite,context,-style.pivotX,-style.pivotY);context.restoreTransform(LayaGLQuickRunner.curMat);};LayaGLQuickRunner.transform_drawNodes=function transform_drawNodes(sprite,context,x,y){var textLastRender=sprite._getBit(Const.DRAWCALL_OPTIMIZE)&&context.drawCallOptimize(true);var style=sprite._style;context.saveTransform(LayaGLQuickRunner.curMat);context.transformByMatrix(sprite.transform,x,y);x=-style.pivotX;y=-style.pivotY;var childs=sprite._children,n=childs.length,ele;if(style.viewport){var rect=style.viewport;var left=rect.x;var top=rect.y;var right=rect.right;var bottom=rect.bottom;var _x,_y;for(i=0;i<n;++i){if((ele=childs[i])._visible&&(_x=ele._x)<right&&_x+ele.width>left&&(_y=ele._y)<bottom&&_y+ele.height>top){ele.render(context,x,y);}}}else {for(var i=0;i<n;++i){(ele=childs[i])._visible&&ele.render(context,x,y);}}context.restoreTransform(LayaGLQuickRunner.curMat);textLastRender&&context.drawCallOptimize(false);};LayaGLQuickRunner.drawLayaGL_drawNodes=function drawLayaGL_drawNodes(sprite,context,x,y){var textLastRender=sprite._getBit(Const.DRAWCALL_OPTIMIZE)&&context.drawCallOptimize(true);var style=sprite._style;x=x-style.pivotX;y=y-style.pivotY;sprite._graphics&&sprite._graphics._render(sprite,context,x,y);var childs=sprite._children,n=childs.length,ele;if(style.viewport){var rect=style.viewport;var left=rect.x;var top=rect.y;var right=rect.right;var bottom=rect.bottom;var _x,_y;for(i=0;i<n;++i){if((ele=childs[i])._visible&&(_x=ele._x)<right&&_x+ele.width>left&&(_y=ele._y)<bottom&&_y+ele.height>top){ele.render(context,x,y);}}}else {for(var i=0;i<n;++i){(ele=childs[i])._visible&&ele.render(context,x,y);}}textLastRender&&context.drawCallOptimize(false);};return LayaGLQuickRunner;}();LayaGLQuickRunner.map=[];LayaGLQuickRunner.curMat=new Matrix();var RenderSprite=/*#__PURE__*/function(){function RenderSprite(type,next){if(LayaGLQuickRunner.map[type]){this._fun=LayaGLQuickRunner.map[type];this._next=RenderSprite.NORENDER;return;}this._next=next||RenderSprite.NORENDER;switch(type){case 0:this._fun=this._no;return;case SpriteConst.ALPHA:this._fun=this._alpha;return;case SpriteConst.TRANSFORM:this._fun=this._transform;return;case SpriteConst.BLEND:this._fun=this._blend;return;case SpriteConst.CANVAS:this._fun=this._canvas;return;case SpriteConst.MASK:this._fun=this._mask;return;case SpriteConst.CLIP:this._fun=this._clip;return;case SpriteConst.STYLE:this._fun=this._style;return;case SpriteConst.GRAPHICS:this._fun=this._graphics;return;case SpriteConst.CHILDS:this._fun=this._children;return;case SpriteConst.CUSTOM:this._fun=this._custom;return;case SpriteConst.TEXTURE:this._fun=this._texture;return;case SpriteConst.FILTERS:this._fun=Filter._filter;return;case RenderSprite.INIT:this._fun=RenderSprite._initRenderFun;return;}this.onCreate(type);}RenderSprite.__init__=function __init__(){LayaGLQuickRunner.__init__();var i,len;var initRender;initRender=new RenderSprite(RenderSprite.INIT,null);len=RenderSprite.renders.length=SpriteConst.CHILDS*2;for(i=0;i<len;i++){RenderSprite.renders[i]=initRender;}RenderSprite.renders[0]=new RenderSprite(0,null);};RenderSprite._initRenderFun=function _initRenderFun(sprite,context,x,y){var type=sprite._renderType;var r=RenderSprite.renders[type]=RenderSprite._getTypeRender(type);r._fun(sprite,context,x,y);};RenderSprite._getTypeRender=function _getTypeRender(type){if(LayaGLQuickRunner.map[type])return new RenderSprite(type,null);var rst=null;var tType=SpriteConst.CHILDS;while(tType>0){if(tType&type)rst=new RenderSprite(tType,rst);tType=tType>>1;}return rst;};var _proto89=RenderSprite.prototype;_proto89.onCreate=function onCreate(type){};_proto89._style=function _style(sprite,context,x,y){var style=sprite._style;if(style.render!=null)style.render(sprite,context,x,y);var next=this._next;next._fun.call(next,sprite,context,x,y);};_proto89._no=function _no(sprite,context,x,y){};_proto89._custom=function _custom(sprite,context,x,y){sprite.customRender(context,x,y);this._next._fun.call(this._next,sprite,context,0,0);};_proto89._clip=function _clip(sprite,context,x,y){var next=this._next;if(next==RenderSprite.NORENDER)return;var r=sprite._style.scrollRect;var width=r.width;var height=r.height;if(width===0||height===0){return;}context.save();context.clipRect(x,y,width,height);next._fun.call(next,sprite,context,x-r.x,y-r.y);context.restore();};_proto89._texture=function _texture(sprite,context,x,y){var tex=sprite.texture;if(tex._getSource()){var width=sprite._width||tex.sourceWidth;var height=sprite._height||tex.sourceHeight;var wRate=width/tex.sourceWidth;var hRate=height/tex.sourceHeight;width=tex.width*wRate;height=tex.height*hRate;if(width<=0||height<=0)return;var px=x-sprite.pivotX+tex.offsetX*wRate;var py=y-sprite.pivotY+tex.offsetY*hRate;context.drawTexture(tex,px,py,width,height);}var next=this._next;if(next!=RenderSprite.NORENDER)next._fun.call(next,sprite,context,x,y);};_proto89._graphics=function _graphics(sprite,context,x,y){var style=sprite._style;var g=sprite._graphics;g&&g._render(sprite,context,x-style.pivotX,y-style.pivotY);var next=this._next;if(next!=RenderSprite.NORENDER)next._fun.call(next,sprite,context,x,y);};_proto89._image=function _image(sprite,context,x,y){var style=sprite._style;context.drawTexture2(x,y,style.pivotX,style.pivotY,sprite.transform,sprite._graphics._one);};_proto89._image2=function _image2(sprite,context,x,y){var style=sprite._style;context.drawTexture2(x,y,style.pivotX,style.pivotY,sprite.transform,sprite._graphics._one);};_proto89._alpha=function _alpha(sprite,context,x,y){var style=sprite._style;var alpha;if((alpha=style.alpha)>0.01||sprite._needRepaint()){var temp=context.globalAlpha;context.globalAlpha*=alpha;var next=this._next;next._fun.call(next,sprite,context,x,y);context.globalAlpha=temp;}};_proto89._transform=function _transform(sprite,context,x,y){var transform=sprite.transform,_next=this._next;var style=sprite._style;if(transform&&_next!=RenderSprite.NORENDER){context.save();context.transform(transform.a,transform.b,transform.c,transform.d,transform.tx+x,transform.ty+y);_next._fun.call(_next,sprite,context,0,0);context.restore();}else {if(_next!=RenderSprite.NORENDER)_next._fun.call(_next,sprite,context,x,y);}};_proto89._children=function _children(sprite,context,x,y){var style=sprite._style;var childs=sprite._children,n=childs.length,ele;x=x-sprite.pivotX;y=y-sprite.pivotY;var textLastRender=sprite._getBit(Const.DRAWCALL_OPTIMIZE)&&context.drawCallOptimize(true);if(style.viewport){var rect=style.viewport;var left=rect.x;var top=rect.y;var right=rect.right;var bottom=rect.bottom;var _x,_y;for(i=0;i<n;++i){if((ele=childs[i])._visible&&(_x=ele._x)<right&&_x+ele.width>left&&(_y=ele._y)<bottom&&_y+ele.height>top){ele.render(context,x,y);}}}else {for(var i=0;i<n;++i){(ele=childs[i])._visible&&ele.render(context,x,y);}}textLastRender&&context.drawCallOptimize(false);};_proto89._canvas=function _canvas(sprite,context,x,y){var _cacheStyle=sprite._cacheStyle;var _next=this._next;if(!_cacheStyle.enableCanvasRender){_next._fun.call(_next,sprite,context,x,y);return;}_cacheStyle.cacheAs==='bitmap'?Stat.canvasBitmap++:Stat.canvasNormal++;var cacheNeedRebuild=false;var textNeedRestore=false;if(_cacheStyle.canvas){var canv=_cacheStyle.canvas;var ctx=canv.context;var charRIs=canv.touches;if(charRIs){for(var ci=0;ci<charRIs.length;ci++){if(charRIs[ci].deleted){textNeedRestore=true;break;}}}cacheNeedRebuild=canv.isCacheValid&&!canv.isCacheValid();}if(sprite._needRepaint()||!_cacheStyle.canvas||textNeedRestore||cacheNeedRebuild||ILaya.stage.isGlobalRepaint()){if(_cacheStyle.cacheAs==='normal'){if(context._targets){_next._fun.call(_next,sprite,context,x,y);return;}else {this._canvas_webgl_normal_repaint(sprite,context);}}else {this._canvas_repaint(sprite,context,x,y);}}var tRec=_cacheStyle.cacheRect;context.drawCanvas(_cacheStyle.canvas,x+tRec.x,y+tRec.y,tRec.width,tRec.height);};_proto89._canvas_repaint=function _canvas_repaint(sprite,context,x,y){var _cacheStyle=sprite._cacheStyle;var _next=this._next;var tx;var canvas=_cacheStyle.canvas;var left;var top;var tRec;var tCacheType=_cacheStyle.cacheAs;var w,h;var scaleX,scaleY;var scaleInfo;scaleInfo=_cacheStyle._calculateCacheRect(sprite,tCacheType,x,y);scaleX=scaleInfo.x;scaleY=scaleInfo.y;tRec=_cacheStyle.cacheRect;w=tRec.width*scaleX;h=tRec.height*scaleY;left=tRec.x;top=tRec.y;if(tCacheType==='bitmap'&&(w>2048||h>2048)){console.warn("cache bitmap size larger than 2048,cache ignored");_cacheStyle.releaseContext();_next._fun.call(_next,sprite,context,x,y);return;}if(!canvas){_cacheStyle.createContext();canvas=_cacheStyle.canvas;}tx=canvas.context;tx.sprite=sprite;(canvas.width!=w||canvas.height!=h)&&canvas.size(w,h);if(tCacheType==='bitmap')tx.asBitmap=true;else if(tCacheType==='normal')tx.asBitmap=false;tx.clear();if(scaleX!=1||scaleY!=1){var ctx=tx;ctx.save();ctx.scale(scaleX,scaleY);_next._fun.call(_next,sprite,tx,-left,-top);ctx.restore();sprite._applyFilters();}else {ctx=tx;_next._fun.call(_next,sprite,tx,-left,-top);sprite._applyFilters();}if(_cacheStyle.staticCache)_cacheStyle.reCache=false;Stat.canvasReCache++;};_proto89._canvas_webgl_normal_repaint=function _canvas_webgl_normal_repaint(sprite,context){var _cacheStyle=sprite._cacheStyle;var _next=this._next;var canvas=_cacheStyle.canvas;var tCacheType=_cacheStyle.cacheAs;_cacheStyle._calculateCacheRect(sprite,tCacheType,0,0);if(!canvas){canvas=new WebGLCacheAsNormalCanvas(context,sprite);_cacheStyle.canvas=canvas;}var tx=canvas.context;canvas.startRec();_next._fun.call(_next,sprite,tx,sprite.pivotX,sprite.pivotY);sprite._applyFilters();Stat.canvasReCache++;canvas.endRec();};_proto89._blend=function _blend(sprite,context,x,y){var style=sprite._style;var next=this._next;if(style.blendMode){context.save();context.globalCompositeOperation=style.blendMode;next._fun.call(next,sprite,context,x,y);context.restore();}else {next._fun.call(next,sprite,context,x,y);}};_proto89._mask=function _mask(sprite,context,x,y){var next=this._next;var mask=sprite.mask;var ctx=context;if(mask){ctx.save();var preBlendMode=ctx.globalCompositeOperation;var tRect=new Rectangle();tRect.copyFrom(mask.getBounds());tRect.width=Math.round(tRect.width);tRect.height=Math.round(tRect.height);tRect.x=Math.round(tRect.x);tRect.y=Math.round(tRect.y);if(tRect.width>0&&tRect.height>0){var w=tRect.width;var h=tRect.height;var tmpRT=WebGLRTMgr.getRT(w,h);ctx.breakNextMerge();ctx.pushRT();ctx.addRenderObject(SubmitCMD.create([ctx,tmpRT,w,h],RenderSprite.tmpTarget,this));mask.render(ctx,-tRect.x,-tRect.y);ctx.breakNextMerge();ctx.popRT();ctx.save();ctx.clipRect(x+tRect.x-sprite.getStyle().pivotX,y+tRect.y-sprite.getStyle().pivotY,w,h);next._fun.call(next,sprite,ctx,x,y);ctx.restore();preBlendMode=ctx.globalCompositeOperation;ctx.addRenderObject(SubmitCMD.create(["mask"],RenderSprite.setBlendMode,this));var shaderValue=Value2D.create(ShaderDefines2D.TEXTURE2D,0);var uv=Texture.INV_UV;ctx.drawTarget(tmpRT,x+tRect.x-sprite.getStyle().pivotX,y+tRect.y-sprite.getStyle().pivotY,w,h,Matrix.TEMP.identity(),shaderValue,uv,6);ctx.addRenderObject(SubmitCMD.create([tmpRT],RenderSprite.recycleTarget,this));ctx.addRenderObject(SubmitCMD.create([preBlendMode],RenderSprite.setBlendMode,this));}ctx.restore();}else {next._fun.call(next,sprite,context,x,y);}};RenderSprite.tmpTarget=function tmpTarget(ctx,rt,w,h){rt.start();rt.clear(0,0,0,0);};RenderSprite.recycleTarget=function recycleTarget(rt){WebGLRTMgr.releaseRT(rt);};RenderSprite.setBlendMode=function setBlendMode(blendMode){var gl=WebGLContext.mainContext;BlendMode.targetFns[BlendMode.TOINT[blendMode]](gl);};return RenderSprite;}();RenderSprite.INIT=0x11111;RenderSprite.renders=[];RenderSprite.NORENDER=new RenderSprite(0,null);RenderSprite.tempUV=new Array(8);var HTMLCanvas=/*#__PURE__*/function(_Bitmap2){_inheritsLoose(HTMLCanvas,_Bitmap2);function HTMLCanvas(createCanvas){var _this21;if(createCanvas===void 0){createCanvas=false;}_this21=_Bitmap2.call(this)||this;if(createCanvas)_this21._source=Browser.createElement("canvas");else {_this21._source=_assertThisInitialized(_this21);}_this21.lock=true;return _this21;}var _proto90=HTMLCanvas.prototype;_proto90._getSource=function _getSource(){return this._source;};_proto90.clear=function clear(){if(this._ctx){if(this._ctx.clear){this._ctx.clear();}else {this._ctx.clearRect(0,0,this._width,this._height);}}if(this._texture){this._texture.destroy();this._texture=null;}};_proto90.destroy=function destroy(){_Bitmap2.prototype.destroy.call(this);this._setCPUMemory(0);this._ctx&&this._ctx.destroy&&this._ctx.destroy();this._ctx=null;};_proto90.release=function release(){};_proto90._setContext=function _setContext(context){this._ctx=context;};_proto90.getContext=function getContext(contextID,other){return this.context;};_proto90.getMemSize=function getMemSize(){return 0;};_proto90.size=function size(w,h){if(this._width!=w||this._height!=h||this._source&&(this._source.width!=w||this._source.height!=h)){this._width=w;this._height=h;this._setCPUMemory(w*h*4);this._ctx&&this._ctx.size&&this._ctx.size(w,h);if(this._source){this._source.height=h;this._source.width=w;}if(this._texture){this._texture.destroy();this._texture=null;}}};_proto90.getTexture=function getTexture(){if(!this._texture){var bitmap=new Texture2D();bitmap.loadImageSource(this.source);this._texture=new Texture(bitmap);}return this._texture;};_proto90.toBase64=function toBase64(type,encoderOptions){if(this._source){if(ILaya.Render.isConchApp){var win=window;if(win.conchConfig.threadMode==2){throw "native 2 thread mode use toBase64Async";}var width=this._ctx._targets.sourceWidth;var height=this._ctx._targets.sourceHeight;var data=this._ctx._targets.getData(0,0,width,height);return win.conchToBase64FlipY?win.conchToBase64FlipY(type,encoderOptions,data.buffer,width,height):win.conchToBase64(type,encoderOptions,data.buffer,width,height);}else {return this._source.toDataURL(type,encoderOptions);}}return null;};_proto90.toBase64Async=function toBase64Async(type,encoderOptions,callBack){var width=this._ctx._targets.sourceWidth;var height=this._ctx._targets.sourceHeight;this._ctx._targets.getDataAsync(0,0,width,height,function(data){var win=window;var base64=win.conchToBase64FlipY?win.conchToBase64FlipY(type,encoderOptions,data.buffer,width,height):win.conchToBase64(type,encoderOptions,data.buffer,width,height);callBack(base64);});};_createClass(HTMLCanvas,[{key:"source",get:function get(){return this._source;}},{key:"context",get:function get(){if(this._ctx)return this._ctx;if(this._source==this){this._ctx=new ILaya.Context();}else {this._ctx=this._source.getContext(ILaya.Render.isConchApp?'layagl':'2d');}this._ctx._canvas=this;return this._ctx;}}]);return HTMLCanvas;}(Bitmap);var HitArea=/*#__PURE__*/function(){function HitArea(){}var _proto91=HitArea.prototype;_proto91.contains=function contains(x,y){if(!HitArea._isHitGraphic(x,y,this.hit))return false;return !HitArea._isHitGraphic(x,y,this.unHit);};HitArea._isHitGraphic=function _isHitGraphic(x,y,graphic){if(!graphic)return false;var cmds=graphic.cmds;if(!cmds&&graphic._one){cmds=HitArea._cmds;cmds.length=1;cmds[0]=graphic._one;}if(!cmds)return false;var i,len;len=cmds.length;var cmd;for(i=0;i<len;i++){cmd=cmds[i];if(!cmd)continue;switch(cmd.cmdID){case"Translate":x-=cmd.tx;y-=cmd.ty;}if(HitArea._isHitCmd(x,y,cmd))return true;}return false;};HitArea._isHitCmd=function _isHitCmd(x,y,cmd){if(!cmd)return false;var rst=false;switch(cmd.cmdID){case"DrawRect":HitArea._rect.setTo(cmd.x,cmd.y,cmd.width,cmd.height);rst=HitArea._rect.contains(x,y);break;case"DrawCircle":var d;x-=cmd.x;y-=cmd.y;d=x*x+y*y;rst=d<cmd.radius*cmd.radius;break;case"DrawPoly":x-=cmd.x;y-=cmd.y;rst=HitArea._ptInPolygon(x,y,cmd.points);break;}return rst;};HitArea._ptInPolygon=function _ptInPolygon(x,y,areaPoints){var p=HitArea._ptPoint;p.setTo(x,y);var nCross=0;var p1x,p1y,p2x,p2y;var len;len=areaPoints.length;for(var i=0;i<len;i+=2){p1x=areaPoints[i];p1y=areaPoints[i+1];p2x=areaPoints[(i+2)%len];p2y=areaPoints[(i+3)%len];if(p1y==p2y)continue;if(p.y<Math.min(p1y,p2y))continue;if(p.y>=Math.max(p1y,p2y))continue;var tx=(p.y-p1y)*(p2x-p1x)/(p2y-p1y)+p1x;if(tx>p.x)nCross++;}return nCross%2==1;};_createClass(HitArea,[{key:"hit",get:function get(){if(!this._hit)this._hit=new ILaya.Graphics();return this._hit;},set:function set(value){this._hit=value;}},{key:"unHit",get:function get(){if(!this._unHit)this._unHit=new ILaya.Graphics();return this._unHit;},set:function set(value){this._unHit=value;}}]);return HitArea;}();HitArea._cmds=[];HitArea._rect=new Rectangle();HitArea._ptPoint=new Point();var ClassUtils=/*#__PURE__*/function(){function ClassUtils(){}ClassUtils.regClass=function regClass(className,classDef){ClassUtils._classMap[className]=classDef;};ClassUtils.regShortClassName=function regShortClassName(classes){for(var i=0;i<classes.length;i++){var classDef=classes[i];var className=classDef.name;ClassUtils._classMap[className]=classDef;}};ClassUtils.getRegClass=function getRegClass(className){return ClassUtils._classMap[className];};ClassUtils.getClass=function getClass(className){var classObject=ClassUtils._classMap[className]||ClassUtils._classMap['Laya.'+className]||className;var glaya=ILaya.Laya;if(typeof classObject=='string')return ILaya.__classMap[classObject]||glaya[className];return classObject;};ClassUtils.getInstance=function getInstance(className){var compClass=ClassUtils.getClass(className);if(compClass)return new compClass();else console.warn("[error] Undefined class:",className);return null;};ClassUtils.createByJson=function createByJson(json,node,root,customHandler,instanceHandler){if(node===void 0){node=null;}if(root===void 0){root=null;}if(customHandler===void 0){customHandler=null;}if(instanceHandler===void 0){instanceHandler=null;}if(typeof json=='string')json=JSON.parse(json);var props=json.props;if(!node){node=instanceHandler?instanceHandler.runWith(json):ClassUtils.getInstance(props.runtime||json.type);if(!node)return null;}var child=json.child;if(child){for(var i=0,n=child.length;i<n;i++){var data=child[i];if((data.props.name==="render"||data.props.renderType==="render")&&node["_$set_itemRender"])node.itemRender=data;else {if(data.type=="Graphic"){ClassUtils._addGraphicsToSprite(data,node);}else if(ClassUtils._isDrawType(data.type)){ClassUtils._addGraphicToSprite(data,node,true);}else {var tChild=ClassUtils.createByJson(data,null,root,customHandler,instanceHandler);if(data.type==="Script"){if("owner"in tChild){tChild["owner"]=node;}else if("target"in tChild){tChild["target"]=node;}}else if(data.props.renderType=="mask"){node.mask=tChild;}else {node.addChild(tChild);}}}}}if(props){for(var prop in props){var value=props[prop];if(prop==="var"&&root){root[value]=node;}else if(value instanceof Array&&node[prop]instanceof Function){node[prop].apply(node,value);}else {node[prop]=value;}}}if(customHandler&&json.customProps){customHandler.runWith([node,json]);}if(node["created"])node.created();return node;};ClassUtils._addGraphicsToSprite=function _addGraphicsToSprite(graphicO,sprite){var graphics=graphicO.child;if(!graphics||graphics.length<1)return;var g=ClassUtils._getGraphicsFromSprite(graphicO,sprite);var ox=0;var oy=0;if(graphicO.props){ox=ClassUtils._getObjVar(graphicO.props,"x",0);oy=ClassUtils._getObjVar(graphicO.props,"y",0);}if(ox!=0&&oy!=0){g.translate(ox,oy);}var i,len;len=graphics.length;for(i=0;i<len;i++){ClassUtils._addGraphicToGraphics(graphics[i],g);}if(ox!=0&&oy!=0){g.translate(-ox,-oy);}};ClassUtils._addGraphicToSprite=function _addGraphicToSprite(graphicO,sprite,isChild){if(isChild===void 0){isChild=false;}var g=isChild?ClassUtils._getGraphicsFromSprite(graphicO,sprite):sprite.graphics;ClassUtils._addGraphicToGraphics(graphicO,g);};ClassUtils._getGraphicsFromSprite=function _getGraphicsFromSprite(dataO,sprite){if(!dataO||!dataO.props)return sprite.graphics;var propsName=dataO.props.renderType;if(propsName==="hit"||propsName==="unHit"){var hitArea=sprite._style.hitArea||(sprite.hitArea=new HitArea());if(!hitArea[propsName]){hitArea[propsName]=new Graphics();}var g=hitArea[propsName];}if(!g)g=sprite.graphics;return g;};ClassUtils._getTransformData=function _getTransformData(propsO){var m;if("pivotX"in propsO||"pivotY"in propsO){m=m||new Matrix();m.translate(-ClassUtils._getObjVar(propsO,"pivotX",0),-ClassUtils._getObjVar(propsO,"pivotY",0));}var sx=ClassUtils._getObjVar(propsO,"scaleX",1),sy=ClassUtils._getObjVar(propsO,"scaleY",1);var rotate=ClassUtils._getObjVar(propsO,"rotation",0);var skewX=ClassUtils._getObjVar(propsO,"skewX",0);var skewY=ClassUtils._getObjVar(propsO,"skewY",0);if(sx!=1||sy!=1||rotate!=0){m=m||new Matrix();m.scale(sx,sy);m.rotate(rotate*0.0174532922222222);}return m;};ClassUtils._addGraphicToGraphics=function _addGraphicToGraphics(graphicO,graphic){var propsO;propsO=graphicO.props;if(!propsO)return;var drawConfig;drawConfig=ClassUtils.DrawTypeDic[graphicO.type];if(!drawConfig)return;var g=graphic;var params=ClassUtils._getParams(propsO,drawConfig[1],drawConfig[2],drawConfig[3]);var m=ClassUtils._tM;if(m||ClassUtils._alpha!=1){g.save();if(m)g.transform(m);if(ClassUtils._alpha!=1)g.alpha(ClassUtils._alpha);}g[drawConfig[0]].apply(g,params);if(m||ClassUtils._alpha!=1){g.restore();}};ClassUtils._adptLineData=function _adptLineData(params){params[2]=parseFloat(params[0])+parseFloat(params[2]);params[3]=parseFloat(params[1])+parseFloat(params[3]);return params;};ClassUtils._adptTextureData=function _adptTextureData(params){params[0]=ILaya.Loader.getRes(params[0]);return params;};ClassUtils._adptLinesData=function _adptLinesData(params){params[2]=ClassUtils._getPointListByStr(params[2]);return params;};ClassUtils._isDrawType=function _isDrawType(type){if(type==="Image")return false;return type in ClassUtils.DrawTypeDic;};ClassUtils._getParams=function _getParams(obj,params,xPos,adptFun){if(xPos===void 0){xPos=0;}if(adptFun===void 0){adptFun=null;}var rst=ClassUtils._temParam;rst.length=params.length;var i,len;len=params.length;for(i=0;i<len;i++){rst[i]=ClassUtils._getObjVar(obj,params[i][0],params[i][1]);}ClassUtils._alpha=ClassUtils._getObjVar(obj,"alpha",1);var m;m=ClassUtils._getTransformData(obj);if(m){if(!xPos)xPos=0;m.translate(rst[xPos],rst[xPos+1]);rst[xPos]=rst[xPos+1]=0;ClassUtils._tM=m;}else {ClassUtils._tM=null;}if(adptFun&&ClassUtils[adptFun]){rst=ClassUtils[adptFun](rst);}return rst;};ClassUtils._getPointListByStr=function _getPointListByStr(str){var pointArr=str.split(",");var i,len;len=pointArr.length;for(i=0;i<len;i++){pointArr[i]=parseFloat(pointArr[i]);}return pointArr;};ClassUtils._getObjVar=function _getObjVar(obj,key,noValue){if(key in obj){return obj[key];}return noValue;};return ClassUtils;}();ClassUtils.DrawTypeDic={"Rect":["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],"Circle":["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],"Pie":["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],"Image":["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],"Texture":["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],"FillTexture":["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],"FillText":["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],"Line":["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],"Lines":["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],"Curves":["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],"Poly":["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]};ClassUtils._temParam=[];ClassUtils._classMap={};var BoundsStyle=/*#__PURE__*/function(){function BoundsStyle(){}var _proto92=BoundsStyle.prototype;_proto92.reset=function reset(){if(this.bounds)this.bounds.recover();if(this.userBounds)this.userBounds.recover();this.bounds=null;this.userBounds=null;this.temBM=null;return this;};_proto92.recover=function recover(){Pool.recover("BoundsStyle",this.reset());};BoundsStyle.create=function create(){return Pool.getItemByClass("BoundsStyle",BoundsStyle);};return BoundsStyle;}();var CacheStyle=/*#__PURE__*/function(){function CacheStyle(){this.reset();}var _proto93=CacheStyle.prototype;_proto93.needBitmapCache=function needBitmapCache(){return this.cacheForFilters||!!this.mask;};_proto93.needEnableCanvasRender=function needEnableCanvasRender(){return this.userSetCache!="none"||this.cacheForFilters||!!this.mask;};_proto93.releaseContext=function releaseContext(){if(this.canvas&&this.canvas.size){Pool.recover("CacheCanvas",this.canvas);this.canvas.size(0,0);try{this.canvas.width=0;this.canvas.height=0;}catch(e){}}this.canvas=null;};_proto93.createContext=function createContext(){if(!this.canvas){this.canvas=Pool.getItem("CacheCanvas")||new HTMLCanvas(false);var tx=this.canvas.context;if(!tx){tx=this.canvas.getContext('2d');}}};_proto93.releaseFilterCache=function releaseFilterCache(){var fc=this.filterCache;if(fc){fc.destroy();fc.recycle();this.filterCache=null;}};_proto93.recover=function recover(){if(this===CacheStyle.EMPTY)return;Pool.recover("SpriteCache",this.reset());};_proto93.reset=function reset(){this.releaseContext();this.releaseFilterCache();this.cacheAs="none";this.enableCanvasRender=false;this.userSetCache="none";this.cacheForFilters=false;this.staticCache=false;this.reCache=true;this.mask=null;this.maskParent=null;this.filterCache=null;this.filters=null;this.hasGlowFilter=false;if(this.cacheRect)this.cacheRect.recover();this.cacheRect=null;return this;};CacheStyle.create=function create(){return Pool.getItemByClass("SpriteCache",CacheStyle);};_proto93._calculateCacheRect=function _calculateCacheRect(sprite,tCacheType,x,y){var _cacheStyle=sprite._cacheStyle;if(!_cacheStyle.cacheRect)_cacheStyle.cacheRect=Rectangle.create();var tRec;if(tCacheType==="bitmap"){tRec=sprite.getSelfBounds();tRec.width=tRec.width+CacheStyle.CANVAS_EXTEND_EDGE*2;tRec.height=tRec.height+CacheStyle.CANVAS_EXTEND_EDGE*2;tRec.x=tRec.x-sprite.pivotX;tRec.y=tRec.y-sprite.pivotY;tRec.x=tRec.x-CacheStyle.CANVAS_EXTEND_EDGE;tRec.y=tRec.y-CacheStyle.CANVAS_EXTEND_EDGE;tRec.x=Math.floor(tRec.x+x)-x;tRec.y=Math.floor(tRec.y+y)-y;tRec.width=Math.floor(tRec.width);tRec.height=Math.floor(tRec.height);_cacheStyle.cacheRect.copyFrom(tRec);}else {_cacheStyle.cacheRect.setTo(-sprite._style.pivotX,-sprite._style.pivotY,1,1);}tRec=_cacheStyle.cacheRect;if(sprite._style.scrollRect){var scrollRect=sprite._style.scrollRect;tRec.x-=scrollRect.x;tRec.y-=scrollRect.y;}CacheStyle._scaleInfo.setTo(1,1);return CacheStyle._scaleInfo;};return CacheStyle;}();CacheStyle.EMPTY=new CacheStyle();CacheStyle._scaleInfo=new Point();CacheStyle.CANVAS_EXTEND_EDGE=16;var SpriteStyle=/*#__PURE__*/function(){function SpriteStyle(){this.reset();}var _proto94=SpriteStyle.prototype;_proto94.reset=function reset(){this.scaleX=this.scaleY=1;this.skewX=this.skewY=0;this.pivotX=this.pivotY=this.rotation=0;this.alpha=1;if(this.scrollRect)this.scrollRect.recover();this.scrollRect=null;if(this.viewport)this.viewport.recover();this.viewport=null;this.hitArea=null;this.dragging=null;this.blendMode=null;return this;};_proto94.recover=function recover(){if(this===SpriteStyle.EMPTY)return;Pool.recover("SpriteStyle",this.reset());};SpriteStyle.create=function create(){return Pool.getItemByClass("SpriteStyle",SpriteStyle);};return SpriteStyle;}();SpriteStyle.EMPTY=new SpriteStyle();var Node=/*#__PURE__*/function(_EventDispatcher3){_inheritsLoose(Node,_EventDispatcher3);function Node(){var _this22;_this22=_EventDispatcher3.call(this)||this;_this22._bits=0;_this22._children=Node.ARRAY_EMPTY;_this22._extUIChild=Node.ARRAY_EMPTY;_this22._parent=null;_this22.name="";_this22.destroyed=false;_this22.createGLBuffer();return _this22;}var _proto95=Node.prototype;_proto95.createGLBuffer=function createGLBuffer(){};_proto95._setBit=function _setBit(type,value){if(type===Const.DISPLAY){var preValue=this._getBit(type);if(preValue!=value)this._updateDisplayedInstage();}if(value)this._bits|=type;else this._bits&=~type;};_proto95._getBit=function _getBit(type){return (this._bits&type)!=0;};_proto95._setUpNoticeChain=function _setUpNoticeChain(){if(this._getBit(Const.DISPLAY))this._setBitUp(Const.DISPLAY);};_proto95._setBitUp=function _setBitUp(type){var ele=this;ele._setBit(type,true);ele=ele._parent;while(ele){if(ele._getBit(type))return;ele._setBit(type,true);ele=ele._parent;}};_proto95.on=function on(type,caller,listener,args){if(args===void 0){args=null;}if(type===Event.DISPLAY||type===Event.UNDISPLAY){if(!this._getBit(Const.DISPLAY))this._setBitUp(Const.DISPLAY);}return this._createListener(type,caller,listener,args,false);};_proto95.once=function once(type,caller,listener,args){if(args===void 0){args=null;}if(type===Event.DISPLAY||type===Event.UNDISPLAY){if(!this._getBit(Const.DISPLAY))this._setBitUp(Const.DISPLAY);}return this._createListener(type,caller,listener,args,true);};_proto95.destroy=function destroy(destroyChild){if(destroyChild===void 0){destroyChild=true;}this.destroyed=true;this._destroyAllComponent();this._parent&&this._parent.removeChild(this);if(this._children){if(destroyChild)this.destroyChildren();else this.removeChildren();}this.onDestroy();this._children=null;this.offAll();};_proto95.onDestroy=function onDestroy(){};_proto95.destroyChildren=function destroyChildren(){if(this._children){for(var i=0,n=this._children.length;i<n;i++){this._children[0].destroy(true);}}};_proto95.addChild=function addChild(node){if(!node||this.destroyed||node===this)return node;if(node._zOrder)this._setBit(Const.HAS_ZORDER,true);if(node._parent===this){var index=this.getChildIndex(node);if(index!==this._children.length-1){this._children.splice(index,1);this._children.push(node);this._childChanged();}}else {node._parent&&node._parent.removeChild(node);this._children===Node.ARRAY_EMPTY&&(this._children=[]);this._children.push(node);node._setParent(this);this._childChanged();}return node;};_proto95.addInputChild=function addInputChild(node){if(this._extUIChild==Node.ARRAY_EMPTY){this._extUIChild=[node];}else {if(this._extUIChild.indexOf(node)>=0){return null;}this._extUIChild.push(node);}return null;};_proto95.removeInputChild=function removeInputChild(node){var idx=this._extUIChild.indexOf(node);if(idx>=0){this._extUIChild.splice(idx,1);}};_proto95.addChildren=function addChildren(){var i=0,n=arguments.length;while(i<n){var _i;this.addChild((_i=i++,_i<0||arguments.length<=_i?undefined:arguments[_i]));}};_proto95.addChildAt=function addChildAt(node,index){if(!node||this.destroyed||node===this)return node;if(node._zOrder)this._setBit(Const.HAS_ZORDER,true);if(index>=0&&index<=this._children.length){if(node._parent===this){var oldIndex=this.getChildIndex(node);this._children.splice(oldIndex,1);this._children.splice(index,0,node);this._childChanged();}else {node._parent&&node._parent.removeChild(node);this._children===Node.ARRAY_EMPTY&&(this._children=[]);this._children.splice(index,0,node);node._setParent(this);}return node;}else {throw new Error("appendChildAt:The index is out of bounds");}};_proto95.getChildIndex=function getChildIndex(node){return this._children.indexOf(node);};_proto95.getChildByName=function getChildByName(name){var nodes=this._children;if(nodes){for(var i=0,n=nodes.length;i<n;i++){var node=nodes[i];if(node.name===name)return node;}}return null;};_proto95.getChildAt=function getChildAt(index){return this._children[index]||null;};_proto95.setChildIndex=function setChildIndex(node,index){var childs=this._children;if(index<0||index>=childs.length){throw new Error("setChildIndex:The index is out of bounds.");}var oldIndex=this.getChildIndex(node);if(oldIndex<0)throw new Error("setChildIndex:node is must child of this object.");childs.splice(oldIndex,1);childs.splice(index,0,node);this._childChanged();return node;};_proto95._childChanged=function _childChanged(child){};_proto95.removeChild=function removeChild(node){if(!this._children)return node;var index=this._children.indexOf(node);return this.removeChildAt(index);};_proto95.removeSelf=function removeSelf(){this._parent&&this._parent.removeChild(this);return this;};_proto95.removeChildByName=function removeChildByName(name){var node=this.getChildByName(name);node&&this.removeChild(node);return node;};_proto95.removeChildAt=function removeChildAt(index){var node=this.getChildAt(index);if(node){this._children.splice(index,1);node._setParent(null);}return node;};_proto95.removeChildren=function removeChildren(beginIndex,endIndex){if(beginIndex===void 0){beginIndex=0;}if(endIndex===void 0){endIndex=0x7fffffff;}if(this._children&&this._children.length>0){var childs=this._children;if(beginIndex===0&&endIndex>=childs.length-1){var arr=childs;this._children=Node.ARRAY_EMPTY;}else {arr=childs.splice(beginIndex,endIndex-beginIndex);}for(var i=0,n=arr.length;i<n;i++){arr[i]._setParent(null);}}return this;};_proto95.replaceChild=function replaceChild(newNode,oldNode){var index=this._children.indexOf(oldNode);if(index>-1){this._children.splice(index,1,newNode);oldNode._setParent(null);newNode._setParent(this);return newNode;}return null;};_proto95._setParent=function _setParent(value){if(this._parent!==value){if(value){this._parent=value;this._onAdded();this.event(Event.ADDED);if(this._getBit(Const.DISPLAY)){this._setUpNoticeChain();value.displayedInStage&&this._displayChild(this,true);}value._childChanged(this);}else {this._onRemoved();this.event(Event.REMOVED);this._parent._childChanged();if(this._getBit(Const.DISPLAY))this._displayChild(this,false);this._parent=value;}}};_proto95._updateDisplayedInstage=function _updateDisplayedInstage(){var ele;ele=this;var stage=ILaya.stage;var displayedInStage=false;while(ele){if(ele._getBit(Const.DISPLAY)){displayedInStage=ele._getBit(Const.DISPLAYED_INSTAGE);break;}if(ele===stage||ele._getBit(Const.DISPLAYED_INSTAGE)){displayedInStage=true;break;}ele=ele._parent;}this._setBit(Const.DISPLAYED_INSTAGE,displayedInStage);};_proto95._setDisplay=function _setDisplay(value){if(this._getBit(Const.DISPLAYED_INSTAGE)!==value){this._setBit(Const.DISPLAYED_INSTAGE,value);if(value)this.event(Event.DISPLAY);else this.event(Event.UNDISPLAY);}};_proto95._displayChild=function _displayChild(node,display){var childs=node._children;if(childs){for(var i=0,n=childs.length;i<n;i++){var child=childs[i];if(!child._getBit(Const.DISPLAY))continue;if(child._children.length>0){this._displayChild(child,display);}else {child._setDisplay(display);}}}node._setDisplay(display);};_proto95.contains=function contains(node){if(node===this)return true;while(node){if(node._parent===this)return true;node=node._parent;}return false;};_proto95.timerLoop=function timerLoop(delay,caller,method,args,coverBefore,jumpFrame){if(args===void 0){args=null;}if(coverBefore===void 0){coverBefore=true;}if(jumpFrame===void 0){jumpFrame=false;}var timer=this.scene?this.scene.timer:ILaya.timer;timer.loop(delay,caller,method,args,coverBefore,jumpFrame);};_proto95.timerOnce=function timerOnce(delay,caller,method,args,coverBefore){if(args===void 0){args=null;}if(coverBefore===void 0){coverBefore=true;}var timer=this.scene?this.scene.timer:ILaya.timer;timer._create(false,false,delay,caller,method,args,coverBefore);};_proto95.frameLoop=function frameLoop(delay,caller,method,args,coverBefore){if(args===void 0){args=null;}if(coverBefore===void 0){coverBefore=true;}var timer=this.scene?this.scene.timer:ILaya.timer;timer._create(true,true,delay,caller,method,args,coverBefore);};_proto95.frameOnce=function frameOnce(delay,caller,method,args,coverBefore){if(args===void 0){args=null;}if(coverBefore===void 0){coverBefore=true;}var timer=this.scene?this.scene.timer:ILaya.timer;timer._create(true,false,delay,caller,method,args,coverBefore);};_proto95.clearTimer=function clearTimer(caller,method){var timer=this.scene?this.scene.timer:ILaya.timer;timer.clear(caller,method);};_proto95.callLater=function callLater(method,args){if(args===void 0){args=null;}var timer=this.scene?this.scene.timer:ILaya.timer;timer.callLater(this,method,args);};_proto95.runCallLater=function runCallLater(method){var timer=this.scene?this.scene.timer:ILaya.timer;timer.runCallLater(this,method);};_proto95._onActive=function _onActive(){Stat.spriteCount++;};_proto95._onInActive=function _onInActive(){Stat.spriteCount--;};_proto95._onActiveInScene=function _onActiveInScene(){};_proto95._onInActiveInScene=function _onInActiveInScene(){};_proto95._parse=function _parse(data,spriteMap){};_proto95._setBelongScene=function _setBelongScene(scene){if(!this._scene){this._scene=scene;this._onActiveInScene();for(var i=0,n=this._children.length;i<n;i++){this._children[i]._setBelongScene(scene);}}};_proto95._setUnBelongScene=function _setUnBelongScene(){if(this._scene!==this){this._onInActiveInScene();this._scene=null;for(var i=0,n=this._children.length;i<n;i++){this._children[i]._setUnBelongScene();}}};_proto95.onAwake=function onAwake(){};_proto95.onEnable=function onEnable(){};_proto95._processActive=function _processActive(){this._activeChangeScripts||(this._activeChangeScripts=[]);this._activeHierarchy(this._activeChangeScripts);this._activeScripts();};_proto95._activeHierarchy=function _activeHierarchy(activeChangeScripts){this._setBit(Const.ACTIVE_INHIERARCHY,true);if(this._components){for(var i=0,n=this._components.length;i<n;i++){var comp=this._components[i];if(comp._isScript())comp._enabled&&activeChangeScripts.push(comp);else comp._setActive(true);}}this._onActive();for(i=0,n=this._children.length;i<n;i++){var child=this._children[i];!child._getBit(Const.NOT_ACTIVE)&&!child._getBit(Const.NOT_READY)&&child._activeHierarchy(activeChangeScripts);}if(!this._getBit(Const.AWAKED)){this._setBit(Const.AWAKED,true);this.onAwake();}this.onEnable();};_proto95._activeScripts=function _activeScripts(){for(var i=0,n=this._activeChangeScripts.length;i<n;i++){var comp=this._activeChangeScripts[i];if(!comp._awaked){comp._awaked=true;comp._onAwake();}comp._onEnable();}this._activeChangeScripts.length=0;};_proto95._processInActive=function _processInActive(){this._activeChangeScripts||(this._activeChangeScripts=[]);this._inActiveHierarchy(this._activeChangeScripts);this._inActiveScripts();};_proto95._inActiveHierarchy=function _inActiveHierarchy(activeChangeScripts){this._onInActive();if(this._components){for(var i=0,n=this._components.length;i<n;i++){var comp=this._components[i];comp._setActive(false);comp._isScript()&&comp._enabled&&activeChangeScripts.push(comp);}}this._setBit(Const.ACTIVE_INHIERARCHY,false);for(i=0,n=this._children.length;i<n;i++){var child=this._children[i];child&&!child._getBit(Const.NOT_ACTIVE)&&child._inActiveHierarchy(activeChangeScripts);}this.onDisable();};_proto95._inActiveScripts=function _inActiveScripts(){for(var i=0,n=this._activeChangeScripts.length;i<n;i++){this._activeChangeScripts[i].onDisable();}this._activeChangeScripts.length=0;};_proto95.onDisable=function onDisable(){};_proto95._onAdded=function _onAdded(){if(this._activeChangeScripts&&this._activeChangeScripts.length!==0){throw "Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.";}else {var parentScene=this._parent.scene;parentScene&&this._setBelongScene(parentScene);this._parent.activeInHierarchy&&this.active&&this._processActive();}};_proto95._onRemoved=function _onRemoved(){if(this._activeChangeScripts&&this._activeChangeScripts.length!==0){throw "Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";}else {this._parent.activeInHierarchy&&this.active&&this._processInActive();this._parent.scene&&this._setUnBelongScene();}};_proto95._addComponentInstance=function _addComponentInstance(comp){this._components=this._components||[];this._components.push(comp);comp.owner=this;comp._onAdded();if(this.activeInHierarchy)comp._setActive(true);};_proto95._destroyComponent=function _destroyComponent(comp){if(this._components){for(var i=0,n=this._components.length;i<n;i++){var item=this._components[i];if(item===comp){item._destroy();this._components.splice(i,1);break;}}}};_proto95._destroyAllComponent=function _destroyAllComponent(){if(this._components){for(var i=0,n=this._components.length;i<n;i++){var item=this._components[i];item&&item._destroy();}this._components.length=0;}};_proto95._cloneTo=function _cloneTo(destObject,srcRoot,dstRoot){var destNode=destObject;if(this._components){for(var i=0,n=this._components.length;i<n;i++){var destComponent=destNode.addComponent(this._components[i].constructor);this._components[i]._cloneTo(destComponent);}}};_proto95.addComponentIntance=function addComponentIntance(component){if(component.owner)throw "Node:the component has belong to other node.";if(component.isSingleton&&this.getComponent(component.constructor))throw "Node:the component is singleton,can't add the second one.";this._addComponentInstance(component);return component;};_proto95.addComponent=function addComponent(componentType){var comp=Pool.createByClass(componentType);comp._destroyed=false;if(comp.isSingleton&&this.getComponent(componentType))throw "无法实例"+componentType+"组件"+"，"+componentType+"组件已存在！";this._addComponentInstance(comp);return comp;};_proto95.getComponent=function getComponent(componentType){if(this._components){for(var i=0,n=this._components.length;i<n;i++){var comp=this._components[i];if(comp instanceof componentType)return comp;}}return null;};_proto95.getComponents=function getComponents(componentType){var arr;if(this._components){for(var i=0,n=this._components.length;i<n;i++){var comp=this._components[i];if(comp instanceof componentType){arr=arr||[];arr.push(comp);}}}return arr;};_createClass(Node,[{key:"numChildren",get:function get(){return this._children.length;}},{key:"parent",get:function get(){return this._parent;}},{key:"displayedInStage",get:function get(){if(this._getBit(Const.DISPLAY))return this._getBit(Const.DISPLAYED_INSTAGE);this._setBitUp(Const.DISPLAY);return this._getBit(Const.DISPLAYED_INSTAGE);}},{key:"scene",get:function get(){return this._scene;}},{key:"active",get:function get(){return !this._getBit(Const.NOT_READY)&&!this._getBit(Const.NOT_ACTIVE);},set:function set(value){value=!!value;if(!this._getBit(Const.NOT_ACTIVE)!==value){if(this._activeChangeScripts&&this._activeChangeScripts.length!==0){if(value)throw "Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.";else throw "Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";}else {this._setBit(Const.NOT_ACTIVE,!value);if(this._parent){if(this._parent.activeInHierarchy){if(value)this._processActive();else this._processInActive();}}}}}},{key:"activeInHierarchy",get:function get(){return this._getBit(Const.ACTIVE_INHIERARCHY);}},{key:"timer",get:function get(){return this.scene?this.scene.timer:ILaya.timer;}}]);return Node;}(EventDispatcher);Node.ARRAY_EMPTY=[];ClassUtils.regClass("laya.display.Node",Node);ClassUtils.regClass("Laya.Node",Node);var Sprite=/*#__PURE__*/function(_Node){_inheritsLoose(Sprite,_Node);function Sprite(){var _this23;_this23=_Node.call(this)||this;_this23._x=0;_this23._y=0;_this23._width=0;_this23._height=0;_this23._visible=true;_this23._mouseState=0;_this23._zOrder=0;_this23._renderType=0;_this23._transform=null;_this23._tfChanged=false;_this23._repaint=SpriteConst.REPAINT_NONE;_this23._texture=null;_this23._style=SpriteStyle.EMPTY;_this23._cacheStyle=CacheStyle.EMPTY;_this23._boundStyle=null;_this23._graphics=null;_this23.mouseThrough=false;_this23.autoSize=false;_this23.hitTestPrior=false;return _this23;}var _proto96=Sprite.prototype;_proto96.destroy=function destroy(destroyChild){if(destroyChild===void 0){destroyChild=true;}_Node.prototype.destroy.call(this,destroyChild);this._style&&this._style.recover();this._cacheStyle&&this._cacheStyle.recover();this._boundStyle&&this._boundStyle.recover();this._style=null;this._cacheStyle=null;this._boundStyle=null;this._transform=null;if(this._graphics&&this._graphics.autoDestroy){this._graphics.destroy();}this._graphics=null;this.texture=null;};_proto96.updateZOrder=function updateZOrder(){Utils.updateOrder(this._children)&&this.repaint();};_proto96._getBoundsStyle=function _getBoundsStyle(){if(!this._boundStyle)this._boundStyle=BoundsStyle.create();return this._boundStyle;};_proto96._setCustomRender=function _setCustomRender(){};_proto96._setCacheAs=function _setCacheAs(value){};_proto96._checkCanvasEnable=function _checkCanvasEnable(){var tEnable=this._cacheStyle.needEnableCanvasRender();this._getCacheStyle().enableCanvasRender=tEnable;if(tEnable){if(this._cacheStyle.needBitmapCache()){this._cacheStyle.cacheAs="bitmap";}else {this._cacheStyle.cacheAs=this._cacheStyle.userSetCache;}this._cacheStyle.reCache=true;this._renderType|=SpriteConst.CANVAS;}else {this._cacheStyle.cacheAs="none";this._cacheStyle.releaseContext();this._renderType&=~SpriteConst.CANVAS;}this._setCacheAs(this._cacheStyle.cacheAs);this._setRenderType(this._renderType);};_proto96.reCache=function reCache(){this._cacheStyle.reCache=true;this._repaint|=SpriteConst.REPAINT_CACHE;};_proto96.getRepaint=function getRepaint(){return this._repaint;};_proto96._setX=function _setX(value){this._x=value;};_proto96._setY=function _setY(value){this._y=value;};_proto96._setWidth=function _setWidth(texture,value){};_proto96._setHeight=function _setHeight(texture,value){};_proto96.set_width=function set_width(value){if(this._width!==value){this._width=value;this._setWidth(this.texture,value);this._setTranformChange();}};_proto96.get_width=function get_width(){if(!this.autoSize)return this._width||(this.texture?this.texture.width:0);if(this.texture)return this.texture.width;if(!this._graphics&&this._children.length===0)return 0;return this.getSelfBounds().width;};_proto96.set_height=function set_height(value){if(this._height!==value){this._height=value;this._setHeight(this.texture,value);this._setTranformChange();}};_proto96.get_height=function get_height(){if(!this.autoSize)return this._height||(this.texture?this.texture.height:0);if(this.texture)return this.texture.height;if(!this._graphics&&this._children.length===0)return 0;return this.getSelfBounds().height;};_proto96.setSelfBounds=function setSelfBounds(bound){this._getBoundsStyle().userBounds=bound;};_proto96.getBounds=function getBounds(){return this._getBoundsStyle().bounds=Rectangle._getWrapRec(this._boundPointsToParent());};_proto96.getSelfBounds=function getSelfBounds(){if(this._boundStyle&&this._boundStyle.userBounds)return this._boundStyle.userBounds;if(!this._graphics&&this._children.length===0&&!this._texture)return Rectangle.TEMP.setTo(0,0,this.width,this.height);return this._getBoundsStyle().bounds=Rectangle._getWrapRec(this._getBoundPointsM(false));};_proto96._boundPointsToParent=function _boundPointsToParent(ifRotate){if(ifRotate===void 0){ifRotate=false;}var pX=0,pY=0;if(this._style){pX=this.pivotX;pY=this.pivotY;ifRotate=ifRotate||this._style.rotation!==0;if(this._style.scrollRect){pX+=this._style.scrollRect.x;pY+=this._style.scrollRect.y;}}var pList=this._getBoundPointsM(ifRotate);if(!pList||pList.length<1)return pList;if(pList.length!=8){pList=ifRotate?GrahamScan.scanPList(pList):Rectangle._getWrapRec(pList,Rectangle.TEMP)._getBoundPoints();}if(!this.transform){Utils.transPointList(pList,this._x-pX,this._y-pY);return pList;}var tPoint=Point.TEMP;var i,len=pList.length;for(i=0;i<len;i+=2){tPoint.x=pList[i];tPoint.y=pList[i+1];this.toParentPoint(tPoint);pList[i]=tPoint.x;pList[i+1]=tPoint.y;}return pList;};_proto96.getGraphicBounds=function getGraphicBounds(realSize){if(realSize===void 0){realSize=false;}if(!this._graphics)return Rectangle.TEMP.setTo(0,0,0,0);return this._graphics.getBounds(realSize);};_proto96._getBoundPointsM=function _getBoundPointsM(ifRotate){if(ifRotate===void 0){ifRotate=false;}if(this._boundStyle&&this._boundStyle.userBounds)return this._boundStyle.userBounds._getBoundPoints();if(!this._boundStyle)this._getBoundsStyle();if(!this._boundStyle.temBM)this._boundStyle.temBM=[];if(this._style.scrollRect){var rst=Utils.clearArray(this._boundStyle.temBM);var rec=Rectangle.TEMP;rec.copyFrom(this._style.scrollRect);Utils.concatArray(rst,rec._getBoundPoints());return rst;}var pList;if(this._graphics){pList=this._graphics.getBoundPoints();}else {pList=Utils.clearArray(this._boundStyle.temBM);if(this._texture){rec=Rectangle.TEMP;rec.setTo(0,0,this.width||this._texture.width,this.height||this._texture.height);Utils.concatArray(pList,rec._getBoundPoints());}}var child;var cList;var __childs;__childs=this._children;for(var i=0,n=__childs.length;i<n;i++){child=__childs[i];if(child instanceof Sprite&&child._visible===true){cList=child._boundPointsToParent(ifRotate);if(cList)pList=pList?Utils.concatArray(pList,cList):cList;}}return pList;};_proto96._getCacheStyle=function _getCacheStyle(){this._cacheStyle===CacheStyle.EMPTY&&(this._cacheStyle=CacheStyle.create());return this._cacheStyle;};_proto96.getStyle=function getStyle(){this._style===SpriteStyle.EMPTY&&(this._style=SpriteStyle.create());return this._style;};_proto96.setStyle=function setStyle(value){this._style=value;};_proto96._setScaleX=function _setScaleX(value){this._style.scaleX=value;};_proto96._setScaleY=function _setScaleY(value){this._style.scaleY=value;};_proto96.set_scaleX=function set_scaleX(value){var style=this.getStyle();if(style.scaleX!==value){this._setScaleX(value);this._setTranformChange();}};_proto96.get_scaleX=function get_scaleX(){return this._style.scaleX;};_proto96.set_scaleY=function set_scaleY(value){var style=this.getStyle();if(style.scaleY!==value){this._setScaleY(value);this._setTranformChange();}};_proto96.get_scaleY=function get_scaleY(){return this._style.scaleY;};_proto96._setRotation=function _setRotation(value){this._style.rotation=value;};_proto96._setSkewX=function _setSkewX(value){this._style.skewX=value;};_proto96._setSkewY=function _setSkewY(value){this._style.skewY=value;};_proto96._createTransform=function _createTransform(){return Matrix.create();};_proto96._adjustTransform=function _adjustTransform(){this._tfChanged=false;var style=this._style;var sx=style.scaleX,sy=style.scaleY;var sskx=style.skewX;var ssky=style.skewY;var rot=style.rotation;var m=this._transform||(this._transform=this._createTransform());if(rot||sx!==1||sy!==1||sskx!==0||ssky!==0){m._bTransform=true;var skx=(rot-sskx)*0.0174532922222222;var sky=(rot+ssky)*0.0174532922222222;var cx=Math.cos(sky);var ssx=Math.sin(sky);var cy=Math.sin(skx);var ssy=Math.cos(skx);m.a=sx*cx;m.b=sx*ssx;m.c=-sy*cy;m.d=sy*ssy;m.tx=m.ty=0;}else {m.identity();this._renderType&=~SpriteConst.TRANSFORM;this._setRenderType(this._renderType);}return m;};_proto96._setTransform=function _setTransform(value){};_proto96.get_transform=function get_transform(){return this._tfChanged?this._adjustTransform():this._transform;};_proto96.set_transform=function set_transform(value){this._tfChanged=false;var m=this._transform||(this._transform=this._createTransform());value.copyTo(m);this._setTransform(m);if(value){this._x=m.tx;this._y=m.ty;m.tx=m.ty=0;}if(value)this._renderType|=SpriteConst.TRANSFORM;else {this._renderType&=~SpriteConst.TRANSFORM;}this._setRenderType(this._renderType);this.parentRepaint();};_proto96._setPivotX=function _setPivotX(value){var style=this.getStyle();style.pivotX=value;};_proto96._getPivotX=function _getPivotX(){return this._style.pivotX;};_proto96._setPivotY=function _setPivotY(value){var style=this.getStyle();style.pivotY=value;};_proto96._getPivotY=function _getPivotY(){return this._style.pivotY;};_proto96._setAlpha=function _setAlpha(value){if(this._style.alpha!==value){var style=this.getStyle();style.alpha=value;if(value!==1)this._renderType|=SpriteConst.ALPHA;else this._renderType&=~SpriteConst.ALPHA;this._setRenderType(this._renderType);this.parentRepaint();}};_proto96._getAlpha=function _getAlpha(){return this._style.alpha;};_proto96.get_visible=function get_visible(){return this._visible;};_proto96.set_visible=function set_visible(value){if(this._visible!==value){this._visible=value;this.parentRepaint(SpriteConst.REPAINT_ALL);}};_proto96._setBlendMode=function _setBlendMode(value){};_proto96._setGraphics=function _setGraphics(value){};_proto96._setGraphicsCallBack=function _setGraphicsCallBack(){};_proto96._setScrollRect=function _setScrollRect(value){};_proto96.pos=function pos(x,y,speedMode){if(speedMode===void 0){speedMode=false;}if(this._x!==x||this._y!==y){if(this.destroyed)return this;if(speedMode){this._setX(x);this._setY(y);this.parentRepaint(SpriteConst.REPAINT_CACHE);var p=this._cacheStyle.maskParent;if(p){p.repaint(SpriteConst.REPAINT_CACHE);}}else {this.x=x;this.y=y;}}return this;};_proto96.pivot=function pivot(x,y){this.pivotX=x;this.pivotY=y;return this;};_proto96.size=function size(width,height){this.width=width;this.height=height;return this;};_proto96.scale=function scale(scaleX,scaleY,speedMode){if(speedMode===void 0){speedMode=false;}var style=this.getStyle();if(style.scaleX!=scaleX||style.scaleY!=scaleY){if(this.destroyed)return this;if(speedMode){this._setScaleX(scaleX);this._setScaleY(scaleY);this._setTranformChange();}else {this.scaleX=scaleX;this.scaleY=scaleY;}}return this;};_proto96.skew=function skew(skewX,skewY){this.skewX=skewX;this.skewY=skewY;return this;};_proto96.render=function render(ctx,x,y){RenderSprite.renders[this._renderType]._fun(this,ctx,x+this._x,y+this._y);this._repaint=0;};_proto96.drawToCanvas=function drawToCanvas(canvasWidth,canvasHeight,offsetX,offsetY){return Sprite.drawToCanvas(this,this._renderType,canvasWidth,canvasHeight,offsetX,offsetY);};_proto96.drawToTexture=function drawToTexture(canvasWidth,canvasHeight,offsetX,offsetY,rt){if(rt===void 0){rt=null;}return Sprite.drawToTexture(this,this._renderType,canvasWidth,canvasHeight,offsetX,offsetY,rt);};_proto96.drawToTexture3D=function drawToTexture3D(offx,offy,tex){throw 'not implement';};Sprite.drawToCanvas=function drawToCanvas(sprite,_renderType,canvasWidth,canvasHeight,offsetX,offsetY){offsetX-=sprite.x;offsetY-=sprite.y;offsetX|=0;offsetY|=0;canvasWidth|=0;canvasHeight|=0;var ctx=new Context();ctx.size(canvasWidth,canvasHeight);ctx.asBitmap=true;ctx._targets.start();ctx._targets.clear(0,0,0,0);RenderSprite.renders[_renderType]._fun(sprite,ctx,offsetX,offsetY);ctx.flush();ctx._targets.end();ctx._targets.restore();var dt=ctx._targets.getData(0,0,canvasWidth,canvasHeight);ctx.destroy();var imgdata=new ImageData(canvasWidth,canvasHeight);var lineLen=canvasWidth*4;var dst=imgdata.data;var y=canvasHeight-1;var off=y*lineLen;var srcoff=0;for(;y>=0;y--){dst.set(dt.subarray(srcoff,srcoff+lineLen),off);off-=lineLen;srcoff+=lineLen;}var canv=new HTMLCanvas(true);canv.size(canvasWidth,canvasHeight);var ctx2d=canv.getContext('2d');ctx2d.putImageData(imgdata,0,0);return canv;};Sprite.drawToTexture=function drawToTexture(sprite,_renderType,canvasWidth,canvasHeight,offsetX,offsetY,rt){if(rt===void 0){rt=null;}if(!Sprite.drawtocanvCtx){Sprite.drawtocanvCtx=new Context();}offsetX-=sprite.x;offsetY-=sprite.y;offsetX|=0;offsetY|=0;canvasWidth|=0;canvasHeight|=0;var ctx=rt?Sprite.drawtocanvCtx:new Context();ctx.clear();ctx.size(canvasWidth,canvasHeight);if(rt){ctx._targets=rt;}else {ctx.asBitmap=true;}if(ctx._targets){ctx._targets.start();ctx._targets.clear(0,0,0,0);RenderSprite.renders[_renderType]._fun(sprite,ctx,offsetX,offsetY);ctx.flush();ctx._targets.end();ctx._targets.restore();}if(!rt){var rtex=new Texture(ctx._targets,Texture.INV_UV);ctx.destroy(true);return rtex;}sprite._repaint=0;return rt;};_proto96.customRender=function customRender(context,x,y){this._repaint=SpriteConst.REPAINT_ALL;};_proto96._applyFilters=function _applyFilters(){};_proto96._setColorFilter=function _setColorFilter(value){};_proto96._isHaveGlowFilter=function _isHaveGlowFilter(){var i,len;if(this.filters){for(i=0;i<this.filters.length;i++){if(this.filters[i].type==Filter.GLOW){return true;}}}for(i=0,len=this._children.length;i<len;i++){if(this._children[i]._isHaveGlowFilter()){return true;}}return false;};_proto96.localToGlobal=function localToGlobal(point,createNewPoint,globalNode){if(createNewPoint===void 0){createNewPoint=false;}if(globalNode===void 0){globalNode=null;}if(createNewPoint===true){point=new Point(point.x,point.y);}var ele=this;globalNode=globalNode||ILaya.stage;while(ele&&!ele.destroyed){if(ele==globalNode)break;point=ele.toParentPoint(point);ele=ele.parent;}return point;};_proto96.globalToLocal=function globalToLocal(point,createNewPoint,globalNode){if(createNewPoint===void 0){createNewPoint=false;}if(globalNode===void 0){globalNode=null;}if(createNewPoint){point=new Point(point.x,point.y);}var ele=this;var list=[];globalNode=globalNode||ILaya.stage;while(ele&&!ele.destroyed){if(ele==globalNode)break;list.push(ele);ele=ele.parent;}var i=list.length-1;while(i>=0){ele=list[i];point=ele.fromParentPoint(point);i--;}return point;};_proto96.toParentPoint=function toParentPoint(point){if(!point)return point;point.x-=this.pivotX;point.y-=this.pivotY;if(this.transform){this._transform.transformPoint(point);}point.x+=this._x;point.y+=this._y;var scroll=this._style.scrollRect;if(scroll){point.x-=scroll.x;point.y-=scroll.y;}return point;};_proto96.fromParentPoint=function fromParentPoint(point){if(!point)return point;point.x-=this._x;point.y-=this._y;var scroll=this._style.scrollRect;if(scroll){point.x+=scroll.x;point.y+=scroll.y;}if(this.transform){this._transform.invertTransformPoint(point);}point.x+=this.pivotX;point.y+=this.pivotY;return point;};_proto96.fromStagePoint=function fromStagePoint(point){return point;};_proto96.on=function on(type,caller,listener,args){if(args===void 0){args=null;}if(this._mouseState!==1&&this.isMouseEvent(type)){this.mouseEnabled=true;this._setBit(Const.HAS_MOUSE,true);if(this._parent){this._onDisplay();}return this._createListener(type,caller,listener,args,false);}return _Node.prototype.on.call(this,type,caller,listener,args);};_proto96.once=function once(type,caller,listener,args){if(args===void 0){args=null;}if(this._mouseState!==1&&this.isMouseEvent(type)){this.mouseEnabled=true;this._setBit(Const.HAS_MOUSE,true);if(this._parent){this._onDisplay();}return this._createListener(type,caller,listener,args,true);}return _Node.prototype.once.call(this,type,caller,listener,args);};_proto96._onDisplay=function _onDisplay(v){if(this._mouseState!==1){var ele=this;ele=ele.parent;while(ele&&ele._mouseState!==1){if(ele._getBit(Const.HAS_MOUSE))break;ele.mouseEnabled=true;ele._setBit(Const.HAS_MOUSE,true);ele=ele.parent;}}};_proto96._setParent=function _setParent(value){_Node.prototype._setParent.call(this,value);if(value&&this._getBit(Const.HAS_MOUSE)){this._onDisplay();}};_proto96.loadImage=function loadImage(url,complete){if(complete===void 0){complete=null;}if(!url){this.texture=null;loaded.call(this);}else {var tex=ILaya.Loader.textureMap[URL.formatURL(url)];if(!tex){tex=new Texture();tex.load(url);ILaya.Loader.cacheTexture(url,tex);}this.texture=tex;if(!tex.getIsReady())tex.once(Event.READY,this,loaded);else loaded.call(this);}function loaded(){this.repaint(SpriteConst.REPAINT_ALL);complete&&complete.run();}return this;};Sprite.fromImage=function fromImage(url){return new Sprite().loadImage(url);};_proto96.repaint=function repaint(type){if(type===void 0){type=SpriteConst.REPAINT_CACHE;}if(!(this._repaint&type)){this._repaint|=type;this.parentRepaint(type);}if(this._cacheStyle&&this._cacheStyle.maskParent){this._cacheStyle.maskParent.repaint(type);}};_proto96._needRepaint=function _needRepaint(){return this._repaint&SpriteConst.REPAINT_CACHE&&this._cacheStyle.enableCanvasRender&&this._cacheStyle.reCache;};_proto96._childChanged=function _childChanged(child){if(child===void 0){child=null;}if(this._children.length)this._renderType|=SpriteConst.CHILDS;else this._renderType&=~SpriteConst.CHILDS;this._setRenderType(this._renderType);if(child&&this._getBit(Const.HAS_ZORDER))ILaya.systemTimer.callLater(this,this.updateZOrder);this.repaint(SpriteConst.REPAINT_ALL);};_proto96.parentRepaint=function parentRepaint(type){if(type===void 0){type=SpriteConst.REPAINT_CACHE;}var p=this._parent;if(p&&!(p._repaint&type)){p._repaint|=type;p.parentRepaint(type);}};_proto96._setMask=function _setMask(value){};_proto96.startDrag=function startDrag(area,hasInertia,elasticDistance,elasticBackTime,data,disableMouseEvent,ratio){if(area===void 0){area=null;}if(hasInertia===void 0){hasInertia=false;}if(elasticDistance===void 0){elasticDistance=0;}if(elasticBackTime===void 0){elasticBackTime=300;}if(data===void 0){data=null;}if(disableMouseEvent===void 0){disableMouseEvent=false;}if(ratio===void 0){ratio=0.92;}this._style.dragging||(this.getStyle().dragging=new ILaya.Dragging());this._style.dragging.start(this,area,hasInertia,elasticDistance,elasticBackTime,data,disableMouseEvent,ratio);};_proto96.stopDrag=function stopDrag(){this._style.dragging&&this._style.dragging.stop();};_proto96._setDisplay=function _setDisplay(value){if(!value){if(this._cacheStyle){this._cacheStyle.releaseContext();this._cacheStyle.releaseFilterCache();if(this._cacheStyle.hasGlowFilter){this._cacheStyle.hasGlowFilter=false;}}}_Node.prototype._setDisplay.call(this,value);};_proto96.hitTestPoint=function hitTestPoint(x,y){var point=this.globalToLocal(Point.TEMP.setTo(x,y));x=point.x;y=point.y;var rect=this._style.hitArea?this._style.hitArea:this._width>0&&this._height>0?Rectangle.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds();return rect.contains(x,y);};_proto96.getMousePoint=function getMousePoint(){return this.globalToLocal(Point.TEMP.setTo(ILaya.stage.mouseX,ILaya.stage.mouseY));};_proto96._setTexture=function _setTexture(value){};_proto96._setRenderType=function _setRenderType(type){};_proto96._setTranformChange=function _setTranformChange(){this._tfChanged=true;this._renderType|=SpriteConst.TRANSFORM;this.parentRepaint(SpriteConst.REPAINT_CACHE);};_proto96._setBgStyleColor=function _setBgStyleColor(x,y,width,height,fillColor){};_proto96._setBorderStyleColor=function _setBorderStyleColor(x,y,width,height,fillColor,borderWidth){};_proto96.captureMouseEvent=function captureMouseEvent(exclusive){ILaya.MouseManager.instance.setCapture(this,exclusive);};_proto96.releaseMouseEvent=function releaseMouseEvent(){ILaya.MouseManager.instance.releaseCapture();};_createClass(Sprite,[{key:"customRenderEnable",set:function set(b){if(b){this._renderType|=SpriteConst.CUSTOM;this._setRenderType(this._renderType);this._setCustomRender();}}},{key:"cacheAs",get:function get(){return this._cacheStyle.cacheAs;},set:function set(value){if(value===this._cacheStyle.userSetCache)return;if(this.mask&&value==='normal')return;this._setCacheAs(value);this._getCacheStyle().userSetCache=value;this._checkCanvasEnable();this.repaint();}},{key:"staticCache",get:function get(){return this._cacheStyle.staticCache;},set:function set(value){this._getCacheStyle().staticCache=value;if(!value)this.reCache();}},{key:"x",get:function get(){return this._x;},set:function set(value){if(this.destroyed)return;if(this._x!==value){this._setX(value);this.parentRepaint(SpriteConst.REPAINT_CACHE);var p=this._cacheStyle.maskParent;if(p){p.repaint(SpriteConst.REPAINT_CACHE);}}}},{key:"y",get:function get(){return this._y;},set:function set(value){if(this.destroyed)return;if(this._y!==value){this._setY(value);this.parentRepaint(SpriteConst.REPAINT_CACHE);var p=this._cacheStyle.maskParent;if(p){p.repaint(SpriteConst.REPAINT_CACHE);}}}},{key:"width",get:function get(){return this.get_width();},set:function set(value){this.set_width(value);}},{key:"height",get:function get(){return this.get_height();},set:function set(value){this.set_height(value);}},{key:"displayWidth",get:function get(){return this.width*this.scaleX;}},{key:"displayHeight",get:function get(){return this.height*this.scaleY;}},{key:"scaleX",get:function get(){return this._style.scaleX;},set:function set(value){this.set_scaleX(value);}},{key:"scaleY",get:function get(){return this._style.scaleY;},set:function set(value){this.set_scaleY(value);}},{key:"rotation",get:function get(){return this._style.rotation;},set:function set(value){var style=this.getStyle();if(style.rotation!==value){this._setRotation(value);this._setTranformChange();}}},{key:"skewX",get:function get(){return this._style.skewX;},set:function set(value){var style=this.getStyle();if(style.skewX!==value){this._setSkewX(value);this._setTranformChange();}}},{key:"skewY",get:function get(){return this._style.skewY;},set:function set(value){var style=this.getStyle();if(style.skewY!==value){this._setSkewY(value);this._setTranformChange();}}},{key:"transform",get:function get(){return this._tfChanged?this._adjustTransform():this._transform;},set:function set(value){this.set_transform(value);}},{key:"pivotX",get:function get(){return this._getPivotX();},set:function set(value){this._setPivotX(value);this.repaint();}},{key:"pivotY",get:function get(){return this._getPivotY();},set:function set(value){this._setPivotY(value);this.repaint();}},{key:"alpha",get:function get(){return this._getAlpha();},set:function set(value){value=value<0?0:value>1?1:value;this._setAlpha(value);}},{key:"visible",get:function get(){return this.get_visible();},set:function set(value){this.set_visible(value);}},{key:"blendMode",get:function get(){return this._style.blendMode;},set:function set(value){this._setBlendMode(value);this.getStyle().blendMode=value;if(value&&value!="source-over")this._renderType|=SpriteConst.BLEND;else this._renderType&=~SpriteConst.BLEND;this._setRenderType(this._renderType);this.parentRepaint();}},{key:"graphics",get:function get(){if(!this._graphics){this.graphics=new Graphics();this._graphics.autoDestroy=true;}return this._graphics;},set:function set(value){if(this._graphics)this._graphics._sp=null;this._graphics=value;if(value){this._setGraphics(value);this._renderType|=SpriteConst.GRAPHICS;value._sp=this;}else {this._renderType&=~SpriteConst.GRAPHICS;}this._setRenderType(this._renderType);this.repaint();}},{key:"scrollRect",get:function get(){return this._style.scrollRect;},set:function set(value){this.getStyle().scrollRect=value;this._setScrollRect(value);this.repaint();if(value){this._renderType|=SpriteConst.CLIP;}else {this._renderType&=~SpriteConst.CLIP;}this._setRenderType(this._renderType);}},{key:"filters",get:function get(){return this._cacheStyle.filters;},set:function set(value){value&&value.length===0&&(value=null);if(this._cacheStyle.filters==value)return;this._getCacheStyle().filters=value?value.slice():null;if(value&&value.length){this._setColorFilter(value[0]);this._renderType|=SpriteConst.FILTERS;}else {this._setColorFilter(null);this._renderType&=~SpriteConst.FILTERS;}this._setRenderType(this._renderType);if(value&&value.length>0){if(!this._getBit(Const.DISPLAY))this._setBitUp(Const.DISPLAY);if(!(value.length==1&&value[0]instanceof ColorFilter)){this._getCacheStyle().cacheForFilters=true;this._checkCanvasEnable();}}else {if(this._cacheStyle.cacheForFilters){this._cacheStyle.cacheForFilters=false;this._checkCanvasEnable();}}this._getCacheStyle().hasGlowFilter=this._isHaveGlowFilter();this.repaint();}},{key:"stage",get:function get(){return ILaya.stage;}},{key:"hitArea",get:function get(){return this._style.hitArea;},set:function set(value){this.getStyle().hitArea=value;}},{key:"mask",get:function get(){return this._cacheStyle.mask;},set:function set(value){if(value&&this.mask&&this.mask._cacheStyle.maskParent)return;this._getCacheStyle().mask=value;this._setMask(value);this._checkCanvasEnable();if(value){value._getCacheStyle().maskParent=this;}else {if(this.mask){this.mask._getCacheStyle().maskParent=null;}}this._renderType|=SpriteConst.MASK;this._setRenderType(this._renderType);this.parentRepaint(SpriteConst.REPAINT_ALL);}},{key:"mouseEnabled",get:function get(){return this._mouseState>1;},set:function set(value){this._mouseState=value?2:1;}},{key:"globalScaleX",get:function get(){var scale=1;var ele=this;while(ele){if(ele===ILaya.stage)break;scale*=ele.scaleX;ele=ele.parent;}return scale;}},{key:"globalRotation",get:function get(){var angle=0;var ele=this;while(ele){if(ele===ILaya.stage)break;angle+=ele.rotation;ele=ele.parent;}return angle;}},{key:"globalScaleY",get:function get(){var scale=1;var ele=this;while(ele){if(ele===ILaya.stage)break;scale*=ele.scaleY;ele=ele.parent;}return scale;}},{key:"mouseX",get:function get(){return this.getMousePoint().x;}},{key:"mouseY",get:function get(){return this.getMousePoint().y;}},{key:"zOrder",get:function get(){return this._zOrder;},set:function set(value){if(this._zOrder!=value){this._zOrder=value;if(this._parent){value&&this._parent._setBit(Const.HAS_ZORDER,true);ILaya.systemTimer.callLater(this._parent,this.updateZOrder);}}}},{key:"texture",get:function get(){return this._texture;},set:function set(value){if(typeof value=='string'){this.loadImage(value);}else if(this._texture!=value){this._texture&&this._texture._removeReference();this._texture=value;value&&value._addReference();this._setTexture(value);this._setWidth(this._texture,this.width);this._setHeight(this._texture,this.height);if(value)this._renderType|=SpriteConst.TEXTURE;else this._renderType&=~SpriteConst.TEXTURE;this._setRenderType(this._renderType);this.repaint();}}},{key:"viewport",get:function get(){return this._style.viewport;},set:function set(value){if(typeof value=='string'){var recArr;recArr=value.split(",");if(recArr.length>3){value=new Rectangle(parseFloat(recArr[0]),parseFloat(recArr[1]),parseFloat(recArr[2]),parseFloat(recArr[3]));}}this.getStyle().viewport=value;}},{key:"drawCallOptimize",set:function set(value){this._setBit(Const.DRAWCALL_OPTIMIZE,value);},get:function get(){return this._getBit(Const.DRAWCALL_OPTIMIZE);}}]);return Sprite;}(Node);ClassUtils.regClass("laya.display.Sprite",Sprite);ClassUtils.regClass("Laya.Sprite",Sprite);var TextStyle=/*#__PURE__*/function(_SpriteStyle){_inheritsLoose(TextStyle,_SpriteStyle);function TextStyle(){var _this24;_this24=_SpriteStyle.apply(this,arguments)||this;_this24.italic=false;return _this24;}var _proto97=TextStyle.prototype;_proto97.reset=function reset(){_SpriteStyle.prototype.reset.call(this);this.italic=false;this.align="left";this.wordWrap=false;this.leading=0;this.padding=[0,0,0,0];this.bgColor=null;this.borderColor=null;this.asPassword=false;this.stroke=0;this.strokeColor="#000000";this.bold=false;this.underline=false;this.underlineColor=null;this.currBitmapFont=null;return this;};_proto97.recover=function recover(){if(this===TextStyle.EMPTY)return;Pool.recover("TextStyle",this.reset());};TextStyle.create=function create(){return Pool.getItemByClass("TextStyle",TextStyle);};_proto97.render=function render(sprite,context,x,y){(this.bgColor||this.borderColor)&&context.drawRect(x,y,sprite.width,sprite.height,this.bgColor,this.borderColor,1);};return TextStyle;}(SpriteStyle);TextStyle.EMPTY=new TextStyle();var Text=/*#__PURE__*/function(_Sprite){_inheritsLoose(Text,_Sprite);function Text(){var _this25;_this25=_Sprite.call(this)||this;_this25._textWidth=0;_this25._textHeight=0;_this25._lines=[];_this25._lineWidths=[];_this25._startX=0;_this25._startY=0;_this25._charSize={};_this25._valign="top";_this25._fontSize=Text.defaultFontSize;_this25._font=Text.defaultFont;_this25._color="#000000";_this25._singleCharRender=false;_this25.overflow=Text.VISIBLE;_this25._style=TextStyle.EMPTY;return _this25;}Text.defaultFontStr=function defaultFontStr(){return Text.defaultFontSize+"px "+Text.defaultFont;};var _proto98=Text.prototype;_proto98.getStyle=function getStyle(){this._style===TextStyle.EMPTY&&(this._style=TextStyle.create());return this._style;};_proto98._getTextStyle=function _getTextStyle(){if(this._style===TextStyle.EMPTY){this._style=TextStyle.create();}return this._style;};Text.registerBitmapFont=function registerBitmapFont(name,bitmapFont){Text._bitmapFonts||(Text._bitmapFonts={});Text._bitmapFonts[name]=bitmapFont;};Text.unregisterBitmapFont=function unregisterBitmapFont(name,destroy){if(destroy===void 0){destroy=true;}if(Text._bitmapFonts&&Text._bitmapFonts[name]){var tBitmapFont=Text._bitmapFonts[name];if(destroy)tBitmapFont.destroy();delete Text._bitmapFonts[name];}};_proto98.destroy=function destroy(destroyChild){if(destroyChild===void 0){destroyChild=true;}_Sprite.prototype.destroy.call(this,destroyChild);this._clipPoint=null;this._lines=null;this._lineWidths=null;this._words&&this._words.forEach(function(w){w.cleanCache();});this._words=null;this._charSize=null;};_proto98._getBoundPointsM=function _getBoundPointsM(ifRotate){var rec=Rectangle.TEMP;rec.setTo(0,0,this.width,this.height);return rec._getBoundPoints();};_proto98.getGraphicBounds=function getGraphicBounds(realSize){var rec=Rectangle.TEMP;rec.setTo(0,0,this.width,this.height);return rec;};_proto98._getCSSStyle=function _getCSSStyle(){return this._style;};_proto98.get_text=function get_text(){return this._text||"";};_proto98.set_text=function set_text(value){if(this._text!==value){this.lang(value+"");this.isChanged=true;this.event(Event.CHANGE);if(this.borderColor){this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1);}}};_proto98.lang=function lang(text,arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10){if(arg1===void 0){arg1=null;}if(arg2===void 0){arg2=null;}if(arg3===void 0){arg3=null;}if(arg4===void 0){arg4=null;}if(arg5===void 0){arg5=null;}if(arg6===void 0){arg6=null;}if(arg7===void 0){arg7=null;}if(arg8===void 0){arg8=null;}if(arg9===void 0){arg9=null;}if(arg10===void 0){arg10=null;}text=Text.langPacks&&Text.langPacks[text]?Text.langPacks[text]:text;if(arguments.length<2){this._text=text;}else {for(var i=0,n=arguments.length;i<n;i++){text=text.replace("{"+i+"}",arguments[i+1]);}this._text=text;}};_proto98.get_color=function get_color(){return this._color;};_proto98.set_color=function set_color(value){if(this._color!=value){this._color=value;if(!this._isChanged&&this._graphics){this._graphics.replaceTextColor(this.color);}else {this.isChanged=true;}}};_proto98.set_bgColor=function set_bgColor(value){this._getTextStyle().bgColor=value;this._renderType|=SpriteConst.STYLE;this._setBgStyleColor(0,0,this.width,this.height,value);this._setRenderType(this._renderType);this.isChanged=true;};_proto98.get_bgColor=function get_bgColor(){return this._style.bgColor;};_proto98._getContextFont=function _getContextFont(){return (this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(ILaya.Browser.onIPhone?Text.fontFamilyMap[this.font]||this.font:this.font);};_proto98._isPassWordMode=function _isPassWordMode(){var style=this._style;var password=style.asPassword;if("prompt"in this&&this['prompt']==this._text)password=false;return password;};_proto98._getPassWordTxt=function _getPassWordTxt(txt){var len=txt.length;var word;word="";for(var j=len;j>0;j--){word+="●";}return word;};_proto98._renderText=function _renderText(){var padding=this.padding;var visibleLineCount=this._lines.length;if(this.overflow!=Text.VISIBLE){visibleLineCount=Math.min(visibleLineCount,Math.floor((this.height-padding[0]-padding[2])/(this.leading+this._charSize.height))+1);}var beginLine=this.scrollY/(this._charSize.height+this.leading)|0;var graphics=this.graphics;graphics.clear(true);var ctxFont=this._getContextFont();ILaya.Browser.context.font=ctxFont;var startX=padding[3];var textAlgin="left";var lines=this._lines;var lineHeight=this.leading+this._charSize.height;var tCurrBitmapFont=this._style.currBitmapFont;if(tCurrBitmapFont){lineHeight=this.leading+tCurrBitmapFont.getMaxHeight();}var startY=padding[0];if(!tCurrBitmapFont&&this._width>0&&this._textWidth<=this._width){if(this.align=="right"){textAlgin="right";startX=this._width-padding[1];}else if(this.align=="center"){textAlgin="center";startX=this._width*0.5+padding[3]-padding[1];}}if(this._height>0){var tempVAlign=this._textHeight>this._height?"top":this.valign;if(tempVAlign==="middle")startY=(this._height-visibleLineCount*lineHeight)*0.5+padding[0]-padding[2];else if(tempVAlign==="bottom")startY=this._height-visibleLineCount*lineHeight-padding[2];}var style=this._style;if(tCurrBitmapFont&&tCurrBitmapFont.autoScaleSize){var bitmapScale=tCurrBitmapFont.fontSize/this.fontSize;}if(this._clipPoint){graphics.save();if(tCurrBitmapFont&&tCurrBitmapFont.autoScaleSize){var tClipWidth;var tClipHeight;this._width?tClipWidth=this._width-padding[3]-padding[1]:tClipWidth=this._textWidth;this._height?tClipHeight=this._height-padding[0]-padding[2]:tClipHeight=this._textHeight;tClipWidth*=bitmapScale;tClipHeight*=bitmapScale;graphics.clipRect(padding[3],padding[0],tClipWidth,tClipHeight);}else {graphics.clipRect(padding[3],padding[0],this._width?this._width-padding[3]-padding[1]:this._textWidth,this._height?this._height-padding[0]-padding[2]:this._textHeight);}this.repaint();}var password=style.asPassword;if("prompt"in this&&this['prompt']==this._text)password=false;var x=0,y=0;var end=Math.min(this._lines.length,visibleLineCount+beginLine)||1;for(var i=beginLine;i<end;i++){var word=lines[i];var _word;if(password){var len=word.length;word="";for(var j=len;j>0;j--){word+="●";}}if(word==null)word="";x=startX-(this._clipPoint?this._clipPoint.x:0);y=startY+lineHeight*i-(this._clipPoint?this._clipPoint.y:0);this.underline&&this._drawUnderline(textAlgin,x,y,i);if(tCurrBitmapFont){var tWidth=this.width;if(tCurrBitmapFont.autoScaleSize){tWidth=this.width*bitmapScale;}tCurrBitmapFont._drawText(word,this,x,y,this.align,tWidth);}else {this._words||(this._words=[]);if(this._words.length>i-beginLine){_word=this._words[i-beginLine];}else {_word=new WordText();this._words.push(_word);}_word.setText(word);_word.splitRender=this._singleCharRender;style.stroke?graphics.fillBorderText(_word,x,y,ctxFont,this.color,textAlgin,style.stroke,style.strokeColor):graphics.fillText(_word,x,y,ctxFont,this.color,textAlgin);}}if(tCurrBitmapFont&&tCurrBitmapFont.autoScaleSize){var tScale=1/bitmapScale;this.scale(tScale,tScale);}if(this._clipPoint)graphics.restore();this._startX=startX;this._startY=startY;};_proto98._drawUnderline=function _drawUnderline(align,x,y,lineIndex){var lineWidth=this._lineWidths[lineIndex];switch(align){case'center':x-=lineWidth/2;break;case'right':x-=lineWidth;break;}y+=this._charSize.height;this._graphics.drawLine(x,y,x+lineWidth,y,this.underlineColor||this.color,1);};_proto98.typeset=function typeset(){this._isChanged=false;if(!this._text){this._clipPoint=null;this._textWidth=this._textHeight=0;this.graphics.clear(true);return;}if(ILaya.Render.isConchApp){window.conchTextCanvas.font=this._getContextFont();}else {ILaya.Browser.context.font=this._getContextFont();}this._lines.length=0;this._lineWidths.length=0;if(this._isPassWordMode()){this._parseLines(this._getPassWordTxt(this._text));}else this._parseLines(this._text);this._evalTextSize();if(this._checkEnabledViewportOrNot())this._clipPoint||(this._clipPoint=new Point(0,0));else this._clipPoint=null;this._renderText();};_proto98._evalTextSize=function _evalTextSize(){var nw,nh;nw=Math.max.apply(this,this._lineWidths);if(this._style.currBitmapFont)nh=this._lines.length*(this._style.currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2];else nh=this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2];if(nw!=this._textWidth||nh!=this._textHeight){this._textWidth=nw;this._textHeight=nh;}};_proto98._checkEnabledViewportOrNot=function _checkEnabledViewportOrNot(){return this.overflow==Text.SCROLL&&(this._width>0&&this._textWidth>this._width||this._height>0&&this._textHeight>this._height);};_proto98.changeText=function changeText(text){if(this._text!==text){this.lang(text+"");if(this._graphics&&this._graphics.replaceText(this._text));else {this.typeset();}}};_proto98._parseLines=function _parseLines(text){var needWordWrapOrTruncate=this.wordWrap||this.overflow==Text.HIDDEN;if(needWordWrapOrTruncate){var wordWrapWidth=this._getWordWrapWidth();}var bitmapFont=this._style.currBitmapFont;if(bitmapFont){this._charSize.width=bitmapFont.getMaxWidth();this._charSize.height=bitmapFont.getMaxHeight();}else {var measureResult=null;if(ILaya.Render.isConchApp){measureResult=window.conchTextCanvas.measureText(Text._testWord);}else {measureResult=ILaya.Browser.context.measureText(Text._testWord);}if(!measureResult)measureResult={width:100};this._charSize.width=measureResult.width;this._charSize.height=measureResult.height||this.fontSize;}var lines=text.replace(/\r\n/g,"\n").split("\n");for(var i=0,n=lines.length;i<n;i++){var line=lines[i];if(needWordWrapOrTruncate)this._parseLine(line,wordWrapWidth);else {this._lineWidths.push(this._getTextWidth(line));this._lines.push(line);}}};_proto98._parseLine=function _parseLine(line,wordWrapWidth){var lines=this._lines;var maybeIndex=0;var charsWidth=0;var wordWidth=0;var startIndex=0;charsWidth=this._getTextWidth(line);if(charsWidth<=wordWrapWidth){lines.push(line);this._lineWidths.push(charsWidth);return;}charsWidth=this._charSize.width;maybeIndex=Math.floor(wordWrapWidth/charsWidth);maybeIndex==0&&(maybeIndex=1);charsWidth=this._getTextWidth(line.substring(0,maybeIndex));wordWidth=charsWidth;for(var j=maybeIndex,m=line.length;j<m;j++){charsWidth=this._getTextWidth(line.charAt(j));wordWidth+=charsWidth;if(wordWidth>wordWrapWidth){if(this.wordWrap){var newLine=line.substring(startIndex,j);if(newLine.charCodeAt(newLine.length-1)<255){var execResult=/(?:\w|-)+$/.exec(newLine);if(execResult){j=execResult.index+startIndex;if(execResult.index==0)j+=newLine.length;else newLine=line.substring(startIndex,j);}}lines.push(newLine);this._lineWidths.push(wordWidth-charsWidth);startIndex=j;if(j+maybeIndex<m){j+=maybeIndex;charsWidth=this._getTextWidth(line.substring(startIndex,j));wordWidth=charsWidth;j--;}else {lines.push(line.substring(startIndex,m));this._lineWidths.push(this._getTextWidth(lines[lines.length-1]));startIndex=-1;break;}}else if(this.overflow==Text.HIDDEN){lines.push(line.substring(0,j));this._lineWidths.push(this._getTextWidth(lines[lines.length-1]));return;}}}if(this.wordWrap&&startIndex!=-1){lines.push(line.substring(startIndex,m));this._lineWidths.push(this._getTextWidth(lines[lines.length-1]));}};_proto98._getTextWidth=function _getTextWidth(text){var bitmapFont=this._style.currBitmapFont;if(bitmapFont)return bitmapFont.getTextWidth(text);else {if(ILaya.Render.isConchApp){return window.conchTextCanvas.measureText(text).width;}else {var ret=ILaya.Browser.context.measureText(text)||{width:100};return ret.width;}}};_proto98._getWordWrapWidth=function _getWordWrapWidth(){var p=this.padding;var w;var bitmapFont=this._style.currBitmapFont;if(bitmapFont&&bitmapFont.autoScaleSize)w=this._width*(bitmapFont.fontSize/this.fontSize);else w=this._width;if(w<=0){w=this.wordWrap?100:ILaya.Browser.width;}w<=0&&(w=100);return w-p[3]-p[1];};_proto98.getCharPoint=function getCharPoint(charIndex,out){if(out===void 0){out=null;}this._isChanged&&ILaya.systemTimer.runCallLater(this,this.typeset);var len=0,lines=this._lines,startIndex=0;for(var i=0,n=lines.length;i<n;i++){len+=lines[i].length;if(charIndex<len){var line=i;break;}startIndex=len;}var ctxFont=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;ILaya.Browser.context.font=ctxFont;var width=this._getTextWidth(this._text.substring(startIndex,charIndex));var point=out||new Point();return point.setTo(this._startX+width-(this._clipPoint?this._clipPoint.x:0),this._startY+line*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0));};_createClass(Text,[{key:"width",get:function get(){if(this._width)return this._width;return this.textWidth+this.padding[1]+this.padding[3];},set:function set(value){if(value!=this._width){_Sprite.prototype.set_width.call(this,value);this.isChanged=true;if(this.borderColor){this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1);}}}},{key:"height",get:function get(){if(this._height)return this._height;return this.textHeight;},set:function set(value){if(value!=this._height){_Sprite.prototype.set_height.call(this,value);this.isChanged=true;if(this.borderColor){this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1);}}}},{key:"textWidth",get:function get(){this._isChanged&&ILaya.systemTimer.runCallLater(this,this.typeset);return this._textWidth;}},{key:"textHeight",get:function get(){this._isChanged&&ILaya.systemTimer.runCallLater(this,this.typeset);return this._textHeight;}},{key:"text",get:function get(){return this._text||"";},set:function set(value){this.set_text(value);}},{key:"font",get:function get(){return this._font;},set:function set(value){if(this._style.currBitmapFont){this._getTextStyle().currBitmapFont=null;this.scale(1,1);}if(Text._bitmapFonts&&Text._bitmapFonts[value]){this._getTextStyle().currBitmapFont=Text._bitmapFonts[value];}this._font=value;this.isChanged=true;}},{key:"fontSize",get:function get(){return this._fontSize;},set:function set(value){if(this._fontSize!=value){this._fontSize=value;this.isChanged=true;}}},{key:"bold",get:function get(){return this._style.bold;},set:function set(value){this._getTextStyle().bold=value;this.isChanged=true;}},{key:"color",get:function get(){return this._color;},set:function set(value){this.set_color(value);}},{key:"italic",get:function get(){return this._style.italic;},set:function set(value){this._getTextStyle().italic=value;this.isChanged=true;}},{key:"align",get:function get(){return this._style.align;},set:function set(value){this._getTextStyle().align=value;this.isChanged=true;}},{key:"valign",get:function get(){return this._valign;},set:function set(value){this._valign=value;this.isChanged=true;}},{key:"wordWrap",get:function get(){return this._style.wordWrap;},set:function set(value){this._getTextStyle().wordWrap=value;this.isChanged=true;}},{key:"leading",get:function get(){return this._style.leading;},set:function set(value){this._getTextStyle().leading=value;this.isChanged=true;}},{key:"padding",get:function get(){return this._style.padding;},set:function set(value){if(typeof value=='string'){var arr;arr=value.split(",");var i,len;len=arr.length;while(arr.length<4){arr.push(0);}for(i=0;i<len;i++){arr[i]=parseFloat(arr[i])||0;}value=arr;}this._getTextStyle().padding=value;this.isChanged=true;}},{key:"bgColor",get:function get(){return this._style.bgColor;},set:function set(value){this.set_bgColor(value);}},{key:"borderColor",get:function get(){return this._style.borderColor;},set:function set(value){this._getTextStyle().borderColor=value;this._renderType|=SpriteConst.STYLE;this._setBorderStyleColor(0,0,this.width,this.height,value,1);this._setRenderType(this._renderType);this.isChanged=true;}},{key:"stroke",get:function get(){return this._style.stroke;},set:function set(value){this._getTextStyle().stroke=value;this.isChanged=true;}},{key:"strokeColor",get:function get(){return this._style.strokeColor;},set:function set(value){this._getTextStyle().strokeColor=value;this.isChanged=true;}},{key:"isChanged",set:function set(value){if(this._isChanged!==value){this._isChanged=value;value&&ILaya.systemTimer.callLater(this,this.typeset);}}},{key:"scrollX",set:function set(value){if(this.overflow!=Text.SCROLL||this.textWidth<this._width||!this._clipPoint)return;value=value<this.padding[3]?this.padding[3]:value;var maxScrollX=this._textWidth-this._width;value=value>maxScrollX?maxScrollX:value;this._clipPoint.x=value;this._renderText();},get:function get(){if(!this._clipPoint)return 0;return this._clipPoint.x;}},{key:"scrollY",set:function set(value){if(this.overflow!=Text.SCROLL||this.textHeight<this._height||!this._clipPoint)return;value=value<this.padding[0]?this.padding[0]:value;var maxScrollY=this._textHeight-this._height;value=value>maxScrollY?maxScrollY:value;this._clipPoint.y=value;this._renderText();},get:function get(){if(!this._clipPoint)return 0;return this._clipPoint.y;}},{key:"maxScrollX",get:function get(){return this.textWidth<this._width?0:this._textWidth-this._width;}},{key:"maxScrollY",get:function get(){return this.textHeight<this._height?0:this._textHeight-this._height;}},{key:"lines",get:function get(){if(this._isChanged)this.typeset();return this._lines;}},{key:"underlineColor",get:function get(){return this._style.underlineColor;},set:function set(value){this._getTextStyle().underlineColor=value;if(!this._isChanged)this._renderText();}},{key:"underline",get:function get(){return this._style.underline;},set:function set(value){this._getTextStyle().underline=value;}},{key:"singleCharRender",set:function set(value){this._singleCharRender=value;},get:function get(){return this._singleCharRender;}}]);return Text;}(Sprite);Text.VISIBLE="visible";Text.SCROLL="scroll";Text.HIDDEN="hidden";Text.defaultFontSize=12;Text.defaultFont="Arial";Text.isComplexText=false;Text.fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"};Text._testWord="游";Text.CharacterCache=true;Text.RightToLeft=false;ILaya.regClass(Text);ClassUtils.regClass("laya.display.Text",Text);ClassUtils.regClass("Laya.Text",Text);var Input=/*#__PURE__*/function(_Text){_inheritsLoose(Input,_Text);function Input(){var _this26;_this26=_Text.call(this)||this;_this26._multiline=false;_this26._editable=true;_this26._maxChars=1E5;_this26._type="text";_this26._prompt='';_this26._promptColor="#A9A9A9";_this26._originColor="#000000";_this26._content='';Input.IOS_IFRAME=ILaya.Browser.onIOS&&ILaya.Browser.window.top!=ILaya.Browser.window.self;_this26._width=100;_this26._height=20;_this26.multiline=false;_this26.overflow=Text.SCROLL;_this26.on(Event.MOUSE_DOWN,_assertThisInitialized(_this26),_this26._onMouseDown);_this26.on(Event.UNDISPLAY,_assertThisInitialized(_this26),_this26._onUnDisplay);return _this26;}Input.__init__=function __init__(){Input._createInputElement();if(ILaya.Browser.onMobile){var isTrue=false;if(ILaya.Browser.onMiniGame||ILaya.Browser.onBDMiniGame||ILaya.Browser.onQGMiniGame||ILaya.Browser.onKGMiniGame||ILaya.Browser.onVVMiniGame||ILaya.Browser.onAlipayMiniGame||ILaya.Browser.onQQMiniGame||ILaya.Browser.onBLMiniGame||ILaya.Browser.onTTMiniGame||ILaya.Browser.onHWMiniGame){isTrue=true;}ILaya.Render.canvas.addEventListener(Input.IOS_IFRAME?isTrue?"touchend":"click":"touchend",Input._popupInputMethod);}};Input._popupInputMethod=function _popupInputMethod(e){if(!Input.isInputting)return;var input=Input.inputElement;input.focus();};Input._createInputElement=function _createInputElement(){Input._initInput(Input.area=ILaya.Browser.createElement("textarea"));Input._initInput(Input.input=ILaya.Browser.createElement("input"));Input.inputContainer=ILaya.Browser.createElement("div");Input.inputContainer.style.position="absolute";Input.inputContainer.style.zIndex=1E5;ILaya.Browser.container.appendChild(Input.inputContainer);Input.inputContainer.setPos=function(x,y){Input.inputContainer.style.left=x+'px';Input.inputContainer.style.top=y+'px';};};Input._initInput=function _initInput(input){var style=input.style;style.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;";style.resize='none';style.backgroundColor='transparent';style.border='none';style.outline='none';style.zIndex=1;input.addEventListener('input',Input._processInputting);input.addEventListener('mousemove',Input._stopEvent);input.addEventListener('mousedown',Input._stopEvent);input.addEventListener('touchmove',Input._stopEvent);input.setFontFace=function(fontFace){input.style.fontFamily=fontFace;};if(!ILaya.Render.isConchApp){input.setColor=function(color){input.style.color=color;};input.setFontSize=function(fontSize){input.style.fontSize=fontSize+'px';};}};Input._processInputting=function _processInputting(e){var input=Input.inputElement.target;if(!input)return;var value=Input.inputElement.value;if(input._restrictPattern){value=value.replace(/\u2006|\x27/g,"");if(input._restrictPattern.test(value)){value=value.replace(input._restrictPattern,"");Input.inputElement.value=value;}}input._text=value;input.event(Event.INPUT);};Input._stopEvent=function _stopEvent(e){if(e.type=='touchmove')e.preventDefault();e.stopPropagation&&e.stopPropagation();};var _proto99=Input.prototype;_proto99.setSelection=function setSelection(startIndex,endIndex){this.focus=true;Input.inputElement.selectionStart=startIndex;Input.inputElement.selectionEnd=endIndex;};_proto99._onUnDisplay=function _onUnDisplay(e){this.focus=false;};_proto99._onMouseDown=function _onMouseDown(e){this.focus=true;};_proto99._syncInputTransform=function _syncInputTransform(){var inputElement=this.nativeInput;var transform=Utils.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]);var inputWid=this._width-this.padding[1]-this.padding[3];var inputHei=this._height-this.padding[0]-this.padding[2];if(ILaya.Render.isConchApp){inputElement.setScale(transform.scaleX,transform.scaleY);inputElement.setSize(inputWid,inputHei);inputElement.setPos(transform.x,transform.y);}else {Input.inputContainer.style.transform=Input.inputContainer.style.webkitTransform="scale("+transform.scaleX+","+transform.scaleY+") rotate("+ILaya.stage.canvasDegree+"deg)";inputElement.style.width=inputWid+'px';inputElement.style.height=inputHei+'px';Input.inputContainer.style.left=transform.x+'px';Input.inputContainer.style.top=transform.y+'px';}};_proto99.select=function select(){this.nativeInput.select();};_proto99._setInputMethod=function _setInputMethod(){Input.input.parentElement&&Input.inputContainer.removeChild(Input.input);Input.area.parentElement&&Input.inputContainer.removeChild(Input.area);Input.inputElement=this._multiline?Input.area:Input.input;Input.inputContainer.appendChild(Input.inputElement);if(Text.RightToLeft){Input.inputElement.style.direction="rtl";}};_proto99._focusIn=function _focusIn(){Input.isInputting=true;var input=this.nativeInput;this._focus=true;var cssStyle=input.style;cssStyle.whiteSpace=this.wordWrap?"pre-wrap":"nowrap";this._setPromptColor();input.readOnly=!this._editable;if(ILaya.Render.isConchApp){input.setType(this._type);input.setForbidEdit(!this._editable);}input.maxLength=this._maxChars;var padding=this.padding;input.value=this._content;input.placeholder=this._prompt;ILaya.stage.off(Event.KEY_DOWN,this,this._onKeyDown);ILaya.stage.on(Event.KEY_DOWN,this,this._onKeyDown);ILaya.stage.focus=this;this.event(Event.FOCUS);if(ILaya.Browser.onPC)input.focus();if(!ILaya.Browser.onMiniGame&&!ILaya.Browser.onBDMiniGame&&!ILaya.Browser.onQGMiniGame&&!ILaya.Browser.onKGMiniGame&&!ILaya.Browser.onVVMiniGame&&!ILaya.Browser.onAlipayMiniGame&&!ILaya.Browser.onQQMiniGame&&!ILaya.Browser.onBLMiniGame&&!ILaya.Browser.onTTMiniGame&&!ILaya.Browser.onHWMiniGame){var temp=this._text;this._text=null;}this.typeset();input.setColor(this._originColor);input.setFontSize(this.fontSize);input.setFontFace(ILaya.Browser.onIPhone?Text.fontFamilyMap[this.font]||this.font:this.font);if(ILaya.Render.isConchApp){input.setMultiAble&&input.setMultiAble(this._multiline);}cssStyle.lineHeight=this.leading+this.fontSize+"px";cssStyle.fontStyle=this.italic?"italic":"normal";cssStyle.fontWeight=this.bold?"bold":"normal";cssStyle.textAlign=this.align;cssStyle.padding="0 0";this._syncInputTransform();if(!ILaya.Render.isConchApp&&ILaya.Browser.onPC)ILaya.systemTimer.frameLoop(1,this,this._syncInputTransform);};_proto99._setPromptColor=function _setPromptColor(){Input.promptStyleDOM=ILaya.Browser.getElementById("promptStyle");if(!Input.promptStyleDOM){Input.promptStyleDOM=ILaya.Browser.createElement("style");Input.promptStyleDOM.setAttribute("id","promptStyle");ILaya.Browser.document.head.appendChild(Input.promptStyleDOM);}Input.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {"+"color:"+this._promptColor+"}"+"input:-moz-placeholder, textarea:-moz-placeholder {"+"color:"+this._promptColor+"}"+"input::-moz-placeholder, textarea::-moz-placeholder {"+"color:"+this._promptColor+"}"+"input:-ms-input-placeholder, textarea:-ms-input-placeholder {"+"color:"+this._promptColor+"}";};_proto99._focusOut=function _focusOut(){if(!Input.isInputting)return;Input.isInputting=false;this._focus=false;this._text=null;this._content=this.nativeInput.value;if(!this._content){_Text.prototype.set_text.call(this,this._prompt);_Text.prototype.set_color.call(this,this._promptColor);}else {_Text.prototype.set_text.call(this,this._content);_Text.prototype.set_color.call(this,this._originColor);}ILaya.stage.off(Event.KEY_DOWN,this,this._onKeyDown);ILaya.stage.focus=null;this.event(Event.BLUR);this.event(Event.CHANGE);if(ILaya.Render.isConchApp)this.nativeInput.blur();ILaya.Browser.onPC&&ILaya.systemTimer.clear(this,this._syncInputTransform);};_proto99._onKeyDown=function _onKeyDown(e){if(e.keyCode===13){if(ILaya.Browser.onMobile&&!this._multiline)this.focus=false;this.event(Event.ENTER);}};_proto99.changeText=function changeText(text){this._content=text;if(this._focus){this.nativeInput.value=text||'';this.event(Event.CHANGE);}else _Text.prototype.changeText.call(this,text);};_createClass(Input,[{key:"multiline",get:function get(){return this._multiline;},set:function set(value){this._multiline=value;this.valign=value?"top":"middle";}},{key:"nativeInput",get:function get(){return this._multiline?Input.area:Input.input;}},{key:"focus",get:function get(){return this._focus;},set:function set(value){var input=this.nativeInput;if(this._focus!==value){if(value){if(input.target){input.target._focusOut();}else {this._setInputMethod();}input.target=this;this._focusIn();}else {input.target=null;this._focusOut();ILaya.Browser.document.body.scrollTop=0;input.blur();if(ILaya.Render.isConchApp)input.setPos(-10000,-10000);else if(Input.inputContainer.contains(input))Input.inputContainer.removeChild(input);}}}},{key:"text",set:function set(value){_Text.prototype.set_color.call(this,this._originColor);value+='';if(this._focus){this.nativeInput.value=value||'';this.event(Event.CHANGE);}else {if(!this._multiline)value=value.replace(/\r?\n/g,'');this._content=value;if(value)_Text.prototype.set_text.call(this,value);else {_Text.prototype.set_text.call(this,this._prompt);_Text.prototype.set_color.call(this,this.promptColor);}}},get:function get(){if(this._focus)return this.nativeInput.value;else return this._content||"";}},{key:"color",set:function set(value){if(this._focus)this.nativeInput.setColor(value);_Text.prototype.set_color.call(this,this._content?value:this._promptColor);this._originColor=value;},get:function get(){return _Text.prototype.color;}},{key:"bgColor",set:function set(value){_Text.prototype.set_bgColor.call(this,value);if(ILaya.Render.isConchApp)this.nativeInput.setBgColor(value);},get:function get(){return _Text.prototype.bgColor;}},{key:"restrict",get:function get(){if(this._restrictPattern){return this._restrictPattern.source;}return "";},set:function set(pattern){if(pattern){pattern="[^"+pattern+"]";if(pattern.indexOf("^^")>-1)pattern=pattern.replace("^^","");this._restrictPattern=new RegExp(pattern,"g");}else this._restrictPattern=null;}},{key:"editable",set:function set(value){this._editable=value;if(ILaya.Render.isConchApp){Input.input.setForbidEdit(!value);}},get:function get(){return this._editable;}},{key:"maxChars",get:function get(){return this._maxChars;},set:function set(value){if(value<=0)value=1E5;this._maxChars=value;}},{key:"prompt",get:function get(){return this._prompt;},set:function set(value){if(!this._text&&value)_Text.prototype.set_color.call(this,this._promptColor);this.promptColor=this._promptColor;if(this._text)_Text.prototype.set_text.call(this,this._text==this._prompt?value:this._text);else _Text.prototype.set_text.call(this,value);this._prompt=Text.langPacks&&Text.langPacks[value]?Text.langPacks[value]:value;}},{key:"promptColor",get:function get(){return this._promptColor;},set:function set(value){this._promptColor=value;if(!this._content)_Text.prototype.set_color.call(this,value);}},{key:"type",get:function get(){return this._type;},set:function set(value){if(value==="password")this._getTextStyle().asPassword=true;else this._getTextStyle().asPassword=false;this._type=value;}}]);return Input;}(Text);Input.TYPE_TEXT="text";Input.TYPE_PASSWORD="password";Input.TYPE_EMAIL="email";Input.TYPE_URL="url";Input.TYPE_NUMBER="number";Input.TYPE_RANGE="range";Input.TYPE_DATE="date";Input.TYPE_MONTH="month";Input.TYPE_WEEK="week";Input.TYPE_TIME="time";Input.TYPE_DATE_TIME="datetime";Input.TYPE_DATE_TIME_LOCAL="datetime-local";Input.TYPE_SEARCH="search";Input.IOS_IFRAME=false;Input.inputHeight=45;Input.isInputting=false;ClassUtils.regClass("laya.display.Input",Input);ClassUtils.regClass("Laya.Input",Input);var TouchManager=/*#__PURE__*/function(){function TouchManager(){this.preOvers=[];this.preDowns=[];this.preRightDowns=[];this.enable=true;this._event=new Event();this._lastClickTime=0;}var _proto100=TouchManager.prototype;_proto100._clearTempArrs=function _clearTempArrs(){TouchManager._oldArr.length=0;TouchManager._newArr.length=0;TouchManager._tEleArr.length=0;};_proto100.getTouchFromArr=function getTouchFromArr(touchID,arr){var i,len;len=arr.length;var tTouchO;for(i=0;i<len;i++){tTouchO=arr[i];if(tTouchO.id==touchID){return tTouchO;}}return null;};_proto100.removeTouchFromArr=function removeTouchFromArr(touchID,arr){var i;for(i=arr.length-1;i>=0;i--){if(arr[i].id==touchID){arr.splice(i,1);}}};_proto100.createTouchO=function createTouchO(ele,touchID){var rst;rst=Pool.getItem("TouchData")||{};rst.id=touchID;rst.tar=ele;return rst;};_proto100.onMouseDown=function onMouseDown(ele,touchID,isLeft){if(isLeft===void 0){isLeft=false;}if(!this.enable)return;var preO;var tO;var arrs;preO=this.getTouchFromArr(touchID,this.preOvers);arrs=this.getEles(ele,null,TouchManager._tEleArr);if(!preO){tO=this.createTouchO(ele,touchID);this.preOvers.push(tO);}else {preO.tar=ele;}if(Browser.onMobile)this.sendEvents(arrs,Event.MOUSE_OVER);var preDowns;preDowns=isLeft?this.preDowns:this.preRightDowns;preO=this.getTouchFromArr(touchID,preDowns);if(!preO){tO=this.createTouchO(ele,touchID);preDowns.push(tO);}else {preO.tar=ele;}this.sendEvents(arrs,isLeft?Event.MOUSE_DOWN:Event.RIGHT_MOUSE_DOWN);this._clearTempArrs();};_proto100.sendEvents=function sendEvents(eles,type){var i,len;len=eles.length;this._event._stoped=false;var _target;_target=eles[0];for(i=0;i<len;i++){var tE=eles[i];if(tE.destroyed)return;tE.event(type,this._event.setTo(type,tE,_target));if(this._event._stoped)break;}};_proto100.getEles=function getEles(start,end,rst){if(end===void 0){end=null;}if(rst===void 0){rst=null;}if(!rst){rst=[];}else {rst.length=0;}while(start&&start!=end){rst.push(start);start=start.parent;}return rst;};_proto100.checkMouseOutAndOverOfMove=function checkMouseOutAndOverOfMove(eleNew,elePre,touchID){if(elePre==eleNew)return;var tar;var arrs;var i,len;if(elePre.contains(eleNew)){arrs=this.getEles(eleNew,elePre,TouchManager._tEleArr);this.sendEvents(arrs,Event.MOUSE_OVER);}else if(eleNew.contains(elePre)){arrs=this.getEles(elePre,eleNew,TouchManager._tEleArr);this.sendEvents(arrs,Event.MOUSE_OUT);}else {arrs=TouchManager._tEleArr;arrs.length=0;var oldArr;oldArr=this.getEles(elePre,null,TouchManager._oldArr);var newArr;newArr=this.getEles(eleNew,null,TouchManager._newArr);len=oldArr.length;var tIndex;for(i=0;i<len;i++){tar=oldArr[i];tIndex=newArr.indexOf(tar);if(tIndex>=0){newArr.splice(tIndex,newArr.length-tIndex);break;}else {arrs.push(tar);}}if(arrs.length>0){this.sendEvents(arrs,Event.MOUSE_OUT);}if(newArr.length>0){this.sendEvents(newArr,Event.MOUSE_OVER);}}};_proto100.onMouseMove=function onMouseMove(ele,touchID){if(!this.enable)return;var preO;preO=this.getTouchFromArr(touchID,this.preOvers);var arrs;if(!preO){arrs=this.getEles(ele,null,TouchManager._tEleArr);this.sendEvents(arrs,Event.MOUSE_OVER);this.preOvers.push(this.createTouchO(ele,touchID));}else {this.checkMouseOutAndOverOfMove(ele,preO.tar);preO.tar=ele;arrs=this.getEles(ele,null,TouchManager._tEleArr);}this.sendEvents(arrs,Event.MOUSE_MOVE);this._clearTempArrs();};_proto100.getLastOvers=function getLastOvers(){TouchManager._tEleArr.length=0;if(this.preOvers.length>0&&this.preOvers[0].tar){return this.getEles(this.preOvers[0].tar,null,TouchManager._tEleArr);}TouchManager._tEleArr.push(ILaya.stage);return TouchManager._tEleArr;};_proto100.stageMouseOut=function stageMouseOut(){var lastOvers;lastOvers=this.getLastOvers();this.preOvers.length=0;this.sendEvents(lastOvers,Event.MOUSE_OUT);};_proto100.onMouseUp=function onMouseUp(ele,touchID,isLeft){if(isLeft===void 0){isLeft=false;}if(!this.enable)return;var preO;var arrs;var oldArr;var i,len;var tar;var sendArr;var onMobile=Browser.onMobile;arrs=this.getEles(ele,null,TouchManager._tEleArr);this.sendEvents(arrs,isLeft?Event.MOUSE_UP:Event.RIGHT_MOUSE_UP);var preDowns;preDowns=isLeft?this.preDowns:this.preRightDowns;preO=this.getTouchFromArr(touchID,preDowns);if(!preO);else {var isDouble;var now=Browser.now();isDouble=now-this._lastClickTime<300;this._lastClickTime=now;if(ele==preO.tar){sendArr=arrs;}else {oldArr=this.getEles(preO.tar,null,TouchManager._oldArr);sendArr=TouchManager._newArr;sendArr.length=0;len=oldArr.length;for(i=0;i<len;i++){tar=oldArr[i];if(arrs.indexOf(tar)>=0){sendArr.push(tar);}}}if(sendArr.length>0){this.sendEvents(sendArr,isLeft?Event.CLICK:Event.RIGHT_CLICK);}if(isLeft&&isDouble){this.sendEvents(sendArr,Event.DOUBLE_CLICK);}this.removeTouchFromArr(touchID,preDowns);preO.tar=null;Pool.recover("TouchData",preO);}preO=this.getTouchFromArr(touchID,this.preOvers);if(!preO);else {if(onMobile){sendArr=this.getEles(preO.tar,null,sendArr);if(sendArr&&sendArr.length>0){this.sendEvents(sendArr,Event.MOUSE_OUT);}this.removeTouchFromArr(touchID,this.preOvers);preO.tar=null;Pool.recover("TouchData",preO);}}this._clearTempArrs();};return TouchManager;}();TouchManager.I=new TouchManager();TouchManager._oldArr=[];TouchManager._newArr=[];TouchManager._tEleArr=[];var MouseManager=/*#__PURE__*/function(){function MouseManager(){this.mouseX=0;this.mouseY=0;this.disableMouseEvent=false;this.mouseDownTime=0;this.mouseMoveAccuracy=2;this._event=new Event();this._captureSp=null;this._captureChain=[];this._captureExlusiveMode=false;this._hitCaputreSp=false;this._point=new Point();this._rect=new Rectangle();this._lastMoveTimer=0;this._prePoint=new Point();this._touchIDs={};this._curTouchID=NaN;this._id=1;}var _proto101=MouseManager.prototype;_proto101.__init__=function __init__(stage,canvas){this._stage=stage;var _this=this;canvas.oncontextmenu=function(e){if(MouseManager.enabled)return false;};canvas.addEventListener('mousedown',function(e){if(MouseManager.enabled){if(!Browser.onIE)e.cancelable&&e.preventDefault();_this.mouseDownTime=Browser.now();_this.runEvent(e);}});canvas.addEventListener('mouseup',function(e){if(MouseManager.enabled){e.cancelable&&e.preventDefault();_this.mouseDownTime=-Browser.now();_this.runEvent(e);}},true);canvas.addEventListener('mousemove',function(e){if(MouseManager.enabled){e.cancelable&&e.preventDefault();var now=Browser.now();if(now-_this._lastMoveTimer<10)return;_this._lastMoveTimer=now;_this.runEvent(e);}},true);canvas.addEventListener("mouseout",function(e){if(MouseManager.enabled)_this.runEvent(e);});canvas.addEventListener("mouseover",function(e){if(MouseManager.enabled)_this.runEvent(e);});canvas.addEventListener("touchstart",function(e){if(MouseManager.enabled){if(!MouseManager._isFirstTouch&&!Input.isInputting)e.cancelable&&e.preventDefault();_this.mouseDownTime=Browser.now();_this.runEvent(e);}});canvas.addEventListener("touchend",function(e){if(MouseManager.enabled){if(!MouseManager._isFirstTouch&&!Input.isInputting)e.cancelable&&e.preventDefault();MouseManager._isFirstTouch=false;_this.mouseDownTime=-Browser.now();_this.runEvent(e);}else {_this._curTouchID=NaN;}},true);canvas.addEventListener("touchmove",function(e){if(MouseManager.enabled){e.cancelable&&e.preventDefault();_this.runEvent(e);}},true);canvas.addEventListener("touchcancel",function(e){if(MouseManager.enabled){e.cancelable&&e.preventDefault();_this.runEvent(e);}else {_this._curTouchID=NaN;}},true);canvas.addEventListener('mousewheel',function(e){if(MouseManager.enabled)_this.runEvent(e);});canvas.addEventListener('DOMMouseScroll',function(e){if(MouseManager.enabled)_this.runEvent(e);});};_proto101.initEvent=function initEvent(e,nativeEvent){if(nativeEvent===void 0){nativeEvent=null;}var _this=this;_this._event._stoped=false;_this._event.nativeEvent=nativeEvent||e;_this._target=null;this._point.setTo(e.pageX||e.clientX,e.pageY||e.clientY);if(this._stage._canvasTransform){this._stage._canvasTransform.invertTransformPoint(this._point);_this.mouseX=this._point.x;_this.mouseY=this._point.y;}_this._event.touchId=e.identifier||0;this._tTouchID=_this._event.touchId;var evt;evt=TouchManager.I._event;evt._stoped=false;evt.nativeEvent=_this._event.nativeEvent;evt.touchId=_this._event.touchId;};_proto101.checkMouseWheel=function checkMouseWheel(e){this._event.delta=e.wheelDelta?e.wheelDelta*0.025:-e.detail;var _lastOvers=TouchManager.I.getLastOvers();for(var i=0,n=_lastOvers.length;i<n;i++){var ele=_lastOvers[i];ele.event(Event.MOUSE_WHEEL,this._event.setTo(Event.MOUSE_WHEEL,ele,this._target));}};_proto101.onMouseMove=function onMouseMove(ele){TouchManager.I.onMouseMove(ele,this._tTouchID);};_proto101.onMouseDown=function onMouseDown(ele){if(Input.isInputting&&ILaya.stage.focus&&ILaya.stage.focus["focus"]&&!ILaya.stage.focus.contains(this._target)){var pre_input=ILaya.stage.focus['_tf']||ILaya.stage.focus;var new_input=ele['_tf']||ele;if(new_input instanceof Input&&new_input.multiline==pre_input.multiline)pre_input['_focusOut']();else pre_input.focus=false;}TouchManager.I.onMouseDown(ele,this._tTouchID,this._isLeftMouse);};_proto101.onMouseUp=function onMouseUp(ele){TouchManager.I.onMouseUp(ele,this._tTouchID,this._isLeftMouse);};_proto101.check=function check(sp,mouseX,mouseY,callBack){this._point.setTo(mouseX,mouseY);sp.fromParentPoint(this._point);mouseX=this._point.x;mouseY=this._point.y;var scrollRect=sp._style.scrollRect;if(scrollRect){this._rect.setTo(scrollRect.x,scrollRect.y,scrollRect.width,scrollRect.height);if(!this._rect.contains(mouseX,mouseY))return false;}if(!this.disableMouseEvent){if(sp.hitTestPrior&&!sp.mouseThrough&&!this.hitTest(sp,mouseX,mouseY)){return false;}for(var i=sp._children.length-1;i>-1;i--){var child=sp._children[i];if(!child.destroyed&&child._mouseState>1&&child._visible){if(this.check(child,mouseX,mouseY,callBack))return true;}}for(i=sp._extUIChild.length-1;i>=0;i--){var c=sp._extUIChild[i];if(!c.destroyed&&c._mouseState>1&&c._visible){if(this.check(c,mouseX,mouseY,callBack))return true;}}}var isHit=sp.hitTestPrior&&!sp.mouseThrough&&!this.disableMouseEvent?true:this.hitTest(sp,mouseX,mouseY);if(isHit){this._target=sp;callBack.call(this,sp);if(this._target==this._hitCaputreSp){this._hitCaputreSp=true;}}else if(callBack===this.onMouseUp&&sp===this._stage){this._target=this._stage;callBack.call(this,this._target);}return isHit;};_proto101.hitTest=function hitTest(sp,mouseX,mouseY){var isHit=false;if(sp.scrollRect){mouseX-=sp._style.scrollRect.x;mouseY-=sp._style.scrollRect.y;}var hitArea=sp._style.hitArea;if(hitArea&&hitArea._hit){return hitArea.contains(mouseX,mouseY);}if(sp.width>0&&sp.height>0||sp.mouseThrough||hitArea){if(!sp.mouseThrough){isHit=(hitArea?hitArea:this._rect.setTo(0,0,sp.width,sp.height)).contains(mouseX,mouseY);}else {isHit=sp.getGraphicBounds().contains(mouseX,mouseY);}}return isHit;};_proto101._checkAllBaseUI=function _checkAllBaseUI(mousex,mousey,callback){var ret=this.handleExclusiveCapture(this.mouseX,this.mouseY,callback);if(ret)return true;ret=this.check(this._stage,this.mouseX,this.mouseY,callback);return this.handleCapture(this.mouseX,this.mouseY,callback)||ret;};_proto101.check3DUI=function check3DUI(mousex,mousey,callback){var uis=this._stage._3dUI;var i=0;var ret=false;for(;i<uis.length;i++){var curui=uis[i];this._stage._curUIBase=curui;if(!curui.destroyed&&curui._mouseState>1&&curui._visible){ret=ret||this.check(curui,this.mouseX,this.mouseY,callback);}}this._stage._curUIBase=this._stage;return ret;};_proto101.handleExclusiveCapture=function handleExclusiveCapture(mousex,mousey,callback){if(this._captureExlusiveMode&&this._captureSp&&this._captureChain.length>0){var cursp;this._point.setTo(mousex,mousey);for(var i=0;i<this._captureChain.length;i++){cursp=this._captureChain[i];cursp.fromParentPoint(this._point);}this._target=cursp;callback.call(this,cursp);return true;}return false;};_proto101.handleCapture=function handleCapture(mousex,mousey,callback){if(!this._hitCaputreSp&&this._captureSp&&this._captureChain.length>0){var cursp;this._point.setTo(mousex,mousey);for(var i=0;i<this._captureChain.length;i++){cursp=this._captureChain[i];cursp.fromParentPoint(this._point);}this._target=cursp;callback.call(this,cursp);return true;}return false;};_proto101.runEvent=function runEvent(evt){var i,n,touch;if(evt.type!=='mousemove')this._prePoint.x=this._prePoint.y=-1000000;switch(evt.type){case'mousedown':this._touchIDs[0]=this._id++;if(!MouseManager._isTouchRespond){this._isLeftMouse=evt.button===0;this.initEvent(evt);this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseDown);}else MouseManager._isTouchRespond=false;break;case'mouseup':this._isLeftMouse=evt.button===0;this.initEvent(evt);this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseUp);break;case'mousemove':if(Math.abs(this._prePoint.x-evt.clientX)+Math.abs(this._prePoint.y-evt.clientY)>=this.mouseMoveAccuracy){this._prePoint.x=evt.clientX;this._prePoint.y=evt.clientY;this.initEvent(evt);this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseMove);}break;case"touchstart":MouseManager._isTouchRespond=true;this._isLeftMouse=true;var touches=evt.changedTouches;for(i=0,n=touches.length;i<n;i++){touch=touches[i];if(MouseManager.multiTouchEnabled||isNaN(this._curTouchID)){this._curTouchID=touch.identifier;if(this._id%200===0)this._touchIDs={};this._touchIDs[touch.identifier]=this._id++;this.initEvent(touch,evt);this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseDown);}}break;case"touchend":case"touchcancel":MouseManager._isTouchRespond=true;this._isLeftMouse=true;var touchends=evt.changedTouches;for(i=0,n=touchends.length;i<n;i++){touch=touchends[i];if(MouseManager.multiTouchEnabled||touch.identifier==this._curTouchID){this._curTouchID=NaN;this.initEvent(touch,evt);var isChecked;isChecked=this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseUp);if(!isChecked){this.onMouseUp(null);}}}break;case"touchmove":var touchemoves=evt.changedTouches;for(i=0,n=touchemoves.length;i<n;i++){touch=touchemoves[i];if(MouseManager.multiTouchEnabled||touch.identifier==this._curTouchID){this.initEvent(touch,evt);this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseMove);}}break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(evt);break;case"mouseout":TouchManager.I.stageMouseOut();break;case"mouseover":this._stage.event(Event.MOUSE_OVER,this._event.setTo(Event.MOUSE_OVER,this._stage,this._stage));break;}};_proto101.setCapture=function setCapture(sp,exclusive){if(exclusive===void 0){exclusive=false;}this._captureSp=sp;this._captureExlusiveMode=exclusive;this._captureChain.length=0;this._captureChain.push(sp);var cursp=sp;while(true){if(cursp==ILaya.stage)break;if(cursp==ILaya.stage._curUIBase)break;cursp=cursp.parent;if(!cursp)break;this._captureChain.splice(0,0,cursp);}};_proto101.releaseCapture=function releaseCapture(){console.log('release capture');this._captureSp=null;};return MouseManager;}();MouseManager.instance=new MouseManager();MouseManager.enabled=true;MouseManager.multiTouchEnabled=true;MouseManager._isFirstTouch=true;var CallLater=/*#__PURE__*/function(){function CallLater(){this._pool=[];this._map={};this._laters=[];}var _proto102=CallLater.prototype;_proto102._update=function _update(){var laters=this._laters;var len=laters.length;if(len>0){for(var i=0,n=len-1;i<=n;i++){var handler=laters[i];this._map[handler.key]=null;if(handler.method!==null){handler.run();handler.clear();}this._pool.push(handler);i===n&&(n=laters.length-1);}laters.length=0;}};_proto102._getHandler=function _getHandler(caller,method){var cid=caller?caller.$_GID||(caller.$_GID=ILaya.Utils.getGID()):0;var mid=method.$_TID||(method.$_TID=ILaya.Timer._mid++);return this._map[cid+'.'+mid];};_proto102.callLater=function callLater(caller,method,args){if(args===void 0){args=null;}if(this._getHandler(caller,method)==null){var handler;if(this._pool.length)handler=this._pool.pop();else handler=new LaterHandler();handler.caller=caller;handler.method=method;handler.args=args;var cid=caller?caller.$_GID:0;var mid=method["$_TID"];handler.key=cid+'.'+mid;this._map[handler.key]=handler;this._laters.push(handler);}};_proto102.runCallLater=function runCallLater(caller,method){var handler=this._getHandler(caller,method);if(handler&&handler.method!=null){this._map[handler.key]=null;handler.run();handler.clear();}};return CallLater;}();CallLater.I=new CallLater();var LaterHandler=/*#__PURE__*/function(){function LaterHandler(){}var _proto103=LaterHandler.prototype;_proto103.clear=function clear(){this.caller=null;this.method=null;this.args=null;};_proto103.run=function run(){var caller=this.caller;if(caller&&caller.destroyed)return this.clear();var method=this.method;var args=this.args;if(method==null)return;args?method.apply(caller,args):method.call(caller);};return LaterHandler;}();var RunDriver=function RunDriver(){};RunDriver.createShaderCondition=function(conditionScript){var fn="(function() {return "+conditionScript+";})";return window.Laya._runScript(fn);};RunDriver.changeWebGLSize=function(w,h){WebGL.onStageResize(w,h);};var Stage=/*#__PURE__*/function(_Sprite2){_inheritsLoose(Stage,_Sprite2);function Stage(){var _this27;_this27=_Sprite2.call(this)||this;_this27.offset=new Point();_this27._frameRate="fast";_this27.designWidth=0;_this27.designHeight=0;_this27.canvasRotation=false;_this27.canvasDegree=0;_this27.renderingEnabled=true;_this27.screenAdaptationEnabled=true;_this27._canvasTransform=new Matrix();_this27._screenMode="none";_this27._scaleMode="noscale";_this27._alignV="top";_this27._alignH="left";_this27._bgColor="black";_this27._mouseMoveTime=0;_this27._renderCount=0;_this27._safariOffsetY=0;_this27._frameStartTime=0;_this27._previousOrientation=Browser.window.orientation;_this27._wgColor=[0,0,0,1];_this27._scene3Ds=[];_this27._globalRepaintSet=false;_this27._globalRepaintGet=false;_this27._3dUI=[];_this27._curUIBase=null;_this27.useRetinalCanvas=false;_Sprite2.prototype.set_transform.call(_assertThisInitialized(_this27),_this27._createTransform());_this27.mouseEnabled=true;_this27.hitTestPrior=true;_this27.autoSize=false;_this27._setBit(Const.DISPLAYED_INSTAGE,true);_this27._setBit(Const.ACTIVE_INHIERARCHY,true);_this27._isFocused=true;_this27._isVisibility=true;_this27.useRetinalCanvas=Config.useRetinalCanvas;var window=Browser.window;window.addEventListener("focus",function(){_this27._isFocused=true;_this27.event(Event.FOCUS);_this27.event(Event.FOCUS_CHANGE);});window.addEventListener("blur",function(){_this27._isFocused=false;_this27.event(Event.BLUR);_this27.event(Event.FOCUS_CHANGE);if(_this27._isInputting())Input["inputElement"].target.focus=false;});var state="visibilityState",visibilityChange="visibilitychange";var document=window.document;if(typeof document.hidden!=="undefined"){visibilityChange="visibilitychange";state="visibilityState";}else if(typeof document.mozHidden!=="undefined"){visibilityChange="mozvisibilitychange";state="mozVisibilityState";}else if(typeof document.msHidden!=="undefined"){visibilityChange="msvisibilitychange";state="msVisibilityState";}else if(typeof document.webkitHidden!=="undefined"){visibilityChange="webkitvisibilitychange";state="webkitVisibilityState";}window.document.addEventListener(visibilityChange,function(){if(Browser.document[state]=="hidden"){_this27._isVisibility=false;if(_this27._isInputting())Input["inputElement"].target.focus=false;}else {_this27._isVisibility=true;}_this27.renderingEnabled=_this27._isVisibility;_this27.event(Event.VISIBILITY_CHANGE);});window.addEventListener("resize",function(){var orientation=Browser.window.orientation;if(orientation!=null&&orientation!=_this27._previousOrientation&&_this27._isInputting()){Input["inputElement"].target.focus=false;}_this27._previousOrientation=orientation;if(_this27._isInputting())return;if(Browser.onSafari)_this27._safariOffsetY=(Browser.window.__innerHeight||Browser.document.body.clientHeight||Browser.document.documentElement.clientHeight)-Browser.window.innerHeight;_this27._resetCanvas();});window.addEventListener("orientationchange",function(e){_this27._resetCanvas();});_this27.on(Event.MOUSE_MOVE,_assertThisInitialized(_this27),_this27._onmouseMove);if(Browser.onMobile)_this27.on(Event.MOUSE_DOWN,_assertThisInitialized(_this27),_this27._onmouseMove);return _this27;}var _proto104=Stage.prototype;_proto104._isInputting=function _isInputting(){return Browser.onMobile&&Input.isInputting;};_proto104._changeCanvasSize=function _changeCanvasSize(){this.setScreenSize(Browser.clientWidth*Browser.pixelRatio,Browser.clientHeight*Browser.pixelRatio);};_proto104._resetCanvas=function _resetCanvas(){if(!this.screenAdaptationEnabled)return;this._changeCanvasSize();};_proto104.setScreenSize=function setScreenSize(screenWidth,screenHeight){var rotation=false;if(this._screenMode!==Stage.SCREEN_NONE){var screenType=screenWidth/screenHeight<1?Stage.SCREEN_VERTICAL:Stage.SCREEN_HORIZONTAL;rotation=screenType!==this._screenMode;if(rotation){var temp=screenHeight;screenHeight=screenWidth;screenWidth=temp;}}this.canvasRotation=rotation;var canvas=Render._mainCanvas;var canvasStyle=canvas.source.style;var mat=this._canvasTransform.identity();var scaleMode=this._scaleMode;var scaleX=screenWidth/this.designWidth;var scaleY=screenHeight/this.designHeight;var canvasWidth=this.useRetinalCanvas?screenWidth:this.designWidth;var canvasHeight=this.useRetinalCanvas?screenHeight:this.designHeight;var realWidth=screenWidth;var realHeight=screenHeight;var pixelRatio=Browser.pixelRatio;this._width=this.designWidth;this._height=this.designHeight;switch(scaleMode){case Stage.SCALE_NOSCALE:scaleX=scaleY=1;realWidth=this.designWidth;realHeight=this.designHeight;break;case Stage.SCALE_SHOWALL:scaleX=scaleY=Math.min(scaleX,scaleY);canvasWidth=realWidth=Math.round(this.designWidth*scaleX);canvasHeight=realHeight=Math.round(this.designHeight*scaleY);break;case Stage.SCALE_NOBORDER:scaleX=scaleY=Math.max(scaleX,scaleY);realWidth=Math.round(this.designWidth*scaleX);realHeight=Math.round(this.designHeight*scaleY);break;case Stage.SCALE_FULL:scaleX=scaleY=1;this._width=canvasWidth=screenWidth;this._height=canvasHeight=screenHeight;break;case Stage.SCALE_FIXED_WIDTH:scaleY=scaleX;this._height=canvasHeight=Math.round(screenHeight/scaleX);break;case Stage.SCALE_FIXED_HEIGHT:scaleX=scaleY;this._width=canvasWidth=Math.round(screenWidth/scaleY);break;case Stage.SCALE_FIXED_AUTO:if(screenWidth/screenHeight<this.designWidth/this.designHeight){scaleY=scaleX;this._height=canvasHeight=Math.round(screenHeight/scaleX);}else {scaleX=scaleY;this._width=canvasWidth=Math.round(screenWidth/scaleY);}break;}if(this.useRetinalCanvas){realWidth=canvasWidth=screenWidth;realHeight=canvasHeight=screenHeight;}scaleX*=this.scaleX;scaleY*=this.scaleY;if(scaleX===1&&scaleY===1){this.transform.identity();}else {this.transform.a=this._formatData(scaleX/(realWidth/canvasWidth));this.transform.d=this._formatData(scaleY/(realHeight/canvasHeight));}canvas.size(canvasWidth,canvasHeight);RunDriver.changeWebGLSize(canvasWidth,canvasHeight);mat.scale(realWidth/canvasWidth/pixelRatio,realHeight/canvasHeight/pixelRatio);if(this._alignH===Stage.ALIGN_LEFT)this.offset.x=0;else if(this._alignH===Stage.ALIGN_RIGHT)this.offset.x=screenWidth-realWidth;else this.offset.x=(screenWidth-realWidth)*0.5/pixelRatio;if(this._alignV===Stage.ALIGN_TOP)this.offset.y=0;else if(this._alignV===Stage.ALIGN_BOTTOM)this.offset.y=screenHeight-realHeight;else this.offset.y=(screenHeight-realHeight)*0.5/pixelRatio;this.offset.x=Math.round(this.offset.x);this.offset.y=Math.round(this.offset.y);mat.translate(this.offset.x,this.offset.y);if(this._safariOffsetY)mat.translate(0,this._safariOffsetY);this.canvasDegree=0;if(rotation){if(this._screenMode===Stage.SCREEN_HORIZONTAL){mat.rotate(Math.PI/2);mat.translate(screenHeight/pixelRatio,0);this.canvasDegree=90;}else {mat.rotate(-Math.PI/2);mat.translate(0,screenWidth/pixelRatio);this.canvasDegree=-90;}}mat.a=this._formatData(mat.a);mat.d=this._formatData(mat.d);mat.tx=this._formatData(mat.tx);mat.ty=this._formatData(mat.ty);_Sprite2.prototype.set_transform.call(this,this.transform);canvasStyle.transformOrigin=canvasStyle.webkitTransformOrigin=canvasStyle.msTransformOrigin=canvasStyle.mozTransformOrigin=canvasStyle.oTransformOrigin="0px 0px 0px";canvasStyle.transform=canvasStyle.webkitTransform=canvasStyle.msTransform=canvasStyle.mozTransform=canvasStyle.oTransform="matrix("+mat.toString()+")";if(this._safariOffsetY)mat.translate(0,-this._safariOffsetY);mat.translate(parseInt(canvasStyle.left)||0,parseInt(canvasStyle.top)||0);this.visible=true;this._repaint|=SpriteConst.REPAINT_CACHE;this.event(Event.RESIZE);};_proto104._formatData=function _formatData(value){if(Math.abs(value)<0.000001)return 0;if(Math.abs(1-value)<0.001)return value>0?1:-1;return value;};_proto104.getMousePoint=function getMousePoint(){return Point.TEMP.setTo(this.mouseX,this.mouseY);};_proto104.repaint=function repaint(type){if(type===void 0){type=SpriteConst.REPAINT_CACHE;}this._repaint|=type;};_proto104.parentRepaint=function parentRepaint(type){};_proto104._loop=function _loop(){this._globalRepaintGet=this._globalRepaintSet;this._globalRepaintSet=false;this.render(Render._context,0,0);return true;};_proto104.getFrameTm=function getFrameTm(){return this._frameStartTime;};_proto104._onmouseMove=function _onmouseMove(e){this._mouseMoveTime=Browser.now();};_proto104.getTimeFromFrameStart=function getTimeFromFrameStart(){return Browser.now()-this._frameStartTime;};_proto104.render=function render(context,x,y){if(window.conch){this.renderToNative(context,x,y);return;}if(this._frameRate===Stage.FRAME_SLEEP){var now=Browser.now();if(now-this._frameStartTime>=1000)this._frameStartTime=now;else return;}else {if(!this._visible){this._renderCount++;if(this._renderCount%5===0){CallLater.I._update();Stat.loopCount++;RenderInfo.loopCount=Stat.loopCount;this._updateTimers();}return;}this._frameStartTime=Browser.now();RenderInfo.loopStTm=this._frameStartTime;}this._renderCount++;var frameMode=this._frameRate===Stage.FRAME_MOUSE?this._frameStartTime-this._mouseMoveTime<2000?Stage.FRAME_FAST:Stage.FRAME_SLOW:this._frameRate;var isFastMode=frameMode!==Stage.FRAME_SLOW;var isDoubleLoop=this._renderCount%2===0;Stat.renderSlow=!isFastMode;if(!isFastMode&&!isDoubleLoop)return;CallLater.I._update();Stat.loopCount++;RenderInfo.loopCount=Stat.loopCount;if(this.renderingEnabled){for(var i=0,n=this._scene3Ds.length;i<n;i++){this._scene3Ds[i]._update();}context.clear();_Sprite2.prototype.render.call(this,context,x,y);Stat._StatRender.renderNotCanvas(context,x,y);}if(this.renderingEnabled){Stage.clear(this._bgColor);context.flush();VectorGraphManager.instance&&VectorGraphManager.getInstance().endDispose();}this._updateTimers();};_proto104.renderToNative=function renderToNative(context,x,y){this._renderCount++;if(!this._visible){if(this._renderCount%5===0){CallLater.I._update();Stat.loopCount++;RenderInfo.loopCount=Stat.loopCount;this._updateTimers();}return;}CallLater.I._update();Stat.loopCount++;RenderInfo.loopCount=Stat.loopCount;if(this.renderingEnabled){for(var i=0,n=this._scene3Ds.length;i<n;i++){this._scene3Ds[i]._update();}context.clear();_Sprite2.prototype.render.call(this,context,x,y);Stat._StatRender.renderNotCanvas(context,x,y);}if(this.renderingEnabled){Stage.clear(this._bgColor);context.flush();VectorGraphManager.instance&&VectorGraphManager.getInstance().endDispose();}this._updateTimers();};_proto104._updateTimers=function _updateTimers(){ILaya.systemTimer._update();ILaya.startTimer._update();ILaya.physicsTimer._update();ILaya.updateTimer._update();ILaya.lateTimer._update();ILaya.timer._update();};_proto104._requestFullscreen=function _requestFullscreen(){var element=Browser.document.documentElement;if(element.requestFullscreen){element.requestFullscreen();}else if(element.mozRequestFullScreen){element.mozRequestFullScreen();}else if(element.webkitRequestFullscreen){element.webkitRequestFullscreen();}else if(element.msRequestFullscreen){element.msRequestFullscreen();}};_proto104._fullScreenChanged=function _fullScreenChanged(){ILaya.stage.event(Event.FULL_SCREEN_CHANGE);};_proto104.exitFullscreen=function exitFullscreen(){var document=Browser.document;if(document.exitFullscreen){document.exitFullscreen();}else if(document.mozCancelFullScreen){document.mozCancelFullScreen();}else if(document.webkitExitFullscreen){document.webkitExitFullscreen();}};_proto104.isGlobalRepaint=function isGlobalRepaint(){return this._globalRepaintGet;};_proto104.setGlobalRepaint=function setGlobalRepaint(){this._globalRepaintSet=true;};_proto104.add3DUI=function add3DUI(uibase){var uiroot=uibase.rootView;if(this._3dUI.indexOf(uiroot)>=0)return;this._3dUI.push(uiroot);};_proto104.remove3DUI=function remove3DUI(uibase){var uiroot=uibase.rootView;var p=this._3dUI.indexOf(uiroot);if(p>=0){this._3dUI.splice(p,1);return true;}return false;};_createClass(Stage,[{key:"width",set:function set(value){this.designWidth=value;_Sprite2.prototype.set_width.call(this,value);ILaya.systemTimer.callLater(this,this._changeCanvasSize);},get:function get(){return _Sprite2.prototype.get_width.call(this);}},{key:"height",set:function set(value){this.designHeight=value;_Sprite2.prototype.set_height.call(this,value);ILaya.systemTimer.callLater(this,this._changeCanvasSize);},get:function get(){return _Sprite2.prototype.get_height.call(this);}},{key:"transform",set:function set(value){_Sprite2.prototype.set_transform.call(this,value);},get:function get(){if(this._tfChanged)this._adjustTransform();return this._transform=this._transform||this._createTransform();}},{key:"isFocused",get:function get(){return this._isFocused;}},{key:"isVisibility",get:function get(){return this._isVisibility;}},{key:"scaleMode",get:function get(){return this._scaleMode;},set:function set(value){this._scaleMode=value;ILaya.systemTimer.callLater(this,this._changeCanvasSize);}},{key:"alignH",get:function get(){return this._alignH;},set:function set(value){this._alignH=value;ILaya.systemTimer.callLater(this,this._changeCanvasSize);}},{key:"alignV",get:function get(){return this._alignV;},set:function set(value){this._alignV=value;ILaya.systemTimer.callLater(this,this._changeCanvasSize);}},{key:"bgColor",get:function get(){return this._bgColor;},set:function set(value){this._bgColor=value;if(value)this._wgColor=ColorUtils.create(value).arrColor;else this._wgColor=null;if(value){Render.canvas.style.background=value;}else {Render.canvas.style.background="none";}}},{key:"mouseX",get:function get(){return Math.round(MouseManager.instance.mouseX/this.clientScaleX);}},{key:"mouseY",get:function get(){return Math.round(MouseManager.instance.mouseY/this.clientScaleY);}},{key:"clientScaleX",get:function get(){return this._transform?this._transform.getScaleX():1;}},{key:"clientScaleY",get:function get(){return this._transform?this._transform.getScaleY():1;}},{key:"screenMode",get:function get(){return this._screenMode;},set:function set(value){this._screenMode=value;}},{key:"visible",set:function set(value){if(this.visible!==value){_Sprite2.prototype.set_visible.call(this,value);var style=Render._mainCanvas.source.style;style.visibility=value?"visible":"hidden";}},get:function get(){return _Sprite2.prototype.visible;}},{key:"fullScreenEnabled",set:function set(value){var document=Browser.document;var canvas=Render.canvas;if(value){canvas.addEventListener('mousedown',this._requestFullscreen);canvas.addEventListener('touchstart',this._requestFullscreen);document.addEventListener("fullscreenchange",this._fullScreenChanged);document.addEventListener("mozfullscreenchange",this._fullScreenChanged);document.addEventListener("webkitfullscreenchange",this._fullScreenChanged);document.addEventListener("msfullscreenchange",this._fullScreenChanged);}else {canvas.removeEventListener('mousedown',this._requestFullscreen);canvas.removeEventListener('touchstart',this._requestFullscreen);document.removeEventListener("fullscreenchange",this._fullScreenChanged);document.removeEventListener("mozfullscreenchange",this._fullScreenChanged);document.removeEventListener("webkitfullscreenchange",this._fullScreenChanged);document.removeEventListener("msfullscreenchange",this._fullScreenChanged);}}},{key:"frameRate",get:function get(){if(!ILaya.Render.isConchApp){return this._frameRate;}else {return this._frameRateNative;}},set:function set(value){if(!ILaya.Render.isConchApp){this._frameRate=value;}else {var c=window.conch;switch(value){case Stage.FRAME_FAST:c.config.setLimitFPS(60);break;case Stage.FRAME_MOUSE:c.config.setMouseFrame(2000);break;case Stage.FRAME_SLOW:c.config.setSlowFrame(true);break;case Stage.FRAME_SLEEP:c.config.setLimitFPS(1);break;}this._frameRateNative=value;}}}]);return Stage;}(Sprite);Stage.SCALE_NOSCALE="noscale";Stage.SCALE_EXACTFIT="exactfit";Stage.SCALE_SHOWALL="showall";Stage.SCALE_NOBORDER="noborder";Stage.SCALE_FULL="full";Stage.SCALE_FIXED_WIDTH="fixedwidth";Stage.SCALE_FIXED_HEIGHT="fixedheight";Stage.SCALE_FIXED_AUTO="fixedauto";Stage.ALIGN_LEFT="left";Stage.ALIGN_RIGHT="right";Stage.ALIGN_CENTER="center";Stage.ALIGN_TOP="top";Stage.ALIGN_MIDDLE="middle";Stage.ALIGN_BOTTOM="bottom";Stage.SCREEN_NONE="none";Stage.SCREEN_HORIZONTAL="horizontal";Stage.SCREEN_VERTICAL="vertical";Stage.FRAME_FAST="fast";Stage.FRAME_SLOW="slow";Stage.FRAME_MOUSE="mouse";Stage.FRAME_SLEEP="sleep";Stage.clear=function(value){Context.set2DRenderConfig();var gl=LayaGL.instance;RenderState2D.worldScissorTest&&gl.disable(gl.SCISSOR_TEST);var ctx=Render.context;var c=ctx._submits._length==0||Config.preserveDrawingBuffer?ColorUtils.create(value).arrColor:ILaya.stage._wgColor;if(c)ctx.clearBG(c[0],c[1],c[2],c[3]);else ctx.clearBG(0,0,0,0);RenderState2D.clear();};ClassUtils.regClass("laya.display.Stage",Stage);ClassUtils.regClass("Laya.Stage",Stage);var KeyBoardManager=/*#__PURE__*/function(){function KeyBoardManager(){}KeyBoardManager.__init__=function __init__(){KeyBoardManager._addEvent("keydown");KeyBoardManager._addEvent("keypress");KeyBoardManager._addEvent("keyup");};KeyBoardManager._addEvent=function _addEvent(type){ILaya.Browser.document.addEventListener(type,function(e){KeyBoardManager._dispatch(e,type);},true);};KeyBoardManager._dispatch=function _dispatch(e,type){if(!KeyBoardManager.enabled)return;KeyBoardManager._event._stoped=false;KeyBoardManager._event.nativeEvent=e;KeyBoardManager._event.keyCode=e.keyCode||e.which||e.charCode;if(type==="keydown")KeyBoardManager._pressKeys[KeyBoardManager._event.keyCode]=true;else if(type==="keyup")KeyBoardManager._pressKeys[KeyBoardManager._event.keyCode]=null;var target=ILaya.stage.focus&&ILaya.stage.focus.event!=null&&ILaya.stage.focus.displayedInStage?ILaya.stage.focus:ILaya.stage;var ct=target;while(ct){ct.event(type,KeyBoardManager._event.setTo(type,ct,target));ct=ct.parent;}};KeyBoardManager.hasKeyDown=function hasKeyDown(key){return KeyBoardManager._pressKeys[key];};return KeyBoardManager;}();KeyBoardManager._pressKeys={};KeyBoardManager.enabled=true;KeyBoardManager._event=new Event();var SoundChannel=/*#__PURE__*/function(_EventDispatcher4){_inheritsLoose(SoundChannel,_EventDispatcher4);function SoundChannel(){var _this28;_this28=_EventDispatcher4.apply(this,arguments)||this;_this28.isStopped=false;return _this28;}var _proto105=SoundChannel.prototype;_proto105.play=function play(){};_proto105.stop=function stop(){if(this.completeHandler)this.completeHandler.runWith(false);};_proto105.pause=function pause(){};_proto105.resume=function resume(){};_proto105.__runComplete=function __runComplete(handler){if(handler){handler.runWith(true);}};_createClass(SoundChannel,[{key:"volume",set:function set(v){},get:function get(){return 1;}},{key:"position",get:function get(){return 0;}},{key:"duration",get:function get(){return 0;}}]);return SoundChannel;}(EventDispatcher);var AudioSoundChannel=/*#__PURE__*/function(_SoundChannel){_inheritsLoose(AudioSoundChannel,_SoundChannel);function AudioSoundChannel(audio){var _this29;_this29=_SoundChannel.call(this)||this;_this29._audio=null;_this29._onEnd=_this29.__onEnd.bind(_assertThisInitialized(_this29));_this29._resumePlay=_this29.__resumePlay.bind(_assertThisInitialized(_this29));audio.addEventListener("ended",_this29._onEnd);_this29._audio=audio;return _this29;}var _proto106=AudioSoundChannel.prototype;_proto106.__onEnd=function __onEnd(evt){if(this.loops==1){if(this.completeHandler){ILaya.systemTimer.once(10,this,this.__runComplete,[this.completeHandler],false);this.completeHandler=null;}this.stop();this.event(Event.COMPLETE);return;}if(this.loops>0){this.loops--;}this.startTime=0;this.play();};_proto106.__resumePlay=function __resumePlay(){if(this._audio)this._audio.removeEventListener("canplay",this._resumePlay);if(this.isStopped)return;try{this._audio.currentTime=this.startTime;Browser.container.appendChild(this._audio);this._audio.play();}catch(e){this.event(Event.ERROR);}};_proto106.play=function play(){this.isStopped=false;try{this._audio.playbackRate=ILaya.SoundManager.playbackRate;this._audio.currentTime=this.startTime;}catch(e){this._audio.addEventListener("canplay",this._resumePlay);return;}ILaya.SoundManager.addChannel(this);Browser.container.appendChild(this._audio);if("play"in this._audio)this._audio.play();};_proto106.stop=function stop(){_SoundChannel.prototype.stop.call(this);this.isStopped=true;ILaya.SoundManager.removeChannel(this);this.completeHandler=null;if(!this._audio)return;if("pause"in this._audio)if(ILaya.Render.isConchApp){this._audio.stop();}this._audio.pause();this._audio.removeEventListener("ended",this._onEnd);this._audio.removeEventListener("canplay",this._resumePlay);if(!ILaya.Browser.onIE){if(this._audio!=ILaya.AudioSound._musicAudio){ILaya.Pool.recover("audio:"+this.url,this._audio);}}Browser.removeElement(this._audio);this._audio=null;if(ILaya.SoundManager.autoReleaseSound)ILaya.SoundManager.disposeSoundLater(this.url);};_proto106.pause=function pause(){this.isStopped=true;ILaya.SoundManager.removeChannel(this);if("pause"in this._audio)this._audio.pause();if(ILaya.SoundManager.autoReleaseSound)ILaya.SoundManager.disposeSoundLater(this.url);};_proto106.resume=function resume(){var audio=this._audio;if(!audio)return;this.isStopped=false;if(audio.readyState==0){audio.src=this.url;audio.addEventListener("canplay",this._resumePlay);audio.load();}ILaya.SoundManager.addChannel(this);if("play"in audio){audio.play();}};_createClass(AudioSoundChannel,[{key:"position",get:function get(){if(!this._audio)return 0;return this._audio.currentTime;}},{key:"duration",get:function get(){if(!this._audio)return 0;return this._audio.duration;}},{key:"volume",set:function set(v){if(!this._audio)return;this._audio.volume=v;},get:function get(){if(!this._audio)return 1;return this._audio.volume;}}]);return AudioSoundChannel;}(SoundChannel);var AudioSound=/*#__PURE__*/function(_EventDispatcher5){_inheritsLoose(AudioSound,_EventDispatcher5);function AudioSound(){var _this30;_this30=_EventDispatcher5.apply(this,arguments)||this;_this30.loaded=false;return _this30;}var _proto107=AudioSound.prototype;_proto107.dispose=function dispose(){var ad=AudioSound._audioCache[this.url];Pool.clearBySign("audio:"+this.url);if(ad){if(!Render.isConchApp){ad.src="";}delete AudioSound._audioCache[this.url];}};AudioSound._initMusicAudio=function _initMusicAudio(){if(AudioSound._musicAudio)return;if(!AudioSound._musicAudio)AudioSound._musicAudio=Browser.createElement("audio");if(!Render.isConchApp){Browser.document.addEventListener("mousedown",AudioSound._makeMusicOK);}};AudioSound._makeMusicOK=function _makeMusicOK(){Browser.document.removeEventListener("mousedown",AudioSound._makeMusicOK);if(!AudioSound._musicAudio.src){AudioSound._musicAudio.src="";AudioSound._musicAudio.load();}else {AudioSound._musicAudio.play();}};_proto107.load=function load(url){url=URL.formatURL(url);this.url=url;var ad;if(url==ILaya.SoundManager._bgMusic){AudioSound._initMusicAudio();ad=AudioSound._musicAudio;if(ad.src!=url){AudioSound._audioCache[ad.src]=null;ad=null;}}else {ad=AudioSound._audioCache[url];}if(ad&&ad.readyState>=2){this.event(Event.COMPLETE);return;}if(!ad){if(url==ILaya.SoundManager._bgMusic){AudioSound._initMusicAudio();ad=AudioSound._musicAudio;}else {ad=Browser.createElement("audio");}AudioSound._audioCache[url]=ad;ad.src=url;}ad.addEventListener("canplaythrough",onLoaded);ad.addEventListener("error",onErr);var me=this;function onLoaded(){offs();me.loaded=true;me.event(Event.COMPLETE);}function onErr(){ad.load=null;offs();me.event(Event.ERROR);}function offs(){ad.removeEventListener("canplaythrough",onLoaded);ad.removeEventListener("error",onErr);}this.audio=ad;if(ad.load){ad.load();}else {onErr();}};_proto107.play=function play(startTime,loops){if(startTime===void 0){startTime=0;}if(loops===void 0){loops=0;}if(!this.url)return null;var ad;if(this.url==ILaya.SoundManager._bgMusic){ad=AudioSound._musicAudio;}else {ad=AudioSound._audioCache[this.url];}if(!ad)return null;var tAd;tAd=Pool.getItem("audio:"+this.url);if(Render.isConchApp){if(!tAd){tAd=Browser.createElement("audio");tAd.src=this.url;}}else {if(this.url==ILaya.SoundManager._bgMusic){AudioSound._initMusicAudio();tAd=AudioSound._musicAudio;tAd.src=this.url;}else {tAd=tAd?tAd:ad.cloneNode(true);}}var channel=new AudioSoundChannel(tAd);channel.url=this.url;channel.loops=loops;channel.startTime=startTime;channel.play();ILaya.SoundManager.addChannel(channel);return channel;};_createClass(AudioSound,[{key:"duration",get:function get(){var ad;ad=AudioSound._audioCache[this.url];if(!ad)return 0;return ad.duration;}}]);return AudioSound;}(EventDispatcher);AudioSound._audioCache={};var WebAudioSoundChannel=/*#__PURE__*/function(_SoundChannel2){_inheritsLoose(WebAudioSoundChannel,_SoundChannel2);function WebAudioSoundChannel(){var _this31;_this31=_SoundChannel2.call(this)||this;_this31.bufferSource=null;_this31._currentTime=0;_this31._volume=1;_this31._startTime=0;_this31._pauseTime=0;_this31.context=ILaya.WebAudioSound.ctx;_this31._onPlayEnd=Utils.bind(_this31.__onPlayEnd,_assertThisInitialized(_this31));if(_this31.context["createGain"]){_this31.gain=_this31.context["createGain"]();}else {_this31.gain=_this31.context["createGainNode"]();}return _this31;}var _proto108=WebAudioSoundChannel.prototype;_proto108.play=function play(){ILaya.SoundManager.addChannel(this);this.isStopped=false;this._clearBufferSource();if(!this.audioBuffer)return;if(this.startTime>=this.duration)return stop();var context=this.context;var gain=this.gain;var bufferSource=context.createBufferSource();this.bufferSource=bufferSource;bufferSource.buffer=this.audioBuffer;bufferSource.connect(gain);if(gain)gain.disconnect();gain.connect(context.destination);bufferSource.onended=this._onPlayEnd;this._startTime=Browser.now();if(this.gain.gain.setTargetAtTime){this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,WebAudioSoundChannel.SetTargetDelay);}else this.gain.gain.value=this._volume;if(this.loops==0){bufferSource.loop=true;}if(bufferSource.playbackRate.setTargetAtTime){bufferSource.playbackRate.setTargetAtTime(ILaya.SoundManager.playbackRate,this.context.currentTime,WebAudioSoundChannel.SetTargetDelay);}else bufferSource.playbackRate.value=ILaya.SoundManager.playbackRate;bufferSource.start(0,this.startTime);this._currentTime=0;};_proto108.__onPlayEnd=function __onPlayEnd(){if(this.loops==1){if(this.completeHandler){ILaya.timer.once(10,this,this.__runComplete,[this.completeHandler],false);this.completeHandler=null;}this.stop();this.event(Event.COMPLETE);return;}if(this.loops>0){this.loops--;}this.startTime=0;this.play();};_proto108._clearBufferSource=function _clearBufferSource(){if(this.bufferSource){var sourceNode=this.bufferSource;if(sourceNode.stop){sourceNode.stop(0);}else {sourceNode.noteOff(0);}sourceNode.disconnect(0);sourceNode.onended=null;if(!WebAudioSoundChannel._tryCleanFailed)this._tryClearBuffer(sourceNode);this.bufferSource=null;}};_proto108._tryClearBuffer=function _tryClearBuffer(sourceNode){try{sourceNode.buffer=null;}catch(e){WebAudioSoundChannel._tryCleanFailed=true;}};_proto108.stop=function stop(){_SoundChannel2.prototype.stop.call(this);this._clearBufferSource();this.audioBuffer=null;if(this.gain)this.gain.disconnect();this.isStopped=true;ILaya.SoundManager.removeChannel(this);this.completeHandler=null;if(ILaya.SoundManager.autoReleaseSound)ILaya.SoundManager.disposeSoundLater(this.url);};_proto108.pause=function pause(){if(!this.isStopped){this._pauseTime=this.position;}this._clearBufferSource();if(this.gain)this.gain.disconnect();this.isStopped=true;ILaya.SoundManager.removeChannel(this);if(ILaya.SoundManager.autoReleaseSound)ILaya.SoundManager.disposeSoundLater(this.url);};_proto108.resume=function resume(){this.startTime=this._pauseTime;this.play();};_createClass(WebAudioSoundChannel,[{key:"position",get:function get(){if(this.bufferSource){return (Browser.now()-this._startTime)/1000+this.startTime;}return 0;}},{key:"duration",get:function get(){if(this.audioBuffer){return this.audioBuffer.duration;}return 0;}},{key:"volume",set:function set(v){this._volume=v;if(this.isStopped){return;}if(this.gain.gain.setTargetAtTime){this.gain.gain.setTargetAtTime(v,this.context.currentTime,WebAudioSoundChannel.SetTargetDelay);}else this.gain.gain.value=v;},get:function get(){return this._volume;}}]);return WebAudioSoundChannel;}(SoundChannel);WebAudioSoundChannel._tryCleanFailed=false;WebAudioSoundChannel.SetTargetDelay=0.001;var WebAudioSound=/*#__PURE__*/function(_EventDispatcher6){_inheritsLoose(WebAudioSound,_EventDispatcher6);function WebAudioSound(){var _this32;_this32=_EventDispatcher6.apply(this,arguments)||this;_this32.loaded=false;_this32._disposed=false;return _this32;}WebAudioSound.decode=function decode(){if(WebAudioSound.buffs.length<=0||WebAudioSound.isDecoding){return;}WebAudioSound.isDecoding=true;WebAudioSound.tInfo=WebAudioSound.buffs.shift();WebAudioSound.ctx.decodeAudioData(WebAudioSound.tInfo["buffer"],WebAudioSound._done,WebAudioSound._fail);};WebAudioSound._done=function _done(audioBuffer){WebAudioSound.e.event("loaded:"+WebAudioSound.tInfo.url,audioBuffer);WebAudioSound.isDecoding=false;WebAudioSound.decode();};WebAudioSound._fail=function _fail(){WebAudioSound.e.event("err:"+WebAudioSound.tInfo.url,null);WebAudioSound.isDecoding=false;WebAudioSound.decode();};WebAudioSound._playEmptySound=function _playEmptySound(){if(WebAudioSound.ctx==null){return;}var source=WebAudioSound.ctx.createBufferSource();source.buffer=WebAudioSound._miniBuffer;source.connect(WebAudioSound.ctx.destination);source.start(0,0,0);};WebAudioSound._unlock=function _unlock(){if(WebAudioSound._unlocked){return;}WebAudioSound._playEmptySound();if(WebAudioSound.ctx.state=="running"){window.document.removeEventListener("mousedown",WebAudioSound._unlock,true);window.document.removeEventListener("touchend",WebAudioSound._unlock,true);window.document.removeEventListener("touchstart",WebAudioSound._unlock,true);WebAudioSound._unlocked=true;}};WebAudioSound.initWebAudio=function initWebAudio(){if(WebAudioSound.ctx.state!="running"){WebAudioSound._unlock();window.document.addEventListener("mousedown",WebAudioSound._unlock,true);window.document.addEventListener("touchend",WebAudioSound._unlock,true);window.document.addEventListener("touchstart",WebAudioSound._unlock,true);}};var _proto109=WebAudioSound.prototype;_proto109.load=function load(url){var me=this;url=URL.formatURL(url);this.url=url;this.audioBuffer=WebAudioSound._dataCache[url];if(this.audioBuffer){this._loaded(this.audioBuffer);return;}WebAudioSound.e.on("loaded:"+url,this,this._loaded);WebAudioSound.e.on("err:"+url,this,this._err);if(WebAudioSound.__loadingSound[url]){return;}WebAudioSound.__loadingSound[url]=true;var request=new XMLHttpRequest();request.open("GET",url,true);request.responseType="arraybuffer";request.onload=function(){if(me._disposed){me._removeLoadEvents();return;}me.data=request.response;WebAudioSound.buffs.push({"buffer":me.data,"url":me.url});WebAudioSound.decode();};request.onerror=function(e){me._err();};request.send();};_proto109._err=function _err(){this._removeLoadEvents();WebAudioSound.__loadingSound[this.url]=false;this.event(Event.ERROR);};_proto109._loaded=function _loaded(audioBuffer){this._removeLoadEvents();if(this._disposed){return;}this.audioBuffer=audioBuffer;WebAudioSound._dataCache[this.url]=this.audioBuffer;this.loaded=true;this.event(Event.COMPLETE);};_proto109._removeLoadEvents=function _removeLoadEvents(){WebAudioSound.e.off("loaded:"+this.url,this,this._loaded);WebAudioSound.e.off("err:"+this.url,this,this._err);};_proto109.__playAfterLoaded=function __playAfterLoaded(){if(!this.__toPlays)return;var i,len;var toPlays;toPlays=this.__toPlays;len=toPlays.length;var tParams;for(i=0;i<len;i++){tParams=toPlays[i];if(tParams[2]&&!tParams[2].isStopped){this.play(tParams[0],tParams[1],tParams[2]);}}this.__toPlays.length=0;};_proto109.play=function play(startTime,loops,channel){if(startTime===void 0){startTime=0;}if(loops===void 0){loops=0;}if(channel===void 0){channel=null;}channel=channel?channel:new WebAudioSoundChannel();if(!this.audioBuffer){if(this.url){if(!this.__toPlays)this.__toPlays=[];this.__toPlays.push([startTime,loops,channel]);this.once(Event.COMPLETE,this,this.__playAfterLoaded);this.load(this.url);}}channel.url=this.url;channel.loops=loops;channel.audioBuffer=this.audioBuffer;channel.startTime=startTime;channel.play();ILaya.SoundManager.addChannel(channel);return channel;};_proto109.dispose=function dispose(){this._disposed=true;delete WebAudioSound._dataCache[this.url];delete WebAudioSound.__loadingSound[this.url];this.audioBuffer=null;this.data=null;this.__toPlays=[];};_createClass(WebAudioSound,[{key:"duration",get:function get(){if(this.audioBuffer){return this.audioBuffer.duration;}return 0;}}]);return WebAudioSound;}(EventDispatcher);WebAudioSound._dataCache={};WebAudioSound.webAudioEnabled=window["AudioContext"]||window["webkitAudioContext"]||window["mozAudioContext"];WebAudioSound.ctx=WebAudioSound.webAudioEnabled?new(window["AudioContext"]||window["webkitAudioContext"]||window["mozAudioContext"])():undefined;WebAudioSound.buffs=[];WebAudioSound.isDecoding=false;WebAudioSound._miniBuffer=WebAudioSound.ctx?WebAudioSound.ctx.createBuffer(1,1,22050):undefined;WebAudioSound.e=new EventDispatcher();WebAudioSound._unlocked=false;WebAudioSound.__loadingSound={};var SoundManager=/*#__PURE__*/function(){function SoundManager(){}SoundManager.__init__=function __init__(){var win=ILaya.Browser.window;var supportWebAudio=win["AudioContext"]||win["webkitAudioContext"]||win["mozAudioContext"]?true:false;if(supportWebAudio)WebAudioSound.initWebAudio();SoundManager._soundClass=supportWebAudio?WebAudioSound:AudioSound;AudioSound._initMusicAudio();SoundManager._musicClass=AudioSound;return supportWebAudio;};SoundManager.addChannel=function addChannel(channel){if(SoundManager._channels.indexOf(channel)>=0)return;SoundManager._channels.push(channel);};SoundManager.removeChannel=function removeChannel(channel){var i;for(i=SoundManager._channels.length-1;i>=0;i--){if(SoundManager._channels[i]==channel){SoundManager._channels.splice(i,1);}}};SoundManager.disposeSoundLater=function disposeSoundLater(url){SoundManager._lastSoundUsedTimeDic[url]=ILaya.Browser.now();if(!SoundManager._isCheckingDispose){SoundManager._isCheckingDispose=true;ILaya.timer.loop(5000,null,SoundManager._checkDisposeSound);}};SoundManager._checkDisposeSound=function _checkDisposeSound(){var key;var tTime=ILaya.Browser.now();var hasCheck=false;for(key in SoundManager._lastSoundUsedTimeDic){if(tTime-SoundManager._lastSoundUsedTimeDic[key]>30000){delete SoundManager._lastSoundUsedTimeDic[key];SoundManager.disposeSoundIfNotUsed(key);}else {hasCheck=true;}}if(!hasCheck){SoundManager._isCheckingDispose=false;ILaya.timer.clear(null,SoundManager._checkDisposeSound);}};SoundManager.disposeSoundIfNotUsed=function disposeSoundIfNotUsed(url){var i;for(i=SoundManager._channels.length-1;i>=0;i--){if(SoundManager._channels[i].url==url){return;}}SoundManager.destroySound(url);};SoundManager._visibilityChange=function _visibilityChange(){if(ILaya.stage.isVisibility){SoundManager._stageOnFocus();}else {SoundManager._stageOnBlur();}};SoundManager._stageOnBlur=function _stageOnBlur(){SoundManager._isActive=false;if(SoundManager._musicChannel){if(!SoundManager._musicChannel.isStopped){SoundManager._blurPaused=true;SoundManager._musicChannel.pause();}}SoundManager.stopAllSound();ILaya.stage.once(Event.MOUSE_DOWN,null,SoundManager._stageOnFocus);};SoundManager._recoverWebAudio=function _recoverWebAudio(){if(WebAudioSound.ctx&&WebAudioSound.ctx.state!="running"&&WebAudioSound.ctx.resume)WebAudioSound.ctx.resume();};SoundManager._stageOnFocus=function _stageOnFocus(){SoundManager._isActive=true;SoundManager._recoverWebAudio();ILaya.stage.off(Event.MOUSE_DOWN,null,SoundManager._stageOnFocus);if(SoundManager._blurPaused){if(SoundManager._musicChannel&&SoundManager._musicChannel.isStopped){SoundManager._blurPaused=false;SoundManager._musicChannel.resume();}}};SoundManager.playSound=function playSound(url,loops,complete,soundClass,startTime){if(loops===void 0){loops=1;}if(complete===void 0){complete=null;}if(soundClass===void 0){soundClass=null;}if(startTime===void 0){startTime=0;}if(!SoundManager._isActive||!url)return null;if(SoundManager._muted)return null;SoundManager._recoverWebAudio();url=URL.formatURL(url);if(url==SoundManager._bgMusic){if(SoundManager._musicMuted)return null;}else {if(ILaya.Render.isConchApp){var ext=Utils.getFileExtension(url);if(ext!="wav"&&ext!="ogg"){alert("The sound only supports wav or ogg format,for optimal performance reason,please refer to the official website document.");return null;}}if(SoundManager._soundMuted)return null;}var tSound;if(!ILaya.Browser.onBDMiniGame&&!ILaya.Browser.onMiniGame&&!ILaya.Browser.onKGMiniGame&&!ILaya.Browser.onQGMiniGame&&!ILaya.Browser.onVVMiniGame&&!ILaya.Browser.onAlipayMiniGame&&!ILaya.Browser.onQQMiniGame&&!ILaya.Browser.onBLMiniGame&&!ILaya.Browser.onTTMiniGame&&!ILaya.Browser.onHWMiniGame){tSound=ILaya.loader.getRes(url);}if(!soundClass)soundClass=SoundManager._soundClass;if(!tSound){tSound=new soundClass();tSound.load(url);if(!ILaya.Browser.onBDMiniGame&&!ILaya.Browser.onMiniGame&&!ILaya.Browser.onKGMiniGame&&!ILaya.Browser.onQGMiniGame&&!ILaya.Browser.onVVMiniGame&&!ILaya.Browser.onAlipayMiniGame&&!ILaya.Browser.onQQMiniGame&&!ILaya.Browser.onBLMiniGame&&!ILaya.Browser.onTTMiniGame&&!ILaya.Browser.onHWMiniGame){ILaya.Loader.cacheRes(url,tSound);}}var channel;channel=tSound.play(startTime,loops);if(!channel)return null;channel.url=url;channel.volume=url==SoundManager._bgMusic?SoundManager.musicVolume:SoundManager.soundVolume;channel.completeHandler=complete;return channel;};SoundManager.destroySound=function destroySound(url){var tSound=ILaya.loader.getRes(url);if(tSound){ILaya.Loader.clearRes(url);tSound.dispose();}};SoundManager.playMusic=function playMusic(url,loops,complete,startTime){if(loops===void 0){loops=0;}if(complete===void 0){complete=null;}if(startTime===void 0){startTime=0;}url=URL.formatURL(url);SoundManager._bgMusic=url;if(SoundManager._musicChannel)SoundManager._musicChannel.stop();return SoundManager._musicChannel=SoundManager.playSound(url,loops,complete,SoundManager._musicClass,startTime);};SoundManager.stopSound=function stopSound(url){url=URL.formatURL(url);var i;var channel;for(i=SoundManager._channels.length-1;i>=0;i--){channel=SoundManager._channels[i];if(channel.url==url){channel.stop();}}};SoundManager.stopAll=function stopAll(){SoundManager._bgMusic=null;var i;var channel;for(i=SoundManager._channels.length-1;i>=0;i--){channel=SoundManager._channels[i];channel.stop();}};SoundManager.stopAllSound=function stopAllSound(){var i;var channel;for(i=SoundManager._channels.length-1;i>=0;i--){channel=SoundManager._channels[i];if(channel.url!=SoundManager._bgMusic){channel.stop();}}};SoundManager.stopMusic=function stopMusic(){if(SoundManager._musicChannel)SoundManager._musicChannel.stop();SoundManager._bgMusic=null;};SoundManager.setSoundVolume=function setSoundVolume(volume,url){if(url===void 0){url=null;}if(url){url=URL.formatURL(url);SoundManager._setVolume(url,volume);}else {SoundManager.soundVolume=volume;var i;var channel;for(i=SoundManager._channels.length-1;i>=0;i--){channel=SoundManager._channels[i];if(channel.url!=SoundManager._bgMusic){channel.volume=volume;}}}};SoundManager.setMusicVolume=function setMusicVolume(volume){SoundManager.musicVolume=volume;SoundManager._setVolume(SoundManager._bgMusic,volume);};SoundManager._setVolume=function _setVolume(url,volume){url=URL.formatURL(url);var i;var channel;for(i=SoundManager._channels.length-1;i>=0;i--){channel=SoundManager._channels[i];if(channel.url==url){channel.volume=volume;}}};_createClass(SoundManager,null,[{key:"autoStopMusic",set:function set(v){ILaya.stage.off(Event.BLUR,null,SoundManager._stageOnBlur);ILaya.stage.off(Event.FOCUS,null,SoundManager._stageOnFocus);ILaya.stage.off(Event.VISIBILITY_CHANGE,null,SoundManager._visibilityChange);SoundManager._autoStopMusic=v;if(v){ILaya.stage.on(Event.BLUR,null,SoundManager._stageOnBlur);ILaya.stage.on(Event.FOCUS,null,SoundManager._stageOnFocus);ILaya.stage.on(Event.VISIBILITY_CHANGE,null,SoundManager._visibilityChange);}},get:function get(){return SoundManager._autoStopMusic;}},{key:"muted",set:function set(value){if(value==SoundManager._muted)return;if(value){SoundManager.stopAllSound();}SoundManager.musicMuted=value;SoundManager._muted=value;},get:function get(){return SoundManager._muted;}},{key:"soundMuted",set:function set(value){SoundManager._soundMuted=value;},get:function get(){return SoundManager._soundMuted;}},{key:"musicMuted",set:function set(value){if(value==SoundManager._musicMuted)return;if(value){if(SoundManager._bgMusic){if(SoundManager._musicChannel&&!SoundManager._musicChannel.isStopped){if(ILaya.Render.isConchApp){if(SoundManager._musicChannel._audio)SoundManager._musicChannel._audio.muted=true;}else {SoundManager._musicChannel.pause();}}else {SoundManager._musicChannel=null;}}else {SoundManager._musicChannel=null;}SoundManager._musicMuted=value;}else {SoundManager._musicMuted=value;if(SoundManager._bgMusic){if(SoundManager._musicChannel){if(ILaya.Render.isConchApp){if(SoundManager._musicChannel._audio)SoundManager._musicChannel._audio.muted=false;}else {SoundManager._musicChannel.resume();}}}}},get:function get(){return SoundManager._musicMuted;}},{key:"useAudioMusic",get:function get(){return SoundManager._useAudioMusic;},set:function set(value){SoundManager._useAudioMusic=value;if(value){SoundManager._musicClass=AudioSound;}else {SoundManager._musicClass=null;}}}]);return SoundManager;}();SoundManager.musicVolume=1;SoundManager.soundVolume=1;SoundManager.playbackRate=1;SoundManager._useAudioMusic=true;SoundManager._muted=false;SoundManager._soundMuted=false;SoundManager._musicMuted=false;SoundManager._bgMusic=null;SoundManager._musicChannel=null;SoundManager._channels=[];SoundManager._blurPaused=false;SoundManager._isActive=true;SoundManager._lastSoundUsedTimeDic={};SoundManager._isCheckingDispose=false;SoundManager.autoReleaseSound=true;var Prefab=/*#__PURE__*/function(){function Prefab(){}var _proto110=Prefab.prototype;_proto110.create=function create(){if(this.json)return ILaya.SceneUtils.createByData(null,this.json);return null;};return Prefab;}();var BitmapFont=/*#__PURE__*/function(){function BitmapFont(){this._fontCharDic={};this._fontWidthMap={};this._maxWidth=0;this._spaceWidth=10;this.fontSize=12;this.autoScaleSize=false;this.letterSpacing=0;}var _proto111=BitmapFont.prototype;_proto111.loadFont=function loadFont(path,complete){this._path=path;this._complete=complete;if(!path||path.indexOf(".fnt")===-1){console.error('Bitmap font configuration information must be a ".fnt" file');return;}ILaya.loader.load([{url:path,type:ILaya.Loader.XML},{url:path.replace(".fnt",".png"),type:ILaya.Loader.IMAGE}],Handler.create(this,this._onLoaded));};_proto111._onLoaded=function _onLoaded(){this.parseFont(ILaya.Loader.getRes(this._path),ILaya.Loader.getRes(this._path.replace(".fnt",".png")));this._complete&&this._complete.run();};_proto111.parseFont=function parseFont(xml,texture){if(xml==null||texture==null)return;this._texture=texture;var tScale=1;var tInfo=xml.getElementsByTagName("info");if(!tInfo[0].getAttributeNode){return this.parseFont2(xml,texture);}this.fontSize=parseInt(tInfo[0].getAttributeNode("size").nodeValue);var tPadding=tInfo[0].getAttributeNode("padding").nodeValue;var tPaddingArray=tPadding.split(",");this._padding=[parseInt(tPaddingArray[0]),parseInt(tPaddingArray[1]),parseInt(tPaddingArray[2]),parseInt(tPaddingArray[3])];var chars=xml.getElementsByTagName("char");var i=0;for(i=0;i<chars.length;i++){var tAttribute=chars[i];var tId=parseInt(tAttribute.getAttributeNode("id").nodeValue);var xOffset=parseInt(tAttribute.getAttributeNode("xoffset").nodeValue)/tScale;var yOffset=parseInt(tAttribute.getAttributeNode("yoffset").nodeValue)/tScale;var xAdvance=parseInt(tAttribute.getAttributeNode("xadvance").nodeValue)/tScale;var region=new Rectangle();region.x=parseInt(tAttribute.getAttributeNode("x").nodeValue);region.y=parseInt(tAttribute.getAttributeNode("y").nodeValue);region.width=parseInt(tAttribute.getAttributeNode("width").nodeValue);region.height=parseInt(tAttribute.getAttributeNode("height").nodeValue);var tTexture=Texture.create(texture,region.x,region.y,region.width,region.height,xOffset,yOffset);this._maxWidth=Math.max(this._maxWidth,xAdvance+this.letterSpacing);this._fontCharDic[tId]=tTexture;this._fontWidthMap[tId]=xAdvance;}};_proto111.parseFont2=function parseFont2(xml,texture){if(xml==null||texture==null)return;this._texture=texture;var tScale=1;var tInfo=xml.getElementsByTagName("info");this.fontSize=parseInt(tInfo[0].attributes["size"].nodeValue);var tPadding=tInfo[0].attributes["padding"].nodeValue;var tPaddingArray=tPadding.split(",");this._padding=[parseInt(tPaddingArray[0]),parseInt(tPaddingArray[1]),parseInt(tPaddingArray[2]),parseInt(tPaddingArray[3])];var chars=xml.getElementsByTagName("char");var i=0;for(i=0;i<chars.length;i++){var tAttribute=chars[i].attributes;var tId=parseInt(tAttribute["id"].nodeValue);var xOffset=parseInt(tAttribute["xoffset"].nodeValue)/tScale;var yOffset=parseInt(tAttribute["yoffset"].nodeValue)/tScale;var xAdvance=parseInt(tAttribute["xadvance"].nodeValue)/tScale;var region=new Rectangle();region.x=parseInt(tAttribute["x"].nodeValue);region.y=parseInt(tAttribute["y"].nodeValue);region.width=parseInt(tAttribute["width"].nodeValue);region.height=parseInt(tAttribute["height"].nodeValue);var tTexture=Texture.create(texture,region.x,region.y,region.width,region.height,xOffset,yOffset);this._maxWidth=Math.max(this._maxWidth,xAdvance+this.letterSpacing);this._fontCharDic[tId]=tTexture;this._fontWidthMap[tId]=xAdvance;}};_proto111.getCharTexture=function getCharTexture(_char5){return this._fontCharDic[_char5.charCodeAt(0)];};_proto111.destroy=function destroy(){if(this._texture){for(var p in this._fontCharDic){var tTexture=this._fontCharDic[p];if(tTexture)tTexture.destroy();}this._texture.destroy();this._fontCharDic=null;this._fontWidthMap=null;this._texture=null;this._complete=null;this._padding=null;}};_proto111.setSpaceWidth=function setSpaceWidth(spaceWidth){this._spaceWidth=spaceWidth;};_proto111.getCharWidth=function getCharWidth(_char6){var code=_char6.charCodeAt(0);if(this._fontWidthMap[code])return this._fontWidthMap[code]+this.letterSpacing;if(_char6===" ")return this._spaceWidth+this.letterSpacing;return 0;};_proto111.getTextWidth=function getTextWidth(text){var tWidth=0;for(var i=0,n=text.length;i<n;i++){tWidth+=this.getCharWidth(text.charAt(i));}return tWidth;};_proto111.getMaxWidth=function getMaxWidth(){return this._maxWidth;};_proto111.getMaxHeight=function getMaxHeight(){return this.fontSize;};_proto111._drawText=function _drawText(text,sprite,drawX,drawY,align,width){var tWidth=this.getTextWidth(text);var tTexture;var dx=0;align==="center"&&(dx=(width-tWidth)/2);align==="right"&&(dx=width-tWidth);var tx=0;for(var i=0,n=text.length;i<n;i++){tTexture=this.getCharTexture(text.charAt(i));if(tTexture){sprite.graphics.drawImage(tTexture,drawX+tx+dx,drawY);tx+=this.getCharWidth(text.charAt(i));}}};return BitmapFont;}();ClassUtils.regClass("laya.display.BitmapFont",BitmapFont);ClassUtils.regClass("Laya.BitmapFont",BitmapFont);var HttpRequest=/*#__PURE__*/function(_EventDispatcher7){_inheritsLoose(HttpRequest,_EventDispatcher7);function HttpRequest(){var _this33;_this33=_EventDispatcher7.apply(this,arguments)||this;_this33._http=new XMLHttpRequest();return _this33;}var _proto112=HttpRequest.prototype;_proto112.send=function send(url,data,method,responseType,headers){if(data===void 0){data=null;}if(method===void 0){method="get";}if(responseType===void 0){responseType="text";}if(headers===void 0){headers=null;}this._responseType=responseType;this._data=null;if(Browser.onVVMiniGame||Browser.onQGMiniGame||Browser.onQQMiniGame||Browser.onAlipayMiniGame||Browser.onBLMiniGame||Browser.onHWMiniGame||Browser.onTTMiniGame){url=HttpRequest._urlEncode(url);}this._url=url;var _this=this;var http=this._http;url=URL.getAdptedFilePath(url);http.open(method,url,true);var isJson=false;if(headers){for(var i=0;i<headers.length;i++){http.setRequestHeader(headers[i++],headers[i]);}}else if(!window.conch){if(!data||typeof data=='string')http.setRequestHeader("Content-Type","application/x-www-form-urlencoded");else {http.setRequestHeader("Content-Type","application/json");isJson=true;}}var restype=responseType!=="arraybuffer"?"text":"arraybuffer";http.responseType=restype;if(http.dataType){http.dataType=restype;}http.onerror=function(e){_this._onError(e);};http.onabort=function(e){_this._onAbort(e);};http.onprogress=function(e){_this._onProgress(e);};http.onload=function(e){_this._onLoad(e);};if(Browser.onBLMiniGame&&Browser.onAndroid&&!data)data={};http.send(isJson?JSON.stringify(data):data);};_proto112._onProgress=function _onProgress(e){if(e&&e.lengthComputable)this.event(Event.PROGRESS,e.loaded/e.total);};_proto112._onAbort=function _onAbort(e){this.error("Request was aborted by user");};_proto112._onError=function _onError(e){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText);};_proto112._onLoad=function _onLoad(e){var http=this._http;var status=http.status!==undefined?http.status:200;if(status===200||status===204||status===0){this.complete();}else {this.error("["+http.status+"]"+http.statusText+":"+http.responseURL);}};_proto112.error=function error(message){this.clear();console.warn(this.url,message);this.event(Event.ERROR,message);};_proto112.complete=function complete(){this.clear();var flag=true;try{if(this._responseType==="json"){this._data=JSON.parse(this._http.responseText);}else if(this._responseType==="xml"){this._data=Utils.parseXMLFromString(this._http.responseText);}else {this._data=this._http.response||this._http.responseText;}}catch(e){flag=false;this.error(e.message);}flag&&this.event(Event.COMPLETE,this._data instanceof Array?[this._data]:this._data);};_proto112.clear=function clear(){var http=this._http;http.onerror=http.onabort=http.onprogress=http.onload=null;};_createClass(HttpRequest,[{key:"url",get:function get(){return this._url;}},{key:"data",get:function get(){return this._data;}},{key:"http",get:function get(){return this._http;}}]);return HttpRequest;}(EventDispatcher);HttpRequest._urlEncode=encodeURI;var Loader=/*#__PURE__*/function(_EventDispatcher8){_inheritsLoose(Loader,_EventDispatcher8);function Loader(){var _this34;_this34=_EventDispatcher8.apply(this,arguments)||this;_this34._customParse=false;return _this34;}Loader.getTypeFromUrl=function getTypeFromUrl(url){var type=Utils.getFileExtension(url);if(type)return Loader.typeMap[type];console.warn("Not recognize the resources suffix",url);return "text";};var _proto113=Loader.prototype;_proto113.load=function load(url,type,cache,group,ignoreCache,useWorkerLoader){if(type===void 0){type=null;}if(cache===void 0){cache=true;}if(group===void 0){group=null;}if(ignoreCache===void 0){ignoreCache=false;}if(useWorkerLoader===void 0){useWorkerLoader=ILaya.WorkerLoader.enable;}if(!url){this.onLoaded(null);return;}Loader.setGroup(url,"666");this._url=url;if(url.indexOf("data:image")===0)type=Loader.IMAGE;else url=URL.formatURL(url);this._type=type||(type=Loader.getTypeFromUrl(this._url));this._cache=cache;this._useWorkerLoader=useWorkerLoader;this._data=null;if(useWorkerLoader)ILaya.WorkerLoader.enableWorkerLoader();var cacheRes;if(type==Loader.IMAGE)cacheRes=Loader.textureMap[url];else cacheRes=Loader.loadedMap[url];if(!ignoreCache&&cacheRes){this._data=cacheRes;this.event(Event.PROGRESS,1);this.event(Event.COMPLETE,this._data);return;}if(group)Loader.setGroup(url,group);if(Loader.parserMap[type]!=null){this._customParse=true;if(Loader.parserMap[type]instanceof Handler)Loader.parserMap[type].runWith(this);else Loader.parserMap[type].call(null,this);return;}this._loadResourceFilter(type,url);};_proto113._loadResourceFilter=function _loadResourceFilter(type,url){this._loadResource(type,url);};_proto113._loadResource=function _loadResource(type,url){switch(type){case Loader.IMAGE:case"htmlimage":case"nativeimage":this._loadImage(url);break;case Loader.SOUND:this._loadSound(url);break;case Loader.TTF:this._loadTTF(url);break;case Loader.ATLAS:case Loader.PREFAB:case Loader.PLF:this._loadHttpRequestWhat(url,Loader.JSON);break;case Loader.FONT:this._loadHttpRequestWhat(url,Loader.XML);break;case Loader.PLFB:this._loadHttpRequestWhat(url,Loader.BUFFER);break;default:this._loadHttpRequestWhat(url,type);}};_proto113._loadHttpRequest=function _loadHttpRequest(url,contentType,onLoadCaller,onLoad,onProcessCaller,onProcess,onErrorCaller,onError){if(Browser.onVVMiniGame||Browser.onHWMiniGame){this._http=new HttpRequest();}else {if(!this._http)this._http=new HttpRequest();}onProcess&&this._http.on(Event.PROGRESS,onProcessCaller,onProcess);onLoad&&this._http.on(Event.COMPLETE,onLoadCaller,onLoad);this._http.on(Event.ERROR,onErrorCaller,onError);this._http.send(url,null,"get",contentType);};_proto113._loadHtmlImage=function _loadHtmlImage(url,onLoadCaller,onLoad,onErrorCaller,onError){var image;function clear(){var img=image;img.onload=null;img.onerror=null;delete Loader._imgCache[url];}var onerror=function onerror(){clear();onError.call(onErrorCaller);};var onload=function onload(){clear();onLoad.call(onLoadCaller,image);};image=new Browser.window.Image();image.crossOrigin="";image.onload=onload;image.onerror=onerror;image.src=url;Loader._imgCache[url]=image;};_proto113._loadHttpRequestWhat=function _loadHttpRequestWhat(url,contentType){if(Loader.preLoadedMap[url])this.onLoaded(Loader.preLoadedMap[url]);else this._loadHttpRequest(url,contentType,this,this.onLoaded,this,this.onProgress,this,this.onError);};_proto113._loadTTF=function _loadTTF(url){url=URL.formatURL(url);var ttfLoader=new ILaya.TTFLoader();ttfLoader.complete=Handler.create(this,this.onLoaded);ttfLoader.load(url);};_proto113._loadImage=function _loadImage(url,isformatURL){if(isformatURL===void 0){isformatURL=true;}var _this=this;if(isformatURL)url=URL.formatURL(url);var onError=function onError(){_this.event(Event.ERROR,"Load image failed");};if(this._type==="nativeimage"){this._loadHtmlImage(url,this,this.onLoaded,this,onError);}else {var ext=Utils.getFileExtension(url);if(ext==="ktx"||ext==="pvr")this._loadHttpRequest(url,Loader.BUFFER,this,this.onLoaded,this,this.onProgress,this,this.onError);else this._loadHtmlImage(url,this,this.onLoaded,this,onError);}};_proto113._loadSound=function _loadSound(url){var sound=new SoundManager._soundClass();var _this=this;sound.on(Event.COMPLETE,this,soundOnload);sound.on(Event.ERROR,this,soundOnErr);sound.load(url);function soundOnload(){clear();_this.onLoaded(sound);}function soundOnErr(){clear();sound.dispose();_this.event(Event.ERROR,"Load sound failed");}function clear(){sound.offAll();}};_proto113.onProgress=function onProgress(value){if(this._type===Loader.ATLAS)this.event(Event.PROGRESS,value*0.3);else if(this._originType==Loader.HIERARCHY)this.event(Event.PROGRESS,value/3);else this.event(Event.PROGRESS,value);};_proto113.onError=function onError(message){this.event(Event.ERROR,message);};_proto113.onLoaded=function onLoaded(data){if(data===void 0){data=null;}var type=this._type;if(type==Loader.PLFB){this.parsePLFBData(data);this.complete(data);}else if(type==Loader.PLF){this.parsePLFData(data);this.complete(data);}else if(type===Loader.IMAGE){var tex;if(data instanceof ArrayBuffer){var ext=Utils.getFileExtension(this._url);var format;switch(ext){case"ktx":format=exports.TextureFormat.ETC1RGB;break;case"pvr":format=exports.TextureFormat.PVRTCRGBA_4BPPV;break;default:{console.error('unknown format',ext);return;}}tex=new Texture2D(0,0,format,false,false);tex.wrapModeU=exports.WarpMode.Clamp;tex.wrapModeV=exports.WarpMode.Clamp;tex.setCompressData(data);tex._setCreateURL(this.url);}else if(!(data instanceof Texture2D)){tex=new Texture2D(data.width,data.height,1,false,false);tex.wrapModeU=exports.WarpMode.Clamp;tex.wrapModeV=exports.WarpMode.Clamp;tex.loadImageSource(data,true);tex._setCreateURL(data.src);}else {tex=data;}var texture=new Texture(tex);texture.url=this._url;this.complete(texture);}else if(type===Loader.SOUND||type==="nativeimage"){this.complete(data);}else if(type==="htmlimage"){var _tex2=new Texture2D(data.width,data.height,1,false,false);_tex2.wrapModeU=exports.WarpMode.Clamp;_tex2.wrapModeV=exports.WarpMode.Clamp;_tex2.loadImageSource(data,true);_tex2._setCreateURL(data.src);this.complete(_tex2);}else if(type===Loader.ATLAS){if(data.frames){var toloadPics=[];if(!this._data){this._data=data;if(data.meta&&data.meta.image){toloadPics=data.meta.image.split(",");var split=this._url.indexOf("/")>=0?"/":"\\";var idx=this._url.lastIndexOf(split);var folderPath=idx>=0?this._url.substr(0,idx+1):"";var changeType=null;if(Browser.onAndroid&&data.meta.compressTextureAndroid){changeType=".ktx";}if(Browser.onIOS&&data.meta.compressTextureIOS){changeType=".pvr";}for(var i=0,len=toloadPics.length;i<len;i++){if(changeType){toloadPics[i]=folderPath+toloadPics[i].replace(".png",changeType);}else {toloadPics[i]=folderPath+toloadPics[i];}}}else {toloadPics=[this._url.replace(".json",".png")];}toloadPics.reverse();data.toLoads=toloadPics;data.pics=[];}this.event(Event.PROGRESS,0.3+1/toloadPics.length*0.6);return this._loadResourceFilter(Loader.IMAGE,toloadPics.pop());}else {if(!(data instanceof Texture2D)){var _tex3=new Texture2D(data.width,data.height,1,false,false);_tex3.wrapModeU=BaseTexture.WARPMODE_CLAMP;_tex3.wrapModeV=BaseTexture.WARPMODE_CLAMP;_tex3.loadImageSource(data,true);_tex3._setCreateURL(data.src);data=_tex3;}this._data.pics.push(data);if(this._data.toLoads.length>0){this.event(Event.PROGRESS,0.3+1/this._data.toLoads.length*0.6);return this._loadResourceFilter(Loader.IMAGE,this._data.toLoads.pop());}var frames=this._data.frames;var cleanUrl=this._url.split("?")[0];var directory=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:cleanUrl.substring(0,cleanUrl.lastIndexOf("."))+"/";var pics=this._data.pics;var atlasURL=URL.formatURL(this._url);var map=Loader.atlasMap[atlasURL]||(Loader.atlasMap[atlasURL]=[]);map.dir=directory;var scaleRate=1;if(this._data.meta&&this._data.meta.scale&&this._data.meta.scale!=1){scaleRate=parseFloat(this._data.meta.scale);for(var name in frames){var obj=frames[name];var tPic=pics[obj.frame.idx?obj.frame.idx:0];var url=URL.formatURL(directory+name);tPic.scaleRate=scaleRate;var tTexture;tTexture=Texture._create(tPic,obj.frame.x,obj.frame.y,obj.frame.w,obj.frame.h,obj.spriteSourceSize.x,obj.spriteSourceSize.y,obj.sourceSize.w,obj.sourceSize.h,Loader.getRes(url));Loader.cacheTexture(url,tTexture);tTexture.url=url;map.push(url);}}else {for(name in frames){obj=frames[name];tPic=pics[obj.frame.idx?obj.frame.idx:0];url=URL.formatURL(directory+name);tTexture=Texture._create(tPic,obj.frame.x,obj.frame.y,obj.frame.w,obj.frame.h,obj.spriteSourceSize.x,obj.spriteSourceSize.y,obj.sourceSize.w,obj.sourceSize.h,Loader.getRes(url));Loader.cacheTexture(url,tTexture);tTexture.url=url;map.push(url);}}delete this._data.pics;this.complete(this._data);}}else if(type===Loader.FONT){if(!data._source){this._data=data;this.event(Event.PROGRESS,0.5);return this._loadResourceFilter(Loader.IMAGE,this._url.replace(".fnt",".png"));}else {var bFont=new BitmapFont();bFont.parseFont(this._data,new Texture(data));var tArr=this._url.split(".fnt")[0].split("/");var fontName=tArr[tArr.length-1];Text.registerBitmapFont(fontName,bFont);this._data=bFont;this.complete(this._data);}}else if(type===Loader.PREFAB){var prefab=new Prefab();prefab.json=data;this.complete(prefab);}else {this.complete(data);}};_proto113.parsePLFData=function parsePLFData(plfData){var type;var filePath;var fileDic;for(type in plfData){fileDic=plfData[type];switch(type){case"json":case"text":for(filePath in fileDic){Loader.preLoadedMap[URL.formatURL(filePath)]=fileDic[filePath];}break;default:for(filePath in fileDic){Loader.preLoadedMap[URL.formatURL(filePath)]=fileDic[filePath];}}}};_proto113.parsePLFBData=function parsePLFBData(plfData){var _byte2;_byte2=new Byte(plfData);var i,len;len=_byte2.getInt32();for(i=0;i<len;i++){this.parseOnePLFBFile(_byte2);}};_proto113.parseOnePLFBFile=function parseOnePLFBFile(_byte3){var fileLen;var fileName;var fileData;fileName=_byte3.getUTFString();fileLen=_byte3.getInt32();fileData=_byte3.readArrayBuffer(fileLen);Loader.preLoadedMap[URL.formatURL(fileName)]=fileData;};_proto113.complete=function complete(data){this._data=data;if(this._customParse){this.event(Event.LOADED,data instanceof Array?[data]:data);}else {Loader._loaders.push(this);if(!Loader._isWorking)Loader.checkNext();}};Loader.checkNext=function checkNext(){Loader._isWorking=true;var startTimer=Browser.now();while(Loader._startIndex<Loader._loaders.length){Loader._loaders[Loader._startIndex].endLoad();Loader._startIndex++;if(Browser.now()-startTimer>Loader.maxTimeOut){console.warn("loader callback cost a long time:"+(Browser.now()-startTimer)+" url="+Loader._loaders[Loader._startIndex-1].url);ILaya.systemTimer.frameOnce(1,null,Loader.checkNext);return;}}Loader._loaders.length=0;Loader._startIndex=0;Loader._isWorking=false;};_proto113.endLoad=function endLoad(content){if(content===void 0){content=null;}content&&(this._data=content);if(this._cache)Loader.cacheRes(this._url,this._data);this.event(Event.PROGRESS,1);this.event(Event.COMPLETE,this.data instanceof Array?[this.data]:this.data);};Loader.clearRes=function clearRes(url){url=URL.formatURL(url);var arr=Loader.getAtlas(url);if(arr){for(var i=0,n=arr.length;i<n;i++){var resUrl=arr[i];var tex=Loader.getRes(resUrl);delete Loader.textureMap[resUrl];if(tex)tex.destroy();}arr.length=0;delete Loader.atlasMap[url];}var texture=Loader.textureMap[url];if(texture){texture.destroy();delete Loader.textureMap[url];}var res=Loader.loadedMap[url];res&&delete Loader.loadedMap[url];};Loader.clearTextureRes=function clearTextureRes(url){url=URL.formatURL(url);var arr=Loader.getAtlas(url);if(arr&&arr.length>0){arr.forEach(function(t){var tex=Loader.getRes(t);if(tex instanceof Texture){tex.disposeBitmap();}});}else {var t=Loader.getRes(url);if(t instanceof Texture){t.disposeBitmap();}}};Loader.getRes=function getRes(url){var res=Loader.textureMap[URL.formatURL(url)];if(res)return res;else return Loader.loadedMap[URL.formatURL(url)];};Loader.getAtlas=function getAtlas(url){return Loader.atlasMap[URL.formatURL(url)];};Loader.cacheRes=function cacheRes(url,data){url=URL.formatURL(url);if(Loader.loadedMap[url]!=null){console.warn("Resources already exist,is repeated loading:",url);}else {if(data instanceof Texture){Loader.loadedMap[url]=data.bitmap;Loader.textureMap[url]=data;}else {Loader.loadedMap[url]=data;}}};Loader.cacheTexture=function cacheTexture(url,data){url=URL.formatURL(url);if(Loader.textureMap[url]!=null){console.warn("Resources already exist,is repeated loading:",url);}else {Loader.textureMap[url]=data;}};Loader.setGroup=function setGroup(url,group){if(!Loader.groupMap[group])Loader.groupMap[group]=[];Loader.groupMap[group].push(url);};Loader.clearResByGroup=function clearResByGroup(group){if(!Loader.groupMap[group])return;var arr=Loader.groupMap[group],i,len=arr.length;for(i=0;i<len;i++){Loader.clearRes(arr[i]);}arr.length=0;};_createClass(Loader,[{key:"url",get:function get(){return this._url;}},{key:"type",get:function get(){return this._type;}},{key:"cache",get:function get(){return this._cache;}},{key:"data",get:function get(){return this._data;}}]);return Loader;}(EventDispatcher);Loader.TEXT="text";Loader.JSON="json";Loader.PREFAB="prefab";Loader.XML="xml";Loader.BUFFER="arraybuffer";Loader.IMAGE="image";Loader.SOUND="sound";Loader.ATLAS="atlas";Loader.FONT="font";Loader.TTF="ttf";Loader.PLF="plf";Loader.PLFB="plfb";Loader.HIERARCHY="HIERARCHY";Loader.MESH="MESH";Loader.MATERIAL="MATERIAL";Loader.TEXTURE2D="TEXTURE2D";Loader.TEXTURECUBE="TEXTURECUBE";Loader.ANIMATIONCLIP="ANIMATIONCLIP";Loader.AVATAR="AVATAR";Loader.TERRAINHEIGHTDATA="TERRAINHEIGHTDATA";Loader.TERRAINRES="TERRAIN";Loader.typeMap={"ttf":"ttf","png":"image","jpg":"image","jpeg":"image","ktx":"image","pvr":"image","txt":"text","json":"json","prefab":"prefab","xml":"xml","als":"atlas","atlas":"atlas","mp3":"sound","ogg":"sound","wav":"sound","part":"json","fnt":"font","plf":"plf","plfb":"plfb","scene":"json","ani":"json","sk":"arraybuffer"};Loader.parserMap={};Loader.maxTimeOut=100;Loader.groupMap={};Loader.loadedMap={};Loader.atlasMap={};Loader.textureMap={};Loader.preLoadedMap={};Loader._imgCache={};Loader._loaders=[];Loader._isWorking=false;Loader._startIndex=0;var AtlasInfoManager=/*#__PURE__*/function(){function AtlasInfoManager(){}AtlasInfoManager.enable=function enable(infoFile,callback){if(callback===void 0){callback=null;}ILaya.loader.load(infoFile,Handler.create(null,AtlasInfoManager._onInfoLoaded,[callback]),null,Loader.JSON);};AtlasInfoManager._onInfoLoaded=function _onInfoLoaded(callback,data){var tKey;var tPrefix;var tArr;var i,len;for(tKey in data){tArr=data[tKey];tPrefix=tArr[0];tArr=tArr[1];len=tArr.length;for(i=0;i<len;i++){AtlasInfoManager._fileLoadDic[tPrefix+tArr[i]]=tKey;}}callback&&callback.run();};AtlasInfoManager.getFileLoadPath=function getFileLoadPath(file){return AtlasInfoManager._fileLoadDic[file]||file;};return AtlasInfoManager;}();AtlasInfoManager._fileLoadDic={};var LoaderManager=/*#__PURE__*/function(_EventDispatcher9){_inheritsLoose(LoaderManager,_EventDispatcher9);function LoaderManager(){var _this35;_this35=_EventDispatcher9.call(this)||this;_this35.retryNum=1;_this35.retryDelay=0;_this35.maxLoader=5;_this35._loaders=[];_this35._loaderCount=0;_this35._resInfos=[];_this35._infoPool=[];_this35._maxPriority=5;_this35._failRes={};_this35._statInfo={count:1,loaded:1};for(var i=0;i<_this35._maxPriority;i++){_this35._resInfos[i]=[];}return _this35;}var _proto114=LoaderManager.prototype;_proto114.getProgress=function getProgress(){return this._statInfo.loaded/this._statInfo.count;};_proto114.resetProgress=function resetProgress(){this._statInfo.count=this._statInfo.loaded=1;};_proto114.create=function create(url,complete,progress,type,constructParams,propertyParams,priority,cache){if(complete===void 0){complete=null;}if(progress===void 0){progress=null;}if(type===void 0){type=null;}if(constructParams===void 0){constructParams=null;}if(propertyParams===void 0){propertyParams=null;}if(priority===void 0){priority=1;}if(cache===void 0){cache=true;}this._create(url,true,complete,progress,type,constructParams,propertyParams,priority,cache);};_proto114._create=function _create(url,mainResou,complete,progress,type,constructParams,propertyParams,priority,cache){if(complete===void 0){complete=null;}if(progress===void 0){progress=null;}if(type===void 0){type=null;}if(constructParams===void 0){constructParams=null;}if(propertyParams===void 0){propertyParams=null;}if(priority===void 0){priority=1;}if(cache===void 0){cache=true;}if(url instanceof Array){var allScuess=true;var items=url;var itemCount=items.length;var loadedCount=0;if(progress){var progress2=Handler.create(progress.caller,progress?progress.method:null,progress.args,false);}for(var i=0;i<itemCount;i++){var item=items[i];if(typeof item=='string')item=items[i]={url:item};item.progress=0;}for(i=0;i<itemCount;i++){item=items[i];var progressHandler=progress?Handler.create(null,function(item,value){item.progress=value;var num=0;for(var j=0;j<itemCount;j++){var item1=items[j];num+=item1.progress;}var v=num/itemCount;progress2.runWith(v);},[item],false):null;var completeHandler=progress||complete?Handler.create(null,function(item,content){if(content===void 0){content=null;}loadedCount++;item.progress=1;content||(allScuess=false);if(loadedCount===itemCount&&complete){complete.runWith(allScuess);}},[item]):null;this._createOne(item.url,mainResou,completeHandler,progressHandler,item.type||type,item.constructParams||constructParams,item.propertyParams||propertyParams,item.priority||priority,cache);}}else {this._createOne(url,mainResou,complete,progress,type,constructParams,propertyParams,priority,cache);}};_proto114._createOne=function _createOne(url,mainResou,complete,progress,type,constructParams,propertyParams,priority,cache){if(complete===void 0){complete=null;}if(progress===void 0){progress=null;}if(type===void 0){type=null;}if(constructParams===void 0){constructParams=null;}if(propertyParams===void 0){propertyParams=null;}if(priority===void 0){priority=1;}if(cache===void 0){cache=true;}var item=this.getRes(url);if(!item){var extension=LoaderManager.createMap[Utils.getFilecompatibleExtension(url)]?Utils.getFilecompatibleExtension(url):Utils.getFileExtension(url);type||(type=LoaderManager.createMap[extension]?LoaderManager.createMap[extension][0]:null);if(!type){this.load(url,complete,progress,type,priority,cache);return;}var parserMap=Loader.parserMap;if(!parserMap[type]){this.load(url,complete,progress,type,priority,cache);return;}this._createLoad(url,Handler.create(null,function(createRes){if(createRes){if(!mainResou&&createRes instanceof Resource)createRes._addReference();createRes._setCreateURL(url);}complete&&complete.runWith(createRes);ILaya.loader.event(url);}),progress,type,constructParams,propertyParams,priority,cache,true);}else {if(!mainResou&&item instanceof Resource)item._addReference();progress&&progress.runWith(1);complete&&complete.runWith(item);}};_proto114.load=function load(url,complete,progress,type,priority,cache,group,ignoreCache,useWorkerLoader){if(complete===void 0){complete=null;}if(progress===void 0){progress=null;}if(type===void 0){type=null;}if(priority===void 0){priority=1;}if(cache===void 0){cache=true;}if(group===void 0){group=null;}if(ignoreCache===void 0){ignoreCache=false;}if(useWorkerLoader===void 0){useWorkerLoader=ILaya.WorkerLoader.enable;}if(url instanceof Array){return this._loadAssets(url,complete,progress,type,priority,cache,group);}var content;if(type===Loader.IMAGE)content=Loader.textureMap[URL.formatURL(url)];else content=Loader.loadedMap[URL.formatURL(url)];if(!ignoreCache&&content!=null){ILaya.systemTimer.callLater(this,function(){progress&&progress.runWith(1);complete&&complete.runWith(content instanceof Array?[content]:content);this._loaderCount||this.event(Event.COMPLETE);});}else {var original;original=url;url=AtlasInfoManager.getFileLoadPath(url);if(url!=original&&type!=="nativeimage"){type=Loader.ATLAS;}else {original=null;}var info=LoaderManager._resMap[url];if(!info){info=this._infoPool.length?this._infoPool.pop():new ResInfo();info.url=url;info.type=type;info.cache=cache;info.group=group;info.ignoreCache=ignoreCache;info.useWorkerLoader=useWorkerLoader;info.originalUrl=original;complete&&info.on(Event.COMPLETE,complete.caller,complete.method,complete.args);progress&&info.on(Event.PROGRESS,progress.caller,progress.method,progress.args);LoaderManager._resMap[url]=info;priority=priority<this._maxPriority?priority:this._maxPriority-1;this._resInfos[priority].push(info);this._statInfo.count++;this.event(Event.PROGRESS,this.getProgress());this._next();}else {if(complete){if(original){complete&&info._createListener(Event.COMPLETE,this,this._resInfoLoaded,[original,complete],false,false);}else {complete&&info._createListener(Event.COMPLETE,complete.caller,complete.method,complete.args,false,false);}}progress&&info._createListener(Event.PROGRESS,progress.caller,progress.method,progress.args,false,false);}}return this;};_proto114._resInfoLoaded=function _resInfoLoaded(original,complete){complete.runWith(Loader.getRes(original));};_proto114._createLoad=function _createLoad(url,complete,progress,type,constructParams,propertyParams,priority,cache,ignoreCache){if(complete===void 0){complete=null;}if(progress===void 0){progress=null;}if(type===void 0){type=null;}if(constructParams===void 0){constructParams=null;}if(propertyParams===void 0){propertyParams=null;}if(priority===void 0){priority=1;}if(cache===void 0){cache=true;}if(ignoreCache===void 0){ignoreCache=false;}if(url instanceof Array)return this._loadAssets(url,complete,progress,type,priority,cache);var content=Loader.getRes(url);if(content!=null){ILaya.systemTimer.frameOnce(1,this,function(){progress&&progress.runWith(1);complete&&complete.runWith(content);this._loaderCount||this.event(Event.COMPLETE);});}else {var info=LoaderManager._resMap[url];if(!info){info=this._infoPool.length?this._infoPool.pop():new ResInfo();info.url=url;info.type=type;info.cache=false;info.ignoreCache=ignoreCache;info.originalUrl=null;info.group=null;info.createCache=cache;info.createConstructParams=constructParams;info.createPropertyParams=propertyParams;complete&&info.on(Event.COMPLETE,complete.caller,complete.method,complete.args);progress&&info.on(Event.PROGRESS,progress.caller,progress.method,progress.args);LoaderManager._resMap[url]=info;priority=priority<this._maxPriority?priority:this._maxPriority-1;this._resInfos[priority].push(info);this._statInfo.count++;this.event(Event.PROGRESS,this.getProgress());this._next();}else {complete&&info._createListener(Event.COMPLETE,complete.caller,complete.method,complete.args,false,false);progress&&info._createListener(Event.PROGRESS,progress.caller,progress.method,progress.args,false,false);}}return this;};_proto114._next=function _next(){if(this._loaderCount>=this.maxLoader)return;for(var i=0;i<this._maxPriority;i++){var infos=this._resInfos[i];while(infos.length>0){var info=infos.shift();if(info)return this._doLoad(info);}}this._loaderCount||this.event(Event.COMPLETE);};_proto114._doLoad=function _doLoad(resInfo){this._loaderCount++;var loader=this._loaders.length?this._loaders.pop():new Loader();loader.on(Event.COMPLETE,null,onLoaded);loader.on(Event.PROGRESS,null,function(num){resInfo.event(Event.PROGRESS,num);});loader.on(Event.ERROR,null,function(msg){onLoaded(null);});var _me=this;function onLoaded(data){if(data===void 0){data=null;}loader.offAll();loader._data=null;loader._customParse=false;_me._loaders.push(loader);_me._endLoad(resInfo,data instanceof Array?[data]:data);_me._loaderCount--;_me._next();}loader._constructParams=resInfo.createConstructParams;loader._propertyParams=resInfo.createPropertyParams;loader._createCache=resInfo.createCache;loader.load(resInfo.url,resInfo.type,resInfo.cache,resInfo.group,resInfo.ignoreCache,resInfo.useWorkerLoader);};_proto114._endLoad=function _endLoad(resInfo,content){var url=resInfo.url;if(content==null){var errorCount=this._failRes[url]||0;if(errorCount<this.retryNum){console.warn("[warn]Retry to load:",url);this._failRes[url]=errorCount+1;ILaya.systemTimer.once(this.retryDelay,this,this._addReTry,[resInfo],false);return;}else {Loader.clearRes(url);console.warn("[error]Failed to load:",url);this.event(Event.ERROR,url);}}if(this._failRes[url])this._failRes[url]=0;delete LoaderManager._resMap[url];if(resInfo.originalUrl){content=Loader.getRes(resInfo.originalUrl);}resInfo.event(Event.COMPLETE,content);resInfo.offAll();this._infoPool.push(resInfo);this._statInfo.loaded++;this.event(Event.PROGRESS,this.getProgress());};_proto114._addReTry=function _addReTry(resInfo){this._resInfos[this._maxPriority-1].push(resInfo);this._next();};_proto114.clearRes=function clearRes(url){Loader.clearRes(url);};_proto114.clearTextureRes=function clearTextureRes(url){Loader.clearTextureRes(url);};_proto114.getRes=function getRes(url){return Loader.getRes(url);};_proto114.cacheRes=function cacheRes(url,data){Loader.cacheRes(url,data);};_proto114.setGroup=function setGroup(url,group){Loader.setGroup(url,group);};_proto114.clearResByGroup=function clearResByGroup(group){Loader.clearResByGroup(group);};LoaderManager.cacheRes=function cacheRes(url,data){Loader.cacheRes(url,data);};_proto114.clearUnLoaded=function clearUnLoaded(){for(var i=0;i<this._maxPriority;i++){var infos=this._resInfos[i];for(var j=infos.length-1;j>-1;j--){var info=infos[j];if(info){info.offAll();this._infoPool.push(info);}}infos.length=0;}this._loaderCount=0;LoaderManager._resMap={};};_proto114.cancelLoadByUrls=function cancelLoadByUrls(urls){if(!urls)return;for(var i=0,n=urls.length;i<n;i++){this.cancelLoadByUrl(urls[i]);}};_proto114.cancelLoadByUrl=function cancelLoadByUrl(url){for(var i=0;i<this._maxPriority;i++){var infos=this._resInfos[i];for(var j=infos.length-1;j>-1;j--){var info=infos[j];if(info&&info.url===url){infos[j]=null;info.offAll();this._infoPool.push(info);}}}if(LoaderManager._resMap[url])delete LoaderManager._resMap[url];};_proto114._loadAssets=function _loadAssets(arr,complete,progress,type,priority,cache,group){if(complete===void 0){complete=null;}if(progress===void 0){progress=null;}if(type===void 0){type=null;}if(priority===void 0){priority=1;}if(cache===void 0){cache=true;}if(group===void 0){group=null;}var itemCount=arr.length;var loadedCount=0;var totalSize=0;var items=[];var success=true;for(var i=0;i<itemCount;i++){var url=arr[i];var item=void 0;if(typeof url=='string')item={url:url,type:type,size:1,priority:priority};else item=url;if(!item.size)item.size=1;item.progress=0;totalSize+=item.size;items.push(item);var progressHandler=progress?Handler.create(null,loadProgress,[item],false):null;var completeHandler=complete||progress?Handler.create(null,loadComplete,[item]):null;this.load(item.url,completeHandler,progressHandler,item.type,item.priority||1,cache,item.group||group,false,item.useWorkerLoader);}function loadComplete(item,content){if(content===void 0){content=null;}loadedCount++;item.progress=1;if(!content)success=false;if(loadedCount===itemCount&&complete){complete.runWith(success);}}function loadProgress(item,value){if(progress!=null){item.progress=value;var num=0;for(var j=0;j<items.length;j++){var item1=items[j];if(item1){var prog=item1.progress==undefined?0:item1.progress;num+=item1.size==undefined?0:item1.size*prog;}}var v=num/totalSize;progress.runWith(v);}}return this;};_proto114.decodeBitmaps=function decodeBitmaps(urls){var i,len=urls.length;var ctx;ctx=ILaya.Render._context;for(i=0;i<len;i++){var atlas;atlas=Loader.getAtlas(urls[i]);if(atlas){this._decodeTexture(atlas[0],ctx);}else {var tex;tex=this.getRes(urls[i]);if(tex&&tex instanceof Texture){this._decodeTexture(tex,ctx);}}}};_proto114._decodeTexture=function _decodeTexture(tex,ctx){var bitmap=tex.bitmap;if(!tex||!bitmap)return;var tImg=bitmap.source||bitmap.image;if(!tImg)return;if(tImg instanceof HTMLImageElement){ctx.drawImage(tImg,0,0,1,1);var info=ctx.getImageData(0,0,1,1);}};return LoaderManager;}(EventDispatcher);LoaderManager._resMap={};LoaderManager.createMap={atlas:[null,Loader.ATLAS]};var ResInfo=/*#__PURE__*/function(_EventDispatcher10){_inheritsLoose(ResInfo,_EventDispatcher10);function ResInfo(){return _EventDispatcher10.apply(this,arguments)||this;}return ResInfo;}(EventDispatcher);var LocalStorage=/*#__PURE__*/function(){function LocalStorage(){}LocalStorage.__init__=function __init__(){if(!LocalStorage._baseClass){LocalStorage._baseClass=Storage;Storage.init();}LocalStorage.items=LocalStorage._baseClass.items;LocalStorage.support=LocalStorage._baseClass.support;return LocalStorage.support;};LocalStorage.setItem=function setItem(key,value){LocalStorage._baseClass.setItem(key,value);};LocalStorage.getItem=function getItem(key){return LocalStorage._baseClass.getItem(key);};LocalStorage.setJSON=function setJSON(key,value){LocalStorage._baseClass.setJSON(key,value);};LocalStorage.getJSON=function getJSON(key){return LocalStorage._baseClass.getJSON(key);};LocalStorage.removeItem=function removeItem(key){LocalStorage._baseClass.removeItem(key);};LocalStorage.clear=function clear(){LocalStorage._baseClass.clear();};return LocalStorage;}();LocalStorage.support=false;var Storage=/*#__PURE__*/function(){function Storage(){}Storage.init=function init(){try{Storage.support=true;Storage.items=window.localStorage;Storage.setItem('laya','1');Storage.removeItem('laya');}catch(e){Storage.support=false;}if(!Storage.support)console.log('LocalStorage is not supprot or browser is private mode.');};Storage.setItem=function setItem(key,value){try{Storage.support&&Storage.items.setItem(key,value);}catch(e){console.warn("set localStorage failed",e);}};Storage.getItem=function getItem(key){return Storage.support?Storage.items.getItem(key):null;};Storage.setJSON=function setJSON(key,value){try{Storage.support&&Storage.items.setItem(key,JSON.stringify(value));}catch(e){console.warn("set localStorage failed",e);}};Storage.getJSON=function getJSON(key){try{var obj=JSON.parse(Storage.support?Storage.items.getItem(key):null);return obj;}catch(err){return Storage.items.getItem(key);}};Storage.removeItem=function removeItem(key){Storage.support&&Storage.items.removeItem(key);};Storage.clear=function clear(){Storage.support&&Storage.items.clear();};return Storage;}();Storage.support=false;var TTFLoader=/*#__PURE__*/function(){function TTFLoader(){}var _proto115=TTFLoader.prototype;_proto115.load=function load(fontPath){this._url=fontPath;var tArr=fontPath.split(".ttf")[0].split("/");this.fontName=tArr[tArr.length-1];if(ILaya.Render.isConchApp){this._loadConch();}else if(window.FontFace){this._loadWithFontFace();}else {this._loadWithCSS();}};_proto115._loadConch=function _loadConch(){this._http=new HttpRequest();this._http.on(Event.ERROR,this,this._onErr);this._http.on(Event.COMPLETE,this,this._onHttpLoaded);this._http.send(this._url,null,"get",Loader.BUFFER);};_proto115._onHttpLoaded=function _onHttpLoaded(data){if(data===void 0){data=null;}window["conchTextCanvas"].setFontFaceFromBuffer(this.fontName,data);this._clearHttp();this._complete();};_proto115._clearHttp=function _clearHttp(){if(this._http){this._http.off(Event.ERROR,this,this._onErr);this._http.off(Event.COMPLETE,this,this._onHttpLoaded);this._http=null;}};_proto115._onErr=function _onErr(){this._clearHttp();if(this.err){this.err.runWith("fail:"+this._url);this.err=null;}};_proto115._complete=function _complete(){ILaya.systemTimer.clear(this,this._complete);ILaya.systemTimer.clear(this,this._checkComplete);if(this._div&&this._div.parentNode){this._div.parentNode.removeChild(this._div);this._div=null;}if(this.complete){this.complete.runWith(this);this.complete=null;}};_proto115._checkComplete=function _checkComplete(){if(ILaya.Browser.measureText(TTFLoader._testString,this._fontTxt).width!=this._txtWidth){this._complete();}};_proto115._loadWithFontFace=function _loadWithFontFace(){var fontFace=new window.FontFace(this.fontName,"url('"+this._url+"')");document.fonts.add(fontFace);var self=this;fontFace.loaded.then(function(){self._complete();});fontFace.load();};_proto115._createDiv=function _createDiv(){this._div=Browser.createElement("div");this._div.innerHTML="laya";var _style=this._div.style;_style.fontFamily=this.fontName;_style.position="absolute";_style.left="-100px";_style.top="-100px";document.body.appendChild(this._div);};_proto115._loadWithCSS=function _loadWithCSS(){var fontStyle=Browser.createElement("style");fontStyle.type="text/css";document.body.appendChild(fontStyle);fontStyle.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}";this._fontTxt="40px "+this.fontName;this._txtWidth=Browser.measureText(TTFLoader._testString,this._fontTxt).width;var self=this;fontStyle.onload=function(){ILaya.systemTimer.once(10000,self,self._complete);};ILaya.systemTimer.loop(20,this,this._checkComplete);this._createDiv();};return TTFLoader;}();TTFLoader._testString="LayaTTFFont";var Ease=/*#__PURE__*/function(){function Ease(){}Ease.linearNone=function linearNone(t,b,c,d){return c*t/d+b;};Ease.linearIn=function linearIn(t,b,c,d){return c*t/d+b;};Ease.linearInOut=function linearInOut(t,b,c,d){return c*t/d+b;};Ease.linearOut=function linearOut(t,b,c,d){return c*t/d+b;};Ease.bounceIn=function bounceIn(t,b,c,d){return c-Ease.bounceOut(d-t,0,c,d)+b;};Ease.bounceInOut=function bounceInOut(t,b,c,d){if(t<d*0.5)return Ease.bounceIn(t*2,0,c,d)*.5+b;else return Ease.bounceOut(t*2-d,0,c,d)*.5+c*.5+b;};Ease.bounceOut=function bounceOut(t,b,c,d){if((t/=d)<1/2.75)return c*(7.5625*t*t)+b;else if(t<2/2.75)return c*(7.5625*(t-=1.5/2.75)*t+.75)+b;else if(t<2.5/2.75)return c*(7.5625*(t-=2.25/2.75)*t+.9375)+b;else return c*(7.5625*(t-=2.625/2.75)*t+.984375)+b;};Ease.backIn=function backIn(t,b,c,d,s){if(s===void 0){s=1.70158;}return c*(t/=d)*t*((s+1)*t-s)+b;};Ease.backInOut=function backInOut(t,b,c,d,s){if(s===void 0){s=1.70158;}if((t/=d*0.5)<1)return c*0.5*(t*t*(((s*=1.525)+1)*t-s))+b;return c/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+b;};Ease.backOut=function backOut(t,b,c,d,s){if(s===void 0){s=1.70158;}return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b;};Ease.elasticIn=function elasticIn(t,b,c,d,a,p){if(a===void 0){a=0;}if(p===void 0){p=0;}var s;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(!a||c>0&&a<c||c<0&&a<-c){a=c;s=p/4;}else s=p/Ease.PI2*Math.asin(c/a);return -(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*Ease.PI2/p))+b;};Ease.elasticInOut=function elasticInOut(t,b,c,d,a,p){if(a===void 0){a=0;}if(p===void 0){p=0;}var s;if(t==0)return b;if((t/=d*0.5)==2)return b+c;if(!p)p=d*(.3*1.5);if(!a||c>0&&a<c||c<0&&a<-c){a=c;s=p/4;}else s=p/Ease.PI2*Math.asin(c/a);if(t<1)return -.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*Ease.PI2/p))+b;return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*Ease.PI2/p)*.5+c+b;};Ease.elasticOut=function elasticOut(t,b,c,d,a,p){if(a===void 0){a=0;}if(p===void 0){p=0;}var s;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(!a||c>0&&a<c||c<0&&a<-c){a=c;s=p/4;}else s=p/Ease.PI2*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*Ease.PI2/p)+c+b;};Ease.strongIn=function strongIn(t,b,c,d){return c*(t/=d)*t*t*t*t+b;};Ease.strongInOut=function strongInOut(t,b,c,d){if((t/=d*0.5)<1)return c*0.5*t*t*t*t*t+b;return c*0.5*((t-=2)*t*t*t*t+2)+b;};Ease.strongOut=function strongOut(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b;};Ease.sineInOut=function sineInOut(t,b,c,d){return -c*0.5*(Math.cos(Math.PI*t/d)-1)+b;};Ease.sineIn=function sineIn(t,b,c,d){return -c*Math.cos(t/d*Ease.HALF_PI)+c+b;};Ease.sineOut=function sineOut(t,b,c,d){return c*Math.sin(t/d*Ease.HALF_PI)+b;};Ease.quintIn=function quintIn(t,b,c,d){return c*(t/=d)*t*t*t*t+b;};Ease.quintInOut=function quintInOut(t,b,c,d){if((t/=d*0.5)<1)return c*0.5*t*t*t*t*t+b;return c*0.5*((t-=2)*t*t*t*t+2)+b;};Ease.quintOut=function quintOut(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b;};Ease.quartIn=function quartIn(t,b,c,d){return c*(t/=d)*t*t*t+b;};Ease.quartInOut=function quartInOut(t,b,c,d){if((t/=d*0.5)<1)return c*0.5*t*t*t*t+b;return -c*0.5*((t-=2)*t*t*t-2)+b;};Ease.quartOut=function quartOut(t,b,c,d){return -c*((t=t/d-1)*t*t*t-1)+b;};Ease.cubicIn=function cubicIn(t,b,c,d){return c*(t/=d)*t*t+b;};Ease.cubicInOut=function cubicInOut(t,b,c,d){if((t/=d*0.5)<1)return c*0.5*t*t*t+b;return c*0.5*((t-=2)*t*t+2)+b;};Ease.cubicOut=function cubicOut(t,b,c,d){return c*((t=t/d-1)*t*t+1)+b;};Ease.quadIn=function quadIn(t,b,c,d){return c*(t/=d)*t+b;};Ease.quadInOut=function quadInOut(t,b,c,d){if((t/=d*0.5)<1)return c*0.5*t*t+b;return -c*0.5*(--t*(t-2)-1)+b;};Ease.quadOut=function quadOut(t,b,c,d){return -c*(t/=d)*(t-2)+b;};Ease.expoIn=function expoIn(t,b,c,d){return t==0?b:c*Math.pow(2,10*(t/d-1))+b-c*0.001;};Ease.expoInOut=function expoInOut(t,b,c,d){if(t==0)return b;if(t==d)return b+c;if((t/=d*0.5)<1)return c*0.5*Math.pow(2,10*(t-1))+b;return c*0.5*(-Math.pow(2,-10*--t)+2)+b;};Ease.expoOut=function expoOut(t,b,c,d){return t==d?b+c:c*(-Math.pow(2,-10*t/d)+1)+b;};Ease.circIn=function circIn(t,b,c,d){return -c*(Math.sqrt(1-(t/=d)*t)-1)+b;};Ease.circInOut=function circInOut(t,b,c,d){if((t/=d*0.5)<1)return -c*0.5*(Math.sqrt(1-t*t)-1)+b;return c*0.5*(Math.sqrt(1-(t-=2)*t)+1)+b;};Ease.circOut=function circOut(t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b;};return Ease;}();Ease.HALF_PI=Math.PI*0.5;Ease.PI2=Math.PI*2;var Tween=/*#__PURE__*/function(){function Tween(){this.gid=0;this.repeat=1;this._count=0;}Tween.to=function to(target,props,duration,ease,complete,delay,coverBefore,autoRecover){if(ease===void 0){ease=null;}if(complete===void 0){complete=null;}if(delay===void 0){delay=0;}if(coverBefore===void 0){coverBefore=false;}if(autoRecover===void 0){autoRecover=true;}return Pool.getItemByClass("tween",Tween)._create(target,props,duration,ease,complete,delay,coverBefore,true,autoRecover,true);};Tween.from=function from(target,props,duration,ease,complete,delay,coverBefore,autoRecover){if(ease===void 0){ease=null;}if(complete===void 0){complete=null;}if(delay===void 0){delay=0;}if(coverBefore===void 0){coverBefore=false;}if(autoRecover===void 0){autoRecover=true;}return Pool.getItemByClass("tween",Tween)._create(target,props,duration,ease,complete,delay,coverBefore,false,autoRecover,true);};var _proto116=Tween.prototype;_proto116.to=function to(target,props,duration,ease,complete,delay,coverBefore){if(ease===void 0){ease=null;}if(complete===void 0){complete=null;}if(delay===void 0){delay=0;}if(coverBefore===void 0){coverBefore=false;}return this._create(target,props,duration,ease,complete,delay,coverBefore,true,false,true);};_proto116.from=function from(target,props,duration,ease,complete,delay,coverBefore){if(ease===void 0){ease=null;}if(complete===void 0){complete=null;}if(delay===void 0){delay=0;}if(coverBefore===void 0){coverBefore=false;}return this._create(target,props,duration,ease,complete,delay,coverBefore,false,false,true);};_proto116._create=function _create(target,props,duration,ease,complete,delay,coverBefore,isTo,usePool,runNow){if(!target)throw new Error("Tween:target is null");this._target=target;this._duration=duration;this._ease=ease||props.ease||Tween.easeNone;this._complete=complete||props.complete;this._delay=delay;this._props=[];this._usedTimer=0;this._startTimer=Browser.now();this._usedPool=usePool;this._delayParam=null;this.update=props.update;var gid=target.$_GID||(target.$_GID=Utils.getGID());if(!Tween.tweenMap[gid]){Tween.tweenMap[gid]=[this];}else {if(coverBefore)Tween.clearTween(target);Tween.tweenMap[gid].push(this);}if(runNow){if(delay<=0)this.firstStart(target,props,isTo);else {this._delayParam=[target,props,isTo];ILaya.timer.once(delay,this,this.firstStart,this._delayParam);}}else {this._initProps(target,props,isTo);}return this;};_proto116.firstStart=function firstStart(target,props,isTo){this._delayParam=null;if(target.destroyed){this.clear();return;}this._initProps(target,props,isTo);this._beginLoop();};_proto116._initProps=function _initProps(target,props,isTo){for(var p in props){if(typeof target[p]=='number'){var start=isTo?target[p]:props[p];var end=isTo?props[p]:target[p];this._props.push([p,start,end-start]);if(!isTo)target[p]=start;}}};_proto116._beginLoop=function _beginLoop(){ILaya.timer.frameLoop(1,this,this._doEase);};_proto116._doEase=function _doEase(){this._updateEase(Browser.now());};_proto116._updateEase=function _updateEase(time){var target=this._target;if(!target)return;if(target.destroyed)return Tween.clearTween(target);var usedTimer=this._usedTimer=time-this._startTimer-this._delay;if(usedTimer<0)return;if(usedTimer>=this._duration)return this.complete();var ratio=usedTimer>0?this._ease(usedTimer,0,1,this._duration):0;var props=this._props;for(var i=0,n=props.length;i<n;i++){var prop=props[i];target[prop[0]]=prop[1]+ratio*prop[2];}if(this.update)this.update.run();};_proto116.complete=function complete(){if(!this._target)return;ILaya.timer.runTimer(this,this.firstStart);var target=this._target;var props=this._props;var handler=this._complete;for(var i=0,n=props.length;i<n;i++){var prop=props[i];target[prop[0]]=prop[1]+prop[2];}if(this.update)this.update.run();this._count++;if(this.repeat!=0&&this._count>=this.repeat){this.clear();handler&&handler.run();}else {this.restart();}};_proto116.pause=function pause(){ILaya.timer.clear(this,this._beginLoop);ILaya.timer.clear(this,this._doEase);ILaya.timer.clear(this,this.firstStart);var time=Browser.now();var dTime;dTime=time-this._startTimer-this._delay;if(dTime<0){this._usedTimer=dTime;}};_proto116.setStartTime=function setStartTime(startTime){this._startTimer=startTime;};Tween.clearAll=function clearAll(target){if(!target||!target.$_GID)return;var tweens=Tween.tweenMap[target.$_GID];if(tweens){for(var i=0,n=tweens.length;i<n;i++){tweens[i]._clear();}tweens.length=0;}};Tween.clear=function clear(tween){tween.clear();};Tween.clearTween=function clearTween(target){Tween.clearAll(target);};_proto116.clear=function clear(){if(this._target){this._remove();this._clear();}};_proto116._clear=function _clear(){this.pause();ILaya.timer.clear(this,this.firstStart);this._complete=null;this._target=null;this._ease=null;this._props=null;this._delayParam=null;this.repeat=1;if(this._usedPool){this.update=null;Pool.recover("tween",this);}};_proto116.recover=function recover(){this._usedPool=true;this._clear();};_proto116._remove=function _remove(){var tweens=Tween.tweenMap[this._target.$_GID];if(tweens){for(var i=0,n=tweens.length;i<n;i++){if(tweens[i]===this){tweens.splice(i,1);break;}}}};_proto116.restart=function restart(){this.pause();this._usedTimer=0;this._startTimer=Browser.now();if(this._delayParam){ILaya.timer.once(this._delay,this,this.firstStart,this._delayParam);return;}var props=this._props;for(var i=0,n=props.length;i<n;i++){var prop=props[i];this._target[prop[0]]=prop[1];}ILaya.timer.once(this._delay,this,this._beginLoop);};_proto116.resume=function resume(){if(this._usedTimer>=this._duration)return;this._startTimer=Browser.now()-this._usedTimer-this._delay;if(this._delayParam){if(this._usedTimer<0){ILaya.timer.once(-this._usedTimer,this,this.firstStart,this._delayParam);}else {this.firstStart.apply(this,this._delayParam);}}else {this._beginLoop();}};Tween.easeNone=function easeNone(t,b,c,d){return c*t/d+b;};_createClass(Tween,[{key:"progress",set:function set(v){var uTime=v*this._duration;this._startTimer=Browser.now()-this._delay-uTime;}}]);return Tween;}();Tween.tweenMap=[];var Dragging=/*#__PURE__*/function(){function Dragging(){this.ratio=0.92;this.maxOffset=60;this._dragging=false;this._clickOnly=true;}var _proto117=Dragging.prototype;_proto117.start=function start(target,area,hasInertia,elasticDistance,elasticBackTime,data,disableMouseEvent,ratio){if(ratio===void 0){ratio=0.92;}this.clearTimer();this.target=target;this.area=area;this.hasInertia=hasInertia;this.elasticDistance=area?elasticDistance:0;this.elasticBackTime=elasticBackTime;this.data=data;this._disableMouseEvent=disableMouseEvent;this.ratio=ratio;this._parent=target.parent;this._clickOnly=true;this._dragging=true;this._elasticRateX=this._elasticRateY=1;this._lastX=this._parent.mouseX;this._lastY=this._parent.mouseY;ILaya.stage.on(Event.MOUSE_UP,this,this.onStageMouseUp);ILaya.stage.on(Event.MOUSE_OUT,this,this.onStageMouseUp);ILaya.systemTimer.frameLoop(1,this,this.loop);};_proto117.clearTimer=function clearTimer(){ILaya.systemTimer.clear(this,this.loop);ILaya.systemTimer.clear(this,this.tweenMove);if(this._tween){this._tween.recover();this._tween=null;}};_proto117.stop=function stop(){if(this._dragging){MouseManager.instance.disableMouseEvent=false;ILaya.stage.off(Event.MOUSE_UP,this,this.onStageMouseUp);ILaya.stage.off(Event.MOUSE_OUT,this,this.onStageMouseUp);this._dragging=false;this.target&&this.area&&this.backToArea();this.clear();}};_proto117.loop=function loop(){var point=this._parent.getMousePoint();var mouseX=point.x;var mouseY=point.y;var offsetX=mouseX-this._lastX;var offsetY=mouseY-this._lastY;if(this._clickOnly){if(Math.abs(offsetX*ILaya.stage._canvasTransform.getScaleX())>1||Math.abs(offsetY*ILaya.stage._canvasTransform.getScaleY())>1){this._clickOnly=false;this._offsets||(this._offsets=[]);this._offsets.length=0;this.target.event(Event.DRAG_START,this.data);MouseManager.instance.disableMouseEvent=this._disableMouseEvent;}else return;}else {this._offsets.push(offsetX,offsetY);}if(offsetX===0&&offsetY===0)return;this._lastX=mouseX;this._lastY=mouseY;this.target.x+=offsetX*this._elasticRateX;this.target.y+=offsetY*this._elasticRateY;this.area&&this.checkArea();this.target.event(Event.DRAG_MOVE,this.data);};_proto117.checkArea=function checkArea(){if(this.elasticDistance<=0){this.backToArea();}else {if(this.target._x<this.area.x){var offsetX=this.area.x-this.target._x;}else if(this.target._x>this.area.x+this.area.width){offsetX=this.target._x-this.area.x-this.area.width;}else {offsetX=0;}this._elasticRateX=Math.max(0,1-offsetX/this.elasticDistance);if(this.target._y<this.area.y){var offsetY=this.area.y-this.target.y;}else if(this.target._y>this.area.y+this.area.height){offsetY=this.target._y-this.area.y-this.area.height;}else {offsetY=0;}this._elasticRateY=Math.max(0,1-offsetY/this.elasticDistance);}};_proto117.backToArea=function backToArea(){this.target.x=Math.min(Math.max(this.target._x,this.area.x),this.area.x+this.area.width);this.target.y=Math.min(Math.max(this.target._y,this.area.y),this.area.y+this.area.height);};_proto117.onStageMouseUp=function onStageMouseUp(e){MouseManager.instance.disableMouseEvent=false;ILaya.stage.off(Event.MOUSE_UP,this,this.onStageMouseUp);ILaya.stage.off(Event.MOUSE_OUT,this,this.onStageMouseUp);ILaya.systemTimer.clear(this,this.loop);if(this._clickOnly||!this.target)return;if(this.hasInertia){if(this._offsets.length<1){this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY);}this._offsetX=this._offsetY=0;var len=this._offsets.length;var n=Math.min(len,6);var m=this._offsets.length-n;for(var i=len-1;i>m;i--){this._offsetY+=this._offsets[i--];this._offsetX+=this._offsets[i];}this._offsetX=this._offsetX/n*2;this._offsetY=this._offsetY/n*2;if(Math.abs(this._offsetX)>this.maxOffset)this._offsetX=this._offsetX>0?this.maxOffset:-this.maxOffset;if(Math.abs(this._offsetY)>this.maxOffset)this._offsetY=this._offsetY>0?this.maxOffset:-this.maxOffset;ILaya.systemTimer.frameLoop(1,this,this.tweenMove);}else if(this.elasticDistance>0){this.checkElastic();}else {this.clear();}};_proto117.checkElastic=function checkElastic(){var tx=NaN;var ty=NaN;if(this.target.x<this.area.x)tx=this.area.x;else if(this.target._x>this.area.x+this.area.width)tx=this.area.x+this.area.width;if(this.target.y<this.area.y)ty=this.area.y;else if(this.target._y>this.area.y+this.area.height)ty=this.area.y+this.area.height;if(!isNaN(tx)||!isNaN(ty)){var obj={};if(!isNaN(tx))obj.x=tx;if(!isNaN(ty))obj.y=ty;this._tween=Tween.to(this.target,obj,this.elasticBackTime,Ease.sineOut,Handler.create(this,this.clear),0,false,false);}else {this.clear();}};_proto117.tweenMove=function tweenMove(){this._offsetX*=this.ratio*this._elasticRateX;this._offsetY*=this.ratio*this._elasticRateY;this.target.x+=this._offsetX;this.target.y+=this._offsetY;this.area&&this.checkArea();this.target.event(Event.DRAG_MOVE,this.data);if(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<0.5||this._elasticRateY<0.5){ILaya.systemTimer.clear(this,this.tweenMove);if(this.elasticDistance>0)this.checkElastic();else this.clear();}};_proto117.clear=function clear(){if(this.target){this.clearTimer();var sp=this.target;this.target=null;this._parent=null;sp.event(Event.DRAG_END,this.data);}};return Dragging;}();var Component=/*#__PURE__*/function(){function Component(){this._id=Utils.getGID();this._resetComp();}var _proto118=Component.prototype;_proto118._isScript=function _isScript(){return false;};_proto118._resetComp=function _resetComp(){this._indexInList=-1;this._enabled=true;this._awaked=false;this.owner=null;};_proto118._getIndexInList=function _getIndexInList(){return this._indexInList;};_proto118._setIndexInList=function _setIndexInList(index){this._indexInList=index;};_proto118._onAdded=function _onAdded(){};_proto118._onAwake=function _onAwake(){};_proto118._onEnable=function _onEnable(){};_proto118._onDisable=function _onDisable(){};_proto118._onDestroy=function _onDestroy(){};_proto118.onReset=function onReset(){};_proto118._parse=function _parse(data,interactMap){};_proto118._parseInteractive=function _parseInteractive(data,spriteMap){};_proto118._cloneTo=function _cloneTo(dest){};_proto118._setActive=function _setActive(value){if(value){if(!this._awaked){this._awaked=true;this._onAwake();}this._enabled&&this._onEnable();}else {this._enabled&&this._onDisable();}};_proto118.destroy=function destroy(){if(this.owner)this.owner._destroyComponent(this);};_proto118._destroy=function _destroy(){if(this.owner.activeInHierarchy&&this._enabled)this._setActive(false);this._onDestroy();this._destroyed=true;if(this.onReset!==Component.prototype.onReset){this.onReset();this._resetComp();Pool.recoverByClass(this);}else {this._resetComp();}};_createClass(Component,[{key:"id",get:function get(){return this._id;}},{key:"enabled",get:function get(){return this._enabled;},set:function set(value){if(this._enabled!=value){this._enabled=value;if(this.owner){if(value)this.owner.activeInHierarchy&&this._onEnable();else this.owner.activeInHierarchy&&this._onDisable();}}}},{key:"isSingleton",get:function get(){return true;}},{key:"destroyed",get:function get(){return this._destroyed;}}]);return Component;}();var AnimationBase=/*#__PURE__*/function(_Sprite3){_inheritsLoose(AnimationBase,_Sprite3);function AnimationBase(){var _this36;_this36=_Sprite3.call(this)||this;_this36.wrapMode=0;_this36._interval=Config.animationInterval;_this36._isReverse=false;_this36._frameRateChanged=false;_this36._setBitUp(Const.DISPLAY);return _this36;}var _proto119=AnimationBase.prototype;_proto119.play=function play(start,loop,name){if(start===void 0){start=0;}if(loop===void 0){loop=true;}if(name===void 0){name="";}this._isPlaying=true;this._actionName=name;this.index=typeof start=='string'?this._getFrameByLabel(start):start;this.loop=loop;this._isReverse=this.wrapMode===AnimationBase.WRAP_REVERSE;if(this.index==0&&this._isReverse){this.index=this.count-1;}if(this.interval>0)this.timerLoop(this.interval,this,this._frameLoop,null,true,true);};_proto119._getFrameByLabel=function _getFrameByLabel(label){for(var i=0;i<this._count;i++){var item=this._labels[i];if(item&&item.indexOf(label)>-1)return i;}return 0;};_proto119._frameLoop=function _frameLoop(){if(this._isReverse){this._index--;if(this._index<0){if(this.loop){if(this.wrapMode==AnimationBase.WRAP_PINGPONG){this._index=this._count>0?1:0;this._isReverse=false;}else {this._index=this._count-1;}this.event(Event.COMPLETE);}else {this._index=0;this.stop();this.event(Event.COMPLETE);return;}}}else {this._index++;if(this._index>=this._count){if(this.loop){if(this.wrapMode==AnimationBase.WRAP_PINGPONG){this._index=this._count-2>=0?this._count-2:0;this._isReverse=true;}else {this._index=0;}this.event(Event.COMPLETE);}else {this._index--;this.stop();this.event(Event.COMPLETE);return;}}}this.index=this._index;};_proto119._setControlNode=function _setControlNode(node){if(this._controlNode){this._controlNode.off(Event.DISPLAY,this,this._resumePlay);this._controlNode.off(Event.UNDISPLAY,this,this._resumePlay);}this._controlNode=node;if(node&&node!=this){node.on(Event.DISPLAY,this,this._resumePlay);node.on(Event.UNDISPLAY,this,this._resumePlay);}};_proto119._setDisplay=function _setDisplay(value){_Sprite3.prototype._setDisplay.call(this,value);this._resumePlay();};_proto119._resumePlay=function _resumePlay(){if(this._isPlaying){if(this._controlNode.displayedInStage)this.play(this._index,this.loop,this._actionName);else this.clearTimer(this,this._frameLoop);}};_proto119.stop=function stop(){this._isPlaying=false;this.clearTimer(this,this._frameLoop);};_proto119.addLabel=function addLabel(label,index){if(!this._labels)this._labels={};if(!this._labels[index])this._labels[index]=[];this._labels[index].push(label);};_proto119.removeLabel=function removeLabel(label){if(!label)this._labels=null;else if(this._labels){for(var name in this._labels){this._removeLabelFromList(this._labels[name],label);}}};_proto119._removeLabelFromList=function _removeLabelFromList(list,label){if(!list)return;for(var i=list.length-1;i>=0;i--){if(list[i]==label){list.splice(i,1);}}};_proto119.gotoAndStop=function gotoAndStop(position){this.index=typeof position=='string'?this._getFrameByLabel(position):position;this.stop();};_proto119._displayToIndex=function _displayToIndex(value){};_proto119.clear=function clear(){this.stop();this._labels=null;return this;};_createClass(AnimationBase,[{key:"interval",get:function get(){return this._interval;},set:function set(value){if(this._interval!=value){this._frameRateChanged=true;this._interval=value;if(this._isPlaying&&value>0){this.timerLoop(value,this,this._frameLoop,null,true,true);}}}},{key:"isPlaying",get:function get(){return this._isPlaying;}},{key:"index",get:function get(){return this._index;},set:function set(value){this._index=value;this._displayToIndex(value);if(this._labels&&this._labels[value]){var tArr=this._labels[value];for(var i=0,len=tArr.length;i<len;i++){this.event(Event.LABEL,tArr[i]);}}}},{key:"count",get:function get(){return this._count;}}]);return AnimationBase;}(Sprite);AnimationBase.WRAP_POSITIVE=0;AnimationBase.WRAP_REVERSE=1;AnimationBase.WRAP_PINGPONG=2;ClassUtils.regClass("laya.display.AnimationBase",AnimationBase);ClassUtils.regClass("Laya.AnimationBase",AnimationBase);var MathUtil=/*#__PURE__*/function(){function MathUtil(){}MathUtil.subtractVector3=function subtractVector3(l,r,o){o[0]=l[0]-r[0];o[1]=l[1]-r[1];o[2]=l[2]-r[2];};MathUtil.lerp=function lerp(left,right,amount){return left*(1-amount)+right*amount;};MathUtil.scaleVector3=function scaleVector3(f,b,e){e[0]=f[0]*b;e[1]=f[1]*b;e[2]=f[2]*b;};MathUtil.lerpVector3=function lerpVector3(l,r,t,o){var ax=l[0],ay=l[1],az=l[2];o[0]=ax+t*(r[0]-ax);o[1]=ay+t*(r[1]-ay);o[2]=az+t*(r[2]-az);};MathUtil.lerpVector4=function lerpVector4(l,r,t,o){var ax=l[0],ay=l[1],az=l[2],aw=l[3];o[0]=ax+t*(r[0]-ax);o[1]=ay+t*(r[1]-ay);o[2]=az+t*(r[2]-az);o[3]=aw+t*(r[3]-aw);};MathUtil.slerpQuaternionArray=function slerpQuaternionArray(a,Offset1,b,Offset2,t,out,Offset3){var ax=a[Offset1+0],ay=a[Offset1+1],az=a[Offset1+2],aw=a[Offset1+3],bx=b[Offset2+0],by=b[Offset2+1],bz=b[Offset2+2],bw=b[Offset2+3];var omega,cosom,sinom,scale0,scale1;cosom=ax*bx+ay*by+az*bz+aw*bw;if(cosom<0.0){cosom=-cosom;bx=-bx;by=-by;bz=-bz;bw=-bw;}if(1.0-cosom>0.000001){omega=Math.acos(cosom);sinom=Math.sin(omega);scale0=Math.sin((1.0-t)*omega)/sinom;scale1=Math.sin(t*omega)/sinom;}else {scale0=1.0-t;scale1=t;}out[Offset3+0]=scale0*ax+scale1*bx;out[Offset3+1]=scale0*ay+scale1*by;out[Offset3+2]=scale0*az+scale1*bz;out[Offset3+3]=scale0*aw+scale1*bw;return out;};MathUtil.getRotation=function getRotation(x0,y0,x1,y1){return Math.atan2(y1-y0,x1-x0)/Math.PI*180;};MathUtil.sortBigFirst=function sortBigFirst(a,b){if(a==b)return 0;return b>a?1:-1;};MathUtil.sortSmallFirst=function sortSmallFirst(a,b){if(a==b)return 0;return b>a?-1:1;};MathUtil.sortNumBigFirst=function sortNumBigFirst(a,b){return parseFloat(b)-parseFloat(a);};MathUtil.sortNumSmallFirst=function sortNumSmallFirst(a,b){return parseFloat(a)-parseFloat(b);};MathUtil.sortByKey=function sortByKey(key,bigFirst,forceNum){if(bigFirst===void 0){bigFirst=false;}if(forceNum===void 0){forceNum=true;}var _sortFun;if(bigFirst){_sortFun=forceNum?MathUtil.sortNumBigFirst:MathUtil.sortBigFirst;}else {_sortFun=forceNum?MathUtil.sortNumSmallFirst:MathUtil.sortSmallFirst;}return function(a,b){return _sortFun(a[key],b[key]);};};return MathUtil;}();var FrameAnimation=/*#__PURE__*/function(_AnimationBase){_inheritsLoose(FrameAnimation,_AnimationBase);function FrameAnimation(){var _this37;_this37=_AnimationBase.call(this)||this;if(FrameAnimation._sortIndexFun===undefined){FrameAnimation._sortIndexFun=MathUtil.sortByKey("index",false,true);}return _this37;}FrameAnimation._sortIndexFun=function _sortIndexFun(objpre,objnext){return objpre.index-objnext.index;};var _proto120=FrameAnimation.prototype;_proto120._setUp=function _setUp(targetDic,animationData){this._targetDic=targetDic;this._animationData=animationData;this.interval=1000/animationData.frameRate;if(animationData.parsed){this._count=animationData.count;this._labels=animationData.labels;this._usedFrames=animationData.animationNewFrames;}else {this._usedFrames=[];this._calculateDatas();animationData.parsed=true;animationData.labels=this._labels;animationData.count=this._count;animationData.animationNewFrames=this._usedFrames;}};_proto120.clear=function clear(){_AnimationBase.prototype.clear.call(this);this._targetDic=null;this._animationData=null;return this;};_proto120._displayToIndex=function _displayToIndex(value){if(!this._animationData)return;if(value<0)value=0;if(value>this._count)value=this._count;var nodes=this._animationData.nodes,i,len=nodes.length;for(i=0;i<len;i++){this._displayNodeToFrame(nodes[i],value);}};_proto120._displayNodeToFrame=function _displayNodeToFrame(node,frame,targetDic){if(targetDic===void 0){targetDic=null;}if(!targetDic)targetDic=this._targetDic;var target=targetDic[node.target];if(!target){return;}var frames=node.frames,key,propFrames,value;var keys=node.keys,i,len=keys.length;for(i=0;i<len;i++){key=keys[i];propFrames=frames[key];if(propFrames.length>frame){value=propFrames[frame];}else {value=propFrames[propFrames.length-1];}target[key]=value;}var funkeys=node.funkeys;len=funkeys.length;var funFrames;if(len==0)return;for(i=0;i<len;i++){key=funkeys[i];funFrames=frames[key];if(funFrames[frame]!==undefined){target[key]&&target[key].apply(target,funFrames[frame]);}}};_proto120._calculateDatas=function _calculateDatas(){if(!this._animationData)return;var nodes=this._animationData.nodes,i,len=nodes.length,tNode;this._count=0;for(i=0;i<len;i++){tNode=nodes[i];this._calculateKeyFrames(tNode);}this._count+=1;};_proto120._calculateKeyFrames=function _calculateKeyFrames(node){var keyFrames=node.keyframes,key,tKeyFrames,target=node.target;if(!node.frames)node.frames={};if(!node.keys)node.keys=[];else node.keys.length=0;if(!node.funkeys)node.funkeys=[];else node.funkeys.length=0;if(!node.initValues)node.initValues={};for(key in keyFrames){var isFun=key.indexOf("()")!=-1;tKeyFrames=keyFrames[key];if(isFun)key=key.substr(0,key.length-2);if(!node.frames[key]){node.frames[key]=[];}if(!isFun){if(this._targetDic&&this._targetDic[target]){node.initValues[key]=this._targetDic[target][key];}tKeyFrames.sort(FrameAnimation._sortIndexFun);node.keys.push(key);this._calculateNodePropFrames(tKeyFrames,node.frames[key],key,target);}else {node.funkeys.push(key);var map=node.frames[key];for(var i=0;i<tKeyFrames.length;i++){var temp=tKeyFrames[i];map[temp.index]=temp.value;if(temp.index>this._count)this._count=temp.index;}}}};_proto120.resetNodes=function resetNodes(){if(!this._targetDic)return;if(!this._animationData)return;var nodes=this._animationData.nodes,i,len=nodes.length;var tNode;var initValues;for(i=0;i<len;i++){tNode=nodes[i];initValues=tNode.initValues;if(!initValues)continue;var target=this._targetDic[tNode.target];if(!target)continue;var key;for(key in initValues){target[key]=initValues[key];}}};_proto120._calculateNodePropFrames=function _calculateNodePropFrames(keyframes,frames,key,target){var i,len=keyframes.length-1;frames.length=keyframes[len].index+1;for(i=0;i<len;i++){this._dealKeyFrame(keyframes[i]);this._calculateFrameValues(keyframes[i],keyframes[i+1],frames);}if(len==0){frames[0]=keyframes[0].value;if(this._usedFrames)this._usedFrames[keyframes[0].index]=true;}this._dealKeyFrame(keyframes[i]);};_proto120._dealKeyFrame=function _dealKeyFrame(keyFrame){if(keyFrame.label&&keyFrame.label!="")this.addLabel(keyFrame.label,keyFrame.index);};_proto120._calculateFrameValues=function _calculateFrameValues(startFrame,endFrame,result){var i,easeFun;var start=startFrame.index,end=endFrame.index;var startValue=startFrame.value;var dValue=endFrame.value-startFrame.value;var dLen=end-start;var frames=this._usedFrames;if(end>this._count)this._count=end;if(startFrame.tween){easeFun=Ease[startFrame.tweenMethod];if(easeFun==null)easeFun=Ease.linearNone;for(i=start;i<end;i++){result[i]=easeFun(i-start,startValue,dValue,dLen);if(frames)frames[i]=true;}}else {for(i=start;i<end;i++){result[i]=startValue;}}if(frames){frames[startFrame.index]=true;frames[endFrame.index]=true;}result[endFrame.index]=endFrame.value;};return FrameAnimation;}(AnimationBase);ClassUtils.regClass("laya.display.FrameAnimation",FrameAnimation);ClassUtils.regClass("Laya.FrameAnimation",FrameAnimation);var WeakObject=/*#__PURE__*/function(){function WeakObject(){this._obj={};WeakObject._maps.push(this);}WeakObject.__init__=function __init__(){WeakObject.I=new WeakObject();if(!WeakObject.supportWeakMap)ILaya.systemTimer.loop(WeakObject.delInterval,null,WeakObject.clearCache);};WeakObject.clearCache=function clearCache(){for(var i=0,n=WeakObject._maps.length;i<n;i++){var obj=WeakObject._maps[i];obj._obj={};}};var _proto121=WeakObject.prototype;_proto121.set=function set(key,value){if(key==null)return;if(WeakObject.supportWeakMap);else {if(typeof key=='string'||typeof key=='number'){this._obj[key]=value;}else {key.$_GID||(key.$_GID=Utils.getGID());this._obj[key.$_GID]=value;}}};_proto121.get=function get(key){if(key==null)return null;if(WeakObject.supportWeakMap);else {if(typeof key=='string'||typeof key=='number')return this._obj[key];return this._obj[key.$_GID];}};_proto121.del=function del(key){if(key==null)return;if(WeakObject.supportWeakMap);else {if(typeof key=='string'||typeof key=='number')delete this._obj[key];else delete this._obj[this._obj.$_GID];}};_proto121.has=function has(key){if(key==null)return false;if(WeakObject.supportWeakMap);else {if(typeof key=='string'||typeof key=='number')return this._obj[key]!=null;return this._obj[this._obj.$_GID]!=null;}};return WeakObject;}();WeakObject.supportWeakMap=false;WeakObject.delInterval=10*60*1000;WeakObject._maps=[];var SceneUtils=/*#__PURE__*/function(){function SceneUtils(){}SceneUtils.__init=function __init(){SceneUtils._funMap=new WeakObject();};SceneUtils.getBindFun=function getBindFun(value){var fun=SceneUtils._funMap.get(value);if(fun==null){var temp="\""+value+"\"";temp=temp.replace(/^"\${|}"$/g,"").replace(/\${/g,"\"+").replace(/}/g,"+\"");var str="(function(data){if(data==null)return;with(data){try{\nreturn "+temp+"\n}catch(e){}}})";fun=window.Laya._runScript(str);SceneUtils._funMap.set(value,fun);}return fun;};SceneUtils.createByData=function createByData(root,uiView){var tInitTool=InitTool.create();root=SceneUtils.createComp(uiView,root,root,null,tInitTool);root._setBit(Const.NOT_READY,true);if("_idMap"in root){root["_idMap"]=tInitTool._idMap;}if(uiView.animations){var anilist=[];var animations=uiView.animations;var i,len=animations.length;var tAni;var tAniO;for(i=0;i<len;i++){tAni=new FrameAnimation();tAniO=animations[i];tAni._setUp(tInitTool._idMap,tAniO);root[tAniO.name]=tAni;tAni._setControlNode(root);switch(tAniO.action){case 1:tAni.play(0,false);break;case 2:tAni.play(0,true);break;}anilist.push(tAni);}root._aniList=anilist;}if(root._$componentType==="Scene"&&root._width>0&&uiView.props.hitTestPrior==null&&!root.mouseThrough)root.hitTestPrior=true;tInitTool.beginLoad(root);return root;};SceneUtils.createInitTool=function createInitTool(){return InitTool.create();};SceneUtils.createComp=function createComp(uiView,comp,view,dataMap,initTool){if(comp===void 0){comp=null;}if(view===void 0){view=null;}if(dataMap===void 0){dataMap=null;}if(initTool===void 0){initTool=null;}if(uiView.type=="Scene3D"||uiView.type=="Sprite3D"){var outBatchSprits=[];var scene3D=ILaya.Laya["Utils3D"]._createSceneByJsonForMaker(uiView,outBatchSprits,initTool);if(uiView.type=="Sprite3D")ILaya.Laya["StaticBatchManager"].combine(scene3D,outBatchSprits);else ILaya.Laya["StaticBatchManager"].combine(null,outBatchSprits);return scene3D;}comp=comp||SceneUtils.getCompInstance(uiView);if(!comp){if(uiView.props&&uiView.props.runtime)console.warn("runtime not found:"+uiView.props.runtime);else console.warn("can not create:"+uiView.type);return null;}var child=uiView.child;if(child){var isList=comp["_$componentType"]=="List";for(var i=0,n=child.length;i<n;i++){var node=child[i];if('itemRender'in comp&&(node.props.name=="render"||node.props.renderType==="render")){comp["itemRender"]=node;}else if(node.type=="Graphic"){ILaya.ClassUtils._addGraphicsToSprite(node,comp);}else if(ILaya.ClassUtils._isDrawType(node.type)){ILaya.ClassUtils._addGraphicToSprite(node,comp,true);}else {if(isList){var arr=[];var tChild=SceneUtils.createComp(node,null,view,arr,initTool);if(arr.length)tChild["_$bindData"]=arr;}else {tChild=SceneUtils.createComp(node,null,view,dataMap,initTool);}if(node.type=="Script"){if(tChild instanceof Component){comp._addComponentInstance(tChild);}else {if("owner"in tChild){tChild["owner"]=comp;}else if("target"in tChild){tChild["target"]=comp;}}}else if(node.props.renderType=="mask"||node.props.name=="mask"){comp.mask=tChild;}else {tChild instanceof Node&&comp.addChild(tChild);}}}}var props=uiView.props;for(var prop in props){var value=props[prop];if(typeof value=='string'&&(value.indexOf("@node:")>=0||value.indexOf("@Prefab:")>=0)){if(initTool){initTool.addNodeRef(comp,prop,value);}}else SceneUtils.setCompValue(comp,prop,value,view,dataMap);}if(comp._afterInited){comp._afterInited();}if(uiView.compId&&initTool&&initTool._idMap){initTool._idMap[uiView.compId]=comp;}return comp;};SceneUtils.setCompValue=function setCompValue(comp,prop,value,view,dataMap){if(view===void 0){view=null;}if(dataMap===void 0){dataMap=null;}if(typeof value=='string'&&value.indexOf("${")>-1){SceneUtils._sheet||(SceneUtils._sheet=ILaya.ClassUtils.getClass("laya.data.Table"));if(!SceneUtils._sheet){console.warn("Can not find class Sheet");return;}if(dataMap){dataMap.push(comp,prop,value);}else if(view){if(value.indexOf("].")==-1){value=value.replace(".","[0].");}var watcher=new DataWatcher(comp,prop,value);watcher.exe(view);var one,temp;var str=value.replace(/\[.*?\]\./g,".");while((one=SceneUtils._parseWatchData.exec(str))!=null){var key1=one[1];while((temp=SceneUtils._parseKeyWord.exec(key1))!=null){var key2=temp[0];var arr=view._watchMap[key2]||(view._watchMap[key2]=[]);arr.push(watcher);SceneUtils._sheet.I.notifer.on(key2,view,view.changeData,[key2]);}arr=view._watchMap[key1]||(view._watchMap[key1]=[]);arr.push(watcher);SceneUtils._sheet.I.notifer.on(key1,view,view.changeData,[key1]);}}return;}if(prop==="var"&&view){view[value]=comp;}else {comp[prop]=value==="true"?true:value==="false"?false:value;}};SceneUtils.getCompInstance=function getCompInstance(json){if(json.type=="UIView"){if(json.props&&json.props.pageData){return SceneUtils.createByData(null,json.props.pageData);}}var runtime=json.props&&json.props.runtime||json.type;var compClass=ILaya.ClassUtils.getClass(runtime);if(!compClass)throw "Can not find class "+runtime;if(json.type==="Script"&&compClass.prototype._doAwake){var comp=Pool.createByClass(compClass);comp._destroyed=false;return comp;}if(json.props&&"renderType"in json.props&&json.props["renderType"]=="instance"){if(!compClass["instance"])compClass["instance"]=new compClass();return compClass["instance"];}return new compClass();};return SceneUtils;}();SceneUtils._parseWatchData=/\${(.*?)}/g;SceneUtils._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g;var DataWatcher=/*#__PURE__*/function(){function DataWatcher(comp,prop,value){this.comp=comp;this.prop=prop;this.value=value;}var _proto122=DataWatcher.prototype;_proto122.exe=function exe(view){var fun=SceneUtils.getBindFun(this.value);this.comp[this.prop]=fun.call(this,view);};return DataWatcher;}();var InitTool=/*#__PURE__*/function(){function InitTool(){}var _proto123=InitTool.prototype;_proto123.reset=function reset(){this._nodeRefList=null;this._initList=null;this._idMap=null;this._loadList=null;this._scene=null;};_proto123.recover=function recover(){this.reset();Pool.recover("InitTool",this);};InitTool.create=function create(){var tool=Pool.getItemByClass("InitTool",InitTool);tool._idMap=[];return tool;};_proto123.addLoadRes=function addLoadRes(url,type){if(type===void 0){type=null;}if(!this._loadList)this._loadList=[];if(ILaya.loader.getRes(url)){return;}if(!type){this._loadList.push(url);}else {this._loadList.push({url:url,type:type});}};_proto123.addNodeRef=function addNodeRef(node,prop,referStr){if(!this._nodeRefList)this._nodeRefList=[];this._nodeRefList.push([node,prop,referStr]);if(referStr.indexOf("@Prefab:")>=0){this.addLoadRes(referStr.replace("@Prefab:",""),Loader.PREFAB);}};_proto123.setNodeRef=function setNodeRef(){if(!this._nodeRefList)return;if(!this._idMap){this._nodeRefList=null;return;}var i,len;len=this._nodeRefList.length;var tRefInfo;for(i=0;i<len;i++){tRefInfo=this._nodeRefList[i];tRefInfo[0][tRefInfo[1]]=this.getReferData(tRefInfo[2]);}this._nodeRefList=null;};_proto123.getReferData=function getReferData(referStr){if(referStr.indexOf("@Prefab:")>=0){var prefab;prefab=Loader.getRes(referStr.replace("@Prefab:",""));return prefab;}else if(referStr.indexOf("@arr:")>=0){referStr=referStr.replace("@arr:","");var list;list=referStr.split(",");var i,len;var tStr;len=list.length;for(i=0;i<len;i++){tStr=list[i];if(tStr){list[i]=this._idMap[tStr.replace("@node:","")];}else {list[i]=null;}}return list;}else {return this._idMap[referStr.replace("@node:","")];}};_proto123.addInitItem=function addInitItem(item){if(!this._initList)this._initList=[];this._initList.push(item);};_proto123.doInits=function doInits(){if(!this._initList)return;this._initList=null;};_proto123.finish=function finish(){this.setNodeRef();this.doInits();this._scene._setBit(Const.NOT_READY,false);if(this._scene.parent&&this._scene.parent.activeInHierarchy&&this._scene.active)this._scene._processActive();this._scene.event("onViewCreated");this.recover();};_proto123.beginLoad=function beginLoad(scene){this._scene=scene;if(!this._loadList||this._loadList.length<1){this.finish();}else {ILaya.loader.load(this._loadList,Handler.create(this,this.finish));}};return InitTool;}();var IStatRender=/*#__PURE__*/function(){function IStatRender(){}var _proto124=IStatRender.prototype;_proto124.show=function show(x,y){};_proto124.enable=function enable(){};_proto124.hide=function hide(){};_proto124.set_onclick=function set_onclick(fn){};_proto124.isCanvasRender=function isCanvasRender(){return true;};_proto124.renderNotCanvas=function renderNotCanvas(ctx,x,y){};return IStatRender;}();var StatUI=/*#__PURE__*/function(_IStatRender){_inheritsLoose(StatUI,_IStatRender);function StatUI(){var _this38;_this38=_IStatRender.apply(this,arguments)||this;_this38._show=false;_this38._useCanvas=false;_this38._height=100;_this38._view=[];return _this38;}var _proto125=StatUI.prototype;_proto125.show=function show(x,y){if(x===void 0){x=0;}if(y===void 0){y=0;}if(!Browser.onMiniGame&&!ILaya.Render.isConchApp&&!Browser.onBDMiniGame&&!Browser.onKGMiniGame&&!Browser.onQGMiniGame&&!Browser.onQQMiniGame&&!Browser.onAlipayMiniGame&&!Browser.onBLMiniGame&&!Browser.onTTMiniGame&&!Browser.onHWMiniGame)this._useCanvas=true;this._show=true;Stat._fpsData.length=60;this._view[0]={title:"FPS(WebGL)",value:"_fpsStr",color:"yellow",units:"int"};this._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"};this._view[2]={title:"RenderBatches",value:"renderBatches",color:"white",units:"int"};this._view[3]={title:"SavedRenderBatches",value:"savedRenderBatches",color:"white",units:"int"};this._view[4]={title:"CPUMemory",value:"cpuMemory",color:"yellow",units:"M"};this._view[5]={title:"GPUMemory",value:"gpuMemory",color:"yellow",units:"M"};this._view[6]={title:"Shader",value:"shaderCall",color:"white",units:"int"};this._view[7]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};if(Render.is3DMode){this._view[0].title="FPS(3D)";this._view[8]={title:"TriFaces",value:"trianglesFaces",color:"white",units:"int"};this._view[9]={title:"FrustumCulling",value:"frustumCulling",color:"white",units:"int"};this._view[10]={title:"OctreeNodeCulling",value:"octreeNodeCulling",color:"white",units:"int"};}if(this._useCanvas){this.createUIPre(x,y);}else this.createUI(x,y);this.enable();};_proto125.createUIPre=function createUIPre(x,y){var pixel=Browser.pixelRatio;this._width=pixel*180;this._vx=pixel*120;this._height=pixel*(this._view.length*12+3*pixel)+4;StatUI._fontSize=12*pixel;for(var i=0;i<this._view.length;i++){this._view[i].x=4;this._view[i].y=i*StatUI._fontSize+2*pixel;}if(!this._canvas){this._canvas=new HTMLCanvas(true);this._canvas.size(this._width,this._height);this._ctx=this._canvas.getContext('2d');this._ctx.textBaseline="top";this._ctx.font=StatUI._fontSize+"px Arial";this._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+x+"px;top:"+y+"px;width:"+this._width/pixel+"px;height:"+this._height/pixel+"px;";}if(!Browser.onKGMiniGame){Browser.container.appendChild(this._canvas.source);}this._first=true;this.loop();this._first=false;};_proto125.createUI=function createUI(x,y){var stat=this._sp;var pixel=Browser.pixelRatio;if(!stat){stat=new Sprite();this._leftText=new Text();this._leftText.pos(5,5);this._leftText.color="#ffffff";stat.addChild(this._leftText);this._txt=new Text();this._txt.pos(130*pixel,5);this._txt.color="#ffffff";stat.addChild(this._txt);this._sp=stat;}stat.pos(x,y);var text="";for(var i=0;i<this._view.length;i++){var one=this._view[i];text+=one.title+"\n";}this._leftText.text=text;var width=pixel*138;var height=pixel*(this._view.length*12+3*pixel)+4;this._txt.fontSize=StatUI._fontSize*pixel;this._leftText.fontSize=StatUI._fontSize*pixel;stat.size(width,height);stat.graphics.clear();stat.graphics.alpha(0.5);stat.graphics.drawRect(0,0,width+110,height+30,"#999999");stat.graphics.alpha(2);this.loop();};_proto125.enable=function enable(){ILaya.systemTimer.frameLoop(1,this,this.loop);};_proto125.hide=function hide(){this._show=false;ILaya.systemTimer.clear(this,this.loop);if(this._canvas){Browser.removeElement(this._canvas.source);}};_proto125.set_onclick=function set_onclick(fn){if(this._sp){this._sp.on("click",this._sp,fn);}if(this._canvas){this._canvas.source.onclick=fn;this._canvas.source.style.pointerEvents='';}};_proto125.loop=function loop(){Stat._count++;var timer=Browser.now();if(timer-Stat._timer<1000)return;var count=Stat._count;Stat.FPS=Math.round(count*1000/(timer-Stat._timer));if(this._show){Stat.trianglesFaces=Math.round(Stat.trianglesFaces/count);if(!this._useCanvas){Stat.renderBatches=Math.round(Stat.renderBatches/count)-1;}else {Stat.renderBatches=Math.round(Stat.renderBatches/count);}Stat.savedRenderBatches=Math.round(Stat.savedRenderBatches/count);Stat.shaderCall=Math.round(Stat.shaderCall/count);Stat.spriteRenderUseCacheCount=Math.round(Stat.spriteRenderUseCacheCount/count);Stat.canvasNormal=Math.round(Stat.canvasNormal/count);Stat.canvasBitmap=Math.round(Stat.canvasBitmap/count);Stat.canvasReCache=Math.ceil(Stat.canvasReCache/count);Stat.frustumCulling=Math.round(Stat.frustumCulling/count);Stat.octreeNodeCulling=Math.round(Stat.octreeNodeCulling/count);var delay=Stat.FPS>0?Math.floor(1000/Stat.FPS).toString():" ";Stat._fpsStr=Stat.FPS+(Stat.renderSlow?" slow":"")+" "+delay;Stat._spriteStr=Stat.spriteCount+(Stat.spriteRenderUseCacheCount?"/"+Stat.spriteRenderUseCacheCount:'');Stat._canvasStr=Stat.canvasReCache+"/"+Stat.canvasNormal+"/"+Stat.canvasBitmap;Stat.cpuMemory=Resource.cpuMemory;Stat.gpuMemory=Resource.gpuMemory;if(this._useCanvas){this.renderInfoPre();}else this.renderInfo();Stat.clear();}Stat._count=0;Stat._timer=timer;};_proto125.renderInfoPre=function renderInfoPre(){var i=0;var one;var value;if(this._canvas){var ctx=this._ctx;ctx.clearRect(this._first?0:this._vx,0,this._width,this._height);for(i=0;i<this._view.length;i++){one=this._view[i];if(this._first){ctx.fillStyle="white";ctx.fillText(one.title,one.x,one.y);}ctx.fillStyle=one.color;value=Stat[one.value];one.units=="M"&&(value=Math.floor(value/(1024*1024)*100)/100+" M");ctx.fillText(value+"",one.x+this._vx,one.y);}}};_proto125.renderInfo=function renderInfo(){var text="";for(var i=0;i<this._view.length;i++){var one=this._view[i];var value=Stat[one.value];one.units=="M"&&(value=Math.floor(value/(1024*1024)*100)/100+" M");one.units=="K"&&(value=Math.floor(value/1024*100)/100+" K");text+=value+"\n";}this._txt.text=text;};_proto125.isCanvasRender=function isCanvasRender(){return this._useCanvas;};_proto125.renderNotCanvas=function renderNotCanvas(ctx,x,y){this._show&&this._sp&&this._sp.render(ctx,0,0);};return StatUI;}(IStatRender);StatUI._fontSize=12;var Timer=/*#__PURE__*/function(){function Timer(autoActive){if(autoActive===void 0){autoActive=true;}this.scale=1;this.currTimer=Date.now();this.currFrame=0;this._delta=0;this._lastTimer=Date.now();this._map=[];this._handlers=[];this._temp=[];this._count=0;autoActive&&Timer.gSysTimer&&Timer.gSysTimer.frameLoop(1,this,this._update);}var _proto126=Timer.prototype;_proto126._update=function _update(){if(this.scale<=0){this._lastTimer=Date.now();this._delta=0;return;}var frame=this.currFrame=this.currFrame+this.scale;var now=Date.now();var awake=now-this._lastTimer>30000;this._delta=(now-this._lastTimer)*this.scale;var timer=this.currTimer=this.currTimer+this._delta;this._lastTimer=now;var handlers=this._handlers;this._count=0;for(var i=0,n=handlers.length;i<n;i++){var handler=handlers[i];if(handler.method!==null){var t=handler.userFrame?frame:timer;if(t>=handler.exeTime){if(handler.repeat){if(!handler.jumpFrame||awake){handler.exeTime+=handler.delay;handler.run(false);if(t>handler.exeTime){handler.exeTime+=Math.ceil((t-handler.exeTime)/handler.delay)*handler.delay;}}else {while(t>=handler.exeTime){handler.exeTime+=handler.delay;handler.run(false);}}}else {handler.run(true);}}}else {this._count++;}}if(this._count>30||frame%200===0)this._clearHandlers();};_proto126._clearHandlers=function _clearHandlers(){var handlers=this._handlers;for(var i=0,n=handlers.length;i<n;i++){var handler=handlers[i];if(handler.method!==null)this._temp.push(handler);else this._recoverHandler(handler);}this._handlers=this._temp;handlers.length=0;this._temp=handlers;};_proto126._recoverHandler=function _recoverHandler(handler){if(this._map[handler.key]==handler)this._map[handler.key]=null;handler.clear();Timer._pool.push(handler);};_proto126._create=function _create(useFrame,repeat,delay,caller,method,args,coverBefore){if(!delay){method.apply(caller,args);return null;}if(coverBefore){var handler=this._getHandler(caller,method);if(handler){handler.repeat=repeat;handler.userFrame=useFrame;handler.delay=delay;handler.caller=caller;handler.method=method;handler.args=args;handler.exeTime=delay+(useFrame?this.currFrame:this.currTimer+Date.now()-this._lastTimer);return handler;}}handler=Timer._pool.length>0?Timer._pool.pop():new TimerHandler();handler.repeat=repeat;handler.userFrame=useFrame;handler.delay=delay;handler.caller=caller;handler.method=method;handler.args=args;handler.exeTime=delay+(useFrame?this.currFrame:this.currTimer+Date.now()-this._lastTimer);this._indexHandler(handler);this._handlers.push(handler);return handler;};_proto126._indexHandler=function _indexHandler(handler){var caller=handler.caller;var method=handler.method;var cid=caller?caller.$_GID||(caller.$_GID=ILaya.Utils.getGID()):0;var mid=method.$_TID||(method.$_TID=Timer._mid++*100000);handler.key=cid+mid;this._map[handler.key]=handler;};_proto126.once=function once(delay,caller,method,args,coverBefore){if(args===void 0){args=null;}if(coverBefore===void 0){coverBefore=true;}this._create(false,false,delay,caller,method,args,coverBefore);};_proto126.loop=function loop(delay,caller,method,args,coverBefore,jumpFrame){if(args===void 0){args=null;}if(coverBefore===void 0){coverBefore=true;}if(jumpFrame===void 0){jumpFrame=false;}var handler=this._create(false,true,delay,caller,method,args,coverBefore);if(handler)handler.jumpFrame=jumpFrame;};_proto126.frameOnce=function frameOnce(delay,caller,method,args,coverBefore){if(args===void 0){args=null;}if(coverBefore===void 0){coverBefore=true;}this._create(true,false,delay,caller,method,args,coverBefore);};_proto126.frameLoop=function frameLoop(delay,caller,method,args,coverBefore){if(args===void 0){args=null;}if(coverBefore===void 0){coverBefore=true;}this._create(true,true,delay,caller,method,args,coverBefore);};_proto126.toString=function toString(){return " handlers:"+this._handlers.length+" pool:"+Timer._pool.length;};_proto126.clear=function clear(caller,method){var handler=this._getHandler(caller,method);if(handler){this._map[handler.key]=null;handler.key=0;handler.clear();}};_proto126.clearAll=function clearAll(caller){if(!caller)return;for(var i=0,n=this._handlers.length;i<n;i++){var handler=this._handlers[i];if(handler.caller===caller){this._map[handler.key]=null;handler.key=0;handler.clear();}}};_proto126._getHandler=function _getHandler(caller,method){var cid=caller?caller.$_GID||(caller.$_GID=ILaya.Utils.getGID()):0;var mid=method.$_TID||(method.$_TID=Timer._mid++*100000);return this._map[cid+mid];};_proto126.callLater=function callLater(caller,method,args){if(args===void 0){args=null;}CallLater.I.callLater(caller,method,args);};_proto126.runCallLater=function runCallLater(caller,method){CallLater.I.runCallLater(caller,method);};_proto126.runTimer=function runTimer(caller,method){var handler=this._getHandler(caller,method);if(handler&&handler.method!=null){this._map[handler.key]=null;handler.run(true);}};_proto126.pause=function pause(){this.scale=0;};_proto126.resume=function resume(){this.scale=1;};_createClass(Timer,[{key:"delta",get:function get(){return this._delta;}}]);return Timer;}();Timer.gSysTimer=null;Timer._pool=[];Timer._mid=1;var TimerHandler=/*#__PURE__*/function(){function TimerHandler(){}var _proto127=TimerHandler.prototype;_proto127.clear=function clear(){this.caller=null;this.method=null;this.args=null;};_proto127.run=function run(withClear){var caller=this.caller;if(caller&&caller.destroyed)return this.clear();var method=this.method;var args=this.args;withClear&&this.clear();if(method==null)return;args?method.apply(caller,args):method.call(caller);};return TimerHandler;}();var SkinSV=/*#__PURE__*/function(_Value2D){_inheritsLoose(SkinSV,_Value2D);function SkinSV(type){var _this39;_this39=_Value2D.call(this,ShaderDefines2D.SKINMESH,0)||this;_this39.offsetX=300;_this39.offsetY=0;var gl=WebGLContext.mainContext;var _vlen=8*CONST3D2D.BYTES_PE;_this39.position=[2,gl.FLOAT,false,_vlen,0];_this39.texcoord=[2,gl.FLOAT,false,_vlen,2*CONST3D2D.BYTES_PE];_this39.color=[4,gl.FLOAT,false,_vlen,4*CONST3D2D.BYTES_PE];return _this39;}return SkinSV;}(Value2D);var PrimitiveSV=/*#__PURE__*/function(_Value2D2){_inheritsLoose(PrimitiveSV,_Value2D2);function PrimitiveSV(args){var _this40;_this40=_Value2D2.call(this,ShaderDefines2D.PRIMITIVE,0)||this;_this40._attribLocation=['position',0,'attribColor',1];return _this40;}return PrimitiveSV;}(Value2D);var TextureSV=/*#__PURE__*/function(_Value2D3){_inheritsLoose(TextureSV,_Value2D3);function TextureSV(subID){var _this41;if(subID===void 0){subID=0;}_this41=_Value2D3.call(this,ShaderDefines2D.TEXTURE2D,subID)||this;_this41.strength=0;_this41.blurInfo=null;_this41.colorMat=null;_this41.colorAlpha=null;_this41._attribLocation=['posuv',0,'attribColor',1,'attribFlags',2];return _this41;}var _proto128=TextureSV.prototype;_proto128.clear=function clear(){this.texture=null;this.shader=null;this.defines._value=this.subID;};return TextureSV;}(Value2D);var InlcudeFile=/*#__PURE__*/function(){function InlcudeFile(txt){this.codes={};this.funs={};this.curUseID=-1;this.funnames="";this.script=txt;var begin=0,ofs,end;while(true){begin=txt.indexOf("#begin",begin);if(begin<0)break;end=begin+5;while(true){end=txt.indexOf("#end",end);if(end<0)break;if(txt.charAt(end+4)==='i')end+=5;else break;}if(end<0){throw "add include err,no #end:"+txt;}ofs=txt.indexOf('\n',begin);var words=ILaya.ShaderCompile.splitToWords(txt.substr(begin,ofs-begin),null);if(words[1]=='code'){this.codes[words[2]]=txt.substr(ofs+1,end-ofs-1);}else if(words[1]=='function'){ofs=txt.indexOf("function",begin);ofs+="function".length;this.funs[words[3]]=txt.substr(ofs+1,end-ofs-1);this.funnames+=words[3]+";";}begin=end+1;}}var _proto129=InlcudeFile.prototype;_proto129.getWith=function getWith(name){if(name===void 0){name=null;}var r=name?this.codes[name]:this.script;if(!r){throw "get with error:"+name;}return r;};_proto129.getFunsScript=function getFunsScript(funsdef){var r="";for(var i in this.funs){if(funsdef.indexOf(i+";")>=0){r+=this.funs[i];}}return r;};return InlcudeFile;}();var ShaderNode=/*#__PURE__*/function(){function ShaderNode(includefiles){this.childs=[];this.text="";this.useFuns="";this.z=0;this.includefiles=includefiles;}var _proto130=ShaderNode.prototype;_proto130.setParent=function setParent(parent){parent.childs.push(this);this.z=parent.z+1;this.parent=parent;};_proto130.setCondition=function setCondition(condition,type){if(condition){this.conditionType=type;condition=condition.replace(/(\s*$)/g,"");this.condition=function(){return this[condition];};this.condition.__condition=condition;}};_proto130.toscript=function toscript(def,out){return this._toscript(def,out,++ShaderNode.__id);};_proto130._toscript=function _toscript(def,out,id){if(this.childs.length<1&&!this.text)return out;var outIndex=out.length;if(this.condition){var ifdef=!!this.condition.call(def);this.conditionType===ILaya.ShaderCompile.IFDEF_ELSE&&(ifdef=!ifdef);if(!ifdef)return out;}this.text&&out.push(this.text);this.childs.length>0&&this.childs.forEach(function(o,index,arr){o._toscript(def,out,id);});if(this.includefiles.length>0&&this.useFuns.length>0){var funsCode;for(var i=0,n=this.includefiles.length;i<n;i++){if(this.includefiles[i].curUseID==id){continue;}funsCode=this.includefiles[i].file.getFunsScript(this.useFuns);if(funsCode.length>0){this.includefiles[i].curUseID=id;out[0]=funsCode+out[0];}}}return out;};return ShaderNode;}();ShaderNode.__id=1;var ShaderCompile=/*#__PURE__*/function(){function ShaderCompile(vs,ps,nameMap){this.defs={};var _this=this;function _compile(script){script=script.replace(ShaderCompile._clearCR,"");var includefiles=[];var top=new ShaderNode(includefiles);_this._compileToTree(top,script.split('\n'),0,includefiles,_this.defs);return top;}var startTime=Date.now();this._VS=_compile(vs);this._PS=_compile(ps);this._nameMap=nameMap;if(Date.now()-startTime>2)console.log("ShaderCompile use time:"+(Date.now()-startTime)+"  size:"+vs.length+"/"+ps.length);}ShaderCompile.__init__=function __init__(){var gl=LayaGL.instance;ShaderCompile.shaderParamsMap={"float":gl.FLOAT,"int":gl.INT,"bool":gl.BOOL,"vec2":gl.FLOAT_VEC2,"vec3":gl.FLOAT_VEC3,"vec4":gl.FLOAT_VEC4,"ivec2":gl.INT_VEC2,"ivec3":gl.INT_VEC3,"ivec4":gl.INT_VEC4,"bvec2":gl.BOOL_VEC2,"bvec3":gl.BOOL_VEC3,"bvec4":gl.BOOL_VEC4,"mat2":gl.FLOAT_MAT2,"mat3":gl.FLOAT_MAT3,"mat4":gl.FLOAT_MAT4,"sampler2D":gl.SAMPLER_2D,"samplerCube":gl.SAMPLER_CUBE};};ShaderCompile._parseOne=function _parseOne(attributes,uniforms,words,i,word,b){var one={type:ShaderCompile.shaderParamsMap[words[i+1]],name:words[i+2],size:isNaN(parseInt(words[i+3]))?1:parseInt(words[i+3])};if(b){if(word=="attribute"){attributes.push(one);}else {uniforms.push(one);}}if(words[i+3]==':'){one.type=words[i+4];i+=2;}i+=2;return i;};ShaderCompile.addInclude=function addInclude(fileName,txt){if(!txt||txt.length===0)throw new Error("add shader include file err:"+fileName);if(ShaderCompile.includes[fileName])throw new Error("add shader include file err, has add:"+fileName);ShaderCompile.includes[fileName]=new InlcudeFile(txt);};ShaderCompile.preGetParams=function preGetParams(vs,ps){var text=[vs,ps];var result={};var attributes=[];var uniforms=[];var definesInfo={};var definesName=[];result.attributes=attributes;result.uniforms=uniforms;result.defines=definesInfo;var i,n;for(var s=0;s<2;s++){text[s]=text[s].replace(ShaderCompile._removeAnnotation,"");var words=text[s].match(ShaderCompile._reg);var tempelse;for(i=0,n=words.length;i<n;i++){var word=words[i];if(word!="attribute"&&word!="uniform"){if(word=="#define"){word=words[++i];definesName[word]=1;continue;}else if(word=="#ifdef"){tempelse=words[++i];var def=definesInfo[tempelse]=definesInfo[tempelse]||[];for(i++;i<n;i++){word=words[i];if(word!="attribute"&&word!="uniform"){if(word=="#else"){for(i++;i<n;i++){word=words[i];if(word!="attribute"&&word!="uniform"){if(word=="#endif"){break;}continue;}i=ShaderCompile._parseOne(attributes,uniforms,words,i,word,!definesName[tempelse]);}}continue;}i=ShaderCompile._parseOne(attributes,uniforms,words,i,word,definesName[tempelse]);}}continue;}i=ShaderCompile._parseOne(attributes,uniforms,words,i,word,true);}}return result;};ShaderCompile.splitToWords=function splitToWords(str,block){var out=[];var c;var ofs=-1;var word;for(var i=0,n=str.length;i<n;i++){c=str.charAt(i);if(" \t=+-*/&%!<>()'\",;".indexOf(c)>=0){if(ofs>=0&&i-ofs>1){word=str.substr(ofs,i-ofs);out.push(word);}if(c=='"'||c=="'"){var ofs2=str.indexOf(c,i+1);if(ofs2<0){throw "Sharder err:"+str;}out.push(str.substr(i+1,ofs2-i-1));i=ofs2;ofs=-1;continue;}if(c=='('&&block&&out.length>0){word=out[out.length-1]+";";if("vec4;main;".indexOf(word)<0)block.useFuns+=word;}ofs=-1;continue;}if(ofs<0)ofs=i;}if(ofs<n&&n-ofs>1){word=str.substr(ofs,n-ofs);out.push(word);}return out;};var _proto131=ShaderCompile.prototype;_proto131._compileToTree=function _compileToTree(parent,lines,start,includefiles,defs){var node,preNode;var text,name,fname;var ofs,words,noUseNode;var i,n,j;for(i=start;i<lines.length;i++){text=lines[i];if(text.length<1)continue;ofs=text.indexOf("//");if(ofs===0)continue;if(ofs>=0)text=text.substr(0,ofs);node=noUseNode||new ShaderNode(includefiles);noUseNode=null;node.text=text;node.noCompile=true;if((ofs=text.indexOf("#"))>=0){name="#";for(j=ofs+1,n=text.length;j<n;j++){var c=text.charAt(j);if(c===' '||c==='\t'||c==='?')break;name+=c;}node.name=name;switch(name){case"#ifdef":case"#ifndef":node.src=text;node.noCompile=text.match(/[!&|()=<>]/)!=null;if(!node.noCompile){words=text.replace(/^\s*/,'').split(/\s+/);node.setCondition(words[1],name==="#ifdef"?ShaderCompile.IFDEF_YES:ShaderCompile.IFDEF_ELSE);node.text="//"+node.text;}else {console.log("function():Boolean{return "+text.substr(ofs+node.name.length)+"}");}node.setParent(parent);parent=node;if(defs){words=text.substr(j).split(ShaderCompile._splitToWordExps3);for(j=0;j<words.length;j++){text=words[j];text.length&&(defs[text]=true);}}continue;case"#if":node.src=text;node.noCompile=true;node.setParent(parent);parent=node;if(defs){words=text.substr(j).split(ShaderCompile._splitToWordExps3);for(j=0;j<words.length;j++){text=words[j];text.length&&text!="defined"&&(defs[text]=true);}}continue;case"#else":node.src=text;parent=parent.parent;preNode=parent.childs[parent.childs.length-1];node.noCompile=preNode.noCompile;if(!node.noCompile){node.condition=preNode.condition;node.conditionType=preNode.conditionType==ShaderCompile.IFDEF_YES?ShaderCompile.IFDEF_ELSE:ShaderCompile.IFDEF_YES;node.text="//"+node.text+" "+preNode.text+" "+node.conditionType;}node.setParent(parent);parent=node;continue;case"#endif":parent=parent.parent;preNode=parent.childs[parent.childs.length-1];node.noCompile=preNode.noCompile;if(!node.noCompile){node.text="//"+node.text;}node.setParent(parent);continue;case"#include":words=ShaderCompile.splitToWords(text,null);var inlcudeFile=ShaderCompile.includes[words[1]];if(!inlcudeFile){throw "ShaderCompile error no this include file:"+words[1];}if((ofs=words[0].indexOf("?"))<0){node.setParent(parent);text=inlcudeFile.getWith(words[2]=='with'?words[3]:null);this._compileToTree(node,text.split('\n'),0,includefiles,defs);node.text="";continue;}node.setCondition(words[0].substr(ofs+1),ShaderCompile.IFDEF_YES);node.text=inlcudeFile.getWith(words[2]=='with'?words[3]:null);break;case"#import":words=ShaderCompile.splitToWords(text,null);fname=words[1];includefiles.push({node:node,file:ShaderCompile.includes[fname],ofs:node.text.length});continue;}}else {preNode=parent.childs[parent.childs.length-1];if(preNode&&!preNode.name){includefiles.length>0&&ShaderCompile.splitToWords(text,preNode);noUseNode=node;preNode.text+="\n"+text;continue;}includefiles.length>0&&ShaderCompile.splitToWords(text,node);}node.setParent(parent);}};_proto131.createShader=function createShader(define,shaderName,_createShader2,bindAttrib){var defMap={};var defineStr="";if(define){for(var i in define){defineStr+="#define "+i+"\n";defMap[i]=true;}}var vs=this._VS.toscript(defMap,[]);var ps=this._PS.toscript(defMap,[]);return (_createShader2||Shader.create)(defineStr+vs.join('\n'),defineStr+ps.join('\n'),shaderName,this._nameMap,bindAttrib);};return ShaderCompile;}();ShaderCompile.IFDEF_NO=0;ShaderCompile.IFDEF_YES=1;ShaderCompile.IFDEF_ELSE=2;ShaderCompile.IFDEF_PARENT=3;ShaderCompile._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g");ShaderCompile._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g");ShaderCompile._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%\(\),;])","g");ShaderCompile.includes={};ShaderCompile._clearCR=new RegExp("\r","g");ShaderCompile._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%\(\),;\\|]","g");var WorkerLoader=/*#__PURE__*/function(_EventDispatcher11){_inheritsLoose(WorkerLoader,_EventDispatcher11);function WorkerLoader(){var _this42;_this42=_EventDispatcher11.call(this)||this;_this42.worker=new Worker(WorkerLoader.workerPath);var me=_assertThisInitialized(_this42);_this42.worker.onmessage=function(evt){me.workerMessage(evt.data);};return _this42;}WorkerLoader.__init__=function __init__(){if(WorkerLoader._preLoadFun!=null)return false;if(!Worker)return false;WorkerLoader._preLoadFun=Loader["prototype"]["_loadImage"];Loader["prototype"]["_loadImage"]=WorkerLoader["prototype"]["_loadImage"];if(!WorkerLoader.I)WorkerLoader.I=new WorkerLoader();return true;};WorkerLoader.workerSupported=function workerSupported(){return Worker?true:false;};WorkerLoader.enableWorkerLoader=function enableWorkerLoader(){if(!WorkerLoader._tryEnabled){WorkerLoader.enable=true;WorkerLoader._tryEnabled=true;}};var _proto132=WorkerLoader.prototype;_proto132.workerMessage=function workerMessage(data){if(data){switch(data.type){case"Image":this.imageLoaded(data);break;case"Disable":WorkerLoader.enable=false;break;}}};_proto132.imageLoaded=function imageLoaded(data){if(!data.dataType||data.dataType!="imageBitmap"){this.event(data.url,null);return;}var imageData=data.imageBitmap;console.log("load:",data.url);this.event(data.url,imageData);};_proto132.loadImage=function loadImage(url){this.worker.postMessage(url);};_proto132._loadImage=function _loadImage(url){var _this=this;var type=_this.type;if(!this._useWorkerLoader||!WorkerLoader._enable){WorkerLoader._preLoadFun.call(_this,url);return;}url=URL.formatURL(url);function clear(){WorkerLoader.I.off(url,_this,onload);}var onload=function onload(imageData){clear();if(imageData){var image=imageData;if(type!=="nativeimage"){image=new Texture2D();image.loadImageSource(imageData);}_this["onLoaded"](image);}else {WorkerLoader._preLoadFun.call(_this,url);}};WorkerLoader.I.on(url,_this,onload);WorkerLoader.I.loadImage(url);};_createClass(WorkerLoader,null,[{key:"enable",set:function set(value){if(WorkerLoader._enable!=value){WorkerLoader._enable=value;if(value&&WorkerLoader._preLoadFun==null)WorkerLoader._enable=WorkerLoader.__init__();}},get:function get(){return WorkerLoader._enable;}}]);return WorkerLoader;}(EventDispatcher);WorkerLoader.workerPath="libs/workerloader.js";WorkerLoader._enable=false;WorkerLoader._tryEnabled=false;var Mouse=/*#__PURE__*/function(){function Mouse(){}Mouse.__init__=function __init__(){Mouse._style=Browser.document.body.style;};Mouse.hide=function hide(){if(Mouse.cursor!="none"){Mouse._preCursor=Mouse.cursor;Mouse.cursor="none";}};Mouse.show=function show(){if(Mouse.cursor=="none"){if(Mouse._preCursor){Mouse.cursor=Mouse._preCursor;}else {Mouse.cursor="auto";}}};_createClass(Mouse,null,[{key:"cursor",set:function set(cursorStr){Mouse._style.cursor=cursorStr;},get:function get(){return Mouse._style.cursor;}}]);return Mouse;}();var MeshParticle2D=/*#__PURE__*/function(_Mesh2D4){_inheritsLoose(MeshParticle2D,_Mesh2D4);function MeshParticle2D(maxNum){var _this43;_this43=_Mesh2D4.call(this,MeshParticle2D.const_stride,maxNum*4*MeshParticle2D.const_stride,4)||this;_this43.canReuse=true;_this43.setAttributes(MeshParticle2D._fixattriInfo);_this43.createQuadIB(maxNum);_this43._quadNum=maxNum;return _this43;}MeshParticle2D.__init__=function __init__(){var gl=LayaGL.instance;MeshParticle2D._fixattriInfo=[gl.FLOAT,4,0,gl.FLOAT,3,16,gl.FLOAT,3,28,gl.FLOAT,4,40,gl.FLOAT,4,56,gl.FLOAT,3,72,gl.FLOAT,2,84,gl.FLOAT,4,92,gl.FLOAT,1,108,gl.FLOAT,1,112];};var _proto133=MeshParticle2D.prototype;_proto133.setMaxParticleNum=function setMaxParticleNum(maxNum){this._vb._resizeBuffer(maxNum*4*MeshParticle2D.const_stride,false);this.createQuadIB(maxNum);};MeshParticle2D.getAMesh=function getAMesh(maxNum){if(MeshParticle2D._POOL.length){var ret=MeshParticle2D._POOL.pop();ret.setMaxParticleNum(maxNum);return ret;}return new MeshParticle2D(maxNum);};_proto133.releaseMesh=function releaseMesh(){this._vb.setByteLength(0);this.vertNum=0;this.indexNum=0;MeshParticle2D._POOL.push(this);};_proto133.destroy=function destroy(){this._ib.destroy();this._vb.destroy();this._vb.deleteBuffer();};return MeshParticle2D;}(Mesh2D);MeshParticle2D.const_stride=116;MeshParticle2D._POOL=[];var HTMLImage=/*#__PURE__*/function(_Bitmap3){_inheritsLoose(HTMLImage,_Bitmap3);function HTMLImage(){return _Bitmap3.apply(this,arguments)||this;}return HTMLImage;}(Bitmap);HTMLImage.create=function(width,height,format){var tex=new Texture2D(width,height,format,false,false);tex.wrapModeU=exports.WarpMode.Clamp;tex.wrapModeV=exports.WarpMode.Clamp;return tex;};var Laya=/*#__PURE__*/function(){function Laya(){}Laya.__init=function __init(_classs){_classs.forEach(function(o){o.__init$&&o.__init$();});};Laya.init=function init(width,height){if(Laya._isinit)return;Laya._isinit=true;ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=Laya._arrayBufferSlice);Browser.__init__();var mainCanv=Browser.mainCanvas=new HTMLCanvas(true);var style=mainCanv.source.style;style.position='absolute';style.top=style.left="0px";style.background="#000000";if(!Browser.onKGMiniGame&&!Browser.onAlipayMiniGame){Browser.container.appendChild(mainCanv.source);}Browser.canvas=new HTMLCanvas(true);Browser.context=Browser.canvas.getContext('2d');Browser.supportWebAudio=SoundManager.__init__();Browser.supportLocalStorage=LocalStorage.__init__();Laya.systemTimer=new Timer(false);exports.systemTimer=Timer.gSysTimer=Laya.systemTimer;Laya.startTimer=new Timer(false);Laya.physicsTimer=new Timer(false);Laya.updateTimer=new Timer(false);Laya.lateTimer=new Timer(false);Laya.timer=new Timer(false);exports.startTimer=ILaya.startTimer=Laya.startTimer;exports.lateTimer=ILaya.lateTimer=Laya.lateTimer;exports.updateTimer=ILaya.updateTimer=Laya.updateTimer;ILaya.systemTimer=Laya.systemTimer;exports.timer=ILaya.timer=Laya.timer;exports.physicsTimer=ILaya.physicsTimer=Laya.physicsTimer;Laya.loader=new LoaderManager();ILaya.Laya=Laya;exports.loader=ILaya.loader=Laya.loader;WeakObject.__init__();SceneUtils.__init();Mouse.__init__();WebGL.inner_enable();for(var _len=arguments.length,plugins=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){plugins[_key-2]=arguments[_key];}if(plugins){for(var i=0,n=plugins.length;i<n;i++){if(plugins[i]&&plugins[i].enable){plugins[i].enable();}}}if(ILaya.Render.isConchApp){Laya.enableNative();}Laya.enableWebGLPlus();CacheManger.beginCheck();exports.stage=Laya.stage=new Stage();ILaya.stage=Laya.stage;Utils.gStage=Laya.stage;URL.rootPath=URL._basePath=Laya._getUrlPath();MeshQuadTexture.__int__();MeshVG.__init__();MeshTexture.__init__();Laya.render=new Render(0,0,Browser.mainCanvas);exports.render=Laya.render;Laya.stage.size(width,height);window.stage=Laya.stage;WebGLContext.__init__();MeshParticle2D.__init__();ShaderCompile.__init__();RenderSprite.__init__();KeyBoardManager.__init__();MouseManager.instance.__init__(Laya.stage,Render.canvas);Input.__init__();SoundManager.autoStopMusic=true;Stat._StatRender=new StatUI();Value2D._initone(ShaderDefines2D.TEXTURE2D,TextureSV);Value2D._initone(ShaderDefines2D.TEXTURE2D|ShaderDefines2D.FILTERGLOW,TextureSV);Value2D._initone(ShaderDefines2D.PRIMITIVE,PrimitiveSV);Value2D._initone(ShaderDefines2D.SKINMESH,SkinSV);return Render.canvas;};Laya._getUrlPath=function _getUrlPath(){return URL.getPath(location.protocol+"//"+location.host+location.pathname);};Laya._arrayBufferSlice=function _arrayBufferSlice(start,end){var arr=this;var arrU8List=new Uint8Array(arr,start,end-start);var newU8List=new Uint8Array(arrU8List.length);newU8List.set(arrU8List);return newU8List.buffer;};Laya.alertGlobalError=function alertGlobalError(value){var erralert=0;if(value){Browser.window.onerror=function(msg,url,line,column,detail){if(erralert++<5&&detail)this.alert("出错啦，请把此信息截图给研发商\n"+msg+"\n"+detail.stack);};}else {Browser.window.onerror=null;}};Laya._runScript=function _runScript(script){return Browser.window[Laya._evcode](script);};Laya.enableDebugPanel=function enableDebugPanel(debugJsPath){if(debugJsPath===void 0){debugJsPath="libs/laya.debugtool.js";}if(!window['Laya']["DebugPanel"]){var script=Browser.createElement("script");script.onload=function(){window['Laya']["DebugPanel"].enable();};script.src=debugJsPath;Browser.document.body.appendChild(script);}else {window['Laya']["DebugPanel"].enable();}};Laya.enableWebGLPlus=function enableWebGLPlus(){WebGLContext.__init_native();};Laya.enableNative=function enableNative(){if(Laya.isNativeRender_enable)return;Laya.isNativeRender_enable=true;if(Render.supportWebGLPlusRendering){Shader.prototype.uploadTexture2D=function(value){var gl=LayaGL.instance;gl.bindTexture(gl.TEXTURE_2D,value);};}RenderState2D.width=Browser.window.innerWidth;RenderState2D.height=Browser.window.innerHeight;Browser.measureText=function(txt,font){window["conchTextCanvas"].font=font;return window["conchTextCanvas"].measureText(txt);};Stage.clear=function(color){Context.set2DRenderConfig();var c=ColorUtils.create(color).arrColor;var gl=LayaGL.instance;if(c)gl.clearColor(c[0],c[1],c[2],c[3]);gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT|gl.STENCIL_BUFFER_BIT);RenderState2D.clear();};Sprite.drawToCanvas=Sprite.drawToTexture=function(sprite,_renderType,canvasWidth,canvasHeight,offsetX,offsetY){offsetX-=sprite.x;offsetY-=sprite.y;offsetX|=0;offsetY|=0;canvasWidth|=0;canvasHeight|=0;var canv=new HTMLCanvas(false);var ctx=canv.getContext('2d');canv.size(canvasWidth,canvasHeight);ctx.asBitmap=true;ctx._targets.start();RenderSprite.renders[_renderType]._fun(sprite,ctx,offsetX,offsetY);ctx.flush();ctx._targets.end();ctx._targets.restore();return canv;};Object["defineProperty"](RenderTexture2D.prototype,"uv",{"get":function get(){return this._uv;},"set":function set(v){this._uv=v;}});HTMLCanvas.prototype.getTexture=function(){if(!this._texture){this._texture=this.context._targets;this._texture.uv=RenderTexture2D.flipyuv;this._texture.bitmap=this._texture;}return this._texture;};};return Laya;}();Laya.stage=null;Laya.systemTimer=null;Laya.startTimer=null;Laya.physicsTimer=null;Laya.updateTimer=null;Laya.lateTimer=null;Laya.timer=null;Laya.loader=null;Laya.version="2.8.0beta";Laya._isinit=false;Laya.isWXOpenDataContext=false;Laya.isWXPosMsg=false;Laya.__classmap=null;Laya.Config=Config;Laya.TextRender=TextRender;Laya.EventDispatcher=EventDispatcher;Laya.SoundChannel=SoundChannel;Laya.Stage=Stage;Laya.Render=Render;Laya.Browser=Browser;Laya.Sprite=Sprite;Laya.Node=Node;Laya.Context=Context;Laya.WebGL=WebGL;Laya.Handler=Handler;Laya.RunDriver=RunDriver;Laya.Utils=Utils;Laya.Input=Input;Laya.Loader=Loader;Laya.LocalStorage=LocalStorage;Laya.SoundManager=SoundManager;Laya.URL=URL;Laya.Event=Event;Laya.Matrix=Matrix;Laya.HTMLImage=HTMLImage;Laya.Laya=Laya;Laya._evcode="eva"+"l";Laya.isNativeRender_enable=false;Laya.__classmap=ILaya.__classMap;ILaya.Timer=Timer;ILaya.Dragging=Dragging;ILaya.GraphicsBounds=GraphicsBounds;ILaya.Sprite=Sprite;ILaya.TextRender=TextRender;ILaya.Loader=Loader;ILaya.TTFLoader=TTFLoader;ILaya.WebAudioSound=WebAudioSound;ILaya.SoundManager=SoundManager;ILaya.ShaderCompile=ShaderCompile;ILaya.ClassUtils=ClassUtils;ILaya.SceneUtils=SceneUtils;ILaya.Context=Context;ILaya.Render=Render;ILaya.MouseManager=MouseManager;ILaya.Text=Text;ILaya.Browser=Browser;ILaya.WebGL=WebGL;ILaya.AudioSound=AudioSound;ILaya.Pool=Pool;ILaya.Utils=Utils;ILaya.Graphics=Graphics;ILaya.Submit=Submit;ILaya.Stage=Stage;ILaya.Resource=Resource;ILaya.WorkerLoader=WorkerLoader;var libs=window._layalibs;if(libs){libs.sort(function(a,b){return a.i-b.i;});for(var j=0;j<libs.length;j++){libs[j].f(window,window.document,Laya);}}var win=window;if(win.Laya){win.Laya.Laya=Laya;Object.assign(win.Laya,Laya);}else win.Laya=Laya;var __init=Laya.__init;var init=Laya.init;var version=Laya.version;var isWXOpenDataContext;var isWXPosMsg;var alertGlobalError=Laya.alertGlobalError;var enableDebugPanel=Laya.enableDebugPanel;function _static(_class,def){for(var i=0,sz=def.length;i<sz;i+=2){if(def[i]=='length')_class.length=def[i+1].call(_class);else {var tmp=function tmp(){var name=def[i];var getfn=def[i+1];Object.defineProperty(_class,name,{get:function get(){delete this[name];return this[name]=getfn.call(this);},set:function set(v){delete this[name];this[name]=v;},enumerable:true,configurable:true});};tmp();}}}var CommonScript=/*#__PURE__*/function(_Component){_inheritsLoose(CommonScript,_Component);_createClass(CommonScript,[{key:"isSingleton",get:function get(){return false;}}]);function CommonScript(){return _Component.call(this)||this;}var _proto134=CommonScript.prototype;_proto134.onAwake=function onAwake(){};_proto134.onEnable=function onEnable(){};_proto134.onStart=function onStart(){};_proto134.onUpdate=function onUpdate(){};_proto134.onLateUpdate=function onLateUpdate(){};_proto134.onDisable=function onDisable(){};_proto134.onDestroy=function onDestroy(){};return CommonScript;}(Component);var Script=/*#__PURE__*/function(_Component2){_inheritsLoose(Script,_Component2);function Script(){return _Component2.apply(this,arguments)||this;}var _proto135=Script.prototype;_proto135._onAwake=function _onAwake(){this.onAwake();if(this.onStart!==Script.prototype.onStart){ILaya.startTimer.callLater(this,this.onStart);}};_proto135._onEnable=function _onEnable(){var proto=Script.prototype;if(this.onTriggerEnter!==proto.onTriggerEnter){this.owner.on(Event.TRIGGER_ENTER,this,this.onTriggerEnter);}if(this.onTriggerStay!==proto.onTriggerStay){this.owner.on(Event.TRIGGER_STAY,this,this.onTriggerStay);}if(this.onTriggerExit!==proto.onTriggerExit){this.owner.on(Event.TRIGGER_EXIT,this,this.onTriggerExit);}if(this.onMouseDown!==proto.onMouseDown){this.owner.on(Event.MOUSE_DOWN,this,this.onMouseDown);}if(this.onMouseUp!==proto.onMouseUp){this.owner.on(Event.MOUSE_UP,this,this.onMouseUp);}if(this.onClick!==proto.onClick){this.owner.on(Event.CLICK,this,this.onClick);}if(this.onStageMouseDown!==proto.onStageMouseDown){ILaya.stage.on(Event.MOUSE_DOWN,this,this.onStageMouseDown);}if(this.onStageMouseUp!==proto.onStageMouseUp){ILaya.stage.on(Event.MOUSE_UP,this,this.onStageMouseUp);}if(this.onStageClick!==proto.onStageClick){ILaya.stage.on(Event.CLICK,this,this.onStageClick);}if(this.onStageMouseMove!==proto.onStageMouseMove){ILaya.stage.on(Event.MOUSE_MOVE,this,this.onStageMouseMove);}if(this.onDoubleClick!==proto.onDoubleClick){this.owner.on(Event.DOUBLE_CLICK,this,this.onDoubleClick);}if(this.onRightClick!==proto.onRightClick){this.owner.on(Event.RIGHT_CLICK,this,this.onRightClick);}if(this.onMouseMove!==proto.onMouseMove){this.owner.on(Event.MOUSE_MOVE,this,this.onMouseMove);}if(this.onMouseOver!==proto.onMouseOver){this.owner.on(Event.MOUSE_OVER,this,this.onMouseOver);}if(this.onMouseOut!==proto.onMouseOut){this.owner.on(Event.MOUSE_OUT,this,this.onMouseOut);}if(this.onKeyDown!==proto.onKeyDown){ILaya.stage.on(Event.KEY_DOWN,this,this.onKeyDown);}if(this.onKeyPress!==proto.onKeyPress){ILaya.stage.on(Event.KEY_PRESS,this,this.onKeyPress);}if(this.onKeyUp!==proto.onKeyUp){ILaya.stage.on(Event.KEY_UP,this,this.onKeyUp);}if(this.onUpdate!==proto.onUpdate){ILaya.updateTimer.frameLoop(1,this,this.onUpdate);}if(this.onLateUpdate!==proto.onLateUpdate){ILaya.lateTimer.frameLoop(1,this,this.onLateUpdate);}if(this.onPreRender!==proto.onPreRender){ILaya.lateTimer.frameLoop(1,this,this.onPreRender);}this.onEnable();};_proto135._onDisable=function _onDisable(){this.owner.offAllCaller(this);ILaya.stage.offAllCaller(this);ILaya.startTimer.clearAll(this);ILaya.updateTimer.clearAll(this);ILaya.lateTimer.clearAll(this);};_proto135._isScript=function _isScript(){return true;};_proto135._onDestroy=function _onDestroy(){this.onDestroy();};_proto135.onAwake=function onAwake(){};_proto135.onEnable=function onEnable(){};_proto135.onStart=function onStart(){};_proto135.onTriggerEnter=function onTriggerEnter(other,self,contact){};_proto135.onTriggerStay=function onTriggerStay(other,self,contact){};_proto135.onTriggerExit=function onTriggerExit(other,self,contact){};_proto135.onMouseDown=function onMouseDown(e){};_proto135.onMouseUp=function onMouseUp(e){};_proto135.onClick=function onClick(e){};_proto135.onStageMouseDown=function onStageMouseDown(e){};_proto135.onStageMouseUp=function onStageMouseUp(e){};_proto135.onStageClick=function onStageClick(e){};_proto135.onStageMouseMove=function onStageMouseMove(e){};_proto135.onDoubleClick=function onDoubleClick(e){};_proto135.onRightClick=function onRightClick(e){};_proto135.onMouseMove=function onMouseMove(e){};_proto135.onMouseOver=function onMouseOver(e){};_proto135.onMouseOut=function onMouseOut(e){};_proto135.onKeyDown=function onKeyDown(e){};_proto135.onKeyPress=function onKeyPress(e){};_proto135.onKeyUp=function onKeyUp(e){};_proto135.onUpdate=function onUpdate(){};_proto135.onLateUpdate=function onLateUpdate(){};_proto135.onPreRender=function onPreRender(){};_proto135.onPostRender=function onPostRender(){};_proto135.onDisable=function onDisable(){};_proto135.onDestroy=function onDestroy(){};_createClass(Script,[{key:"isSingleton",get:function get(){return false;}}]);return Script;}(Component);var GraphicAnimation=/*#__PURE__*/function(_FrameAnimation){_inheritsLoose(GraphicAnimation,_FrameAnimation);function GraphicAnimation(){var _this44;_this44=_FrameAnimation.apply(this,arguments)||this;_this44._nodeIDAniDic={};return _this44;}var _proto136=GraphicAnimation.prototype;_proto136._parseNodeList=function _parseNodeList(uiView){if(!this._nodeList)this._nodeList=[];this._nodeDefaultProps[uiView.compId]=uiView.props;if(uiView.compId)this._nodeList.push(uiView.compId);var childs=uiView.child;if(childs){var i,len=childs.length;for(i=0;i<len;i++){this._parseNodeList(childs[i]);}}};_proto136._calGraphicData=function _calGraphicData(aniData){this._setUp(null,aniData);this._createGraphicData();if(this._nodeIDAniDic){var key;for(key in this._nodeIDAniDic){this._nodeIDAniDic[key]=null;}}};_proto136._createGraphicData=function _createGraphicData(){var gList=[];var i,len=this.count;var animationDataNew=this._usedFrames;if(!animationDataNew)animationDataNew=[];var preGraphic;for(i=0;i<len;i++){if(animationDataNew[i]||!preGraphic){preGraphic=this._createFrameGraphic(i);}gList.push(preGraphic);}this._gList=gList;};_proto136._createFrameGraphic=function _createFrameGraphic(frame){var g=new Graphics();if(!GraphicAnimation._rootMatrix)GraphicAnimation._rootMatrix=new Matrix();this._updateNodeGraphic(this._rootNode,frame,GraphicAnimation._rootMatrix,g);return g;};_proto136._updateNodeGraphic=function _updateNodeGraphic(node,frame,parentTransfrom,g,alpha){if(alpha===void 0){alpha=1;}var tNodeG;tNodeG=this._nodeGDic[node.compId]=this._getNodeGraphicData(node.compId,frame,this._nodeGDic[node.compId]);if(!tNodeG.resultTransform)tNodeG.resultTransform=new Matrix();var tResultTransform;tResultTransform=tNodeG.resultTransform;Matrix.mul(tNodeG.transform,parentTransfrom,tResultTransform);var tTex;var tGraphicAlpha=tNodeG.alpha*alpha;if(tGraphicAlpha<0.01)return;if(tNodeG.skin){tTex=this._getTextureByUrl(tNodeG.skin);if(tTex){if(tResultTransform._checkTransform()){g.drawTexture(tTex,0,0,tNodeG.width,tNodeG.height,tResultTransform,tGraphicAlpha);tNodeG.resultTransform=null;}else {g.drawTexture(tTex,tResultTransform.tx,tResultTransform.ty,tNodeG.width,tNodeG.height,null,tGraphicAlpha);}}}var childs=node.child;if(!childs)return;var i,len;len=childs.length;for(i=0;i<len;i++){this._updateNodeGraphic(childs[i],frame,tResultTransform,g,tGraphicAlpha);}};_proto136._updateNoChilds=function _updateNoChilds(tNodeG,g){if(!tNodeG.skin)return;var tTex=this._getTextureByUrl(tNodeG.skin);if(!tTex)return;var tTransform=tNodeG.transform;tTransform._checkTransform();var onlyTranslate;onlyTranslate=!tTransform._bTransform;if(!onlyTranslate){g.drawTexture(tTex,0,0,tNodeG.width,tNodeG.height,tTransform.clone(),tNodeG.alpha);}else {g.drawTexture(tTex,tTransform.tx,tTransform.ty,tNodeG.width,tNodeG.height,null,tNodeG.alpha);}};_proto136._updateNodeGraphic2=function _updateNodeGraphic2(node,frame,g){var tNodeG;tNodeG=this._nodeGDic[node.compId]=this._getNodeGraphicData(node.compId,frame,this._nodeGDic[node.compId]);if(!node.child){this._updateNoChilds(tNodeG,g);return;}var tTransform=tNodeG.transform;tTransform._checkTransform();var onlyTranslate;onlyTranslate=!tTransform._bTransform;var hasTrans;hasTrans=onlyTranslate&&(tTransform.tx!=0||tTransform.ty!=0);var ifSave;ifSave=tTransform._bTransform||tNodeG.alpha!=1;if(ifSave)g.save();if(tNodeG.alpha!=1)g.alpha(tNodeG.alpha);if(!onlyTranslate)g.transform(tTransform.clone());else if(hasTrans)g.translate(tTransform.tx,tTransform.ty);var childs=node.child;var tTex;if(tNodeG.skin){tTex=this._getTextureByUrl(tNodeG.skin);if(tTex){g.drawImage(tTex,0,0,tNodeG.width,tNodeG.height);}}if(childs){var i,len;len=childs.length;for(i=0;i<len;i++){this._updateNodeGraphic2(childs[i],frame,g);}}if(ifSave){g.restore();}else {if(!onlyTranslate){g.transform(tTransform.clone().invert());}else if(hasTrans){g.translate(-tTransform.tx,-tTransform.ty);}}};_proto136._calculateKeyFrames=function _calculateKeyFrames(node){_FrameAnimation.prototype._calculateKeyFrames.call(this,node);this._nodeIDAniDic[node.target]=node;};_proto136.getNodeDataByID=function getNodeDataByID(nodeID){return this._nodeIDAniDic[nodeID];};_proto136._getParams=function _getParams(obj,params,frame,obj2){var rst=GraphicAnimation._temParam;rst.length=params.length;var i,len=params.length;for(i=0;i<len;i++){rst[i]=this._getObjVar(obj,params[i][0],frame,params[i][1],obj2);}return rst;};_proto136._getObjVar=function _getObjVar(obj,key,frame,noValue,obj2){if(key in obj){var vArr=obj[key];if(frame>=vArr.length)frame=vArr.length-1;return obj[key][frame];}if(key in obj2){return obj2[key];}return noValue;};_proto136._getNodeGraphicData=function _getNodeGraphicData(nodeID,frame,rst){if(!rst)rst=new GraphicNode();if(!rst.transform){rst.transform=new Matrix();}else {rst.transform.identity();}var node=this.getNodeDataByID(nodeID);if(!node)return rst;var frameData=node.frames;var params=this._getParams(frameData,GraphicAnimation._drawTextureCmd,frame,this._nodeDefaultProps[nodeID]);var url=params[0];var width,height;var px=params[5],py=params[6];var aX=params[13],aY=params[14];var sx=params[7],sy=params[8];var rotate=params[9];var skewX=params[11],skewY=params[12];width=params[3];height=params[4];if(width==0||height==0)url=null;if(width==-1)width=0;if(height==-1)height=0;var tex;rst.skin=url;rst.width=width;rst.height=height;if(url){tex=this._getTextureByUrl(url);if(tex){if(!width)width=tex.sourceWidth;if(!height)height=tex.sourceHeight;}else {console.warn("lost skin:",url,",you may load pics first");}}rst.alpha=params[10];var m=rst.transform;if(aX!=0){px=aX*width;}if(aY!=0){py=aY*height;}if(px!=0||py!=0){m.translate(-px,-py);}var tm=null;if(rotate||sx!==1||sy!==1||skewX||skewY){tm=GraphicAnimation._tempMt;tm.identity();tm._bTransform=true;var skx=(rotate-skewX)*0.0174532922222222;var sky=(rotate+skewY)*0.0174532922222222;var cx=Math.cos(sky);var ssx=Math.sin(sky);var cy=Math.sin(skx);var ssy=Math.cos(skx);tm.a=sx*cx;tm.b=sx*ssx;tm.c=-sy*cy;tm.d=sy*ssy;tm.tx=tm.ty=0;}if(tm){m=Matrix.mul(m,tm,m);}m.translate(params[1],params[2]);return rst;};_proto136._getTextureByUrl=function _getTextureByUrl(url){return Loader.getRes(url);};_proto136.setAniData=function setAniData(uiView,aniName){if(aniName===void 0){aniName=null;}if(uiView.animations){this._nodeDefaultProps={};this._nodeGDic={};if(this._nodeList)this._nodeList.length=0;this._rootNode=uiView;this._parseNodeList(uiView);var aniDic={};var anilist=[];var animations=uiView.animations;var i,len=animations.length;var tAniO;for(i=0;i<len;i++){tAniO=animations[i];this._labels=null;if(aniName&&aniName!=tAniO.name){continue;}if(!tAniO)continue;try{this._calGraphicData(tAniO);}catch(e){console.warn("parse animation fail:"+tAniO.name+",empty animation created");this._gList=[];}var frameO={};frameO.interval=1000/tAniO["frameRate"];frameO.frames=this._gList;frameO.labels=this._labels;frameO.name=tAniO.name;anilist.push(frameO);aniDic[tAniO.name]=frameO;}this.animationList=anilist;this.animationDic=aniDic;}GraphicAnimation._temParam.length=0;};_proto136.parseByData=function parseByData(aniData){var rootNode,aniO;rootNode=aniData.nodeRoot;aniO=aniData.aniO;delete aniData.nodeRoot;delete aniData.aniO;this._nodeDefaultProps={};this._nodeGDic={};if(this._nodeList)this._nodeList.length=0;this._rootNode=rootNode;this._parseNodeList(rootNode);this._labels=null;try{this._calGraphicData(aniO);}catch(e){console.warn("parse animation fail:"+aniO.name+",empty animation created");this._gList=[];}var frameO=aniData;frameO.interval=1000/aniO["frameRate"];frameO.frames=this._gList;frameO.labels=this._labels;frameO.name=aniO.name;return frameO;};_proto136.setUpAniData=function setUpAniData(uiView){if(uiView.animations){var aniDic={};var anilist=[];var animations=uiView.animations;var i,len=animations.length;var tAniO;for(i=0;i<len;i++){tAniO=animations[i];if(!tAniO)continue;var frameO={};frameO.name=tAniO.name;frameO.aniO=tAniO;frameO.nodeRoot=uiView;anilist.push(frameO);aniDic[tAniO.name]=frameO;}this.animationList=anilist;this.animationDic=aniDic;}};_proto136._clear=function _clear(){this.animationList=null;this.animationDic=null;this._gList=null;this._nodeGDic=null;};GraphicAnimation.parseAnimationByData=function parseAnimationByData(animationObject){if(!GraphicAnimation._I)GraphicAnimation._I=new GraphicAnimation();var rst;rst=GraphicAnimation._I.parseByData(animationObject);GraphicAnimation._I._clear();return rst;};GraphicAnimation.parseAnimationData=function parseAnimationData(aniData){if(!GraphicAnimation._I)GraphicAnimation._I=new GraphicAnimation();GraphicAnimation._I.setUpAniData(aniData);var rst;rst={};rst.animationList=GraphicAnimation._I.animationList;rst.animationDic=GraphicAnimation._I.animationDic;GraphicAnimation._I._clear();return rst;};return GraphicAnimation;}(FrameAnimation);GraphicAnimation._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]];GraphicAnimation._temParam=[];GraphicAnimation._tempMt=new Matrix();var GraphicNode=function GraphicNode(){this.alpha=1;};var Animation=/*#__PURE__*/function(_AnimationBase2){_inheritsLoose(Animation,_AnimationBase2);function Animation(){var _this45;_this45=_AnimationBase2.call(this)||this;_this45._setControlNode(_assertThisInitialized(_this45));return _this45;}var _proto137=Animation.prototype;_proto137.destroy=function destroy(destroyChild){if(destroyChild===void 0){destroyChild=true;}this.stop();_AnimationBase2.prototype.destroy.call(this,destroyChild);this._frames=null;this._labels=null;};_proto137.play=function play(start,loop,name){if(start===void 0){start=0;}if(loop===void 0){loop=true;}if(name===void 0){name="";}if(name)this._setFramesFromCache(name,true);_AnimationBase2.prototype.play.call(this,start,loop,name);};_proto137._setFramesFromCache=function _setFramesFromCache(name,showWarn){if(showWarn===void 0){showWarn=false;}if(this._url)name=this._url+"#"+name;if(name&&Animation.framesMap[name]){var tAniO=Animation.framesMap[name];if(tAniO instanceof Array){this._frames=Animation.framesMap[name];this._count=this._frames.length;}else {if(tAniO.nodeRoot){Animation.framesMap[name]=GraphicAnimation.parseAnimationByData(tAniO);tAniO=Animation.framesMap[name];}this._frames=tAniO.frames;this._count=this._frames.length;if(!this._frameRateChanged)this._interval=tAniO.interval;this._labels=this._copyLabels(tAniO.labels);}return true;}else {if(showWarn)console.log("ani not found:",name);}return false;};_proto137._copyLabels=function _copyLabels(labels){if(!labels)return null;var rst;rst={};var key;for(key in labels){rst[key]=Utils.copyArray([],labels[key]);}return rst;};_proto137._frameLoop=function _frameLoop(){if(this._visible&&this._style.alpha>0.01&&this._frames){_AnimationBase2.prototype._frameLoop.call(this);}};_proto137._displayToIndex=function _displayToIndex(value){if(this._frames)this.graphics=this._frames[value];};_proto137.clear=function clear(){_AnimationBase2.prototype.clear.call(this);this.stop();this.graphics=null;this._frames=null;this._labels=null;return this;};_proto137.loadImages=function loadImages(urls,cacheName){if(cacheName===void 0){cacheName="";}this._url="";if(!this._setFramesFromCache(cacheName)){this.frames=Animation.framesMap[cacheName]?Animation.framesMap[cacheName]:Animation.createFrames(urls,cacheName);}return this;};_proto137.loadAtlas=function loadAtlas(url,loaded,cacheName){if(loaded===void 0){loaded=null;}if(cacheName===void 0){cacheName="";}this._url="";var _this=this;if(!_this._setFramesFromCache(cacheName)){var onLoaded=function onLoaded(loadUrl){if(url===loadUrl){_this.frames=Animation.framesMap[cacheName]?Animation.framesMap[cacheName]:Animation.createFrames(url,cacheName);if(loaded)loaded.run();}};if(Loader.getAtlas(url))onLoaded(url);else ILaya.loader.load(url,Handler.create(null,onLoaded,[url]),null,Loader.ATLAS);}return this;};_proto137.loadAnimation=function loadAnimation(url,loaded,atlas){if(loaded===void 0){loaded=null;}if(atlas===void 0){atlas=null;}this._url=url;var _this=this;if(!this._actionName)this._actionName="";if(!_this._setFramesFromCache(this._actionName)){if(!atlas||Loader.getAtlas(atlas)){this._loadAnimationData(url,loaded,atlas);}else {ILaya.loader.load(atlas,Handler.create(this,this._loadAnimationData,[url,loaded,atlas]),null,Loader.ATLAS);}}else {_this._setFramesFromCache(this._actionName,true);this.index=0;if(loaded)loaded.run();}return this;};_proto137._loadAnimationData=function _loadAnimationData(url,loaded,atlas){if(loaded===void 0){loaded=null;}if(atlas===void 0){atlas=null;}if(atlas&&!Loader.getAtlas(atlas)){console.warn("atlas load fail:"+atlas);return;}var _this=this;function onLoaded(loadUrl){if(!Loader.getRes(loadUrl)){if(Animation.framesMap[url+"#"]){_this._setFramesFromCache(_this._actionName,true);_this.index=0;_this._resumePlay();if(loaded)loaded.run();}return;}if(url===loadUrl){var tAniO;if(!Animation.framesMap[url+"#"]){var aniData=GraphicAnimation.parseAnimationData(Loader.getRes(url));if(!aniData)return;var aniList=aniData.animationList;var i,len=aniList.length;var defaultO;for(i=0;i<len;i++){tAniO=aniList[i];Animation.framesMap[url+"#"+tAniO.name]=tAniO;if(!defaultO)defaultO=tAniO;}if(defaultO){Animation.framesMap[url+"#"]=defaultO;_this._setFramesFromCache(_this._actionName,true);_this.index=0;}_this._resumePlay();}else {_this._setFramesFromCache(_this._actionName,true);_this.index=0;_this._resumePlay();}if(loaded)loaded.run();}Loader.clearRes(url);}if(Loader.getRes(url))onLoaded(url);else ILaya.loader.load(url,Handler.create(null,onLoaded,[url]),null,Loader.JSON);};Animation.createFrames=function createFrames(url,name){var arr;if(typeof url=='string'){var atlas=Loader.getAtlas(url);if(atlas&&atlas.length){arr=[];for(var i=0,n=atlas.length;i<n;i++){var g=new Graphics();g.drawImage(Loader.getRes(atlas[i]),0,0);arr.push(g);}}}else if(url instanceof Array){arr=[];for(i=0,n=url.length;i<n;i++){g=new Graphics();g.loadImage(url[i],0,0);arr.push(g);}}if(name)Animation.framesMap[name]=arr;return arr;};Animation.clearCache=function clearCache(key){var cache=Animation.framesMap;var val;var key2=key+"#";for(val in cache){if(val===key||val.indexOf(key2)===0){delete Animation.framesMap[val];}}};_createClass(Animation,[{key:"frames",get:function get(){return this._frames;},set:function set(value){this._frames=value;if(value){this._count=value.length;if(this._actionName)this._setFramesFromCache(this._actionName,true);this.index=this._index;}}},{key:"source",set:function set(value){if(value.indexOf(".ani")>-1)this.loadAnimation(value);else if(value.indexOf(".json")>-1||value.indexOf("als")>-1||value.indexOf("atlas")>-1)this.loadAtlas(value);else this.loadImages(value.split(","));}},{key:"autoAnimation",set:function set(value){this.play(0,true,value);}},{key:"autoPlay",set:function set(value){if(value)this.play();else this.stop();}}]);return Animation;}(AnimationBase);Animation.framesMap={};ILaya.regClass(Animation);ClassUtils.regClass("laya.display.Animation",Animation);ClassUtils.regClass("Laya.Animation",Animation);var EffectAnimation=/*#__PURE__*/function(_FrameAnimation2){_inheritsLoose(EffectAnimation,_FrameAnimation2);function EffectAnimation(){var _this46;_this46=_FrameAnimation2.apply(this,arguments)||this;_this46._initData={};return _this46;}var _proto138=EffectAnimation.prototype;_proto138._onOtherBegin=function _onOtherBegin(effect){if(effect===this)return;this.stop();};_proto138._addEvent=function _addEvent(){if(!this._target||!this._playEvent)return;this._setControlNode(this._target);this._target.on(this._playEvent,this,this._onPlayAction);};_proto138._onPlayAction=function _onPlayAction(){this.play(0,false);};_proto138.play=function play(start,loop,name){if(start===void 0){start=0;}if(loop===void 0){loop=true;}if(name===void 0){name="";}if(!this._target)return;this._target.event(EffectAnimation.EFFECT_BEGIN,[this]);this._recordInitData();_FrameAnimation2.prototype.play.call(this,start,loop,name);};_proto138._recordInitData=function _recordInitData(){if(!this._aniKeys)return;var i,len;len=this._aniKeys.length;var key;for(i=0;i<len;i++){key=this._aniKeys[i];this._initData[key]=this._target[key];}};_proto138._displayToIndex=function _displayToIndex(value){if(!this._animationData)return;if(value<0)value=0;if(value>this._count)value=this._count;var nodes=this._animationData.nodes,i,len=nodes.length;len=len>1?1:len;for(i=0;i<len;i++){this._displayNodeToFrame(nodes[i],value);}};_proto138._displayNodeToFrame=function _displayNodeToFrame(node,frame,targetDic){if(!this._target)return;var target=this._target;var frames=node.frames,key,propFrames,value;var keys=node.keys,i,len=keys.length;var secondFrames=node.secondFrames;var tSecondFrame;var easeFun;var tKeyFrames;var startFrame;var endFrame;for(i=0;i<len;i++){key=keys[i];propFrames=frames[key];tSecondFrame=secondFrames[key];if(tSecondFrame==-1){value=this._initData[key];}else {if(frame<tSecondFrame){tKeyFrames=node.keyframes[key];startFrame=tKeyFrames[0];if(startFrame.tween){easeFun=Ease[startFrame.tweenMethod];if(easeFun==null)easeFun=Ease.linearNone;endFrame=tKeyFrames[1];value=easeFun(frame,this._initData[key],endFrame.value-this._initData[key],endFrame.index);}else {value=this._initData[key];}}else {if(propFrames.length>frame)value=propFrames[frame];else value=propFrames[propFrames.length-1];}}target[key]=value;}};_proto138._calculateKeyFrames=function _calculateKeyFrames(node){_FrameAnimation2.prototype._calculateKeyFrames.call(this,node);var keyFrames=node.keyframes,key,tKeyFrames,target=node.target;var secondFrames={};node.secondFrames=secondFrames;for(key in keyFrames){tKeyFrames=keyFrames[key];if(tKeyFrames.length<=1)secondFrames[key]=-1;else secondFrames[key]=tKeyFrames[1].index;}};_createClass(EffectAnimation,[{key:"target",set:function set(v){if(this._target)this._target.off(EffectAnimation.EFFECT_BEGIN,this,this._onOtherBegin);this._target=v;if(this._target)this._target.on(EffectAnimation.EFFECT_BEGIN,this,this._onOtherBegin);this._addEvent();},get:function get(){return this._target;}},{key:"playEvent",set:function set(event){this._playEvent=event;if(!event)return;this._addEvent();}},{key:"effectClass",set:function set(classStr){this._effectClass=ClassUtils.getClass(classStr);if(this._effectClass){var uiData=this._effectClass["uiView"];if(uiData){var aniData=uiData["animations"];if(aniData&&aniData[0]){var data=aniData[0];this._setUp({},data);if(data.nodes&&data.nodes[0]){this._aniKeys=data.nodes[0].keys;}}}}}},{key:"effectData",set:function set(uiData){if(uiData){var aniData=uiData["animations"];if(aniData&&aniData[0]){var data=aniData[0];this._setUp({},data);if(data.nodes&&data.nodes[0]){this._aniKeys=data.nodes[0].keys;}}}}}]);return EffectAnimation;}(FrameAnimation);EffectAnimation.EFFECT_BEGIN="effectbegin";ClassUtils.regClass("laya.display.EffectAnimation",EffectAnimation);ClassUtils.regClass("Laya.EffectAnimation",EffectAnimation);var SceneLoader=/*#__PURE__*/function(_EventDispatcher12){_inheritsLoose(SceneLoader,_EventDispatcher12);function SceneLoader(){var _this47;_this47=_EventDispatcher12.call(this)||this;_this47._completeHandler=new Handler(_assertThisInitialized(_this47),_this47.onOneLoadComplete);_this47.reset();return _this47;}var _proto139=SceneLoader.prototype;_proto139.reset=function reset(){this._toLoadList=[];this._isLoading=false;this.totalCount=0;};_proto139.load=function load(url,is3D,ifCheck){if(is3D===void 0){is3D=false;}if(ifCheck===void 0){ifCheck=true;}if(url instanceof Array){var i,len;len=url.length;for(i=0;i<len;i++){this._addToLoadList(url[i],is3D);}}else {this._addToLoadList(url,is3D);}if(ifCheck)this._checkNext();};_proto139._addToLoadList=function _addToLoadList(url,is3D){if(is3D===void 0){is3D=false;}if(this._toLoadList.indexOf(url)>=0)return;if(Loader.getRes(url))return;if(is3D){this._toLoadList.push({url:url});}else this._toLoadList.push(url);this.totalCount++;};_proto139._checkNext=function _checkNext(){if(!this._isLoading){if(this._toLoadList.length==0){this.event(Event.COMPLETE);return;}var tItem;tItem=this._toLoadList.pop();if(typeof tItem=='string'){this.loadOne(tItem);}else {this.loadOne(tItem.url,true);}}};_proto139.loadOne=function loadOne(url,is3D){if(is3D===void 0){is3D=false;}this._curUrl=url;var type=Utils.getFileExtension(this._curUrl);if(is3D){ILaya.loader.create(url,this._completeHandler);}else if(SceneLoader.LoadableExtensions[type]){ILaya.loader.load(url,this._completeHandler,null,SceneLoader.LoadableExtensions[type]);}else if(url!=AtlasInfoManager.getFileLoadPath(url)||SceneLoader.No3dLoadTypes[type]||!LoaderManager.createMap[type]){ILaya.loader.load(url,this._completeHandler);}else {ILaya.loader.create(url,this._completeHandler);}};_proto139.onOneLoadComplete=function onOneLoadComplete(){this._isLoading=false;if(!Loader.getRes(this._curUrl)){console.log("Fail to load:",this._curUrl);}var type=Utils.getFileExtension(this._curUrl);if(SceneLoader.LoadableExtensions[type]){var dataO;dataO=Loader.getRes(this._curUrl);if(dataO&&dataO instanceof Prefab){dataO=dataO.json;}if(dataO){if(dataO.loadList){this.load(dataO.loadList,false,false);}if(dataO.loadList3D){this.load(dataO.loadList3D,true,false);}}}if(type=="sk"){this.load(this._curUrl.replace(".sk",".png"),false,false);}this.event(Event.PROGRESS,this.getProgress());this._checkNext();};_proto139.getProgress=function getProgress(){return this.loadedCount/this.totalCount;};_createClass(SceneLoader,[{key:"leftCount",get:function get(){if(this._isLoading)return this._toLoadList.length+1;return this._toLoadList.length;}},{key:"loadedCount",get:function get(){return this.totalCount-this.leftCount;}}]);return SceneLoader;}(EventDispatcher);SceneLoader.LoadableExtensions={"scene":Loader.JSON,"scene3d":Loader.JSON,"ani":Loader.JSON,"ui":Loader.JSON,"prefab":Loader.PREFAB};SceneLoader.No3dLoadTypes={"png":true,"jpg":true,"txt":true};var Scene=/*#__PURE__*/function(_Sprite4){_inheritsLoose(Scene,_Sprite4);function Scene(createChildren){var _this48;if(createChildren===void 0){createChildren=true;}_this48=_Sprite4.call(this)||this;_this48.autoDestroyAtClosed=false;_this48.url=null;_this48._viewCreated=false;_this48._$componentType="Scene";_this48._setBit(Const.NOT_READY,true);Scene.unDestroyedScenes.push(_assertThisInitialized(_this48));_this48._scene=_assertThisInitialized(_this48);if(createChildren)_this48.createChildren();return _this48;}var _proto140=Scene.prototype;_proto140.createChildren=function createChildren(){};Scene.setUIMap=function setUIMap(url){var uimap=ILaya.loader.getRes(url);if(uimap){for(var key in uimap){ILaya.Loader.loadedMap[URL.formatURL(key+".scene")]=uimap[key];}}else {throw "请提前加载uimap的json，再使用该接口设置！";}};_proto140.loadScene=function loadScene(path){var url=path.indexOf(".")>-1?path:path+".scene";var view=ILaya.loader.getRes(url);if(view){this.createView(view);}else {ILaya.loader.resetProgress();var loader=new SceneLoader();loader.on(Event.COMPLETE,this,this._onSceneLoaded,[url]);loader.load(url);}};_proto140._onSceneLoaded=function _onSceneLoaded(url){this.createView(ILaya.Loader.getRes(url));};_proto140.createView=function createView(view){if(view&&!this._viewCreated){this._viewCreated=true;SceneUtils.createByData(this,view);}};_proto140.getNodeByID=function getNodeByID(id){if(this._idMap)return this._idMap[id];return null;};_proto140.open=function open(closeOther,param){if(closeOther===void 0){closeOther=true;}if(param===void 0){param=null;}if(closeOther)Scene.closeAll();Scene.root.addChild(this);this.onOpened(param);};_proto140.onOpened=function onOpened(param){};_proto140.close=function close(type){if(type===void 0){type=null;}this.onClosed(type);if(this.autoDestroyAtClosed)this.destroy();else this.removeSelf();};_proto140.onClosed=function onClosed(type){};_proto140.destroy=function destroy(destroyChild){if(destroyChild===void 0){destroyChild=true;}this._idMap=null;_Sprite4.prototype.destroy.call(this,destroyChild);var list=Scene.unDestroyedScenes;for(var i=list.length-1;i>-1;i--){if(list[i]===this){list.splice(i,1);return;}}};_proto140._sizeChanged=function _sizeChanged(){this.event(Event.RESIZE);};Scene.load=function load(url,complete,progress){if(complete===void 0){complete=null;}if(progress===void 0){progress=null;}ILaya.loader.resetProgress();var loader=new SceneLoader();loader.on(Event.PROGRESS,null,onProgress);loader.once(Event.COMPLETE,null,create);loader.load(url);function onProgress(value){if(Scene._loadPage)Scene._loadPage.event("progress",value);progress&&progress.runWith(value);}function create(){loader.off(Event.PROGRESS,null,onProgress);var obj=ILaya.Loader.getRes(url);if(!obj)throw "Can not find scene:"+url;if(!obj.props)throw "Scene data is error:"+url;var runtime=obj.props.runtime?obj.props.runtime:obj.type;var clas=ILaya.ClassUtils.getClass(runtime);if(obj.props.renderType=="instance"){var scene=clas.instance||(clas.instance=new clas());}else {scene=new clas();}if(scene&&scene instanceof Node){scene.url=url;if(!scene._getBit(Const.NOT_READY)){complete&&complete.runWith(scene);}else {scene.on("onViewCreated",null,function(){complete&&complete.runWith(scene);});scene.createView(obj);}Scene.hideLoadingPage();}else {throw "Can not find scene:"+runtime;}}};Scene.open=function open(url,closeOther,param,complete,progress){if(closeOther===void 0){closeOther=true;}if(param===void 0){param=null;}if(complete===void 0){complete=null;}if(progress===void 0){progress=null;}if(param instanceof Handler){var temp=complete;complete=param;param=temp;}Scene.showLoadingPage();Scene.load(url,Handler.create(null,this._onSceneLoaded,[closeOther,complete,param]),progress);};Scene._onSceneLoaded=function _onSceneLoaded(closeOther,complete,param,scene){scene.open(closeOther,param);if(complete)complete.runWith(scene);};Scene.close=function close(url,name){if(name===void 0){name="";}var flag=false;var list=Scene.unDestroyedScenes;for(var i=0,n=list.length;i<n;i++){var scene=list[i];if(scene&&scene.parent&&scene.url===url&&scene.name==name){scene.close();flag=true;}}return flag;};Scene.closeAll=function closeAll(){var root=Scene.root;for(var i=0,n=root.numChildren;i<n;i++){var scene=root.getChildAt(0);if(scene instanceof Scene)scene.close();else scene.removeSelf();}};Scene.destroy=function destroy(url,name){if(name===void 0){name="";}var flag=false;var list=[].concat(Scene.unDestroyedScenes);for(var i=0,n=list.length;i<n;i++){var scene=list[i];if(scene.url===url&&scene.name==name&&!scene.destroyed){scene.destroy();flag=true;}}return flag;};Scene.gc=function gc(){Resource.destroyUnusedResources();};Scene.setLoadingPage=function setLoadingPage(loadPage){if(Scene._loadPage!=loadPage){Scene._loadPage=loadPage;}};Scene.showLoadingPage=function showLoadingPage(param,delay){if(param===void 0){param=null;}if(delay===void 0){delay=500;}if(Scene._loadPage){ILaya.systemTimer.clear(null,Scene._showLoading);ILaya.systemTimer.clear(null,Scene._hideLoading);ILaya.systemTimer.once(delay,null,Scene._showLoading,[param],false);}};Scene._showLoading=function _showLoading(param){ILaya.stage.addChild(Scene._loadPage);Scene._loadPage.onOpened(param);};Scene._hideLoading=function _hideLoading(){Scene._loadPage.close();};Scene.hideLoadingPage=function hideLoadingPage(delay){if(delay===void 0){delay=500;}if(Scene._loadPage){ILaya.systemTimer.clear(null,Scene._showLoading);ILaya.systemTimer.clear(null,Scene._hideLoading);ILaya.systemTimer.once(delay,null,Scene._hideLoading);}};_createClass(Scene,[{key:"scaleX",set:function set(value){if(_Sprite4.prototype.get_scaleX.call(this)==value)return;_Sprite4.prototype.set_scaleX.call(this,value);this.event(Event.RESIZE);},get:function get(){return _Sprite4.prototype.scaleX;}},{key:"scaleY",set:function set(value){if(_Sprite4.prototype.get_scaleY.call(this)==value)return;_Sprite4.prototype.set_scaleY.call(this,value);this.event(Event.RESIZE);},get:function get(){return _Sprite4.prototype.scaleY;}},{key:"width",get:function get(){if(this._width)return this._width;var max=0;for(var i=this.numChildren-1;i>-1;i--){var comp=this.getChildAt(i);if(comp._visible){max=Math.max(comp._x+comp.width*comp.scaleX,max);}}return max;},set:function set(value){if(_Sprite4.prototype.get_width.call(this)==value)return;_Sprite4.prototype.set_width.call(this,value);this.callLater(this._sizeChanged);}},{key:"height",get:function get(){if(this._height)return this._height;var max=0;for(var i=this.numChildren-1;i>-1;i--){var comp=this.getChildAt(i);if(comp._visible){max=Math.max(comp._y+comp.height*comp.scaleY,max);}}return max;},set:function set(value){if(_Sprite4.prototype.get_height.call(this)==value)return;_Sprite4.prototype.set_height.call(this,value);this.callLater(this._sizeChanged);}},{key:"timer",get:function get(){return this._timer||ILaya.timer;},set:function set(value){this._timer=value;}}],[{key:"root",get:function get(){if(!Scene._root){Scene._root=ILaya.stage.addChild(new Sprite());Scene._root.name="root";ILaya.stage.on("resize",null,function(){Scene._root.size(ILaya.stage.width,ILaya.stage.height);Scene._root.event(Event.RESIZE);});Scene._root.size(ILaya.stage.width,ILaya.stage.height);Scene._root.event(Event.RESIZE);}return Scene._root;}}]);return Scene;}(Sprite);Scene.unDestroyedScenes=[];ILaya.regClass(Scene);ClassUtils.regClass("laya.display.Scene",Scene);ClassUtils.regClass("Laya.Scene",Scene);var DrawParticleCmd=/*#__PURE__*/function(){function DrawParticleCmd(){}DrawParticleCmd.create=function create(_temp){var cmd=Pool.getItemByClass("DrawParticleCmd",DrawParticleCmd);cmd._templ=_temp;return cmd;};var _proto141=DrawParticleCmd.prototype;_proto141.recover=function recover(){this._templ=null;Pool.recover("DrawParticleCmd",this);};_proto141.run=function run(context,gx,gy){context.drawParticle(gx,gy,this._templ);};_createClass(DrawParticleCmd,[{key:"cmdID",get:function get(){return DrawParticleCmd.ID;}}]);return DrawParticleCmd;}();DrawParticleCmd.ID="DrawParticleCmd";var FilterSetterBase=/*#__PURE__*/function(){function FilterSetterBase(){}var _proto142=FilterSetterBase.prototype;_proto142.paramChanged=function paramChanged(){Laya.systemTimer.callLater(this,this.buildFilter);};_proto142.buildFilter=function buildFilter(){if(this._target){this.addFilter(this._target);}};_proto142.addFilter=function addFilter(sprite){if(!sprite)return;if(!sprite.filters){sprite.filters=[this._filter];}else {var preFilters;preFilters=sprite.filters;if(preFilters.indexOf(this._filter)<0){preFilters.push(this._filter);sprite.filters=Utils.copyArray([],preFilters);}}};_proto142.removeFilter=function removeFilter(sprite){if(!sprite)return;sprite.filters=null;};_createClass(FilterSetterBase,[{key:"target",set:function set(value){if(this._target!=value){this._target=value;this.paramChanged();}}}]);return FilterSetterBase;}();var BlurFilterGLRender=/*#__PURE__*/function(){function BlurFilterGLRender(){}var _proto143=BlurFilterGLRender.prototype;_proto143.render=function render(rt,ctx,width,height,filter){var shaderValue=Value2D.create(ShaderDefines2D.TEXTURE2D,0);this.setShaderInfo(shaderValue,filter,rt.width,rt.height);ctx.drawTarget(rt,0,0,width,height,Matrix.EMPTY.identity(),shaderValue);};_proto143.setShaderInfo=function setShaderInfo(shader,filter,w,h){shader.defines.add(Filter.BLUR);var sv=shader;BlurFilterGLRender.blurinfo[0]=w;BlurFilterGLRender.blurinfo[1]=h;sv.blurInfo=BlurFilterGLRender.blurinfo;var sigma=filter.strength/3.0;var sigma2=sigma*sigma;filter.strength_sig2_2sig2_gauss1[0]=filter.strength;filter.strength_sig2_2sig2_gauss1[1]=sigma2;filter.strength_sig2_2sig2_gauss1[2]=2.0*sigma2;filter.strength_sig2_2sig2_gauss1[3]=1.0/(2.0*Math.PI*sigma2);sv.strength_sig2_2sig2_gauss1=filter.strength_sig2_2sig2_gauss1;};return BlurFilterGLRender;}();BlurFilterGLRender.blurinfo=new Array(2);var BlurFilter=/*#__PURE__*/function(_Filter2){_inheritsLoose(BlurFilter,_Filter2);function BlurFilter(strength){var _this49;if(strength===void 0){strength=4;}_this49=_Filter2.call(this)||this;_this49.strength_sig2_2sig2_gauss1=[];_this49.strength=strength;_this49._glRender=new BlurFilterGLRender();return _this49;}var _proto144=BlurFilter.prototype;_proto144.getStrenth_sig2_2sig2_native=function getStrenth_sig2_2sig2_native(){if(!this.strength_sig2_native){this.strength_sig2_native=new Float32Array(4);}var sigma=this.strength/3.0;var sigma2=sigma*sigma;this.strength_sig2_native[0]=this.strength;this.strength_sig2_native[1]=sigma2;this.strength_sig2_native[2]=2.0*sigma2;this.strength_sig2_native[3]=1.0/(2.0*Math.PI*sigma2);return this.strength_sig2_native;};_createClass(BlurFilter,[{key:"type",get:function get(){return Filter.BLUR;}}]);return BlurFilter;}(Filter);var BlurFilterSetter=/*#__PURE__*/function(_FilterSetterBase){_inheritsLoose(BlurFilterSetter,_FilterSetterBase);function BlurFilterSetter(){var _this50;_this50=_FilterSetterBase.call(this)||this;_this50._strength=4;_this50._filter=new BlurFilter(_this50.strength);return _this50;}var _proto145=BlurFilterSetter.prototype;_proto145.buildFilter=function buildFilter(){this._filter=new BlurFilter(this.strength);_FilterSetterBase.prototype.buildFilter.call(this);};_createClass(BlurFilterSetter,[{key:"strength",get:function get(){return this._strength;},set:function set(value){this._strength=value;}}]);return BlurFilterSetter;}(FilterSetterBase);var ButtonEffect=/*#__PURE__*/function(){function ButtonEffect(){this._curState=0;this.effectScale=1.5;this.tweenTime=300;}var _proto146=ButtonEffect.prototype;_proto146.toChangedState=function toChangedState(){this._curState=1;if(this._curTween)Tween.clear(this._curTween);this._curTween=Tween.to(this._tar,{scaleX:this.effectScale,scaleY:this.effectScale},this.tweenTime,Ease[this.effectEase],Handler.create(this,this.tweenComplete));};_proto146.toInitState=function toInitState(){if(this._curState==2)return;if(this._curTween)Tween.clear(this._curTween);this._curState=2;this._curTween=Tween.to(this._tar,{scaleX:1,scaleY:1},this.tweenTime,Ease[this.backEase],Handler.create(this,this.tweenComplete));};_proto146.tweenComplete=function tweenComplete(){this._curState=0;this._curTween=null;};_createClass(ButtonEffect,[{key:"target",set:function set(tar){this._tar=tar;tar.on(Event.MOUSE_DOWN,this,this.toChangedState);tar.on(Event.MOUSE_UP,this,this.toInitState);tar.on(Event.MOUSE_OUT,this,this.toInitState);}}]);return ButtonEffect;}();var ColorFilterSetter=/*#__PURE__*/function(_FilterSetterBase2){_inheritsLoose(ColorFilterSetter,_FilterSetterBase2);function ColorFilterSetter(){var _this51;_this51=_FilterSetterBase2.call(this)||this;_this51._brightness=0;_this51._contrast=0;_this51._saturation=0;_this51._hue=0;_this51._red=0;_this51._green=0;_this51._blue=0;_this51._alpha=0;_this51._filter=new ColorFilter();return _this51;}var _proto147=ColorFilterSetter.prototype;_proto147.buildFilter=function buildFilter(){this._filter.reset();this._filter.color(this.red,this.green,this.blue,this.alpha);this._filter.adjustHue(this.hue);this._filter.adjustContrast(this.contrast);this._filter.adjustBrightness(this.brightness);this._filter.adjustSaturation(this.saturation);_FilterSetterBase2.prototype.buildFilter.call(this);};_createClass(ColorFilterSetter,[{key:"brightness",get:function get(){return this._brightness;},set:function set(value){this._brightness=value;this.paramChanged();}},{key:"contrast",get:function get(){return this._contrast;},set:function set(value){this._contrast=value;this.paramChanged();}},{key:"saturation",get:function get(){return this._saturation;},set:function set(value){this._saturation=value;this.paramChanged();}},{key:"hue",get:function get(){return this._hue;},set:function set(value){this._hue=value;this.paramChanged();}},{key:"red",get:function get(){return this._red;},set:function set(value){this._red=value;this.paramChanged();}},{key:"green",get:function get(){return this._green;},set:function set(value){this._green=value;this.paramChanged();}},{key:"blue",get:function get(){return this._blue;},set:function set(value){this._blue=value;this.paramChanged();}},{key:"color",get:function get(){return this._color;},set:function set(value){this._color=value;var colorO;colorO=ColorUtils.create(value);this._red=colorO.arrColor[0]*255;this._green=colorO.arrColor[1]*255;this._blue=colorO.arrColor[2]*255;this.paramChanged();}},{key:"alpha",get:function get(){return this._alpha;},set:function set(value){this._alpha=value;this.paramChanged();}}]);return ColorFilterSetter;}(FilterSetterBase);var EffectBase=/*#__PURE__*/function(_Component3){_inheritsLoose(EffectBase,_Component3);function EffectBase(){var _this52;_this52=_Component3.apply(this,arguments)||this;_this52.duration=1000;_this52.delay=0;_this52.repeat=0;_this52.autoDestroyAtComplete=true;return _this52;}var _proto148=EffectBase.prototype;_proto148._onAwake=function _onAwake(){this.target=this.target||this.owner;if(this.autoDestroyAtComplete)this._comlete=Handler.create(this.target,this.target.destroy,null,false);if(this.eventName)this.owner.on(this.eventName,this,this._exeTween);else this._exeTween();};_proto148._exeTween=function _exeTween(){this._tween=this._doTween();this._tween.repeat=this.repeat;};_proto148._doTween=function _doTween(){return null;};_proto148.onReset=function onReset(){this.duration=1000;this.delay=0;this.repeat=0;this.ease=null;this.target=null;if(this.eventName){this.owner.off(this.eventName,this,this._exeTween);this.eventName=null;}if(this._comlete){this._comlete.recover();this._comlete=null;}if(this._tween){this._tween.clear();this._tween=null;}};return EffectBase;}(Component);var FadeIn=/*#__PURE__*/function(_EffectBase){_inheritsLoose(FadeIn,_EffectBase);function FadeIn(){return _EffectBase.apply(this,arguments)||this;}var _proto149=FadeIn.prototype;_proto149._doTween=function _doTween(){this.target.alpha=0;return Tween.to(this.target,{alpha:1},this.duration,Ease[this.ease],this._comlete,this.delay);};return FadeIn;}(EffectBase);var FadeOut=/*#__PURE__*/function(_EffectBase2){_inheritsLoose(FadeOut,_EffectBase2);function FadeOut(){return _EffectBase2.apply(this,arguments)||this;}var _proto150=FadeOut.prototype;_proto150._doTween=function _doTween(){this.target.alpha=1;return Tween.to(this.target,{alpha:0},this.duration,Ease[this.ease],this._comlete,this.delay);};return FadeOut;}(EffectBase);var GlowFilterGLRender=/*#__PURE__*/function(){function GlowFilterGLRender(){}var _proto151=GlowFilterGLRender.prototype;_proto151.setShaderInfo=function setShaderInfo(shader,w,h,data){shader.defines.add(data.type);var sv=shader;sv.u_blurInfo1=data._sv_blurInfo1;var info2=data._sv_blurInfo2;info2[0]=w;info2[1]=h;sv.u_blurInfo2=info2;sv.u_color=data.getColor();};_proto151.render=function render(rt,ctx,width,height,filter){var w=width,h=height;var svBlur=Value2D.create(ShaderDefines2D.TEXTURE2D,0);this.setShaderInfo(svBlur,w,h,filter);var svCP=Value2D.create(ShaderDefines2D.TEXTURE2D,0);var matI=Matrix.TEMP.identity();ctx.drawTarget(rt,0,0,w,h,matI,svBlur);ctx.drawTarget(rt,0,0,w,h,matI,svCP);};return GlowFilterGLRender;}();var GlowFilter=/*#__PURE__*/function(_Filter3){_inheritsLoose(GlowFilter,_Filter3);function GlowFilter(color,blur,offX,offY){var _this53;if(blur===void 0){blur=4;}if(offX===void 0){offX=6;}if(offY===void 0){offY=6;}_this53=_Filter3.call(this)||this;_this53._elements=new Float32Array(9);_this53._sv_blurInfo1=new Array(4);_this53._sv_blurInfo2=[0,0,1,0];_this53._color=new ColorUtils(color);_this53.blur=Math.min(blur,20);_this53.offX=offX;_this53.offY=offY;_this53._sv_blurInfo1[0]=_this53._sv_blurInfo1[1]=_this53.blur;_this53._sv_blurInfo1[2]=offX;_this53._sv_blurInfo1[3]=-offY;_this53._glRender=new GlowFilterGLRender();return _this53;}var _proto152=GlowFilter.prototype;_proto152.getColor=function getColor(){return this._color.arrColor;};_proto152.getColorNative=function getColorNative(){if(!this._color_native){this._color_native=new Float32Array(4);}var color=this.getColor();this._color_native[0]=color[0];this._color_native[1]=color[1];this._color_native[2]=color[2];this._color_native[3]=color[3];return this._color_native;};_proto152.getBlurInfo1Native=function getBlurInfo1Native(){if(!this._blurInof1_native){this._blurInof1_native=new Float32Array(4);}this._blurInof1_native[0]=this._blurInof1_native[1]=this.blur;this._blurInof1_native[2]=this.offX;this._blurInof1_native[3]=this.offY;return this._blurInof1_native;};_proto152.getBlurInfo2Native=function getBlurInfo2Native(){if(!this._blurInof2_native){this._blurInof2_native=new Float32Array(4);}this._blurInof2_native[2]=1;return this._blurInof2_native;};_createClass(GlowFilter,[{key:"type",get:function get(){return BlurFilter.GLOW;}},{key:"offY",get:function get(){return this._elements[6];},set:function set(value){this._elements[6]=value;this._sv_blurInfo1[3]=-value;}},{key:"offX",get:function get(){return this._elements[5];},set:function set(value){this._elements[5]=value;this._sv_blurInfo1[2]=value;}},{key:"blur",get:function get(){return this._elements[4];},set:function set(value){this._elements[4]=value;this._sv_blurInfo1[0]=this._sv_blurInfo1[1]=value;}}]);return GlowFilter;}(Filter);var GlowFilterSetter=/*#__PURE__*/function(_FilterSetterBase3){_inheritsLoose(GlowFilterSetter,_FilterSetterBase3);function GlowFilterSetter(){var _this54;_this54=_FilterSetterBase3.call(this)||this;_this54._color="#ff0000";_this54._blur=4;_this54._offX=6;_this54._offY=6;_this54._filter=new GlowFilter(_this54._color);return _this54;}var _proto153=GlowFilterSetter.prototype;_proto153.buildFilter=function buildFilter(){this._filter=new GlowFilter(this.color,this.blur,this.offX,this.offY);_FilterSetterBase3.prototype.buildFilter.call(this);};_createClass(GlowFilterSetter,[{key:"color",get:function get(){return this._color;},set:function set(value){this._color=value;this.paramChanged();}},{key:"blur",get:function get(){return this._blur;},set:function set(value){this._blur=value;this.paramChanged();}},{key:"offX",get:function get(){return this._offX;},set:function set(value){this._offX=value;this.paramChanged();}},{key:"offY",get:function get(){return this._offY;},set:function set(value){this._offY=value;this.paramChanged();}}]);return GlowFilterSetter;}(FilterSetterBase);var KeyLocation=function KeyLocation(){};KeyLocation.STANDARD=0;KeyLocation.LEFT=1;KeyLocation.RIGHT=2;KeyLocation.NUM_PAD=3;var Keyboard=function Keyboard(){};Keyboard.NUMBER_0=48;Keyboard.NUMBER_1=49;Keyboard.NUMBER_2=50;Keyboard.NUMBER_3=51;Keyboard.NUMBER_4=52;Keyboard.NUMBER_5=53;Keyboard.NUMBER_6=54;Keyboard.NUMBER_7=55;Keyboard.NUMBER_8=56;Keyboard.NUMBER_9=57;Keyboard.A=65;Keyboard.B=66;Keyboard.C=67;Keyboard.D=68;Keyboard.E=69;Keyboard.F=70;Keyboard.G=71;Keyboard.H=72;Keyboard.I=73;Keyboard.J=74;Keyboard.K=75;Keyboard.L=76;Keyboard.M=77;Keyboard.N=78;Keyboard.O=79;Keyboard.P=80;Keyboard.Q=81;Keyboard.R=82;Keyboard.S=83;Keyboard.T=84;Keyboard.U=85;Keyboard.V=86;Keyboard.W=87;Keyboard.X=88;Keyboard.Y=89;Keyboard.Z=90;Keyboard.F1=112;Keyboard.F2=113;Keyboard.F3=114;Keyboard.F4=115;Keyboard.F5=116;Keyboard.F6=117;Keyboard.F7=118;Keyboard.F8=119;Keyboard.F9=120;Keyboard.F10=121;Keyboard.F11=122;Keyboard.F12=123;Keyboard.F13=124;Keyboard.F14=125;Keyboard.F15=126;Keyboard.NUMPAD=21;Keyboard.NUMPAD_0=96;Keyboard.NUMPAD_1=97;Keyboard.NUMPAD_2=98;Keyboard.NUMPAD_3=99;Keyboard.NUMPAD_4=100;Keyboard.NUMPAD_5=101;Keyboard.NUMPAD_6=102;Keyboard.NUMPAD_7=103;Keyboard.NUMPAD_8=104;Keyboard.NUMPAD_9=105;Keyboard.NUMPAD_ADD=107;Keyboard.NUMPAD_DECIMAL=110;Keyboard.NUMPAD_DIVIDE=111;Keyboard.NUMPAD_ENTER=108;Keyboard.NUMPAD_MULTIPLY=106;Keyboard.NUMPAD_SUBTRACT=109;Keyboard.SEMICOLON=186;Keyboard.EQUAL=187;Keyboard.COMMA=188;Keyboard.MINUS=189;Keyboard.PERIOD=190;Keyboard.SLASH=191;Keyboard.BACKQUOTE=192;Keyboard.LEFTBRACKET=219;Keyboard.BACKSLASH=220;Keyboard.RIGHTBRACKET=221;Keyboard.QUOTE=222;Keyboard.ALTERNATE=18;Keyboard.BACKSPACE=8;Keyboard.CAPS_LOCK=20;Keyboard.COMMAND=15;Keyboard.CONTROL=17;Keyboard.DELETE=46;Keyboard.ENTER=13;Keyboard.ESCAPE=27;Keyboard.PAGE_UP=33;Keyboard.PAGE_DOWN=34;Keyboard.END=35;Keyboard.HOME=36;Keyboard.LEFT=37;Keyboard.UP=38;Keyboard.RIGHT=39;Keyboard.DOWN=40;Keyboard.SHIFT=16;Keyboard.SPACE=32;Keyboard.TAB=9;Keyboard.INSERT=45;var CommandEncoder=/*#__PURE__*/function(){function CommandEncoder(layagl,reserveSize,adjustSize,isSyncToRenderThread){this._idata=[];}var _proto154=CommandEncoder.prototype;_proto154.getArrayData=function getArrayData(){return this._idata;};_proto154.getPtrID=function getPtrID(){return 0;};_proto154.beginEncoding=function beginEncoding(){};_proto154.endEncoding=function endEncoding(){};_proto154.clearEncoding=function clearEncoding(){this._idata.length=0;};_proto154.getCount=function getCount(){return this._idata.length;};_proto154.add_ShaderValue=function add_ShaderValue(o){this._idata.push(o);};_proto154.addShaderUniform=function addShaderUniform(one){this.add_ShaderValue(one);};return CommandEncoder;}();var LayaGLRunner=/*#__PURE__*/function(){function LayaGLRunner(){}LayaGLRunner.uploadShaderUniforms=function uploadShaderUniforms(layaGL,commandEncoder,shaderData,uploadUnTexture){var data=shaderData._data;var shaderUniform=commandEncoder.getArrayData();var shaderCall=0;for(var i=0,n=shaderUniform.length;i<n;i++){var one=shaderUniform[i];if(uploadUnTexture||one.textureID!==-1){var value=data[one.dataOffset];if(value!=null)shaderCall+=one.fun.call(one.caller,one,value);}}return shaderCall;};LayaGLRunner.uploadCustomUniform=function uploadCustomUniform(layaGL,custom,index,data){var shaderCall=0;var one=custom[index];if(one&&data!=null)shaderCall+=one.fun.call(one.caller,one,data);return shaderCall;};LayaGLRunner.uploadShaderUniformsForNative=function uploadShaderUniformsForNative(layaGL,commandEncoder,shaderData){var nType=LayaGL.UPLOAD_SHADER_UNIFORM_TYPE_ID;if(shaderData._runtimeCopyValues.length>0){nType=LayaGL.UPLOAD_SHADER_UNIFORM_TYPE_DATA;}var data=shaderData._data;return LayaGL.instance.uploadShaderUniforms(commandEncoder,data,nType);};return LayaGLRunner;}();var QuickTestTool=/*#__PURE__*/function(){function QuickTestTool(){}QuickTestTool.getMCDName=function getMCDName(type){return QuickTestTool._typeToNameDic[type];};QuickTestTool.showRenderTypeInfo=function showRenderTypeInfo(type,force){if(force===void 0){force=false;}if(!force&&QuickTestTool.showedDic[type])return;QuickTestTool.showedDic[type]=true;if(!QuickTestTool._rendertypeToStrDic[type]){var arr=[];var tType;tType=1;while(tType<=type){if(tType&type){arr.push(QuickTestTool.getMCDName(tType&type));}tType=tType<<1;}QuickTestTool._rendertypeToStrDic[type]=arr.join(",");}console.log("cmd:",QuickTestTool._rendertypeToStrDic[type]);};QuickTestTool.__init__=function __init__(){QuickTestTool._typeToNameDic[SpriteConst.ALPHA]="ALPHA";QuickTestTool._typeToNameDic[SpriteConst.TRANSFORM]="TRANSFORM";QuickTestTool._typeToNameDic[SpriteConst.TEXTURE]="TEXTURE";QuickTestTool._typeToNameDic[SpriteConst.GRAPHICS]="GRAPHICS";QuickTestTool._typeToNameDic[SpriteConst.ONECHILD]="ONECHILD";QuickTestTool._typeToNameDic[SpriteConst.CHILDS]="CHILDS";QuickTestTool._typeToNameDic[SpriteConst.TRANSFORM|SpriteConst.ALPHA]="TRANSFORM|ALPHA";QuickTestTool._typeToNameDic[SpriteConst.CANVAS]="CANVAS";QuickTestTool._typeToNameDic[SpriteConst.BLEND]="BLEND";QuickTestTool._typeToNameDic[SpriteConst.FILTERS]="FILTERS";QuickTestTool._typeToNameDic[SpriteConst.MASK]="MASK";QuickTestTool._typeToNameDic[SpriteConst.CLIP]="CLIP";QuickTestTool._typeToNameDic[SpriteConst.LAYAGL3D]="LAYAGL3D";};var _proto155=QuickTestTool.prototype;_proto155.render=function render(context,x,y){QuickTestTool._addType(this._renderType);QuickTestTool.showRenderTypeInfo(this._renderType);RenderSprite.renders[this._renderType]._fun(this,context,x+this._x,y+this._y);this._repaint=0;};_proto155._stageRender=function _stageRender(context,x,y){QuickTestTool._countStart();QuickTestTool._PreStageRender.call(ILaya.stage,context,x,y);QuickTestTool._countEnd();};QuickTestTool._countStart=function _countStart(){var key;for(key in QuickTestTool._countDic){QuickTestTool._countDic[key]=0;}};QuickTestTool._countEnd=function _countEnd(){QuickTestTool._i++;if(QuickTestTool._i>60){QuickTestTool.showCountInfo();QuickTestTool._i=0;}};QuickTestTool._addType=function _addType(type){if(!QuickTestTool._countDic[type]){QuickTestTool._countDic[type]=1;}else {QuickTestTool._countDic[type]+=1;}};QuickTestTool.showCountInfo=function showCountInfo(){console.log("===================");var key;for(key in QuickTestTool._countDic){console.log("count:"+QuickTestTool._countDic[key]);QuickTestTool.showRenderTypeInfo(key,true);}};QuickTestTool.enableQuickTest=function enableQuickTest(){QuickTestTool.__init__();Sprite["prototype"]["render"]=QuickTestTool["prototype"]["render"];QuickTestTool._PreStageRender=Stage["prototype"]["render"];Stage["prototype"]["render"]=QuickTestTool["prototype"]["_stageRender"];};return QuickTestTool;}();QuickTestTool.showedDic={};QuickTestTool._rendertypeToStrDic={};QuickTestTool._typeToNameDic={};QuickTestTool._countDic={};QuickTestTool._i=0;var Sound=/*#__PURE__*/function(_EventDispatcher13){_inheritsLoose(Sound,_EventDispatcher13);function Sound(){return _EventDispatcher13.apply(this,arguments)||this;}var _proto156=Sound.prototype;_proto156.load=function load(url){};_proto156.play=function play(startTime,loops){return null;};_proto156.dispose=function dispose(){};_createClass(Sound,[{key:"duration",get:function get(){return 0;}}]);return Sound;}(EventDispatcher);var SoundNode=/*#__PURE__*/function(_Sprite5){_inheritsLoose(SoundNode,_Sprite5);function SoundNode(){var _this55;_this55=_Sprite5.call(this)||this;_this55.visible=false;_this55.on(Event.ADDED,_assertThisInitialized(_this55),_this55._onParentChange);_this55.on(Event.REMOVED,_assertThisInitialized(_this55),_this55._onParentChange);return _this55;}var _proto157=SoundNode.prototype;_proto157._onParentChange=function _onParentChange(){this.target=this.parent;};_proto157.play=function play(loops,complete){if(loops===void 0){loops=1;}if(complete===void 0){complete=null;}if(isNaN(loops)){loops=1;}if(!this.url)return;this.stop();this._channel=SoundManager.playSound(this.url,loops,complete);};_proto157.stop=function stop(){if(this._channel&&!this._channel.isStopped){this._channel.stop();}this._channel=null;};_proto157._setPlayAction=function _setPlayAction(tar,event,action,add){if(add===void 0){add=true;}if(!this[action])return;if(!tar)return;if(add){tar.on(event,this,this[action]);}else {tar.off(event,this,this[action]);}};_proto157._setPlayActions=function _setPlayActions(tar,events,action,add){if(add===void 0){add=true;}if(!tar)return;if(!events)return;var eventArr=events.split(",");var i,len;len=eventArr.length;for(i=0;i<len;i++){this._setPlayAction(tar,eventArr[i],action,add);}};_createClass(SoundNode,[{key:"playEvent",set:function set(events){this._playEvents=events;if(!events)return;if(this._tar){this._setPlayActions(this._tar,events,"play");}}},{key:"target",set:function set(tar){if(this._tar){this._setPlayActions(this._tar,this._playEvents,"play",false);this._setPlayActions(this._tar,this._stopEvents,"stop",false);}this._tar=tar;if(this._tar){this._setPlayActions(this._tar,this._playEvents,"play",true);this._setPlayActions(this._tar,this._stopEvents,"stop",true);}}},{key:"stopEvent",set:function set(events){this._stopEvents=events;if(!events)return;if(this._tar){this._setPlayActions(this._tar,events,"stop");}}}]);return SoundNode;}(Sprite);ClassUtils.regClass("laya.media.SoundNode",SoundNode);ClassUtils.regClass("Laya.SoundNode",SoundNode);var ResourceVersion=/*#__PURE__*/function(){function ResourceVersion(){}ResourceVersion.enable=function enable(manifestFile,callback,type){if(type===void 0){type=2;}ResourceVersion.type=type;ILaya.loader.load(manifestFile,Handler.create(null,ResourceVersion.onManifestLoaded,[callback]),null,Loader.JSON);};ResourceVersion.onManifestLoaded=function onManifestLoaded(callback,data){ResourceVersion.manifest=data;URL.customFormat=ResourceVersion.addVersionPrefix;callback.run();if(!data){console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。");}};ResourceVersion.addVersionPrefix=function addVersionPrefix(originURL){originURL=URL.getAdptedFilePath(originURL);if(ResourceVersion.manifest&&ResourceVersion.manifest[originURL]){if(ResourceVersion.type==ResourceVersion.FILENAME_VERSION)return ResourceVersion.manifest[originURL];return ResourceVersion.manifest[originURL]+"/"+originURL;}return originURL;};return ResourceVersion;}();ResourceVersion.FOLDER_VERSION=1;ResourceVersion.FILENAME_VERSION=2;ResourceVersion.type=ResourceVersion.FOLDER_VERSION;var Socket=/*#__PURE__*/function(_EventDispatcher14){_inheritsLoose(Socket,_EventDispatcher14);function Socket(host,port,byteClass,protocols){var _this56;if(host===void 0){host=null;}if(port===void 0){port=0;}if(byteClass===void 0){byteClass=null;}if(protocols===void 0){protocols=null;}_this56=_EventDispatcher14.call(this)||this;_this56.disableInput=false;_this56.protocols=[];_this56._byteClass=byteClass?byteClass:Byte;_this56.protocols=protocols;_this56.endian=Socket.BIG_ENDIAN;if(host&&port>0&&port<65535)_this56.connect(host,port);return _this56;}var _proto158=Socket.prototype;_proto158.connect=function connect(host,port){var url="ws://"+host+":"+port;this.connectByUrl(url);};_proto158.connectByUrl=function connectByUrl(url){var _this57=this;if(this._socket!=null)this.close();this._socket&&this.cleanSocket();if(!this.protocols||this.protocols.length==0){this._socket=new Browser.window.WebSocket(url);}else {this._socket=new Browser.window.WebSocket(url,this.protocols);}this._socket.binaryType="arraybuffer";this._output=new this._byteClass();this._output.endian=this.endian;this._input=new this._byteClass();this._input.endian=this.endian;this._addInputPosition=0;this._socket.onopen=function(e){_this57._onOpen(e);};this._socket.onmessage=function(msg){_this57._onMessage(msg);};this._socket.onclose=function(e){_this57._onClose(e);};this._socket.onerror=function(e){_this57._onError(e);};};_proto158.cleanSocket=function cleanSocket(){this.close();this._connected=false;this._socket.onopen=null;this._socket.onmessage=null;this._socket.onclose=null;this._socket.onerror=null;this._socket=null;};_proto158.close=function close(){if(this._socket!=null){try{this._socket.close();}catch(e){}}};_proto158._onOpen=function _onOpen(e){this._connected=true;this.event(Event.OPEN,e);};_proto158._onMessage=function _onMessage(msg){if(!msg||!msg.data)return;var data=msg.data;if(this.disableInput&&data){this.event(Event.MESSAGE,data);return;}if(this._input.length>0&&this._input.bytesAvailable<1){this._input.clear();this._addInputPosition=0;}var pre=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0);this._input.pos=this._addInputPosition;if(data){if(typeof data=='string'){this._input.writeUTFBytes(data);}else {this._input.writeArrayBuffer(data);}this._addInputPosition=this._input.pos;this._input.pos=pre;}this.event(Event.MESSAGE,data);};_proto158._onClose=function _onClose(e){this._connected=false;this.event(Event.CLOSE,e);};_proto158._onError=function _onError(e){this.event(Event.ERROR,e);};_proto158.send=function send(data){this._socket.send(data);};_proto158.flush=function flush(){if(this._output&&this._output.length>0){var evt;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length));}catch(e){evt=e;}this._output.endian=this.endian;this._output.clear();if(evt)this.event(Event.ERROR,evt);}};_createClass(Socket,[{key:"input",get:function get(){return this._input;}},{key:"output",get:function get(){return this._output;}},{key:"connected",get:function get(){return this._connected;}},{key:"endian",get:function get(){return this._endian;},set:function set(value){this._endian=value;if(this._input!=null)this._input.endian=value;if(this._output!=null)this._output.endian=value;}}]);return Socket;}(EventDispatcher);Socket.LITTLE_ENDIAN="littleEndian";Socket.BIG_ENDIAN="bigEndian";(function(TextureDecodeFormat){TextureDecodeFormat[TextureDecodeFormat["Normal"]=0]="Normal";TextureDecodeFormat[TextureDecodeFormat["RGBM"]=1]="RGBM";})(exports.TextureDecodeFormat||(exports.TextureDecodeFormat={}));var VideoTexture=/*#__PURE__*/function(_BaseTexture3){_inheritsLoose(VideoTexture,_BaseTexture3);function VideoTexture(){var _this58;var gl=LayaGL.instance;_this58=_BaseTexture3.call(this,gl.RGB,false)||this;_this58._glTextureType=gl.TEXTURE_2D;_this58._width=1;_this58._height=1;_this58._wrapModeU=_this58._wrapModeV=exports.WarpMode.Clamp;_this58._filterMode=exports.FilterMode.Bilinear;_this58._setWarpMode(gl.TEXTURE_WRAP_S,_this58._wrapModeU);_this58._setWarpMode(gl.TEXTURE_WRAP_T,_this58._wrapModeV);_this58._setFilterMode(_this58._filterMode);_this58._needUpdate=false;_this58._readyed=true;VideoTexture._videoTexturePool.push(_assertThisInitialized(_this58));return _this58;}VideoTexture._update=function _update(){var pool=VideoTexture._videoTexturePool;for(var i=0,n=pool.length;i<n;i++){var videoElement=pool[i];videoElement&&videoElement._updateVideoData();}};var _proto159=VideoTexture.prototype;_proto159._updateVideoData=function _updateVideoData(){if(!this._video||!this._needUpdate)return;var gl=LayaGL.instance;WebGLContext.bindTexture(gl,this._glTextureType,this._glTexture);gl.texImage2D(this._glTextureType,0,gl.RGB,gl.RGB,gl.UNSIGNED_BYTE,this._video);};_proto159.videoPlay=function videoPlay(){this._video.play();this._needUpdate=true;};_proto159.videoPause=function videoPause(){this._video.pause();this._needUpdate=false;};_proto159.destroy=function destroy(){_BaseTexture3.prototype.destroy.call(this);this._video=null;};_createClass(VideoTexture,[{key:"video",get:function get(){return this._video;},set:function set(value){if(!value||!(value instanceof HTMLVideoElement))return;this._video=value;if(Laya.Browser.onMobile){this._video["x5-playsInline"]=true;this._video["x5-playsinline"]=true;this._video.x5PlaysInline=true;this._video.playsInline=true;this._video["webkit-playsInline"]=true;this._video["webkit-playsinline"]=true;this._video.webkitPlaysInline=true;this._video.playsinline=true;this._video.style.playsInline=true;this._video.crossOrigin="anonymous";this._video.setAttribute('crossorigin',"anonymous");this._video.setAttribute('playsinline','true');this._video.setAttribute('x5-playsinline','true');this._video.setAttribute('webkit-playsinline','true');this._video.autoplay=true;}}}]);return VideoTexture;}(BaseTexture);VideoTexture._videoTexturePool=new Array();var System=/*#__PURE__*/function(){function System(){}System.changeDefinition=function changeDefinition(name,classObj){window.Laya[name]=classObj;var str=name+"=classObj";window['eval'](str);};return System;}();var HTMLChar=/*#__PURE__*/function(){function HTMLChar(){this.reset();}var _proto160=HTMLChar.prototype;_proto160.setData=function setData(_char7,w,h,style){this["char"]=_char7;this.charNum=_char7.charCodeAt(0);this.x=this.y=0;this.width=w;this.height=h;this.style=style;this.isWord=!HTMLChar._isWordRegExp.test(_char7);return this;};_proto160.reset=function reset(){this.x=this.y=this.width=this.height=0;this.isWord=false;this["char"]=null;this.charNum=0;this.style=null;return this;};_proto160.recover=function recover(){Pool.recover("HTMLChar",this.reset());};HTMLChar.create=function create(){return Pool.getItemByClass("HTMLChar",HTMLChar);};_proto160._isChar=function _isChar(){return true;};_proto160._getCSSStyle=function _getCSSStyle(){return this.style;};return HTMLChar;}();HTMLChar._isWordRegExp=new RegExp("[\\w\.]","");var Log=/*#__PURE__*/function(){function Log(){}Log.enable=function enable(){if(!Log._logdiv){Log._logdiv=Browser.createElement('div');Log._logdiv.style.cssText="border:white;padding:4px;overflow-y:auto;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;";Browser.document.body.appendChild(Log._logdiv);Log._btn=Browser.createElement("button");Log._btn.innerText="Hide";Log._btn.style.cssText="z-index:1000001;position: absolute;left:10px;top:10px;";Log._btn.onclick=Log.toggle;Browser.document.body.appendChild(Log._btn);}};Log.toggle=function toggle(){var style=Log._logdiv.style;if(style.display===""){Log._btn.innerText="Show";style.display="none";}else {Log._btn.innerText="Hide";style.display="";}};Log.print=function print(value){if(Log._logdiv){if(Log._count>=Log.maxCount)Log.clear();Log._count++;Log._logdiv.innerText+=value+"\n";if(Log.autoScrollToBottom){if(Log._logdiv.scrollHeight-Log._logdiv.scrollTop-Log._logdiv.clientHeight<50){Log._logdiv.scrollTop=Log._logdiv.scrollHeight;}}}};Log.clear=function clear(){Log._logdiv.innerText="";Log._count=0;};return Log;}();Log._count=0;Log.maxCount=50;Log.autoScrollToBottom=true;var DATANUM=300;var PerfData=/*#__PURE__*/function(){function PerfData(id,color,name,scale){this.scale=1.0;this.datas=new Array(DATANUM);this.datapos=0;this.id=id;this.color=color;this.name=name;this.scale=scale;}var _proto161=PerfData.prototype;_proto161.addData=function addData(v){this.datas[this.datapos]=v;this.datapos++;this.datapos%=DATANUM;};return PerfData;}();var PerfHUD=/*#__PURE__*/function(_Sprite6){_inheritsLoose(PerfHUD,_Sprite6);function PerfHUD(){var _this59;_this59=_Sprite6.call(this)||this;_this59.datas=[];_this59.xdata=new Array(PerfHUD.DATANUM);_this59.ydata=new Array(PerfHUD.DATANUM);_this59.hud_width=800;_this59.hud_height=200;_this59.gMinV=0;_this59.gMaxV=100;_this59.textSpace=40;_this59.sttm=0;PerfHUD.inst=_assertThisInitialized(_this59);_this59._renderType|=SpriteConst.CUSTOM;_this59._setRenderType(_this59._renderType);_this59._setCustomRender();_this59.addDataDef(0,0xffffff,'frame',1.0);_this59.addDataDef(1,0x00ff00,'update',1.0);_this59.addDataDef(2,0xff0000,'flush',1.0);PerfHUD._now=performance?performance.now.bind(performance):Date.now;return _this59;}var _proto162=PerfHUD.prototype;_proto162.now=function now(){return PerfHUD._now();};_proto162.start=function start(){this.sttm=PerfHUD._now();};_proto162.end=function end(i){var dt=PerfHUD._now()-this.sttm;this.updateValue(i,dt);};_proto162.config=function config(w,h){this.hud_width=w;this.hud_height=h;};_proto162.addDataDef=function addDataDef(id,color,name,scale){this.datas[id]=new PerfData(id,color,name,scale);};_proto162.updateValue=function updateValue(id,v){this.datas[id].addData(v);};_proto162.v2y=function v2y(v){var bb=this._y+this.hud_height*(1-(v-this.gMinV)/this.gMaxV);return this._y+this.hud_height*(1-(v-this.gMinV)/this.gMaxV);};_proto162.drawHLine=function drawHLine(ctx,v,color,text){var sx=this._x;var ex=this._x+this.hud_width;var sy=this.v2y(v);ctx.fillText(text,sx,sy-6,null,'green',null);sx+=this.textSpace;ctx.fillStyle=color;ctx.fillRect(sx,sy,this._x+this.hud_width,1,null);};_proto162.customRender=function customRender(ctx,x,y){var now=performance.now();if(PerfHUD._lastTm<=0)PerfHUD._lastTm=now;this.updateValue(0,now-PerfHUD._lastTm);PerfHUD._lastTm=now;ctx.save();ctx.fillRect(this._x,this._y,this.hud_width,this.hud_height+4,'#000000cc');ctx.globalAlpha=0.9;this.drawHLine(ctx,0,'green','    0');this.drawHLine(ctx,10,'green','  10');this.drawHLine(ctx,16.667,'red',' ');this.drawHLine(ctx,20,'green','50|20');this.drawHLine(ctx,16.667*2,'yellow','');this.drawHLine(ctx,16.667*3,'yellow','');this.drawHLine(ctx,16.667*4,'yellow','');this.drawHLine(ctx,50,'green','20|50');this.drawHLine(ctx,100,'green','10|100');for(var di=0,sz=this.datas.length;di<sz;di++){var cd=this.datas[di];if(!cd)continue;var dtlen=cd.datas.length;var dx=(this.hud_width-this.textSpace)/dtlen;var cx=cd.datapos;var _cx=this._x+this.textSpace;ctx.fillStyle=cd.color;for(var dtsz=dtlen;cx<dtsz;cx++){var sty=this.v2y(cd.datas[cx]*cd.scale);ctx.fillRect(_cx,sty,dx,this.hud_height+this._y-sty,null);_cx+=dx;}for(cx=0;cx<cd.datapos;cx++){sty=this.v2y(cd.datas[cx]*cd.scale);ctx.fillRect(_cx,sty,dx,this.hud_height+this._y-sty,null);_cx+=dx;}}ctx.restore();};return PerfHUD;}(Sprite);PerfHUD._lastTm=0;PerfHUD._now=null;PerfHUD.DATANUM=300;PerfHUD.drawTexTm=0;var PoolCache=/*#__PURE__*/function(){function PoolCache(){this.maxCount=1000;}var _proto163=PoolCache.prototype;_proto163.getCacheList=function getCacheList(){return Pool.getPoolBySign(this.sign);};_proto163.tryDispose=function tryDispose(force){var list;list=Pool.getPoolBySign(this.sign);if(list.length>this.maxCount){list.splice(this.maxCount,list.length-this.maxCount);}};PoolCache.addPoolCacheManager=function addPoolCacheManager(sign,maxCount){if(maxCount===void 0){maxCount=100;}var cache;cache=new PoolCache();cache.sign=sign;cache.maxCount=maxCount;CacheManger.regCacheByFunction(Utils.bind(cache.tryDispose,cache),Utils.bind(cache.getCacheList,cache));};return PoolCache;}();var TimeLine=/*#__PURE__*/function(_EventDispatcher15){_inheritsLoose(TimeLine,_EventDispatcher15);function TimeLine(){var _this60;_this60=_EventDispatcher15.apply(this,arguments)||this;_this60._tweenDic={};_this60._tweenDataList=[];_this60._currTime=0;_this60._lastTime=0;_this60._startTime=0;_this60._index=0;_this60._gidIndex=0;_this60._firstTweenDic={};_this60._startTimeSort=false;_this60._endTimeSort=false;_this60._loopKey=false;_this60.scale=1;_this60._frameRate=60;_this60._frameIndex=0;_this60._total=0;return _this60;}TimeLine.to=function to(target,props,duration,ease,offset){if(ease===void 0){ease=null;}if(offset===void 0){offset=0;}return new TimeLine().to(target,props,duration,ease,offset);};TimeLine.from=function from(target,props,duration,ease,offset){if(ease===void 0){ease=null;}if(offset===void 0){offset=0;}return new TimeLine().from(target,props,duration,ease,offset);};var _proto164=TimeLine.prototype;_proto164.to=function to(target,props,duration,ease,offset){if(ease===void 0){ease=null;}if(offset===void 0){offset=0;}return this._create(target,props,duration,ease,offset,true);};_proto164.from=function from(target,props,duration,ease,offset){if(ease===void 0){ease=null;}if(offset===void 0){offset=0;}return this._create(target,props,duration,ease,offset,false);};_proto164._create=function _create(target,props,duration,ease,offset,isTo){var tTweenData=Pool.getItemByClass("tweenData",tweenData);tTweenData.isTo=isTo;tTweenData.type=0;tTweenData.target=target;tTweenData.duration=duration;tTweenData.data=props;tTweenData.startTime=this._startTime+offset;tTweenData.endTime=tTweenData.startTime+tTweenData.duration;tTweenData.ease=ease;this._startTime=Math.max(tTweenData.endTime,this._startTime);this._tweenDataList.push(tTweenData);this._startTimeSort=true;this._endTimeSort=true;return this;};_proto164.addLabel=function addLabel(label,offset){var tTweenData=Pool.getItemByClass("tweenData",tweenData);tTweenData.type=1;tTweenData.data=label;tTweenData.endTime=tTweenData.startTime=this._startTime+offset;this._labelDic||(this._labelDic={});this._labelDic[label]=tTweenData;this._tweenDataList.push(tTweenData);return this;};_proto164.removeLabel=function removeLabel(label){if(this._labelDic&&this._labelDic[label]){var tTweenData=this._labelDic[label];if(tTweenData){var tIndex=this._tweenDataList.indexOf(tTweenData);if(tIndex>-1){this._tweenDataList.splice(tIndex,1);}}delete this._labelDic[label];}};_proto164.gotoTime=function gotoTime(time){if(this._tweenDataList==null||this._tweenDataList.length==0)return;var tTween;var tObject;for(var p in this._firstTweenDic){tObject=this._firstTweenDic[p];if(tObject){for(var tDataP in tObject){if(tDataP in tObject.diyTarget){tObject.diyTarget[tDataP]=tObject[tDataP];}}}}for(p in this._tweenDic){tTween=this._tweenDic[p];tTween.clear();delete this._tweenDic[p];}this._index=0;this._gidIndex=0;this._currTime=time;this._lastTime=Browser.now();var tTweenDataCopyList;if(this._endTweenDataList==null||this._endTimeSort){var Compare=function Compare(paraA,paraB){if(paraA.endTime>paraB.endTime){return 1;}else if(paraA.endTime<paraB.endTime){return -1;}else {return 0;}};this._endTimeSort=false;this._endTweenDataList=tTweenDataCopyList=this._tweenDataList.concat();tTweenDataCopyList.sort(Compare);}else {tTweenDataCopyList=this._endTweenDataList;}var tTweenData;for(var i=0,n=tTweenDataCopyList.length;i<n;i++){tTweenData=tTweenDataCopyList[i];if(tTweenData.type==0){if(time>=tTweenData.endTime){this._index=Math.max(this._index,i+1);var props=tTweenData.data;if(tTweenData.isTo){for(var tP in props){tTweenData.target[tP]=props[tP];}}}else {break;}}}for(i=0,n=this._tweenDataList.length;i<n;i++){tTweenData=this._tweenDataList[i];if(tTweenData.type==0){if(time>=tTweenData.startTime&&time<tTweenData.endTime){this._index=Math.max(this._index,i+1);this._gidIndex++;tTween=Pool.getItemByClass("tween",Tween);tTween._create(tTweenData.target,tTweenData.data,tTweenData.duration,tTweenData.ease,Handler.create(this,this._animComplete,[this._gidIndex]),0,false,tTweenData.isTo,true,false);tTween.setStartTime(this._currTime-(time-tTweenData.startTime));tTween._updateEase(this._currTime);tTween.gid=this._gidIndex;this._tweenDic[this._gidIndex]=tTween;}}}};_proto164.gotoLabel=function gotoLabel(Label){if(this._labelDic==null)return;var tLabelData=this._labelDic[Label];if(tLabelData)this.gotoTime(tLabelData.startTime);};_proto164.pause=function pause(){ILaya.timer.clear(this,this._update);};_proto164.resume=function resume(){this.play(this._currTime,this._loopKey);};_proto164.play=function play(timeOrLabel,loop){if(timeOrLabel===void 0){timeOrLabel=0;}if(loop===void 0){loop=false;}if(!this._tweenDataList)return;if(this._startTimeSort){var Compare=function Compare(paraA,paraB){if(paraA.startTime>paraB.startTime){return 1;}else if(paraA.startTime<paraB.startTime){return -1;}else {return 0;}};this._startTimeSort=false;this._tweenDataList.sort(Compare);for(var i=0,n=this._tweenDataList.length;i<n;i++){var tTweenData=this._tweenDataList[i];if(tTweenData!=null&&tTweenData.type==0){var tTarget=tTweenData.target;var gid=tTarget.$_GID||(tTarget.$_GID=Utils.getGID());var tSrcData=null;if(this._firstTweenDic[gid]==null){tSrcData={};tSrcData.diyTarget=tTarget;this._firstTweenDic[gid]=tSrcData;}else {tSrcData=this._firstTweenDic[gid];}for(var p in tTweenData.data){if(tSrcData[p]==null){tSrcData[p]=tTarget[p];}}}}}if(typeof timeOrLabel=='string'){this.gotoLabel(timeOrLabel);}else {this.gotoTime(timeOrLabel);}this._loopKey=loop;this._lastTime=Browser.now();ILaya.timer.frameLoop(1,this,this._update);};_proto164._update=function _update(){if(this._currTime>=this._startTime){if(this._loopKey){this._complete();if(!this._tweenDataList)return;this.gotoTime(0);}else {for(var p in this._tweenDic){tTween=this._tweenDic[p];tTween.complete();}this.pause();this._complete();return;}}var tNow=Browser.now();var tFrameTime=tNow-this._lastTime;var tCurrTime=this._currTime+=tFrameTime*this.scale;this._lastTime=tNow;for(p in this._tweenDic){tTween=this._tweenDic[p];tTween._updateEase(tCurrTime);}var tTween;if(this._tweenDataList.length!=0&&this._index<this._tweenDataList.length){var tTweenData=this._tweenDataList[this._index];if(tCurrTime>=tTweenData.startTime){this._index++;if(tTweenData.type==0){this._gidIndex++;tTween=Pool.getItemByClass("tween",Tween);tTween._create(tTweenData.target,tTweenData.data,tTweenData.duration,tTweenData.ease,Handler.create(this,this._animComplete,[this._gidIndex]),0,false,tTweenData.isTo,true,false);tTween.setStartTime(tCurrTime);tTween.gid=this._gidIndex;this._tweenDic[this._gidIndex]=tTween;tTween._updateEase(tCurrTime);}else {this.event(Event.LABEL,tTweenData.data);}}}};_proto164._animComplete=function _animComplete(index){var tTween=this._tweenDic[index];if(tTween)delete this._tweenDic[index];};_proto164._complete=function _complete(){this.event(Event.COMPLETE);};_proto164.reset=function reset(){var p;if(this._labelDic){for(p in this._labelDic){delete this._labelDic[p];}}var tTween;for(p in this._tweenDic){tTween=this._tweenDic[p];tTween.clear();delete this._tweenDic[p];}for(p in this._firstTweenDic){delete this._firstTweenDic[p];}this._endTweenDataList=null;if(this._tweenDataList&&this._tweenDataList.length){var i,len;len=this._tweenDataList.length;for(i=0;i<len;i++){if(this._tweenDataList[i])this._tweenDataList[i].destroy();}}this._tweenDataList.length=0;this._currTime=0;this._lastTime=0;this._startTime=0;this._index=0;this._gidIndex=0;this.scale=1;ILaya.timer.clear(this,this._update);};_proto164.destroy=function destroy(){this.reset();this._labelDic=null;this._tweenDic=null;this._tweenDataList=null;this._firstTweenDic=null;};_createClass(TimeLine,[{key:"index",get:function get(){return this._frameIndex;},set:function set(value){this._frameIndex=value;this.gotoTime(this._frameIndex/this._frameRate*1000);}},{key:"total",get:function get(){this._total=Math.floor(this._startTime/1000*this._frameRate);return this._total;}}]);return TimeLine;}(EventDispatcher);var tweenData=/*#__PURE__*/function(){function tweenData(){this.type=0;this.isTo=true;}var _proto165=tweenData.prototype;_proto165.destroy=function destroy(){this.target=null;this.ease=null;this.data=null;this.isTo=true;this.type=0;Pool.recover("tweenData",this);};return tweenData;}();var ShaderValue=function ShaderValue(){};var ArabicReshaper=/*#__PURE__*/function(){function ArabicReshaper(){}var _proto166=ArabicReshaper.prototype;_proto166.characterMapContains=function characterMapContains(c){for(var i=0;i<ArabicReshaper.charsMap.length;++i){if(ArabicReshaper.charsMap[i][0]===c){return true;}}return false;};_proto166.getCharRep=function getCharRep(c){for(var i=0;i<ArabicReshaper.charsMap.length;++i){if(ArabicReshaper.charsMap[i][0]===c){return ArabicReshaper.charsMap[i];}}return false;};_proto166.getCombCharRep=function getCombCharRep(c1,c2){for(var i=0;i<ArabicReshaper.combCharsMap.length;++i){if(ArabicReshaper.combCharsMap[i][0][0]===c1&&ArabicReshaper.combCharsMap[i][0][1]===c2){return ArabicReshaper.combCharsMap[i];}}return false;};_proto166.isTransparent=function isTransparent(c){for(var i=0;i<ArabicReshaper.transChars.length;++i){if(ArabicReshaper.transChars[i]===c){return true;}}return false;};_proto166.getOriginalCharsFromCode=function getOriginalCharsFromCode(code){var j;for(j=0;j<ArabicReshaper.charsMap.length;++j){if(ArabicReshaper.charsMap[j].indexOf(code)>-1){return String.fromCharCode(ArabicReshaper.charsMap[j][0]);}}for(j=0;j<ArabicReshaper.combCharsMap.length;++j){if(ArabicReshaper.combCharsMap[j].indexOf(code)>-1){return String.fromCharCode(ArabicReshaper.combCharsMap[j][0][0])+String.fromCharCode(ArabicReshaper.combCharsMap[j][0][1]);}}return String.fromCharCode(code);};_proto166.convertArabic=function convertArabic(normal){var crep,combcrep,shaped='';for(var i=0;i<normal.length;++i){var current=normal.charCodeAt(i);if(this.characterMapContains(current)){var prev=null,next=null,prevID=i-1,nextID=i+1;for(;prevID>=0;--prevID){if(!this.isTransparent(normal.charCodeAt(prevID))){break;}}prev=prevID>=0?normal.charCodeAt(prevID):null;crep=prev?this.getCharRep(prev):false;if(!crep||crep[2]==null&&crep[3]==null){prev=null;}for(;nextID<normal.length;++nextID){if(!this.isTransparent(normal.charCodeAt(nextID))){break;}}next=nextID<normal.length?normal.charCodeAt(nextID):null;crep=next?this.getCharRep(next):false;if(!crep||crep[3]==null&&crep[4]==null){next=null;}if(current===0x0644&&next!=null&&(next===0x0622||next===0x0623||next===0x0625||next===0x0627)){combcrep=this.getCombCharRep(current,next);if(prev!=null){shaped+=String.fromCharCode(combcrep[4]);}else {shaped+=String.fromCharCode(combcrep[1]);}++i;continue;}crep=this.getCharRep(current);if(prev!=null&&next!=null&&crep[3]!=null){shaped+=String.fromCharCode(crep[3]);continue;}else if(prev!=null&&crep[4]!=null){shaped+=String.fromCharCode(crep[4]);continue;}else if(next!=null&&crep[2]!=null){shaped+=String.fromCharCode(crep[2]);continue;}else {shaped+=String.fromCharCode(crep[1]);}}else {shaped+=String.fromCharCode(current);}}return shaped;};_proto166.convertArabicBack=function convertArabicBack(apfb){var toReturn='',selectedChar;var i;for(i=0;i<apfb.length;++i){selectedChar=apfb.charCodeAt(i);toReturn+=this.getOriginalCharsFromCode(selectedChar);}return toReturn;};return ArabicReshaper;}();ArabicReshaper.charsMap=[[0x0621,0xFE80,null,null,null],[0x0622,0xFE81,null,null,0xFE82],[0x0623,0xFE83,null,null,0xFE84],[0x0624,0xFE85,null,null,0xFE86],[0x0625,0xFE87,null,null,0xFE88],[0x0626,0xFE89,0xFE8B,0xFE8C,0xFE8A],[0x0627,0xFE8D,null,null,0xFE8E],[0x0628,0xFE8F,0xFE91,0xFE92,0xFE90],[0x0629,0xFE93,null,null,0xFE94],[0x062A,0xFE95,0xFE97,0xFE98,0xFE96],[0x062B,0xFE99,0xFE9B,0xFE9C,0xFE9A],[0x062C,0xFE9D,0xFE9F,0xFEA0,0xFE9E],[0x062D,0xFEA1,0xFEA3,0xFEA4,0xFEA2],[0x062E,0xFEA5,0xFEA7,0xFEA8,0xFEA6],[0x062F,0xFEA9,null,null,0xFEAA],[0x0630,0xFEAB,null,null,0xFEAC],[0x0631,0xFEAD,null,null,0xFEAE],[0x0632,0xFEAF,null,null,0xFEB0],[0x0633,0xFEB1,0xFEB3,0xFEB4,0xFEB2],[0x0634,0xFEB5,0xFEB7,0xFEB8,0xFEB6],[0x0635,0xFEB9,0xFEBB,0xFEBC,0xFEBA],[0x0636,0xFEBD,0xFEBF,0xFEC0,0xFEBE],[0x0637,0xFEC1,0xFEC3,0xFEC4,0xFEC2],[0x0638,0xFEC5,0xFEC7,0xFEC8,0xFEC6],[0x0639,0xFEC9,0xFECB,0xFECC,0xFECA],[0x063A,0xFECD,0xFECF,0xFED0,0xFECE],[0x0640,0x0640,0x0640,0x0640,0x0640],[0x0641,0xFED1,0xFED3,0xFED4,0xFED2],[0x0642,0xFED5,0xFED7,0xFED8,0xFED6],[0x0643,0xFED9,0xFEDB,0xFEDC,0xFEDA],[0x0644,0xFEDD,0xFEDF,0xFEE0,0xFEDE],[0x0645,0xFEE1,0xFEE3,0xFEE4,0xFEE2],[0x0646,0xFEE5,0xFEE7,0xFEE8,0xFEE6],[0x0647,0xFEE9,0xFEEB,0xFEEC,0xFEEA],[0x0648,0xFEED,null,null,0xFEEE],[0x0649,0xFEEF,null,null,0xFEF0],[0x064A,0xFEF1,0xFEF3,0xFEF4,0xFEF2],[0x067E,0xFB56,0xFB58,0xFB59,0xFB57],[0x06CC,0xFBFC,0xFBFE,0xFBFF,0xFBFD],[0x0686,0xFB7A,0xFB7C,0xFB7D,0xFB7B],[0x06A9,0xFB8E,0xFB90,0xFB91,0xFB8F],[0x06AF,0xFB92,0xFB94,0xFB95,0xFB93],[0x0698,0xFB8A,null,null,0xFB8B]];ArabicReshaper.combCharsMap=[[[0x0644,0x0622],0xFEF5,null,null,0xFEF6],[[0x0644,0x0623],0xFEF7,null,null,0xFEF8],[[0x0644,0x0625],0xFEF9,null,null,0xFEFA],[[0x0644,0x0627],0xFEFB,null,null,0xFEFC]];ArabicReshaper.transChars=[0x0610,0x0612,0x0613,0x0614,0x0615,0x064B,0x064C,0x064D,0x064E,0x064F,0x0650,0x0651,0x0652,0x0653,0x0654,0x0655,0x0656,0x0657,0x0658,0x0670,0x06D6,0x06D7,0x06D8,0x06D9,0x06DA,0x06DB,0x06DC,0x06DF,0x06E0,0x06E1,0x06E2,0x06E3,0x06E4,0x06E7,0x06E8,0x06EA,0x06EB,0x06EC,0x06ED];var MatirxArray=/*#__PURE__*/function(){function MatirxArray(){}MatirxArray.ArrayMul=function ArrayMul(a,b,o){if(!a){MatirxArray.copyArray(b,o);return;}if(!b){MatirxArray.copyArray(a,o);return;}var ai0,ai1,ai2,ai3;for(var i=0;i<4;i++){ai0=a[i];ai1=a[i+4];ai2=a[i+8];ai3=a[i+12];o[i]=ai0*b[0]+ai1*b[1]+ai2*b[2]+ai3*b[3];o[i+4]=ai0*b[4]+ai1*b[5]+ai2*b[6]+ai3*b[7];o[i+8]=ai0*b[8]+ai1*b[9]+ai2*b[10]+ai3*b[11];o[i+12]=ai0*b[12]+ai1*b[13]+ai2*b[14]+ai3*b[15];}};MatirxArray.copyArray=function copyArray(f,t){if(!f)return;if(!t)return;for(var i=0;i<f.length;i++){t[i]=f[i];}};return MatirxArray;}();exports.AlphaCmd=AlphaCmd;exports.Animation=Animation;exports.AnimationBase=AnimationBase;exports.ArabicReshaper=ArabicReshaper;exports.AtlasGrid=AtlasGrid;exports.AtlasInfoManager=AtlasInfoManager;exports.AudioSound=AudioSound;exports.AudioSoundChannel=AudioSoundChannel;exports.BasePoly=BasePoly;exports.BaseShader=BaseShader;exports.BaseTexture=BaseTexture;exports.Bezier=Bezier;exports.Bitmap=Bitmap;exports.BitmapFont=BitmapFont;exports.BlendMode=BlendMode;exports.BlurFilter=BlurFilter;exports.BlurFilterGLRender=BlurFilterGLRender;exports.BlurFilterSetter=BlurFilterSetter;exports.BoundsStyle=BoundsStyle;exports.Browser=Browser;exports.Buffer=Buffer;exports.Buffer2D=Buffer2D;exports.BufferState2D=BufferState2D;exports.BufferStateBase=BufferStateBase;exports.ButtonEffect=ButtonEffect;exports.Byte=Byte;exports.CONST3D2D=CONST3D2D;exports.CacheManger=CacheManger;exports.CacheStyle=CacheStyle;exports.CallLater=CallLater;exports.CharRenderInfo=CharRenderInfo;exports.CharRender_Canvas=CharRender_Canvas;exports.CharRender_Native=CharRender_Native;exports.CharSubmitCache=CharSubmitCache;exports.ClassUtils=ClassUtils;exports.ClipRectCmd=ClipRectCmd;exports.ColorFilter=ColorFilter;exports.ColorFilterSetter=ColorFilterSetter;exports.ColorUtils=ColorUtils;exports.CommandEncoder=CommandEncoder;exports.CommonScript=CommonScript;exports.Component=Component;exports.Config=Config;exports.Const=Const;exports.Context=Context;exports.Dragging=Dragging;exports.Draw9GridTexture=Draw9GridTexture;exports.DrawCircleCmd=DrawCircleCmd;exports.DrawCurvesCmd=DrawCurvesCmd;exports.DrawImageCmd=DrawImageCmd;exports.DrawLineCmd=DrawLineCmd;exports.DrawLinesCmd=DrawLinesCmd;exports.DrawParticleCmd=DrawParticleCmd;exports.DrawPathCmd=DrawPathCmd;exports.DrawPieCmd=DrawPieCmd;exports.DrawPolyCmd=DrawPolyCmd;exports.DrawRectCmd=DrawRectCmd;exports.DrawStyle=DrawStyle;exports.DrawTextureCmd=DrawTextureCmd;exports.DrawTexturesCmd=DrawTexturesCmd;exports.DrawTrianglesCmd=DrawTrianglesCmd;exports.Earcut=Earcut;exports.EarcutNode=EarcutNode;exports.Ease=Ease;exports.EffectAnimation=EffectAnimation;exports.EffectBase=EffectBase;exports.Event=Event;exports.EventDispatcher=EventDispatcher;exports.FadeIn=FadeIn;exports.FadeOut=FadeOut;exports.FillTextCmd=FillTextCmd;exports.FillTextureCmd=FillTextureCmd;exports.Filter=Filter;exports.FilterSetterBase=FilterSetterBase;exports.FontInfo=FontInfo;exports.FrameAnimation=FrameAnimation;exports.GlowFilter=GlowFilter;exports.GlowFilterGLRender=GlowFilterGLRender;exports.GlowFilterSetter=GlowFilterSetter;exports.GrahamScan=GrahamScan;exports.GraphicAnimation=GraphicAnimation;exports.Graphics=Graphics;exports.GraphicsBounds=GraphicsBounds;exports.HTMLCanvas=HTMLCanvas;exports.HTMLChar=HTMLChar;exports.HTMLImage=HTMLImage;exports.Handler=Handler;exports.HitArea=HitArea;exports.HttpRequest=HttpRequest;exports.ICharRender=ICharRender;exports.ILaya=ILaya;exports.IStatRender=IStatRender;exports.IndexBuffer2D=IndexBuffer2D;exports.InlcudeFile=InlcudeFile;exports.Input=Input;exports.KeyBoardManager=KeyBoardManager;exports.KeyLocation=KeyLocation;exports.Keyboard=Keyboard;exports.Laya=Laya;exports.LayaGL=LayaGL;exports.LayaGLQuickRunner=LayaGLQuickRunner;exports.LayaGLRunner=LayaGLRunner;exports.LayaGPU=LayaGPU;exports.Loader=Loader;exports.LoaderManager=LoaderManager;exports.LocalStorage=LocalStorage;exports.Log=Log;exports.MathUtil=MathUtil;exports.MatirxArray=MatirxArray;exports.Matrix=Matrix;exports.Mesh2D=Mesh2D;exports.MeshParticle2D=MeshParticle2D;exports.MeshQuadTexture=MeshQuadTexture;exports.MeshTexture=MeshTexture;exports.MeshVG=MeshVG;exports.Mouse=Mouse;exports.MouseManager=MouseManager;exports.Node=Node;exports.Path=Path;exports.PerfData=PerfData;exports.PerfHUD=PerfHUD;exports.Point=Point;exports.Pool=Pool;exports.PoolCache=PoolCache;exports.Prefab=Prefab;exports.PrimitiveSV=PrimitiveSV;exports.QuickTestTool=QuickTestTool;exports.Rectangle=Rectangle;exports.Render=Render;exports.RenderInfo=RenderInfo;exports.RenderSprite=RenderSprite;exports.RenderState2D=RenderState2D;exports.RenderTexture2D=RenderTexture2D;exports.Resource=Resource;exports.ResourceVersion=ResourceVersion;exports.RestoreCmd=RestoreCmd;exports.RotateCmd=RotateCmd;exports.RunDriver=RunDriver;exports.SaveBase=SaveBase;exports.SaveClipRect=SaveClipRect;exports.SaveCmd=SaveCmd;exports.SaveMark=SaveMark;exports.SaveTransform=SaveTransform;exports.SaveTranslate=SaveTranslate;exports.ScaleCmd=ScaleCmd;exports.Scene=Scene;exports.SceneLoader=SceneLoader;exports.SceneUtils=SceneUtils;exports.Script=Script;exports.Shader=Shader;exports.Shader2D=Shader2D;exports.Shader2X=Shader2X;exports.ShaderCompile=ShaderCompile;exports.ShaderDefines2D=ShaderDefines2D;exports.ShaderDefinesBase=ShaderDefinesBase;exports.ShaderNode=ShaderNode;exports.ShaderValue=ShaderValue;exports.SkinMeshBuffer=SkinMeshBuffer;exports.SkinSV=SkinSV;exports.Socket=Socket;exports.Sound=Sound;exports.SoundChannel=SoundChannel;exports.SoundManager=SoundManager;exports.SoundNode=SoundNode;exports.Sprite=Sprite;exports.SpriteConst=SpriteConst;exports.SpriteStyle=SpriteStyle;exports.Stage=Stage;exports.Stat=Stat;exports.StatUI=StatUI;exports.StringKey=StringKey;exports.Submit=Submit;exports.SubmitBase=SubmitBase;exports.SubmitCMD=SubmitCMD;exports.SubmitCanvas=SubmitCanvas;exports.SubmitKey=SubmitKey;exports.SubmitTarget=SubmitTarget;exports.SubmitTexture=SubmitTexture;exports.System=System;exports.SystemUtils=SystemUtils;exports.TTFLoader=TTFLoader;exports.Text=Text;exports.TextAtlas=TextAtlas;exports.TextRender=TextRender;exports.TextStyle=TextStyle;exports.TextTexture=TextTexture;exports.Texture=Texture;exports.Texture2D=Texture2D;exports.TextureSV=TextureSV;exports.TimeLine=TimeLine;exports.Timer=Timer;exports.TouchManager=TouchManager;exports.TransformCmd=TransformCmd;exports.TranslateCmd=TranslateCmd;exports.Tween=Tween;exports.URL=URL;exports.Utils=Utils;exports.Value2D=Value2D;exports.VectorGraphManager=VectorGraphManager;exports.VertexArrayObject=VertexArrayObject;exports.VertexBuffer2D=VertexBuffer2D;exports.VideoTexture=VideoTexture;exports.WeakObject=WeakObject;exports.WebAudioSound=WebAudioSound;exports.WebAudioSoundChannel=WebAudioSoundChannel;exports.WebGL=WebGL;exports.WebGLCacheAsNormalCanvas=WebGLCacheAsNormalCanvas;exports.WebGLContext=WebGLContext;exports.WebGLRTMgr=WebGLRTMgr;exports.WordText=WordText;exports.WorkerLoader=WorkerLoader;exports.__init=__init;exports._static=_static;exports.alertGlobalError=alertGlobalError;exports.enableDebugPanel=enableDebugPanel;exports.init=init;exports.isWXOpenDataContext=isWXOpenDataContext;exports.isWXPosMsg=isWXPosMsg;exports.version=version;exports["static"]=_static;return exports;}({});

  (function(exports,Laya){var MathUtils3D=/*#__PURE__*/function(){function MathUtils3D(){}MathUtils3D.isZero=function isZero(v){return Math.abs(v)<MathUtils3D.zeroTolerance;};MathUtils3D.nearEqual=function nearEqual(n1,n2){if(MathUtils3D.isZero(n1-n2))return true;return false;};MathUtils3D.fastInvSqrt=function fastInvSqrt(value){if(MathUtils3D.isZero(value))return value;return 1.0/Math.sqrt(value);};return MathUtils3D;}();MathUtils3D.zeroTolerance=1e-6;MathUtils3D.MaxValue=3.40282347e+38;MathUtils3D.MinValue=-3.40282347e+38;MathUtils3D.Deg2Rad=Math.PI/180;var Vector2=/*#__PURE__*/function(){function Vector2(x,y){if(x===void 0){x=0;}if(y===void 0){y=0;}this.x=x;this.y=y;}var _proto=Vector2.prototype;_proto.setValue=function setValue(x,y){this.x=x;this.y=y;};Vector2.scale=function scale(a,b,out){out.x=a.x*b;out.y=a.y*b;};_proto.fromArray=function fromArray(array,offset){if(offset===void 0){offset=0;}this.x=array[offset+0];this.y=array[offset+1];};_proto.cloneTo=function cloneTo(destObject){var destVector2=destObject;destVector2.x=this.x;destVector2.y=this.y;};Vector2.dot=function dot(a,b){return a.x*b.x+a.y*b.y;};Vector2.normalize=function normalize(s,out){var x=s.x,y=s.y;var len=x*x+y*y;if(len>0){len=1/Math.sqrt(len);out.x=x*len;out.y=y*len;}};Vector2.scalarLength=function scalarLength(a){var x=a.x,y=a.y;return Math.sqrt(x*x+y*y);};_proto.clone=function clone(){var destVector2=new Vector2();this.cloneTo(destVector2);return destVector2;};_proto.forNativeElement=function forNativeElement(nativeElements){if(nativeElements===void 0){nativeElements=null;}if(nativeElements){this.elements=nativeElements;this.elements[0]=this.x;this.elements[1]=this.y;}else {this.elements=new Float32Array([this.x,this.y]);}Vector2.rewriteNumProperty(this,"x",0);Vector2.rewriteNumProperty(this,"y",1);};Vector2.rewriteNumProperty=function rewriteNumProperty(proto,name,index){Object["defineProperty"](proto,name,{"get":function get(){return this.elements[index];},"set":function set(v){this.elements[index]=v;}});};return Vector2;}();Vector2.ZERO=new Vector2(0.0,0.0);Vector2.ONE=new Vector2(1.0,1.0);var Vector4=/*#__PURE__*/function(){function Vector4(x,y,z,w){if(x===void 0){x=0;}if(y===void 0){y=0;}if(z===void 0){z=0;}if(w===void 0){w=0;}this.x=x;this.y=y;this.z=z;this.w=w;}var _proto2=Vector4.prototype;_proto2.setValue=function setValue(x,y,z,w){this.x=x;this.y=y;this.z=z;this.w=w;};_proto2.fromArray=function fromArray(array,offset){if(offset===void 0){offset=0;}this.x=array[offset+0];this.y=array[offset+1];this.z=array[offset+2];this.w=array[offset+3];};_proto2.cloneTo=function cloneTo(destObject){var destVector4=destObject;destVector4.x=this.x;destVector4.y=this.y;destVector4.z=this.z;destVector4.w=this.w;};_proto2.clone=function clone(){var destVector4=new Vector4();this.cloneTo(destVector4);return destVector4;};Vector4.lerp=function lerp(a,b,t,out){var ax=a.x,ay=a.y,az=a.z,aw=a.w;out.x=ax+t*(b.x-ax);out.y=ay+t*(b.y-ay);out.z=az+t*(b.z-az);out.w=aw+t*(b.w-aw);};Vector4.transformByM4x4=function transformByM4x4(vector4,m4x4,out){var vx=vector4.x;var vy=vector4.y;var vz=vector4.z;var vw=vector4.w;var me=m4x4.elements;out.x=vx*me[0]+vy*me[4]+vz*me[8]+vw*me[12];out.y=vx*me[1]+vy*me[5]+vz*me[9]+vw*me[13];out.z=vx*me[2]+vy*me[6]+vz*me[10]+vw*me[14];out.w=vx*me[3]+vy*me[7]+vz*me[11]+vw*me[15];};Vector4.equals=function equals(a,b){return MathUtils3D.nearEqual(Math.abs(a.x),Math.abs(b.x))&&MathUtils3D.nearEqual(Math.abs(a.y),Math.abs(b.y))&&MathUtils3D.nearEqual(Math.abs(a.z),Math.abs(b.z))&&MathUtils3D.nearEqual(Math.abs(a.w),Math.abs(b.w));};_proto2.length=function length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);};_proto2.lengthSquared=function lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;};Vector4.normalize=function normalize(s,out){var len=s.length();if(len>0){var inverse=1.0/len;out.x=s.x*inverse;out.y=s.y*inverse;out.z=s.z*inverse;out.w=s.w*inverse;}};Vector4.add=function add(a,b,out){out.x=a.x+b.x;out.y=a.y+b.y;out.z=a.z+b.z;out.w=a.w+b.w;};Vector4.subtract=function subtract(a,b,out){out.x=a.x-b.x;out.y=a.y-b.y;out.z=a.z-b.z;out.w=a.w-b.w;};Vector4.multiply=function multiply(a,b,out){out.x=a.x*b.x;out.y=a.y*b.y;out.z=a.z*b.z;out.w=a.w*b.w;};Vector4.scale=function scale(a,b,out){out.x=a.x*b;out.y=a.y*b;out.z=a.z*b;out.w=a.w*b;};Vector4.Clamp=function Clamp(value,min,max,out){var x=value.x;var y=value.y;var z=value.z;var w=value.w;var mineX=min.x;var mineY=min.y;var mineZ=min.z;var mineW=min.w;var maxeX=max.x;var maxeY=max.y;var maxeZ=max.z;var maxeW=max.w;x=x>maxeX?maxeX:x;x=x<mineX?mineX:x;y=y>maxeY?maxeY:y;y=y<mineY?mineY:y;z=z>maxeZ?maxeZ:z;z=z<mineZ?mineZ:z;w=w>maxeW?maxeW:w;w=w<mineW?mineW:w;out.x=x;out.y=y;out.z=z;out.w=w;};Vector4.distanceSquared=function distanceSquared(value1,value2){var x=value1.x-value2.x;var y=value1.y-value2.y;var z=value1.z-value2.z;var w=value1.w-value2.w;return x*x+y*y+z*z+w*w;};Vector4.distance=function distance(value1,value2){var x=value1.x-value2.x;var y=value1.y-value2.y;var z=value1.z-value2.z;var w=value1.w-value2.w;return Math.sqrt(x*x+y*y+z*z+w*w);};Vector4.dot=function dot(a,b){return a.x*b.x+a.y*b.y+a.z*b.z+a.w*b.w;};Vector4.min=function min(a,b,out){out.x=Math.min(a.x,b.x);out.y=Math.min(a.y,b.y);out.z=Math.min(a.z,b.z);out.w=Math.min(a.w,b.w);};Vector4.max=function max(a,b,out){out.x=Math.max(a.x,b.x);out.y=Math.max(a.y,b.y);out.z=Math.max(a.z,b.z);out.w=Math.max(a.w,b.w);};_proto2.forNativeElement=function forNativeElement(nativeElements){if(nativeElements===void 0){nativeElements=null;}if(nativeElements){this.elements=nativeElements;this.elements[0]=this.x;this.elements[1]=this.y;this.elements[2]=this.z;this.elements[3]=this.w;}else {this.elements=new Float32Array([this.x,this.y,this.z,this.w]);}Vector2.rewriteNumProperty(this,"x",0);Vector2.rewriteNumProperty(this,"y",1);Vector2.rewriteNumProperty(this,"z",2);Vector2.rewriteNumProperty(this,"w",3);};return Vector4;}();Vector4.ZERO=new Vector4();Vector4.ONE=new Vector4(1.0,1.0,1.0,1.0);Vector4.UnitX=new Vector4(1.0,0.0,0.0,0.0);Vector4.UnitY=new Vector4(0.0,1.0,0.0,0.0);Vector4.UnitZ=new Vector4(0.0,0.0,1.0,0.0);Vector4.UnitW=new Vector4(0.0,0.0,0.0,1.0);var Vector3=/*#__PURE__*/function(){function Vector3(x,y,z,nativeElements){if(x===void 0){x=0;}if(y===void 0){y=0;}if(z===void 0){z=0;}this.x=x;this.y=y;this.z=z;}Vector3.distanceSquared=function distanceSquared(value1,value2){var x=value1.x-value2.x;var y=value1.y-value2.y;var z=value1.z-value2.z;return x*x+y*y+z*z;};Vector3.distance=function distance(value1,value2){var x=value1.x-value2.x;var y=value1.y-value2.y;var z=value1.z-value2.z;return Math.sqrt(x*x+y*y+z*z);};Vector3.min=function min(a,b,out){out.x=Math.min(a.x,b.x);out.y=Math.min(a.y,b.y);out.z=Math.min(a.z,b.z);};Vector3.max=function max(a,b,out){out.x=Math.max(a.x,b.x);out.y=Math.max(a.y,b.y);out.z=Math.max(a.z,b.z);};Vector3.transformQuat=function transformQuat(source,rotation,out){var x=source.x,y=source.y,z=source.z,qx=rotation.x,qy=rotation.y,qz=rotation.z,qw=rotation.w,ix=qw*x+qy*z-qz*y,iy=qw*y+qz*x-qx*z,iz=qw*z+qx*y-qy*x,iw=-qx*x-qy*y-qz*z;out.x=ix*qw+iw*-qx+iy*-qz-iz*-qy;out.y=iy*qw+iw*-qy+iz*-qx-ix*-qz;out.z=iz*qw+iw*-qz+ix*-qy-iy*-qx;};Vector3.scalarLength=function scalarLength(a){var x=a.x,y=a.y,z=a.z;return Math.sqrt(x*x+y*y+z*z);};Vector3.scalarLengthSquared=function scalarLengthSquared(a){var x=a.x,y=a.y,z=a.z;return x*x+y*y+z*z;};Vector3.normalize=function normalize(s,out){var x=s.x,y=s.y,z=s.z;var len=x*x+y*y+z*z;if(len>0){len=1/Math.sqrt(len);out.x=x*len;out.y=y*len;out.z=z*len;}};Vector3.multiply=function multiply(a,b,out){out.x=a.x*b.x;out.y=a.y*b.y;out.z=a.z*b.z;};Vector3.scale=function scale(a,b,out){out.x=a.x*b;out.y=a.y*b;out.z=a.z*b;};Vector3.lerp=function lerp(a,b,t,out){var ax=a.x,ay=a.y,az=a.z;out.x=ax+t*(b.x-ax);out.y=ay+t*(b.y-ay);out.z=az+t*(b.z-az);};Vector3.transformV3ToV3=function transformV3ToV3(vector,transform,result){var intermediate=Vector3._tempVector4;Vector3.transformV3ToV4(vector,transform,intermediate);result.x=intermediate.x;result.y=intermediate.y;result.z=intermediate.z;};Vector3.transformV3ToV4=function transformV3ToV4(vector,transform,result){var vectorX=vector.x;var vectorY=vector.y;var vectorZ=vector.z;var transformElem=transform.elements;result.x=vectorX*transformElem[0]+vectorY*transformElem[4]+vectorZ*transformElem[8]+transformElem[12];result.y=vectorX*transformElem[1]+vectorY*transformElem[5]+vectorZ*transformElem[9]+transformElem[13];result.z=vectorX*transformElem[2]+vectorY*transformElem[6]+vectorZ*transformElem[10]+transformElem[14];result.w=vectorX*transformElem[3]+vectorY*transformElem[7]+vectorZ*transformElem[11]+transformElem[15];};Vector3.TransformNormal=function TransformNormal(normal,transform,result){var normalX=normal.x;var normalY=normal.y;var normalZ=normal.z;var transformElem=transform.elements;result.x=normalX*transformElem[0]+normalY*transformElem[4]+normalZ*transformElem[8];result.y=normalX*transformElem[1]+normalY*transformElem[5]+normalZ*transformElem[9];result.z=normalX*transformElem[2]+normalY*transformElem[6]+normalZ*transformElem[10];};Vector3.transformCoordinate=function transformCoordinate(coordinate,transform,result){var coordinateX=coordinate.x;var coordinateY=coordinate.y;var coordinateZ=coordinate.z;var transformElem=transform.elements;var w=coordinateX*transformElem[3]+coordinateY*transformElem[7]+coordinateZ*transformElem[11]+transformElem[15];result.x=(coordinateX*transformElem[0]+coordinateY*transformElem[4]+coordinateZ*transformElem[8]+transformElem[12])/w;result.y=(coordinateX*transformElem[1]+coordinateY*transformElem[5]+coordinateZ*transformElem[9]+transformElem[13])/w;result.z=(coordinateX*transformElem[2]+coordinateY*transformElem[6]+coordinateZ*transformElem[10]+transformElem[14])/w;};Vector3.Clamp=function Clamp(value,min,max,out){var x=value.x;var y=value.y;var z=value.z;var mineX=min.x;var mineY=min.y;var mineZ=min.z;var maxeX=max.x;var maxeY=max.y;var maxeZ=max.z;x=x>maxeX?maxeX:x;x=x<mineX?mineX:x;y=y>maxeY?maxeY:y;y=y<mineY?mineY:y;z=z>maxeZ?maxeZ:z;z=z<mineZ?mineZ:z;out.x=x;out.y=y;out.z=z;};Vector3.add=function add(a,b,out){out.x=a.x+b.x;out.y=a.y+b.y;out.z=a.z+b.z;};Vector3.subtract=function subtract(a,b,o){o.x=a.x-b.x;o.y=a.y-b.y;o.z=a.z-b.z;};Vector3.cross=function cross(a,b,o){var ax=a.x,ay=a.y,az=a.z,bx=b.x,by=b.y,bz=b.z;o.x=ay*bz-az*by;o.y=az*bx-ax*bz;o.z=ax*by-ay*bx;};Vector3.dot=function dot(a,b){return a.x*b.x+a.y*b.y+a.z*b.z;};Vector3.equals=function equals(a,b){return MathUtils3D.nearEqual(a.x,b.x)&&MathUtils3D.nearEqual(a.y,b.y)&&MathUtils3D.nearEqual(a.z,b.z);};var _proto3=Vector3.prototype;_proto3.setValue=function setValue(x,y,z){this.x=x;this.y=y;this.z=z;};_proto3.fromArray=function fromArray(array,offset){if(offset===void 0){offset=0;}this.x=array[offset+0];this.y=array[offset+1];this.z=array[offset+2];};_proto3.cloneTo=function cloneTo(destObject){var destVector3=destObject;destVector3.x=this.x;destVector3.y=this.y;destVector3.z=this.z;};_proto3.clone=function clone(){var destVector3=new Vector3();this.cloneTo(destVector3);return destVector3;};_proto3.toDefault=function toDefault(){this.x=0;this.y=0;this.z=0;};_proto3.forNativeElement=function forNativeElement(nativeElements){if(nativeElements===void 0){nativeElements=null;}if(nativeElements){this.elements=nativeElements;this.elements[0]=this.x;this.elements[1]=this.y;this.elements[2]=this.z;}else {this.elements=new Float32Array([this.x,this.y,this.z]);}Vector2.rewriteNumProperty(this,"x",0);Vector2.rewriteNumProperty(this,"y",1);Vector2.rewriteNumProperty(this,"z",2);};return Vector3;}();Vector3._tempVector4=new Vector4();Vector3._ZERO=new Vector3(0.0,0.0,0.0);Vector3._ONE=new Vector3(1.0,1.0,1.0);Vector3._NegativeUnitX=new Vector3(-1,0,0);Vector3._UnitX=new Vector3(1,0,0);Vector3._UnitY=new Vector3(0,1,0);Vector3._UnitZ=new Vector3(0,0,1);Vector3._ForwardRH=new Vector3(0,0,-1);Vector3._ForwardLH=new Vector3(0,0,1);Vector3._Up=new Vector3(0,1,0);(function(PBRRenderQuality){PBRRenderQuality[PBRRenderQuality["High"]=0]="High";PBRRenderQuality[PBRRenderQuality["Low"]=1]="Low";})(exports.PBRRenderQuality||(exports.PBRRenderQuality={}));var Matrix3x3=/*#__PURE__*/function(){function Matrix3x3(){var e=this.elements=new Float32Array(9);e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=1;e[5]=0;e[6]=0;e[7]=0;e[8]=1;}Matrix3x3.createRotationQuaternion=function createRotationQuaternion(rotation,out){var rotX=rotation.x;var rotY=rotation.y;var rotZ=rotation.z;var rotW=rotation.w;var xx=rotX*rotX;var yy=rotY*rotY;var zz=rotZ*rotZ;var xy=rotX*rotY;var zw=rotZ*rotW;var zx=rotZ*rotX;var yw=rotY*rotW;var yz=rotY*rotZ;var xw=rotX*rotW;var resultE=out.elements;resultE[0]=1.0-2.0*(yy+zz);resultE[1]=2.0*(xy+zw);resultE[2]=2.0*(zx-yw);resultE[3]=2.0*(xy-zw);resultE[4]=1.0-2.0*(zz+xx);resultE[5]=2.0*(yz+xw);resultE[6]=2.0*(zx+yw);resultE[7]=2.0*(yz-xw);resultE[8]=1.0-2.0*(yy+xx);};Matrix3x3.createFromTranslation=function createFromTranslation(trans,out){var e=out.elements;e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=1;e[5]=0;e[6]=trans.x;e[7]=trans.y;e[8]=1;};Matrix3x3.createFromRotation=function createFromRotation(rad,out){var e=out.elements;var s=Math.sin(rad),c=Math.cos(rad);e[0]=c;e[1]=s;e[2]=0;e[3]=-s;e[4]=c;e[5]=0;e[6]=0;e[7]=0;e[8]=1;};Matrix3x3.createFromScaling=function createFromScaling(scale,out){var e=out.elements;e[0]=scale.x;e[1]=0;e[2]=0;e[3]=0;e[4]=scale.y;e[5]=0;e[6]=0;e[7]=0;e[8]=scale.z;};Matrix3x3.createFromMatrix4x4=function createFromMatrix4x4(sou,out){var souE=sou.elements;var outE=out.elements;outE[0]=souE[0];outE[1]=souE[1];outE[2]=souE[2];outE[3]=souE[4];outE[4]=souE[5];outE[5]=souE[6];outE[6]=souE[8];outE[7]=souE[9];outE[8]=souE[10];};Matrix3x3.multiply=function multiply(left,right,out){var l=left.elements;var r=right.elements;var e=out.elements;var l11=l[0],l12=l[1],l13=l[2];var l21=l[3],l22=l[4],l23=l[5];var l31=l[6],l32=l[7],l33=l[8];var r11=r[0],r12=r[1],r13=r[2];var r21=r[3],r22=r[4],r23=r[5];var r31=r[6],r32=r[7],r33=r[8];e[0]=r11*l11+r12*l21+r13*l31;e[1]=r11*l12+r12*l22+r13*r32;e[2]=r11*l13+r12*l23+r13*l33;e[3]=r21*l11+r22*l21+r23*l31;e[4]=r21*l12+r22*l22+r23*l32;e[5]=r21*l13+r22*l23+r23*l33;e[6]=r31*l11+r32*l21+r33*l31;e[7]=r31*l12+r32*l22+r33*l32;e[8]=r31*l13+r32*l23+r33*l33;};var _proto4=Matrix3x3.prototype;_proto4.determinant=function determinant(){var f=this.elements;var a00=f[0],a01=f[1],a02=f[2];var a10=f[3],a11=f[4],a12=f[5];var a20=f[6],a21=f[7],a22=f[8];return a00*(a22*a11-a12*a21)+a01*(-a22*a10+a12*a20)+a02*(a21*a10-a11*a20);};_proto4.translate=function translate(trans,out){var e=out.elements;var f=this.elements;var a00=f[0],a01=f[1],a02=f[2];var a10=f[3],a11=f[4],a12=f[5];var a20=f[6],a21=f[7],a22=f[8];var x=trans.x,y=trans.y;e[0]=a00;e[1]=a01;e[2]=a02;e[3]=a10;e[4]=a11;e[5]=a12;e[6]=x*a00+y*a10+a20;e[7]=x*a01+y*a11+a21;e[8]=x*a02+y*a12+a22;};_proto4.rotate=function rotate(rad,out){var e=out.elements;var f=this.elements;var a00=f[0],a01=f[1],a02=f[2];var a10=f[3],a11=f[4],a12=f[5];var a20=f[6],a21=f[7],a22=f[8];var s=Math.sin(rad);var c=Math.cos(rad);e[0]=c*a00+s*a10;e[1]=c*a01+s*a11;e[2]=c*a02+s*a12;e[3]=c*a10-s*a00;e[4]=c*a11-s*a01;e[5]=c*a12-s*a02;e[6]=a20;e[7]=a21;e[8]=a22;};_proto4.scale=function scale(_scale,out){var e=out.elements;var f=this.elements;var x=_scale.x,y=_scale.y;e[0]=x*f[0];e[1]=x*f[1];e[2]=x*f[2];e[3]=y*f[3];e[4]=y*f[4];e[5]=y*f[5];e[6]=f[6];e[7]=f[7];e[8]=f[8];};_proto4.invert=function invert(out){var e=out.elements;var f=this.elements;var a00=f[0],a01=f[1],a02=f[2];var a10=f[3],a11=f[4],a12=f[5];var a20=f[6],a21=f[7],a22=f[8];var b01=a22*a11-a12*a21;var b11=-a22*a10+a12*a20;var b21=a21*a10-a11*a20;var det=a00*b01+a01*b11+a02*b21;if(!det){out=null;}det=1.0/det;e[0]=b01*det;e[1]=(-a22*a01+a02*a21)*det;e[2]=(a12*a01-a02*a11)*det;e[3]=b11*det;e[4]=(a22*a00-a02*a20)*det;e[5]=(-a12*a00+a02*a10)*det;e[6]=b21*det;e[7]=(-a21*a00+a01*a20)*det;e[8]=(a11*a00-a01*a10)*det;};_proto4.transpose=function transpose(out){var e=out.elements;var f=this.elements;if(out===this){var a01=f[1],a02=f[2],a12=f[5];e[1]=f[3];e[2]=f[6];e[3]=a01;e[5]=f[7];e[6]=a02;e[7]=a12;}else {e[0]=f[0];e[1]=f[3];e[2]=f[6];e[3]=f[1];e[4]=f[4];e[5]=f[7];e[6]=f[2];e[7]=f[5];e[8]=f[8];}};_proto4.identity=function identity(){var e=this.elements;e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=1;e[5]=0;e[6]=0;e[7]=0;e[8]=1;};_proto4.cloneTo=function cloneTo(destObject){var i,s,d;s=this.elements;d=destObject.elements;if(s===d){return;}for(i=0;i<9;++i){d[i]=s[i];}};_proto4.clone=function clone(){var dest=new Matrix3x3();this.cloneTo(dest);return dest;};Matrix3x3.lookAt=function lookAt(eye,target,up,out){Vector3.subtract(eye,target,Matrix3x3._tempV30);Vector3.normalize(Matrix3x3._tempV30,Matrix3x3._tempV30);Vector3.cross(up,Matrix3x3._tempV30,Matrix3x3._tempV31);Vector3.normalize(Matrix3x3._tempV31,Matrix3x3._tempV31);Vector3.cross(Matrix3x3._tempV30,Matrix3x3._tempV31,Matrix3x3._tempV32);var v0=Matrix3x3._tempV30;var v1=Matrix3x3._tempV31;var v2=Matrix3x3._tempV32;var me=out.elements;me[0]=v1.x;me[3]=v1.y;me[6]=v1.z;me[1]=v2.x;me[4]=v2.y;me[7]=v2.z;me[2]=v0.x;me[5]=v0.y;me[8]=v0.z;};return Matrix3x3;}();Matrix3x3.DEFAULT=new Matrix3x3();Matrix3x3._tempV30=new Vector3();Matrix3x3._tempV31=new Vector3();Matrix3x3._tempV32=new Vector3();var ILaya3D=function ILaya3D(){};ILaya3D.Shader3D=null;ILaya3D.Scene3D=null;ILaya3D.MeshRenderStaticBatchManager=null;ILaya3D.MeshRenderDynamicBatchManager=null;ILaya3D.SubMeshDynamicBatch=null;ILaya3D.Laya3D=null;ILaya3D.Matrix4x4=null;ILaya3D.Physics3D=null;ILaya3D.ShadowLightType=null;var Quaternion=/*#__PURE__*/function(){function Quaternion(x,y,z,w,nativeElements){if(x===void 0){x=0;}if(y===void 0){y=0;}if(z===void 0){z=0;}if(w===void 0){w=1;}this.x=x;this.y=y;this.z=z;this.w=w;}Quaternion.createFromYawPitchRoll=function createFromYawPitchRoll(yaw,pitch,roll,out){var halfRoll=roll*0.5;var halfPitch=pitch*0.5;var halfYaw=yaw*0.5;var sinRoll=Math.sin(halfRoll);var cosRoll=Math.cos(halfRoll);var sinPitch=Math.sin(halfPitch);var cosPitch=Math.cos(halfPitch);var sinYaw=Math.sin(halfYaw);var cosYaw=Math.cos(halfYaw);out.x=cosYaw*sinPitch*cosRoll+sinYaw*cosPitch*sinRoll;out.y=sinYaw*cosPitch*cosRoll-cosYaw*sinPitch*sinRoll;out.z=cosYaw*cosPitch*sinRoll-sinYaw*sinPitch*cosRoll;out.w=cosYaw*cosPitch*cosRoll+sinYaw*sinPitch*sinRoll;};Quaternion.multiply=function multiply(left,right,out){var lx=left.x;var ly=left.y;var lz=left.z;var lw=left.w;var rx=right.x;var ry=right.y;var rz=right.z;var rw=right.w;var a=ly*rz-lz*ry;var b=lz*rx-lx*rz;var c=lx*ry-ly*rx;var d=lx*rx+ly*ry+lz*rz;out.x=lx*rw+rx*lw+a;out.y=ly*rw+ry*lw+b;out.z=lz*rw+rz*lw+c;out.w=lw*rw-d;};Quaternion.arcTanAngle=function arcTanAngle(x,y){if(x==0){if(y==1)return Math.PI/2;return -Math.PI/2;}if(x>0)return Math.atan(y/x);if(x<0){if(y>0)return Math.atan(y/x)+Math.PI;return Math.atan(y/x)-Math.PI;}return 0;};Quaternion.angleTo=function angleTo(from,location,angle){Vector3.subtract(location,from,Quaternion.TEMPVector30);Vector3.normalize(Quaternion.TEMPVector30,Quaternion.TEMPVector30);angle.x=Math.asin(Quaternion.TEMPVector30.y);angle.y=Quaternion.arcTanAngle(-Quaternion.TEMPVector30.z,-Quaternion.TEMPVector30.x);};Quaternion.createFromAxisAngle=function createFromAxisAngle(axis,rad,out){rad=rad*0.5;var s=Math.sin(rad);out.x=s*axis.x;out.y=s*axis.y;out.z=s*axis.z;out.w=Math.cos(rad);};Quaternion.createFromMatrix4x4=function createFromMatrix4x4(mat,out){var me=mat.elements;var sqrt;var half;var scale=me[0]+me[5]+me[10];if(scale>0.0){sqrt=Math.sqrt(scale+1.0);out.w=sqrt*0.5;sqrt=0.5/sqrt;out.x=(me[6]-me[9])*sqrt;out.y=(me[8]-me[2])*sqrt;out.z=(me[1]-me[4])*sqrt;}else if(me[0]>=me[5]&&me[0]>=me[10]){sqrt=Math.sqrt(1.0+me[0]-me[5]-me[10]);half=0.5/sqrt;out.x=0.5*sqrt;out.y=(me[1]+me[4])*half;out.z=(me[2]+me[8])*half;out.w=(me[6]-me[9])*half;}else if(me[5]>me[10]){sqrt=Math.sqrt(1.0+me[5]-me[0]-me[10]);half=0.5/sqrt;out.x=(me[4]+me[1])*half;out.y=0.5*sqrt;out.z=(me[9]+me[6])*half;out.w=(me[8]-me[2])*half;}else {sqrt=Math.sqrt(1.0+me[10]-me[0]-me[5]);half=0.5/sqrt;out.x=(me[8]+me[2])*half;out.y=(me[9]+me[6])*half;out.z=0.5*sqrt;out.w=(me[1]-me[4])*half;}};Quaternion.slerp=function slerp(left,right,t,out){var ax=left.x,ay=left.y,az=left.z,aw=left.w,bx=right.x,by=right.y,bz=right.z,bw=right.w;var omega,cosom,sinom,scale0,scale1;cosom=ax*bx+ay*by+az*bz+aw*bw;if(cosom<0.0){cosom=-cosom;bx=-bx;by=-by;bz=-bz;bw=-bw;}if(1.0-cosom>0.000001){omega=Math.acos(cosom);sinom=Math.sin(omega);scale0=Math.sin((1.0-t)*omega)/sinom;scale1=Math.sin(t*omega)/sinom;}else {scale0=1.0-t;scale1=t;}out.x=scale0*ax+scale1*bx;out.y=scale0*ay+scale1*by;out.z=scale0*az+scale1*bz;out.w=scale0*aw+scale1*bw;return out;};Quaternion.lerp=function lerp(left,right,amount,out){var inverse=1.0-amount;if(Quaternion.dot(left,right)>=0){out.x=inverse*left.x+amount*right.x;out.y=inverse*left.y+amount*right.y;out.z=inverse*left.z+amount*right.z;out.w=inverse*left.w+amount*right.w;}else {out.x=inverse*left.x-amount*right.x;out.y=inverse*left.y-amount*right.y;out.z=inverse*left.z-amount*right.z;out.w=inverse*left.w-amount*right.w;}out.normalize(out);};Quaternion.add=function add(left,right,out){out.x=left.x+right.x;out.y=left.y+right.y;out.z=left.z+right.z;out.w=left.w+right.w;};Quaternion.dot=function dot(left,right){return left.x*right.x+left.y*right.y+left.z*right.z+left.w*right.w;};var _proto5=Quaternion.prototype;_proto5.scaling=function scaling(_scaling,out){out.x=this.x*_scaling;out.y=this.y*_scaling;out.z=this.z*_scaling;out.w=this.w*_scaling;};_proto5.normalize=function normalize(out){var len=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;if(len>0){len=1/Math.sqrt(len);out.x=this.x*len;out.y=this.y*len;out.z=this.z*len;out.w=this.w*len;}};_proto5.length=function length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);};_proto5.rotateX=function rotateX(rad,out){rad*=0.5;var bx=Math.sin(rad),bw=Math.cos(rad);out.x=this.x*bw+this.w*bx;out.y=this.y*bw+this.z*bx;out.z=this.z*bw-this.y*bx;out.w=this.w*bw-this.x*bx;};_proto5.rotateY=function rotateY(rad,out){rad*=0.5;var by=Math.sin(rad),bw=Math.cos(rad);out.x=this.x*bw-this.z*by;out.y=this.y*bw+this.w*by;out.z=this.z*bw+this.x*by;out.w=this.w*bw-this.y*by;};_proto5.rotateZ=function rotateZ(rad,out){rad*=0.5;var bz=Math.sin(rad),bw=Math.cos(rad);out.x=this.x*bw+this.y*bz;out.y=this.y*bw-this.x*bz;out.z=this.z*bw+this.w*bz;out.w=this.w*bw-this.z*bz;};_proto5.getYawPitchRoll=function getYawPitchRoll(out){Vector3.transformQuat(Vector3._ForwardRH,this,Quaternion.TEMPVector31);Vector3.transformQuat(Vector3._Up,this,Quaternion.TEMPVector32);var upe=Quaternion.TEMPVector32;Quaternion.angleTo(Vector3._ZERO,Quaternion.TEMPVector31,Quaternion.TEMPVector33);var angle=Quaternion.TEMPVector33;if(angle.x==Math.PI/2){angle.y=Quaternion.arcTanAngle(upe.z,upe.x);angle.z=0;}else if(angle.x==-Math.PI/2){angle.y=Quaternion.arcTanAngle(-upe.z,-upe.x);angle.z=0;}else {ILaya3D.Matrix4x4.createRotationY(-angle.y,ILaya3D.Matrix4x4.TEMPMatrix0);ILaya3D.Matrix4x4.createRotationX(-angle.x,ILaya3D.Matrix4x4.TEMPMatrix1);Vector3.transformCoordinate(Quaternion.TEMPVector32,ILaya3D.Matrix4x4.TEMPMatrix0,Quaternion.TEMPVector32);Vector3.transformCoordinate(Quaternion.TEMPVector32,ILaya3D.Matrix4x4.TEMPMatrix1,Quaternion.TEMPVector32);angle.z=Quaternion.arcTanAngle(upe.y,-upe.x);}if(angle.y<=-Math.PI)angle.y=Math.PI;if(angle.z<=-Math.PI)angle.z=Math.PI;if(angle.y>=Math.PI&&angle.z>=Math.PI){angle.y=0;angle.z=0;angle.x=Math.PI-angle.x;}var oe=out;oe.x=angle.y;oe.y=angle.x;oe.z=angle.z;};_proto5.invert=function invert(out){var a0=this.x,a1=this.y,a2=this.z,a3=this.w;var dot=a0*a0+a1*a1+a2*a2+a3*a3;var invDot=dot?1.0/dot:0;out.x=-a0*invDot;out.y=-a1*invDot;out.z=-a2*invDot;out.w=a3*invDot;};_proto5.identity=function identity(){this.x=0;this.y=0;this.z=0;this.w=1;};_proto5.fromArray=function fromArray(array,offset){if(offset===void 0){offset=0;}this.x=array[offset+0];this.y=array[offset+1];this.z=array[offset+2];this.w=array[offset+3];};_proto5.cloneTo=function cloneTo(destObject){if(this===destObject){return;}destObject.x=this.x;destObject.y=this.y;destObject.z=this.z;destObject.w=this.w;};_proto5.clone=function clone(){var dest=new Quaternion();this.cloneTo(dest);return dest;};_proto5.equals=function equals(b){return MathUtils3D.nearEqual(this.x,b.x)&&MathUtils3D.nearEqual(this.y,b.y)&&MathUtils3D.nearEqual(this.z,b.z)&&MathUtils3D.nearEqual(this.w,b.w);};Quaternion.rotationLookAt=function rotationLookAt(forward,up,out){Quaternion.lookAt(Vector3._ZERO,forward,up,out);};Quaternion.lookAt=function lookAt(eye,target,up,out){Matrix3x3.lookAt(eye,target,up,Quaternion._tempMatrix3x3);Quaternion.rotationMatrix(Quaternion._tempMatrix3x3,out);};_proto5.lengthSquared=function lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;};Quaternion.invert=function invert(value,out){var lengthSq=value.lengthSquared();if(!MathUtils3D.isZero(lengthSq)){lengthSq=1.0/lengthSq;out.x=-value.x*lengthSq;out.y=-value.y*lengthSq;out.z=-value.z*lengthSq;out.w=value.w*lengthSq;}};Quaternion.rotationMatrix=function rotationMatrix(matrix3x3,out){var me=matrix3x3.elements;var m11=me[0];var m12=me[1];var m13=me[2];var m21=me[3];var m22=me[4];var m23=me[5];var m31=me[6];var m32=me[7];var m33=me[8];var sqrt,half;var scale=m11+m22+m33;if(scale>0){sqrt=Math.sqrt(scale+1);out.w=sqrt*0.5;sqrt=0.5/sqrt;out.x=(m23-m32)*sqrt;out.y=(m31-m13)*sqrt;out.z=(m12-m21)*sqrt;}else if(m11>=m22&&m11>=m33){sqrt=Math.sqrt(1+m11-m22-m33);half=0.5/sqrt;out.x=0.5*sqrt;out.y=(m12+m21)*half;out.z=(m13+m31)*half;out.w=(m23-m32)*half;}else if(m22>m33){sqrt=Math.sqrt(1+m22-m11-m33);half=0.5/sqrt;out.x=(m21+m12)*half;out.y=0.5*sqrt;out.z=(m32+m23)*half;out.w=(m31-m13)*half;}else {sqrt=Math.sqrt(1+m33-m11-m22);half=0.5/sqrt;out.x=(m31+m13)*half;out.y=(m32+m23)*half;out.z=0.5*sqrt;out.w=(m12-m21)*half;}};_proto5.forNativeElement=function forNativeElement(nativeElements){if(nativeElements===void 0){nativeElements=null;}if(nativeElements){this.elements=nativeElements;this.elements[0]=this.x;this.elements[1]=this.y;this.elements[2]=this.z;this.elements[3]=this.w;}else {this.elements=new Float32Array([this.x,this.y,this.z,this.w]);}Vector2.rewriteNumProperty(this,"x",0);Vector2.rewriteNumProperty(this,"y",1);Vector2.rewriteNumProperty(this,"z",2);Vector2.rewriteNumProperty(this,"w",3);};return Quaternion;}();Quaternion.TEMPVector30=new Vector3();Quaternion.TEMPVector31=new Vector3();Quaternion.TEMPVector32=new Vector3();Quaternion.TEMPVector33=new Vector3();Quaternion._tempMatrix3x3=new Matrix3x3();Quaternion.DEFAULT=new Quaternion();Quaternion.NAN=new Quaternion(NaN,NaN,NaN,NaN);var Matrix4x4=/*#__PURE__*/function(){function Matrix4x4(m11,m12,m13,m14,m21,m22,m23,m24,m31,m32,m33,m34,m41,m42,m43,m44,elements){if(m11===void 0){m11=1;}if(m12===void 0){m12=0;}if(m13===void 0){m13=0;}if(m14===void 0){m14=0;}if(m21===void 0){m21=0;}if(m22===void 0){m22=1;}if(m23===void 0){m23=0;}if(m24===void 0){m24=0;}if(m31===void 0){m31=0;}if(m32===void 0){m32=0;}if(m33===void 0){m33=1;}if(m34===void 0){m34=0;}if(m41===void 0){m41=0;}if(m42===void 0){m42=0;}if(m43===void 0){m43=0;}if(m44===void 0){m44=1;}if(elements===void 0){elements=null;}var e=elements?this.elements=elements:this.elements=new Float32Array(16);e[0]=m11;e[1]=m12;e[2]=m13;e[3]=m14;e[4]=m21;e[5]=m22;e[6]=m23;e[7]=m24;e[8]=m31;e[9]=m32;e[10]=m33;e[11]=m34;e[12]=m41;e[13]=m42;e[14]=m43;e[15]=m44;}Matrix4x4.createRotationX=function createRotationX(rad,out){var oe=out.elements;var s=Math.sin(rad),c=Math.cos(rad);oe[1]=oe[2]=oe[3]=oe[4]=oe[7]=oe[8]=oe[11]=oe[12]=oe[13]=oe[14]=0;oe[0]=oe[15]=1;oe[5]=oe[10]=c;oe[6]=s;oe[9]=-s;};Matrix4x4.createRotationY=function createRotationY(rad,out){var oe=out.elements;var s=Math.sin(rad),c=Math.cos(rad);oe[1]=oe[3]=oe[4]=oe[6]=oe[7]=oe[9]=oe[11]=oe[12]=oe[13]=oe[14]=0;oe[5]=oe[15]=1;oe[0]=oe[10]=c;oe[2]=-s;oe[8]=s;};Matrix4x4.createRotationZ=function createRotationZ(rad,out){var oe=out.elements;var s=Math.sin(rad),c=Math.cos(rad);oe[2]=oe[3]=oe[6]=oe[7]=oe[8]=oe[9]=oe[11]=oe[12]=oe[13]=oe[14]=0;oe[10]=oe[15]=1;oe[0]=oe[5]=c;oe[1]=s;oe[4]=-s;};Matrix4x4.createRotationYawPitchRoll=function createRotationYawPitchRoll(yaw,pitch,roll,result){Quaternion.createFromYawPitchRoll(yaw,pitch,roll,Matrix4x4._tempQuaternion);Matrix4x4.createRotationQuaternion(Matrix4x4._tempQuaternion,result);};Matrix4x4.createRotationAxis=function createRotationAxis(axis,angle,result){var x=axis.x;var y=axis.y;var z=axis.z;var cos=Math.cos(angle);var sin=Math.sin(angle);var xx=x*x;var yy=y*y;var zz=z*z;var xy=x*y;var xz=x*z;var yz=y*z;var resultE=result.elements;resultE[3]=resultE[7]=resultE[11]=resultE[12]=resultE[13]=resultE[14]=0;resultE[15]=1.0;resultE[0]=xx+cos*(1.0-xx);resultE[1]=xy-cos*xy+sin*z;resultE[2]=xz-cos*xz-sin*y;resultE[4]=xy-cos*xy-sin*z;resultE[5]=yy+cos*(1.0-yy);resultE[6]=yz-cos*yz+sin*x;resultE[8]=xz-cos*xz+sin*y;resultE[9]=yz-cos*yz-sin*x;resultE[10]=zz+cos*(1.0-zz);};var _proto6=Matrix4x4.prototype;_proto6.setRotation=function setRotation(rotation){var rotationX=rotation.x;var rotationY=rotation.y;var rotationZ=rotation.z;var rotationW=rotation.w;var xx=rotationX*rotationX;var yy=rotationY*rotationY;var zz=rotationZ*rotationZ;var xy=rotationX*rotationY;var zw=rotationZ*rotationW;var zx=rotationZ*rotationX;var yw=rotationY*rotationW;var yz=rotationY*rotationZ;var xw=rotationX*rotationW;var e=this.elements;e[0]=1.0-2.0*(yy+zz);e[1]=2.0*(xy+zw);e[2]=2.0*(zx-yw);e[4]=2.0*(xy-zw);e[5]=1.0-2.0*(zz+xx);e[6]=2.0*(yz+xw);e[8]=2.0*(zx+yw);e[9]=2.0*(yz-xw);e[10]=1.0-2.0*(yy+xx);};_proto6.setPosition=function setPosition(position){var e=this.elements;e[12]=position.x;e[13]=position.y;e[14]=position.z;};Matrix4x4.createRotationQuaternion=function createRotationQuaternion(rotation,result){var resultE=result.elements;var rotationX=rotation.x;var rotationY=rotation.y;var rotationZ=rotation.z;var rotationW=rotation.w;var xx=rotationX*rotationX;var yy=rotationY*rotationY;var zz=rotationZ*rotationZ;var xy=rotationX*rotationY;var zw=rotationZ*rotationW;var zx=rotationZ*rotationX;var yw=rotationY*rotationW;var yz=rotationY*rotationZ;var xw=rotationX*rotationW;resultE[3]=resultE[7]=resultE[11]=resultE[12]=resultE[13]=resultE[14]=0;resultE[15]=1.0;resultE[0]=1.0-2.0*(yy+zz);resultE[1]=2.0*(xy+zw);resultE[2]=2.0*(zx-yw);resultE[4]=2.0*(xy-zw);resultE[5]=1.0-2.0*(zz+xx);resultE[6]=2.0*(yz+xw);resultE[8]=2.0*(zx+yw);resultE[9]=2.0*(yz-xw);resultE[10]=1.0-2.0*(yy+xx);};Matrix4x4.createTranslate=function createTranslate(trans,out){var oe=out.elements;oe[4]=oe[8]=oe[1]=oe[9]=oe[2]=oe[6]=oe[3]=oe[7]=oe[11]=0;oe[0]=oe[5]=oe[10]=oe[15]=1;oe[12]=trans.x;oe[13]=trans.y;oe[14]=trans.z;};Matrix4x4.createScaling=function createScaling(scale,out){var oe=out.elements;oe[0]=scale.x;oe[5]=scale.y;oe[10]=scale.z;oe[1]=oe[4]=oe[8]=oe[12]=oe[9]=oe[13]=oe[2]=oe[6]=oe[14]=oe[3]=oe[7]=oe[11]=0;oe[15]=1;};Matrix4x4.multiply=function multiply(left,right,out){var l=right.elements;var r=left.elements;var e=out.elements;var l11=l[0],l12=l[1],l13=l[2],l14=l[3];var l21=l[4],l22=l[5],l23=l[6],l24=l[7];var l31=l[8],l32=l[9],l33=l[10],l34=l[11];var l41=l[12],l42=l[13],l43=l[14],l44=l[15];var r11=r[0],r12=r[1],r13=r[2],r14=r[3];var r21=r[4],r22=r[5],r23=r[6],r24=r[7];var r31=r[8],r32=r[9],r33=r[10],r34=r[11];var r41=r[12],r42=r[13],r43=r[14],r44=r[15];e[0]=l11*r11+l12*r21+l13*r31+l14*r41;e[1]=l11*r12+l12*r22+l13*r32+l14*r42;e[2]=l11*r13+l12*r23+l13*r33+l14*r43;e[3]=l11*r14+l12*r24+l13*r34+l14*r44;e[4]=l21*r11+l22*r21+l23*r31+l24*r41;e[5]=l21*r12+l22*r22+l23*r32+l24*r42;e[6]=l21*r13+l22*r23+l23*r33+l24*r43;e[7]=l21*r14+l22*r24+l23*r34+l24*r44;e[8]=l31*r11+l32*r21+l33*r31+l34*r41;e[9]=l31*r12+l32*r22+l33*r32+l34*r42;e[10]=l31*r13+l32*r23+l33*r33+l34*r43;e[11]=l31*r14+l32*r24+l33*r34+l34*r44;e[12]=l41*r11+l42*r21+l43*r31+l44*r41;e[13]=l41*r12+l42*r22+l43*r32+l44*r42;e[14]=l41*r13+l42*r23+l43*r33+l44*r43;e[15]=l41*r14+l42*r24+l43*r34+l44*r44;};Matrix4x4.multiplyForNative=function multiplyForNative(left,right,out){Laya.LayaGL.instance.matrix4x4Multiply(left.elements,right.elements,out.elements);};Matrix4x4.createFromQuaternion=function createFromQuaternion(rotation,out){var e=out.elements;var x=rotation.x,y=rotation.y,z=rotation.z,w=rotation.w;var x2=x+x;var y2=y+y;var z2=z+z;var xx=x*x2;var yx=y*x2;var yy=y*y2;var zx=z*x2;var zy=z*y2;var zz=z*z2;var wx=w*x2;var wy=w*y2;var wz=w*z2;e[0]=1-yy-zz;e[1]=yx+wz;e[2]=zx-wy;e[3]=0;e[4]=yx-wz;e[5]=1-xx-zz;e[6]=zy+wx;e[7]=0;e[8]=zx+wy;e[9]=zy-wx;e[10]=1-xx-yy;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;};Matrix4x4.createAffineTransformation=function createAffineTransformation(trans,rot,scale,out){var oe=out.elements;var x=rot.x,y=rot.y,z=rot.z,w=rot.w,x2=x+x,y2=y+y,z2=z+z;var xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2;var wx=w*x2,wy=w*y2,wz=w*z2,sx=scale.x,sy=scale.y,sz=scale.z;oe[0]=(1-(yy+zz))*sx;oe[1]=(xy+wz)*sx;oe[2]=(xz-wy)*sx;oe[3]=0;oe[4]=(xy-wz)*sy;oe[5]=(1-(xx+zz))*sy;oe[6]=(yz+wx)*sy;oe[7]=0;oe[8]=(xz+wy)*sz;oe[9]=(yz-wx)*sz;oe[10]=(1-(xx+yy))*sz;oe[11]=0;oe[12]=trans.x;oe[13]=trans.y;oe[14]=trans.z;oe[15]=1;};Matrix4x4.createLookAt=function createLookAt(eye,target,up,out){var oE=out.elements;var xaxis=Matrix4x4._tempVector0;var yaxis=Matrix4x4._tempVector1;var zaxis=Matrix4x4._tempVector2;Vector3.subtract(eye,target,zaxis);Vector3.normalize(zaxis,zaxis);Vector3.cross(up,zaxis,xaxis);Vector3.normalize(xaxis,xaxis);Vector3.cross(zaxis,xaxis,yaxis);oE[3]=oE[7]=oE[11]=0;oE[15]=1;oE[0]=xaxis.x;oE[4]=xaxis.y;oE[8]=xaxis.z;oE[1]=yaxis.x;oE[5]=yaxis.y;oE[9]=yaxis.z;oE[2]=zaxis.x;oE[6]=zaxis.y;oE[10]=zaxis.z;oE[12]=-Vector3.dot(xaxis,eye);oE[13]=-Vector3.dot(yaxis,eye);oE[14]=-Vector3.dot(zaxis,eye);};Matrix4x4.createPerspective=function createPerspective(fov,aspect,znear,zfar,out){var yScale=1.0/Math.tan(fov*0.5);var xScale=yScale/aspect;var halfWidth=znear/xScale;var halfHeight=znear/yScale;Matrix4x4.createPerspectiveOffCenter(-halfWidth,halfWidth,-halfHeight,halfHeight,znear,zfar,out);};Matrix4x4.createPerspectiveOffCenter=function createPerspectiveOffCenter(left,right,bottom,top,znear,zfar,out){var oe=out.elements;var zRange=zfar/(zfar-znear);oe[1]=oe[2]=oe[3]=oe[4]=oe[6]=oe[7]=oe[12]=oe[13]=oe[15]=0;oe[0]=2.0*znear/(right-left);oe[5]=2.0*znear/(top-bottom);oe[8]=(left+right)/(right-left);oe[9]=(top+bottom)/(top-bottom);oe[10]=-zRange;oe[11]=-1.0;oe[14]=-znear*zRange;};Matrix4x4.createOrthoOffCenter=function createOrthoOffCenter(left,right,bottom,top,znear,zfar,out){var oe=out.elements;var zRange=1.0/(zfar-znear);oe[1]=oe[2]=oe[3]=oe[4]=oe[6]=oe[8]=oe[7]=oe[9]=oe[11]=0;oe[15]=1;oe[0]=2.0/(right-left);oe[5]=2.0/(top-bottom);oe[10]=-zRange;oe[12]=(left+right)/(left-right);oe[13]=(top+bottom)/(bottom-top);oe[14]=-znear*zRange;};_proto6.getElementByRowColumn=function getElementByRowColumn(row,column){if(row<0||row>3)throw new Error("row Rows and columns for matrices run from 0 to 3, inclusive.");if(column<0||column>3)throw new Error("column Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[row*4+column];};_proto6.setElementByRowColumn=function setElementByRowColumn(row,column,value){if(row<0||row>3)throw new Error("row Rows and columns for matrices run from 0 to 3, inclusive.");if(column<0||column>3)throw new Error("column Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[row*4+column]=value;};_proto6.equalsOtherMatrix=function equalsOtherMatrix(other){var e=this.elements;var oe=other.elements;return MathUtils3D.nearEqual(e[0],oe[0])&&MathUtils3D.nearEqual(e[1],oe[1])&&MathUtils3D.nearEqual(e[2],oe[2])&&MathUtils3D.nearEqual(e[3],oe[3])&&MathUtils3D.nearEqual(e[4],oe[4])&&MathUtils3D.nearEqual(e[5],oe[5])&&MathUtils3D.nearEqual(e[6],oe[6])&&MathUtils3D.nearEqual(e[7],oe[7])&&MathUtils3D.nearEqual(e[8],oe[8])&&MathUtils3D.nearEqual(e[9],oe[9])&&MathUtils3D.nearEqual(e[10],oe[10])&&MathUtils3D.nearEqual(e[11],oe[11])&&MathUtils3D.nearEqual(e[12],oe[12])&&MathUtils3D.nearEqual(e[13],oe[13])&&MathUtils3D.nearEqual(e[14],oe[14])&&MathUtils3D.nearEqual(e[15],oe[15]);};_proto6.decomposeTransRotScale=function decomposeTransRotScale(translation,rotation,scale){var rotationMatrix=Matrix4x4._tempMatrix4x4;if(this.decomposeTransRotMatScale(translation,rotationMatrix,scale)){Quaternion.createFromMatrix4x4(rotationMatrix,rotation);return true;}else {rotation.identity();return false;}};_proto6.decomposeTransRotMatScale=function decomposeTransRotMatScale(translation,rotationMatrix,scale){var e=this.elements;var te=translation;var re=rotationMatrix.elements;var se=scale;te.x=e[12];te.y=e[13];te.z=e[14];var m11=e[0],m12=e[1],m13=e[2];var m21=e[4],m22=e[5],m23=e[6];var m31=e[8],m32=e[9],m33=e[10];var sX=se.x=Math.sqrt(m11*m11+m12*m12+m13*m13);var sY=se.y=Math.sqrt(m21*m21+m22*m22+m23*m23);var sZ=se.z=Math.sqrt(m31*m31+m32*m32+m33*m33);if(MathUtils3D.isZero(sX)||MathUtils3D.isZero(sY)||MathUtils3D.isZero(sZ)){re[1]=re[2]=re[3]=re[4]=re[6]=re[7]=re[8]=re[9]=re[11]=re[12]=re[13]=re[14]=0;re[0]=re[5]=re[10]=re[15]=1;return false;}var at=Matrix4x4._tempVector0;at.x=m31/sZ;at.y=m32/sZ;at.z=m33/sZ;var tempRight=Matrix4x4._tempVector1;tempRight.x=m11/sX;tempRight.y=m12/sX;tempRight.z=m13/sX;var up=Matrix4x4._tempVector2;Vector3.cross(at,tempRight,up);var right=Matrix4x4._tempVector1;Vector3.cross(up,at,right);re[3]=re[7]=re[11]=re[12]=re[13]=re[14]=0;re[15]=1;re[0]=right.x;re[1]=right.y;re[2]=right.z;re[4]=up.x;re[5]=up.y;re[6]=up.z;re[8]=at.x;re[9]=at.y;re[10]=at.z;re[0]*m11+re[1]*m12+re[2]*m13<0.0&&(se.x=-sX);re[4]*m21+re[5]*m22+re[6]*m23<0.0&&(se.y=-sY);re[8]*m31+re[9]*m32+re[10]*m33<0.0&&(se.z=-sZ);return true;};_proto6.decomposeYawPitchRoll=function decomposeYawPitchRoll(yawPitchRoll){var pitch=Math.asin(-this.elements[9]);yawPitchRoll.y=pitch;var test=Math.cos(pitch);if(test>MathUtils3D.zeroTolerance){yawPitchRoll.z=Math.atan2(this.elements[1],this.elements[5]);yawPitchRoll.x=Math.atan2(this.elements[8],this.elements[10]);}else {yawPitchRoll.z=Math.atan2(-this.elements[4],this.elements[0]);yawPitchRoll.x=0.0;}};_proto6.normalize=function normalize(){var v=this.elements;var c=v[0],d=v[1],e=v[2],g=Math.sqrt(c*c+d*d+e*e);if(g){if(g==1)return;}else {v[0]=0;v[1]=0;v[2]=0;return;}g=1/g;v[0]=c*g;v[1]=d*g;v[2]=e*g;};_proto6.transpose=function transpose(){var e,t;e=this.elements;t=e[1];e[1]=e[4];e[4]=t;t=e[2];e[2]=e[8];e[8]=t;t=e[3];e[3]=e[12];e[12]=t;t=e[6];e[6]=e[9];e[9]=t;t=e[7];e[7]=e[13];e[13]=t;t=e[11];e[11]=e[14];e[14]=t;return this;};_proto6.invert=function invert(out){var ae=this.elements;var oe=out.elements;var a00=ae[0],a01=ae[1],a02=ae[2],a03=ae[3],a10=ae[4],a11=ae[5],a12=ae[6],a13=ae[7],a20=ae[8],a21=ae[9],a22=ae[10],a23=ae[11],a30=ae[12],a31=ae[13],a32=ae[14],a33=ae[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;if(Math.abs(det)===0.0){return;}det=1.0/det;oe[0]=(a11*b11-a12*b10+a13*b09)*det;oe[1]=(a02*b10-a01*b11-a03*b09)*det;oe[2]=(a31*b05-a32*b04+a33*b03)*det;oe[3]=(a22*b04-a21*b05-a23*b03)*det;oe[4]=(a12*b08-a10*b11-a13*b07)*det;oe[5]=(a00*b11-a02*b08+a03*b07)*det;oe[6]=(a32*b02-a30*b05-a33*b01)*det;oe[7]=(a20*b05-a22*b02+a23*b01)*det;oe[8]=(a10*b10-a11*b08+a13*b06)*det;oe[9]=(a01*b08-a00*b10-a03*b06)*det;oe[10]=(a30*b04-a31*b02+a33*b00)*det;oe[11]=(a21*b02-a20*b04-a23*b00)*det;oe[12]=(a11*b07-a10*b09-a12*b06)*det;oe[13]=(a00*b09-a01*b07+a02*b06)*det;oe[14]=(a31*b01-a30*b03-a32*b00)*det;oe[15]=(a20*b03-a21*b01+a22*b00)*det;};Matrix4x4.billboard=function billboard(objectPosition,cameraPosition,cameraRight,cameraUp,cameraForward,mat){Vector3.subtract(objectPosition,cameraPosition,Matrix4x4._tempVector0);var lengthSq=Vector3.scalarLengthSquared(Matrix4x4._tempVector0);if(MathUtils3D.isZero(lengthSq)){Vector3.scale(cameraForward,-1,Matrix4x4._tempVector1);Matrix4x4._tempVector1.cloneTo(Matrix4x4._tempVector0);}else {Vector3.scale(Matrix4x4._tempVector0,1/Math.sqrt(lengthSq),Matrix4x4._tempVector0);}Vector3.cross(cameraUp,Matrix4x4._tempVector0,Matrix4x4._tempVector2);Vector3.normalize(Matrix4x4._tempVector2,Matrix4x4._tempVector2);Vector3.cross(Matrix4x4._tempVector0,Matrix4x4._tempVector2,Matrix4x4._tempVector3);var crosse=Matrix4x4._tempVector2;var finale=Matrix4x4._tempVector3;var diffee=Matrix4x4._tempVector0;var obpose=objectPosition;var mate=mat.elements;mate[0]=crosse.x;mate[1]=crosse.y;mate[2]=crosse.z;mate[3]=0.0;mate[4]=finale.x;mate[5]=finale.y;mate[6]=finale.z;mate[7]=0.0;mate[8]=diffee.x;mate[9]=diffee.y;mate[10]=diffee.z;mate[11]=0.0;mate[12]=obpose.x;mate[13]=obpose.y;mate[14]=obpose.z;mate[15]=1.0;};_proto6.identity=function identity(){var e=this.elements;e[1]=e[2]=e[3]=e[4]=e[6]=e[7]=e[8]=e[9]=e[11]=e[12]=e[13]=e[14]=0;e[0]=e[5]=e[10]=e[15]=1;};_proto6.cloneTo=function cloneTo(destObject){var i,s,d;s=this.elements;d=destObject.elements;if(s===d){return;}for(i=0;i<16;++i){d[i]=s[i];}};_proto6.clone=function clone(){var dest=new Matrix4x4();this.cloneTo(dest);return dest;};Matrix4x4.translation=function translation(v3,out){var oe=out.elements;oe[0]=oe[5]=oe[10]=oe[15]=1;oe[12]=v3.x;oe[13]=v3.y;oe[14]=v3.z;};_proto6.getTranslationVector=function getTranslationVector(out){var me=this.elements;out.x=me[12];out.y=me[13];out.z=me[14];};_proto6.setTranslationVector=function setTranslationVector(translate){var me=this.elements;var ve=translate;me[12]=ve.x;me[13]=ve.y;me[14]=ve.z;};_proto6.getForward=function getForward(out){var me=this.elements;out.x=-me[8];out.y=-me[9];out.z=-me[10];};_proto6.setForward=function setForward(forward){var me=this.elements;me[8]=-forward.x;me[9]=-forward.y;me[10]=-forward.z;};return Matrix4x4;}();Matrix4x4._tempMatrix4x4=new Matrix4x4();Matrix4x4.TEMPMatrix0=new Matrix4x4();Matrix4x4.TEMPMatrix1=new Matrix4x4();Matrix4x4._tempVector0=new Vector3();Matrix4x4._tempVector1=new Vector3();Matrix4x4._tempVector2=new Vector3();Matrix4x4._tempVector3=new Vector3();Matrix4x4._tempQuaternion=new Quaternion();Matrix4x4.DEFAULT=new Matrix4x4();Matrix4x4.ZERO=new Matrix4x4(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var ColliderShape=/*#__PURE__*/function(){function ColliderShape(){this._scale=new Vector3(1,1,1);this._centerMatrix=new Matrix4x4();this._attatched=false;this._indexInCompound=-1;this._compoundParent=null;this._attatchedCollisionObject=null;this._referenceCount=0;this._localOffset=new Vector3(0,0,0);this._localRotation=new Quaternion(0,0,0,1);this.needsCustomCollisionCallback=false;}ColliderShape.__init__=function __init__(){var bt=ILaya3D.Physics3D._bullet;ColliderShape._btScale=bt.btVector3_create(1,1,1);ColliderShape._btVector30=bt.btVector3_create(0,0,0);ColliderShape._btQuaternion0=bt.btQuaternion_create(0,0,0,1);ColliderShape._btTransform0=bt.btTransform_create();};ColliderShape._createAffineTransformation=function _createAffineTransformation(trans,rot,outE){var x=rot.x,y=rot.y,z=rot.z,w=rot.w,x2=x+x,y2=y+y,z2=z+z;var xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2;var wx=w*x2,wy=w*y2,wz=w*z2;outE[0]=1-(yy+zz);outE[1]=xy+wz;outE[2]=xz-wy;outE[3]=0;outE[4]=xy-wz;outE[5]=1-(xx+zz);outE[6]=yz+wx;outE[7]=0;outE[8]=xz+wy;outE[9]=yz-wx;outE[10]=1-(xx+yy);outE[11]=0;outE[12]=trans.x;outE[13]=trans.y;outE[14]=trans.z;outE[15]=1;};var _proto7=ColliderShape.prototype;_proto7._setScale=function _setScale(value){if(this._compoundParent){this.updateLocalTransformations();}else {var bt=ILaya3D.Physics3D._bullet;bt.btVector3_setValue(ColliderShape._btScale,value.x,value.y,value.z);bt.btCollisionShape_setLocalScaling(this._btShape,ColliderShape._btScale);}};_proto7._addReference=function _addReference(){this._referenceCount++;};_proto7._removeReference=function _removeReference(){this._referenceCount--;};_proto7.updateLocalTransformations=function updateLocalTransformations(){if(this._compoundParent){var offset=ColliderShape._tempVector30;Vector3.multiply(this.localOffset,this._scale,offset);ColliderShape._createAffineTransformation(offset,this.localRotation,this._centerMatrix.elements);}else {ColliderShape._createAffineTransformation(this.localOffset,this.localRotation,this._centerMatrix.elements);}};_proto7.cloneTo=function cloneTo(destObject){var destColliderShape=destObject;this._localOffset.cloneTo(destColliderShape.localOffset);this._localRotation.cloneTo(destColliderShape.localRotation);destColliderShape.localOffset=destColliderShape.localOffset;destColliderShape.localRotation=destColliderShape.localRotation;};_proto7.clone=function clone(){return null;};_proto7.destroy=function destroy(){if(this._btShape){ILaya3D.Physics3D._bullet.btCollisionShape_destroy(this._btShape);this._btShape=null;}};_createClass(ColliderShape,[{key:"type",get:function get(){return this._type;}},{key:"localOffset",get:function get(){return this._localOffset;},set:function set(value){this._localOffset=value;if(this._compoundParent)this._compoundParent._updateChildTransform(this);}},{key:"localRotation",get:function get(){return this._localRotation;},set:function set(value){this._localRotation=value;if(this._compoundParent)this._compoundParent._updateChildTransform(this);}}]);return ColliderShape;}();ColliderShape.SHAPEORIENTATION_UPX=0;ColliderShape.SHAPEORIENTATION_UPY=1;ColliderShape.SHAPEORIENTATION_UPZ=2;ColliderShape.SHAPETYPES_BOX=0;ColliderShape.SHAPETYPES_SPHERE=1;ColliderShape.SHAPETYPES_CYLINDER=2;ColliderShape.SHAPETYPES_CAPSULE=3;ColliderShape.SHAPETYPES_CONVEXHULL=4;ColliderShape.SHAPETYPES_COMPOUND=5;ColliderShape.SHAPETYPES_STATICPLANE=6;ColliderShape.SHAPETYPES_CONE=7;ColliderShape._tempVector30=new Vector3();var StaticPlaneColliderShape=/*#__PURE__*/function(_ColliderShape){_inheritsLoose(StaticPlaneColliderShape,_ColliderShape);function StaticPlaneColliderShape(normal,offset){var _this;_this=_ColliderShape.call(this)||this;_this._normal=normal;_this._offset=offset;_this._type=ColliderShape.SHAPETYPES_STATICPLANE;var bt=ILaya3D.Physics3D._bullet;bt.btVector3_setValue(StaticPlaneColliderShape._btNormal,-normal.x,normal.y,normal.z);_this._btShape=bt.btStaticPlaneShape_create(StaticPlaneColliderShape._btNormal,offset);return _this;}StaticPlaneColliderShape.__init__=function __init__(){StaticPlaneColliderShape._btNormal=ILaya3D.Physics3D._bullet.btVector3_create(0,0,0);};var _proto8=StaticPlaneColliderShape.prototype;_proto8.clone=function clone(){var dest=new StaticPlaneColliderShape(this._normal,this._offset);this.cloneTo(dest);return dest;};return StaticPlaneColliderShape;}(ColliderShape);var CompoundColliderShape=/*#__PURE__*/function(_ColliderShape2){_inheritsLoose(CompoundColliderShape,_ColliderShape2);function CompoundColliderShape(){var _this2;_this2=_ColliderShape2.call(this)||this;_this2._childColliderShapes=[];_this2._type=ColliderShape.SHAPETYPES_COMPOUND;_this2._btShape=ILaya3D.Physics3D._bullet.btCompoundShape_create();return _this2;}CompoundColliderShape.__init__=function __init__(){var bt=ILaya3D.Physics3D._bullet;CompoundColliderShape._btVector3One=bt.btVector3_create(1,1,1);CompoundColliderShape._btTransform=bt.btTransform_create();CompoundColliderShape._btOffset=bt.btVector3_create(0,0,0);CompoundColliderShape._btRotation=bt.btQuaternion_create(0,0,0,1);};var _proto9=CompoundColliderShape.prototype;_proto9._clearChildShape=function _clearChildShape(shape){shape._attatched=false;shape._compoundParent=null;shape._indexInCompound=-1;};_proto9._addReference=function _addReference(){};_proto9._removeReference=function _removeReference(){};_proto9._updateChildTransform=function _updateChildTransform(shape){var bt=ILaya3D.Physics3D._bullet;var offset=shape.localOffset;var rotation=shape.localRotation;var btOffset=ColliderShape._btVector30;var btQuaternion=ColliderShape._btQuaternion0;var btTransform=ColliderShape._btTransform0;bt.btVector3_setValue(btOffset,-offset.x,offset.y,offset.z);bt.btQuaternion_setValue(btQuaternion,-rotation.x,rotation.y,rotation.z,-rotation.w);bt.btTransform_setOrigin(btTransform,btOffset);bt.btTransform_setRotation(btTransform,btQuaternion);bt.btCompoundShape_updateChildTransform(this._btShape,shape._indexInCompound,btTransform,true);};_proto9.addChildShape=function addChildShape(shape){if(shape._attatched)throw "CompoundColliderShape: this shape has attatched to other entity.";shape._attatched=true;shape._compoundParent=this;shape._indexInCompound=this._childColliderShapes.length;this._childColliderShapes.push(shape);var offset=shape.localOffset;var rotation=shape.localRotation;var bt=ILaya3D.Physics3D._bullet;bt.btVector3_setValue(CompoundColliderShape._btOffset,-offset.x,offset.y,offset.z);bt.btQuaternion_setValue(CompoundColliderShape._btRotation,-rotation.x,rotation.y,rotation.z,-rotation.w);bt.btTransform_setOrigin(CompoundColliderShape._btTransform,CompoundColliderShape._btOffset);bt.btTransform_setRotation(CompoundColliderShape._btTransform,CompoundColliderShape._btRotation);var btScale=bt.btCollisionShape_getLocalScaling(this._btShape);bt.btCollisionShape_setLocalScaling(this._btShape,CompoundColliderShape._btVector3One);bt.btCompoundShape_addChildShape(this._btShape,CompoundColliderShape._btTransform,shape._btShape);bt.btCollisionShape_setLocalScaling(this._btShape,btScale);this._attatchedCollisionObject&&(this._attatchedCollisionObject.colliderShape=this);};_proto9.removeChildShape=function removeChildShape(shape){if(shape._compoundParent===this){var index=shape._indexInCompound;this._clearChildShape(shape);var endShape=this._childColliderShapes[this._childColliderShapes.length-1];endShape._indexInCompound=index;this._childColliderShapes[index]=endShape;this._childColliderShapes.pop();ILaya3D.Physics3D._bullet.btCompoundShape_removeChildShapeByIndex(this._btShape,index);}};_proto9.clearChildShape=function clearChildShape(){for(var i=0,n=this._childColliderShapes.length;i<n;i++){this._clearChildShape(this._childColliderShapes[i]);ILaya3D.Physics3D._bullet.btCompoundShape_removeChildShapeByIndex(this._btShape,0);}this._childColliderShapes.length=0;};_proto9.getChildShapeCount=function getChildShapeCount(){return this._childColliderShapes.length;};_proto9.cloneTo=function cloneTo(destObject){var destCompoundColliderShape=destObject;destCompoundColliderShape.clearChildShape();for(var i=0,n=this._childColliderShapes.length;i<n;i++){destCompoundColliderShape.addChildShape(this._childColliderShapes[i].clone());}};_proto9.clone=function clone(){var dest=new CompoundColliderShape();this.cloneTo(dest);return dest;};_proto9.destroy=function destroy(){_ColliderShape2.prototype.destroy.call(this);for(var i=0,n=this._childColliderShapes.length;i<n;i++){var childShape=this._childColliderShapes[i];if(childShape._referenceCount===0)childShape.destroy();}};return CompoundColliderShape;}(ColliderShape);var Transform3D=/*#__PURE__*/function(_Laya$EventDispatcher){_inheritsLoose(Transform3D,_Laya$EventDispatcher);function Transform3D(owner){var _this3;_this3=_Laya$EventDispatcher.call(this)||this;_this3._localPosition=new Vector3(0,0,0);_this3._localRotation=new Quaternion(0,0,0,1);_this3._localScale=new Vector3(1,1,1);_this3._localRotationEuler=new Vector3(0,0,0);_this3._localMatrix=new Matrix4x4();_this3._position=new Vector3(0,0,0);_this3._rotation=new Quaternion(0,0,0,1);_this3._scale=new Vector3(1,1,1);_this3._rotationEuler=new Vector3(0,0,0);_this3._worldMatrix=new Matrix4x4();_this3._children=null;_this3._parent=null;_this3._dummy=null;_this3._transformFlag=0;_this3._owner=owner;_this3._children=[];_this3._setTransformFlag(Transform3D.TRANSFORM_LOCALQUATERNION|Transform3D.TRANSFORM_LOCALEULER|Transform3D.TRANSFORM_LOCALMATRIX,false);_this3._setTransformFlag(Transform3D.TRANSFORM_WORLDPOSITION|Transform3D.TRANSFORM_WORLDQUATERNION|Transform3D.TRANSFORM_WORLDEULER|Transform3D.TRANSFORM_WORLDSCALE|Transform3D.TRANSFORM_WORLDMATRIX,true);return _this3;}var _proto10=Transform3D.prototype;_proto10._getScaleMatrix=function _getScaleMatrix(){var invRotation=Transform3D._tempQuaternion0;var invRotationMat=Transform3D._tempMatrix3x30;var worldRotScaMat=Transform3D._tempMatrix3x31;var scaMat=Transform3D._tempMatrix3x32;Matrix3x3.createFromMatrix4x4(this.worldMatrix,worldRotScaMat);this.rotation.invert(invRotation);Matrix3x3.createRotationQuaternion(invRotation,invRotationMat);Matrix3x3.multiply(invRotationMat,worldRotScaMat,scaMat);return scaMat;};_proto10._setTransformFlag=function _setTransformFlag(type,value){if(value)this._transformFlag|=type;else this._transformFlag&=~type;};_proto10._getTransformFlag=function _getTransformFlag(type){return (this._transformFlag&type)!=0;};_proto10._setParent=function _setParent(value){if(this._parent!==value){if(this._parent){var parentChilds=this._parent._children;var index=parentChilds.indexOf(this);parentChilds.splice(index,1);}if(value){value._children.push(this);value&&this._onWorldTransform();}this._parent=value;}};_proto10._onWorldPositionRotationTransform=function _onWorldPositionRotationTransform(){if(!this._getTransformFlag(Transform3D.TRANSFORM_WORLDMATRIX)||!this._getTransformFlag(Transform3D.TRANSFORM_WORLDPOSITION)||!this._getTransformFlag(Transform3D.TRANSFORM_WORLDQUATERNION)||!this._getTransformFlag(Transform3D.TRANSFORM_WORLDEULER)){this._setTransformFlag(Transform3D.TRANSFORM_WORLDMATRIX|Transform3D.TRANSFORM_WORLDPOSITION|Transform3D.TRANSFORM_WORLDQUATERNION|Transform3D.TRANSFORM_WORLDEULER,true);this.event(Laya.Event.TRANSFORM_CHANGED,this._transformFlag);for(var i=0,n=this._children.length;i<n;i++){this._children[i]._onWorldPositionRotationTransform();}}};_proto10._onWorldPositionScaleTransform=function _onWorldPositionScaleTransform(){if(!this._getTransformFlag(Transform3D.TRANSFORM_WORLDMATRIX)||!this._getTransformFlag(Transform3D.TRANSFORM_WORLDPOSITION)||!this._getTransformFlag(Transform3D.TRANSFORM_WORLDSCALE)){this._setTransformFlag(Transform3D.TRANSFORM_WORLDMATRIX|Transform3D.TRANSFORM_WORLDPOSITION|Transform3D.TRANSFORM_WORLDSCALE,true);this.event(Laya.Event.TRANSFORM_CHANGED,this._transformFlag);for(var i=0,n=this._children.length;i<n;i++){this._children[i]._onWorldPositionScaleTransform();}}};_proto10._onWorldPositionTransform=function _onWorldPositionTransform(){if(!this._getTransformFlag(Transform3D.TRANSFORM_WORLDMATRIX)||!this._getTransformFlag(Transform3D.TRANSFORM_WORLDPOSITION)){this._setTransformFlag(Transform3D.TRANSFORM_WORLDMATRIX|Transform3D.TRANSFORM_WORLDPOSITION,true);this.event(Laya.Event.TRANSFORM_CHANGED,this._transformFlag);for(var i=0,n=this._children.length;i<n;i++){this._children[i]._onWorldPositionTransform();}}};_proto10._onWorldRotationTransform=function _onWorldRotationTransform(){if(!this._getTransformFlag(Transform3D.TRANSFORM_WORLDMATRIX)||!this._getTransformFlag(Transform3D.TRANSFORM_WORLDQUATERNION)||!this._getTransformFlag(Transform3D.TRANSFORM_WORLDEULER)){this._setTransformFlag(Transform3D.TRANSFORM_WORLDMATRIX|Transform3D.TRANSFORM_WORLDQUATERNION|Transform3D.TRANSFORM_WORLDEULER,true);this.event(Laya.Event.TRANSFORM_CHANGED,this._transformFlag);for(var i=0,n=this._children.length;i<n;i++){this._children[i]._onWorldPositionRotationTransform();}}};_proto10._onWorldScaleTransform=function _onWorldScaleTransform(){if(!this._getTransformFlag(Transform3D.TRANSFORM_WORLDMATRIX)||!this._getTransformFlag(Transform3D.TRANSFORM_WORLDSCALE)){this._setTransformFlag(Transform3D.TRANSFORM_WORLDMATRIX|Transform3D.TRANSFORM_WORLDSCALE,true);this.event(Laya.Event.TRANSFORM_CHANGED,this._transformFlag);for(var i=0,n=this._children.length;i<n;i++){this._children[i]._onWorldPositionScaleTransform();}}};_proto10._onWorldTransform=function _onWorldTransform(){if(!this._getTransformFlag(Transform3D.TRANSFORM_WORLDMATRIX)||!this._getTransformFlag(Transform3D.TRANSFORM_WORLDPOSITION)||!this._getTransformFlag(Transform3D.TRANSFORM_WORLDQUATERNION)||!this._getTransformFlag(Transform3D.TRANSFORM_WORLDEULER)||!this._getTransformFlag(Transform3D.TRANSFORM_WORLDSCALE)){this._setTransformFlag(Transform3D.TRANSFORM_WORLDMATRIX|Transform3D.TRANSFORM_WORLDPOSITION|Transform3D.TRANSFORM_WORLDQUATERNION|Transform3D.TRANSFORM_WORLDEULER|Transform3D.TRANSFORM_WORLDSCALE,true);this.event(Laya.Event.TRANSFORM_CHANGED,this._transformFlag);for(var i=0,n=this._children.length;i<n;i++){this._children[i]._onWorldTransform();}}};_proto10.translate=function translate(translation,isLocal){if(isLocal===void 0){isLocal=true;}if(isLocal){Matrix4x4.createFromQuaternion(this.localRotation,Transform3D._tempMatrix0);Vector3.transformCoordinate(translation,Transform3D._tempMatrix0,Transform3D._tempVector30);Vector3.add(this.localPosition,Transform3D._tempVector30,this._localPosition);this.localPosition=this._localPosition;}else {Vector3.add(this.position,translation,this._position);this.position=this._position;}};_proto10.rotate=function rotate(rotation,isLocal,isRadian){if(isLocal===void 0){isLocal=true;}if(isRadian===void 0){isRadian=true;}var rot;if(isRadian){rot=rotation;}else {Vector3.scale(rotation,Math.PI/180.0,Transform3D._tempVector30);rot=Transform3D._tempVector30;}Quaternion.createFromYawPitchRoll(rot.y,rot.x,rot.z,Transform3D._tempQuaternion0);if(isLocal){Quaternion.multiply(this._localRotation,Transform3D._tempQuaternion0,this._localRotation);this.localRotation=this._localRotation;}else {Quaternion.multiply(Transform3D._tempQuaternion0,this.rotation,this._rotation);this.rotation=this._rotation;}};_proto10.getForward=function getForward(forward){var worldMatElem=this.worldMatrix.elements;forward.x=-worldMatElem[8];forward.y=-worldMatElem[9];forward.z=-worldMatElem[10];};_proto10.getUp=function getUp(up){var worldMatElem=this.worldMatrix.elements;up.x=worldMatElem[4];up.y=worldMatElem[5];up.z=worldMatElem[6];};_proto10.getRight=function getRight(right){var worldMatElem=this.worldMatrix.elements;right.x=worldMatElem[0];right.y=worldMatElem[1];right.z=worldMatElem[2];};_proto10.lookAt=function lookAt(target,up,isLocal){if(isLocal===void 0){isLocal=false;}var eye;if(isLocal){eye=this._localPosition;if(Math.abs(eye.x-target.x)<MathUtils3D.zeroTolerance&&Math.abs(eye.y-target.y)<MathUtils3D.zeroTolerance&&Math.abs(eye.z-target.z)<MathUtils3D.zeroTolerance)return;Quaternion.lookAt(this._localPosition,target,up,this._localRotation);this._localRotation.invert(this._localRotation);this.localRotation=this._localRotation;}else {var worldPosition=this.position;eye=worldPosition;if(Math.abs(eye.x-target.x)<MathUtils3D.zeroTolerance&&Math.abs(eye.y-target.y)<MathUtils3D.zeroTolerance&&Math.abs(eye.z-target.z)<MathUtils3D.zeroTolerance)return;Quaternion.lookAt(worldPosition,target,up,this._rotation);this._rotation.invert(this._rotation);this.rotation=this._rotation;}};_proto10.getWorldLossyScale=function getWorldLossyScale(){if(this._getTransformFlag(Transform3D.TRANSFORM_WORLDSCALE)){if(this._parent!==null){var scaMatE=this._getScaleMatrix().elements;this._scale.x=scaMatE[0];this._scale.y=scaMatE[4];this._scale.z=scaMatE[8];}else {this._localScale.cloneTo(this._scale);}this._setTransformFlag(Transform3D.TRANSFORM_WORLDSCALE,false);}return this._scale;};_proto10.setWorldLossyScale=function setWorldLossyScale(value){if(this._parent!==null){var scaleMat=Transform3D._tempMatrix3x33;var localScaleMat=Transform3D._tempMatrix3x33;var localScaleMatE=localScaleMat.elements;var parInvScaleMat=this._parent._getScaleMatrix();parInvScaleMat.invert(parInvScaleMat);Matrix3x3.createFromScaling(value,scaleMat);Matrix3x3.multiply(parInvScaleMat,scaleMat,localScaleMat);this._localScale.x=localScaleMatE[0];this._localScale.y=localScaleMatE[4];this._localScale.z=localScaleMatE[8];}else {value.cloneTo(this._localScale);}this.localScale=this._localScale;if(this._scale!==value)value.cloneTo(this._scale);this._setTransformFlag(Transform3D.TRANSFORM_WORLDSCALE,false);};_createClass(Transform3D,[{key:"_isFrontFaceInvert",get:function get(){var scale=this.getWorldLossyScale();var isInvert=scale.x<0;scale.y<0&&(isInvert=!isInvert);scale.z<0&&(isInvert=!isInvert);return isInvert;}},{key:"owner",get:function get(){return this._owner;}},{key:"worldNeedUpdate",get:function get(){return this._getTransformFlag(Transform3D.TRANSFORM_WORLDMATRIX);}},{key:"localPositionX",get:function get(){return this._localPosition.x;},set:function set(x){this._localPosition.x=x;this.localPosition=this._localPosition;}},{key:"localPositionY",get:function get(){return this._localPosition.y;},set:function set(y){this._localPosition.y=y;this.localPosition=this._localPosition;}},{key:"localPositionZ",get:function get(){return this._localPosition.z;},set:function set(z){this._localPosition.z=z;this.localPosition=this._localPosition;}},{key:"localPosition",get:function get(){return this._localPosition;},set:function set(value){if(this._localPosition!==value)value.cloneTo(this._localPosition);this._setTransformFlag(Transform3D.TRANSFORM_LOCALMATRIX,true);this._onWorldPositionTransform();}},{key:"localRotationX",get:function get(){return this.localRotation.x;},set:function set(x){this._localRotation.x=x;this.localRotation=this._localRotation;}},{key:"localRotationY",get:function get(){return this.localRotation.y;},set:function set(y){this._localRotation.y=y;this.localRotation=this._localRotation;}},{key:"localRotationZ",get:function get(){return this.localRotation.z;},set:function set(z){this._localRotation.z=z;this.localRotation=this._localRotation;}},{key:"localRotationW",get:function get(){return this.localRotation.w;},set:function set(w){this._localRotation.w=w;this.localRotation=this._localRotation;}},{key:"localRotation",get:function get(){if(this._getTransformFlag(Transform3D.TRANSFORM_LOCALQUATERNION)){var eulerE=this._localRotationEuler;Quaternion.createFromYawPitchRoll(eulerE.y/Transform3D._angleToRandin,eulerE.x/Transform3D._angleToRandin,eulerE.z/Transform3D._angleToRandin,this._localRotation);this._setTransformFlag(Transform3D.TRANSFORM_LOCALQUATERNION,false);}return this._localRotation;},set:function set(value){if(this._localRotation!==value)value.cloneTo(this._localRotation);this._localRotation.normalize(this._localRotation);this._setTransformFlag(Transform3D.TRANSFORM_LOCALEULER|Transform3D.TRANSFORM_LOCALMATRIX,true);this._setTransformFlag(Transform3D.TRANSFORM_LOCALQUATERNION,false);this._onWorldRotationTransform();}},{key:"localScaleX",get:function get(){return this._localScale.x;},set:function set(value){this._localScale.x=value;this.localScale=this._localScale;}},{key:"localScaleY",get:function get(){return this._localScale.y;},set:function set(value){this._localScale.y=value;this.localScale=this._localScale;}},{key:"localScaleZ",get:function get(){return this._localScale.z;},set:function set(value){this._localScale.z=value;this.localScale=this._localScale;}},{key:"localScale",get:function get(){return this._localScale;},set:function set(value){if(this._localScale!==value)value.cloneTo(this._localScale);this._setTransformFlag(Transform3D.TRANSFORM_LOCALMATRIX,true);this._onWorldScaleTransform();}},{key:"localRotationEulerX",get:function get(){return this.localRotationEuler.x;},set:function set(value){this._localRotationEuler.x=value;this.localRotationEuler=this._localRotationEuler;}},{key:"localRotationEulerY",get:function get(){return this.localRotationEuler.y;},set:function set(value){this._localRotationEuler.y=value;this.localRotationEuler=this._localRotationEuler;}},{key:"localRotationEulerZ",get:function get(){return this.localRotationEuler.z;},set:function set(value){this._localRotationEuler.z=value;this.localRotationEuler=this._localRotationEuler;}},{key:"localRotationEuler",get:function get(){if(this._getTransformFlag(Transform3D.TRANSFORM_LOCALEULER)){this._localRotation.getYawPitchRoll(Transform3D._tempVector30);var euler=Transform3D._tempVector30;var localRotationEuler=this._localRotationEuler;localRotationEuler.x=euler.y*Transform3D._angleToRandin;localRotationEuler.y=euler.x*Transform3D._angleToRandin;localRotationEuler.z=euler.z*Transform3D._angleToRandin;this._setTransformFlag(Transform3D.TRANSFORM_LOCALEULER,false);}return this._localRotationEuler;},set:function set(value){if(this._localRotationEuler!==value)value.cloneTo(this._localRotationEuler);this._setTransformFlag(Transform3D.TRANSFORM_LOCALEULER,false);this._setTransformFlag(Transform3D.TRANSFORM_LOCALQUATERNION|Transform3D.TRANSFORM_LOCALMATRIX,true);this._onWorldRotationTransform();}},{key:"localMatrix",get:function get(){if(this._getTransformFlag(Transform3D.TRANSFORM_LOCALMATRIX)){Matrix4x4.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);this._setTransformFlag(Transform3D.TRANSFORM_LOCALMATRIX,false);}return this._localMatrix;},set:function set(value){if(this._localMatrix!==value)value.cloneTo(this._localMatrix);this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale);this._setTransformFlag(Transform3D.TRANSFORM_LOCALEULER,true);this._setTransformFlag(Transform3D.TRANSFORM_LOCALMATRIX,false);this._onWorldTransform();}},{key:"position",get:function get(){if(this._getTransformFlag(Transform3D.TRANSFORM_WORLDPOSITION)){if(this._parent!=null){var worldMatE=this.worldMatrix.elements;this._position.x=worldMatE[12];this._position.y=worldMatE[13];this._position.z=worldMatE[14];}else {this._localPosition.cloneTo(this._position);}this._setTransformFlag(Transform3D.TRANSFORM_WORLDPOSITION,false);}return this._position;},set:function set(value){if(this._parent!=null){var parentInvMat=Transform3D._tempMatrix0;this._parent.worldMatrix.invert(parentInvMat);Vector3.transformCoordinate(value,parentInvMat,this._localPosition);}else {value.cloneTo(this._localPosition);}this.localPosition=this._localPosition;if(this._position!==value)value.cloneTo(this._position);this._setTransformFlag(Transform3D.TRANSFORM_WORLDPOSITION,false);}},{key:"rotation",get:function get(){if(this._getTransformFlag(Transform3D.TRANSFORM_WORLDQUATERNION)){if(this._parent!=null)Quaternion.multiply(this._parent.rotation,this.localRotation,this._rotation);else this.localRotation.cloneTo(this._rotation);this._setTransformFlag(Transform3D.TRANSFORM_WORLDQUATERNION,false);}return this._rotation;},set:function set(value){if(this._parent!=null){this._parent.rotation.invert(Transform3D._tempQuaternion0);Quaternion.multiply(Transform3D._tempQuaternion0,value,this._localRotation);}else {value.cloneTo(this._localRotation);}this.localRotation=this._localRotation;if(value!==this._rotation)value.cloneTo(this._rotation);this._setTransformFlag(Transform3D.TRANSFORM_WORLDQUATERNION,false);}},{key:"rotationEuler",get:function get(){if(this._getTransformFlag(Transform3D.TRANSFORM_WORLDEULER)){this.rotation.getYawPitchRoll(Transform3D._tempVector30);var eulerE=Transform3D._tempVector30;var rotationEulerE=this._rotationEuler;rotationEulerE.x=eulerE.y*Transform3D._angleToRandin;rotationEulerE.y=eulerE.x*Transform3D._angleToRandin;rotationEulerE.z=eulerE.z*Transform3D._angleToRandin;this._setTransformFlag(Transform3D.TRANSFORM_WORLDEULER,false);}return this._rotationEuler;},set:function set(value){Quaternion.createFromYawPitchRoll(value.y/Transform3D._angleToRandin,value.x/Transform3D._angleToRandin,value.z/Transform3D._angleToRandin,this._rotation);this.rotation=this._rotation;if(this._rotationEuler!==value)value.cloneTo(this._rotationEuler);this._setTransformFlag(Transform3D.TRANSFORM_WORLDEULER,false);}},{key:"worldMatrix",get:function get(){if(this._getTransformFlag(Transform3D.TRANSFORM_WORLDMATRIX)){if(this._parent!=null)Matrix4x4.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix);else this.localMatrix.cloneTo(this._worldMatrix);this._setTransformFlag(Transform3D.TRANSFORM_WORLDMATRIX,false);}return this._worldMatrix;},set:function set(value){if(this._parent===null){value.cloneTo(this._localMatrix);}else {this._parent.worldMatrix.invert(this._localMatrix);Matrix4x4.multiply(this._localMatrix,value,this._localMatrix);}this.localMatrix=this._localMatrix;if(this._worldMatrix!==value)value.cloneTo(this._worldMatrix);this._setTransformFlag(Transform3D.TRANSFORM_WORLDMATRIX,false);}},{key:"scale",get:function get(){console.warn("Transfrm3D: discard function,please use getWorldLossyScale instead.");return this.getWorldLossyScale();},set:function set(value){console.warn("Transfrm3D: discard function,please use setWorldLossyScale instead.");this.setWorldLossyScale(value);}}]);return Transform3D;}(Laya.EventDispatcher);Transform3D._tempVector30=new Vector3();Transform3D._tempQuaternion0=new Quaternion();Transform3D._tempMatrix0=new Matrix4x4();Transform3D._tempMatrix3x30=new Matrix3x3();Transform3D._tempMatrix3x31=new Matrix3x3();Transform3D._tempMatrix3x32=new Matrix3x3();Transform3D._tempMatrix3x33=new Matrix3x3();Transform3D.TRANSFORM_LOCALQUATERNION=0x01;Transform3D.TRANSFORM_LOCALEULER=0x02;Transform3D.TRANSFORM_LOCALMATRIX=0x04;Transform3D.TRANSFORM_WORLDPOSITION=0x08;Transform3D.TRANSFORM_WORLDQUATERNION=0x10;Transform3D.TRANSFORM_WORLDSCALE=0x20;Transform3D.TRANSFORM_WORLDMATRIX=0x40;Transform3D.TRANSFORM_WORLDEULER=0x80;Transform3D._angleToRandin=180/Math.PI;var Physics3DUtils=/*#__PURE__*/function(){function Physics3DUtils(){}Physics3DUtils.setColliderCollision=function setColliderCollision(collider1,collider2,collsion){};Physics3DUtils.getIColliderCollision=function getIColliderCollision(collider1,collider2){return false;};return Physics3DUtils;}();Physics3DUtils.COLLISIONFILTERGROUP_DEFAULTFILTER=0x1;Physics3DUtils.COLLISIONFILTERGROUP_STATICFILTER=0x2;Physics3DUtils.COLLISIONFILTERGROUP_KINEMATICFILTER=0x4;Physics3DUtils.COLLISIONFILTERGROUP_DEBRISFILTER=0x8;Physics3DUtils.COLLISIONFILTERGROUP_SENSORTRIGGER=0x10;Physics3DUtils.COLLISIONFILTERGROUP_CHARACTERFILTER=0x20;Physics3DUtils.COLLISIONFILTERGROUP_CUSTOMFILTER1=0x40;Physics3DUtils.COLLISIONFILTERGROUP_CUSTOMFILTER2=0x80;Physics3DUtils.COLLISIONFILTERGROUP_CUSTOMFILTER3=0x100;Physics3DUtils.COLLISIONFILTERGROUP_CUSTOMFILTER4=0x200;Physics3DUtils.COLLISIONFILTERGROUP_CUSTOMFILTER5=0x400;Physics3DUtils.COLLISIONFILTERGROUP_CUSTOMFILTER6=0x800;Physics3DUtils.COLLISIONFILTERGROUP_CUSTOMFILTER7=0x1000;Physics3DUtils.COLLISIONFILTERGROUP_CUSTOMFILTER8=0x2000;Physics3DUtils.COLLISIONFILTERGROUP_CUSTOMFILTER9=0x4000;Physics3DUtils.COLLISIONFILTERGROUP_CUSTOMFILTER10=0x8000;Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER=-1;Physics3DUtils.gravity=new Vector3(0,-9.81,0);var BoxColliderShape=/*#__PURE__*/function(_ColliderShape3){_inheritsLoose(BoxColliderShape,_ColliderShape3);function BoxColliderShape(sizeX,sizeY,sizeZ){var _this4;if(sizeX===void 0){sizeX=1.0;}if(sizeY===void 0){sizeY=1.0;}if(sizeZ===void 0){sizeZ=1.0;}_this4=_ColliderShape3.call(this)||this;_this4._sizeX=sizeX;_this4._sizeY=sizeY;_this4._sizeZ=sizeZ;_this4._type=ColliderShape.SHAPETYPES_BOX;var bt=ILaya3D.Physics3D._bullet;bt.btVector3_setValue(BoxColliderShape._btSize,sizeX/2,sizeY/2,sizeZ/2);_this4._btShape=bt.btBoxShape_create(BoxColliderShape._btSize);return _this4;}BoxColliderShape.__init__=function __init__(){BoxColliderShape._btSize=ILaya3D.Physics3D._bullet.btVector3_create(0,0,0);};var _proto11=BoxColliderShape.prototype;_proto11.clone=function clone(){var dest=new BoxColliderShape(this._sizeX,this._sizeY,this._sizeZ);this.cloneTo(dest);return dest;};_createClass(BoxColliderShape,[{key:"sizeX",get:function get(){return this._sizeX;}},{key:"sizeY",get:function get(){return this._sizeY;}},{key:"sizeZ",get:function get(){return this._sizeZ;}}]);return BoxColliderShape;}(ColliderShape);var CapsuleColliderShape=/*#__PURE__*/function(_ColliderShape4){_inheritsLoose(CapsuleColliderShape,_ColliderShape4);function CapsuleColliderShape(radius,length,orientation){var _this5;if(radius===void 0){radius=0.5;}if(length===void 0){length=1.25;}if(orientation===void 0){orientation=ColliderShape.SHAPEORIENTATION_UPY;}_this5=_ColliderShape4.call(this)||this;_this5._radius=radius;_this5._length=length;_this5._orientation=orientation;_this5._type=ColliderShape.SHAPETYPES_CAPSULE;var bt=ILaya3D.Physics3D._bullet;switch(orientation){case ColliderShape.SHAPEORIENTATION_UPX:_this5._btShape=bt.btCapsuleShapeX_create(radius,length-radius*2);break;case ColliderShape.SHAPEORIENTATION_UPY:_this5._btShape=bt.btCapsuleShape_create(radius,length-radius*2);break;case ColliderShape.SHAPEORIENTATION_UPZ:_this5._btShape=bt.btCapsuleShapeZ_create(radius,length-radius*2);break;default:throw "CapsuleColliderShape:unknown orientation.";}return _this5;}var _proto12=CapsuleColliderShape.prototype;_proto12._setScale=function _setScale(value){var fixScale=CapsuleColliderShape._tempVector30;switch(this.orientation){case ColliderShape.SHAPEORIENTATION_UPX:fixScale.x=value.x;fixScale.y=fixScale.z=Math.max(value.y,value.z);break;case ColliderShape.SHAPEORIENTATION_UPY:fixScale.y=value.y;fixScale.x=fixScale.z=Math.max(value.x,value.z);break;case ColliderShape.SHAPEORIENTATION_UPZ:fixScale.z=value.z;fixScale.x=fixScale.y=Math.max(value.x,value.y);break;default:throw "CapsuleColliderShape:unknown orientation.";}_ColliderShape4.prototype._setScale.call(this,fixScale);};_proto12.clone=function clone(){var dest=new CapsuleColliderShape(this._radius,this._length,this._orientation);this.cloneTo(dest);return dest;};_createClass(CapsuleColliderShape,[{key:"radius",get:function get(){return this._radius;}},{key:"length",get:function get(){return this._length;}},{key:"orientation",get:function get(){return this._orientation;}}]);return CapsuleColliderShape;}(ColliderShape);CapsuleColliderShape._tempVector30=new Vector3();var ConeColliderShape=/*#__PURE__*/function(_ColliderShape5){_inheritsLoose(ConeColliderShape,_ColliderShape5);function ConeColliderShape(radius,height,orientation){var _this6;if(radius===void 0){radius=0.5;}if(height===void 0){height=1.0;}if(orientation===void 0){orientation=ColliderShape.SHAPEORIENTATION_UPY;}_this6=_ColliderShape5.call(this)||this;_this6._radius=1;_this6._height=0.5;_this6._radius=radius;_this6._height=height;_this6._orientation=orientation;_this6._type=ColliderShape.SHAPETYPES_CYLINDER;var bt=ILaya3D.Physics3D._bullet;switch(orientation){case ColliderShape.SHAPEORIENTATION_UPX:_this6._btShape=bt.btConeShapeX_create(radius,height);break;case ColliderShape.SHAPEORIENTATION_UPY:_this6._btShape=bt.btConeShape_create(radius,height);break;case ColliderShape.SHAPEORIENTATION_UPZ:_this6._btShape=bt.btConeShapeZ_create(radius,height);break;default:throw "ConeColliderShape:unknown orientation.";}return _this6;}var _proto13=ConeColliderShape.prototype;_proto13.clone=function clone(){var dest=new ConeColliderShape(this._radius,this._height,this._orientation);this.cloneTo(dest);return dest;};_createClass(ConeColliderShape,[{key:"radius",get:function get(){return this._radius;}},{key:"height",get:function get(){return this._height;}},{key:"orientation",get:function get(){return this._orientation;}}]);return ConeColliderShape;}(ColliderShape);var CylinderColliderShape=/*#__PURE__*/function(_ColliderShape6){_inheritsLoose(CylinderColliderShape,_ColliderShape6);function CylinderColliderShape(radius,height,orientation){var _this7;if(radius===void 0){radius=0.5;}if(height===void 0){height=1.0;}if(orientation===void 0){orientation=ColliderShape.SHAPEORIENTATION_UPY;}_this7=_ColliderShape6.call(this)||this;_this7._radius=1;_this7._height=0.5;_this7._radius=radius;_this7._height=height;_this7._orientation=orientation;_this7._type=ColliderShape.SHAPETYPES_CYLINDER;var bt=ILaya3D.Physics3D._bullet;switch(orientation){case ColliderShape.SHAPEORIENTATION_UPX:bt.btVector3_setValue(CylinderColliderShape._btSize,height/2,radius,radius);_this7._btShape=bt.btCylinderShapeX_create(CylinderColliderShape._btSize);break;case ColliderShape.SHAPEORIENTATION_UPY:bt.btVector3_setValue(CylinderColliderShape._btSize,radius,height/2,radius);_this7._btShape=bt.btCylinderShape_create(CylinderColliderShape._btSize);break;case ColliderShape.SHAPEORIENTATION_UPZ:bt.btVector3_setValue(CylinderColliderShape._btSize,radius,radius,height/2);_this7._btShape=bt.btCylinderShapeZ_create(CylinderColliderShape._btSize);break;default:throw "CapsuleColliderShape:unknown orientation.";}return _this7;}CylinderColliderShape.__init__=function __init__(){CylinderColliderShape._btSize=ILaya3D.Physics3D._bullet.btVector3_create(0,0,0);};var _proto14=CylinderColliderShape.prototype;_proto14.clone=function clone(){var dest=new CylinderColliderShape(this._radius,this._height,this._orientation);this.cloneTo(dest);return dest;};_createClass(CylinderColliderShape,[{key:"radius",get:function get(){return this._radius;}},{key:"height",get:function get(){return this._height;}},{key:"orientation",get:function get(){return this._orientation;}}]);return CylinderColliderShape;}(ColliderShape);var MeshColliderShape=/*#__PURE__*/function(_ColliderShape7){_inheritsLoose(MeshColliderShape,_ColliderShape7);function MeshColliderShape(){var _this8;_this8=_ColliderShape7.call(this)||this;_this8._mesh=null;_this8._convex=false;return _this8;}var _proto15=MeshColliderShape.prototype;_proto15._setScale=function _setScale(value){if(this._compoundParent){this.updateLocalTransformations();}else {var bt=ILaya3D.Physics3D._bullet;bt.btVector3_setValue(ColliderShape._btScale,value.x,value.y,value.z);bt.btCollisionShape_setLocalScaling(this._btShape,ColliderShape._btScale);bt.btGImpactShapeInterface_updateBound(this._btShape);}};_proto15.cloneTo=function cloneTo(destObject){var destMeshCollider=destObject;destMeshCollider.convex=this._convex;destMeshCollider.mesh=this._mesh;_ColliderShape7.prototype.cloneTo.call(this,destObject);};_proto15.clone=function clone(){var dest=new MeshColliderShape();this.cloneTo(dest);return dest;};_proto15.destroy=function destroy(){if(this._btShape){ILaya3D.Physics3D._bullet.btCollisionShape_destroy(this._btShape);this._btShape=null;}};_createClass(MeshColliderShape,[{key:"mesh",get:function get(){return this._mesh;},set:function set(value){if(this._mesh!==value){var bt=ILaya3D.Physics3D._bullet;if(this._mesh){bt.btCollisionShape_destroy(this._btShape);}if(value){this._btShape=bt.btGImpactMeshShape_create(value._getPhysicMesh());bt.btGImpactShapeInterface_updateBound(this._btShape);}this._mesh=value;}}},{key:"convex",get:function get(){return this._convex;},set:function set(value){this._convex=value;}}]);return MeshColliderShape;}(ColliderShape);var SphereColliderShape=/*#__PURE__*/function(_ColliderShape8){_inheritsLoose(SphereColliderShape,_ColliderShape8);function SphereColliderShape(radius){var _this9;if(radius===void 0){radius=0.5;}_this9=_ColliderShape8.call(this)||this;_this9._radius=radius;_this9._type=ColliderShape.SHAPETYPES_SPHERE;_this9._btShape=ILaya3D.Physics3D._bullet.btSphereShape_create(radius);return _this9;}var _proto16=SphereColliderShape.prototype;_proto16.clone=function clone(){var dest=new SphereColliderShape(this._radius);this.cloneTo(dest);return dest;};_createClass(SphereColliderShape,[{key:"radius",get:function get(){return this._radius;}}]);return SphereColliderShape;}(ColliderShape);var PhysicsComponent=/*#__PURE__*/function(_Laya$Component){_inheritsLoose(PhysicsComponent,_Laya$Component);function PhysicsComponent(collisionGroup,canCollideWith){var _this10;_this10=_Laya$Component.call(this)||this;_this10._restitution=0.0;_this10._friction=0.5;_this10._rollingFriction=0.0;_this10._ccdMotionThreshold=0.0;_this10._ccdSweptSphereRadius=0.0;_this10._collisionGroup=Physics3DUtils.COLLISIONFILTERGROUP_DEFAULTFILTER;_this10._canCollideWith=Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER;_this10._colliderShape=null;_this10._transformFlag=2147483647;_this10._controlBySimulation=false;_this10._enableProcessCollisions=true;_this10._inPhysicUpdateListIndex=-1;_this10.canScaleShape=true;_this10._collisionGroup=collisionGroup;_this10._canCollideWith=canCollideWith;PhysicsComponent._physicObjectsMap[_this10.id]=_assertThisInitialized(_this10);return _this10;}PhysicsComponent.__init__=function __init__(){var bt=ILaya3D.Physics3D._bullet;PhysicsComponent._btVector30=bt.btVector3_create(0,0,0);PhysicsComponent._btQuaternion0=bt.btQuaternion_create(0,0,0,1);};PhysicsComponent._createAffineTransformationArray=function _createAffineTransformationArray(tranX,tranY,tranZ,rotX,rotY,rotZ,rotW,scale,outE){var x2=rotX+rotX,y2=rotY+rotY,z2=rotZ+rotZ;var xx=rotX*x2,xy=rotX*y2,xz=rotX*z2,yy=rotY*y2,yz=rotY*z2,zz=rotZ*z2;var wx=rotW*x2,wy=rotW*y2,wz=rotW*z2,sx=scale[0],sy=scale[1],sz=scale[2];outE[0]=(1-(yy+zz))*sx;outE[1]=(xy+wz)*sx;outE[2]=(xz-wy)*sx;outE[3]=0;outE[4]=(xy-wz)*sy;outE[5]=(1-(xx+zz))*sy;outE[6]=(yz+wx)*sy;outE[7]=0;outE[8]=(xz+wy)*sz;outE[9]=(yz-wx)*sz;outE[10]=(1-(xx+yy))*sz;outE[11]=0;outE[12]=tranX;outE[13]=tranY;outE[14]=tranZ;outE[15]=1;};PhysicsComponent._creatShape=function _creatShape(shapeData){var colliderShape;switch(shapeData.type){case"BoxColliderShape":var sizeData=shapeData.size;colliderShape=sizeData?new BoxColliderShape(sizeData[0],sizeData[1],sizeData[2]):new BoxColliderShape();break;case"SphereColliderShape":colliderShape=new SphereColliderShape(shapeData.radius);break;case"CapsuleColliderShape":colliderShape=new CapsuleColliderShape(shapeData.radius,shapeData.height,shapeData.orientation);break;case"MeshColliderShape":var meshCollider=new MeshColliderShape();shapeData.mesh&&(meshCollider.mesh=Laya.Loader.getRes(shapeData.mesh));colliderShape=meshCollider;break;case"ConeColliderShape":colliderShape=new ConeColliderShape(shapeData.radius,shapeData.height,shapeData.orientation);break;case"CylinderColliderShape":colliderShape=new CylinderColliderShape(shapeData.radius,shapeData.height,shapeData.orientation);break;default:throw "unknown shape type.";}if(shapeData.center){var localOffset=colliderShape.localOffset;localOffset.fromArray(shapeData.center);colliderShape.localOffset=localOffset;}return colliderShape;};PhysicsComponent.physicVector3TransformQuat=function physicVector3TransformQuat(source,qx,qy,qz,qw,out){var x=source.x,y=source.y,z=source.z,ix=qw*x+qy*z-qz*y,iy=qw*y+qz*x-qx*z,iz=qw*z+qx*y-qy*x,iw=-qx*x-qy*y-qz*z;out.x=ix*qw+iw*-qx+iy*-qz-iz*-qy;out.y=iy*qw+iw*-qy+iz*-qx-ix*-qz;out.z=iz*qw+iw*-qz+ix*-qy-iy*-qx;};PhysicsComponent.physicQuaternionMultiply=function physicQuaternionMultiply(lx,ly,lz,lw,right,out){var rx=right.x;var ry=right.y;var rz=right.z;var rw=right.w;var a=ly*rz-lz*ry;var b=lz*rx-lx*rz;var c=lx*ry-ly*rx;var d=lx*rx+ly*ry+lz*rz;out.x=lx*rw+rx*lw+a;out.y=ly*rw+ry*lw+b;out.z=lz*rw+rz*lw+c;out.w=lw*rw-d;};var _proto17=PhysicsComponent.prototype;_proto17._parseShape=function _parseShape(shapesData){var shapeCount=shapesData.length;if(shapeCount===1){var shape=PhysicsComponent._creatShape(shapesData[0]);this.colliderShape=shape;}else {var compoundShape=new CompoundColliderShape();for(var i=0;i<shapeCount;i++){shape=PhysicsComponent._creatShape(shapesData[i]);compoundShape.addChildShape(shape);}this.colliderShape=compoundShape;}};_proto17._onScaleChange=function _onScaleChange(scale){this._colliderShape._setScale(scale);};_proto17._onEnable=function _onEnable(){this._simulation=this.owner._scene.physicsSimulation;ILaya3D.Physics3D._bullet.btCollisionObject_setContactProcessingThreshold(this._btColliderObject,1e30);if(this._colliderShape){this._derivePhysicsTransformation(true);this._addToSimulation();}};_proto17._onDisable=function _onDisable(){if(this._colliderShape){this._removeFromSimulation();this._inPhysicUpdateListIndex!==-1&&this._simulation._physicsUpdateList.remove(this);}this._simulation=null;};_proto17._onDestroy=function _onDestroy(){delete PhysicsComponent._physicObjectsMap[this.id];ILaya3D.Physics3D._bullet.btCollisionObject_destroy(this._btColliderObject);this._colliderShape.destroy();_Laya$Component.prototype._onDestroy.call(this);this._btColliderObject=null;this._colliderShape=null;this._simulation=null;this.owner.transform.off(Laya.Event.TRANSFORM_CHANGED,this,this._onTransformChanged);};_proto17._isValid=function _isValid(){return this._simulation&&this._colliderShape&&this._enabled;};_proto17._parse=function _parse(data){data.collisionGroup!=null&&(this.collisionGroup=data.collisionGroup);data.canCollideWith!=null&&(this.canCollideWith=data.canCollideWith);data.ccdMotionThreshold!=null&&(this.ccdMotionThreshold=data.ccdMotionThreshold);data.ccdSweptSphereRadius!=null&&(this.ccdSweptSphereRadius=data.ccdSweptSphereRadius);};_proto17._setTransformFlag=function _setTransformFlag(type,value){if(value)this._transformFlag|=type;else this._transformFlag&=~type;};_proto17._getTransformFlag=function _getTransformFlag(type){return (this._transformFlag&type)!=0;};_proto17._addToSimulation=function _addToSimulation(){};_proto17._removeFromSimulation=function _removeFromSimulation(){};_proto17._derivePhysicsTransformation=function _derivePhysicsTransformation(force){var bt=ILaya3D.Physics3D._bullet;var btColliderObject=this._btColliderObject;var btTransform=bt.btCollisionObject_getWorldTransform(btColliderObject);this._innerDerivePhysicsTransformation(btTransform,force);bt.btCollisionObject_setWorldTransform(btColliderObject,btTransform);};_proto17._innerDerivePhysicsTransformation=function _innerDerivePhysicsTransformation(physicTransformOut,force){var bt=ILaya3D.Physics3D._bullet;var transform=this.owner._transform;if(force||this._getTransformFlag(Transform3D.TRANSFORM_WORLDPOSITION)){var shapeOffset=this._colliderShape.localOffset;var position=transform.position;var btPosition=PhysicsComponent._btVector30;if(shapeOffset.x!==0||shapeOffset.y!==0||shapeOffset.z!==0){var physicPosition=PhysicsComponent._tempVector30;var worldMat=transform.worldMatrix;Vector3.transformCoordinate(shapeOffset,worldMat,physicPosition);bt.btVector3_setValue(btPosition,-physicPosition.x,physicPosition.y,physicPosition.z);}else {bt.btVector3_setValue(btPosition,-position.x,position.y,position.z);}bt.btTransform_setOrigin(physicTransformOut,btPosition);this._setTransformFlag(Transform3D.TRANSFORM_WORLDPOSITION,false);}if(force||this._getTransformFlag(Transform3D.TRANSFORM_WORLDQUATERNION)){var shapeRotation=this._colliderShape.localRotation;var btRotation=PhysicsComponent._btQuaternion0;var rotation=transform.rotation;if(shapeRotation.x!==0||shapeRotation.y!==0||shapeRotation.z!==0||shapeRotation.w!==1){var physicRotation=PhysicsComponent._tempQuaternion0;PhysicsComponent.physicQuaternionMultiply(rotation.x,rotation.y,rotation.z,rotation.w,shapeRotation,physicRotation);bt.btQuaternion_setValue(btRotation,-physicRotation.x,physicRotation.y,physicRotation.z,-physicRotation.w);}else {bt.btQuaternion_setValue(btRotation,-rotation.x,rotation.y,rotation.z,-rotation.w);}bt.btTransform_setRotation(physicTransformOut,btRotation);this._setTransformFlag(Transform3D.TRANSFORM_WORLDQUATERNION,false);}if(force||this._getTransformFlag(Transform3D.TRANSFORM_WORLDSCALE)){this._onScaleChange(transform.getWorldLossyScale());this._setTransformFlag(Transform3D.TRANSFORM_WORLDSCALE,false);}};_proto17._updateTransformComponent=function _updateTransformComponent(physicsTransform){var bt=ILaya3D.Physics3D._bullet;var colliderShape=this._colliderShape;var localOffset=colliderShape.localOffset;var localRotation=colliderShape.localRotation;var transform=this.owner._transform;var position=transform.position;var rotation=transform.rotation;var btPosition=bt.btTransform_getOrigin(physicsTransform);var btRotation=bt.btTransform_getRotation(physicsTransform);var btRotX=-bt.btQuaternion_x(btRotation);var btRotY=bt.btQuaternion_y(btRotation);var btRotZ=bt.btQuaternion_z(btRotation);var btRotW=-bt.btQuaternion_w(btRotation);if(localRotation.x!==0||localRotation.y!==0||localRotation.z!==0||localRotation.w!==1){var invertShapeRotaion=PhysicsComponent._tempQuaternion0;localRotation.invert(invertShapeRotaion);PhysicsComponent.physicQuaternionMultiply(btRotX,btRotY,btRotZ,btRotW,invertShapeRotaion,rotation);}else {rotation.x=btRotX;rotation.y=btRotY;rotation.z=btRotZ;rotation.w=btRotW;}transform.rotation=rotation;if(localOffset.x!==0||localOffset.y!==0||localOffset.z!==0){var btScale=bt.btCollisionShape_getLocalScaling(colliderShape._btShape);var rotShapePosition=PhysicsComponent._tempVector30;rotShapePosition.x=localOffset.x*bt.btVector3_x(btScale);rotShapePosition.y=localOffset.y*bt.btVector3_y(btScale);rotShapePosition.z=localOffset.z*bt.btVector3_z(btScale);Vector3.transformQuat(rotShapePosition,rotation,rotShapePosition);position.x=-bt.btVector3_x(btPosition)-rotShapePosition.x;position.y=bt.btVector3_y(btPosition)-rotShapePosition.y;position.z=bt.btVector3_z(btPosition)-rotShapePosition.z;}else {position.x=-bt.btVector3_x(btPosition);position.y=bt.btVector3_y(btPosition);position.z=bt.btVector3_z(btPosition);}transform.position=position;};_proto17._onShapeChange=function _onShapeChange(colShape){var btColObj=this._btColliderObject;var bt=ILaya3D.Physics3D._bullet;var flags=bt.btCollisionObject_getCollisionFlags(btColObj);if(colShape.needsCustomCollisionCallback){if((flags&PhysicsComponent.COLLISIONFLAGS_CUSTOM_MATERIAL_CALLBACK)===0)bt.btCollisionObject_setCollisionFlags(btColObj,flags|PhysicsComponent.COLLISIONFLAGS_CUSTOM_MATERIAL_CALLBACK);}else {if((flags&PhysicsComponent.COLLISIONFLAGS_CUSTOM_MATERIAL_CALLBACK)>0)bt.btCollisionObject_setCollisionFlags(btColObj,flags^PhysicsComponent.COLLISIONFLAGS_CUSTOM_MATERIAL_CALLBACK);}};_proto17._onAdded=function _onAdded(){this.enabled=this._enabled;this.restitution=this._restitution;this.friction=this._friction;this.rollingFriction=this._rollingFriction;this.ccdMotionThreshold=this._ccdMotionThreshold;this.ccdSweptSphereRadius=this._ccdSweptSphereRadius;this.owner.transform.on(Laya.Event.TRANSFORM_CHANGED,this,this._onTransformChanged);};_proto17._onTransformChanged=function _onTransformChanged(flag){if(PhysicsComponent._addUpdateList||!this._controlBySimulation){flag&=Transform3D.TRANSFORM_WORLDPOSITION|Transform3D.TRANSFORM_WORLDQUATERNION|Transform3D.TRANSFORM_WORLDSCALE;if(flag){this._transformFlag|=flag;if(this._isValid()&&this._inPhysicUpdateListIndex===-1)this._simulation._physicsUpdateList.add(this);}}};_proto17._cloneTo=function _cloneTo(dest){var destPhysicsComponent=dest;destPhysicsComponent.restitution=this._restitution;destPhysicsComponent.friction=this._friction;destPhysicsComponent.rollingFriction=this._rollingFriction;destPhysicsComponent.ccdMotionThreshold=this._ccdMotionThreshold;destPhysicsComponent.ccdSweptSphereRadius=this._ccdSweptSphereRadius;destPhysicsComponent.collisionGroup=this._collisionGroup;destPhysicsComponent.canCollideWith=this._canCollideWith;destPhysicsComponent.canScaleShape=this.canScaleShape;this._colliderShape&&(destPhysicsComponent.colliderShape=this._colliderShape.clone());};_createClass(PhysicsComponent,[{key:"restitution",get:function get(){return this._restitution;},set:function set(value){this._restitution=value;this._btColliderObject&&ILaya3D.Physics3D._bullet.btCollisionObject_setRestitution(this._btColliderObject,value);}},{key:"friction",get:function get(){return this._friction;},set:function set(value){this._friction=value;this._btColliderObject&&ILaya3D.Physics3D._bullet.btCollisionObject_setFriction(this._btColliderObject,value);}},{key:"rollingFriction",get:function get(){return this._rollingFriction;},set:function set(value){this._rollingFriction=value;this._btColliderObject&&ILaya3D.Physics3D._bullet.btCollisionObject_setRollingFriction(this._btColliderObject,value);}},{key:"ccdMotionThreshold",get:function get(){return this._ccdMotionThreshold;},set:function set(value){this._ccdMotionThreshold=value;this._btColliderObject&&ILaya3D.Physics3D._bullet.btCollisionObject_setCcdMotionThreshold(this._btColliderObject,value);}},{key:"ccdSweptSphereRadius",get:function get(){return this._ccdSweptSphereRadius;},set:function set(value){this._ccdSweptSphereRadius=value;this._btColliderObject&&ILaya3D.Physics3D._bullet.btCollisionObject_setCcdSweptSphereRadius(this._btColliderObject,value);}},{key:"isActive",get:function get(){return this._btColliderObject?ILaya3D.Physics3D._bullet.btCollisionObject_isActive(this._btColliderObject):false;}},{key:"colliderShape",get:function get(){return this._colliderShape;},set:function set(value){var lastColliderShape=this._colliderShape;if(lastColliderShape){lastColliderShape._attatched=false;lastColliderShape._attatchedCollisionObject=null;}this._colliderShape=value;if(value){if(value._attatched){throw "PhysicsComponent: this shape has attatched to other entity.";}else {value._attatched=true;value._attatchedCollisionObject=this;}if(this._btColliderObject){ILaya3D.Physics3D._bullet.btCollisionObject_setCollisionShape(this._btColliderObject,value._btShape);var canInSimulation=this._simulation&&this._enabled;canInSimulation&&lastColliderShape&&this._removeFromSimulation();this._onShapeChange(value);if(canInSimulation){this._derivePhysicsTransformation(true);this._addToSimulation();}}}else {if(this._simulation&&this._enabled)lastColliderShape&&this._removeFromSimulation();}}},{key:"simulation",get:function get(){return this._simulation;}},{key:"collisionGroup",get:function get(){return this._collisionGroup;},set:function set(value){if(this._collisionGroup!==value){this._collisionGroup=value;if(this._simulation&&this._colliderShape&&this._enabled){this._removeFromSimulation();this._addToSimulation();}}}},{key:"canCollideWith",get:function get(){return this._canCollideWith;},set:function set(value){if(this._canCollideWith!==value){this._canCollideWith=value;if(this._simulation&&this._colliderShape&&this._enabled){this._removeFromSimulation();this._addToSimulation();}}}}]);return PhysicsComponent;}(Laya.Component);PhysicsComponent.ACTIVATIONSTATE_ACTIVE_TAG=1;PhysicsComponent.ACTIVATIONSTATE_ISLAND_SLEEPING=2;PhysicsComponent.ACTIVATIONSTATE_WANTS_DEACTIVATION=3;PhysicsComponent.ACTIVATIONSTATE_DISABLE_DEACTIVATION=4;PhysicsComponent.ACTIVATIONSTATE_DISABLE_SIMULATION=5;PhysicsComponent.COLLISIONFLAGS_STATIC_OBJECT=1;PhysicsComponent.COLLISIONFLAGS_KINEMATIC_OBJECT=2;PhysicsComponent.COLLISIONFLAGS_NO_CONTACT_RESPONSE=4;PhysicsComponent.COLLISIONFLAGS_CUSTOM_MATERIAL_CALLBACK=8;PhysicsComponent.COLLISIONFLAGS_CHARACTER_OBJECT=16;PhysicsComponent.COLLISIONFLAGS_DISABLE_VISUALIZE_OBJECT=32;PhysicsComponent.COLLISIONFLAGS_DISABLE_SPU_COLLISION_PROCESSING=64;PhysicsComponent._tempVector30=new Vector3();PhysicsComponent._tempQuaternion0=new Quaternion();PhysicsComponent._tempQuaternion1=new Quaternion();PhysicsComponent._tempMatrix4x40=new Matrix4x4();PhysicsComponent._physicObjectsMap={};PhysicsComponent._addUpdateList=true;var SingletonList=/*#__PURE__*/function(){function SingletonList(){this.elements=[];this.length=0;}var _proto18=SingletonList.prototype;_proto18._add=function _add(element){if(this.length===this.elements.length)this.elements.push(element);else this.elements[this.length]=element;};_proto18.add=function add(element){if(this.length===this.elements.length)this.elements.push(element);else this.elements[this.length]=element;this.length++;};return SingletonList;}();var PhysicsUpdateList=/*#__PURE__*/function(_SingletonList){_inheritsLoose(PhysicsUpdateList,_SingletonList);function PhysicsUpdateList(){return _SingletonList.call(this)||this;}var _proto19=PhysicsUpdateList.prototype;_proto19.add=function add(element){var index=element._inPhysicUpdateListIndex;if(index!==-1)throw "PhysicsUpdateList:element has  in  PhysicsUpdateList.";this._add(element);element._inPhysicUpdateListIndex=this.length++;};_proto19.remove=function remove(element){var index=element._inPhysicUpdateListIndex;this.length--;if(index!==this.length){var end=this.elements[this.length];this.elements[index]=end;end._inPhysicUpdateListIndex=index;}element._inPhysicUpdateListIndex=-1;};return PhysicsUpdateList;}(SingletonList);var ContactPoint=function ContactPoint(){this._idCounter=0;this.colliderA=null;this.colliderB=null;this.distance=0;this.normal=new Vector3();this.positionOnA=new Vector3();this.positionOnB=new Vector3();this._id=++this._idCounter;};var HitResult=function HitResult(){this.succeeded=false;this.collider=null;this.point=new Vector3();this.normal=new Vector3();this.hitFraction=0;};var Collision=/*#__PURE__*/function(){function Collision(){this._lastUpdateFrame=-2147483648;this._updateFrame=-2147483648;this._isTrigger=false;this.contacts=[];}var _proto20=Collision.prototype;_proto20._setUpdateFrame=function _setUpdateFrame(farme){this._lastUpdateFrame=this._updateFrame;this._updateFrame=farme;};return Collision;}();var CollisionTool=/*#__PURE__*/function(){function CollisionTool(){this._hitResultsPoolIndex=0;this._hitResultsPool=[];this._contactPonintsPoolIndex=0;this._contactPointsPool=[];this._collisionsPool=[];this._collisions={};}var _proto21=CollisionTool.prototype;_proto21.getHitResult=function getHitResult(){var hitResult=this._hitResultsPool[this._hitResultsPoolIndex++];if(!hitResult){hitResult=new HitResult();this._hitResultsPool.push(hitResult);}return hitResult;};_proto21.recoverAllHitResultsPool=function recoverAllHitResultsPool(){this._hitResultsPoolIndex=0;};_proto21.getContactPoints=function getContactPoints(){var contactPoint=this._contactPointsPool[this._contactPonintsPoolIndex++];if(!contactPoint){contactPoint=new ContactPoint();this._contactPointsPool.push(contactPoint);}return contactPoint;};_proto21.recoverAllContactPointsPool=function recoverAllContactPointsPool(){this._contactPonintsPoolIndex=0;};_proto21.getCollision=function getCollision(physicComponentA,physicComponentB){var collision;var idA=physicComponentA.id;var idB=physicComponentB.id;var subCollisionFirst=this._collisions[idA];if(subCollisionFirst)collision=subCollisionFirst[idB];if(!collision){if(!subCollisionFirst){subCollisionFirst={};this._collisions[idA]=subCollisionFirst;}collision=this._collisionsPool.length===0?new Collision():this._collisionsPool.pop();collision._colliderA=physicComponentA;collision._colliderB=physicComponentB;subCollisionFirst[idB]=collision;}return collision;};_proto21.recoverCollision=function recoverCollision(collision){var idA=collision._colliderA.id;var idB=collision._colliderB.id;this._collisions[idA][idB]=null;this._collisionsPool.push(collision);};_proto21.garbageCollection=function garbageCollection(){this._hitResultsPoolIndex=0;this._hitResultsPool.length=0;this._contactPonintsPoolIndex=0;this._contactPointsPool.length=0;this._collisionsPool.length=0;for(var subCollisionsKey in this._collisionsPool){var subCollisions=this._collisionsPool[subCollisionsKey];var wholeDelete=true;for(var collisionKey in subCollisions){if(subCollisions[collisionKey])wholeDelete=false;else delete subCollisions[collisionKey];}if(wholeDelete)delete this._collisionsPool[subCollisionsKey];}};return CollisionTool;}();var PhysicsSimulation=/*#__PURE__*/function(){function PhysicsSimulation(configuration,flags){this._gravity=new Vector3(0,-10,0);this._btVector3Zero=ILaya3D.Physics3D._bullet.btVector3_create(0,0,0);this._btDefaultQuaternion=ILaya3D.Physics3D._bullet.btQuaternion_create(0,0,0,-1);this._collisionsUtils=new CollisionTool();this._previousFrameCollisions=[];this._currentFrameCollisions=[];this._currentConstraint={};this._physicsUpdateList=new PhysicsUpdateList();this._characters=[];this._updatedRigidbodies=0;this.maxSubSteps=1;this.fixedTimeStep=1.0/60.0;this.maxSubSteps=configuration.maxSubSteps;this.fixedTimeStep=configuration.fixedTimeStep;var bt=ILaya3D.Physics3D._bullet;this._btCollisionConfiguration=bt.btDefaultCollisionConfiguration_create();this._btDispatcher=bt.btCollisionDispatcher_create(this._btCollisionConfiguration);this._btBroadphase=bt.btDbvtBroadphase_create();bt.btOverlappingPairCache_setInternalGhostPairCallback(bt.btDbvtBroadphase_getOverlappingPairCache(this._btBroadphase),bt.btGhostPairCallback_create());var conFlags=configuration.flags;if(conFlags&PhysicsSimulation.PHYSICSENGINEFLAGS_COLLISIONSONLY){this._btCollisionWorld=new bt.btCollisionWorld(this._btDispatcher,this._btBroadphase,this._btCollisionConfiguration);}else if(conFlags&PhysicsSimulation.PHYSICSENGINEFLAGS_SOFTBODYSUPPORT){throw "PhysicsSimulation:SoftBody processing is not yet available";}else {var solver=bt.btSequentialImpulseConstraintSolver_create();this._btDiscreteDynamicsWorld=bt.btDiscreteDynamicsWorld_create(this._btDispatcher,this._btBroadphase,solver,this._btCollisionConfiguration);this._btCollisionWorld=this._btDiscreteDynamicsWorld;}if(this._btDiscreteDynamicsWorld){this._btSolverInfo=bt.btDynamicsWorld_getSolverInfo(this._btDiscreteDynamicsWorld);this._btDispatchInfo=bt.btCollisionWorld_getDispatchInfo(this._btDiscreteDynamicsWorld);}this._btClosestRayResultCallback=bt.ClosestRayResultCallback_create(this._btVector3Zero,this._btVector3Zero);this._btAllHitsRayResultCallback=bt.AllHitsRayResultCallback_create(this._btVector3Zero,this._btVector3Zero);this._btClosestConvexResultCallback=bt.ClosestConvexResultCallback_create(this._btVector3Zero,this._btVector3Zero);this._btAllConvexResultCallback=bt.AllConvexResultCallback_create(this._btVector3Zero,this._btVector3Zero);bt.btGImpactCollisionAlgorithm_RegisterAlgorithm(this._btDispatcher);}PhysicsSimulation.__init__=function __init__(){var bt=ILaya3D.Physics3D._bullet;PhysicsSimulation._btTempVector30=bt.btVector3_create(0,0,0);PhysicsSimulation._btTempVector31=bt.btVector3_create(0,0,0);PhysicsSimulation._btTempQuaternion0=bt.btQuaternion_create(0,0,0,1);PhysicsSimulation._btTempQuaternion1=bt.btQuaternion_create(0,0,0,1);PhysicsSimulation._btTempTransform0=bt.btTransform_create();PhysicsSimulation._btTempTransform1=bt.btTransform_create();};PhysicsSimulation.createConstraint=function createConstraint(){};var _proto22=PhysicsSimulation.prototype;_proto22._simulate=function _simulate(deltaTime){this._updatedRigidbodies=0;var bt=ILaya3D.Physics3D._bullet;if(this._btDiscreteDynamicsWorld)bt.btDiscreteDynamicsWorld_stepSimulation(this._btDiscreteDynamicsWorld,deltaTime,this.maxSubSteps,this.fixedTimeStep);else bt.PerformDiscreteCollisionDetection(this._btCollisionWorld);};_proto22._destroy=function _destroy(){var bt=ILaya3D.Physics3D._bullet;if(this._btDiscreteDynamicsWorld){bt.btCollisionWorld_destroy(this._btDiscreteDynamicsWorld);this._btDiscreteDynamicsWorld=null;}else {bt.btCollisionWorld_destroy(this._btCollisionWorld);this._btCollisionWorld=null;}bt.btDbvtBroadphase_destroy(this._btBroadphase);this._btBroadphase=null;bt.btCollisionDispatcher_destroy(this._btDispatcher);this._btDispatcher=null;bt.btDefaultCollisionConfiguration_destroy(this._btCollisionConfiguration);this._btCollisionConfiguration=null;};_proto22._addPhysicsCollider=function _addPhysicsCollider(component,group,mask){ILaya3D.Physics3D._bullet.btCollisionWorld_addCollisionObject(this._btCollisionWorld,component._btColliderObject,group,mask);};_proto22._removePhysicsCollider=function _removePhysicsCollider(component){ILaya3D.Physics3D._bullet.btCollisionWorld_removeCollisionObject(this._btCollisionWorld,component._btColliderObject);};_proto22._addRigidBody=function _addRigidBody(rigidBody,group,mask){if(!this._btDiscreteDynamicsWorld)throw "Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";ILaya3D.Physics3D._bullet.btDiscreteDynamicsWorld_addRigidBody(this._btCollisionWorld,rigidBody._btColliderObject,group,mask);};_proto22._removeRigidBody=function _removeRigidBody(rigidBody){if(!this._btDiscreteDynamicsWorld)throw "Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";ILaya3D.Physics3D._bullet.btDiscreteDynamicsWorld_removeRigidBody(this._btCollisionWorld,rigidBody._btColliderObject);};_proto22._addCharacter=function _addCharacter(character,group,mask){if(!this._btDiscreteDynamicsWorld)throw "Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";var bt=ILaya3D.Physics3D._bullet;bt.btCollisionWorld_addCollisionObject(this._btCollisionWorld,character._btColliderObject,group,mask);bt.btDynamicsWorld_addAction(this._btCollisionWorld,character._btKinematicCharacter);};_proto22._removeCharacter=function _removeCharacter(character){if(!this._btDiscreteDynamicsWorld)throw "Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";var bt=ILaya3D.Physics3D._bullet;bt.btCollisionWorld_removeCollisionObject(this._btCollisionWorld,character._btColliderObject);bt.btDynamicsWorld_removeAction(this._btCollisionWorld,character._btKinematicCharacter);};_proto22.raycastFromTo=function raycastFromTo(from,to,out,collisonGroup,collisionMask){if(out===void 0){out=null;}if(collisonGroup===void 0){collisonGroup=Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER;}if(collisionMask===void 0){collisionMask=Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER;}var bt=ILaya3D.Physics3D._bullet;var rayResultCall=this._btClosestRayResultCallback;var rayFrom=PhysicsSimulation._btTempVector30;var rayTo=PhysicsSimulation._btTempVector31;bt.btVector3_setValue(rayFrom,-from.x,from.y,from.z);bt.btVector3_setValue(rayTo,-to.x,to.y,to.z);bt.ClosestRayResultCallback_set_m_rayFromWorld(rayResultCall,rayFrom);bt.ClosestRayResultCallback_set_m_rayToWorld(rayResultCall,rayTo);bt.RayResultCallback_set_m_collisionFilterGroup(rayResultCall,collisonGroup);bt.RayResultCallback_set_m_collisionFilterMask(rayResultCall,collisionMask);bt.RayResultCallback_set_m_collisionObject(rayResultCall,null);bt.RayResultCallback_set_m_closestHitFraction(rayResultCall,1);bt.btCollisionWorld_rayTest(this._btCollisionWorld,rayFrom,rayTo,rayResultCall);if(bt.RayResultCallback_hasHit(rayResultCall)){if(out){out.succeeded=true;out.collider=PhysicsComponent._physicObjectsMap[bt.btCollisionObject_getUserIndex(bt.RayResultCallback_get_m_collisionObject(rayResultCall))];out.hitFraction=bt.RayResultCallback_get_m_closestHitFraction(rayResultCall);var btPoint=bt.ClosestRayResultCallback_get_m_hitPointWorld(rayResultCall);var point=out.point;point.x=-bt.btVector3_x(btPoint);point.y=bt.btVector3_y(btPoint);point.z=bt.btVector3_z(btPoint);var btNormal=bt.ClosestRayResultCallback_get_m_hitNormalWorld(rayResultCall);var normal=out.normal;normal.x=-bt.btVector3_x(btNormal);normal.y=bt.btVector3_y(btNormal);normal.z=bt.btVector3_z(btNormal);}return true;}else {if(out)out.succeeded=false;return false;}};_proto22.raycastAllFromTo=function raycastAllFromTo(from,to,out,collisonGroup,collisionMask){if(collisonGroup===void 0){collisonGroup=Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER;}if(collisionMask===void 0){collisionMask=Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER;}var bt=ILaya3D.Physics3D._bullet;var rayResultCall=this._btAllHitsRayResultCallback;var rayFrom=PhysicsSimulation._btTempVector30;var rayTo=PhysicsSimulation._btTempVector31;out.length=0;bt.btVector3_setValue(rayFrom,-from.x,from.y,from.z);bt.btVector3_setValue(rayTo,-to.x,to.y,to.z);bt.AllHitsRayResultCallback_set_m_rayFromWorld(rayResultCall,rayFrom);bt.AllHitsRayResultCallback_set_m_rayToWorld(rayResultCall,rayTo);bt.RayResultCallback_set_m_collisionFilterGroup(rayResultCall,collisonGroup);bt.RayResultCallback_set_m_collisionFilterMask(rayResultCall,collisionMask);var collisionObjects=bt.AllHitsRayResultCallback_get_m_collisionObjects(rayResultCall);var btPoints=bt.AllHitsRayResultCallback_get_m_hitPointWorld(rayResultCall);var btNormals=bt.AllHitsRayResultCallback_get_m_hitNormalWorld(rayResultCall);var btFractions=bt.AllHitsRayResultCallback_get_m_hitFractions(rayResultCall);bt.tBtCollisionObjectArray_clear(collisionObjects);bt.tVector3Array_clear(btPoints);bt.tVector3Array_clear(btNormals);bt.tScalarArray_clear(btFractions);bt.btCollisionWorld_rayTest(this._btCollisionWorld,rayFrom,rayTo,rayResultCall);var count=bt.tBtCollisionObjectArray_size(collisionObjects);if(count>0){this._collisionsUtils.recoverAllHitResultsPool();for(var i=0;i<count;i++){var hitResult=this._collisionsUtils.getHitResult();out.push(hitResult);hitResult.succeeded=true;hitResult.collider=PhysicsComponent._physicObjectsMap[bt.btCollisionObject_getUserIndex(bt.tBtCollisionObjectArray_at(collisionObjects,i))];hitResult.hitFraction=bt.tScalarArray_at(btFractions,i);var btPoint=bt.tVector3Array_at(btPoints,i);var pointE=hitResult.point;pointE.x=-bt.btVector3_x(btPoint);pointE.y=bt.btVector3_y(btPoint);pointE.z=bt.btVector3_z(btPoint);var btNormal=bt.tVector3Array_at(btNormals,i);var normal=hitResult.normal;normal.x=-bt.btVector3_x(btNormal);normal.y=bt.btVector3_y(btNormal);normal.z=bt.btVector3_z(btNormal);}return true;}else {return false;}};_proto22.rayCast=function rayCast(ray,outHitResult,distance,collisonGroup,collisionMask){if(outHitResult===void 0){outHitResult=null;}if(distance===void 0){distance=2147483647;}if(collisonGroup===void 0){collisonGroup=Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER;}if(collisionMask===void 0){collisionMask=Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER;}var from=ray.origin;var to=PhysicsSimulation._tempVector30;Vector3.normalize(ray.direction,to);Vector3.scale(to,distance,to);Vector3.add(from,to,to);return this.raycastFromTo(from,to,outHitResult,collisonGroup,collisionMask);};_proto22.rayCastAll=function rayCastAll(ray,out,distance,collisonGroup,collisionMask){if(distance===void 0){distance=2147483647;}if(collisonGroup===void 0){collisonGroup=Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER;}if(collisionMask===void 0){collisionMask=Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER;}var from=ray.origin;var to=PhysicsSimulation._tempVector30;Vector3.normalize(ray.direction,to);Vector3.scale(to,distance,to);Vector3.add(from,to,to);return this.raycastAllFromTo(from,to,out,collisonGroup,collisionMask);};_proto22.shapeCast=function shapeCast(shape,fromPosition,toPosition,out,fromRotation,toRotation,collisonGroup,collisionMask,allowedCcdPenetration){if(out===void 0){out=null;}if(fromRotation===void 0){fromRotation=null;}if(toRotation===void 0){toRotation=null;}if(collisonGroup===void 0){collisonGroup=Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER;}if(collisionMask===void 0){collisionMask=Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER;}if(allowedCcdPenetration===void 0){allowedCcdPenetration=0.0;}var bt=ILaya3D.Physics3D._bullet;var convexResultCall=this._btClosestConvexResultCallback;var convexPosFrom=PhysicsSimulation._btTempVector30;var convexPosTo=PhysicsSimulation._btTempVector31;var convexRotFrom=PhysicsSimulation._btTempQuaternion0;var convexRotTo=PhysicsSimulation._btTempQuaternion1;var convexTransform=PhysicsSimulation._btTempTransform0;var convexTransTo=PhysicsSimulation._btTempTransform1;var sweepShape=shape._btShape;bt.btVector3_setValue(convexPosFrom,-fromPosition.x,fromPosition.y,fromPosition.z);bt.btVector3_setValue(convexPosTo,-toPosition.x,toPosition.y,toPosition.z);bt.ConvexResultCallback_set_m_collisionFilterGroup(convexResultCall,collisonGroup);bt.ConvexResultCallback_set_m_collisionFilterMask(convexResultCall,collisionMask);bt.btTransform_setOrigin(convexTransform,convexPosFrom);bt.btTransform_setOrigin(convexTransTo,convexPosTo);if(fromRotation){bt.btQuaternion_setValue(convexRotFrom,-fromRotation.x,fromRotation.y,fromRotation.z,-fromRotation.w);bt.btTransform_setRotation(convexTransform,convexRotFrom);}else {bt.btTransform_setRotation(convexTransform,this._btDefaultQuaternion);}if(toRotation){bt.btQuaternion_setValue(convexRotTo,-toRotation.x,toRotation.y,toRotation.z,-toRotation.w);bt.btTransform_setRotation(convexTransTo,convexRotTo);}else {bt.btTransform_setRotation(convexTransTo,this._btDefaultQuaternion);}bt.ClosestConvexResultCallback_set_m_hitCollisionObject(convexResultCall,null);bt.ConvexResultCallback_set_m_closestHitFraction(convexResultCall,1);bt.btCollisionWorld_convexSweepTest(this._btCollisionWorld,sweepShape,convexTransform,convexTransTo,convexResultCall,allowedCcdPenetration);if(bt.ConvexResultCallback_hasHit(convexResultCall)){if(out){out.succeeded=true;out.collider=PhysicsComponent._physicObjectsMap[bt.btCollisionObject_getUserIndex(bt.ClosestConvexResultCallback_get_m_hitCollisionObject(convexResultCall))];out.hitFraction=bt.ConvexResultCallback_get_m_closestHitFraction(convexResultCall);var btPoint=bt.ClosestConvexResultCallback_get_m_hitPointWorld(convexResultCall);var btNormal=bt.ClosestConvexResultCallback_get_m_hitNormalWorld(convexResultCall);var point=out.point;var normal=out.normal;point.x=-bt.btVector3_x(btPoint);point.y=bt.btVector3_y(btPoint);point.z=bt.btVector3_z(btPoint);normal.x=-bt.btVector3_x(btNormal);normal.y=bt.btVector3_y(btNormal);normal.z=bt.btVector3_z(btNormal);}return true;}else {if(out)out.succeeded=false;return false;}};_proto22.shapeCastAll=function shapeCastAll(shape,fromPosition,toPosition,out,fromRotation,toRotation,collisonGroup,collisionMask,allowedCcdPenetration){if(fromRotation===void 0){fromRotation=null;}if(toRotation===void 0){toRotation=null;}if(collisonGroup===void 0){collisonGroup=Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER;}if(collisionMask===void 0){collisionMask=Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER;}if(allowedCcdPenetration===void 0){allowedCcdPenetration=0.0;}var bt=ILaya3D.Physics3D._bullet;var convexResultCall=this._btAllConvexResultCallback;var convexPosFrom=PhysicsSimulation._btTempVector30;var convexPosTo=PhysicsSimulation._btTempVector31;var convexRotFrom=PhysicsSimulation._btTempQuaternion0;var convexRotTo=PhysicsSimulation._btTempQuaternion1;var convexTransform=PhysicsSimulation._btTempTransform0;var convexTransTo=PhysicsSimulation._btTempTransform1;var sweepShape=shape._btShape;out.length=0;bt.btVector3_setValue(convexPosFrom,-fromPosition.x,fromPosition.y,fromPosition.z);bt.btVector3_setValue(convexPosTo,-toPosition.x,toPosition.y,toPosition.z);bt.ConvexResultCallback_set_m_collisionFilterGroup(convexResultCall,collisonGroup);bt.ConvexResultCallback_set_m_collisionFilterMask(convexResultCall,collisionMask);bt.btTransform_setOrigin(convexTransform,convexPosFrom);bt.btTransform_setOrigin(convexTransTo,convexPosTo);if(fromRotation){bt.btQuaternion_setValue(convexRotFrom,-fromRotation.x,fromRotation.y,fromRotation.z,-fromRotation.w);bt.btTransform_setRotation(convexTransform,convexRotFrom);}else {bt.btTransform_setRotation(convexTransform,this._btDefaultQuaternion);}if(toRotation){bt.btQuaternion_setValue(convexRotTo,-toRotation.x,toRotation.y,toRotation.z,-toRotation.w);bt.btTransform_setRotation(convexTransTo,convexRotTo);}else {bt.btTransform_setRotation(convexTransTo,this._btDefaultQuaternion);}var collisionObjects=bt.AllConvexResultCallback_get_m_collisionObjects(convexResultCall);bt.tBtCollisionObjectArray_clear(collisionObjects);bt.btCollisionWorld_convexSweepTest(this._btCollisionWorld,sweepShape,convexTransform,convexTransTo,convexResultCall,allowedCcdPenetration);var count=bt.tBtCollisionObjectArray_size(collisionObjects);if(count>0){this._collisionsUtils.recoverAllHitResultsPool();var btPoints=bt.AllConvexResultCallback_get_m_hitPointWorld(convexResultCall);var btNormals=bt.AllConvexResultCallback_get_m_hitNormalWorld(convexResultCall);var btFractions=bt.AllConvexResultCallback_get_m_hitFractions(convexResultCall);for(var i=0;i<count;i++){var hitResult=this._collisionsUtils.getHitResult();out.push(hitResult);hitResult.succeeded=true;hitResult.collider=PhysicsComponent._physicObjectsMap[bt.btCollisionObject_getUserIndex(bt.tBtCollisionObjectArray_at(collisionObjects,i))];hitResult.hitFraction=bt.tScalarArray_at(btFractions,i);var btPoint=bt.tVector3Array_at(btPoints,i);var point=hitResult.point;point.x=-bt.btVector3_x(btPoint);point.y=bt.btVector3_y(btPoint);point.z=bt.btVector3_z(btPoint);var btNormal=bt.tVector3Array_at(btNormals,i);var normal=hitResult.normal;normal.x=-bt.btVector3_x(btNormal);normal.y=bt.btVector3_y(btNormal);normal.z=bt.btVector3_z(btNormal);}return true;}else {return false;}};_proto22.addConstraint=function addConstraint(constraint,disableCollisionsBetweenLinkedBodies){if(disableCollisionsBetweenLinkedBodies===void 0){disableCollisionsBetweenLinkedBodies=false;}if(!this._btDiscreteDynamicsWorld)throw "Cannot perform this action when the physics engine is set to CollisionsOnly";ILaya3D.Physics3D._bullet.btCollisionWorld_addConstraint(this._btDiscreteDynamicsWorld,constraint._btConstraint,disableCollisionsBetweenLinkedBodies);this._currentConstraint[constraint.id]=constraint;};_proto22.removeConstraint=function removeConstraint(constraint){if(!this._btDiscreteDynamicsWorld)throw "Cannot perform this action when the physics engine is set to CollisionsOnly";ILaya3D.Physics3D._bullet.btCollisionWorld_removeConstraint(this._btDiscreteDynamicsWorld,constraint._btConstraint);delete this._currentConstraint[constraint.id];};_proto22._updatePhysicsTransformFromRender=function _updatePhysicsTransformFromRender(){var elements=this._physicsUpdateList.elements;for(var i=0,n=this._physicsUpdateList.length;i<n;i++){var physicCollider=elements[i];physicCollider._derivePhysicsTransformation(false);physicCollider._inPhysicUpdateListIndex=-1;}this._physicsUpdateList.length=0;};_proto22._updateCharacters=function _updateCharacters(){for(var i=0,n=this._characters.length;i<n;i++){var character=this._characters[i];character._updateTransformComponent(ILaya3D.Physics3D._bullet.btCollisionObject_getWorldTransform(character._btColliderObject));}};_proto22._updateCollisions=function _updateCollisions(){this._collisionsUtils.recoverAllContactPointsPool();var previous=this._currentFrameCollisions;this._currentFrameCollisions=this._previousFrameCollisions;this._currentFrameCollisions.length=0;this._previousFrameCollisions=previous;var loopCount=Laya.Stat.loopCount;var bt=ILaya3D.Physics3D._bullet;var numManifolds=bt.btDispatcher_getNumManifolds(this._btDispatcher);for(var i=0;i<numManifolds;i++){var contactManifold=bt.btDispatcher_getManifoldByIndexInternal(this._btDispatcher,i);var componentA=PhysicsComponent._physicObjectsMap[bt.btCollisionObject_getUserIndex(bt.btPersistentManifold_getBody0(contactManifold))];var componentB=PhysicsComponent._physicObjectsMap[bt.btCollisionObject_getUserIndex(bt.btPersistentManifold_getBody1(contactManifold))];var collision=null;var isFirstCollision;var contacts=null;var isTrigger=componentA.isTrigger||componentB.isTrigger;if(isTrigger&&(componentA.owner._needProcessTriggers||componentB.owner._needProcessTriggers)){var numContacts=bt.btPersistentManifold_getNumContacts(contactManifold);for(var j=0;j<numContacts;j++){var pt=bt.btPersistentManifold_getContactPoint(contactManifold,j);var distance=bt.btManifoldPoint_getDistance(pt);if(distance<=0){collision=this._collisionsUtils.getCollision(componentA,componentB);contacts=collision.contacts;isFirstCollision=collision._updateFrame!==loopCount;if(isFirstCollision){collision._isTrigger=true;contacts.length=0;}break;}}}else if(componentA.owner._needProcessCollisions||componentB.owner._needProcessCollisions){if(componentA._enableProcessCollisions||componentB._enableProcessCollisions){numContacts=bt.btPersistentManifold_getNumContacts(contactManifold);for(j=0;j<numContacts;j++){pt=bt.btPersistentManifold_getContactPoint(contactManifold,j);distance=bt.btManifoldPoint_getDistance(pt);if(distance<=0){var contactPoint=this._collisionsUtils.getContactPoints();contactPoint.colliderA=componentA;contactPoint.colliderB=componentB;contactPoint.distance=distance;var btNormal=bt.btManifoldPoint_get_m_normalWorldOnB(pt);var normal=contactPoint.normal;normal.x=-bt.btVector3_x(btNormal);normal.y=bt.btVector3_y(btNormal);normal.z=bt.btVector3_z(btNormal);var btPostionA=bt.btManifoldPoint_get_m_positionWorldOnA(pt);var positionOnA=contactPoint.positionOnA;positionOnA.x=-bt.btVector3_x(btPostionA);positionOnA.y=bt.btVector3_y(btPostionA);positionOnA.z=bt.btVector3_z(btPostionA);var btPostionB=bt.btManifoldPoint_get_m_positionWorldOnB(pt);var positionOnB=contactPoint.positionOnB;positionOnB.x=-bt.btVector3_x(btPostionB);positionOnB.y=bt.btVector3_y(btPostionB);positionOnB.z=bt.btVector3_z(btPostionB);if(!collision){collision=this._collisionsUtils.getCollision(componentA,componentB);contacts=collision.contacts;isFirstCollision=collision._updateFrame!==loopCount;if(isFirstCollision){collision._isTrigger=false;contacts.length=0;}}contacts.push(contactPoint);}}}}if(collision&&isFirstCollision){this._currentFrameCollisions.push(collision);collision._setUpdateFrame(loopCount);}}};_proto22._eventScripts=function _eventScripts(){var loopCount=Laya.Stat.loopCount;for(var i=0,n=this._currentFrameCollisions.length;i<n;i++){var curFrameCol=this._currentFrameCollisions[i];var colliderA=curFrameCol._colliderA;var colliderB=curFrameCol._colliderB;if(colliderA.destroyed||colliderB.destroyed)continue;if(loopCount-curFrameCol._lastUpdateFrame===1){var ownerA=colliderA.owner;var scriptsA=ownerA._scripts;if(scriptsA){if(curFrameCol._isTrigger){if(ownerA._needProcessTriggers){for(var j=0,m=scriptsA.length;j<m;j++){scriptsA[j].onTriggerStay(colliderB);}}}else {if(ownerA._needProcessCollisions){for(j=0,m=scriptsA.length;j<m;j++){curFrameCol.other=colliderB;scriptsA[j].onCollisionStay(curFrameCol);}}}}var ownerB=colliderB.owner;var scriptsB=ownerB._scripts;if(scriptsB){if(curFrameCol._isTrigger){if(ownerB._needProcessTriggers){for(j=0,m=scriptsB.length;j<m;j++){scriptsB[j].onTriggerStay(colliderA);}}}else {if(ownerB._needProcessCollisions){for(j=0,m=scriptsB.length;j<m;j++){curFrameCol.other=colliderA;scriptsB[j].onCollisionStay(curFrameCol);}}}}}else {ownerA=colliderA.owner;scriptsA=ownerA._scripts;if(scriptsA){if(curFrameCol._isTrigger){if(ownerA._needProcessTriggers){for(j=0,m=scriptsA.length;j<m;j++){scriptsA[j].onTriggerEnter(colliderB);}}}else {if(ownerA._needProcessCollisions){for(j=0,m=scriptsA.length;j<m;j++){curFrameCol.other=colliderB;scriptsA[j].onCollisionEnter(curFrameCol);}}}}ownerB=colliderB.owner;scriptsB=ownerB._scripts;if(scriptsB){if(curFrameCol._isTrigger){if(ownerB._needProcessTriggers){for(j=0,m=scriptsB.length;j<m;j++){scriptsB[j].onTriggerEnter(colliderA);}}}else {if(ownerB._needProcessCollisions){for(j=0,m=scriptsB.length;j<m;j++){curFrameCol.other=colliderA;scriptsB[j].onCollisionEnter(curFrameCol);}}}}}}for(i=0,n=this._previousFrameCollisions.length;i<n;i++){var preFrameCol=this._previousFrameCollisions[i];var preColliderA=preFrameCol._colliderA;var preColliderB=preFrameCol._colliderB;if(preColliderA.destroyed||preColliderB.destroyed)continue;if(loopCount-preFrameCol._updateFrame===1){this._collisionsUtils.recoverCollision(preFrameCol);ownerA=preColliderA.owner;scriptsA=ownerA._scripts;if(scriptsA){if(preFrameCol._isTrigger){if(ownerA._needProcessTriggers){for(j=0,m=scriptsA.length;j<m;j++){scriptsA[j].onTriggerExit(preColliderB);}}}else {if(ownerA._needProcessCollisions){for(j=0,m=scriptsA.length;j<m;j++){preFrameCol.other=preColliderB;scriptsA[j].onCollisionExit(preFrameCol);}}}}ownerB=preColliderB.owner;scriptsB=ownerB._scripts;if(scriptsB){if(preFrameCol._isTrigger){if(ownerB._needProcessTriggers){for(j=0,m=scriptsB.length;j<m;j++){scriptsB[j].onTriggerExit(preColliderA);}}}else {if(ownerB._needProcessCollisions){for(j=0,m=scriptsB.length;j<m;j++){preFrameCol.other=preColliderA;scriptsB[j].onCollisionExit(preFrameCol);}}}}}}for(var id in this._currentConstraint){var constraintObj=this._currentConstraint[id];var scripts=constraintObj.owner._scripts;if(constraintObj.enabled&&constraintObj._isBreakConstrained()&&!!scripts){if(scripts.length!=0){for(i=0,n=scripts.length;i<n;i++){scripts[i].onJointBreak();}}}}};_proto22.clearForces=function clearForces(){if(!this._btDiscreteDynamicsWorld)throw "Cannot perform this action when the physics engine is set to CollisionsOnly";ILaya3D.Physics3D._bullet.btDiscreteDynamicsWorld_clearForces(this._btDiscreteDynamicsWorld);};_createClass(PhysicsSimulation,[{key:"continuousCollisionDetection",get:function get(){return ILaya3D.Physics3D._bullet.btCollisionWorld_get_m_useContinuous(this._btDispatchInfo);},set:function set(value){ILaya3D.Physics3D._bullet.btCollisionWorld_set_m_useContinuous(this._btDispatchInfo,value);}},{key:"gravity",get:function get(){if(!this._btDiscreteDynamicsWorld)throw "Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";return this._gravity;},set:function set(value){if(!this._btDiscreteDynamicsWorld)throw "Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";this._gravity=value;var bt=ILaya3D.Physics3D._bullet;var btGravity=PhysicsSimulation._btTempVector30;bt.btVector3_setValue(btGravity,-value.x,value.y,value.z);bt.btDiscreteDynamicsWorld_setGravity(this._btDiscreteDynamicsWorld,btGravity);}},{key:"speculativeContactRestitution",get:function get(){if(!this._btDiscreteDynamicsWorld)throw "Simulation:Cannot Cannot perform this action when the physics engine is set to CollisionsOnly";return ILaya3D.Physics3D._bullet.btDiscreteDynamicsWorld_getApplySpeculativeContactRestitution(this._btDiscreteDynamicsWorld);},set:function set(value){if(!this._btDiscreteDynamicsWorld)throw "Simulation:Cannot Cannot perform this action when the physics engine is set to CollisionsOnly";ILaya3D.Physics3D._bullet.btDiscreteDynamicsWorld_setApplySpeculativeContactRestitution(this._btDiscreteDynamicsWorld,value);}}]);return PhysicsSimulation;}();PhysicsSimulation.PHYSICSENGINEFLAGS_NONE=0x0;PhysicsSimulation.PHYSICSENGINEFLAGS_COLLISIONSONLY=0x1;PhysicsSimulation.PHYSICSENGINEFLAGS_SOFTBODYSUPPORT=0x2;PhysicsSimulation.PHYSICSENGINEFLAGS_MULTITHREADED=0x4;PhysicsSimulation.PHYSICSENGINEFLAGS_USEHARDWAREWHENPOSSIBLE=0x8;PhysicsSimulation.SOLVERMODE_RANDMIZE_ORDER=1;PhysicsSimulation.SOLVERMODE_FRICTION_SEPARATE=2;PhysicsSimulation.SOLVERMODE_USE_WARMSTARTING=4;PhysicsSimulation.SOLVERMODE_USE_2_FRICTION_DIRECTIONS=16;PhysicsSimulation.SOLVERMODE_ENABLE_FRICTION_DIRECTION_CACHING=32;PhysicsSimulation.SOLVERMODE_DISABLE_VELOCITY_DEPENDENT_FRICTION_DIRECTION=64;PhysicsSimulation.SOLVERMODE_CACHE_FRIENDLY=128;PhysicsSimulation.SOLVERMODE_SIMD=256;PhysicsSimulation.SOLVERMODE_INTERLEAVE_CONTACT_AND_FRICTION_CONSTRAINTS=512;PhysicsSimulation.SOLVERMODE_ALLOW_ZERO_LENGTH_FRICTION_DIRECTIONS=1024;PhysicsSimulation._tempVector30=new Vector3();PhysicsSimulation.disableSimulation=false;var TextureGenerator=/*#__PURE__*/function(){function TextureGenerator(){}TextureGenerator.lightAttenTexture=function lightAttenTexture(x,y,maxX,maxY,index,data){var sqrRange=x/maxX;var atten=1.0/(1.0+25.0*sqrRange);if(sqrRange>=0.64){if(sqrRange>1.0){atten=0;}else {atten*=1-(sqrRange-0.64)/(1-0.64);}}data[index]=Math.floor(atten*255.0+0.5);};TextureGenerator.haloTexture=function haloTexture(x,y,maxX,maxY,index,data){maxX>>=1;maxY>>=1;var xFac=(x-maxX)/maxX;var yFac=(y-maxY)/maxY;var sqrRange=xFac*xFac+yFac*yFac;if(sqrRange>1.0){sqrRange=1.0;}data[index]=Math.floor((1.0-sqrRange)*255.0+0.5);};TextureGenerator._generateTexture2D=function _generateTexture2D(texture,textureWidth,textureHeight,func){var index=0;var size=0;switch(texture.format){case Laya.TextureFormat.R8G8B8:size=3;break;case Laya.TextureFormat.R8G8B8A8:size=4;break;case Laya.TextureFormat.Alpha8:size=1;break;default:throw "GeneratedTexture._generateTexture: unkonw texture format.";}var data=new Uint8Array(textureWidth*textureHeight*size);for(var y=0;y<textureHeight;y++){for(var x=0;x<textureWidth;x++){func(x,y,textureWidth,textureHeight,index,data);index+=size;}}texture.setPixels(data);};return TextureGenerator;}();var Utils3D=/*#__PURE__*/function(){function Utils3D(){}Utils3D._createFloatTextureBuffer=function _createFloatTextureBuffer(width,height){var floatTex=new Laya.Texture2D(width,height,Laya.TextureFormat.R32G32B32A32,false,false);floatTex.filterMode=Laya.FilterMode.Point;floatTex.wrapModeU=Laya.WarpMode.Clamp;floatTex.wrapModeV=Laya.WarpMode.Clamp;floatTex.anisoLevel=0;return floatTex;};Utils3D._convertToLayaVec3=function _convertToLayaVec3(bVector,out,inverseX){var bullet=ILaya3D.Physics3D._bullet;out.x=inverseX?-bullet.btVector3_x(bVector):bullet.btVector3_x(bVector);out.y=bullet.btVector3_y(bVector);out.z=bullet.btVector3_z(bVector);};Utils3D._convertToBulletVec3=function _convertToBulletVec3(lVector,out,inverseX){ILaya3D.Physics3D._bullet.btVector3_setValue(out,inverseX?-lVector.x:lVector.x,lVector.y,lVector.z);};Utils3D._rotationTransformScaleSkinAnimation=function _rotationTransformScaleSkinAnimation(tx,ty,tz,qx,qy,qz,qw,sx,sy,sz,outArray,outOffset){var re=Utils3D._tempArray16_0;var se=Utils3D._tempArray16_1;var tse=Utils3D._tempArray16_2;var x2=qx+qx;var y2=qy+qy;var z2=qz+qz;var xx=qx*x2;var yx=qy*x2;var yy=qy*y2;var zx=qz*x2;var zy=qz*y2;var zz=qz*z2;var wx=qw*x2;var wy=qw*y2;var wz=qw*z2;re[15]=1;re[0]=1-yy-zz;re[1]=yx+wz;re[2]=zx-wy;re[4]=yx-wz;re[5]=1-xx-zz;re[6]=zy+wx;re[8]=zx+wy;re[9]=zy-wx;re[10]=1-xx-yy;se[15]=1;se[0]=sx;se[5]=sy;se[10]=sz;var i,ai0,ai1,ai2,ai3;for(i=0;i<4;i++){ai0=re[i];ai1=re[i+4];ai2=re[i+8];ai3=re[i+12];tse[i]=ai0;tse[i+4]=ai1;tse[i+8]=ai2;tse[i+12]=ai0*tx+ai1*ty+ai2*tz+ai3;}for(i=0;i<4;i++){ai0=tse[i];ai1=tse[i+4];ai2=tse[i+8];ai3=tse[i+12];outArray[i+outOffset]=ai0*se[0]+ai1*se[1]+ai2*se[2]+ai3*se[3];outArray[i+outOffset+4]=ai0*se[4]+ai1*se[5]+ai2*se[6]+ai3*se[7];outArray[i+outOffset+8]=ai0*se[8]+ai1*se[9]+ai2*se[10]+ai3*se[11];outArray[i+outOffset+12]=ai0*se[12]+ai1*se[13]+ai2*se[14]+ai3*se[15];}};Utils3D._computeBoneAndAnimationDatasByBindPoseMatrxix=function _computeBoneAndAnimationDatasByBindPoseMatrxix(bones,curData,inverGlobalBindPose,outBonesDatas,outAnimationDatas,boneIndexToMesh){var offset=0;var matOffset=0;var i;var parentOffset;var boneLength=bones.length;for(i=0;i<boneLength;offset+=bones[i].keyframeWidth,matOffset+=16,i++){Utils3D._rotationTransformScaleSkinAnimation(curData[offset+0],curData[offset+1],curData[offset+2],curData[offset+3],curData[offset+4],curData[offset+5],curData[offset+6],curData[offset+7],curData[offset+8],curData[offset+9],outBonesDatas,matOffset);if(i!=0){parentOffset=bones[i].parentIndex*16;Utils3D.mulMatrixByArray(outBonesDatas,parentOffset,outBonesDatas,matOffset,outBonesDatas,matOffset);}}var n=inverGlobalBindPose.length;for(i=0;i<n;i++){Utils3D.mulMatrixByArrayAndMatrixFast(outBonesDatas,boneIndexToMesh[i]*16,inverGlobalBindPose[i],outAnimationDatas,i*16);}};Utils3D._computeAnimationDatasByArrayAndMatrixFast=function _computeAnimationDatasByArrayAndMatrixFast(inverGlobalBindPose,bonesDatas,outAnimationDatas,boneIndexToMesh){for(var i=0,n=inverGlobalBindPose.length;i<n;i++){Utils3D.mulMatrixByArrayAndMatrixFast(bonesDatas,boneIndexToMesh[i]*16,inverGlobalBindPose[i],outAnimationDatas,i*16);}};Utils3D._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function _computeBoneAndAnimationDatasByBindPoseMatrxixOld(bones,curData,inverGlobalBindPose,outBonesDatas,outAnimationDatas){var offset=0;var matOffset=0;var i;var parentOffset;var boneLength=bones.length;for(i=0;i<boneLength;offset+=bones[i].keyframeWidth,matOffset+=16,i++){Utils3D._rotationTransformScaleSkinAnimation(curData[offset+7],curData[offset+8],curData[offset+9],curData[offset+3],curData[offset+4],curData[offset+5],curData[offset+6],curData[offset+0],curData[offset+1],curData[offset+2],outBonesDatas,matOffset);if(i!=0){parentOffset=bones[i].parentIndex*16;Utils3D.mulMatrixByArray(outBonesDatas,parentOffset,outBonesDatas,matOffset,outBonesDatas,matOffset);}}var n=inverGlobalBindPose.length;for(i=0;i<n;i++){var arrayOffset=i*16;Utils3D.mulMatrixByArrayAndMatrixFast(outBonesDatas,arrayOffset,inverGlobalBindPose[i],outAnimationDatas,arrayOffset);}};Utils3D._computeAnimationDatasByArrayAndMatrixFastOld=function _computeAnimationDatasByArrayAndMatrixFastOld(inverGlobalBindPose,bonesDatas,outAnimationDatas){var n=inverGlobalBindPose.length;for(var i=0;i<n;i++){var arrayOffset=i*16;Utils3D.mulMatrixByArrayAndMatrixFast(bonesDatas,arrayOffset,inverGlobalBindPose[i],outAnimationDatas,arrayOffset);}};Utils3D._computeRootAnimationData=function _computeRootAnimationData(bones,curData,animationDatas){for(var i=0,offset=0,matOffset=0,boneLength=bones.length;i<boneLength;offset+=bones[i].keyframeWidth,matOffset+=16,i++){Utils3D.createAffineTransformationArray(curData[offset+0],curData[offset+1],curData[offset+2],curData[offset+3],curData[offset+4],curData[offset+5],curData[offset+6],curData[offset+7],curData[offset+8],curData[offset+9],animationDatas,matOffset);}};Utils3D.transformVector3ArrayByQuat=function transformVector3ArrayByQuat(sourceArray,sourceOffset,rotation,outArray,outOffset){var x=sourceArray[sourceOffset],y=sourceArray[sourceOffset+1],z=sourceArray[sourceOffset+2],qx=rotation.x,qy=rotation.y,qz=rotation.z,qw=rotation.w,ix=qw*x+qy*z-qz*y,iy=qw*y+qz*x-qx*z,iz=qw*z+qx*y-qy*x,iw=-qx*x-qy*y-qz*z;outArray[outOffset]=ix*qw+iw*-qx+iy*-qz-iz*-qy;outArray[outOffset+1]=iy*qw+iw*-qy+iz*-qx-ix*-qz;outArray[outOffset+2]=iz*qw+iw*-qz+ix*-qy-iy*-qx;};Utils3D.mulMatrixByArray=function mulMatrixByArray(leftArray,leftOffset,rightArray,rightOffset,outArray,outOffset){var i,ai0,ai1,ai2,ai3;if(outArray===rightArray){rightArray=Utils3D._tempArray16_3;for(i=0;i<16;++i){rightArray[i]=outArray[outOffset+i];}rightOffset=0;}for(i=0;i<4;i++){ai0=leftArray[leftOffset+i];ai1=leftArray[leftOffset+i+4];ai2=leftArray[leftOffset+i+8];ai3=leftArray[leftOffset+i+12];outArray[outOffset+i]=ai0*rightArray[rightOffset+0]+ai1*rightArray[rightOffset+1]+ai2*rightArray[rightOffset+2]+ai3*rightArray[rightOffset+3];outArray[outOffset+i+4]=ai0*rightArray[rightOffset+4]+ai1*rightArray[rightOffset+5]+ai2*rightArray[rightOffset+6]+ai3*rightArray[rightOffset+7];outArray[outOffset+i+8]=ai0*rightArray[rightOffset+8]+ai1*rightArray[rightOffset+9]+ai2*rightArray[rightOffset+10]+ai3*rightArray[rightOffset+11];outArray[outOffset+i+12]=ai0*rightArray[rightOffset+12]+ai1*rightArray[rightOffset+13]+ai2*rightArray[rightOffset+14]+ai3*rightArray[rightOffset+15];}};Utils3D.mulMatrixByArrayFast=function mulMatrixByArrayFast(leftArray,leftOffset,rightArray,rightOffset,outArray,outOffset){var i,ai0,ai1,ai2,ai3;for(i=0;i<4;i++){ai0=leftArray[leftOffset+i];ai1=leftArray[leftOffset+i+4];ai2=leftArray[leftOffset+i+8];ai3=leftArray[leftOffset+i+12];outArray[outOffset+i]=ai0*rightArray[rightOffset+0]+ai1*rightArray[rightOffset+1]+ai2*rightArray[rightOffset+2]+ai3*rightArray[rightOffset+3];outArray[outOffset+i+4]=ai0*rightArray[rightOffset+4]+ai1*rightArray[rightOffset+5]+ai2*rightArray[rightOffset+6]+ai3*rightArray[rightOffset+7];outArray[outOffset+i+8]=ai0*rightArray[rightOffset+8]+ai1*rightArray[rightOffset+9]+ai2*rightArray[rightOffset+10]+ai3*rightArray[rightOffset+11];outArray[outOffset+i+12]=ai0*rightArray[rightOffset+12]+ai1*rightArray[rightOffset+13]+ai2*rightArray[rightOffset+14]+ai3*rightArray[rightOffset+15];}};Utils3D.mulMatrixByArrayAndMatrixFast=function mulMatrixByArrayAndMatrixFast(leftArray,leftOffset,rightMatrix,outArray,outOffset){var i,ai0,ai1,ai2,ai3;var rightMatrixE=rightMatrix.elements;var m11=rightMatrixE[0],m12=rightMatrixE[1],m13=rightMatrixE[2],m14=rightMatrixE[3];var m21=rightMatrixE[4],m22=rightMatrixE[5],m23=rightMatrixE[6],m24=rightMatrixE[7];var m31=rightMatrixE[8],m32=rightMatrixE[9],m33=rightMatrixE[10],m34=rightMatrixE[11];var m41=rightMatrixE[12],m42=rightMatrixE[13],m43=rightMatrixE[14],m44=rightMatrixE[15];var ai0LeftOffset=leftOffset;var ai1LeftOffset=leftOffset+4;var ai2LeftOffset=leftOffset+8;var ai3LeftOffset=leftOffset+12;var ai0OutOffset=outOffset;var ai1OutOffset=outOffset+4;var ai2OutOffset=outOffset+8;var ai3OutOffset=outOffset+12;for(i=0;i<4;i++){ai0=leftArray[ai0LeftOffset+i];ai1=leftArray[ai1LeftOffset+i];ai2=leftArray[ai2LeftOffset+i];ai3=leftArray[ai3LeftOffset+i];outArray[ai0OutOffset+i]=ai0*m11+ai1*m12+ai2*m13+ai3*m14;outArray[ai1OutOffset+i]=ai0*m21+ai1*m22+ai2*m23+ai3*m24;outArray[ai2OutOffset+i]=ai0*m31+ai1*m32+ai2*m33+ai3*m34;outArray[ai3OutOffset+i]=ai0*m41+ai1*m42+ai2*m43+ai3*m44;}};Utils3D.createAffineTransformationArray=function createAffineTransformationArray(tX,tY,tZ,rX,rY,rZ,rW,sX,sY,sZ,outArray,outOffset){var x2=rX+rX,y2=rY+rY,z2=rZ+rZ;var xx=rX*x2,xy=rX*y2,xz=rX*z2,yy=rY*y2,yz=rY*z2,zz=rZ*z2;var wx=rW*x2,wy=rW*y2,wz=rW*z2;outArray[outOffset+0]=(1-(yy+zz))*sX;outArray[outOffset+1]=(xy+wz)*sX;outArray[outOffset+2]=(xz-wy)*sX;outArray[outOffset+3]=0;outArray[outOffset+4]=(xy-wz)*sY;outArray[outOffset+5]=(1-(xx+zz))*sY;outArray[outOffset+6]=(yz+wx)*sY;outArray[outOffset+7]=0;outArray[outOffset+8]=(xz+wy)*sZ;outArray[outOffset+9]=(yz-wx)*sZ;outArray[outOffset+10]=(1-(xx+yy))*sZ;outArray[outOffset+11]=0;outArray[outOffset+12]=tX;outArray[outOffset+13]=tY;outArray[outOffset+14]=tZ;outArray[outOffset+15]=1;};Utils3D.transformVector3ArrayToVector3ArrayCoordinate=function transformVector3ArrayToVector3ArrayCoordinate(source,sourceOffset,transform,result,resultOffset){var coordinateX=source[sourceOffset+0];var coordinateY=source[sourceOffset+1];var coordinateZ=source[sourceOffset+2];var transformElem=transform.elements;var w=coordinateX*transformElem[3]+coordinateY*transformElem[7]+coordinateZ*transformElem[11]+transformElem[15];result[resultOffset]=coordinateX*transformElem[0]+coordinateY*transformElem[4]+coordinateZ*transformElem[8]+transformElem[12]/w;result[resultOffset+1]=coordinateX*transformElem[1]+coordinateY*transformElem[5]+coordinateZ*transformElem[9]+transformElem[13]/w;result[resultOffset+2]=coordinateX*transformElem[2]+coordinateY*transformElem[6]+coordinateZ*transformElem[10]+transformElem[14]/w;};Utils3D.transformVector3ArrayToVector3ArrayNormal=function transformVector3ArrayToVector3ArrayNormal(source,sourceOffset,transform,result,resultOffset){var coordinateX=source[sourceOffset+0];var coordinateY=source[sourceOffset+1];var coordinateZ=source[sourceOffset+2];var transformElem=transform.elements;result[resultOffset]=coordinateX*transformElem[0]+coordinateY*transformElem[4]+coordinateZ*transformElem[8];result[resultOffset+1]=coordinateX*transformElem[1]+coordinateY*transformElem[5]+coordinateZ*transformElem[9];result[resultOffset+2]=coordinateX*transformElem[2]+coordinateY*transformElem[6]+coordinateZ*transformElem[10];};Utils3D.transformLightingMapTexcoordArray=function transformLightingMapTexcoordArray(source,sourceOffset,lightingMapScaleOffset,result,resultOffset){result[resultOffset+0]=source[sourceOffset+0]*lightingMapScaleOffset.x+lightingMapScaleOffset.z;result[resultOffset+1]=1.0-((1.0-source[sourceOffset+1])*lightingMapScaleOffset.y+lightingMapScaleOffset.w);};Utils3D.getURLVerion=function getURLVerion(url){var index=url.indexOf("?");return index>=0?url.substr(index):null;};Utils3D._createAffineTransformationArray=function _createAffineTransformationArray(trans,rot,scale,outE){var x=rot.x,y=rot.y,z=rot.z,w=rot.w,x2=x+x,y2=y+y,z2=z+z;var xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2;var wx=w*x2,wy=w*y2,wz=w*z2,sx=scale.x,sy=scale.y,sz=scale.z;outE[0]=(1-(yy+zz))*sx;outE[1]=(xy+wz)*sx;outE[2]=(xz-wy)*sx;outE[3]=0;outE[4]=(xy-wz)*sy;outE[5]=(1-(xx+zz))*sy;outE[6]=(yz+wx)*sy;outE[7]=0;outE[8]=(xz+wy)*sz;outE[9]=(yz-wx)*sz;outE[10]=(1-(xx+yy))*sz;outE[11]=0;outE[12]=trans.x;outE[13]=trans.y;outE[14]=trans.z;outE[15]=1;};Utils3D._mulMatrixArray=function _mulMatrixArray(left,right,rightOffset,outArray,outOffset){var l=right;var r=left;var e=outArray;var l11=l[rightOffset],l12=l[rightOffset+1],l13=l[rightOffset+2],l14=l[rightOffset+3];var l21=l[rightOffset+4],l22=l[rightOffset+5],l23=l[rightOffset+6],l24=l[rightOffset+7];var l31=l[rightOffset+8],l32=l[rightOffset+9],l33=l[rightOffset+10],l34=l[rightOffset+11];var l41=l[rightOffset+12],l42=l[rightOffset+13],l43=l[rightOffset+14],l44=l[rightOffset+15];var r11=r[0],r12=r[1],r13=r[2],r14=r[3];var r21=r[4],r22=r[5],r23=r[6],r24=r[7];var r31=r[8],r32=r[9],r33=r[10],r34=r[11];var r41=r[12],r42=r[13],r43=r[14],r44=r[15];e[outOffset]=l11*r11+l12*r21+l13*r31+l14*r41;e[outOffset+1]=l11*r12+l12*r22+l13*r32+l14*r42;e[outOffset+2]=l11*r13+l12*r23+l13*r33+l14*r43;e[outOffset+3]=l11*r14+l12*r24+l13*r34+l14*r44;e[outOffset+4]=l21*r11+l22*r21+l23*r31+l24*r41;e[outOffset+5]=l21*r12+l22*r22+l23*r32+l24*r42;e[outOffset+6]=l21*r13+l22*r23+l23*r33+l24*r43;e[outOffset+7]=l21*r14+l22*r24+l23*r34+l24*r44;e[outOffset+8]=l31*r11+l32*r21+l33*r31+l34*r41;e[outOffset+9]=l31*r12+l32*r22+l33*r32+l34*r42;e[outOffset+10]=l31*r13+l32*r23+l33*r33+l34*r43;e[outOffset+11]=l31*r14+l32*r24+l33*r34+l34*r44;e[outOffset+12]=l41*r11+l42*r21+l43*r31+l44*r41;e[outOffset+13]=l41*r12+l42*r22+l43*r32+l44*r42;e[outOffset+14]=l41*r13+l42*r23+l43*r33+l44*r43;e[outOffset+15]=l41*r14+l42*r24+l43*r34+l44*r44;};Utils3D.arcTanAngle=function arcTanAngle(x,y){if(x==0){if(y==1)return Math.PI/2;return -Math.PI/2;}if(x>0)return Math.atan(y/x);if(x<0){if(y>0)return Math.atan(y/x)+Math.PI;return Math.atan(y/x)-Math.PI;}return 0;};Utils3D.angleTo=function angleTo(from,location,angle){Vector3.subtract(location,from,Quaternion.TEMPVector30);Vector3.normalize(Quaternion.TEMPVector30,Quaternion.TEMPVector30);angle.x=Math.asin(Quaternion.TEMPVector30.y);angle.y=Utils3D.arcTanAngle(-Quaternion.TEMPVector30.z,-Quaternion.TEMPVector30.x);};Utils3D.transformQuat=function transformQuat(source,rotation,out){var re=rotation;var x=source.x,y=source.y,z=source.z,qx=re[0],qy=re[1],qz=re[2],qw=re[3],ix=qw*x+qy*z-qz*y,iy=qw*y+qz*x-qx*z,iz=qw*z+qx*y-qy*x,iw=-qx*x-qy*y-qz*z;out.x=ix*qw+iw*-qx+iy*-qz-iz*-qy;out.y=iy*qw+iw*-qy+iz*-qx-ix*-qz;out.z=iz*qw+iw*-qz+ix*-qy-iy*-qx;};Utils3D.quaternionWeight=function quaternionWeight(f,weight,e){e.x=f.x*weight;e.y=f.y*weight;e.z=f.z*weight;e.w=f.w;};Utils3D.quaternionConjugate=function quaternionConjugate(value,result){result.x=-value.x;result.y=-value.y;result.z=-value.z;result.w=value.w;};Utils3D.scaleWeight=function scaleWeight(s,w,out){var sX=s.x,sY=s.y,sZ=s.z;out.x=sX>0?Math.pow(Math.abs(sX),w):-Math.pow(Math.abs(sX),w);out.y=sY>0?Math.pow(Math.abs(sY),w):-Math.pow(Math.abs(sY),w);out.z=sZ>0?Math.pow(Math.abs(sZ),w):-Math.pow(Math.abs(sZ),w);};Utils3D.scaleBlend=function scaleBlend(sa,sb,w,out){var saw=Utils3D._tempVector3_0;var sbw=Utils3D._tempVector3_1;Utils3D.scaleWeight(sa,1.0-w,saw);Utils3D.scaleWeight(sb,w,sbw);var sng=w>0.5?sb:sa;out.x=sng.x>0?Math.abs(saw.x*sbw.x):-Math.abs(saw.x*sbw.x);out.y=sng.y>0?Math.abs(saw.y*sbw.y):-Math.abs(saw.y*sbw.y);out.z=sng.z>0?Math.abs(saw.z*sbw.z):-Math.abs(saw.z*sbw.z);};Utils3D.matrix4x4MultiplyFFF=function matrix4x4MultiplyFFF(a,b,e){var i,ai0,ai1,ai2,ai3;if(e===b){b=new Float32Array(16);for(i=0;i<16;++i){b[i]=e[i];}}var b0=b[0],b1=b[1],b2=b[2],b3=b[3];var b4=b[4],b5=b[5],b6=b[6],b7=b[7];var b8=b[8],b9=b[9],b10=b[10],b11=b[11];var b12=b[12],b13=b[13],b14=b[14],b15=b[15];for(i=0;i<4;i++){ai0=a[i];ai1=a[i+4];ai2=a[i+8];ai3=a[i+12];e[i]=ai0*b0+ai1*b1+ai2*b2+ai3*b3;e[i+4]=ai0*b4+ai1*b5+ai2*b6+ai3*b7;e[i+8]=ai0*b8+ai1*b9+ai2*b10+ai3*b11;e[i+12]=ai0*b12+ai1*b13+ai2*b14+ai3*b15;}};Utils3D.matrix4x4MultiplyFFFForNative=function matrix4x4MultiplyFFFForNative(a,b,e){Laya.LayaGL.instance.matrix4x4Multiply(a,b,e);};Utils3D.matrix4x4MultiplyMFM=function matrix4x4MultiplyMFM(left,right,out){Utils3D.matrix4x4MultiplyFFF(left.elements,right,out.elements);};Utils3D._buildTexture2D=function _buildTexture2D(width,height,format,colorFunc,mipmaps){if(mipmaps===void 0){mipmaps=false;}var texture=new Laya.Texture2D(width,height,format,mipmaps,true);texture.anisoLevel=1;texture.filterMode=Laya.FilterMode.Point;TextureGenerator._generateTexture2D(texture,width,height,colorFunc);return texture;};Utils3D._drawBound=function _drawBound(debugLine,boundBox,color){if(debugLine.lineCount+12>debugLine.maxLineCount)debugLine.maxLineCount+=12;var start=Utils3D._tempVector3_0;var end=Utils3D._tempVector3_1;var min=boundBox.min;var max=boundBox.max;start.setValue(min.x,min.y,min.z);end.setValue(max.x,min.y,min.z);debugLine.addLine(start,end,color,color);start.setValue(min.x,min.y,min.z);end.setValue(min.x,min.y,max.z);debugLine.addLine(start,end,color,color);start.setValue(max.x,min.y,min.z);end.setValue(max.x,min.y,max.z);debugLine.addLine(start,end,color,color);start.setValue(min.x,min.y,max.z);end.setValue(max.x,min.y,max.z);debugLine.addLine(start,end,color,color);start.setValue(min.x,min.y,min.z);end.setValue(min.x,max.y,min.z);debugLine.addLine(start,end,color,color);start.setValue(min.x,min.y,max.z);end.setValue(min.x,max.y,max.z);debugLine.addLine(start,end,color,color);start.setValue(max.x,min.y,min.z);end.setValue(max.x,max.y,min.z);debugLine.addLine(start,end,color,color);start.setValue(max.x,min.y,max.z);end.setValue(max.x,max.y,max.z);debugLine.addLine(start,end,color,color);start.setValue(min.x,max.y,min.z);end.setValue(max.x,max.y,min.z);debugLine.addLine(start,end,color,color);start.setValue(min.x,max.y,min.z);end.setValue(min.x,max.y,max.z);debugLine.addLine(start,end,color,color);start.setValue(max.x,max.y,min.z);end.setValue(max.x,max.y,max.z);debugLine.addLine(start,end,color,color);start.setValue(min.x,max.y,max.z);end.setValue(max.x,max.y,max.z);debugLine.addLine(start,end,color,color);};Utils3D._getHierarchyPath=function _getHierarchyPath(rootSprite,checkSprite,path){path.length=0;var sprite=checkSprite;while(sprite!==rootSprite){var parent=sprite._parent;if(parent)path.push(parent.getChildIndex(sprite));else return null;sprite=parent;}return path;};Utils3D._getNodeByHierarchyPath=function _getNodeByHierarchyPath(rootSprite,invPath){var sprite=rootSprite;for(var i=invPath.length-1;i>=0;i--){sprite=sprite.getChildAt(invPath[i]);}return sprite;};return Utils3D;}();Utils3D._tempVector3_0=new Vector3();Utils3D._tempVector3_1=new Vector3();Utils3D._tempArray16_0=new Float32Array(16);Utils3D._tempArray16_1=new Float32Array(16);Utils3D._tempArray16_2=new Float32Array(16);Utils3D._tempArray16_3=new Float32Array(16);Utils3D._compIdToNode=new Object();var CharacterController=/*#__PURE__*/function(_PhysicsComponent){_inheritsLoose(CharacterController,_PhysicsComponent);function CharacterController(stepheight,upAxis,collisionGroup,canCollideWith){var _this11;if(stepheight===void 0){stepheight=0.1;}if(upAxis===void 0){upAxis=null;}if(collisionGroup===void 0){collisionGroup=Physics3DUtils.COLLISIONFILTERGROUP_DEFAULTFILTER;}if(canCollideWith===void 0){canCollideWith=Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER;}_this11=_PhysicsComponent.call(this,collisionGroup,canCollideWith)||this;_this11._upAxis=new Vector3(0,1,0);_this11._maxSlope=45.0;_this11._jumpSpeed=10.0;_this11._fallSpeed=55.0;_this11._gravity=new Vector3(0,-9.8*3,0);_this11._btKinematicCharacter=null;_this11._stepHeight=stepheight;upAxis&&(_this11._upAxis=upAxis);_this11._controlBySimulation=true;return _this11;}CharacterController.__init__=function __init__(){CharacterController._btTempVector30=ILaya3D.Physics3D._bullet.btVector3_create(0,0,0);};var _proto23=CharacterController.prototype;_proto23._constructCharacter=function _constructCharacter(){var bt=ILaya3D.Physics3D._bullet;if(this._btKinematicCharacter)bt.btKinematicCharacterController_destroy(this._btKinematicCharacter);var btUpAxis=CharacterController._btTempVector30;bt.btVector3_setValue(btUpAxis,this._upAxis.x,this._upAxis.y,this._upAxis.z);this._btKinematicCharacter=bt.btKinematicCharacterController_create(this._btColliderObject,this._colliderShape._btShape,this._stepHeight,btUpAxis);this.fallSpeed=this._fallSpeed;this.maxSlope=this._maxSlope;this.jumpSpeed=this._jumpSpeed;this.gravity=this._gravity;};_proto23._onShapeChange=function _onShapeChange(colShape){_PhysicsComponent.prototype._onShapeChange.call(this,colShape);this._constructCharacter();};_proto23._onAdded=function _onAdded(){var bt=ILaya3D.Physics3D._bullet;var ghostObject=bt.btPairCachingGhostObject_create();bt.btCollisionObject_setUserIndex(ghostObject,this.id);bt.btCollisionObject_setCollisionFlags(ghostObject,PhysicsComponent.COLLISIONFLAGS_CHARACTER_OBJECT);this._btColliderObject=ghostObject;this._colliderShape&&this._constructCharacter();_PhysicsComponent.prototype._onAdded.call(this);};_proto23._addToSimulation=function _addToSimulation(){this._simulation._characters.push(this);this._simulation._addCharacter(this,this._collisionGroup,this._canCollideWith);};_proto23._removeFromSimulation=function _removeFromSimulation(){this._simulation._removeCharacter(this);var characters=this._simulation._characters;characters.splice(characters.indexOf(this),1);};_proto23._cloneTo=function _cloneTo(dest){_PhysicsComponent.prototype._cloneTo.call(this,dest);var destCharacterController=dest;destCharacterController.stepHeight=this._stepHeight;destCharacterController.upAxis=this._upAxis;destCharacterController.maxSlope=this._maxSlope;destCharacterController.jumpSpeed=this._jumpSpeed;destCharacterController.fallSpeed=this._fallSpeed;destCharacterController.gravity=this._gravity;};_proto23._onDestroy=function _onDestroy(){ILaya3D.Physics3D._bullet.btKinematicCharacterController_destroy(this._btKinematicCharacter);_PhysicsComponent.prototype._onDestroy.call(this);this._btKinematicCharacter=null;};_proto23.move=function move(movement){var btMovement=CharacterController._btVector30;var bt=ILaya3D.Physics3D._bullet;bt.btVector3_setValue(btMovement,-movement.x,movement.y,movement.z);bt.btKinematicCharacterController_setWalkDirection(this._btKinematicCharacter,btMovement);};_proto23.jump=function jump(velocity){if(velocity===void 0){velocity=null;}var bt=ILaya3D.Physics3D._bullet;var btVelocity=CharacterController._btVector30;if(velocity){Utils3D._convertToBulletVec3(velocity,btVelocity,true);bt.btKinematicCharacterController_jump(this._btKinematicCharacter,btVelocity);}else {bt.btVector3_setValue(btVelocity,0,0,0);bt.btKinematicCharacterController_jump(this._btKinematicCharacter,btVelocity);}};_createClass(CharacterController,[{key:"fallSpeed",get:function get(){return this._fallSpeed;},set:function set(value){this._fallSpeed=value;ILaya3D.Physics3D._bullet.btKinematicCharacterController_setFallSpeed(this._btKinematicCharacter,value);}},{key:"jumpSpeed",get:function get(){return this._jumpSpeed;},set:function set(value){this._jumpSpeed=value;ILaya3D.Physics3D._bullet.btKinematicCharacterController_setJumpSpeed(this._btKinematicCharacter,value);}},{key:"gravity",get:function get(){return this._gravity;},set:function set(value){this._gravity=value;var bt=ILaya3D.Physics3D._bullet;var btGravity=CharacterController._btTempVector30;bt.btVector3_setValue(btGravity,-value.x,value.y,value.z);bt.btKinematicCharacterController_setGravity(this._btKinematicCharacter,btGravity);}},{key:"maxSlope",get:function get(){return this._maxSlope;},set:function set(value){this._maxSlope=value;ILaya3D.Physics3D._bullet.btKinematicCharacterController_setMaxSlope(this._btKinematicCharacter,value/180*Math.PI);}},{key:"isGrounded",get:function get(){return ILaya3D.Physics3D._bullet.btKinematicCharacterController_onGround(this._btKinematicCharacter);}},{key:"stepHeight",get:function get(){return this._stepHeight;},set:function set(value){this._stepHeight=value;ILaya3D.Physics3D._bullet.btKinematicCharacterController_setStepHeight(this._btKinematicCharacter,value);}},{key:"upAxis",get:function get(){return this._upAxis;},set:function set(value){this._upAxis=value;var btUpAxis=CharacterController._btTempVector30;Utils3D._convertToBulletVec3(value,btUpAxis,false);ILaya3D.Physics3D._bullet.btKinematicCharacterController_setUp(this._btKinematicCharacter,btUpAxis);}}]);return CharacterController;}(PhysicsComponent);CharacterController.UPAXIS_X=0;CharacterController.UPAXIS_Y=1;CharacterController.UPAXIS_Z=2;var PhysicsTriggerComponent=/*#__PURE__*/function(_PhysicsComponent2){_inheritsLoose(PhysicsTriggerComponent,_PhysicsComponent2);function PhysicsTriggerComponent(collisionGroup,canCollideWith){var _this12;_this12=_PhysicsComponent2.call(this,collisionGroup,canCollideWith)||this;_this12._isTrigger=false;return _this12;}var _proto24=PhysicsTriggerComponent.prototype;_proto24._onAdded=function _onAdded(){_PhysicsComponent2.prototype._onAdded.call(this);this.isTrigger=this._isTrigger;};_proto24._cloneTo=function _cloneTo(dest){_PhysicsComponent2.prototype._cloneTo.call(this,dest);dest.isTrigger=this._isTrigger;};_createClass(PhysicsTriggerComponent,[{key:"isTrigger",get:function get(){return this._isTrigger;},set:function set(value){this._isTrigger=value;var bt=ILaya3D.Physics3D._bullet;if(this._btColliderObject){var flags=bt.btCollisionObject_getCollisionFlags(this._btColliderObject);if(value){if((flags&PhysicsComponent.COLLISIONFLAGS_NO_CONTACT_RESPONSE)===0)bt.btCollisionObject_setCollisionFlags(this._btColliderObject,flags|PhysicsComponent.COLLISIONFLAGS_NO_CONTACT_RESPONSE);}else {if((flags&PhysicsComponent.COLLISIONFLAGS_NO_CONTACT_RESPONSE)!==0)bt.btCollisionObject_setCollisionFlags(this._btColliderObject,flags^PhysicsComponent.COLLISIONFLAGS_NO_CONTACT_RESPONSE);}}}}]);return PhysicsTriggerComponent;}(PhysicsComponent);var Rigidbody3D=/*#__PURE__*/function(_PhysicsTriggerCompon){_inheritsLoose(Rigidbody3D,_PhysicsTriggerCompon);function Rigidbody3D(collisionGroup,canCollideWith){var _this13;if(collisionGroup===void 0){collisionGroup=Physics3DUtils.COLLISIONFILTERGROUP_DEFAULTFILTER;}if(canCollideWith===void 0){canCollideWith=Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER;}_this13=_PhysicsTriggerCompon.call(this,collisionGroup,canCollideWith)||this;_this13._isKinematic=false;_this13._mass=1.0;_this13._gravity=new Vector3(0,-10,0);_this13._angularDamping=0.0;_this13._linearDamping=0.0;_this13._overrideGravity=false;_this13._totalTorque=new Vector3(0,0,0);_this13._totalForce=new Vector3(0,0,0);_this13._linearVelocity=new Vector3();_this13._angularVelocity=new Vector3();_this13._linearFactor=new Vector3(1,1,1);_this13._angularFactor=new Vector3(1,1,1);_this13._detectCollisions=true;_this13._controlBySimulation=true;return _this13;}Rigidbody3D.__init__=function __init__(){var bt=ILaya3D.Physics3D._bullet;Rigidbody3D._btTempVector30=bt.btVector3_create(0,0,0);Rigidbody3D._btTempVector31=bt.btVector3_create(0,0,0);Rigidbody3D._btVector3Zero=bt.btVector3_create(0,0,0);Rigidbody3D._btInertia=bt.btVector3_create(0,0,0);Rigidbody3D._btImpulse=bt.btVector3_create(0,0,0);Rigidbody3D._btImpulseOffset=bt.btVector3_create(0,0,0);Rigidbody3D._btGravity=bt.btVector3_create(0,0,0);Rigidbody3D._btTransform0=bt.btTransform_create();};var _proto25=Rigidbody3D.prototype;_proto25._updateMass=function _updateMass(mass){if(this._btColliderObject&&this._colliderShape){var bt=ILaya3D.Physics3D._bullet;bt.btCollisionShape_calculateLocalInertia(this._colliderShape._btShape,mass,Rigidbody3D._btInertia);bt.btRigidBody_setMassProps(this._btColliderObject,mass,Rigidbody3D._btInertia);bt.btRigidBody_updateInertiaTensor(this._btColliderObject);}};_proto25._onScaleChange=function _onScaleChange(scale){_PhysicsTriggerCompon.prototype._onScaleChange.call(this,scale);this._updateMass(this._isKinematic?0:this._mass);};_proto25._derivePhysicsTransformation=function _derivePhysicsTransformation(force){var bt=ILaya3D.Physics3D._bullet;var btColliderObject=this._btColliderObject;var oriTransform=bt.btCollisionObject_getWorldTransform(btColliderObject);var transform=Rigidbody3D._btTransform0;bt.btTransform_equal(transform,oriTransform);this._innerDerivePhysicsTransformation(transform,force);bt.btRigidBody_setCenterOfMassTransform(btColliderObject,transform);};_proto25._onAdded=function _onAdded(){var bt=ILaya3D.Physics3D._bullet;var motionState=bt.layaMotionState_create();bt.layaMotionState_set_rigidBodyID(motionState,this._id);this._btLayaMotionState=motionState;var constructInfo=bt.btRigidBodyConstructionInfo_create(0.0,motionState,null,Rigidbody3D._btVector3Zero);var btRigid=bt.btRigidBody_create(constructInfo);bt.btCollisionObject_setUserIndex(btRigid,this.id);this._btColliderObject=btRigid;_PhysicsTriggerCompon.prototype._onAdded.call(this);this.mass=this._mass;this.linearFactor=this._linearFactor;this.angularFactor=this._angularFactor;this.linearDamping=this._linearDamping;this.angularDamping=this._angularDamping;this.overrideGravity=this._overrideGravity;this.gravity=this._gravity;this.isKinematic=this._isKinematic;bt.btRigidBodyConstructionInfo_destroy(constructInfo);};_proto25._onEnable=function _onEnable(){_PhysicsTriggerCompon.prototype._onEnable.call(this);if(this._constaintRigidbodyA){if(this._constaintRigidbodyA.connectedBody._simulation){this._constaintRigidbodyA._createConstraint();this._constaintRigidbodyA._onEnable();}}if(this._constaintRigidbodyB){if(this._constaintRigidbodyB.ownBody._simulation){this._constaintRigidbodyB._createConstraint();this._constaintRigidbodyB._onEnable();}}};_proto25._onShapeChange=function _onShapeChange(colShape){_PhysicsTriggerCompon.prototype._onShapeChange.call(this,colShape);if(this._isKinematic){this._updateMass(0);}else {var bt=ILaya3D.Physics3D._bullet;bt.btRigidBody_setCenterOfMassTransform(this._btColliderObject,bt.btCollisionObject_getWorldTransform(this._btColliderObject));this._updateMass(this._mass);}};_proto25._parse=function _parse(data){data.friction!=null&&(this.friction=data.friction);data.rollingFriction!=null&&(this.rollingFriction=data.rollingFriction);data.restitution!=null&&(this.restitution=data.restitution);data.isTrigger!=null&&(this.isTrigger=data.isTrigger);data.mass!=null&&(this.mass=data.mass);data.linearDamping!=null&&(this.linearDamping=data.linearDamping);data.angularDamping!=null&&(this.angularDamping=data.angularDamping);data.overrideGravity!=null&&(this.overrideGravity=data.overrideGravity);if(data.linearFactor!=null){var linFac=this.linearFactor;linFac.fromArray(data.linearFactor);this.linearFactor=linFac;}if(data.angularFactor!=null){var angFac=this.angularFactor;angFac.fromArray(data.angularFactor);this.angularFactor=angFac;}if(data.gravity){this.gravity.fromArray(data.gravity);this.gravity=this.gravity;}_PhysicsTriggerCompon.prototype._parse.call(this,data);this._parseShape(data.shapes);data.isKinematic!=null&&(this._isKinematic=data.isKinematic);};_proto25._onDestroy=function _onDestroy(){ILaya3D.Physics3D._bullet.btMotionState_destroy(this._btLayaMotionState);_PhysicsTriggerCompon.prototype._onDestroy.call(this);this._btLayaMotionState=null;this._gravity=null;this._totalTorque=null;this._linearVelocity=null;this._angularVelocity=null;this._linearFactor=null;this._angularFactor=null;if(this.constaintRigidbodyA)this.constaintRigidbodyA._breakConstrained();if(this.constaintRigidbodyB){this.constaintRigidbodyB.connectedBody=null;this.constaintRigidbodyB._onDisable();}};_proto25._addToSimulation=function _addToSimulation(){this._simulation._addRigidBody(this,this._collisionGroup,this._detectCollisions?this._canCollideWith:0);};_proto25._removeFromSimulation=function _removeFromSimulation(){this._simulation._removeRigidBody(this);};_proto25._cloneTo=function _cloneTo(dest){_PhysicsTriggerCompon.prototype._cloneTo.call(this,dest);var destRigidbody3D=dest;destRigidbody3D.isKinematic=this._isKinematic;destRigidbody3D.mass=this._mass;destRigidbody3D.gravity=this._gravity;destRigidbody3D.angularDamping=this._angularDamping;destRigidbody3D.linearDamping=this._linearDamping;destRigidbody3D.overrideGravity=this._overrideGravity;destRigidbody3D.linearVelocity=this._linearVelocity;destRigidbody3D.angularVelocity=this._angularVelocity;destRigidbody3D.linearFactor=this._linearFactor;destRigidbody3D.angularFactor=this._angularFactor;destRigidbody3D.detectCollisions=this._detectCollisions;};_proto25.applyForce=function applyForce(force,localOffset){if(localOffset===void 0){localOffset=null;}if(this._btColliderObject==null)throw "Attempted to call a Physics function that is avaliable only when the Entity has been already added to the Scene.";var bt=ILaya3D.Physics3D._bullet;var btForce=Rigidbody3D._btTempVector30;bt.btVector3_setValue(btForce,-force.x,force.y,force.z);if(localOffset){var btOffset=Rigidbody3D._btTempVector31;bt.btVector3_setValue(btOffset,-localOffset.x,localOffset.y,localOffset.z);bt.btRigidBody_applyForce(this._btColliderObject,btForce,btOffset);}else {bt.btRigidBody_applyCentralForce(this._btColliderObject,btForce);}};_proto25.applyTorque=function applyTorque(torque){if(this._btColliderObject==null)throw "Attempted to call a Physics function that is avaliable only when the Entity has been already added to the Scene.";var bullet=ILaya3D.Physics3D._bullet;var btTorque=Rigidbody3D._btTempVector30;bullet.btVector3_setValue(btTorque,-torque.x,torque.y,torque.z);bullet.btRigidBody_applyTorque(this._btColliderObject,btTorque);};_proto25.applyImpulse=function applyImpulse(impulse,localOffset){if(localOffset===void 0){localOffset=null;}if(this._btColliderObject==null)throw "Attempted to call a Physics function that is avaliable only when the Entity has been already added to the Scene.";var bt=ILaya3D.Physics3D._bullet;bt.btVector3_setValue(Rigidbody3D._btImpulse,-impulse.x,impulse.y,impulse.z);if(localOffset){bt.btVector3_setValue(Rigidbody3D._btImpulseOffset,-localOffset.x,localOffset.y,localOffset.z);bt.btRigidBody_applyImpulse(this._btColliderObject,Rigidbody3D._btImpulse,Rigidbody3D._btImpulseOffset);}else {bt.btRigidBody_applyCentralImpulse(this._btColliderObject,Rigidbody3D._btImpulse);}};_proto25.applyTorqueImpulse=function applyTorqueImpulse(torqueImpulse){if(this._btColliderObject==null)throw "Attempted to call a Physics function that is avaliable only when the Entity has been already added to the Scene.";var bt=ILaya3D.Physics3D._bullet;var btTorqueImpulse=Rigidbody3D._btTempVector30;bt.btVector3_setValue(btTorqueImpulse,-torqueImpulse.x,torqueImpulse.y,torqueImpulse.z);bt.btRigidBody_applyTorqueImpulse(this._btColliderObject,btTorqueImpulse);};_proto25.wakeUp=function wakeUp(){this._btColliderObject&&ILaya3D.Physics3D._bullet.btCollisionObject_activate(this._btColliderObject,false);};_proto25.clearForces=function clearForces(){var rigidBody=this._btColliderObject;if(rigidBody==null)throw "Attempted to call a Physics function that is avaliable only when the Entity has been already added to the Scene.";var bt=ILaya3D.Physics3D._bullet;bt.btRigidBody_clearForces(rigidBody);var btZero=Rigidbody3D._btVector3Zero;bt.btCollisionObject_setInterpolationLinearVelocity(rigidBody,btZero);bt.btRigidBody_setLinearVelocity(rigidBody,btZero);bt.btCollisionObject_setInterpolationAngularVelocity(rigidBody,btZero);bt.btRigidBody_setAngularVelocity(rigidBody,btZero);};_createClass(Rigidbody3D,[{key:"mass",get:function get(){return this._mass;},set:function set(value){value=Math.max(value,1e-07);this._mass=value;this._isKinematic||this._updateMass(value);}},{key:"isKinematic",get:function get(){return this._isKinematic;},set:function set(value){this._isKinematic=value;this._controlBySimulation=!value;var bt=ILaya3D.Physics3D._bullet;var canInSimulation=!!(this._simulation&&this._enabled&&this._colliderShape);canInSimulation&&this._removeFromSimulation();var natColObj=this._btColliderObject;var flags=bt.btCollisionObject_getCollisionFlags(natColObj);if(value){flags=flags|PhysicsComponent.COLLISIONFLAGS_KINEMATIC_OBJECT;bt.btCollisionObject_setCollisionFlags(natColObj,flags);bt.btCollisionObject_forceActivationState(this._btColliderObject,PhysicsComponent.ACTIVATIONSTATE_DISABLE_DEACTIVATION);this._enableProcessCollisions=false;this._updateMass(0);}else {if((flags&PhysicsComponent.COLLISIONFLAGS_KINEMATIC_OBJECT)>0)flags=flags^PhysicsComponent.COLLISIONFLAGS_KINEMATIC_OBJECT;bt.btCollisionObject_setCollisionFlags(natColObj,flags);bt.btCollisionObject_setActivationState(this._btColliderObject,PhysicsComponent.ACTIVATIONSTATE_ACTIVE_TAG);this._enableProcessCollisions=true;this._updateMass(this._mass);}var btZero=Rigidbody3D._btVector3Zero;bt.btCollisionObject_setInterpolationLinearVelocity(natColObj,btZero);bt.btRigidBody_setLinearVelocity(natColObj,btZero);bt.btCollisionObject_setInterpolationAngularVelocity(natColObj,btZero);bt.btRigidBody_setAngularVelocity(natColObj,btZero);canInSimulation&&this._addToSimulation();}},{key:"linearDamping",get:function get(){return this._linearDamping;},set:function set(value){this._linearDamping=value;if(this._btColliderObject)ILaya3D.Physics3D._bullet.btRigidBody_setDamping(this._btColliderObject,value,this._angularDamping);}},{key:"angularDamping",get:function get(){return this._angularDamping;},set:function set(value){this._angularDamping=value;if(this._btColliderObject)ILaya3D.Physics3D._bullet.btRigidBody_setDamping(this._btColliderObject,this._linearDamping,value);}},{key:"overrideGravity",get:function get(){return this._overrideGravity;},set:function set(value){this._overrideGravity=value;var bt=ILaya3D.Physics3D._bullet;if(this._btColliderObject){var flag=bt.btRigidBody_getFlags(this._btColliderObject);if(value){if((flag&Rigidbody3D._BT_DISABLE_WORLD_GRAVITY)===0)bt.btRigidBody_setFlags(this._btColliderObject,flag|Rigidbody3D._BT_DISABLE_WORLD_GRAVITY);}else {if((flag&Rigidbody3D._BT_DISABLE_WORLD_GRAVITY)>0)bt.btRigidBody_setFlags(this._btColliderObject,flag^Rigidbody3D._BT_DISABLE_WORLD_GRAVITY);}}}},{key:"gravity",get:function get(){return this._gravity;},set:function set(value){this._gravity=value;var bt=ILaya3D.Physics3D._bullet;bt.btVector3_setValue(Rigidbody3D._btGravity,-value.x,value.y,value.z);bt.btRigidBody_setGravity(this._btColliderObject,Rigidbody3D._btGravity);}},{key:"totalForce",get:function get(){if(this._btColliderObject){var btTotalForce=ILaya3D.Physics3D._bullet.btRigidBody_getTotalForce(this._btColliderObject);Utils3D._convertToLayaVec3(btTotalForce,this._totalForce,true);return this._totalForce;}return null;}},{key:"linearFactor",get:function get(){return this._linearFactor;},set:function set(value){this._linearFactor=value;var btValue=Rigidbody3D._btTempVector30;Utils3D._convertToBulletVec3(value,btValue,false);ILaya3D.Physics3D._bullet.btRigidBody_setLinearFactor(this._btColliderObject,btValue);}},{key:"linearVelocity",get:function get(){if(this._btColliderObject)Utils3D._convertToLayaVec3(ILaya3D.Physics3D._bullet.btRigidBody_getLinearVelocity(this._btColliderObject),this._linearVelocity,true);return this._linearVelocity;},set:function set(value){this._linearVelocity=value;if(this._btColliderObject){var btValue=Rigidbody3D._btTempVector30;Utils3D._convertToBulletVec3(value,btValue,true);this.isSleeping&&this.wakeUp();ILaya3D.Physics3D._bullet.btRigidBody_setLinearVelocity(this._btColliderObject,btValue);}}},{key:"angularFactor",get:function get(){return this._angularFactor;},set:function set(value){this._angularFactor=value;var btValue=Rigidbody3D._btTempVector30;Utils3D._convertToBulletVec3(value,btValue,false);ILaya3D.Physics3D._bullet.btRigidBody_setAngularFactor(this._btColliderObject,btValue);}},{key:"angularVelocity",get:function get(){if(this._btColliderObject)Utils3D._convertToLayaVec3(ILaya3D.Physics3D._bullet.btRigidBody_getAngularVelocity(this._btColliderObject),this._angularVelocity,true);return this._angularVelocity;},set:function set(value){this._angularVelocity=value;if(this._btColliderObject){var btValue=Rigidbody3D._btTempVector30;Utils3D._convertToBulletVec3(value,btValue,true);this.isSleeping&&this.wakeUp();ILaya3D.Physics3D._bullet.btRigidBody_setAngularVelocity(this._btColliderObject,btValue);}}},{key:"totalTorque",get:function get(){if(this._btColliderObject){var btTotalTorque=ILaya3D.Physics3D._bullet.btRigidBody_getTotalTorque(this._btColliderObject);Utils3D._convertToLayaVec3(btTotalTorque,this._totalTorque,true);return this._totalTorque;}return null;}},{key:"detectCollisions",get:function get(){return this._detectCollisions;},set:function set(value){if(this._detectCollisions!==value){this._detectCollisions=value;if(this._colliderShape&&this._enabled&&this._simulation){this._simulation._removeRigidBody(this);this._simulation._addRigidBody(this,this._collisionGroup,value?this._canCollideWith:0);}}}},{key:"isSleeping",get:function get(){if(this._btColliderObject)return ILaya3D.Physics3D._bullet.btCollisionObject_getActivationState(this._btColliderObject)===PhysicsComponent.ACTIVATIONSTATE_ISLAND_SLEEPING;return false;}},{key:"sleepLinearVelocity",get:function get(){return ILaya3D.Physics3D._bullet.btRigidBody_getLinearSleepingThreshold(this._btColliderObject);},set:function set(value){var bt=ILaya3D.Physics3D._bullet;bt.btRigidBody_setSleepingThresholds(this._btColliderObject,value,bt.btRigidBody_getAngularSleepingThreshold(this._btColliderObject));}},{key:"sleepAngularVelocity",get:function get(){return ILaya3D.Physics3D._bullet.btRigidBody_getAngularSleepingThreshold(this._btColliderObject);},set:function set(value){var bt=ILaya3D.Physics3D._bullet;bt.btRigidBody_setSleepingThresholds(this._btColliderObject,bt.btRigidBody_getLinearSleepingThreshold(this._btColliderObject),value);}},{key:"btColliderObject",get:function get(){return this._btColliderObject;}},{key:"constaintRigidbodyA",set:function set(value){this._constaintRigidbodyA=value;},get:function get(){return this._constaintRigidbodyA;}},{key:"constaintRigidbodyB",set:function set(value){this._constaintRigidbodyB=value;},get:function get(){return this._constaintRigidbodyB;}}]);return Rigidbody3D;}(PhysicsTriggerComponent);Rigidbody3D.TYPE_STATIC=0;Rigidbody3D.TYPE_DYNAMIC=1;Rigidbody3D.TYPE_KINEMATIC=2;Rigidbody3D._BT_DISABLE_WORLD_GRAVITY=1;Rigidbody3D._BT_ENABLE_GYROPSCOPIC_FORCE=2;var Physics3D=/*#__PURE__*/function(){function Physics3D(){}Physics3D.__bulletinit__=function __bulletinit__(){this._bullet=window.Physics3D;if(this._bullet){StaticPlaneColliderShape.__init__();ColliderShape.__init__();CompoundColliderShape.__init__();PhysicsComponent.__init__();PhysicsSimulation.__init__();BoxColliderShape.__init__();CylinderColliderShape.__init__();CharacterController.__init__();Rigidbody3D.__init__();}};Physics3D.__cannoninit__=function __cannoninit__(){this._cannon=window.CANNON;if(!this._cannon)return;Laya.CannonColliderShape.__init__();Laya.CannonPhysicsComponent.__init__();Laya.CannonPhysicsSimulation.__init__();Laya.CannonBoxColliderShape.__init__();Laya.CannonRigidbody3D.__init__();};return Physics3D;}();Physics3D._bullet=null;Physics3D._cannon=null;Physics3D._enablePhysics=false;var Config3D=/*#__PURE__*/function(){function Config3D(){this._defaultPhysicsMemory=16;this._maxLightCount=32;this._lightClusterCount=new Vector3(12,12,12);this._editerEnvironment=false;this.isAntialias=true;this.isAlpha=false;this.premultipliedAlpha=true;this.isStencil=true;this.enableMultiLight=true;this.octreeCulling=false;this.octreeInitialSize=64.0;this.octreeInitialCenter=new Vector3(0,0,0);this.octreeMinNodeSize=2.0;this.octreeLooseness=1.25;this.debugFrustumCulling=false;this.pbrRenderQuality=exports.PBRRenderQuality.High;this.isUseCannonPhysicsEngine=false;this._maxAreaLightCountPerClusterAverage=Math.min(Math.floor(2048/this._lightClusterCount.z-1)*4,this._maxLightCount);}var _proto26=Config3D.prototype;_proto26.cloneTo=function cloneTo(dest){var destConfig3D=dest;destConfig3D._defaultPhysicsMemory=this._defaultPhysicsMemory;destConfig3D._editerEnvironment=this._editerEnvironment;destConfig3D.isAntialias=this.isAntialias;destConfig3D.isAlpha=this.isAlpha;destConfig3D.premultipliedAlpha=this.premultipliedAlpha;destConfig3D.isStencil=this.isStencil;destConfig3D.octreeCulling=this.octreeCulling;this.octreeInitialCenter.cloneTo(destConfig3D.octreeInitialCenter);destConfig3D.octreeInitialSize=this.octreeInitialSize;destConfig3D.octreeMinNodeSize=this.octreeMinNodeSize;destConfig3D.octreeLooseness=this.octreeLooseness;destConfig3D.debugFrustumCulling=this.debugFrustumCulling;destConfig3D.maxLightCount=this.maxLightCount;destConfig3D.enableMultiLight=this.enableMultiLight;var lightClusterCount=destConfig3D.lightClusterCount;this.lightClusterCount.cloneTo(lightClusterCount);destConfig3D.lightClusterCount=lightClusterCount;destConfig3D.pbrRenderQuality=this.pbrRenderQuality;};_proto26.clone=function clone(){var dest=new Config3D();this.cloneTo(dest);return dest;};_createClass(Config3D,[{key:"defaultPhysicsMemory",get:function get(){return this._defaultPhysicsMemory;},set:function set(value){if(value<16)throw "defaultPhysicsMemory must large than 16M";this._defaultPhysicsMemory=value;}},{key:"maxLightCount",get:function get(){return this._maxLightCount;},set:function set(value){if(value>2048){this._maxLightCount=2048;console.warn("Config3D: maxLightCount must less equal 2048.");}else {this._maxLightCount=value;}}},{key:"lightClusterCount",get:function get(){return this._lightClusterCount;},set:function set(value){if(value.x>128||value.y>128||value.z>128){this._lightClusterCount.setValue(Math.min(value.x,128),Math.min(value.y,128),Math.min(value.z,128));console.warn("Config3D: lightClusterCount X and Y、Z must less equal 128.");}else {value.cloneTo(this._lightClusterCount);}var maxAreaLightCountWithZ=Math.floor(2048/this._lightClusterCount.z-1)*4;if(maxAreaLightCountWithZ<this._maxLightCount)console.warn("Config3D: if the area light(PointLight、SpotLight) count is large than "+maxAreaLightCountWithZ+",maybe the far away culster will ingonre some light.");this._maxAreaLightCountPerClusterAverage=Math.min(maxAreaLightCountWithZ,this._maxLightCount);}}],[{key:"useCannonPhysics",get:function get(){return Config3D._config.isUseCannonPhysicsEngine;},set:function set(value){Config3D._config.isUseCannonPhysicsEngine=value;if(value){Physics3D.__cannoninit__();if(!ILaya3D.Scene3D.cannonPhysicsSettings)ILaya3D.Scene3D.cannonPhysicsSettings=new Laya.CannonPhysicsSettings();}}}]);return Config3D;}();Config3D._config=new Config3D();window.Config3D=Config3D;var KeyframeNode=/*#__PURE__*/function(){function KeyframeNode(){this._ownerPath=[];this._propertys=[];this._keyFrames=[];}var _proto27=KeyframeNode.prototype;_proto27._setOwnerPathCount=function _setOwnerPathCount(value){this._ownerPath.length=value;};_proto27._setOwnerPathByIndex=function _setOwnerPathByIndex(index,value){this._ownerPath[index]=value;};_proto27._joinOwnerPath=function _joinOwnerPath(sep){return this._ownerPath.join(sep);};_proto27._setPropertyCount=function _setPropertyCount(value){this._propertys.length=value;};_proto27._setPropertyByIndex=function _setPropertyByIndex(index,value){this._propertys[index]=value;};_proto27._joinProperty=function _joinProperty(sep){return this._propertys.join(sep);};_proto27._setKeyframeCount=function _setKeyframeCount(value){this._keyFrames.length=value;};_proto27._setKeyframeByIndex=function _setKeyframeByIndex(index,value){this._keyFrames[index]=value;};_proto27.getOwnerPathByIndex=function getOwnerPathByIndex(index){return this._ownerPath[index];};_proto27.getPropertyByIndex=function getPropertyByIndex(index){return this._propertys[index];};_proto27.getKeyframeByIndex=function getKeyframeByIndex(index){return this._keyFrames[index];};_createClass(KeyframeNode,[{key:"ownerPathCount",get:function get(){return this._ownerPath.length;}},{key:"propertyCount",get:function get(){return this._propertys.length;}},{key:"keyFramesCount",get:function get(){return this._keyFrames.length;}}]);return KeyframeNode;}();var AnimationEvent=function AnimationEvent(){};var Keyframe=/*#__PURE__*/function(){function Keyframe(){}var _proto28=Keyframe.prototype;_proto28.cloneTo=function cloneTo(destObject){var destKeyFrame=destObject;destKeyFrame.time=this.time;};_proto28.clone=function clone(){var dest=new Keyframe();this.cloneTo(dest);return dest;};return Keyframe;}();var FloatKeyframe=/*#__PURE__*/function(_Keyframe){_inheritsLoose(FloatKeyframe,_Keyframe);function FloatKeyframe(){return _Keyframe.call(this)||this;}var _proto29=FloatKeyframe.prototype;_proto29.cloneTo=function cloneTo(destObject){_Keyframe.prototype.cloneTo.call(this,destObject);var destKeyFrame=destObject;destKeyFrame.inTangent=this.inTangent;destKeyFrame.outTangent=this.outTangent;destKeyFrame.value=this.value;};return FloatKeyframe;}(Keyframe);var QuaternionKeyframe=/*#__PURE__*/function(_Keyframe2){_inheritsLoose(QuaternionKeyframe,_Keyframe2);function QuaternionKeyframe(){var _this14;_this14=_Keyframe2.call(this)||this;_this14.inTangent=new Vector4();_this14.outTangent=new Vector4();_this14.value=new Quaternion();return _this14;}var _proto30=QuaternionKeyframe.prototype;_proto30.cloneTo=function cloneTo(dest){_Keyframe2.prototype.cloneTo.call(this,dest);var destKeyFarme=dest;this.inTangent.cloneTo(destKeyFarme.inTangent);this.outTangent.cloneTo(destKeyFarme.outTangent);this.value.cloneTo(destKeyFarme.value);};return QuaternionKeyframe;}(Keyframe);var Vector3Keyframe=/*#__PURE__*/function(_Keyframe3){_inheritsLoose(Vector3Keyframe,_Keyframe3);function Vector3Keyframe(){var _this15;_this15=_Keyframe3.call(this)||this;_this15.inTangent=new Vector3();_this15.outTangent=new Vector3();_this15.value=new Vector3();return _this15;}var _proto31=Vector3Keyframe.prototype;_proto31.cloneTo=function cloneTo(dest){_Keyframe3.prototype.cloneTo.call(this,dest);var destKeyFarme=dest;this.inTangent.cloneTo(destKeyFarme.inTangent);this.outTangent.cloneTo(destKeyFarme.outTangent);this.value.cloneTo(destKeyFarme.value);};return Vector3Keyframe;}(Keyframe);var AnimationClipParser03=/*#__PURE__*/function(){function AnimationClipParser03(){}AnimationClipParser03.READ_DATA=function READ_DATA(){AnimationClipParser03._DATA.offset=AnimationClipParser03._reader.getUint32();AnimationClipParser03._DATA.size=AnimationClipParser03._reader.getUint32();};AnimationClipParser03.READ_BLOCK=function READ_BLOCK(){var count=AnimationClipParser03._BLOCK.count=AnimationClipParser03._reader.getUint16();var blockStarts=AnimationClipParser03._BLOCK.blockStarts=[];var blockLengths=AnimationClipParser03._BLOCK.blockLengths=[];for(var i=0;i<count;i++){blockStarts.push(AnimationClipParser03._reader.getUint32());blockLengths.push(AnimationClipParser03._reader.getUint32());}};AnimationClipParser03.READ_STRINGS=function READ_STRINGS(){var offset=AnimationClipParser03._reader.getUint32();var count=AnimationClipParser03._reader.getUint16();var prePos=AnimationClipParser03._reader.pos;AnimationClipParser03._reader.pos=offset+AnimationClipParser03._DATA.offset;for(var i=0;i<count;i++){AnimationClipParser03._strings[i]=AnimationClipParser03._reader.readUTFString();}AnimationClipParser03._reader.pos=prePos;};AnimationClipParser03.parse=function parse(clip,reader){AnimationClipParser03._animationClip=clip;AnimationClipParser03._reader=reader;var arrayBuffer=reader.__getBuffer();AnimationClipParser03.READ_DATA();AnimationClipParser03.READ_BLOCK();AnimationClipParser03.READ_STRINGS();for(var i=0,n=AnimationClipParser03._BLOCK.count;i<n;i++){var index=reader.getUint16();var blockName=AnimationClipParser03._strings[index];var fn=AnimationClipParser03["READ_"+blockName];if(fn==null)throw new Error("model file err,no this function:"+index+" "+blockName);else fn.call(null);}};AnimationClipParser03.READ_ANIMATIONS=function READ_ANIMATIONS(){var i,j;var node;var reader=AnimationClipParser03._reader;var buffer=reader.__getBuffer();var startTimeTypes=[];var startTimeTypeCount=reader.getUint16();startTimeTypes.length=startTimeTypeCount;for(i=0;i<startTimeTypeCount;i++){startTimeTypes[i]=reader.getFloat32();}var clip=AnimationClipParser03._animationClip;clip.name=AnimationClipParser03._strings[reader.getUint16()];var clipDur=clip._duration=reader.getFloat32();clip.islooping=!!reader.getByte();clip._frameRate=reader.getInt16();var nodeCount=reader.getInt16();var nodes=clip._nodes;nodes.count=nodeCount;var nodesMap=clip._nodesMap={};var nodesDic=clip._nodesDic={};for(i=0;i<nodeCount;i++){node=new KeyframeNode();nodes.setNodeByIndex(i,node);node._indexInList=i;var type=node.type=reader.getUint8();var pathLength=reader.getUint16();node._setOwnerPathCount(pathLength);for(j=0;j<pathLength;j++){node._setOwnerPathByIndex(j,AnimationClipParser03._strings[reader.getUint16()]);}var nodePath=node._joinOwnerPath("/");var mapArray=nodesMap[nodePath];mapArray||(nodesMap[nodePath]=mapArray=[]);mapArray.push(node);node.propertyOwner=AnimationClipParser03._strings[reader.getUint16()];var propertyLength=reader.getUint16();node._setPropertyCount(propertyLength);for(j=0;j<propertyLength;j++){node._setPropertyByIndex(j,AnimationClipParser03._strings[reader.getUint16()]);}var fullPath=nodePath+"."+node.propertyOwner+"."+node._joinProperty(".");nodesDic[fullPath]=node;node.fullPath=fullPath;var keyframeCount=reader.getUint16();node._setKeyframeCount(keyframeCount);var startTime;for(j=0;j<keyframeCount;j++){switch(type){case 0:var floatKeyframe=new FloatKeyframe();node._setKeyframeByIndex(j,floatKeyframe);startTime=floatKeyframe.time=startTimeTypes[reader.getUint16()];floatKeyframe.inTangent=reader.getFloat32();floatKeyframe.outTangent=reader.getFloat32();floatKeyframe.value=reader.getFloat32();break;case 1:case 3:case 4:var floatArrayKeyframe=new Vector3Keyframe();node._setKeyframeByIndex(j,floatArrayKeyframe);startTime=floatArrayKeyframe.time=startTimeTypes[reader.getUint16()];if(Laya.Render.supportWebGLPlusAnimation){var data=floatArrayKeyframe.data=new Float32Array(3*3);for(var k=0;k<3;k++){data[k]=reader.getFloat32();}for(k=0;k<3;k++){data[3+k]=reader.getFloat32();}for(k=0;k<3;k++){data[6+k]=reader.getFloat32();}}else {var inTangent=floatArrayKeyframe.inTangent;var outTangent=floatArrayKeyframe.outTangent;var value=floatArrayKeyframe.value;inTangent.x=reader.getFloat32();inTangent.y=reader.getFloat32();inTangent.z=reader.getFloat32();outTangent.x=reader.getFloat32();outTangent.y=reader.getFloat32();outTangent.z=reader.getFloat32();value.x=reader.getFloat32();value.y=reader.getFloat32();value.z=reader.getFloat32();}break;case 2:var quaArrayKeyframe=new QuaternionKeyframe();node._setKeyframeByIndex(j,quaArrayKeyframe);startTime=quaArrayKeyframe.time=startTimeTypes[reader.getUint16()];if(Laya.Render.supportWebGLPlusAnimation){data=quaArrayKeyframe.data=new Float32Array(3*4);for(k=0;k<4;k++){data[k]=reader.getFloat32();}for(k=0;k<4;k++){data[4+k]=reader.getFloat32();}for(k=0;k<4;k++){data[8+k]=reader.getFloat32();}}else {var inTangentQua=quaArrayKeyframe.inTangent;var outTangentQua=quaArrayKeyframe.outTangent;var valueQua=quaArrayKeyframe.value;inTangentQua.x=reader.getFloat32();inTangentQua.y=reader.getFloat32();inTangentQua.z=reader.getFloat32();inTangentQua.w=reader.getFloat32();outTangentQua.x=reader.getFloat32();outTangentQua.y=reader.getFloat32();outTangentQua.z=reader.getFloat32();outTangentQua.w=reader.getFloat32();valueQua.x=reader.getFloat32();valueQua.y=reader.getFloat32();valueQua.z=reader.getFloat32();valueQua.w=reader.getFloat32();}break;default:throw "AnimationClipParser03:unknown type.";}}}var eventCount=reader.getUint16();for(i=0;i<eventCount;i++){var event=new AnimationEvent();event.time=Math.min(clipDur,reader.getFloat32());event.eventName=AnimationClipParser03._strings[reader.getUint16()];var params;var paramCount=reader.getUint16();paramCount>0&&(event.params=params=[]);for(j=0;j<paramCount;j++){var eventType=reader.getByte();switch(eventType){case 0:params.push(!!reader.getByte());break;case 1:params.push(reader.getInt32());break;case 2:params.push(reader.getFloat32());break;case 3:params.push(AnimationClipParser03._strings[reader.getUint16()]);break;default:throw new Error("unknown type.");}}clip.addEvent(event);}};return AnimationClipParser03;}();AnimationClipParser03._strings=[];AnimationClipParser03._BLOCK={count:0};AnimationClipParser03._DATA={offset:0,size:0};var HalfFloatUtils=/*#__PURE__*/function(){function HalfFloatUtils(){}HalfFloatUtils.__init__=function __init__(){for(var i=0;i<256;++i){var e=i-127;if(e<-27){HalfFloatUtils._baseTable[i|0x000]=0x0000;HalfFloatUtils._baseTable[i|0x100]=0x8000;HalfFloatUtils._shiftTable[i|0x000]=24;HalfFloatUtils._shiftTable[i|0x100]=24;}else if(e<-14){HalfFloatUtils._baseTable[i|0x000]=0x0400>>-e-14;HalfFloatUtils._baseTable[i|0x100]=0x0400>>-e-14|0x8000;HalfFloatUtils._shiftTable[i|0x000]=-e-1;HalfFloatUtils._shiftTable[i|0x100]=-e-1;}else if(e<=15){HalfFloatUtils._baseTable[i|0x000]=e+15<<10;HalfFloatUtils._baseTable[i|0x100]=e+15<<10|0x8000;HalfFloatUtils._shiftTable[i|0x000]=13;HalfFloatUtils._shiftTable[i|0x100]=13;}else if(e<128){HalfFloatUtils._baseTable[i|0x000]=0x7c00;HalfFloatUtils._baseTable[i|0x100]=0xfc00;HalfFloatUtils._shiftTable[i|0x000]=24;HalfFloatUtils._shiftTable[i|0x100]=24;}else {HalfFloatUtils._baseTable[i|0x000]=0x7c00;HalfFloatUtils._baseTable[i|0x100]=0xfc00;HalfFloatUtils._shiftTable[i|0x000]=13;HalfFloatUtils._shiftTable[i|0x100]=13;}}HalfFloatUtils._mantissaTable[0]=0;for(i=1;i<1024;++i){var m=i<<13;e=0;while((m&0x00800000)===0){e-=0x00800000;m<<=1;}m&=~0x00800000;e+=0x38800000;HalfFloatUtils._mantissaTable[i]=m|e;}for(i=1024;i<2048;++i){HalfFloatUtils._mantissaTable[i]=0x38000000+(i-1024<<13);}HalfFloatUtils._exponentTable[0]=0;for(i=1;i<31;++i){HalfFloatUtils._exponentTable[i]=i<<23;}HalfFloatUtils._exponentTable[31]=0x47800000;HalfFloatUtils._exponentTable[32]=0x80000000;for(i=33;i<63;++i){HalfFloatUtils._exponentTable[i]=0x80000000+(i-32<<23);}HalfFloatUtils._exponentTable[63]=0xc7800000;HalfFloatUtils._offsetTable[0]=0;for(i=1;i<64;++i){if(i===32){HalfFloatUtils._offsetTable[i]=0;}else {HalfFloatUtils._offsetTable[i]=1024;}}};HalfFloatUtils.roundToFloat16Bits=function roundToFloat16Bits(num){HalfFloatUtils._floatView[0]=num;var f=HalfFloatUtils._uint32View[0];var e=f>>23&0x1ff;return HalfFloatUtils._baseTable[e]+((f&0x007fffff)>>HalfFloatUtils._shiftTable[e]);};HalfFloatUtils.convertToNumber=function convertToNumber(float16bits){var m=float16bits>>10;HalfFloatUtils._uint32View[0]=HalfFloatUtils._mantissaTable[HalfFloatUtils._offsetTable[m]+(float16bits&0x3ff)]+HalfFloatUtils._exponentTable[m];return HalfFloatUtils._floatView[0];};return HalfFloatUtils;}();HalfFloatUtils._buffer=new ArrayBuffer(4);HalfFloatUtils._floatView=new Float32Array(HalfFloatUtils._buffer);HalfFloatUtils._uint32View=new Uint32Array(HalfFloatUtils._buffer);HalfFloatUtils._baseTable=new Uint32Array(512);HalfFloatUtils._shiftTable=new Uint32Array(512);HalfFloatUtils._mantissaTable=new Uint32Array(2048);HalfFloatUtils._exponentTable=new Uint32Array(64);HalfFloatUtils._offsetTable=new Uint32Array(64);var AnimationClipParser04=/*#__PURE__*/function(){function AnimationClipParser04(){}AnimationClipParser04.READ_DATA=function READ_DATA(){AnimationClipParser04._DATA.offset=AnimationClipParser04._reader.getUint32();AnimationClipParser04._DATA.size=AnimationClipParser04._reader.getUint32();};AnimationClipParser04.READ_BLOCK=function READ_BLOCK(){var count=AnimationClipParser04._BLOCK.count=AnimationClipParser04._reader.getUint16();var blockStarts=AnimationClipParser04._BLOCK.blockStarts=[];var blockLengths=AnimationClipParser04._BLOCK.blockLengths=[];for(var i=0;i<count;i++){blockStarts.push(AnimationClipParser04._reader.getUint32());blockLengths.push(AnimationClipParser04._reader.getUint32());}};AnimationClipParser04.READ_STRINGS=function READ_STRINGS(){var offset=AnimationClipParser04._reader.getUint32();var count=AnimationClipParser04._reader.getUint16();var prePos=AnimationClipParser04._reader.pos;AnimationClipParser04._reader.pos=offset+AnimationClipParser04._DATA.offset;for(var i=0;i<count;i++){AnimationClipParser04._strings[i]=AnimationClipParser04._reader.readUTFString();}AnimationClipParser04._reader.pos=prePos;};AnimationClipParser04.parse=function parse(clip,reader,version){AnimationClipParser04._animationClip=clip;AnimationClipParser04._reader=reader;AnimationClipParser04._version=version;AnimationClipParser04.READ_DATA();AnimationClipParser04.READ_BLOCK();AnimationClipParser04.READ_STRINGS();for(var i=0,n=AnimationClipParser04._BLOCK.count;i<n;i++){var index=reader.getUint16();var blockName=AnimationClipParser04._strings[index];var fn=AnimationClipParser04["READ_"+blockName];if(fn==null)throw new Error("model file err,no this function:"+index+" "+blockName);else fn.call(null);}AnimationClipParser04._version=null;AnimationClipParser04._reader=null;AnimationClipParser04._animationClip=null;};AnimationClipParser04.READ_ANIMATIONS=function READ_ANIMATIONS(){var i,j;var node;var reader=AnimationClipParser04._reader;var buffer=reader.__getBuffer();var startTimeTypes=[];var startTimeTypeCount=reader.getUint16();startTimeTypes.length=startTimeTypeCount;for(i=0;i<startTimeTypeCount;i++){startTimeTypes[i]=reader.getFloat32();}var clip=AnimationClipParser04._animationClip;clip.name=AnimationClipParser04._strings[reader.getUint16()];var clipDur=clip._duration=reader.getFloat32();clip.islooping=!!reader.getByte();clip._frameRate=reader.getInt16();var nodeCount=reader.getInt16();var nodes=clip._nodes;nodes.count=nodeCount;var nodesMap=clip._nodesMap={};var nodesDic=clip._nodesDic={};for(i=0;i<nodeCount;i++){node=new KeyframeNode();nodes.setNodeByIndex(i,node);node._indexInList=i;var type=node.type=reader.getUint8();var pathLength=reader.getUint16();node._setOwnerPathCount(pathLength);for(j=0;j<pathLength;j++){node._setOwnerPathByIndex(j,AnimationClipParser04._strings[reader.getUint16()]);}var nodePath=node._joinOwnerPath("/");var mapArray=nodesMap[nodePath];mapArray||(nodesMap[nodePath]=mapArray=[]);mapArray.push(node);node.propertyOwner=AnimationClipParser04._strings[reader.getUint16()];var propertyLength=reader.getUint16();node._setPropertyCount(propertyLength);for(j=0;j<propertyLength;j++){node._setPropertyByIndex(j,AnimationClipParser04._strings[reader.getUint16()]);}var fullPath=nodePath+"."+node.propertyOwner+"."+node._joinProperty(".");nodesDic[fullPath]=node;node.fullPath=fullPath;var keyframeCount=reader.getUint16();node._setKeyframeCount(keyframeCount);var startTime;switch(AnimationClipParser04._version){case"LAYAANIMATION:04":for(j=0;j<keyframeCount;j++){switch(type){case 0:var floatKeyframe=new FloatKeyframe();node._setKeyframeByIndex(j,floatKeyframe);startTime=floatKeyframe.time=startTimeTypes[reader.getUint16()];floatKeyframe.inTangent=reader.getFloat32();floatKeyframe.outTangent=reader.getFloat32();floatKeyframe.value=reader.getFloat32();break;case 1:case 3:case 4:var floatArrayKeyframe=new Vector3Keyframe();node._setKeyframeByIndex(j,floatArrayKeyframe);startTime=floatArrayKeyframe.time=startTimeTypes[reader.getUint16()];if(Laya.Render.supportWebGLPlusAnimation){var data=floatArrayKeyframe.data=new Float32Array(3*3);for(var k=0;k<3;k++){data[k]=reader.getFloat32();}for(k=0;k<3;k++){data[3+k]=reader.getFloat32();}for(k=0;k<3;k++){data[6+k]=reader.getFloat32();}}else {var inTangent=floatArrayKeyframe.inTangent;var outTangent=floatArrayKeyframe.outTangent;var value=floatArrayKeyframe.value;inTangent.x=reader.getFloat32();inTangent.y=reader.getFloat32();inTangent.z=reader.getFloat32();outTangent.x=reader.getFloat32();outTangent.y=reader.getFloat32();outTangent.z=reader.getFloat32();value.x=reader.getFloat32();value.y=reader.getFloat32();value.z=reader.getFloat32();}break;case 2:var quaternionKeyframe=new QuaternionKeyframe();node._setKeyframeByIndex(j,quaternionKeyframe);startTime=quaternionKeyframe.time=startTimeTypes[reader.getUint16()];if(Laya.Render.supportWebGLPlusAnimation){data=quaternionKeyframe.data=new Float32Array(3*4);for(k=0;k<4;k++){data[k]=reader.getFloat32();}for(k=0;k<4;k++){data[4+k]=reader.getFloat32();}for(k=0;k<4;k++){data[8+k]=reader.getFloat32();}}else {var inTangentQua=quaternionKeyframe.inTangent;var outTangentQua=quaternionKeyframe.outTangent;var valueQua=quaternionKeyframe.value;inTangentQua.x=reader.getFloat32();inTangentQua.y=reader.getFloat32();inTangentQua.z=reader.getFloat32();inTangentQua.w=reader.getFloat32();outTangentQua.x=reader.getFloat32();outTangentQua.y=reader.getFloat32();outTangentQua.z=reader.getFloat32();outTangentQua.w=reader.getFloat32();valueQua.x=reader.getFloat32();valueQua.y=reader.getFloat32();valueQua.z=reader.getFloat32();valueQua.w=reader.getFloat32();}break;default:throw "AnimationClipParser04:unknown type.";}}break;case"LAYAANIMATION:COMPRESSION_04":for(j=0;j<keyframeCount;j++){switch(type){case 0:floatKeyframe=new FloatKeyframe();node._setKeyframeByIndex(j,floatKeyframe);startTime=floatKeyframe.time=startTimeTypes[reader.getUint16()];floatKeyframe.inTangent=HalfFloatUtils.convertToNumber(reader.getUint16());floatKeyframe.outTangent=HalfFloatUtils.convertToNumber(reader.getUint16());floatKeyframe.value=HalfFloatUtils.convertToNumber(reader.getUint16());break;case 1:case 3:case 4:floatArrayKeyframe=new Vector3Keyframe();node._setKeyframeByIndex(j,floatArrayKeyframe);startTime=floatArrayKeyframe.time=startTimeTypes[reader.getUint16()];if(Laya.Render.supportWebGLPlusAnimation){data=floatArrayKeyframe.data=new Float32Array(3*3);for(k=0;k<3;k++){data[k]=HalfFloatUtils.convertToNumber(reader.getUint16());}for(k=0;k<3;k++){data[3+k]=HalfFloatUtils.convertToNumber(reader.getUint16());}for(k=0;k<3;k++){data[6+k]=HalfFloatUtils.convertToNumber(reader.getUint16());}}else {inTangent=floatArrayKeyframe.inTangent;outTangent=floatArrayKeyframe.outTangent;value=floatArrayKeyframe.value;inTangent.x=HalfFloatUtils.convertToNumber(reader.getUint16());inTangent.y=HalfFloatUtils.convertToNumber(reader.getUint16());inTangent.z=HalfFloatUtils.convertToNumber(reader.getUint16());outTangent.x=HalfFloatUtils.convertToNumber(reader.getUint16());outTangent.y=HalfFloatUtils.convertToNumber(reader.getUint16());outTangent.z=HalfFloatUtils.convertToNumber(reader.getUint16());value.x=HalfFloatUtils.convertToNumber(reader.getUint16());value.y=HalfFloatUtils.convertToNumber(reader.getUint16());value.z=HalfFloatUtils.convertToNumber(reader.getUint16());}break;case 2:quaternionKeyframe=new QuaternionKeyframe();node._setKeyframeByIndex(j,quaternionKeyframe);startTime=quaternionKeyframe.time=startTimeTypes[reader.getUint16()];if(Laya.Render.supportWebGLPlusAnimation){data=quaternionKeyframe.data=new Float32Array(3*4);for(k=0;k<4;k++){data[k]=HalfFloatUtils.convertToNumber(reader.getUint16());}for(k=0;k<4;k++){data[4+k]=HalfFloatUtils.convertToNumber(reader.getUint16());}for(k=0;k<4;k++){data[8+k]=HalfFloatUtils.convertToNumber(reader.getUint16());}}else {inTangentQua=quaternionKeyframe.inTangent;outTangentQua=quaternionKeyframe.outTangent;valueQua=quaternionKeyframe.value;inTangentQua.x=HalfFloatUtils.convertToNumber(reader.getUint16());inTangentQua.y=HalfFloatUtils.convertToNumber(reader.getUint16());inTangentQua.z=HalfFloatUtils.convertToNumber(reader.getUint16());inTangentQua.w=HalfFloatUtils.convertToNumber(reader.getUint16());outTangentQua.x=HalfFloatUtils.convertToNumber(reader.getUint16());outTangentQua.y=HalfFloatUtils.convertToNumber(reader.getUint16());outTangentQua.z=HalfFloatUtils.convertToNumber(reader.getUint16());outTangentQua.w=HalfFloatUtils.convertToNumber(reader.getUint16());valueQua.x=HalfFloatUtils.convertToNumber(reader.getUint16());valueQua.y=HalfFloatUtils.convertToNumber(reader.getUint16());valueQua.z=HalfFloatUtils.convertToNumber(reader.getUint16());valueQua.w=HalfFloatUtils.convertToNumber(reader.getUint16());}break;default:throw "AnimationClipParser04:unknown type.";}}break;}}var eventCount=reader.getUint16();for(i=0;i<eventCount;i++){var event=new AnimationEvent();event.time=Math.min(clipDur,reader.getFloat32());event.eventName=AnimationClipParser04._strings[reader.getUint16()];var params;var paramCount=reader.getUint16();paramCount>0&&(event.params=params=[]);for(j=0;j<paramCount;j++){var eventType=reader.getByte();switch(eventType){case 0:params.push(!!reader.getByte());break;case 1:params.push(reader.getInt32());break;case 2:params.push(reader.getFloat32());break;case 3:params.push(AnimationClipParser04._strings[reader.getUint16()]);break;default:throw new Error("unknown type.");}}clip.addEvent(event);}};return AnimationClipParser04;}();AnimationClipParser04._strings=[];AnimationClipParser04._BLOCK={count:0};AnimationClipParser04._DATA={offset:0,size:0};var KeyframeNodeList=/*#__PURE__*/function(){function KeyframeNodeList(){this._nodes=[];}var _proto32=KeyframeNodeList.prototype;_proto32.getNodeByIndex=function getNodeByIndex(index){return this._nodes[index];};_proto32.setNodeByIndex=function setNodeByIndex(index,node){this._nodes[index]=node;};_createClass(KeyframeNodeList,[{key:"count",get:function get(){return this._nodes.length;},set:function set(value){this._nodes.length=value;}}]);return KeyframeNodeList;}();var AnimationClip=/*#__PURE__*/function(_Laya$Resource){_inheritsLoose(AnimationClip,_Laya$Resource);function AnimationClip(){var _this16;_this16=_Laya$Resource.call(this)||this;_this16._nodes=new KeyframeNodeList();_this16._animationEvents=[];return _this16;}AnimationClip._parse=function _parse(data,propertyParams,constructParams){var clip=new AnimationClip();var reader=new Laya.Byte(data);var version=reader.readUTFString();switch(version){case"LAYAANIMATION:03":AnimationClipParser03.parse(clip,reader);break;case"LAYAANIMATION:04":case"LAYAANIMATION:COMPRESSION_04":AnimationClipParser04.parse(clip,reader,version);break;default:throw "unknown animationClip version.";}return clip;};AnimationClip.load=function load(url,complete){Laya.ILaya.loader.create(url,complete,null,AnimationClip.ANIMATIONCLIP);};var _proto33=AnimationClip.prototype;_proto33.duration=function duration(){return this._duration;};_proto33._hermiteInterpolate=function _hermiteInterpolate(frame,nextFrame,t,dur){var t0=frame.outTangent,t1=nextFrame.inTangent;if(Number.isFinite(t0)&&Number.isFinite(t1)){var t2=t*t;var t3=t2*t;var a=2.0*t3-3.0*t2+1.0;var b=t3-2.0*t2+t;var c=t3-t2;var d=-2.0*t3+3.0*t2;return a*frame.value+b*t0*dur+c*t1*dur+d*nextFrame.value;}else return frame.value;};_proto33._hermiteInterpolateVector3=function _hermiteInterpolateVector3(frame,nextFrame,t,dur,out){var p0=frame.value;var tan0=frame.outTangent;var p1=nextFrame.value;var tan1=nextFrame.inTangent;var t2=t*t;var t3=t2*t;var a=2.0*t3-3.0*t2+1.0;var b=t3-2.0*t2+t;var c=t3-t2;var d=-2.0*t3+3.0*t2;var t0=tan0.x,t1=tan1.x;if(Number.isFinite(t0)&&Number.isFinite(t1))out.x=a*p0.x+b*t0*dur+c*t1*dur+d*p1.x;else out.x=p0.x;t0=tan0.y,t1=tan1.y;if(Number.isFinite(t0)&&Number.isFinite(t1))out.y=a*p0.y+b*t0*dur+c*t1*dur+d*p1.y;else out.y=p0.y;t0=tan0.z,t1=tan1.z;if(Number.isFinite(t0)&&Number.isFinite(t1))out.z=a*p0.z+b*t0*dur+c*t1*dur+d*p1.z;else out.z=p0.z;};_proto33._hermiteInterpolateQuaternion=function _hermiteInterpolateQuaternion(frame,nextFrame,t,dur,out){var p0=frame.value;var tan0=frame.outTangent;var p1=nextFrame.value;var tan1=nextFrame.inTangent;var t2=t*t;var t3=t2*t;var a=2.0*t3-3.0*t2+1.0;var b=t3-2.0*t2+t;var c=t3-t2;var d=-2.0*t3+3.0*t2;var t0=tan0.x,t1=tan1.x;if(Number.isFinite(t0)&&Number.isFinite(t1))out.x=a*p0.x+b*t0*dur+c*t1*dur+d*p1.x;else out.x=p0.x;t0=tan0.y,t1=tan1.y;if(Number.isFinite(t0)&&Number.isFinite(t1))out.y=a*p0.y+b*t0*dur+c*t1*dur+d*p1.y;else out.y=p0.y;t0=tan0.z,t1=tan1.z;if(Number.isFinite(t0)&&Number.isFinite(t1))out.z=a*p0.z+b*t0*dur+c*t1*dur+d*p1.z;else out.z=p0.z;t0=tan0.w,t1=tan1.w;if(Number.isFinite(t0)&&Number.isFinite(t1))out.w=a*p0.w+b*t0*dur+c*t1*dur+d*p1.w;else out.w=p0.w;};_proto33._evaluateClipDatasRealTime=function _evaluateClipDatasRealTime(nodes,playCurTime,realTimeCurrentFrameIndexes,addtive,frontPlay,outDatas){for(var i=0,n=nodes.count;i<n;i++){var node=nodes.getNodeByIndex(i);var type=node.type;var nextFrameIndex;var keyFrames=node._keyFrames;var keyFramesCount=keyFrames.length;var frameIndex=realTimeCurrentFrameIndexes[i];if(frontPlay){if(frameIndex!==-1&&playCurTime<keyFrames[frameIndex].time){frameIndex=-1;realTimeCurrentFrameIndexes[i]=frameIndex;}nextFrameIndex=frameIndex+1;while(nextFrameIndex<keyFramesCount){if(keyFrames[nextFrameIndex].time>playCurTime)break;frameIndex++;nextFrameIndex++;realTimeCurrentFrameIndexes[i]=frameIndex;}}else {nextFrameIndex=frameIndex+1;if(nextFrameIndex!==keyFramesCount&&playCurTime>keyFrames[nextFrameIndex].time){frameIndex=keyFramesCount-1;realTimeCurrentFrameIndexes[i]=frameIndex;}nextFrameIndex=frameIndex+1;while(frameIndex>-1){if(keyFrames[frameIndex].time<playCurTime)break;frameIndex--;nextFrameIndex--;realTimeCurrentFrameIndexes[i]=frameIndex;}}var isEnd=nextFrameIndex===keyFramesCount;switch(type){case 0:if(frameIndex!==-1){var frame=keyFrames[frameIndex];if(isEnd){outDatas[i]=frame.value;}else {var nextFarme=keyFrames[nextFrameIndex];var d=nextFarme.time-frame.time;var t;if(d!==0)t=(playCurTime-frame.time)/d;else t=0;outDatas[i]=this._hermiteInterpolate(frame,nextFarme,t,d);}}else {outDatas[i]=keyFrames[0].value;}if(addtive)outDatas[i]=outDatas[i]-keyFrames[0].value;break;case 1:case 4:var clipData=outDatas[i];this._evaluateFrameNodeVector3DatasRealTime(keyFrames,frameIndex,isEnd,playCurTime,clipData);if(addtive){var firstFrameValue=keyFrames[0].value;clipData.x-=firstFrameValue.x;clipData.y-=firstFrameValue.y;clipData.z-=firstFrameValue.z;}break;case 2:var clipQuat=outDatas[i];this._evaluateFrameNodeQuaternionDatasRealTime(keyFrames,frameIndex,isEnd,playCurTime,clipQuat);if(addtive){var tempQuat=AnimationClip._tempQuaternion0;var firstFrameValueQua=keyFrames[0].value;Utils3D.quaternionConjugate(firstFrameValueQua,tempQuat);Quaternion.multiply(tempQuat,clipQuat,clipQuat);}break;case 3:clipData=outDatas[i];this._evaluateFrameNodeVector3DatasRealTime(keyFrames,frameIndex,isEnd,playCurTime,clipData);if(addtive){firstFrameValue=keyFrames[0].value;clipData.x/=firstFrameValue.x;clipData.y/=firstFrameValue.y;clipData.z/=firstFrameValue.z;}break;default:throw "AnimationClip:unknown node type.";}}};_proto33._evaluateClipDatasRealTimeForNative=function _evaluateClipDatasRealTimeForNative(nodes,playCurTime,realTimeCurrentFrameIndexes,addtive){Laya.LayaGL.instance.evaluateClipDatasRealTime(nodes._nativeObj,playCurTime,realTimeCurrentFrameIndexes,addtive);};_proto33._evaluateFrameNodeVector3DatasRealTime=function _evaluateFrameNodeVector3DatasRealTime(keyFrames,frameIndex,isEnd,playCurTime,outDatas){if(frameIndex!==-1){var frame=keyFrames[frameIndex];if(isEnd){var frameData=frame.value;outDatas.x=frameData.x;outDatas.y=frameData.y;outDatas.z=frameData.z;}else {var nextKeyFrame=keyFrames[frameIndex+1];var t;var startTime=frame.time;var d=nextKeyFrame.time-startTime;if(d!==0)t=(playCurTime-startTime)/d;else t=0;this._hermiteInterpolateVector3(frame,nextKeyFrame,t,d,outDatas);}}else {var firstFrameDatas=keyFrames[0].value;outDatas.x=firstFrameDatas.x;outDatas.y=firstFrameDatas.y;outDatas.z=firstFrameDatas.z;}};_proto33._evaluateFrameNodeQuaternionDatasRealTime=function _evaluateFrameNodeQuaternionDatasRealTime(keyFrames,frameIndex,isEnd,playCurTime,outDatas){if(frameIndex!==-1){var frame=keyFrames[frameIndex];if(isEnd){var frameData=frame.value;outDatas.x=frameData.x;outDatas.y=frameData.y;outDatas.z=frameData.z;outDatas.w=frameData.w;}else {var nextKeyFrame=keyFrames[frameIndex+1];var t;var startTime=frame.time;var d=nextKeyFrame.time-startTime;if(d!==0)t=(playCurTime-startTime)/d;else t=0;this._hermiteInterpolateQuaternion(frame,nextKeyFrame,t,d,outDatas);}}else {var firstFrameDatas=keyFrames[0].value;outDatas.x=firstFrameDatas.x;outDatas.y=firstFrameDatas.y;outDatas.z=firstFrameDatas.z;outDatas.w=firstFrameDatas.w;}};_proto33._binarySearchEventIndex=function _binarySearchEventIndex(time){var start=0;var end=this._animationEvents.length-1;var mid;while(start<=end){mid=Math.floor((start+end)/2);var midValue=this._animationEvents[mid].time;if(midValue==time)return mid;else if(midValue>time)end=mid-1;else start=mid+1;}return start;};_proto33.addEvent=function addEvent(event){var index=this._binarySearchEventIndex(event.time);this._animationEvents.splice(index,0,event);};_proto33._disposeResource=function _disposeResource(){this._nodes=null;this._nodesMap=null;};return AnimationClip;}(Laya.Resource);AnimationClip.ANIMATIONCLIP="ANIMATIONCLIP";AnimationClip._tempQuaternion0=new Quaternion();var AnimatorPlayState=/*#__PURE__*/function(){function AnimatorPlayState(){this._currentState=null;}var _proto34=AnimatorPlayState.prototype;_proto34._resetPlayState=function _resetPlayState(startTime){this._finish=false;this._startPlayTime=startTime;this._elapsedTime=startTime;this._playEventIndex=0;this._lastIsFront=true;};_proto34._cloneTo=function _cloneTo(dest){dest._finish=this._finish;dest._startPlayTime=this._startPlayTime;dest._elapsedTime=this._elapsedTime;dest._normalizedTime=this._normalizedTime;dest._normalizedPlayTime=this._normalizedPlayTime;dest._playEventIndex=this._playEventIndex;dest._lastIsFront=this._lastIsFront;};_createClass(AnimatorPlayState,[{key:"normalizedTime",get:function get(){return this._normalizedTime;}},{key:"duration",get:function get(){return this._duration;}},{key:"animatorState",get:function get(){return this._currentState;}}]);return AnimatorPlayState;}();var AnimatorControllerLayer=/*#__PURE__*/function(){function AnimatorControllerLayer(name){this._defaultState=null;this._referenceCount=0;this._playType=-1;this._crossDuration=-1;this._crossMark=0;this._crossNodesOwnersCount=0;this._crossNodesOwners=[];this._crossNodesOwnersIndicesMap={};this._srcCrossClipNodeIndices=[];this._destCrossClipNodeIndices=[];this._statesMap={};this._states=[];this._playStateInfo=new AnimatorPlayState();this._crossPlayStateInfo=new AnimatorPlayState();this.blendingMode=AnimatorControllerLayer.BLENDINGMODE_OVERRIDE;this.defaultWeight=1.0;this.playOnWake=true;this.name=name;}var _proto35=AnimatorControllerLayer.prototype;_proto35._removeClip=function _removeClip(clipStateInfos,statesMap,index,state){var clip=state._clip;var clipStateInfo=clipStateInfos[index];clipStateInfos.splice(index,1);delete statesMap[state.name];if(this._animator){var frameNodes=clip._nodes;var nodeOwners=clipStateInfo._nodeOwners;clip._removeReference();for(var i=0,n=frameNodes.count;i<n;i++){this._animator._removeKeyframeNodeOwner(nodeOwners,frameNodes.getNodeByIndex(i));}}};_proto35._getReferenceCount=function _getReferenceCount(){return this._referenceCount;};_proto35._addReference=function _addReference(count){if(count===void 0){count=1;}for(var i=0,n=this._states.length;i<n;i++){this._states[i]._addReference(count);}this._referenceCount+=count;};_proto35._removeReference=function _removeReference(count){if(count===void 0){count=1;}for(var i=0,n=this._states.length;i<n;i++){this._states[i]._removeReference(count);}this._referenceCount-=count;};_proto35._clearReference=function _clearReference(){this._removeReference(-this._referenceCount);};_proto35.getCurrentPlayState=function getCurrentPlayState(){return this._playStateInfo;};_proto35.getAnimatorState=function getAnimatorState(name){var state=this._statesMap[name];return state?state:null;};_proto35.addState=function addState(state){var stateName=state.name;if(this._statesMap[stateName]){throw "AnimatorControllerLayer:this stat's name has exist.";}else {this._statesMap[stateName]=state;this._states.push(state);if(this._animator){state._clip._addReference();this._animator._getOwnersByClip(state);}}};_proto35.removeState=function removeState(state){var states=this._states;var index=-1;for(var i=0,n=states.length;i<n;i++){if(states[i]===state){index=i;break;}}if(index!==-1)this._removeClip(states,this._statesMap,index,state);};_proto35.destroy=function destroy(){this._clearReference();this._statesMap=null;this._states=null;this._playStateInfo=null;this._crossPlayStateInfo=null;this._defaultState=null;};_proto35.cloneTo=function cloneTo(destObject){var dest=destObject;dest.name=this.name;dest.blendingMode=this.blendingMode;dest.defaultWeight=this.defaultWeight;dest.playOnWake=this.playOnWake;};_proto35.clone=function clone(){var dest=new AnimatorControllerLayer(this.name);this.cloneTo(dest);return dest;};_createClass(AnimatorControllerLayer,[{key:"defaultState",get:function get(){return this._defaultState;},set:function set(value){this._defaultState=value;this._statesMap[value.name]=value;}}]);return AnimatorControllerLayer;}();AnimatorControllerLayer.BLENDINGMODE_OVERRIDE=0;AnimatorControllerLayer.BLENDINGMODE_ADDTIVE=1;var ConchVector4=/*#__PURE__*/function(){function ConchVector4(x,y,z,w){if(x===void 0){x=0;}if(y===void 0){y=0;}if(z===void 0){z=0;}if(w===void 0){w=0;}var v=this.elements=new Float32Array(4);v[0]=x;v[1]=y;v[2]=z;v[3]=w;}var _proto36=ConchVector4.prototype;_proto36.fromArray=function fromArray(array,offset){if(offset===void 0){offset=0;}this.elements[0]=array[offset+0];this.elements[1]=array[offset+1];this.elements[2]=array[offset+2];this.elements[3]=array[offset+3];};_proto36.cloneTo=function cloneTo(destObject){var destVector4=destObject;var destE=destVector4.elements;var s=this.elements;destE[0]=s[0];destE[1]=s[1];destE[2]=s[2];destE[3]=s[3];};_proto36.clone=function clone(){var destVector4=new ConchVector4();this.cloneTo(destVector4);return destVector4;};ConchVector4.lerp=function lerp(a,b,t,out){var e=out.elements;var f=a.elements;var g=b.elements;var ax=f[0],ay=f[1],az=f[2],aw=f[3];e[0]=ax+t*(g[0]-ax);e[1]=ay+t*(g[1]-ay);e[2]=az+t*(g[2]-az);e[3]=aw+t*(g[3]-aw);};ConchVector4.transformByM4x4=function transformByM4x4(vector4,m4x4,out){var ve=vector4.elements;var vx=ve[0];var vy=ve[1];var vz=ve[2];var vw=ve[3];var me=m4x4.elements;var oe=out.elements;oe[0]=vx*me[0]+vy*me[4]+vz*me[8]+vw*me[12];oe[1]=vx*me[1]+vy*me[5]+vz*me[9]+vw*me[13];oe[2]=vx*me[2]+vy*me[6]+vz*me[10]+vw*me[14];oe[3]=vx*me[3]+vy*me[7]+vz*me[11]+vw*me[15];};ConchVector4.equals=function equals(a,b){var ae=a.elements;var be=b.elements;return MathUtils3D.nearEqual(Math.abs(ae[0]),Math.abs(be[0]))&&MathUtils3D.nearEqual(Math.abs(ae[1]),Math.abs(be[1]))&&MathUtils3D.nearEqual(Math.abs(ae[2]),Math.abs(be[2]))&&MathUtils3D.nearEqual(Math.abs(ae[3]),Math.abs(be[3]));};_proto36.length=function length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);};_proto36.lengthSquared=function lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;};ConchVector4.normalize=function normalize(s,out){var se=s.elements;var oe=out.elements;var len=s.length();if(len>0){oe[0]=se[0]*len;oe[1]=se[1]*len;oe[2]=se[2]*len;oe[3]=se[3]*len;}};ConchVector4.add=function add(a,b,out){var oe=out.elements;var ae=a.elements;var be=b.elements;oe[0]=ae[0]+be[0];oe[1]=ae[1]+be[1];oe[2]=ae[2]+be[2];oe[3]=ae[3]+be[3];};ConchVector4.subtract=function subtract(a,b,out){var oe=out.elements;var ae=a.elements;var be=b.elements;oe[0]=ae[0]-be[0];oe[1]=ae[1]-be[1];oe[2]=ae[2]-be[2];oe[3]=ae[3]-be[3];};ConchVector4.multiply=function multiply(a,b,out){var oe=out.elements;var ae=a.elements;var be=b.elements;oe[0]=ae[0]*be[0];oe[1]=ae[1]*be[1];oe[2]=ae[2]*be[2];oe[3]=ae[3]*be[3];};ConchVector4.scale=function scale(a,b,out){var oe=out.elements;var ae=a.elements;oe[0]=ae[0]*b;oe[1]=ae[1]*b;oe[2]=ae[2]*b;oe[3]=ae[3]*b;};ConchVector4.Clamp=function Clamp(value,min,max,out){var valuee=value.elements;var x=valuee[0];var y=valuee[1];var z=valuee[2];var w=valuee[3];var mine=min.elements;var mineX=mine[0];var mineY=mine[1];var mineZ=mine[2];var mineW=mine[3];var maxe=max.elements;var maxeX=maxe[0];var maxeY=maxe[1];var maxeZ=maxe[2];var maxeW=maxe[3];var oute=out.elements;x=x>maxeX?maxeX:x;x=x<mineX?mineX:x;y=y>maxeY?maxeY:y;y=y<mineY?mineY:y;z=z>maxeZ?maxeZ:z;z=z<mineZ?mineZ:z;w=w>maxeW?maxeW:w;w=w<mineW?mineW:w;oute[0]=x;oute[1]=y;oute[2]=z;oute[3]=w;};ConchVector4.distanceSquared=function distanceSquared(value1,value2){var value1e=value1.elements;var value2e=value2.elements;var x=value1e[0]-value2e[0];var y=value1e[1]-value2e[1];var z=value1e[2]-value2e[2];var w=value1e[3]-value2e[3];return x*x+y*y+z*z+w*w;};ConchVector4.distance=function distance(value1,value2){var value1e=value1.elements;var value2e=value2.elements;var x=value1e[0]-value2e[0];var y=value1e[1]-value2e[1];var z=value1e[2]-value2e[2];var w=value1e[3]-value2e[3];return Math.sqrt(x*x+y*y+z*z+w*w);};ConchVector4.dot=function dot(a,b){var ae=a.elements;var be=b.elements;var r=ae[0]*be[0]+ae[1]*be[1]+ae[2]*be[2]+ae[3]*be[3];return r;};ConchVector4.min=function min(a,b,out){var e=out.elements;var f=a.elements;var g=b.elements;e[0]=Math.min(f[0],g[0]);e[1]=Math.min(f[1],g[1]);e[2]=Math.min(f[2],g[2]);e[3]=Math.min(f[3],g[3]);};ConchVector4.max=function max(a,b,out){var e=out.elements;var f=a.elements;var g=b.elements;e[0]=Math.max(f[0],g[0]);e[1]=Math.max(f[1],g[1]);e[2]=Math.max(f[2],g[2]);e[3]=Math.max(f[3],g[3]);};_createClass(ConchVector4,[{key:"x",get:function get(){return this.elements[0];},set:function set(value){this.elements[0]=value;}},{key:"y",get:function get(){return this.elements[1];},set:function set(value){this.elements[1]=value;}},{key:"z",get:function get(){return this.elements[2];},set:function set(value){this.elements[2]=value;}},{key:"w",get:function get(){return this.elements[3];},set:function set(value){this.elements[3]=value;}}]);return ConchVector4;}();ConchVector4.ZERO=new ConchVector4();ConchVector4.ONE=new ConchVector4(1.0,1.0,1.0,1.0);ConchVector4.UnitX=new ConchVector4(1.0,0.0,0.0,0.0);ConchVector4.UnitY=new ConchVector4(0.0,1.0,0.0,0.0);ConchVector4.UnitZ=new ConchVector4(0.0,0.0,1.0,0.0);ConchVector4.UnitW=new ConchVector4(0.0,0.0,0.0,1.0);var ConchVector3=/*#__PURE__*/function(){function ConchVector3(x,y,z,nativeElements){if(x===void 0){x=0;}if(y===void 0){y=0;}if(z===void 0){z=0;}if(nativeElements===void 0){nativeElements=null;}var v;if(nativeElements){v=nativeElements;}else {v=new Float32Array(3);}this.elements=v;v[0]=x;v[1]=y;v[2]=z;}ConchVector3.distanceSquared=function distanceSquared(value1,value2){var value1e=value1.elements;var value2e=value2.elements;var x=value1e[0]-value2e[0];var y=value1e[1]-value2e[1];var z=value1e[2]-value2e[2];return x*x+y*y+z*z;};ConchVector3.distance=function distance(value1,value2){var value1e=value1.elements;var value2e=value2.elements;var x=value1e[0]-value2e[0];var y=value1e[1]-value2e[1];var z=value1e[2]-value2e[2];return Math.sqrt(x*x+y*y+z*z);};ConchVector3.min=function min(a,b,out){var e=out.elements;var f=a.elements;var g=b.elements;e[0]=Math.min(f[0],g[0]);e[1]=Math.min(f[1],g[1]);e[2]=Math.min(f[2],g[2]);};ConchVector3.max=function max(a,b,out){var e=out.elements;var f=a.elements;var g=b.elements;e[0]=Math.max(f[0],g[0]);e[1]=Math.max(f[1],g[1]);e[2]=Math.max(f[2],g[2]);};ConchVector3.transformQuat=function transformQuat(source,rotation,out){var destination=out.elements;var se=source.elements;var re=rotation.elements;var x=se[0],y=se[1],z=se[2],qx=re[0],qy=re[1],qz=re[2],qw=re[3],ix=qw*x+qy*z-qz*y,iy=qw*y+qz*x-qx*z,iz=qw*z+qx*y-qy*x,iw=-qx*x-qy*y-qz*z;destination[0]=ix*qw+iw*-qx+iy*-qz-iz*-qy;destination[1]=iy*qw+iw*-qy+iz*-qx-ix*-qz;destination[2]=iz*qw+iw*-qz+ix*-qy-iy*-qx;};ConchVector3.scalarLength=function scalarLength(a){var f=a.elements;var x=f[0],y=f[1],z=f[2];return Math.sqrt(x*x+y*y+z*z);};ConchVector3.scalarLengthSquared=function scalarLengthSquared(a){var f=a.elements;var x=f[0],y=f[1],z=f[2];return x*x+y*y+z*z;};ConchVector3.normalize=function normalize(s,out){var se=s.elements;var oe=out.elements;var x=se[0],y=se[1],z=se[2];var len=x*x+y*y+z*z;if(len>0){len=1/Math.sqrt(len);oe[0]=se[0]*len;oe[1]=se[1]*len;oe[2]=se[2]*len;}};ConchVector3.multiply=function multiply(a,b,out){var e=out.elements;var f=a.elements;var g=b.elements;e[0]=f[0]*g[0];e[1]=f[1]*g[1];e[2]=f[2]*g[2];};ConchVector3.scale=function scale(a,b,out){var e=out.elements;var f=a.elements;e[0]=f[0]*b;e[1]=f[1]*b;e[2]=f[2]*b;};ConchVector3.lerp=function lerp(a,b,t,out){var e=out.elements;var f=a.elements;var g=b.elements;var ax=f[0],ay=f[1],az=f[2];e[0]=ax+t*(g[0]-ax);e[1]=ay+t*(g[1]-ay);e[2]=az+t*(g[2]-az);};ConchVector3.transformV3ToV3=function transformV3ToV3(vector,transform,result){var intermediate=ConchVector3._tempVector4;ConchVector3.transformV3ToV4(vector,transform,intermediate);var intermediateElem=intermediate.elements;var resultElem=result.elements;resultElem[0]=intermediateElem[0];resultElem[1]=intermediateElem[1];resultElem[2]=intermediateElem[2];};ConchVector3.transformV3ToV4=function transformV3ToV4(vector,transform,result){var vectorElem=vector.elements;var vectorX=vectorElem[0];var vectorY=vectorElem[1];var vectorZ=vectorElem[2];var transformElem=transform.elements;var resultElem=result.elements;resultElem[0]=vectorX*transformElem[0]+vectorY*transformElem[4]+vectorZ*transformElem[8]+transformElem[12];resultElem[1]=vectorX*transformElem[1]+vectorY*transformElem[5]+vectorZ*transformElem[9]+transformElem[13];resultElem[2]=vectorX*transformElem[2]+vectorY*transformElem[6]+vectorZ*transformElem[10]+transformElem[14];resultElem[3]=vectorX*transformElem[3]+vectorY*transformElem[7]+vectorZ*transformElem[11]+transformElem[15];};ConchVector3.TransformNormal=function TransformNormal(normal,transform,result){var normalElem=normal.elements;var normalX=normalElem[0];var normalY=normalElem[1];var normalZ=normalElem[2];var transformElem=transform.elements;var resultElem=result.elements;resultElem[0]=normalX*transformElem[0]+normalY*transformElem[4]+normalZ*transformElem[8];resultElem[1]=normalX*transformElem[1]+normalY*transformElem[5]+normalZ*transformElem[9];resultElem[2]=normalX*transformElem[2]+normalY*transformElem[6]+normalZ*transformElem[10];};ConchVector3.transformCoordinate=function transformCoordinate(coordinate,transform,result){var coordinateElem=coordinate.elements;var coordinateX=coordinateElem[0];var coordinateY=coordinateElem[1];var coordinateZ=coordinateElem[2];var transformElem=transform.elements;var w=coordinateX*transformElem[3]+coordinateY*transformElem[7]+coordinateZ*transformElem[11]+transformElem[15];var resultElem=result.elements;resultElem[0]=coordinateX*transformElem[0]+coordinateY*transformElem[4]+coordinateZ*transformElem[8]+transformElem[12]/w;resultElem[1]=coordinateX*transformElem[1]+coordinateY*transformElem[5]+coordinateZ*transformElem[9]+transformElem[13]/w;resultElem[2]=coordinateX*transformElem[2]+coordinateY*transformElem[6]+coordinateZ*transformElem[10]+transformElem[14]/w;};ConchVector3.Clamp=function Clamp(value,min,max,out){var valuee=value.elements;var x=valuee[0];var y=valuee[1];var z=valuee[2];var mine=min.elements;var mineX=mine[0];var mineY=mine[1];var mineZ=mine[2];var maxe=max.elements;var maxeX=maxe[0];var maxeY=maxe[1];var maxeZ=maxe[2];var oute=out.elements;x=x>maxeX?maxeX:x;x=x<mineX?mineX:x;y=y>maxeY?maxeY:y;y=y<mineY?mineY:y;z=z>maxeZ?maxeZ:z;z=z<mineZ?mineZ:z;oute[0]=x;oute[1]=y;oute[2]=z;};ConchVector3.add=function add(a,b,out){var e=out.elements;var f=a.elements;var g=b.elements;e[0]=f[0]+g[0];e[1]=f[1]+g[1];e[2]=f[2]+g[2];};ConchVector3.subtract=function subtract(a,b,o){var oe=o.elements;var ae=a.elements;var be=b.elements;oe[0]=ae[0]-be[0];oe[1]=ae[1]-be[1];oe[2]=ae[2]-be[2];};ConchVector3.cross=function cross(a,b,o){var ae=a.elements;var be=b.elements;var oe=o.elements;var ax=ae[0],ay=ae[1],az=ae[2],bx=be[0],by=be[1],bz=be[2];oe[0]=ay*bz-az*by;oe[1]=az*bx-ax*bz;oe[2]=ax*by-ay*bx;};ConchVector3.dot=function dot(a,b){var ae=a.elements;var be=b.elements;var r=ae[0]*be[0]+ae[1]*be[1]+ae[2]*be[2];return r;};ConchVector3.equals=function equals(a,b){var ae=a.elements;var be=b.elements;return MathUtils3D.nearEqual(ae[0],be[0])&&MathUtils3D.nearEqual(ae[1],be[1])&&MathUtils3D.nearEqual(ae[2],be[2]);};var _proto37=ConchVector3.prototype;_proto37.setValue=function setValue(x,y,z){this.elements[0]=x;this.elements[1]=y;this.elements[2]=z;};_proto37.fromArray=function fromArray(array,offset){if(offset===void 0){offset=0;}this.elements[0]=array[offset+0];this.elements[1]=array[offset+1];this.elements[2]=array[offset+2];};_proto37.cloneTo=function cloneTo(destObject){var destVector3=destObject;var destE=destVector3.elements;var s=this.elements;destE[0]=s[0];destE[1]=s[1];destE[2]=s[2];};_proto37.clone=function clone(){var destVector3=new ConchVector3();this.cloneTo(destVector3);return destVector3;};_proto37.toDefault=function toDefault(){this.elements[0]=0;this.elements[1]=0;this.elements[2]=0;};_createClass(ConchVector3,[{key:"x",get:function get(){return this.elements[0];},set:function set(value){this.elements[0]=value;}},{key:"y",get:function get(){return this.elements[1];},set:function set(value){this.elements[1]=value;}},{key:"z",get:function get(){return this.elements[2];},set:function set(value){this.elements[2]=value;}}]);return ConchVector3;}();ConchVector3._tempVector4=new ConchVector4();ConchVector3.ZERO=new ConchVector3(0.0,0.0,0.0);ConchVector3.ONE=new ConchVector3(1.0,1.0,1.0);ConchVector3.NegativeUnitX=new ConchVector3(-1,0,0);ConchVector3.UnitX=new ConchVector3(1,0,0);ConchVector3.UnitY=new ConchVector3(0,1,0);ConchVector3.UnitZ=new ConchVector3(0,0,1);ConchVector3.ForwardRH=new ConchVector3(0,0,-1);ConchVector3.ForwardLH=new ConchVector3(0,0,1);ConchVector3.Up=new ConchVector3(0,1,0);ConchVector3.NAN=new ConchVector3(NaN,NaN,NaN);var ConchQuaternion=/*#__PURE__*/function(){function ConchQuaternion(x,y,z,w,nativeElements){if(x===void 0){x=0;}if(y===void 0){y=0;}if(z===void 0){z=0;}if(w===void 0){w=1;}if(nativeElements===void 0){nativeElements=null;}var v;if(nativeElements){v=nativeElements;}else {v=new Float32Array(4);}v[0]=x;v[1]=y;v[2]=z;v[3]=w;this.elements=v;}ConchQuaternion._dotArray=function _dotArray(l,r){return l[0]*r[0]+l[1]*r[1]+l[2]*r[2]+l[3]*r[3];};ConchQuaternion._normalizeArray=function _normalizeArray(f,o){var x=f[0],y=f[1],z=f[2],w=f[3];var len=x*x+y*y+z*z+w*w;if(len>0){len=1/Math.sqrt(len);o[0]=x*len;o[1]=y*len;o[2]=z*len;o[3]=w*len;}};ConchQuaternion._lerpArray=function _lerpArray(l,r,amount,o){var inverse=1.0-amount;if(ConchQuaternion._dotArray(l,r)>=0){o[0]=inverse*l[0]+amount*r[0];o[1]=inverse*l[1]+amount*r[1];o[2]=inverse*l[2]+amount*r[2];o[3]=inverse*l[3]+amount*r[3];}else {o[0]=inverse*l[0]-amount*r[0];o[1]=inverse*l[1]-amount*r[1];o[2]=inverse*l[2]-amount*r[2];o[3]=inverse*l[3]-amount*r[3];}ConchQuaternion._normalizeArray(o,o);};ConchQuaternion.createFromYawPitchRoll=function createFromYawPitchRoll(yaw,pitch,roll,out){var halfRoll=roll*0.5;var halfPitch=pitch*0.5;var halfYaw=yaw*0.5;var sinRoll=Math.sin(halfRoll);var cosRoll=Math.cos(halfRoll);var sinPitch=Math.sin(halfPitch);var cosPitch=Math.cos(halfPitch);var sinYaw=Math.sin(halfYaw);var cosYaw=Math.cos(halfYaw);var oe=out.elements;oe[0]=cosYaw*sinPitch*cosRoll+sinYaw*cosPitch*sinRoll;oe[1]=sinYaw*cosPitch*cosRoll-cosYaw*sinPitch*sinRoll;oe[2]=cosYaw*cosPitch*sinRoll-sinYaw*sinPitch*cosRoll;oe[3]=cosYaw*cosPitch*cosRoll+sinYaw*sinPitch*sinRoll;};ConchQuaternion.multiply=function multiply(left,right,out){var le=left.elements;var re=right.elements;var oe=out.elements;var lx=le[0];var ly=le[1];var lz=le[2];var lw=le[3];var rx=re[0];var ry=re[1];var rz=re[2];var rw=re[3];var a=ly*rz-lz*ry;var b=lz*rx-lx*rz;var c=lx*ry-ly*rx;var d=lx*rx+ly*ry+lz*rz;oe[0]=lx*rw+rx*lw+a;oe[1]=ly*rw+ry*lw+b;oe[2]=lz*rw+rz*lw+c;oe[3]=lw*rw-d;};ConchQuaternion.arcTanAngle=function arcTanAngle(x,y){if(x==0){if(y==1)return Math.PI/2;return -Math.PI/2;}if(x>0)return Math.atan(y/x);if(x<0){if(y>0)return Math.atan(y/x)+Math.PI;return Math.atan(y/x)-Math.PI;}return 0;};ConchQuaternion.angleTo=function angleTo(from,location,angle){ConchVector3.subtract(location,from,ConchQuaternion.TEMPVector30);ConchVector3.normalize(ConchQuaternion.TEMPVector30,ConchQuaternion.TEMPVector30);angle.elements[0]=Math.asin(ConchQuaternion.TEMPVector30.y);angle.elements[1]=ConchQuaternion.arcTanAngle(-ConchQuaternion.TEMPVector30.z,-ConchQuaternion.TEMPVector30.x);};ConchQuaternion.createFromAxisAngle=function createFromAxisAngle(axis,rad,out){var e=out.elements;var f=axis.elements;rad=rad*0.5;var s=Math.sin(rad);e[0]=s*f[0];e[1]=s*f[1];e[2]=s*f[2];e[3]=Math.cos(rad);};ConchQuaternion.createFromMatrix3x3=function createFromMatrix3x3(sou,out){var e=out.elements;var f=sou.elements;var fTrace=f[0]+f[4]+f[8];var fRoot;if(fTrace>0.0){fRoot=Math.sqrt(fTrace+1.0);e[3]=0.5*fRoot;fRoot=0.5/fRoot;e[0]=(f[5]-f[7])*fRoot;e[1]=(f[6]-f[2])*fRoot;e[2]=(f[1]-f[3])*fRoot;}else {var i=0;if(f[4]>f[0])i=1;if(f[8]>f[i*3+i])i=2;var j=(i+1)%3;var k=(i+2)%3;fRoot=Math.sqrt(f[i*3+i]-f[j*3+j]-f[k*3+k]+1.0);e[i]=0.5*fRoot;fRoot=0.5/fRoot;e[3]=(f[j*3+k]-f[k*3+j])*fRoot;e[j]=(f[j*3+i]+f[i*3+j])*fRoot;e[k]=(f[k*3+i]+f[i*3+k])*fRoot;}return;};ConchQuaternion.createFromMatrix4x4=function createFromMatrix4x4(mat,out){var me=mat.elements;var oe=out.elements;var sqrt;var half;var scale=me[0]+me[5]+me[10];if(scale>0.0){sqrt=Math.sqrt(scale+1.0);oe[3]=sqrt*0.5;sqrt=0.5/sqrt;oe[0]=(me[6]-me[9])*sqrt;oe[1]=(me[8]-me[2])*sqrt;oe[2]=(me[1]-me[4])*sqrt;}else if(me[0]>=me[5]&&me[0]>=me[10]){sqrt=Math.sqrt(1.0+me[0]-me[5]-me[10]);half=0.5/sqrt;oe[0]=0.5*sqrt;oe[1]=(me[1]+me[4])*half;oe[2]=(me[2]+me[8])*half;oe[3]=(me[6]-me[9])*half;}else if(me[5]>me[10]){sqrt=Math.sqrt(1.0+me[5]-me[0]-me[10]);half=0.5/sqrt;oe[0]=(me[4]+me[1])*half;oe[1]=0.5*sqrt;oe[2]=(me[9]+me[6])*half;oe[3]=(me[8]-me[2])*half;}else {sqrt=Math.sqrt(1.0+me[10]-me[0]-me[5]);half=0.5/sqrt;oe[0]=(me[8]+me[2])*half;oe[1]=(me[9]+me[6])*half;oe[2]=0.5*sqrt;oe[3]=(me[1]-me[4])*half;}};ConchQuaternion.slerp=function slerp(left,right,t,out){var a=left.elements;var b=right.elements;var oe=out.elements;var ax=a[0],ay=a[1],az=a[2],aw=a[3],bx=b[0],by=b[1],bz=b[2],bw=b[3];var omega,cosom,sinom,scale0,scale1;cosom=ax*bx+ay*by+az*bz+aw*bw;if(cosom<0.0){cosom=-cosom;bx=-bx;by=-by;bz=-bz;bw=-bw;}if(1.0-cosom>0.000001){omega=Math.acos(cosom);sinom=Math.sin(omega);scale0=Math.sin((1.0-t)*omega)/sinom;scale1=Math.sin(t*omega)/sinom;}else {scale0=1.0-t;scale1=t;}oe[0]=scale0*ax+scale1*bx;oe[1]=scale0*ay+scale1*by;oe[2]=scale0*az+scale1*bz;oe[3]=scale0*aw+scale1*bw;return oe;};ConchQuaternion.lerp=function lerp(left,right,amount,out){ConchQuaternion._lerpArray(left.elements,right.elements,amount,out.elements);};ConchQuaternion.add=function add(left,right,out){var e=out.elements;var f=left.elements;var g=right.elements;e[0]=f[0]+g[0];e[1]=f[1]+g[1];e[2]=f[2]+g[2];e[3]=f[3]+g[3];};ConchQuaternion.dot=function dot(left,right){return ConchQuaternion._dotArray(left.elements,right.elements);};var _proto38=ConchQuaternion.prototype;_proto38.scaling=function scaling(_scaling2,out){var e=out.elements;var f=this.elements;e[0]=f[0]*_scaling2;e[1]=f[1]*_scaling2;e[2]=f[2]*_scaling2;e[3]=f[3]*_scaling2;};_proto38.normalize=function normalize(out){ConchQuaternion._normalizeArray(this.elements,out.elements);};_proto38.length=function length(){var f=this.elements;var x=f[0],y=f[1],z=f[2],w=f[3];return Math.sqrt(x*x+y*y+z*z+w*w);};_proto38.rotateX=function rotateX(rad,out){var e=out.elements;var f=this.elements;rad*=0.5;var ax=f[0],ay=f[1],az=f[2],aw=f[3];var bx=Math.sin(rad),bw=Math.cos(rad);e[0]=ax*bw+aw*bx;e[1]=ay*bw+az*bx;e[2]=az*bw-ay*bx;e[3]=aw*bw-ax*bx;};_proto38.rotateY=function rotateY(rad,out){var e=out.elements;var f=this.elements;rad*=0.5;var ax=f[0],ay=f[1],az=f[2],aw=f[3],by=Math.sin(rad),bw=Math.cos(rad);e[0]=ax*bw-az*by;e[1]=ay*bw+aw*by;e[2]=az*bw+ax*by;e[3]=aw*bw-ay*by;};_proto38.rotateZ=function rotateZ(rad,out){var e=out.elements;var f=this.elements;rad*=0.5;var ax=f[0],ay=f[1],az=f[2],aw=f[3],bz=Math.sin(rad),bw=Math.cos(rad);e[0]=ax*bw+ay*bz;e[1]=ay*bw-ax*bz;e[2]=az*bw+aw*bz;e[3]=aw*bw-az*bz;};_proto38.getYawPitchRoll=function getYawPitchRoll(out){ConchVector3.transformQuat(ConchVector3.ForwardRH,this,ConchQuaternion.TEMPVector31);ConchVector3.transformQuat(ConchVector3.Up,this,ConchQuaternion.TEMPVector32);var upe=ConchQuaternion.TEMPVector32.elements;ConchQuaternion.angleTo(ConchVector3.ZERO,ConchQuaternion.TEMPVector31,ConchQuaternion.TEMPVector33);var anglee=ConchQuaternion.TEMPVector33.elements;if(anglee[0]==Math.PI/2){anglee[1]=ConchQuaternion.arcTanAngle(upe[2],upe[0]);anglee[2]=0;}else if(anglee[0]==-Math.PI/2){anglee[1]=ConchQuaternion.arcTanAngle(-upe[2],-upe[0]);anglee[2]=0;}else {Matrix4x4.createRotationY(-anglee[1],ConchQuaternion.TEMPMatrix0);Matrix4x4.createRotationX(-anglee[0],ConchQuaternion.TEMPMatrix1);ConchVector3.transformCoordinate(ConchQuaternion.TEMPVector32,ConchQuaternion.TEMPMatrix0,ConchQuaternion.TEMPVector32);ConchVector3.transformCoordinate(ConchQuaternion.TEMPVector32,ConchQuaternion.TEMPMatrix1,ConchQuaternion.TEMPVector32);anglee[2]=ConchQuaternion.arcTanAngle(upe[1],-upe[0]);}if(anglee[1]<=-Math.PI)anglee[1]=Math.PI;if(anglee[2]<=-Math.PI)anglee[2]=Math.PI;if(anglee[1]>=Math.PI&&anglee[2]>=Math.PI){anglee[1]=0;anglee[2]=0;anglee[0]=Math.PI-anglee[0];}var oe=out.elements;oe[0]=anglee[1];oe[1]=anglee[0];oe[2]=anglee[2];};_proto38.invert=function invert(out){var e=out.elements;var f=this.elements;var a0=f[0],a1=f[1],a2=f[2],a3=f[3];var dot=a0*a0+a1*a1+a2*a2+a3*a3;var invDot=dot?1.0/dot:0;e[0]=-a0*invDot;e[1]=-a1*invDot;e[2]=-a2*invDot;e[3]=a3*invDot;};_proto38.identity=function identity(){var e=this.elements;e[0]=0;e[1]=0;e[2]=0;e[3]=1;};_proto38.fromArray=function fromArray(array,offset){if(offset===void 0){offset=0;}this.elements[0]=array[offset+0];this.elements[1]=array[offset+1];this.elements[2]=array[offset+2];this.elements[3]=array[offset+3];};_proto38.cloneTo=function cloneTo(destObject){var i,s,d;s=this.elements;d=destObject.elements;if(s===d){return;}for(i=0;i<4;++i){d[i]=s[i];}};_proto38.clone=function clone(){var dest=new ConchQuaternion();this.cloneTo(dest);return dest;};_proto38.equals=function equals(b){var ae=this.elements;var be=b.elements;return MathUtils3D.nearEqual(ae[0],be[0])&&MathUtils3D.nearEqual(ae[1],be[1])&&MathUtils3D.nearEqual(ae[2],be[2])&&MathUtils3D.nearEqual(ae[3],be[3]);};ConchQuaternion.rotationLookAt=function rotationLookAt(forward,up,out){ConchQuaternion.lookAt(ConchVector3.ZERO,forward,up,out);};ConchQuaternion.lookAt=function lookAt(eye,target,up,out){Matrix3x3.lookAt(eye,target,up,ConchQuaternion._tempMatrix3x3);ConchQuaternion.rotationMatrix(ConchQuaternion._tempMatrix3x3,out);};_proto38.lengthSquared=function lengthSquared(){var x=this.elements[0];var y=this.elements[1];var z=this.elements[2];var w=this.elements[3];return x*x+y*y+z*z+w*w;};ConchQuaternion.invert=function invert(value,out){var vE=value.elements;var oE=out.elements;var lengthSq=value.lengthSquared();if(!MathUtils3D.isZero(lengthSq)){lengthSq=1.0/lengthSq;oE[0]=-vE[0]*lengthSq;oE[1]=-vE[1]*lengthSq;oE[2]=-vE[2]*lengthSq;oE[3]=vE[3]*lengthSq;}};ConchQuaternion.rotationMatrix=function rotationMatrix(matrix3x3,out){var me=matrix3x3.elements;var m11=me[0];var m12=me[1];var m13=me[2];var m21=me[3];var m22=me[4];var m23=me[5];var m31=me[6];var m32=me[7];var m33=me[8];var oe=out.elements;var sqrt,half;var scale=m11+m22+m33;if(scale>0){sqrt=Math.sqrt(scale+1);oe[3]=sqrt*0.5;sqrt=0.5/sqrt;oe[0]=(m23-m32)*sqrt;oe[1]=(m31-m13)*sqrt;oe[2]=(m12-m21)*sqrt;}else if(m11>=m22&&m11>=m33){sqrt=Math.sqrt(1+m11-m22-m33);half=0.5/sqrt;oe[0]=0.5*sqrt;oe[1]=(m12+m21)*half;oe[2]=(m13+m31)*half;oe[3]=(m23-m32)*half;}else if(m22>m33){sqrt=Math.sqrt(1+m22-m11-m33);half=0.5/sqrt;oe[0]=(m21+m12)*half;oe[1]=0.5*sqrt;oe[2]=(m32+m23)*half;oe[3]=(m31-m13)*half;}else {sqrt=Math.sqrt(1+m33-m11-m22);half=0.5/sqrt;oe[0]=(m31+m13)*half;oe[1]=(m32+m23)*half;oe[2]=0.5*sqrt;oe[3]=(m12-m21)*half;}};_createClass(ConchQuaternion,[{key:"x",get:function get(){return this.elements[0];},set:function set(value){this.elements[0]=value;}},{key:"y",get:function get(){return this.elements[1];},set:function set(value){this.elements[1]=value;}},{key:"z",get:function get(){return this.elements[2];},set:function set(value){this.elements[2]=value;}},{key:"w",get:function get(){return this.elements[3];},set:function set(value){this.elements[3]=value;}}]);return ConchQuaternion;}();ConchQuaternion.TEMPVector30=new ConchVector3();ConchQuaternion.TEMPVector31=new ConchVector3();ConchQuaternion.TEMPVector32=new ConchVector3();ConchQuaternion.TEMPVector33=new ConchVector3();ConchQuaternion.TEMPMatrix0=new Matrix4x4();ConchQuaternion.TEMPMatrix1=new Matrix4x4();ConchQuaternion._tempMatrix3x3=new Matrix3x3();ConchQuaternion.DEFAULT=new ConchQuaternion();ConchQuaternion.NAN=new ConchQuaternion(NaN,NaN,NaN,NaN);var AnimatorState=/*#__PURE__*/function(){function AnimatorState(){this._referenceCount=0;this._clip=null;this._nodeOwners=[];this._currentFrameIndices=null;this._realtimeDatas=[];this._scripts=null;this.speed=1.0;this.clipStart=0.0;this.clipEnd=1.0;}var _proto39=AnimatorState.prototype;_proto39._getReferenceCount=function _getReferenceCount(){return this._referenceCount;};_proto39._addReference=function _addReference(count){if(count===void 0){count=1;}this._clip&&this._clip._addReference(count);this._referenceCount+=count;};_proto39._removeReference=function _removeReference(count){if(count===void 0){count=1;}this._clip&&this._clip._removeReference(count);this._referenceCount-=count;};_proto39._clearReference=function _clearReference(){this._removeReference(-this._referenceCount);};_proto39._resetFrameIndices=function _resetFrameIndices(){for(var i=0,n=this._currentFrameIndices.length;i<n;i++){this._currentFrameIndices[i]=-1;}};_proto39.addScript=function addScript(type){var script=new type();this._scripts=this._scripts||[];this._scripts.push(script);return script;};_proto39.getScript=function getScript(type){if(this._scripts){for(var i=0,n=this._scripts.length;i<n;i++){var script=this._scripts[i];if(script instanceof type)return script;}}return null;};_proto39.getScripts=function getScripts(type){var coms;if(this._scripts){for(var i=0,n=this._scripts.length;i<n;i++){var script=this._scripts[i];if(script instanceof type){coms=coms||[];coms.push(script);}}}return coms;};_proto39.cloneTo=function cloneTo(destObject){var dest=destObject;dest.name=this.name;dest.speed=this.speed;dest.clipStart=this.clipStart;dest.clipEnd=this.clipEnd;dest.clip=this._clip;};_proto39.clone=function clone(){var dest=new AnimatorState();this.cloneTo(dest);return dest;};_createClass(AnimatorState,[{key:"clip",get:function get(){return this._clip;},set:function set(value){if(this._clip!==value){if(this._clip)this._referenceCount>0&&this._clip._removeReference(this._referenceCount);if(value){var realtimeDatas=this._realtimeDatas;var clipNodes=value._nodes;var count=clipNodes.count;this._currentFrameIndices=new Int16Array(count);this._resetFrameIndices();this._referenceCount>0&&value._addReference(this._referenceCount);this._realtimeDatas.length=count;for(var i=0;i<count;i++){switch(clipNodes.getNodeByIndex(i).type){case 0:break;case 1:case 3:case 4:realtimeDatas[i]=Laya.Render.supportWebGLPlusAnimation?new ConchVector3():new Vector3();break;case 2:realtimeDatas[i]=Laya.Render.supportWebGLPlusAnimation?new ConchQuaternion():new Quaternion();break;default:throw "AnimationClipParser04:unknown type.";}}}this._clip=value;}}}]);return AnimatorState;}();var KeyframeNodeOwner=/*#__PURE__*/function(){function KeyframeNodeOwner(){this.indexInList=-1;this.referenceCount=0;this.updateMark=-1;this.type=-1;this.fullPath=null;this.propertyOwner=null;this.property=null;this.defaultValue=null;this.value=null;this.crossFixedValue=null;}var _proto40=KeyframeNodeOwner.prototype;_proto40.saveCrossFixedValue=function saveCrossFixedValue(){var pro=this.propertyOwner;if(pro){switch(this.type){case 0:this.crossFixedValue=this.value;break;case 1:case 3:case 4:this.value.cloneTo(this.crossFixedValue);break;case 2:this.value.cloneTo(this.crossFixedValue);break;default:throw "Animator:unknown type.";}}};return KeyframeNodeOwner;}();var Animator=/*#__PURE__*/function(_Laya$Component2){_inheritsLoose(Animator,_Laya$Component2);function Animator(){var _this17;_this17=_Laya$Component2.call(this)||this;_this17._keyframeNodeOwners=[];_this17._linkAvatarSpritesData={};_this17._linkAvatarSprites=[];_this17._renderableSprites=[];_this17.cullingMode=Animator.CULLINGMODE_CULLCOMPLETELY;_this17._controllerLayers=[];_this17._linkSprites={};_this17._speed=1.0;_this17._keyframeNodeOwnerMap={};_this17._updateMark=0;return _this17;}Animator._update=function _update(scene){var pool=scene._animatorPool;var elements=pool.elements;for(var i=0,n=pool.length;i<n;i++){var animator=elements[i];animator&&animator.enabled&&animator._update();}};var _proto41=Animator.prototype;_proto41._linkToSprites=function _linkToSprites(linkSprites){for(var k in linkSprites){var nodeOwner=this.owner;var path=linkSprites[k];for(var j=0,m=path.length;j<m;j++){var p=path[j];if(p===""){break;}else {nodeOwner=nodeOwner.getChildByName(p);if(!nodeOwner)break;}}nodeOwner&&this.linkSprite3DToAvatarNode(k,nodeOwner);}};_proto41._addKeyframeNodeOwner=function _addKeyframeNodeOwner(clipOwners,node,propertyOwner){var nodeIndex=node._indexInList;var fullPath=node.fullPath;var keyframeNodeOwner=this._keyframeNodeOwnerMap[fullPath];if(keyframeNodeOwner){keyframeNodeOwner.referenceCount++;clipOwners[nodeIndex]=keyframeNodeOwner;}else {var property=propertyOwner;for(var i=0,n=node.propertyCount;i<n;i++){property=property[node.getPropertyByIndex(i)];if(!property)break;}keyframeNodeOwner=this._keyframeNodeOwnerMap[fullPath]=new KeyframeNodeOwner();keyframeNodeOwner.fullPath=fullPath;keyframeNodeOwner.indexInList=this._keyframeNodeOwners.length;keyframeNodeOwner.referenceCount=1;keyframeNodeOwner.propertyOwner=propertyOwner;var propertyCount=node.propertyCount;var propertys=[];for(i=0;i<propertyCount;i++){propertys[i]=node.getPropertyByIndex(i);}keyframeNodeOwner.property=propertys;keyframeNodeOwner.type=node.type;if(property){if(node.type===0){keyframeNodeOwner.defaultValue=property;}else {var defaultValue=new property.constructor();property.cloneTo(defaultValue);keyframeNodeOwner.defaultValue=defaultValue;keyframeNodeOwner.value=new property.constructor();keyframeNodeOwner.crossFixedValue=new property.constructor();}}this._keyframeNodeOwners.push(keyframeNodeOwner);clipOwners[nodeIndex]=keyframeNodeOwner;}};_proto41._removeKeyframeNodeOwner=function _removeKeyframeNodeOwner(nodeOwners,node){var fullPath=node.fullPath;var keyframeNodeOwner=this._keyframeNodeOwnerMap[fullPath];if(keyframeNodeOwner){keyframeNodeOwner.referenceCount--;if(keyframeNodeOwner.referenceCount===0){delete this._keyframeNodeOwnerMap[fullPath];this._keyframeNodeOwners.splice(this._keyframeNodeOwners.indexOf(keyframeNodeOwner),1);}nodeOwners[node._indexInList]=null;}};_proto41._getOwnersByClip=function _getOwnersByClip(clipStateInfo){var frameNodes=clipStateInfo._clip._nodes;var frameNodesCount=frameNodes.count;var nodeOwners=clipStateInfo._nodeOwners;nodeOwners.length=frameNodesCount;for(var i=0;i<frameNodesCount;i++){var node=frameNodes.getNodeByIndex(i);var property=this._avatar?this._avatarNodeMap[this._avatar._rootNode.name]:this.owner;for(var j=0,m=node.ownerPathCount;j<m;j++){var ownPat=node.getOwnerPathByIndex(j);if(ownPat===""){break;}else {property=property.getChildByName(ownPat);if(!property)break;}}if(property){var propertyOwner=node.propertyOwner;propertyOwner&&(property=property[propertyOwner]);property&&this._addKeyframeNodeOwner(nodeOwners,node,property);}}};_proto41._updatePlayer=function _updatePlayer(animatorState,playState,elapsedTime,islooping){var clipDuration=animatorState._clip._duration*(animatorState.clipEnd-animatorState.clipStart);var lastElapsedTime=playState._elapsedTime;var elapsedPlaybackTime=lastElapsedTime+elapsedTime;playState._lastElapsedTime=lastElapsedTime;playState._elapsedTime=elapsedPlaybackTime;var normalizedTime=elapsedPlaybackTime/clipDuration;playState._normalizedTime=normalizedTime;var playTime=normalizedTime%1.0;playState._normalizedPlayTime=playTime<0?playTime+1.0:playTime;playState._duration=clipDuration;var scripts=animatorState._scripts;if(!islooping&&elapsedPlaybackTime>=clipDuration){playState._finish=true;playState._elapsedTime=clipDuration;playState._normalizedPlayTime=1.0;if(scripts){for(var i=0,n=scripts.length;i<n;i++){scripts[i].onStateExit();}}return;}if(scripts){for(i=0,n=scripts.length;i<n;i++){scripts[i].onStateUpdate();}}};_proto41._eventScript=function _eventScript(scripts,events,eventIndex,endTime,front){if(front){for(var n=events.length;eventIndex<n;eventIndex++){var event=events[eventIndex];if(event.time<=endTime){for(var j=0,m=scripts.length;j<m;j++){var script=scripts[j];var fun=script[event.eventName];fun&&fun.apply(script,event.params);}}else {break;}}}else {for(;eventIndex>=0;eventIndex--){event=events[eventIndex];if(event.time>=endTime){for(j=0,m=scripts.length;j<m;j++){script=scripts[j];fun=script[event.eventName];fun&&fun.apply(script,event.params);}}else {break;}}}return eventIndex;};_proto41._updateEventScript=function _updateEventScript(stateInfo,playStateInfo){var scripts=this.owner._scripts;if(scripts){var clip=stateInfo._clip;var events=clip._animationEvents;var clipDuration=clip._duration;var elapsedTime=playStateInfo._elapsedTime;var time=elapsedTime%clipDuration;var loopCount=Math.abs(Math.floor(elapsedTime/clipDuration)-Math.floor(playStateInfo._lastElapsedTime/clipDuration));var frontPlay=playStateInfo._elapsedTime>=playStateInfo._lastElapsedTime;if(playStateInfo._lastIsFront!==frontPlay){if(frontPlay)playStateInfo._playEventIndex++;else playStateInfo._playEventIndex--;playStateInfo._lastIsFront=frontPlay;}if(frontPlay){playStateInfo._playEventIndex=this._eventScript(scripts,events,playStateInfo._playEventIndex,loopCount>0?clipDuration:time,true);for(var i=0,n=loopCount-1;i<n;i++){this._eventScript(scripts,events,0,clipDuration,true);}loopCount>0&&time>0&&(playStateInfo._playEventIndex=this._eventScript(scripts,events,0,time,true));}else {playStateInfo._playEventIndex=this._eventScript(scripts,events,playStateInfo._playEventIndex,loopCount>0?0:time,false);var eventIndex=events.length-1;for(i=0,n=loopCount-1;i<n;i++){this._eventScript(scripts,events,eventIndex,0,false);}loopCount>0&&time>0&&(playStateInfo._playEventIndex=this._eventScript(scripts,events,eventIndex,time,false));}}};_proto41._updateClipDatas=function _updateClipDatas(animatorState,addtive,playStateInfo,scale){var clip=animatorState._clip;var clipDuration=clip._duration;var curPlayTime=animatorState.clipStart*clipDuration+playStateInfo._normalizedPlayTime*playStateInfo._duration;var currentFrameIndices=animatorState._currentFrameIndices;var frontPlay=playStateInfo._elapsedTime>playStateInfo._lastElapsedTime;clip._evaluateClipDatasRealTime(clip._nodes,curPlayTime,currentFrameIndices,addtive,frontPlay,animatorState._realtimeDatas);};_proto41._applyFloat=function _applyFloat(pro,proName,nodeOwner,additive,weight,isFirstLayer,data){if(nodeOwner.updateMark===this._updateMark){if(additive){pro[proName]+=weight*data;}else {var oriValue=pro[proName];pro[proName]=oriValue+weight*(data-oriValue);}}else {if(isFirstLayer){if(additive)pro[proName]=nodeOwner.defaultValue+data;else pro[proName]=data;}else {if(additive){pro[proName]=nodeOwner.defaultValue+weight*data;}else {var defValue=nodeOwner.defaultValue;pro[proName]=defValue+weight*(data-defValue);}}}};_proto41._applyPositionAndRotationEuler=function _applyPositionAndRotationEuler(nodeOwner,additive,weight,isFirstLayer,data,out){if(nodeOwner.updateMark===this._updateMark){if(additive){out.x+=weight*data.x;out.y+=weight*data.y;out.z+=weight*data.z;}else {var oriX=out.x;var oriY=out.y;var oriZ=out.z;out.x=oriX+weight*(data.x-oriX);out.y=oriY+weight*(data.y-oriY);out.z=oriZ+weight*(data.z-oriZ);}}else {if(isFirstLayer){if(additive){var defValue=nodeOwner.defaultValue;out.x=defValue.x+data.x;out.y=defValue.y+data.y;out.z=defValue.z+data.z;}else {out.x=data.x;out.y=data.y;out.z=data.z;}}else {defValue=nodeOwner.defaultValue;if(additive){out.x=defValue.x+weight*data.x;out.y=defValue.y+weight*data.y;out.z=defValue.z+weight*data.z;}else {var defX=defValue.x;var defY=defValue.y;var defZ=defValue.z;out.x=defX+weight*(data.x-defX);out.y=defY+weight*(data.y-defY);out.z=defZ+weight*(data.z-defZ);}}}};_proto41._applyRotation=function _applyRotation(nodeOwner,additive,weight,isFirstLayer,clipRot,localRotation){if(nodeOwner.updateMark===this._updateMark){if(additive){var tempQuat=Animator._tempQuaternion1;Utils3D.quaternionWeight(clipRot,weight,tempQuat);tempQuat.normalize(tempQuat);Quaternion.multiply(localRotation,tempQuat,localRotation);}else {Quaternion.lerp(localRotation,clipRot,weight,localRotation);}}else {if(isFirstLayer){if(additive){var defaultRot=nodeOwner.defaultValue;Quaternion.multiply(defaultRot,clipRot,localRotation);}else {localRotation.x=clipRot.x;localRotation.y=clipRot.y;localRotation.z=clipRot.z;localRotation.w=clipRot.w;}}else {defaultRot=nodeOwner.defaultValue;if(additive){tempQuat=Animator._tempQuaternion1;Utils3D.quaternionWeight(clipRot,weight,tempQuat);tempQuat.normalize(tempQuat);Quaternion.multiply(defaultRot,tempQuat,localRotation);}else {Quaternion.lerp(defaultRot,clipRot,weight,localRotation);}}}};_proto41._applyScale=function _applyScale(nodeOwner,additive,weight,isFirstLayer,clipSca,localScale){if(nodeOwner.updateMark===this._updateMark){if(additive){var scale=Animator._tempVector31;Utils3D.scaleWeight(clipSca,weight,scale);localScale.x=localScale.x*scale.x;localScale.y=localScale.y*scale.y;localScale.z=localScale.z*scale.z;}else {Utils3D.scaleBlend(localScale,clipSca,weight,localScale);}}else {if(isFirstLayer){if(additive){var defaultSca=nodeOwner.defaultValue;localScale.x=defaultSca.x*clipSca.x;localScale.y=defaultSca.y*clipSca.y;localScale.z=defaultSca.z*clipSca.z;}else {localScale.x=clipSca.x;localScale.y=clipSca.y;localScale.z=clipSca.z;}}else {defaultSca=nodeOwner.defaultValue;if(additive){scale=Animator._tempVector31;Utils3D.scaleWeight(clipSca,weight,scale);localScale.x=defaultSca.x*scale.x;localScale.y=defaultSca.y*scale.y;localScale.z=defaultSca.z*scale.z;}else {Utils3D.scaleBlend(defaultSca,clipSca,weight,localScale);}}}};_proto41._applyCrossData=function _applyCrossData(nodeOwner,additive,weight,isFirstLayer,srcValue,desValue,crossWeight){var pro=nodeOwner.propertyOwner;if(pro){switch(nodeOwner.type){case 0:var proPat=nodeOwner.property;var m=proPat.length-1;for(var j=0;j<m;j++){pro=pro[proPat[j]];if(!pro)break;}var crossValue=srcValue+crossWeight*(desValue-srcValue);nodeOwner.value=crossValue;this._applyFloat(pro,proPat[m],nodeOwner,additive,weight,isFirstLayer,crossValue);break;case 1:var localPos=pro.localPosition;var position=nodeOwner.value;var srcX=srcValue.x,srcY=srcValue.y,srcZ=srcValue.z;position.x=srcX+crossWeight*(desValue.x-srcX);position.y=srcY+crossWeight*(desValue.y-srcY);position.z=srcZ+crossWeight*(desValue.z-srcZ);this._applyPositionAndRotationEuler(nodeOwner,additive,weight,isFirstLayer,position,localPos);pro.localPosition=localPos;break;case 2:var localRot=pro.localRotation;var rotation=nodeOwner.value;Quaternion.lerp(srcValue,desValue,crossWeight,rotation);this._applyRotation(nodeOwner,additive,weight,isFirstLayer,rotation,localRot);pro.localRotation=localRot;break;case 3:var localSca=pro.localScale;var scale=nodeOwner.value;Utils3D.scaleBlend(srcValue,desValue,crossWeight,scale);this._applyScale(nodeOwner,additive,weight,isFirstLayer,scale,localSca);pro.localScale=localSca;break;case 4:var localEuler=pro.localRotationEuler;var rotationEuler=nodeOwner.value;srcX=srcValue.x,srcY=srcValue.y,srcZ=srcValue.z;rotationEuler.x=srcX+crossWeight*(desValue.x-srcX);rotationEuler.y=srcY+crossWeight*(desValue.y-srcY);rotationEuler.z=srcZ+crossWeight*(desValue.z-srcZ);this._applyPositionAndRotationEuler(nodeOwner,additive,weight,isFirstLayer,rotationEuler,localEuler);pro.localRotationEuler=localEuler;break;}nodeOwner.updateMark=this._updateMark;}};_proto41._setClipDatasToNode=function _setClipDatasToNode(stateInfo,additive,weight,isFirstLayer){var realtimeDatas=stateInfo._realtimeDatas;var nodes=stateInfo._clip._nodes;var nodeOwners=stateInfo._nodeOwners;for(var i=0,n=nodes.count;i<n;i++){var nodeOwner=nodeOwners[i];if(nodeOwner){var pro=nodeOwner.propertyOwner;if(pro){switch(nodeOwner.type){case 0:var proPat=nodeOwner.property;var m=proPat.length-1;for(var j=0;j<m;j++){pro=pro[proPat[j]];if(!pro)break;}this._applyFloat(pro,proPat[m],nodeOwner,additive,weight,isFirstLayer,realtimeDatas[i]);break;case 1:var localPos=pro.localPosition;this._applyPositionAndRotationEuler(nodeOwner,additive,weight,isFirstLayer,realtimeDatas[i],localPos);pro.localPosition=localPos;break;case 2:var localRot=pro.localRotation;this._applyRotation(nodeOwner,additive,weight,isFirstLayer,realtimeDatas[i],localRot);pro.localRotation=localRot;break;case 3:var localSca=pro.localScale;this._applyScale(nodeOwner,additive,weight,isFirstLayer,realtimeDatas[i],localSca);pro.localScale=localSca;break;case 4:var localEuler=pro.localRotationEuler;this._applyPositionAndRotationEuler(nodeOwner,additive,weight,isFirstLayer,realtimeDatas[i],localEuler);pro.localRotationEuler=localEuler;break;}nodeOwner.updateMark=this._updateMark;}}}};_proto41._setCrossClipDatasToNode=function _setCrossClipDatasToNode(controllerLayer,srcState,destState,crossWeight,isFirstLayer){var nodeOwners=controllerLayer._crossNodesOwners;var ownerCount=controllerLayer._crossNodesOwnersCount;var additive=controllerLayer.blendingMode!==AnimatorControllerLayer.BLENDINGMODE_OVERRIDE;var weight=controllerLayer.defaultWeight;var destRealtimeDatas=destState._realtimeDatas;var destDataIndices=controllerLayer._destCrossClipNodeIndices;var destNodeOwners=destState._nodeOwners;var srcRealtimeDatas=srcState._realtimeDatas;var srcDataIndices=controllerLayer._srcCrossClipNodeIndices;var srcNodeOwners=srcState._nodeOwners;for(var i=0;i<ownerCount;i++){var nodeOwner=nodeOwners[i];if(nodeOwner){var srcIndex=srcDataIndices[i];var destIndex=destDataIndices[i];var srcValue=srcIndex!==-1?srcRealtimeDatas[srcIndex]:destNodeOwners[destIndex].defaultValue;var desValue=destIndex!==-1?destRealtimeDatas[destIndex]:srcNodeOwners[srcIndex].defaultValue;this._applyCrossData(nodeOwner,additive,weight,isFirstLayer,srcValue,desValue,crossWeight);}}};_proto41._setFixedCrossClipDatasToNode=function _setFixedCrossClipDatasToNode(controllerLayer,destState,crossWeight,isFirstLayer){var nodeOwners=controllerLayer._crossNodesOwners;var ownerCount=controllerLayer._crossNodesOwnersCount;var additive=controllerLayer.blendingMode!==AnimatorControllerLayer.BLENDINGMODE_OVERRIDE;var weight=controllerLayer.defaultWeight;var destRealtimeDatas=destState._realtimeDatas;var destDataIndices=controllerLayer._destCrossClipNodeIndices;for(var i=0;i<ownerCount;i++){var nodeOwner=nodeOwners[i];if(nodeOwner){var destIndex=destDataIndices[i];var srcValue=nodeOwner.crossFixedValue;var desValue=destIndex!==-1?destRealtimeDatas[destIndex]:nodeOwner.defaultValue;this._applyCrossData(nodeOwner,additive,weight,isFirstLayer,srcValue,desValue,crossWeight);}}};_proto41._revertDefaultKeyframeNodes=function _revertDefaultKeyframeNodes(clipStateInfo){var nodeOwners=clipStateInfo._nodeOwners;for(var i=0,n=nodeOwners.length;i<n;i++){var nodeOwner=nodeOwners[i];if(nodeOwner){var pro=nodeOwner.propertyOwner;if(pro){switch(nodeOwner.type){case 0:var proPat=nodeOwner.property;var m=proPat.length-1;for(var j=0;j<m;j++){pro=pro[proPat[j]];if(!pro)break;}pro[proPat[m]]=nodeOwner.defaultValue;break;case 1:var locPos=pro.localPosition;var def=nodeOwner.defaultValue;locPos.x=def.x;locPos.y=def.y;locPos.z=def.z;pro.localPosition=locPos;break;case 2:var locRot=pro.localRotation;var defQua=nodeOwner.defaultValue;locRot.x=defQua.x;locRot.y=defQua.y;locRot.z=defQua.z;locRot.w=defQua.w;pro.localRotation=locRot;break;case 3:var locSca=pro.localScale;def=nodeOwner.defaultValue;locSca.x=def.x;locSca.y=def.y;locSca.z=def.z;pro.localScale=locSca;break;case 4:var locEul=pro.localRotationEuler;def=nodeOwner.defaultValue;locEul.x=def.x;locEul.y=def.y;locEul.z=def.z;pro.localRotationEuler=locEul;break;default:throw "Animator:unknown type.";}}}}};_proto41._onAdded=function _onAdded(){var parent=this.owner._parent;this.owner._setHierarchyAnimator(this,parent?parent._hierarchyAnimator:null);this.owner._changeAnimatorToLinkSprite3DNoAvatar(this,true,[]);};_proto41._onDestroy=function _onDestroy(){for(var i=0,n=this._controllerLayers.length;i<n;i++){this._controllerLayers[i]._removeReference();}var parent=this.owner._parent;this.owner._clearHierarchyAnimator(this,parent?parent._hierarchyAnimator:null);};_proto41._onEnable=function _onEnable(){this.owner._scene._animatorPool.add(this);for(var i=0,n=this._controllerLayers.length;i<n;i++){if(this._controllerLayers[i].playOnWake){var defaultClip=this.getDefaultState(i);defaultClip&&this.play(null,i,0);}}};_proto41._onDisable=function _onDisable(){this.owner._scene._animatorPool.remove(this);};_proto41._handleSpriteOwnersBySprite=function _handleSpriteOwnersBySprite(isLink,path,sprite){for(var i=0,n=this._controllerLayers.length;i<n;i++){var clipStateInfos=this._controllerLayers[i]._states;for(var j=0,m=clipStateInfos.length;j<m;j++){var clipStateInfo=clipStateInfos[j];var clip=clipStateInfo._clip;var nodePath=path.join("/");var ownersNodes=clip._nodesMap[nodePath];if(ownersNodes){var nodeOwners=clipStateInfo._nodeOwners;for(var k=0,p=ownersNodes.length;k<p;k++){if(isLink)this._addKeyframeNodeOwner(nodeOwners,ownersNodes[k],sprite);else this._removeKeyframeNodeOwner(nodeOwners,ownersNodes[k]);}}}}};_proto41._parse=function _parse(data){var avatarData=data.avatar;if(avatarData){this.avatar=Laya.Loader.getRes(avatarData.path);var linkSprites=avatarData.linkSprites;this._linkSprites=linkSprites;this._linkToSprites(linkSprites);}var clipPaths=data.clipPaths;var play=data.playOnWake;var layersData=data.layers;for(var i=0;i<layersData.length;i++){var layerData=layersData[i];var animatorLayer=new AnimatorControllerLayer(layerData.name);if(i===0)animatorLayer.defaultWeight=1.0;else animatorLayer.defaultWeight=layerData.weight;var blendingModeData=layerData.blendingMode;blendingModeData&&(animatorLayer.blendingMode=blendingModeData);this.addControllerLayer(animatorLayer);var states=layerData.states;for(var j=0,m=states.length;j<m;j++){var state=states[j];var clipPath=state.clipPath;if(clipPath){var name=state.name;var motion;motion=Laya.Loader.getRes(clipPath);if(motion){var animatorState=new AnimatorState();animatorState.name=name;animatorState.clip=motion;animatorLayer.addState(animatorState);j===0&&(this.getControllerLayer(i).defaultState=animatorState);}}}play!==undefined&&(animatorLayer.playOnWake=play);}var cullingModeData=data.cullingMode;cullingModeData!==undefined&&(this.cullingMode=cullingModeData);};_proto41._update=function _update(){var timer=this.owner._scene.timer;var delta=timer._delta/1000.0;if(this._speed===0||delta===0)return;var needRender;if(this.cullingMode===Animator.CULLINGMODE_CULLCOMPLETELY){needRender=false;for(var i=0,n=this._renderableSprites.length;i<n;i++){if(this._renderableSprites[i]._render.isRender){needRender=true;break;}}}else {needRender=true;}this._updateMark++;var timerScale=timer.scale;for(i=0,n=this._controllerLayers.length;i<n;i++){var controllerLayer=this._controllerLayers[i];var playStateInfo=controllerLayer._playStateInfo;var crossPlayStateInfo=controllerLayer._crossPlayStateInfo;addtive=controllerLayer.blendingMode!==AnimatorControllerLayer.BLENDINGMODE_OVERRIDE;switch(controllerLayer._playType){case 0:var animatorState=playStateInfo._currentState;var clip=animatorState._clip;var speed=this._speed*animatorState.speed;var finish=playStateInfo._finish;finish||this._updatePlayer(animatorState,playStateInfo,delta*speed,clip.islooping);if(needRender){var addtive=controllerLayer.blendingMode!==AnimatorControllerLayer.BLENDINGMODE_OVERRIDE;this._updateClipDatas(animatorState,addtive,playStateInfo,timerScale*speed);this._setClipDatasToNode(animatorState,addtive,controllerLayer.defaultWeight,i===0);finish||this._updateEventScript(animatorState,playStateInfo);}break;case 1:animatorState=playStateInfo._currentState;clip=animatorState._clip;var crossState=controllerLayer._crossPlayState;var crossClip=crossState._clip;var crossDuratuion=controllerLayer._crossDuration;var startPlayTime=crossPlayStateInfo._startPlayTime;var crossClipDuration=crossClip._duration-startPlayTime;var crossScale=crossDuratuion>crossClipDuration?crossClipDuration/crossDuratuion:1.0;var crossSpeed=this._speed*crossState.speed;this._updatePlayer(crossState,crossPlayStateInfo,delta*crossScale*crossSpeed,crossClip.islooping);var crossWeight=(crossPlayStateInfo._elapsedTime-startPlayTime)/crossScale/crossDuratuion;if(crossWeight>=1.0){if(needRender){this._updateClipDatas(crossState,addtive,crossPlayStateInfo,timerScale*crossSpeed);this._setClipDatasToNode(crossState,addtive,controllerLayer.defaultWeight,i===0);controllerLayer._playType=0;playStateInfo._currentState=crossState;crossPlayStateInfo._cloneTo(playStateInfo);}}else {if(!playStateInfo._finish){speed=this._speed*animatorState.speed;this._updatePlayer(animatorState,playStateInfo,delta*speed,clip.islooping);if(needRender)this._updateClipDatas(animatorState,addtive,playStateInfo,timerScale*speed);}if(needRender){this._updateClipDatas(crossState,addtive,crossPlayStateInfo,timerScale*crossScale*crossSpeed);this._setCrossClipDatasToNode(controllerLayer,animatorState,crossState,crossWeight,i===0);}}if(needRender){this._updateEventScript(animatorState,playStateInfo);this._updateEventScript(crossState,crossPlayStateInfo);}break;case 2:crossState=controllerLayer._crossPlayState;crossClip=crossState._clip;crossDuratuion=controllerLayer._crossDuration;startPlayTime=crossPlayStateInfo._startPlayTime;crossClipDuration=crossClip._duration-startPlayTime;crossScale=crossDuratuion>crossClipDuration?crossClipDuration/crossDuratuion:1.0;crossSpeed=this._speed*crossState.speed;this._updatePlayer(crossState,crossPlayStateInfo,delta*crossScale*crossSpeed,crossClip.islooping);if(needRender){crossWeight=(crossPlayStateInfo._elapsedTime-startPlayTime)/crossScale/crossDuratuion;if(crossWeight>=1.0){this._updateClipDatas(crossState,addtive,crossPlayStateInfo,timerScale*crossSpeed);this._setClipDatasToNode(crossState,addtive,1.0,i===0);controllerLayer._playType=0;playStateInfo._currentState=crossState;crossPlayStateInfo._cloneTo(playStateInfo);}else {this._updateClipDatas(crossState,addtive,crossPlayStateInfo,timerScale*crossScale*crossSpeed);this._setFixedCrossClipDatasToNode(controllerLayer,crossState,crossWeight,i===0);}this._updateEventScript(crossState,crossPlayStateInfo);}break;}}if(needRender){if(this._avatar){Laya.Render.supportWebGLPlusAnimation&&this._updateAnimationNodeWorldMatix(this._animationNodeLocalPositions,this._animationNodeLocalRotations,this._animationNodeLocalScales,this._animationNodeWorldMatrixs,this._animationNodeParentIndices);this._updateAvatarNodesToSprite();}}};_proto41._cloneTo=function _cloneTo(dest){var animator=dest;animator.avatar=this.avatar;animator.cullingMode=this.cullingMode;for(var i=0,n=this._controllerLayers.length;i<n;i++){var controllLayer=this._controllerLayers[i];animator.addControllerLayer(controllLayer.clone());var animatorStates=controllLayer._states;for(var j=0,m=animatorStates.length;j<m;j++){var state=animatorStates[j].clone();var cloneLayer=animator.getControllerLayer(i);cloneLayer.addState(state);j==0&&(cloneLayer.defaultState=state);}}animator._linkSprites=this._linkSprites;animator._linkToSprites(this._linkSprites);};_proto41.getDefaultState=function getDefaultState(layerIndex){if(layerIndex===void 0){layerIndex=0;}var controllerLayer=this._controllerLayers[layerIndex];return controllerLayer.defaultState;};_proto41.addState=function addState(state,layerIndex){if(layerIndex===void 0){layerIndex=0;}var controllerLayer=this._controllerLayers[layerIndex];controllerLayer.addState(state);console.warn("Animator:this function is discard,please use animatorControllerLayer.addState() instead.");};_proto41.removeState=function removeState(state,layerIndex){if(layerIndex===void 0){layerIndex=0;}var controllerLayer=this._controllerLayers[layerIndex];controllerLayer.removeState(state);console.warn("Animator:this function is discard,please use animatorControllerLayer.removeState() instead.");};_proto41.addControllerLayer=function addControllerLayer(controllderLayer){this._controllerLayers.push(controllderLayer);controllderLayer._animator=this;controllderLayer._addReference();var states=controllderLayer._states;for(var i=0,n=states.length;i<n;i++){this._getOwnersByClip(states[i]);}};_proto41.getControllerLayer=function getControllerLayer(layerInex){if(layerInex===void 0){layerInex=0;}return this._controllerLayers[layerInex];};_proto41.play=function play(name,layerIndex,normalizedTime){if(name===void 0){name=null;}if(layerIndex===void 0){layerIndex=0;}if(normalizedTime===void 0){normalizedTime=Number.NEGATIVE_INFINITY;}var controllerLayer=this._controllerLayers[layerIndex];if(controllerLayer){var defaultState=controllerLayer.defaultState;if(!name&&!defaultState)throw new Error("Animator:must have default clip value,please set clip property.");var playStateInfo=controllerLayer._playStateInfo;var curPlayState=playStateInfo._currentState;var animatorState=name?controllerLayer._statesMap[name]:defaultState;var clipDuration=animatorState._clip._duration;if(curPlayState!==animatorState){if(normalizedTime!==Number.NEGATIVE_INFINITY)playStateInfo._resetPlayState(clipDuration*normalizedTime);else playStateInfo._resetPlayState(0.0);curPlayState!==null&&curPlayState!==animatorState&&this._revertDefaultKeyframeNodes(curPlayState);controllerLayer._playType=0;playStateInfo._currentState=animatorState;}else {if(normalizedTime!==Number.NEGATIVE_INFINITY){playStateInfo._resetPlayState(clipDuration*normalizedTime);controllerLayer._playType=0;}}var scripts=animatorState._scripts;if(scripts){for(var i=0,n=scripts.length;i<n;i++){scripts[i].onStateEnter();}}}else {console.warn("Invalid layerIndex "+layerIndex+".");}};_proto41.crossFade=function crossFade(name,transitionDuration,layerIndex,normalizedTime){if(layerIndex===void 0){layerIndex=0;}if(normalizedTime===void 0){normalizedTime=Number.NEGATIVE_INFINITY;}var controllerLayer=this._controllerLayers[layerIndex];if(controllerLayer){var destAnimatorState=controllerLayer._statesMap[name];if(destAnimatorState){var playType=controllerLayer._playType;if(playType===-1){this.play(name,layerIndex,normalizedTime);return;}var crossPlayStateInfo=controllerLayer._crossPlayStateInfo;var crossNodeOwners=controllerLayer._crossNodesOwners;var crossNodeOwnerIndicesMap=controllerLayer._crossNodesOwnersIndicesMap;var srcAnimatorState=controllerLayer._playStateInfo._currentState;var destNodeOwners=destAnimatorState._nodeOwners;var destCrossClipNodeIndices=controllerLayer._destCrossClipNodeIndices;var destClip=destAnimatorState._clip;var destNodes=destClip._nodes;var destNodesMap=destClip._nodesDic;switch(playType){case 0:var srcNodeOwners=srcAnimatorState._nodeOwners;var scrCrossClipNodeIndices=controllerLayer._srcCrossClipNodeIndices;var srcClip=srcAnimatorState._clip;var srcNodes=srcClip._nodes;var srcNodesMap=srcClip._nodesDic;controllerLayer._playType=1;var crossMark=++controllerLayer._crossMark;var crossCount=controllerLayer._crossNodesOwnersCount=0;for(var i=0,n=srcNodes.count;i<n;i++){var srcNode=srcNodes.getNodeByIndex(i);var srcIndex=srcNode._indexInList;var srcNodeOwner=srcNodeOwners[srcIndex];if(srcNodeOwner){var srcFullPath=srcNode.fullPath;scrCrossClipNodeIndices[crossCount]=srcIndex;var destNode=destNodesMap[srcFullPath];if(destNode)destCrossClipNodeIndices[crossCount]=destNode._indexInList;else destCrossClipNodeIndices[crossCount]=-1;crossNodeOwnerIndicesMap[srcFullPath]=crossMark;crossNodeOwners[crossCount]=srcNodeOwner;crossCount++;}}for(i=0,n=destNodes.count;i<n;i++){destNode=destNodes.getNodeByIndex(i);var destIndex=destNode._indexInList;var destNodeOwner=destNodeOwners[destIndex];if(destNodeOwner){var destFullPath=destNode.fullPath;if(!srcNodesMap[destFullPath]){scrCrossClipNodeIndices[crossCount]=-1;destCrossClipNodeIndices[crossCount]=destIndex;crossNodeOwnerIndicesMap[destFullPath]=crossMark;crossNodeOwners[crossCount]=destNodeOwner;crossCount++;}}}break;case 1:case 2:controllerLayer._playType=2;for(i=0,n=crossNodeOwners.length;i<n;i++){var nodeOwner=crossNodeOwners[i];nodeOwner.saveCrossFixedValue();destNode=destNodesMap[nodeOwner.fullPath];if(destNode)destCrossClipNodeIndices[i]=destNode._indexInList;else destCrossClipNodeIndices[i]=-1;}crossCount=controllerLayer._crossNodesOwnersCount;crossMark=controllerLayer._crossMark;for(i=0,n=destNodes.count;i<n;i++){destNode=destNodes.getNodeByIndex(i);destIndex=destNode._indexInList;destNodeOwner=destNodeOwners[destIndex];if(destNodeOwner){destFullPath=destNode.fullPath;if(crossNodeOwnerIndicesMap[destFullPath]!==crossMark){destCrossClipNodeIndices[crossCount]=destIndex;crossNodeOwnerIndicesMap[destFullPath]=crossMark;nodeOwner=destNodeOwners[destIndex];crossNodeOwners[crossCount]=nodeOwner;nodeOwner.saveCrossFixedValue();crossCount++;}}}break;}controllerLayer._crossNodesOwnersCount=crossCount;controllerLayer._crossPlayState=destAnimatorState;controllerLayer._crossDuration=srcAnimatorState._clip._duration*transitionDuration;if(normalizedTime!==Number.NEGATIVE_INFINITY)crossPlayStateInfo._resetPlayState(destClip._duration*normalizedTime);else crossPlayStateInfo._resetPlayState(0.0);var scripts=destAnimatorState._scripts;if(scripts){for(i=0,n=scripts.length;i<n;i++){scripts[i].onStateEnter();}}}else {console.warn("Invalid name "+layerIndex+".");}}else {console.warn("Invalid layerIndex "+layerIndex+".");}};_proto41.getCurrentAnimatorPlayState=function getCurrentAnimatorPlayState(layerInex){if(layerInex===void 0){layerInex=0;}return this._controllerLayers[layerInex]._playStateInfo;};_proto41._isLinkSpriteToAnimationNodeData=function _isLinkSpriteToAnimationNodeData(sprite,nodeName,isLink){var linkSprites=this._linkAvatarSpritesData[nodeName];if(isLink){linkSprites||(this._linkAvatarSpritesData[nodeName]=linkSprites=[]);linkSprites.push(sprite);}else {var index=linkSprites.indexOf(sprite);linkSprites.splice(index,1);}};_proto41._getAvatarOwnersAndInitDatasAsync=function _getAvatarOwnersAndInitDatasAsync(){for(var i=0,n=this._controllerLayers.length;i<n;i++){var clipStateInfos=this._controllerLayers[i]._states;for(var j=0,m=clipStateInfos.length;j<m;j++){this._getOwnersByClip(clipStateInfos[j]);}}this._avatar._cloneDatasToAnimator(this);for(var k in this._linkAvatarSpritesData){var sprites=this._linkAvatarSpritesData[k];if(sprites){for(var c=0,p=sprites.length;c<p;c++){this._isLinkSpriteToAnimationNode(sprites[c],k,true);}}}};_proto41._isLinkSpriteToAnimationNode=function _isLinkSpriteToAnimationNode(sprite,nodeName,isLink){if(this._avatar){var node=this._avatarNodeMap[nodeName];if(node){if(isLink){sprite._transform._dummy=node.transform;this._linkAvatarSprites.push(sprite);var nodeTransform=node.transform;var spriteTransform=sprite.transform;if(!spriteTransform.owner.isStatic&&nodeTransform){var spriteWorldMatrix=spriteTransform.worldMatrix;var ownParTra=this.owner._transform._parent;if(ownParTra){Utils3D.matrix4x4MultiplyMFM(ownParTra.worldMatrix,nodeTransform.getWorldMatrix(),spriteWorldMatrix);}else {var sprWorE=spriteWorldMatrix.elements;var nodWorE=nodeTransform.getWorldMatrix();for(var i=0;i<16;i++){sprWorE[i]=nodWorE[i];}}spriteTransform.worldMatrix=spriteWorldMatrix;}}else {sprite._transform._dummy=null;this._linkAvatarSprites.splice(this._linkAvatarSprites.indexOf(sprite),1);}}}};_proto41._updateAvatarNodesToSprite=function _updateAvatarNodesToSprite(){for(var i=0,n=this._linkAvatarSprites.length;i<n;i++){var sprite=this._linkAvatarSprites[i];var nodeTransform=sprite.transform._dummy;var spriteTransform=sprite.transform;if(!spriteTransform.owner.isStatic&&nodeTransform){var spriteWorldMatrix=spriteTransform.worldMatrix;var ownTra=this.owner._transform;Utils3D.matrix4x4MultiplyMFM(ownTra.worldMatrix,nodeTransform.getWorldMatrix(),spriteWorldMatrix);spriteTransform.worldMatrix=spriteWorldMatrix;}}};_proto41.linkSprite3DToAvatarNode=function linkSprite3DToAvatarNode(nodeName,sprite3D){this._isLinkSpriteToAnimationNodeData(sprite3D,nodeName,true);this._isLinkSpriteToAnimationNode(sprite3D,nodeName,true);return true;};_proto41.unLinkSprite3DToAvatarNode=function unLinkSprite3DToAvatarNode(sprite3D){var dummy=sprite3D.transform._dummy;if(dummy){var nodeName=dummy._owner.name;this._isLinkSpriteToAnimationNodeData(sprite3D,nodeName,false);this._isLinkSpriteToAnimationNode(sprite3D,nodeName,false);return true;}else {return false;}};_proto41._updateAnimationNodeWorldMatix=function _updateAnimationNodeWorldMatix(localPositions,localRotations,localScales,worldMatrixs,parentIndices){Laya.LayaGL.instance.updateAnimationNodeWorldMatix(localPositions,localRotations,localScales,parentIndices,worldMatrixs);};_createClass(Animator,[{key:"speed",get:function get(){return this._speed;},set:function set(value){this._speed=value;}},{key:"avatar",get:function get(){return this._avatar;},set:function set(value){if(this._avatar!==value){this._avatar=value;if(value){this._getAvatarOwnersAndInitDatasAsync();this.owner._changeHierarchyAnimatorAvatar(this,value);}else {var parent=this.owner._parent;this.owner._changeHierarchyAnimatorAvatar(this,parent?parent._hierarchyAnimator._avatar:null);}}}}]);return Animator;}(Laya.Component);Animator._tempVector30=new Vector3();Animator._tempVector31=new Vector3();Animator._tempQuaternion0=new Quaternion();Animator._tempQuaternion1=new Quaternion();Animator.CULLINGMODE_ALWAYSANIMATE=0;Animator.CULLINGMODE_CULLCOMPLETELY=2;var PostProcessRenderContext=function PostProcessRenderContext(){this.source=null;this.destination=null;this.camera=null;this.compositeShaderData=null;this.command=null;this.deferredReleaseTextures=[];};var RenderContext3D=function RenderContext3D(){this.invertY=false;};RenderContext3D._instance=new RenderContext3D();var RenderTexture=/*#__PURE__*/function(_Laya$BaseTexture){_inheritsLoose(RenderTexture,_Laya$BaseTexture);function RenderTexture(width,height,format,depthStencilFormat){var _this18;if(format===void 0){format=Laya.RenderTextureFormat.R8G8B8;}if(depthStencilFormat===void 0){depthStencilFormat=Laya.RenderTextureDepthFormat.DEPTH_16;}_this18=_Laya$BaseTexture.call(this,format,false)||this;_this18._inPool=false;_this18._isCameraTarget=false;_this18._glTextureType=Laya.LayaGL.instance.TEXTURE_2D;_this18._width=width;_this18._height=height;_this18._depthStencilFormat=depthStencilFormat;_this18._mipmapCount=1;_this18._create(width,height);return _this18;}RenderTexture.createFromPool=function createFromPool(width,height,format,depthStencilFormat){if(format===void 0){format=Laya.RenderTextureFormat.R8G8B8;}if(depthStencilFormat===void 0){depthStencilFormat=Laya.RenderTextureDepthFormat.DEPTH_16;}var tex;for(var i=0,n=RenderTexture._pool.length;i<n;i++){tex=RenderTexture._pool[i];if(tex._width==width&&tex._height==height&&tex._format==format&&tex._depthStencilFormat==depthStencilFormat){tex._inPool=false;var end=RenderTexture._pool[n-1];RenderTexture._pool[i]=end;RenderTexture._pool.length-=1;return tex;}}tex=new RenderTexture(width,height,format,depthStencilFormat);tex.lock=true;return tex;};RenderTexture.recoverToPool=function recoverToPool(renderTexture){if(renderTexture._inPool)return;RenderTexture._pool.push(renderTexture);renderTexture._inPool=true;};var _proto42=RenderTexture.prototype;_proto42._create=function _create(width,height){var gl=Laya.LayaGL.instance;var gl2=gl;var glTextureType=this._glTextureType;var layaGPU=Laya.LayaGL.layaGPUInstance;var isWebGL2=layaGPU._isWebGL2;var format=this._format;this._frameBuffer=gl.createFramebuffer();gl.bindFramebuffer(gl.FRAMEBUFFER,this._frameBuffer);if(format!==Laya.RenderTextureFormat.Depth&&format!==Laya.RenderTextureFormat.ShadowMap){Laya.WebGLContext.bindTexture(gl,glTextureType,this._glTexture);switch(format){case Laya.RenderTextureFormat.R8G8B8:if(isWebGL2)gl2.texStorage2D(glTextureType,this._mipmapCount,gl2.RGB8,width,height);else gl.texImage2D(glTextureType,0,gl.RGB,width,height,0,gl.RGB,gl.UNSIGNED_BYTE,null);break;case Laya.RenderTextureFormat.R8G8B8A8:if(isWebGL2)gl2.texStorage2D(glTextureType,this._mipmapCount,gl2.RGBA8,width,height);else gl.texImage2D(glTextureType,0,gl.RGBA,width,height,0,gl.RGBA,gl.UNSIGNED_BYTE,null);break;case Laya.RenderTextureFormat.Alpha8:if(isWebGL2)gl2.texStorage2D(glTextureType,0,gl2.R8,width,height);else gl.texImage2D(glTextureType,0,gl.ALPHA,width,height,0,gl.ALPHA,gl.UNSIGNED_BYTE,null);break;case Laya.RenderTextureFormat.R16G16B16A16:if(isWebGL2)gl2.texStorage2D(glTextureType,this._mipmapCount,gl2.RGBA16F,width,height);else gl.texImage2D(glTextureType,0,gl.RGBA,width,height,0,gl.RGBA,layaGPU._oesTextureHalfFloat.HALF_FLOAT_OES,null);break;}gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,this._glTexture,0);}if(format==Laya.RenderTextureFormat.Depth||format==Laya.RenderTextureFormat.ShadowMap){Laya.WebGLContext.bindTexture(gl,glTextureType,this._glTexture);switch(this._depthStencilFormat){case Laya.RenderTextureDepthFormat.DEPTH_16:if(isWebGL2)gl2.texStorage2D(glTextureType,this._mipmapCount,gl2.DEPTH_COMPONENT16,width,height);else gl.texImage2D(glTextureType,0,gl.DEPTH_COMPONENT,width,height,0,gl.DEPTH_COMPONENT,gl.UNSIGNED_SHORT,null);gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.DEPTH_ATTACHMENT,gl.TEXTURE_2D,this._glTexture,0);break;case Laya.RenderTextureDepthFormat.DEPTHSTENCIL_24_8:if(isWebGL2)gl2.texStorage2D(glTextureType,this._mipmapCount,gl2.DEPTH24_STENCIL8,width,height);else gl.texImage2D(glTextureType,0,gl.DEPTH_STENCIL,width,height,0,gl.DEPTH_STENCIL,layaGPU._webgl_depth_texture.UNSIGNED_INT_24_8_WEBGL,null);gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.DEPTH_STENCIL_ATTACHMENT,gl.TEXTURE_2D,this._glTexture,0);break;default:throw "RenderTexture: depth format RenderTexture must use depthFormat with DEPTH_16 and DEPTHSTENCIL_16_8.";}if(isWebGL2&&format==Laya.RenderTextureFormat.ShadowMap)gl2.texParameteri(glTextureType,gl2.TEXTURE_COMPARE_MODE,gl2.COMPARE_REF_TO_TEXTURE);}else {if(this._depthStencilFormat!==Laya.RenderTextureDepthFormat.DEPTHSTENCIL_NONE){this._depthStencilBuffer=gl.createRenderbuffer();gl.bindRenderbuffer(gl.RENDERBUFFER,this._depthStencilBuffer);switch(this._depthStencilFormat){case Laya.RenderTextureDepthFormat.DEPTH_16:gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_COMPONENT16,width,height);gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_ATTACHMENT,gl.RENDERBUFFER,this._depthStencilBuffer);break;case Laya.RenderTextureDepthFormat.STENCIL_8:gl.renderbufferStorage(gl.RENDERBUFFER,gl.STENCIL_INDEX8,width,height);gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.STENCIL_ATTACHMENT,gl.RENDERBUFFER,this._depthStencilBuffer);break;case Laya.RenderTextureDepthFormat.DEPTHSTENCIL_24_8:gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,width,height);gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_STENCIL_ATTACHMENT,gl.RENDERBUFFER,this._depthStencilBuffer);break;default:throw "RenderTexture: unkonw depth format.";}gl.bindRenderbuffer(gl.RENDERBUFFER,null);}}gl.bindFramebuffer(gl.FRAMEBUFFER,null);this._setWarpMode(gl.TEXTURE_WRAP_S,this._wrapModeU);this._setWarpMode(gl.TEXTURE_WRAP_T,this._wrapModeV);this._setFilterMode(this._filterMode);this._setAnisotropy(this._anisoLevel);this._readyed=true;this._activeResource();this._setGPUMemory(width*height*4);};_proto42._start=function _start(){var gl=Laya.LayaGL.instance;gl.bindFramebuffer(gl.FRAMEBUFFER,this._frameBuffer);RenderTexture._currentActive=this;this._isCameraTarget&&(RenderContext3D._instance.invertY=true);this._readyed=false;};_proto42._end=function _end(){var gl=Laya.LayaGL.instance;gl.bindFramebuffer(gl.FRAMEBUFFER,null);RenderTexture._currentActive=null;this._isCameraTarget&&(RenderContext3D._instance.invertY=false);this._readyed=true;};_proto42.getData=function getData(x,y,width,height,out){if(Laya.Render.isConchApp&&window.conchConfig.threadMode==2){throw "native 2 thread mode use getDataAsync";}var gl=Laya.LayaGL.instance;gl.bindFramebuffer(gl.FRAMEBUFFER,this._frameBuffer);var canRead=gl.checkFramebufferStatus(gl.FRAMEBUFFER)===gl.FRAMEBUFFER_COMPLETE;if(!canRead){gl.bindFramebuffer(gl.FRAMEBUFFER,null);return null;}gl.readPixels(x,y,width,height,gl.RGBA,gl.UNSIGNED_BYTE,out);gl.bindFramebuffer(gl.FRAMEBUFFER,null);return out;};_proto42._disposeResource=function _disposeResource(){if(this._frameBuffer){var gl=Laya.LayaGL.instance;gl.deleteTexture(this._glTexture);gl.deleteFramebuffer(this._frameBuffer);gl.deleteRenderbuffer(this._depthStencilBuffer);this._glTexture=null;this._frameBuffer=null;this._depthStencilBuffer=null;this._setGPUMemory(0);}};_proto42.getDataAsync=function getDataAsync(x,y,width,height,callBack){var gl=Laya.LayaGL.instance;gl.bindFramebuffer(gl.FRAMEBUFFER,this._frameBuffer);gl.readPixelsAsync(x,y,width,height,gl.RGBA,gl.UNSIGNED_BYTE,function(data){callBack(new Uint8Array(data));});gl.bindFramebuffer(gl.FRAMEBUFFER,null);};_createClass(RenderTexture,[{key:"depthStencilFormat",get:function get(){return this._depthStencilFormat;}},{key:"defaulteTexture",get:function get(){return Laya.Texture2D.grayTexture;}}],[{key:"currentActive",get:function get(){return RenderTexture._currentActive;}}]);return RenderTexture;}(Laya.BaseTexture);RenderTexture._pool=[];var DefineDatas=/*#__PURE__*/function(){function DefineDatas(){this._mask=[];this._length=0;}var _proto43=DefineDatas.prototype;_proto43._intersectionDefineDatas=function _intersectionDefineDatas(define){var unionMask=define._mask;var mask=this._mask;for(var i=this._length-1;i>=0;i--){var value=mask[i]&unionMask[i];if(value==0&&i==this._length-1)this._length--;else mask[i]=value;}};_proto43.add=function add(define){var index=define._index;var size=index+1;var mask=this._mask;var maskStart=this._length;if(maskStart<size){mask.length<size&&(mask.length=size);for(;maskStart<index;maskStart++){mask[maskStart]=0;}mask[index]=define._value;this._length=size;}else {if(size>this._length){mask[index]=define._value;this._length=size;}else {mask[index]|=define._value;}}};_proto43.remove=function remove(define){var index=define._index;var mask=this._mask;var endIndex=this._length-1;if(index>endIndex)return;var newValue=mask[index]&~define._value;if(index==endIndex&&newValue===0)this._length--;else mask[index]=newValue;};_proto43.addDefineDatas=function addDefineDatas(define){var addMask=define._mask;var size=define._length;var mask=this._mask;var maskStart=mask.length;if(maskStart<size){mask.length=size;for(var i=0;i<maskStart;i++){mask[i]|=addMask[i];}for(;maskStart<size;maskStart++){mask[maskStart]=addMask[maskStart];}this._length=size;}else {for(var i=0;i<size;i++){mask[i]|=addMask[i];}this._length=Math.max(this._length,size);}};_proto43.removeDefineDatas=function removeDefineDatas(define){var removeMask=define._mask;var mask=this._mask;var endIndex=this._length-1;for(var i=define._length-1;i>=0;i--){if(i>endIndex)continue;var newValue=mask[i]&~removeMask[i];if(i==endIndex&&newValue===0){endIndex--;this._length--;}else {mask[i]=newValue;}}};_proto43.has=function has(define){var index=define._index;if(index>=this._length)return false;return (this._mask[index]&define._value)!==0;};_proto43.clear=function clear(){this._length=0;};_proto43.cloneTo=function cloneTo(destObject){var destDefineData=destObject;var destMask=destDefineData._mask;var mask=this._mask;var count=this._length;destMask.length=count;for(var i=0;i<count;i++){destMask[i]=mask[i];}destDefineData._length=count;};_proto43.clone=function clone(){var dest=new DefineDatas();this.cloneTo(dest);return dest;};return DefineDatas;}();var ShaderDefine=function ShaderDefine(index,value){this._index=index;this._value=value;};var ShaderVariant=/*#__PURE__*/function(){function ShaderVariant(shader,subShaderIndex,passIndex,defines){this._subShaderIndex=0;this._passIndex=0;this.setValue(shader,subShaderIndex,passIndex,defines);}var _proto44=ShaderVariant.prototype;_proto44.setValue=function setValue(shader,subShaderIndex,passIndex,defineNames){if(shader){var subShader=shader.getSubShaderAt(subShaderIndex);if(subShader){var pass=subShader._passes[passIndex];if(pass){var validDefine=pass._validDefine;for(var i=0,n=defineNames.length;i<n;i++){var defname=defineNames[i];if(!validDefine.has(ILaya3D.Shader3D.getDefineByName(defname)))throw "ShaderVariantInfo:Invalid defineName "+defname+" in "+shader._name+" subShaderIndex of "+subShaderIndex+" passIndex of "+passIndex+".";}}else {throw "ShaderVariantInfo:Shader don't have passIndex of "+passIndex+".";}}else {throw "ShaderVariantInfo:Shader don't have subShaderIndex of "+subShaderIndex+".";}}else {throw "ShaderVariantInfo:Shader can't be null.";}this._shader=shader;this._subShaderIndex=subShaderIndex;this._passIndex=passIndex;this._defineNames=defineNames;};_proto44.equal=function equal(other){if(this._shader!==other._shader||this._subShaderIndex!==other._subShaderIndex||this._passIndex!==other._passIndex)return false;var defines=this._defineNames;var otherDefines=other._defineNames;if(defines.length!==otherDefines.length)return false;for(var i=0,n=this._defineNames.length;i<n;i++){if(defines[i]!==otherDefines[i])return false;}return true;};_proto44.clone=function clone(){var dest=new ShaderVariant(this._shader,this._subShaderIndex,this._passIndex,this._defineNames.slice());return dest;};_createClass(ShaderVariant,[{key:"shader",get:function get(){return this._shader;}},{key:"subShaderIndex",get:function get(){return this._subShaderIndex;}},{key:"passIndex",get:function get(){return this._passIndex;}},{key:"defineNames",get:function get(){return this._defineNames;}}]);return ShaderVariant;}();var ShaderVariantCollection=/*#__PURE__*/function(){function ShaderVariantCollection(){this._allCompiled=false;this._variants=[];}var _proto45=ShaderVariantCollection.prototype;_proto45.add=function add(variant){for(var i=0,n=this._variants.length;i<n;i++){if(this._variants[i].equal(variant))return false;}this._variants.push(variant.clone());this._allCompiled=false;return true;};_proto45.remove=function remove(variant){for(var i=0,n=this._variants.length;i<n;i++){if(this._variants[i].equal(variant)){this._variants.splice(i,1);return true;}}return false;};_proto45.contatins=function contatins(variant){for(var i=0,n=this._variants.length;i<n;i++){if(this._variants[i].equal(variant))return true;}return false;};_proto45.getByIndex=function getByIndex(index){return this._variants[index];};_proto45.clear=function clear(){this._variants.length=0;};_proto45.compile=function compile(){if(!this._allCompiled){var variants=this._variants;for(var i=0,n=variants.length;i<n;i++){var variant=variants[i];ILaya3D.Shader3D.compileShaderByDefineNames(variant._shader._name,variant._subShaderIndex,variant._passIndex,variant._defineNames);}this._allCompiled=true;}};_createClass(ShaderVariantCollection,[{key:"allCompiled",get:function get(){return this._allCompiled;}},{key:"variantCount",get:function get(){return this._variants.length;}}]);return ShaderVariantCollection;}();var Shader3D=/*#__PURE__*/function(){function Shader3D(name,attributeMap,uniformMap,enableInstancing){this._attributeMap=null;this._uniformMap=null;this._enableInstancing=false;this._subShaders=[];this._name=name;this._attributeMap=attributeMap;this._uniformMap=uniformMap;this._enableInstancing=enableInstancing;}Shader3D._getNamesByDefineData=function _getNamesByDefineData(defineData,out){var maskMap=Shader3D._maskMap;var mask=defineData._mask;out.length=0;for(var i=0,n=defineData._length;i<n;i++){var subMaskMap=maskMap[i];var subMask=mask[i];for(var j=0;j<32;j++){var d=1<<j;if(subMask>0&&d>subMask)break;if(subMask&d)out.push(subMaskMap[d]);}}};Shader3D.getDefineByName=function getDefineByName(name){var define=Shader3D._defineMap[name];if(!define){var maskMap=Shader3D._maskMap;var counter=Shader3D._defineCounter;var index=Math.floor(counter/32);var value=1<<counter%32;define=new ShaderDefine(index,value);Shader3D._defineMap[name]=define;if(index==maskMap.length){maskMap.length++;maskMap[index]={};}maskMap[index][value]=name;Shader3D._defineCounter++;}return define;};Shader3D.propertyNameToID=function propertyNameToID(name){if(Shader3D._propertyNameMap[name]!=null){return Shader3D._propertyNameMap[name];}else {var id=Shader3D._propertyNameCounter++;Shader3D._propertyNameMap[name]=id;return id;}};Shader3D.getAttributeMapByDefine=function getAttributeMapByDefine(defineString,attributeMap){var newAttributeMap={};for(var value in attributeMap){newAttributeMap[value]=attributeMap[value];}for(var i=0,n=defineString.length;i<n;i++){var def=defineString[i];switch(def){case"SIMPLEBONE":if(attributeMap["a_Texcoord1"]){newAttributeMap["a_SimpleTextureParams"]=attributeMap["a_Texcoord1"];delete newAttributeMap["a_Texcoord1"];}newAttributeMap["a_SimpleTextureParams"]=7;break;}}return newAttributeMap;};Shader3D.addInclude=function addInclude(fileName,txt){txt=txt.replace(Laya.ShaderCompile._clearCR,"");Laya.ShaderCompile.addInclude(fileName,txt);};Shader3D.compileShaderByDefineNames=function compileShaderByDefineNames(shaderName,subShaderIndex,passIndex,defineNames){var shader=Shader3D.find(shaderName);if(shader){var subShader=shader.getSubShaderAt(subShaderIndex);if(subShader){var pass=subShader._passes[passIndex];if(pass){var compileDefineDatas=Shader3D._compileDefineDatas;compileDefineDatas.clear();for(var i=0,n=defineNames.length;i<n;i++){compileDefineDatas.add(Shader3D.getDefineByName(defineNames[i]));}pass.withCompile(compileDefineDatas);}else {console.warn("Shader3D: unknown passIndex.");}}else {console.warn("Shader3D: unknown subShaderIndex.");}}else {console.warn("Shader3D: unknown shader name.");}};Shader3D.add=function add(name,attributeMap,uniformMap,enableInstancing){if(attributeMap===void 0){attributeMap=null;}if(uniformMap===void 0){uniformMap=null;}if(enableInstancing===void 0){enableInstancing=false;}return Shader3D._preCompileShader[name]=new Shader3D(name,attributeMap,uniformMap,enableInstancing);};Shader3D.find=function find(name){return Shader3D._preCompileShader[name];};var _proto46=Shader3D.prototype;_proto46.addSubShader=function addSubShader(subShader){this._subShaders.push(subShader);subShader._owner=this;};_proto46.getSubShaderAt=function getSubShaderAt(index){return this._subShaders[index];};Shader3D.compileShader=function compileShader(shaderName,subShaderIndex,passIndex){var shader=Shader3D.find(shaderName);if(shader){var subShader=shader.getSubShaderAt(subShaderIndex);if(subShader){var pass=subShader._passes[passIndex];if(pass){var compileDefineDatas=Shader3D._compileDefineDatas;var mask=compileDefineDatas._mask;mask.length=0;for(var i=0,n=arguments.length<=3?0:arguments.length-3;i<n;i++){mask.push(i+3<3||arguments.length<=i+3?undefined:arguments[i+3]);}compileDefineDatas._length=arguments.length<=3?0:arguments.length-3;pass.withCompile(compileDefineDatas);}else {console.warn("Shader3D: unknown passIndex.");}}else {console.warn("Shader3D: unknown subShaderIndex.");}}else {console.warn("Shader3D: unknown shader name.");}};_createClass(Shader3D,[{key:"name",get:function get(){return this._name;}}]);return Shader3D;}();Shader3D._compileDefineDatas=new DefineDatas();Shader3D.RENDER_STATE_CULL=0;Shader3D.RENDER_STATE_BLEND=1;Shader3D.RENDER_STATE_BLEND_SRC=2;Shader3D.RENDER_STATE_BLEND_DST=3;Shader3D.RENDER_STATE_BLEND_SRC_RGB=4;Shader3D.RENDER_STATE_BLEND_DST_RGB=5;Shader3D.RENDER_STATE_BLEND_SRC_ALPHA=6;Shader3D.RENDER_STATE_BLEND_DST_ALPHA=7;Shader3D.RENDER_STATE_BLEND_CONST_COLOR=8;Shader3D.RENDER_STATE_BLEND_EQUATION=9;Shader3D.RENDER_STATE_BLEND_EQUATION_RGB=10;Shader3D.RENDER_STATE_BLEND_EQUATION_ALPHA=11;Shader3D.RENDER_STATE_DEPTH_TEST=12;Shader3D.RENDER_STATE_DEPTH_WRITE=13;Shader3D.PERIOD_CUSTOM=0;Shader3D.PERIOD_MATERIAL=1;Shader3D.PERIOD_SPRITE=2;Shader3D.PERIOD_CAMERA=3;Shader3D.PERIOD_SCENE=4;Shader3D._propertyNameCounter=0;Shader3D._propertyNameMap={};Shader3D._defineCounter=0;Shader3D._defineMap={};Shader3D._preCompileShader={};Shader3D._maskMap=[];Shader3D.debugMode=false;Shader3D.debugShaderVariantCollection=new ShaderVariantCollection();var ShaderData=/*#__PURE__*/function(){function ShaderData(ownerResource){if(ownerResource===void 0){ownerResource=null;}this._ownerResource=null;this._data=null;this._defineDatas=new DefineDatas();this._runtimeCopyValues=[];this._ownerResource=ownerResource;this._initData();}var _proto47=ShaderData.prototype;_proto47._initData=function _initData(){this._data=new Object();};_proto47.getData=function getData(){return this._data;};_proto47.addDefine=function addDefine(define){this._defineDatas.add(define);};_proto47.removeDefine=function removeDefine(define){this._defineDatas.remove(define);};_proto47.hasDefine=function hasDefine(define){return this._defineDatas.has(define);};_proto47.clearDefine=function clearDefine(){this._defineDatas.clear();};_proto47.getBool=function getBool(index){return this._data[index];};_proto47.setBool=function setBool(index,value){this._data[index]=value;};_proto47.getInt=function getInt(index){return this._data[index];};_proto47.setInt=function setInt(index,value){this._data[index]=value;};_proto47.getNumber=function getNumber(index){return this._data[index];};_proto47.setNumber=function setNumber(index,value){this._data[index]=value;};_proto47.getVector2=function getVector2(index){return this._data[index];};_proto47.setVector2=function setVector2(index,value){this._data[index]=value;};_proto47.getVector3=function getVector3(index){return this._data[index];};_proto47.setVector3=function setVector3(index,value){this._data[index]=value;};_proto47.getVector=function getVector(index){return this._data[index];};_proto47.setVector=function setVector(index,value){this._data[index]=value;};_proto47.getQuaternion=function getQuaternion(index){return this._data[index];};_proto47.setQuaternion=function setQuaternion(index,value){this._data[index]=value;};_proto47.getMatrix4x4=function getMatrix4x4(index){return this._data[index];};_proto47.setMatrix4x4=function setMatrix4x4(index,value){this._data[index]=value;};_proto47.getBuffer=function getBuffer(shaderIndex){return this._data[shaderIndex];};_proto47.setBuffer=function setBuffer(index,value){this._data[index]=value;};_proto47.setTexture=function setTexture(index,value){var lastValue=this._data[index];this._data[index]=value;if(this._ownerResource&&this._ownerResource.referenceCount>0){lastValue&&lastValue._removeReference();value&&value._addReference();}};_proto47.getTexture=function getTexture(index){return this._data[index];};_proto47.setAttribute=function setAttribute(index,value){this._data[index]=value;};_proto47.getAttribute=function getAttribute(index){return this._data[index];};_proto47.getLength=function getLength(){return this._data.length;};_proto47.setLength=function setLength(value){this._data.length=value;};_proto47.cloneTo=function cloneTo(destObject){var dest=destObject;var destData=dest._data;for(var k in this._data){var value=this._data[k];if(value!=null){if(typeof value=='number'){destData[k]=value;}else if(typeof value=='number'){destData[k]=value;}else if(typeof value=="boolean"){destData[k]=value;}else if(value instanceof Vector2){var v2=destData[k]||(destData[k]=new Vector2());value.cloneTo(v2);destData[k]=v2;}else if(value instanceof Vector3){var v3=destData[k]||(destData[k]=new Vector3());value.cloneTo(v3);destData[k]=v3;}else if(value instanceof Vector4){var v4=destData[k]||(destData[k]=new Vector4());value.cloneTo(v4);destData[k]=v4;}else if(value instanceof Matrix4x4){var mat=destData[k]||(destData[k]=new Matrix4x4());value.cloneTo(mat);destData[k]=mat;}else if(value instanceof Laya.BaseTexture){destData[k]=value;}}}this._defineDatas.cloneTo(dest._defineDatas);};_proto47.clone=function clone(){var dest=new ShaderData();this.cloneTo(dest);return dest;};_proto47.cloneToForNative=function cloneToForNative(destObject){var dest=destObject;var diffSize=this._int32Data.length-dest._int32Data.length;if(diffSize>0){dest.needRenewArrayBufferForNative(this._int32Data.length);}dest._int32Data.set(this._int32Data,0);var destData=dest._nativeArray;var dataCount=this._nativeArray.length;destData.length=dataCount;for(var i=0;i<dataCount;i++){var value=this._nativeArray[i];if(value){if(typeof value=='number'){destData[i]=value;dest.setNumber(i,value);}else if(typeof value=='number'){destData[i]=value;dest.setInt(i,value);}else if(typeof value=="boolean"){destData[i]=value;dest.setBool(i,value);}else if(value instanceof Vector2){var v2=destData[i]||(destData[i]=new Vector2());value.cloneTo(v2);destData[i]=v2;dest.setVector2(i,v2);}else if(value instanceof Vector3){var v3=destData[i]||(destData[i]=new Vector3());value.cloneTo(v3);destData[i]=v3;dest.setVector3(i,v3);}else if(value instanceof Vector4){var v4=destData[i]||(destData[i]=new Vector4());value.cloneTo(v4);destData[i]=v4;dest.setVector(i,v4);}else if(value instanceof Matrix4x4){var mat=destData[i]||(destData[i]=new Matrix4x4());value.cloneTo(mat);destData[i]=mat;dest.setMatrix4x4(i,mat);}else if(value instanceof Laya.BaseTexture){destData[i]=value;dest.setTexture(i,value);}}}this._defineDatas.cloneTo(dest._defineDatas);};_proto47._initDataForNative=function _initDataForNative(){var length=8;this._frameCount=-1;this._runtimeCopyValues.length=0;this._nativeArray=[];this._data=new ArrayBuffer(length*4);this._int32Data=new Int32Array(this._data);this._float32Data=new Float32Array(this._data);Laya.LayaGL.instance.createArrayBufferRef(this._data,Laya.LayaGL.ARRAY_BUFFER_TYPE_DATA,true);};_proto47.needRenewArrayBufferForNative=function needRenewArrayBufferForNative(index){if(index>=this._int32Data.length){var nByteLen=(index+1)*4;var pre=this._int32Data;var preConchRef=this._data["conchRef"];var prePtrID=this._data["_ptrID"];this._data=new ArrayBuffer(nByteLen);this._int32Data=new Int32Array(this._data);this._float32Data=new Float32Array(this._data);this._data["conchRef"]=preConchRef;this._data["_ptrID"]=prePtrID;pre&&this._int32Data.set(pre,0);var layagl=Laya.LayaGL.instance;if(layagl.updateArrayBufferRef){layagl.updateArrayBufferRef(this._data['_ptrID'],preConchRef.isSyncToRender(),this._data);}else {window.conch.updateArrayBufferRef(this._data['_ptrID'],preConchRef.isSyncToRender(),this._data);}}};_proto47.getDataForNative=function getDataForNative(){return this._nativeArray;};_proto47.getIntForNative=function getIntForNative(index){return this._int32Data[index];};_proto47.setIntForNative=function setIntForNative(index,value){this.needRenewArrayBufferForNative(index);this._int32Data[index]=value;this._nativeArray[index]=value;};_proto47.getBoolForNative=function getBoolForNative(index){return this._int32Data[index]==1;};_proto47.setBoolForNative=function setBoolForNative(index,value){this.needRenewArrayBufferForNative(index);this._int32Data[index]=value?1:0;this._nativeArray[index]=value;};_proto47.getNumberForNative=function getNumberForNative(index){return this._float32Data[index];};_proto47.setNumberForNative=function setNumberForNative(index,value){this.needRenewArrayBufferForNative(index);this._float32Data[index]=value;this._nativeArray[index]=value;};_proto47.getMatrix4x4ForNative=function getMatrix4x4ForNative(index){return this._nativeArray[index];};_proto47.setMatrix4x4ForNative=function setMatrix4x4ForNative(index,value){this.needRenewArrayBufferForNative(index);this._nativeArray[index]=value;var nPtrID=this.setReferenceForNative(value.elements);this._int32Data[index]=nPtrID;};_proto47.getVectorForNative=function getVectorForNative(index){return this._nativeArray[index];};_proto47.setVectorForNative=function setVectorForNative(index,value){this.needRenewArrayBufferForNative(index);this._nativeArray[index]=value;if(!value.elements){value.forNativeElement();}var nPtrID=this.setReferenceForNative(value.elements);this._int32Data[index]=nPtrID;};_proto47.getVector2ForNative=function getVector2ForNative(index){return this._nativeArray[index];};_proto47.setVector2ForNative=function setVector2ForNative(index,value){this.needRenewArrayBufferForNative(index);this._nativeArray[index]=value;if(!value.elements){value.forNativeElement();}var nPtrID=this.setReferenceForNative(value.elements);this._int32Data[index]=nPtrID;};_proto47.getVector3ForNative=function getVector3ForNative(index){return this._nativeArray[index];};_proto47.setVector3ForNative=function setVector3ForNative(index,value){this.needRenewArrayBufferForNative(index);this._nativeArray[index]=value;if(!value.elements){value.forNativeElement();}var nPtrID=this.setReferenceForNative(value.elements);this._int32Data[index]=nPtrID;};_proto47.getQuaternionForNative=function getQuaternionForNative(index){return this._nativeArray[index];};_proto47.setQuaternionForNative=function setQuaternionForNative(index,value){this.needRenewArrayBufferForNative(index);this._nativeArray[index]=value;if(!value.elements){value.forNativeElement();}var nPtrID=this.setReferenceForNative(value.elements);this._int32Data[index]=nPtrID;};_proto47.getBufferForNative=function getBufferForNative(shaderIndex){return this._nativeArray[shaderIndex];};_proto47.setBufferForNative=function setBufferForNative(index,value){this.needRenewArrayBufferForNative(index);this._nativeArray[index]=value;var nPtrID=this.setReferenceForNative(value);this._int32Data[index]=nPtrID;};_proto47.getAttributeForNative=function getAttributeForNative(index){return this._nativeArray[index];};_proto47.setAttributeForNative=function setAttributeForNative(index,value){this._nativeArray[index]=value;if(!value["_ptrID"]){Laya.LayaGL.instance.createArrayBufferRef(value,Laya.LayaGL.ARRAY_BUFFER_TYPE_DATA,true);}Laya.LayaGL.instance.syncBufferToRenderThread(value);this._int32Data[index]=value["_ptrID"];};_proto47.getTextureForNative=function getTextureForNative(index){return this._nativeArray[index];};_proto47.setTextureForNative=function setTextureForNative(index,value){if(!value)return;this.needRenewArrayBufferForNative(index);var lastValue=this._nativeArray[index];this._nativeArray[index]=value;var glTexture=value._getSource()||value.defaulteTexture._getSource();this._int32Data[index]=glTexture.id;if(this._ownerResource&&this._ownerResource.referenceCount>0){lastValue&&lastValue._removeReference();value&&value._addReference();}};_proto47.setReferenceForNative=function setReferenceForNative(value){this.clearRuntimeCopyArray();var nRefID=0;var nPtrID=0;if(ShaderData._SET_RUNTIME_VALUE_MODE_REFERENCE_){Laya.LayaGL.instance.createArrayBufferRefs(value,Laya.LayaGL.ARRAY_BUFFER_TYPE_DATA,true,Laya.LayaGL.ARRAY_BUFFER_REF_REFERENCE);nRefID=0;nPtrID=value.getPtrID(nRefID);}else {Laya.LayaGL.instance.createArrayBufferRefs(value,Laya.LayaGL.ARRAY_BUFFER_TYPE_DATA,true,Laya.LayaGL.ARRAY_BUFFER_REF_COPY);nRefID=value.getRefNum()-1;nPtrID=value.getPtrID(nRefID);this._runtimeCopyValues.push({"obj":value,"refID":nRefID,"ptrID":nPtrID});}Laya.LayaGL.instance.syncBufferToRenderThread(value,nRefID);return nPtrID;};ShaderData.setRuntimeValueMode=function setRuntimeValueMode(bReference){ShaderData._SET_RUNTIME_VALUE_MODE_REFERENCE_=bReference;};_proto47.clearRuntimeCopyArray=function clearRuntimeCopyArray(){var currentFrame=Laya.Stat.loopCount;if(this._frameCount!=currentFrame){this._frameCount=currentFrame;for(var i=0,n=this._runtimeCopyValues.length;i<n;i++){var obj=this._runtimeCopyValues[i];obj.obj.clearRefNum();}this._runtimeCopyValues.length=0;}};return ShaderData;}();ShaderData._SET_RUNTIME_VALUE_MODE_REFERENCE_=true;var PostProcess=/*#__PURE__*/function(){function PostProcess(){this._compositeShader=Shader3D.find("PostProcessComposite");this._compositeShaderData=new ShaderData();this._effects=[];this._context=null;this._context=new PostProcessRenderContext();this._context.compositeShaderData=this._compositeShaderData;}PostProcess.__init__=function __init__(){PostProcess.SHADERDEFINE_BLOOM_LOW=Shader3D.getDefineByName("BLOOM_LOW");PostProcess.SHADERDEFINE_BLOOM=Shader3D.getDefineByName("BLOOM");PostProcess.SHADERDEFINE_FINALPASS=Shader3D.getDefineByName("FINALPASS");};var _proto48=PostProcess.prototype;_proto48._init=function _init(camera,command){this._context.camera=camera;this._context.command=command;};_proto48._render=function _render(){var noteValue=ShaderData._SET_RUNTIME_VALUE_MODE_REFERENCE_;Laya.ILaya.Render.supportWebGLPlusRendering&&ShaderData.setRuntimeValueMode(false);var camera=this._context.camera;var viewport=camera.viewport;var screenTexture=RenderTexture.createFromPool(RenderContext3D.clientWidth,RenderContext3D.clientHeight,camera._getRenderTextureFormat(),Laya.RenderTextureDepthFormat.DEPTHSTENCIL_NONE);var cameraTarget=camera._internalRenderTexture;this._context.command.clear();this._context.source=screenTexture;this._context.destination=cameraTarget;this._context.compositeShaderData.clearDefine();this._context.command.blitScreenTriangle(cameraTarget,screenTexture);this._context.compositeShaderData.setTexture(PostProcess.SHADERVALUE_AUTOEXPOSURETEX,Laya.Texture2D.whiteTexture);for(var i=0,n=this._effects.length;i<n;i++){this._effects[i].render(this._context);}this._compositeShaderData.addDefine(PostProcess.SHADERDEFINE_FINALPASS);var offScreenTex=camera._offScreenRenderTexture;var dest=offScreenTex?offScreenTex:null;this._context.destination=dest;var canvasWidth=camera._getCanvasWidth(),canvasHeight=camera._getCanvasHeight();camera._screenOffsetScale.setValue(viewport.x/canvasWidth,viewport.y/canvasHeight,viewport.width/canvasWidth,viewport.height/canvasHeight);this._context.command.blitScreenTriangle(this._context.source,dest,camera._screenOffsetScale,this._compositeShader,this._compositeShaderData);RenderTexture.recoverToPool(screenTexture);var tempRenderTextures=this._context.deferredReleaseTextures;for(i=0,n=tempRenderTextures.length;i<n;i++){RenderTexture.recoverToPool(tempRenderTextures[i]);}tempRenderTextures.length=0;Laya.ILaya.Render.supportWebGLPlusRendering&&ShaderData.setRuntimeValueMode(noteValue);};_proto48.addEffect=function addEffect(effect){this._effects.push(effect);};_proto48.removeEffect=function removeEffect(effect){var index=this._effects.indexOf(effect);if(index!==-1)this._effects.splice(index,1);};return PostProcess;}();PostProcess.SHADERVALUE_MAINTEX=Shader3D.propertyNameToID("u_MainTex");PostProcess.SHADERVALUE_BLOOMTEX=Shader3D.propertyNameToID("u_BloomTex");PostProcess.SHADERVALUE_AUTOEXPOSURETEX=Shader3D.propertyNameToID("u_AutoExposureTex");PostProcess.SHADERVALUE_BLOOM_DIRTTEX=Shader3D.propertyNameToID("u_Bloom_DirtTex");PostProcess.SHADERVALUE_BLOOMTEX_TEXELSIZE=Shader3D.propertyNameToID("u_BloomTex_TexelSize");PostProcess.SHADERVALUE_BLOOM_DIRTTILEOFFSET=Shader3D.propertyNameToID("u_Bloom_DirtTileOffset");PostProcess.SHADERVALUE_BLOOM_SETTINGS=Shader3D.propertyNameToID("u_Bloom_Settings");PostProcess.SHADERVALUE_BLOOM_COLOR=Shader3D.propertyNameToID("u_Bloom_Color");var AnimationTransform3D=/*#__PURE__*/function(_Laya$EventDispatcher2){_inheritsLoose(AnimationTransform3D,_Laya$EventDispatcher2);function AnimationTransform3D(owner,localPosition,localRotation,localScale,worldMatrix){var _this19;if(localPosition===void 0){localPosition=null;}if(localRotation===void 0){localRotation=null;}if(localScale===void 0){localScale=null;}if(worldMatrix===void 0){worldMatrix=null;}_this19=_Laya$EventDispatcher2.call(this)||this;_this19._owner=owner;_this19._children=[];_this19._localMatrix=new Float32Array(16);if(Laya.Render.supportWebGLPlusAnimation){_this19._localPosition=new ConchVector3(0,0,0,localPosition);_this19._localRotation=new ConchQuaternion(0,0,0,1,localRotation);_this19._localScale=new ConchVector3(0,0,0,localScale);_this19._worldMatrix=worldMatrix;}else {_this19._localPosition=new Vector3();_this19._localRotation=new Quaternion();_this19._localScale=new Vector3();_this19._worldMatrix=new Float32Array(16);}_this19._localQuaternionUpdate=false;_this19._locaEulerlUpdate=false;_this19._localUpdate=false;_this19._worldUpdate=true;return _this19;}var _proto49=AnimationTransform3D.prototype;_proto49._getlocalMatrix=function _getlocalMatrix(){if(this._localUpdate){Utils3D._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix);this._localUpdate=false;}return this._localMatrix;};_proto49._onWorldTransform=function _onWorldTransform(){if(!this._worldUpdate){this._worldUpdate=true;this.event(Laya.Event.TRANSFORM_CHANGED);for(var i=0,n=this._children.length;i<n;i++){this._children[i]._onWorldTransform();}}};_proto49.getWorldMatrix=function getWorldMatrix(){if(!Laya.Render.supportWebGLPlusAnimation&&this._worldUpdate){if(this._parent!=null){Utils3D.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);}else {var e=this._worldMatrix;e[1]=e[2]=e[3]=e[4]=e[6]=e[7]=e[8]=e[9]=e[11]=e[12]=e[13]=e[14]=0;e[0]=e[5]=e[10]=e[15]=1;}this._worldUpdate=false;}if(Laya.Render.supportWebGLPlusAnimation&&this._worldUpdate){this._worldUpdate=false;}return this._worldMatrix;};_proto49.setParent=function setParent(value){if(this._parent!==value){if(this._parent){var parentChilds=this._parent._children;var index=parentChilds.indexOf(this);parentChilds.splice(index,1);}if(value){value._children.push(this);value&&this._onWorldTransform();}this._parent=value;}};_createClass(AnimationTransform3D,[{key:"localPosition",get:function get(){return this._localPosition;},set:function set(value){this._localPosition=value;this._localUpdate=true;this._onWorldTransform();}},{key:"localRotation",get:function get(){if(this._localQuaternionUpdate){var euler=this._localRotationEuler;Quaternion.createFromYawPitchRoll(euler.y/AnimationTransform3D._angleToRandin,euler.x/AnimationTransform3D._angleToRandin,euler.z/AnimationTransform3D._angleToRandin,this._localRotation);this._localQuaternionUpdate=false;}return this._localRotation;},set:function set(value){this._localRotation=value;this._locaEulerlUpdate=true;this._localQuaternionUpdate=false;this._localUpdate=true;this._onWorldTransform();}},{key:"localScale",get:function get(){return this._localScale;},set:function set(value){this._localScale=value;this._localUpdate=true;this._onWorldTransform();}},{key:"localRotationEuler",get:function get(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(AnimationTransform3D._tempVector3);var euler=AnimationTransform3D._tempVector3;var localRotationEuler=this._localRotationEuler;localRotationEuler.x=euler.y*AnimationTransform3D._angleToRandin;localRotationEuler.y=euler.x*AnimationTransform3D._angleToRandin;localRotationEuler.z=euler.z*AnimationTransform3D._angleToRandin;this._locaEulerlUpdate=false;}return this._localRotationEuler;},set:function set(value){this._localRotationEuler=value;this._locaEulerlUpdate=false;this._localQuaternionUpdate=true;this._localUpdate=true;this._onWorldTransform();}}]);return AnimationTransform3D;}(Laya.EventDispatcher);AnimationTransform3D._tempVector3=new Vector3();AnimationTransform3D._angleToRandin=180/Math.PI;var AnimationNode=/*#__PURE__*/function(){function AnimationNode(localPosition,localRotation,localScale,worldMatrix){if(localPosition===void 0){localPosition=null;}if(localRotation===void 0){localRotation=null;}if(localScale===void 0){localScale=null;}if(worldMatrix===void 0){worldMatrix=null;}this._children=[];this.transform=new AnimationTransform3D(this,localPosition,localRotation,localScale,worldMatrix);}var _proto50=AnimationNode.prototype;_proto50.addChild=function addChild(child){child._parent=this;child.transform.setParent(this.transform);this._children.push(child);};_proto50.removeChild=function removeChild(child){var index=this._children.indexOf(child);index!==-1&&this._children.splice(index,1);};_proto50.getChildByName=function getChildByName(name){for(var i=0,n=this._children.length;i<n;i++){var child=this._children[i];if(child.name===name)return child;}return null;};_proto50.getChildByIndex=function getChildByIndex(index){return this._children[index];};_proto50.getChildCount=function getChildCount(){return this._children.length;};_proto50.cloneTo=function cloneTo(destObject){var destNode=destObject;destNode.name=this.name;for(var i=0,n=this._children.length;i<n;i++){var child=this._children[i];var destChild=child.clone();destNode.addChild(destChild);var transform=child.transform;var destTransform=destChild.transform;var destLocalPosition=destTransform.localPosition;var destLocalRotation=destTransform.localRotation;var destLocalScale=destTransform.localScale;transform.localPosition.cloneTo(destLocalPosition);transform.localRotation.cloneTo(destLocalRotation);transform.localScale.cloneTo(destLocalScale);destTransform.localPosition=destLocalPosition;destTransform.localRotation=destLocalRotation;destTransform.localScale=destLocalScale;}};_proto50.clone=function clone(){var dest=new AnimationNode();this.cloneTo(dest);return dest;};_proto50._cloneNative=function _cloneNative(localPositions,localRotations,localScales,animationNodeWorldMatrixs,animationNodeParentIndices,parentIndex,avatar){var curID=avatar._nativeCurCloneCount;animationNodeParentIndices[curID]=parentIndex;var localPosition=new Float32Array(localPositions.buffer,curID*3*4,3);var localRotation=new Float32Array(localRotations.buffer,curID*4*4,4);var localScale=new Float32Array(localScales.buffer,curID*3*4,3);var worldMatrix=new Float32Array(animationNodeWorldMatrixs.buffer,curID*16*4,16);var dest=new AnimationNode(localPosition,localRotation,localScale,worldMatrix);dest._worldMatrixIndex=curID;this._cloneToNative(dest,localPositions,localRotations,localScales,animationNodeWorldMatrixs,animationNodeParentIndices,curID,avatar);return dest;};_proto50._cloneToNative=function _cloneToNative(destObject,localPositions,localRotations,localScales,animationNodeWorldMatrixs,animationNodeParentIndices,parentIndex,avatar){var destNode=destObject;destNode.name=this.name;for(var i=0,n=this._children.length;i<n;i++){var child=this._children[i];avatar._nativeCurCloneCount++;var destChild=child._cloneNative(localPositions,localRotations,localScales,animationNodeWorldMatrixs,animationNodeParentIndices,parentIndex,avatar);destNode.addChild(destChild);var transform=child.transform;var destTransform=destChild.transform;var destLocalPosition=destTransform.localPosition;var destLocalRotation=destTransform.localRotation;var destLocalScale=destTransform.localScale;transform.localPosition.cloneTo(destLocalPosition);transform.localRotation.cloneTo(destLocalRotation);transform.localScale.cloneTo(destLocalScale);destTransform.localPosition=destLocalPosition;destTransform.localRotation=destLocalRotation;destTransform.localScale=destLocalScale;}};return AnimationNode;}();var Avatar=/*#__PURE__*/function(_Laya$Resource2){_inheritsLoose(Avatar,_Laya$Resource2);function Avatar(){var _this20;_this20=_Laya$Resource2.call(this)||this;_this20._nativeNodeCount=0;_this20._nativeCurCloneCount=0;return _this20;}Avatar._parse=function _parse(data,propertyParams,constructParams){var avatar=new Avatar();avatar._rootNode=new AnimationNode(new Float32Array(3),new Float32Array(4),new Float32Array(3),new Float32Array(16));if(Laya.Render.supportWebGLPlusAnimation)avatar._nativeNodeCount++;if(data.version){var rootNode=data.rootNode;rootNode&&avatar._parseNode(rootNode,avatar._rootNode);}return avatar;};Avatar.load=function load(url,complete){Laya.ILaya.loader.create(url,complete,null,Avatar.AVATAR);};var _proto51=Avatar.prototype;_proto51._initCloneToAnimator=function _initCloneToAnimator(destNode,destAnimator){destAnimator._avatarNodeMap[destNode.name]=destNode;for(var i=0,n=destNode.getChildCount();i<n;i++){this._initCloneToAnimator(destNode.getChildByIndex(i),destAnimator);}};_proto51._parseNode=function _parseNode(nodaData,node){var name=nodaData.props.name;node.name=name;var props=nodaData.props;var transform=node.transform;var pos=transform.localPosition;var rot=transform.localRotation;var sca=transform.localScale;pos.fromArray(props.translate);rot.fromArray(props.rotation);sca.fromArray(props.scale);transform.localPosition=pos;transform.localRotation=rot;transform.localScale=sca;var childrenData=nodaData.child;for(var j=0,n=childrenData.length;j<n;j++){var childData=childrenData[j];var childBone=new AnimationNode(new Float32Array(3),new Float32Array(4),new Float32Array(3),new Float32Array(16));node.addChild(childBone);if(Laya.Render.supportWebGLPlusAnimation)this._nativeNodeCount++;this._parseNode(childData,childBone);}};_proto51._cloneDatasToAnimator=function _cloneDatasToAnimator(destAnimator){var destRoot;destRoot=this._rootNode.clone();var transform=this._rootNode.transform;var destTransform=destRoot.transform;var destPosition=destTransform.localPosition;var destRotation=destTransform.localRotation;var destScale=destTransform.localScale;transform.localPosition.cloneTo(destPosition);transform.localRotation.cloneTo(destRotation);transform.localScale.cloneTo(destScale);destTransform.localPosition=destPosition;destTransform.localRotation=destRotation;destTransform.localScale=destScale;destAnimator._avatarNodeMap={};this._initCloneToAnimator(destRoot,destAnimator);};_proto51.cloneTo=function cloneTo(destObject){var destAvatar=destObject;var destRoot=this._rootNode.clone();destAvatar._rootNode=destRoot;};_proto51.clone=function clone(){var dest=new Avatar();this.cloneTo(dest);return dest;};_proto51._cloneDatasToAnimatorNative=function _cloneDatasToAnimatorNative(destAnimator){var animationNodeLocalPositions=new Float32Array(this._nativeNodeCount*3);var animationNodeLocalRotations=new Float32Array(this._nativeNodeCount*4);var animationNodeLocalScales=new Float32Array(this._nativeNodeCount*3);var animationNodeWorldMatrixs=new Float32Array(this._nativeNodeCount*16);var animationNodeParentIndices=new Int16Array(this._nativeNodeCount);destAnimator._animationNodeLocalPositions=animationNodeLocalPositions;destAnimator._animationNodeLocalRotations=animationNodeLocalRotations;destAnimator._animationNodeLocalScales=animationNodeLocalScales;destAnimator._animationNodeWorldMatrixs=animationNodeWorldMatrixs;destAnimator._animationNodeParentIndices=animationNodeParentIndices;this._nativeCurCloneCount=0;var destRoot=this._rootNode._cloneNative(animationNodeLocalPositions,animationNodeLocalRotations,animationNodeLocalScales,animationNodeWorldMatrixs,animationNodeParentIndices,-1,this);var transform=this._rootNode.transform;var destTransform=destRoot.transform;var destPosition=destTransform.localPosition;var destRotation=destTransform.localRotation;var destScale=destTransform.localScale;transform.localPosition.cloneTo(destPosition);transform.localRotation.cloneTo(destRotation);transform.localScale.cloneTo(destScale);destTransform.localPosition=destPosition;destTransform.localRotation=destRotation;destTransform.localScale=destScale;destAnimator._avatarNodeMap={};this._initCloneToAnimator(destRoot,destAnimator);};return Avatar;}(Laya.Resource);Avatar.AVATAR="AVATAR";var Material=/*#__PURE__*/function(_Laya$Resource3){_inheritsLoose(Material,_Laya$Resource3);function Material(){var _this21;_this21=_Laya$Resource3.call(this)||this;_this21._shaderValues=null;_this21._shaderValues=new ShaderData(_assertThisInitialized(_this21));_this21.renderQueue=Material.RENDERQUEUE_OPAQUE;_this21._alphaTest=false;return _this21;}Material.load=function load(url,complete){Laya.Laya.loader.create(url,complete,null,Material.MATERIAL);};Material.__initDefine__=function __initDefine__(){Material.SHADERDEFINE_ALPHATEST=Shader3D.getDefineByName("ALPHATEST");};Material._parse=function _parse(data,propertyParams,constructParams){var jsonData=data;var props=jsonData.props;var material;var classType=props.type;var clas=Laya.ClassUtils.getRegClass(classType);if(clas)material=new clas();else throw '_getSprite3DHierarchyInnerUrls 错误: '+data.type+' 不是类';switch(jsonData.version){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":var i,n;for(var key in props){switch(key){case"type":break;case"vectors":var vectors=props[key];for(i=0,n=vectors.length;i<n;i++){var vector=vectors[i];var vectorValue=vector.value;switch(vectorValue.length){case 2:material[vector.name]=new Vector2(vectorValue[0],vectorValue[1]);break;case 3:material[vector.name]=new Vector3(vectorValue[0],vectorValue[1],vectorValue[2]);break;case 4:material[vector.name]=new Vector4(vectorValue[0],vectorValue[1],vectorValue[2],vectorValue[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.");}}break;case"textures":var textures=props[key];for(i=0,n=textures.length;i<n;i++){var texture=textures[i];var path=texture.path;path&&(material[texture.name]=Laya.Loader.getRes(path));}break;case"defines":var defineNames=props[key];for(i=0,n=defineNames.length;i<n;i++){var define=Shader3D.getDefineByName(defineNames[i]);material._shaderValues.addDefine(define);}break;case"renderStates":var renderStatesData=props[key];var renderStateData=renderStatesData[0];var mat=material;mat.blend=renderStateData.blend;mat.cull=renderStateData.cull;mat.depthTest=renderStateData.depthTest;mat.depthWrite=renderStateData.depthWrite;mat.blendSrc=renderStateData.srcBlend;mat.blendDst=renderStateData.dstBlend;break;case"cull":material.cull=props[key];break;case"blend":material.blend=props[key];break;case"depthWrite":material.depthWrite=props[key];break;case"srcBlend":material.blendSrc=props[key];break;case"dstBlend":material.blendDst=props[key];break;default:material[key]=props[key];}}break;default:throw new Error("BaseMaterial:unkonwn version.");}return material;};var _proto52=Material.prototype;_proto52._removeTetxureReference=function _removeTetxureReference(){var data=this._shaderValues.getData();for(var k in data){var value=data[k];if(value&&value instanceof Laya.BaseTexture)value._removeReference();}};_proto52._disposeResource=function _disposeResource(){if(this._referenceCount>0)this._removeTetxureReference();this._shaderValues=null;};_proto52._addReference=function _addReference(count){if(count===void 0){count=1;}_Laya$Resource3.prototype._addReference.call(this,count);var data=this._shaderValues.getData();for(var k in data){var value=data[k];if(value&&value instanceof Laya.BaseTexture)value._addReference();}};_proto52._removeReference=function _removeReference(count){if(count===void 0){count=1;}_Laya$Resource3.prototype._removeReference.call(this,count);this._removeTetxureReference();};_proto52.setShaderName=function setShaderName(name){this._shader=Shader3D.find(name);if(!this._shader)throw new Error("BaseMaterial: unknown shader name.");};_proto52.cloneTo=function cloneTo(destObject){var destBaseMaterial=destObject;destBaseMaterial.name=this.name;destBaseMaterial.renderQueue=this.renderQueue;this._shaderValues.cloneTo(destBaseMaterial._shaderValues);};_proto52.clone=function clone(){var dest=new Material();this.cloneTo(dest);return dest;};_createClass(Material,[{key:"shaderData",get:function get(){return this._shaderValues;}},{key:"alphaTestValue",get:function get(){return this._shaderValues.getNumber(Material.ALPHATESTVALUE);},set:function set(value){this._shaderValues.setNumber(Material.ALPHATESTVALUE,value);}},{key:"alphaTest",get:function get(){return this._alphaTest;},set:function set(value){this._alphaTest=value;if(value)this._shaderValues.addDefine(Material.SHADERDEFINE_ALPHATEST);else this._shaderValues.removeDefine(Material.SHADERDEFINE_ALPHATEST);}},{key:"_defineDatas",get:function get(){return this._shaderValues._defineDatas;}}]);return Material;}(Laya.Resource);Material.MATERIAL="MATERIAL";Material.RENDERQUEUE_OPAQUE=2000;Material.RENDERQUEUE_ALPHATEST=2450;Material.RENDERQUEUE_TRANSPARENT=3000;Material.ALPHATESTVALUE=Shader3D.propertyNameToID("u_AlphaTestValue");Material.SHADERDEFINE_ALPHATEST=null;var BaseMaterial=/*#__PURE__*/function(){function BaseMaterial(){}BaseMaterial.load=function load(url,complete){Laya.Laya.loader.create(url,complete,null,Material.MATERIAL);};BaseMaterial.__initDefine__=function __initDefine__(){BaseMaterial.SHADERDEFINE_ALPHATEST=Material.SHADERDEFINE_ALPHATEST;};return BaseMaterial;}();BaseMaterial.MATERIAL="MATERIAL";BaseMaterial.RENDERQUEUE_OPAQUE=2000;BaseMaterial.RENDERQUEUE_ALPHATEST=2450;BaseMaterial.RENDERQUEUE_TRANSPARENT=3000;BaseMaterial.ALPHATESTVALUE=Shader3D.propertyNameToID("u_AlphaTestValue");BaseMaterial.SHADERDEFINE_ALPHATEST=null;var RenderState=/*#__PURE__*/function(){function RenderState(){this.cull=RenderState.CULL_BACK;this.blend=RenderState.BLEND_DISABLE;this.srcBlend=RenderState.BLENDPARAM_ONE;this.dstBlend=RenderState.BLENDPARAM_ZERO;this.srcBlendRGB=RenderState.BLENDPARAM_ONE;this.dstBlendRGB=RenderState.BLENDPARAM_ZERO;this.srcBlendAlpha=RenderState.BLENDPARAM_ONE;this.dstBlendAlpha=RenderState.BLENDPARAM_ZERO;this.blendConstColor=new Vector4(1,1,1,1);this.blendEquation=RenderState.BLENDEQUATION_ADD;this.blendEquationRGB=RenderState.BLENDEQUATION_ADD;this.blendEquationAlpha=RenderState.BLENDEQUATION_ADD;this.depthTest=RenderState.DEPTHTEST_LEQUAL;this.depthWrite=true;}var _proto53=RenderState.prototype;_proto53.cloneTo=function cloneTo(dest){var destState=dest;destState.cull=this.cull;destState.blend=this.blend;destState.srcBlend=this.srcBlend;destState.dstBlend=this.dstBlend;destState.srcBlendRGB=this.srcBlendRGB;destState.dstBlendRGB=this.dstBlendRGB;destState.srcBlendAlpha=this.srcBlendAlpha;destState.dstBlendAlpha=this.dstBlendAlpha;this.blendConstColor.cloneTo(destState.blendConstColor);destState.blendEquation=this.blendEquation;destState.blendEquationRGB=this.blendEquationRGB;destState.blendEquationAlpha=this.blendEquationAlpha;destState.depthTest=this.depthTest;destState.depthWrite=this.depthWrite;};_proto53.clone=function clone(){var dest=new RenderState();this.cloneTo(dest);return dest;};return RenderState;}();RenderState.CULL_NONE=0;RenderState.CULL_FRONT=1;RenderState.CULL_BACK=2;RenderState.BLEND_DISABLE=0;RenderState.BLEND_ENABLE_ALL=1;RenderState.BLEND_ENABLE_SEPERATE=2;RenderState.BLENDPARAM_ZERO=0;RenderState.BLENDPARAM_ONE=1;RenderState.BLENDPARAM_SRC_COLOR=0x0300;RenderState.BLENDPARAM_ONE_MINUS_SRC_COLOR=0x0301;RenderState.BLENDPARAM_DST_COLOR=0x0306;RenderState.BLENDPARAM_ONE_MINUS_DST_COLOR=0x0307;RenderState.BLENDPARAM_SRC_ALPHA=0x0302;RenderState.BLENDPARAM_ONE_MINUS_SRC_ALPHA=0x0303;RenderState.BLENDPARAM_DST_ALPHA=0x0304;RenderState.BLENDPARAM_ONE_MINUS_DST_ALPHA=0x0305;RenderState.BLENDPARAM_SRC_ALPHA_SATURATE=0x0308;RenderState.BLENDEQUATION_ADD=0x8006;RenderState.BLENDEQUATION_SUBTRACT=0x800A;RenderState.BLENDEQUATION_REVERSE_SUBTRACT=0x800B;RenderState.DEPTHTEST_OFF=0;RenderState.DEPTHTEST_NEVER=0x0200;RenderState.DEPTHTEST_LESS=0x0201;RenderState.DEPTHTEST_EQUAL=0x0202;RenderState.DEPTHTEST_LEQUAL=0x0203;RenderState.DEPTHTEST_GREATER=0x0204;RenderState.DEPTHTEST_NOTEQUAL=0x0205;RenderState.DEPTHTEST_GEQUAL=0x0206;RenderState.DEPTHTEST_ALWAYS=0x0207;var BlinnPhongMaterial=/*#__PURE__*/function(_Material){_inheritsLoose(BlinnPhongMaterial,_Material);function BlinnPhongMaterial(){var _this22;_this22=_Material.call(this)||this;_this22._enableVertexColor=false;_this22.setShaderName("BLINNPHONG");_this22._albedoIntensity=1.0;_this22._albedoColor=new Vector4(1.0,1.0,1.0,1.0);var sv=_this22._shaderValues;sv.setVector(BlinnPhongMaterial.ALBEDOCOLOR,new Vector4(1.0,1.0,1.0,1.0));sv.setVector(BlinnPhongMaterial.MATERIALSPECULAR,new Vector4(1.0,1.0,1.0,1.0));sv.setNumber(BlinnPhongMaterial.SHININESS,0.078125);sv.setNumber(Material.ALPHATESTVALUE,0.5);sv.setVector(BlinnPhongMaterial.TILINGOFFSET,new Vector4(1.0,1.0,0.0,0.0));_this22._enableLighting=true;_this22.renderMode=BlinnPhongMaterial.RENDERMODE_OPAQUE;return _this22;}BlinnPhongMaterial.__initDefine__=function __initDefine__(){BlinnPhongMaterial.SHADERDEFINE_DIFFUSEMAP=Shader3D.getDefineByName("DIFFUSEMAP");BlinnPhongMaterial.SHADERDEFINE_NORMALMAP=Shader3D.getDefineByName("NORMALMAP");BlinnPhongMaterial.SHADERDEFINE_SPECULARMAP=Shader3D.getDefineByName("SPECULARMAP");BlinnPhongMaterial.SHADERDEFINE_TILINGOFFSET=Shader3D.getDefineByName("TILINGOFFSET");BlinnPhongMaterial.SHADERDEFINE_ENABLEVERTEXCOLOR=Shader3D.getDefineByName("ENABLEVERTEXCOLOR");};var _proto54=BlinnPhongMaterial.prototype;_proto54.clone=function clone(){var dest=new BlinnPhongMaterial();this.cloneTo(dest);return dest;};_proto54.cloneTo=function cloneTo(destObject){_Material.prototype.cloneTo.call(this,destObject);var destMaterial=destObject;destMaterial._enableLighting=this._enableLighting;destMaterial._albedoIntensity=this._albedoIntensity;destMaterial._enableVertexColor=this._enableVertexColor;this._albedoColor.cloneTo(destMaterial._albedoColor);};_createClass(BlinnPhongMaterial,[{key:"_ColorR",get:function get(){return this._albedoColor.x;},set:function set(value){this._albedoColor.x=value;this.albedoColor=this._albedoColor;}},{key:"_ColorG",get:function get(){return this._albedoColor.y;},set:function set(value){this._albedoColor.y=value;this.albedoColor=this._albedoColor;}},{key:"_ColorB",get:function get(){return this._albedoColor.z;},set:function set(value){this._albedoColor.z=value;this.albedoColor=this._albedoColor;}},{key:"_ColorA",get:function get(){return this._albedoColor.w;},set:function set(value){this._albedoColor.w=value;this.albedoColor=this._albedoColor;}},{key:"_Color",get:function get(){return this._shaderValues.getVector(BlinnPhongMaterial.ALBEDOCOLOR);},set:function set(value){this.albedoColor=value;}},{key:"_SpecColorR",get:function get(){return this._shaderValues.getVector(BlinnPhongMaterial.MATERIALSPECULAR).x;},set:function set(value){this._shaderValues.getVector(BlinnPhongMaterial.MATERIALSPECULAR).x=value;}},{key:"_SpecColorG",get:function get(){return this._shaderValues.getVector(BlinnPhongMaterial.MATERIALSPECULAR).y;},set:function set(value){this._shaderValues.getVector(BlinnPhongMaterial.MATERIALSPECULAR).y=value;}},{key:"_SpecColorB",get:function get(){return this._shaderValues.getVector(BlinnPhongMaterial.MATERIALSPECULAR).z;},set:function set(value){this._shaderValues.getVector(BlinnPhongMaterial.MATERIALSPECULAR).z=value;}},{key:"_SpecColorA",get:function get(){return this._shaderValues.getVector(BlinnPhongMaterial.MATERIALSPECULAR).w;},set:function set(value){this._shaderValues.getVector(BlinnPhongMaterial.MATERIALSPECULAR).w=value;}},{key:"_SpecColor",get:function get(){return this._shaderValues.getVector(BlinnPhongMaterial.MATERIALSPECULAR);},set:function set(value){this.specularColor=value;}},{key:"_AlbedoIntensity",get:function get(){return this._albedoIntensity;},set:function set(value){if(this._albedoIntensity!==value){var finalAlbedo=this._shaderValues.getVector(BlinnPhongMaterial.ALBEDOCOLOR);Vector4.scale(this._albedoColor,value,finalAlbedo);this._albedoIntensity=value;this._shaderValues.setVector(BlinnPhongMaterial.ALBEDOCOLOR,finalAlbedo);}}},{key:"_Shininess",get:function get(){return this._shaderValues.getNumber(BlinnPhongMaterial.SHININESS);},set:function set(value){value=Math.max(0.0,Math.min(1.0,value));this._shaderValues.setNumber(BlinnPhongMaterial.SHININESS,value);}},{key:"_MainTex_STX",get:function get(){return this._shaderValues.getVector(BlinnPhongMaterial.TILINGOFFSET).x;},set:function set(x){var tilOff=this._shaderValues.getVector(BlinnPhongMaterial.TILINGOFFSET);tilOff.x=x;this.tilingOffset=tilOff;}},{key:"_MainTex_STY",get:function get(){return this._shaderValues.getVector(BlinnPhongMaterial.TILINGOFFSET).y;},set:function set(y){var tilOff=this._shaderValues.getVector(BlinnPhongMaterial.TILINGOFFSET);tilOff.y=y;this.tilingOffset=tilOff;}},{key:"_MainTex_STZ",get:function get(){return this._shaderValues.getVector(BlinnPhongMaterial.TILINGOFFSET).z;},set:function set(z){var tilOff=this._shaderValues.getVector(BlinnPhongMaterial.TILINGOFFSET);tilOff.z=z;this.tilingOffset=tilOff;}},{key:"_MainTex_STW",get:function get(){return this._shaderValues.getVector(BlinnPhongMaterial.TILINGOFFSET).w;},set:function set(w){var tilOff=this._shaderValues.getVector(BlinnPhongMaterial.TILINGOFFSET);tilOff.w=w;this.tilingOffset=tilOff;}},{key:"_MainTex_ST",get:function get(){return this._shaderValues.getVector(BlinnPhongMaterial.TILINGOFFSET);},set:function set(value){this.tilingOffset=value;}},{key:"_Cutoff",get:function get(){return this.alphaTestValue;},set:function set(value){this.alphaTestValue=value;}},{key:"renderMode",set:function set(value){switch(value){case BlinnPhongMaterial.RENDERMODE_OPAQUE:this.alphaTest=false;this.renderQueue=Material.RENDERQUEUE_OPAQUE;this.depthWrite=true;this.cull=RenderState.CULL_BACK;this.blend=RenderState.BLEND_DISABLE;this.depthTest=RenderState.DEPTHTEST_LESS;break;case BlinnPhongMaterial.RENDERMODE_CUTOUT:this.renderQueue=Material.RENDERQUEUE_ALPHATEST;this.alphaTest=true;this.depthWrite=true;this.cull=RenderState.CULL_BACK;this.blend=RenderState.BLEND_DISABLE;this.depthTest=RenderState.DEPTHTEST_LESS;break;case BlinnPhongMaterial.RENDERMODE_TRANSPARENT:this.renderQueue=Material.RENDERQUEUE_TRANSPARENT;this.alphaTest=false;this.depthWrite=false;this.cull=RenderState.CULL_BACK;this.blend=RenderState.BLEND_ENABLE_ALL;this.blendSrc=RenderState.BLENDPARAM_SRC_ALPHA;this.blendDst=RenderState.BLENDPARAM_ONE_MINUS_SRC_ALPHA;this.depthTest=RenderState.DEPTHTEST_LESS;break;default:throw new Error("Material:renderMode value error.");}}},{key:"enableVertexColor",get:function get(){return this._enableVertexColor;},set:function set(value){this._enableVertexColor=value;if(value)this._shaderValues.addDefine(BlinnPhongMaterial.SHADERDEFINE_ENABLEVERTEXCOLOR);else this._shaderValues.removeDefine(BlinnPhongMaterial.SHADERDEFINE_ENABLEVERTEXCOLOR);}},{key:"tilingOffsetX",get:function get(){return this._MainTex_STX;},set:function set(x){this._MainTex_STX=x;}},{key:"tilingOffsetY",get:function get(){return this._MainTex_STY;},set:function set(y){this._MainTex_STY=y;}},{key:"tilingOffsetZ",get:function get(){return this._MainTex_STZ;},set:function set(z){this._MainTex_STZ=z;}},{key:"tilingOffsetW",get:function get(){return this._MainTex_STW;},set:function set(w){this._MainTex_STW=w;}},{key:"tilingOffset",get:function get(){return this._shaderValues.getVector(BlinnPhongMaterial.TILINGOFFSET);},set:function set(value){if(value){if(value.x!=1||value.y!=1||value.z!=0||value.w!=0)this._shaderValues.addDefine(BlinnPhongMaterial.SHADERDEFINE_TILINGOFFSET);else this._shaderValues.removeDefine(BlinnPhongMaterial.SHADERDEFINE_TILINGOFFSET);}else {this._shaderValues.removeDefine(BlinnPhongMaterial.SHADERDEFINE_TILINGOFFSET);}this._shaderValues.setVector(BlinnPhongMaterial.TILINGOFFSET,value);}},{key:"albedoColorR",get:function get(){return this._ColorR;},set:function set(value){this._ColorR=value;}},{key:"albedoColorG",get:function get(){return this._ColorG;},set:function set(value){this._ColorG=value;}},{key:"albedoColorB",get:function get(){return this._ColorB;},set:function set(value){this._ColorB=value;}},{key:"albedoColorA",get:function get(){return this._ColorA;},set:function set(value){this._ColorA=value;}},{key:"albedoColor",get:function get(){return this._albedoColor;},set:function set(value){var finalAlbedo=this._shaderValues.getVector(BlinnPhongMaterial.ALBEDOCOLOR);Vector4.scale(value,this._albedoIntensity,finalAlbedo);this._albedoColor=value;this._shaderValues.setVector(BlinnPhongMaterial.ALBEDOCOLOR,finalAlbedo);}},{key:"albedoIntensity",get:function get(){return this._albedoIntensity;},set:function set(value){this._AlbedoIntensity=value;}},{key:"specularColorR",get:function get(){return this._SpecColorR;},set:function set(value){this._SpecColorR=value;}},{key:"specularColorG",get:function get(){return this._SpecColorG;},set:function set(value){this._SpecColorG=value;}},{key:"specularColorB",get:function get(){return this._SpecColorB;},set:function set(value){this._SpecColorB=value;}},{key:"specularColorA",get:function get(){return this._SpecColorA;},set:function set(value){this._SpecColorA=value;}},{key:"specularColor",get:function get(){return this._shaderValues.getVector(BlinnPhongMaterial.MATERIALSPECULAR);},set:function set(value){this._shaderValues.setVector(BlinnPhongMaterial.MATERIALSPECULAR,value);}},{key:"shininess",get:function get(){return this._Shininess;},set:function set(value){this._Shininess=value;}},{key:"albedoTexture",get:function get(){return this._shaderValues.getTexture(BlinnPhongMaterial.ALBEDOTEXTURE);},set:function set(value){if(value)this._shaderValues.addDefine(BlinnPhongMaterial.SHADERDEFINE_DIFFUSEMAP);else this._shaderValues.removeDefine(BlinnPhongMaterial.SHADERDEFINE_DIFFUSEMAP);this._shaderValues.setTexture(BlinnPhongMaterial.ALBEDOTEXTURE,value);}},{key:"normalTexture",get:function get(){return this._shaderValues.getTexture(BlinnPhongMaterial.NORMALTEXTURE);},set:function set(value){if(value)this._shaderValues.addDefine(BlinnPhongMaterial.SHADERDEFINE_NORMALMAP);else this._shaderValues.removeDefine(BlinnPhongMaterial.SHADERDEFINE_NORMALMAP);this._shaderValues.setTexture(BlinnPhongMaterial.NORMALTEXTURE,value);}},{key:"specularTexture",get:function get(){return this._shaderValues.getTexture(BlinnPhongMaterial.SPECULARTEXTURE);},set:function set(value){if(value)this._shaderValues.addDefine(BlinnPhongMaterial.SHADERDEFINE_SPECULARMAP);else this._shaderValues.removeDefine(BlinnPhongMaterial.SHADERDEFINE_SPECULARMAP);this._shaderValues.setTexture(BlinnPhongMaterial.SPECULARTEXTURE,value);}},{key:"depthWrite",get:function get(){return this._shaderValues.getBool(BlinnPhongMaterial.DEPTH_WRITE);},set:function set(value){this._shaderValues.setBool(BlinnPhongMaterial.DEPTH_WRITE,value);}},{key:"cull",get:function get(){return this._shaderValues.getInt(BlinnPhongMaterial.CULL);},set:function set(value){this._shaderValues.setInt(BlinnPhongMaterial.CULL,value);}},{key:"blend",get:function get(){return this._shaderValues.getInt(BlinnPhongMaterial.BLEND);},set:function set(value){this._shaderValues.setInt(BlinnPhongMaterial.BLEND,value);}},{key:"blendSrc",get:function get(){return this._shaderValues.getInt(BlinnPhongMaterial.BLEND_SRC);},set:function set(value){this._shaderValues.setInt(BlinnPhongMaterial.BLEND_SRC,value);}},{key:"blendDst",get:function get(){return this._shaderValues.getInt(BlinnPhongMaterial.BLEND_DST);},set:function set(value){this._shaderValues.setInt(BlinnPhongMaterial.BLEND_DST,value);}},{key:"depthTest",get:function get(){return this._shaderValues.getInt(BlinnPhongMaterial.DEPTH_TEST);},set:function set(value){this._shaderValues.setInt(BlinnPhongMaterial.DEPTH_TEST,value);}}]);return BlinnPhongMaterial;}(Material);BlinnPhongMaterial.RENDERMODE_OPAQUE=0;BlinnPhongMaterial.RENDERMODE_CUTOUT=1;BlinnPhongMaterial.RENDERMODE_TRANSPARENT=2;BlinnPhongMaterial.ALBEDOTEXTURE=Shader3D.propertyNameToID("u_DiffuseTexture");BlinnPhongMaterial.NORMALTEXTURE=Shader3D.propertyNameToID("u_NormalTexture");BlinnPhongMaterial.SPECULARTEXTURE=Shader3D.propertyNameToID("u_SpecularTexture");BlinnPhongMaterial.ALBEDOCOLOR=Shader3D.propertyNameToID("u_DiffuseColor");BlinnPhongMaterial.MATERIALSPECULAR=Shader3D.propertyNameToID("u_MaterialSpecular");BlinnPhongMaterial.SHININESS=Shader3D.propertyNameToID("u_Shininess");BlinnPhongMaterial.TILINGOFFSET=Shader3D.propertyNameToID("u_TilingOffset");BlinnPhongMaterial.CULL=Shader3D.propertyNameToID("s_Cull");BlinnPhongMaterial.BLEND=Shader3D.propertyNameToID("s_Blend");BlinnPhongMaterial.BLEND_SRC=Shader3D.propertyNameToID("s_BlendSrc");BlinnPhongMaterial.BLEND_DST=Shader3D.propertyNameToID("s_BlendDst");BlinnPhongMaterial.DEPTH_TEST=Shader3D.propertyNameToID("s_DepthTest");BlinnPhongMaterial.DEPTH_WRITE=Shader3D.propertyNameToID("s_DepthWrite");var EffectMaterial=/*#__PURE__*/function(_Material2){_inheritsLoose(EffectMaterial,_Material2);function EffectMaterial(){var _this23;_this23=_Material2.call(this)||this;_this23.setShaderName("Effect");_this23._color=new Vector4(1.0,1.0,1.0,1.0);_this23._shaderValues.setVector(EffectMaterial.TINTCOLOR,new Vector4(1.0,1.0,1.0,1.0));_this23.renderMode=EffectMaterial.RENDERMODE_ADDTIVE;return _this23;}EffectMaterial.__initDefine__=function __initDefine__(){EffectMaterial.SHADERDEFINE_MAINTEXTURE=Shader3D.getDefineByName("MAINTEXTURE");EffectMaterial.SHADERDEFINE_TILINGOFFSET=Shader3D.getDefineByName("TILINGOFFSET");EffectMaterial.SHADERDEFINE_ADDTIVEFOG=Shader3D.getDefineByName("ADDTIVEFOG");};var _proto55=EffectMaterial.prototype;_proto55.clone=function clone(){var dest=new EffectMaterial();this.cloneTo(dest);return dest;};_createClass(EffectMaterial,[{key:"_TintColorR",get:function get(){return this._color.x;},set:function set(value){this._color.x=value;this.color=this._color;}},{key:"_TintColorG",get:function get(){return this._color.y;},set:function set(value){this._color.y=value;this.color=this._color;}},{key:"_TintColorB",get:function get(){return this._color.z;},set:function set(value){this._color.z=value;this.color=this._color;}},{key:"_TintColorA",get:function get(){return this._color.w;},set:function set(value){this._color.w=value;this.color=this._color;}},{key:"_TintColor",get:function get(){return this._shaderValues.getVector(EffectMaterial.TINTCOLOR);},set:function set(value){this.color=value;}},{key:"_MainTex_STX",get:function get(){return this._shaderValues.getVector(EffectMaterial.TILINGOFFSET).x;},set:function set(x){var tilOff=this._shaderValues.getVector(EffectMaterial.TILINGOFFSET);tilOff.x=x;this.tilingOffset=tilOff;}},{key:"_MainTex_STY",get:function get(){return this._shaderValues.getVector(EffectMaterial.TILINGOFFSET).y;},set:function set(y){var tilOff=this._shaderValues.getVector(EffectMaterial.TILINGOFFSET);tilOff.y=y;this.tilingOffset=tilOff;}},{key:"_MainTex_STZ",get:function get(){return this._shaderValues.getVector(EffectMaterial.TILINGOFFSET).z;},set:function set(z){var tilOff=this._shaderValues.getVector(EffectMaterial.TILINGOFFSET);tilOff.z=z;this.tilingOffset=tilOff;}},{key:"_MainTex_STW",get:function get(){return this._shaderValues.getVector(EffectMaterial.TILINGOFFSET).w;},set:function set(w){var tilOff=this._shaderValues.getVector(EffectMaterial.TILINGOFFSET);tilOff.w=w;this.tilingOffset=tilOff;}},{key:"_MainTex_ST",get:function get(){return this._shaderValues.getVector(EffectMaterial.TILINGOFFSET);},set:function set(value){this.tilingOffset=value;}},{key:"renderMode",set:function set(value){switch(value){case EffectMaterial.RENDERMODE_ADDTIVE:this.renderQueue=Material.RENDERQUEUE_TRANSPARENT;this.alphaTest=false;this.depthWrite=false;this.cull=RenderState.CULL_NONE;this.blend=RenderState.BLEND_ENABLE_ALL;this.blendSrc=RenderState.BLENDPARAM_SRC_ALPHA;this.blendDst=RenderState.BLENDPARAM_ONE;this.depthTest=RenderState.DEPTHTEST_LESS;this._shaderValues.addDefine(EffectMaterial.SHADERDEFINE_ADDTIVEFOG);break;case EffectMaterial.RENDERMODE_ALPHABLENDED:this.renderQueue=Material.RENDERQUEUE_TRANSPARENT;this.alphaTest=false;this.depthWrite=false;this.cull=RenderState.CULL_NONE;this.blend=RenderState.BLEND_ENABLE_ALL;this.blendSrc=RenderState.BLENDPARAM_SRC_ALPHA;this.blendDst=RenderState.BLENDPARAM_ONE_MINUS_SRC_ALPHA;this.depthTest=RenderState.DEPTHTEST_LESS;this._shaderValues.removeDefine(EffectMaterial.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("MeshEffectMaterial : renderMode value error.");}}},{key:"colorR",get:function get(){return this._TintColorR;},set:function set(value){this._TintColorR=value;}},{key:"colorG",get:function get(){return this._TintColorG;},set:function set(value){this._TintColorG=value;}},{key:"colorB",get:function get(){return this._TintColorB;},set:function set(value){this._TintColorB=value;}},{key:"colorA",get:function get(){return this._TintColorA;},set:function set(value){this._TintColorA=value;}},{key:"color",get:function get(){return this._shaderValues.getVector(EffectMaterial.TINTCOLOR);},set:function set(value){this._shaderValues.setVector(EffectMaterial.TINTCOLOR,value);}},{key:"texture",get:function get(){return this._shaderValues.getTexture(EffectMaterial.MAINTEXTURE);},set:function set(value){if(value)this._shaderValues.addDefine(EffectMaterial.SHADERDEFINE_MAINTEXTURE);else this._shaderValues.removeDefine(EffectMaterial.SHADERDEFINE_MAINTEXTURE);this._shaderValues.setTexture(EffectMaterial.MAINTEXTURE,value);}},{key:"tilingOffsetX",get:function get(){return this._MainTex_STX;},set:function set(x){this._MainTex_STX=x;}},{key:"tilingOffsetY",get:function get(){return this._MainTex_STY;},set:function set(y){this._MainTex_STY=y;}},{key:"tilingOffsetZ",get:function get(){return this._MainTex_STZ;},set:function set(z){this._MainTex_STZ=z;}},{key:"tilingOffsetW",get:function get(){return this._MainTex_STW;},set:function set(w){this._MainTex_STW=w;}},{key:"tilingOffset",get:function get(){return this._shaderValues.getVector(EffectMaterial.TILINGOFFSET);},set:function set(value){if(value){if(value.x!=1||value.y!=1||value.z!=0||value.w!=0)this._shaderValues.addDefine(EffectMaterial.SHADERDEFINE_TILINGOFFSET);else this._shaderValues.removeDefine(EffectMaterial.SHADERDEFINE_TILINGOFFSET);}else {this._shaderValues.removeDefine(EffectMaterial.SHADERDEFINE_TILINGOFFSET);}this._shaderValues.setVector(EffectMaterial.TILINGOFFSET,value);}},{key:"depthWrite",get:function get(){return this._shaderValues.getBool(EffectMaterial.DEPTH_WRITE);},set:function set(value){this._shaderValues.setBool(EffectMaterial.DEPTH_WRITE,value);}},{key:"cull",get:function get(){return this._shaderValues.getInt(EffectMaterial.CULL);},set:function set(value){this._shaderValues.setInt(EffectMaterial.CULL,value);}},{key:"blend",get:function get(){return this._shaderValues.getInt(EffectMaterial.BLEND);},set:function set(value){this._shaderValues.setInt(EffectMaterial.BLEND,value);}},{key:"blendSrc",get:function get(){return this._shaderValues.getInt(EffectMaterial.BLEND_SRC);},set:function set(value){this._shaderValues.setInt(EffectMaterial.BLEND_SRC,value);}},{key:"blendDst",get:function get(){return this._shaderValues.getInt(EffectMaterial.BLEND_DST);},set:function set(value){this._shaderValues.setInt(EffectMaterial.BLEND_DST,value);}},{key:"depthTest",get:function get(){return this._shaderValues.getInt(EffectMaterial.DEPTH_TEST);},set:function set(value){this._shaderValues.setInt(EffectMaterial.DEPTH_TEST,value);}}]);return EffectMaterial;}(Material);EffectMaterial.RENDERMODE_ADDTIVE=0;EffectMaterial.RENDERMODE_ALPHABLENDED=1;EffectMaterial.MAINTEXTURE=Shader3D.propertyNameToID("u_AlbedoTexture");EffectMaterial.TINTCOLOR=Shader3D.propertyNameToID("u_AlbedoColor");EffectMaterial.TILINGOFFSET=Shader3D.propertyNameToID("u_TilingOffset");EffectMaterial.CULL=Shader3D.propertyNameToID("s_Cull");EffectMaterial.BLEND=Shader3D.propertyNameToID("s_Blend");EffectMaterial.BLEND_SRC=Shader3D.propertyNameToID("s_BlendSrc");EffectMaterial.BLEND_DST=Shader3D.propertyNameToID("s_BlendDst");EffectMaterial.DEPTH_TEST=Shader3D.propertyNameToID("s_DepthTest");EffectMaterial.DEPTH_WRITE=Shader3D.propertyNameToID("s_DepthWrite");var ExtendTerrainMaterial=/*#__PURE__*/function(_Material3){_inheritsLoose(ExtendTerrainMaterial,_Material3);function ExtendTerrainMaterial(){var _this24;_this24=_Material3.call(this)||this;_this24._enableLighting=true;_this24.setShaderName("ExtendTerrain");_this24.renderMode=ExtendTerrainMaterial.RENDERMODE_OPAQUE;return _this24;}ExtendTerrainMaterial.__initDefine__=function __initDefine__(){ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1=Shader3D.getDefineByName("ExtendTerrain_DETAIL_NUM1");ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2=Shader3D.getDefineByName("ExtendTerrain_DETAIL_NUM2");ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3=Shader3D.getDefineByName("ExtendTerrain_DETAIL_NUM3");ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4=Shader3D.getDefineByName("ExtendTerrain_DETAIL_NUM4");ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5=Shader3D.getDefineByName("ExtendTerrain_DETAIL_NUM5");};var _proto56=ExtendTerrainMaterial.prototype;_proto56._setDetailNum=function _setDetailNum(value){switch(value){case 1:this._shaderValues.addDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);break;case 2:this._shaderValues.addDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);break;case 3:this._shaderValues.addDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);break;case 4:this._shaderValues.addDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);break;case 5:this._shaderValues.addDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3);this._shaderValues.removeDefine(ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4);break;}};_proto56.clone=function clone(){var dest=new ExtendTerrainMaterial();this.cloneTo(dest);return dest;};_createClass(ExtendTerrainMaterial,[{key:"splatAlphaTexture",get:function get(){return this._shaderValues.getTexture(ExtendTerrainMaterial.SPLATALPHATEXTURE);},set:function set(value){this._shaderValues.setTexture(ExtendTerrainMaterial.SPLATALPHATEXTURE,value);}},{key:"diffuseTexture1",get:function get(){return this._shaderValues.getTexture(ExtendTerrainMaterial.DIFFUSETEXTURE1);},set:function set(value){this._shaderValues.setTexture(ExtendTerrainMaterial.DIFFUSETEXTURE1,value);this._setDetailNum(1);}},{key:"diffuseTexture2",get:function get(){return this._shaderValues.getTexture(ExtendTerrainMaterial.DIFFUSETEXTURE2);},set:function set(value){this._shaderValues.setTexture(ExtendTerrainMaterial.DIFFUSETEXTURE2,value);this._setDetailNum(2);}},{key:"diffuseTexture3",get:function get(){return this._shaderValues.getTexture(ExtendTerrainMaterial.DIFFUSETEXTURE3);},set:function set(value){this._shaderValues.setTexture(ExtendTerrainMaterial.DIFFUSETEXTURE3,value);this._setDetailNum(3);}},{key:"diffuseTexture4",get:function get(){return this._shaderValues.getTexture(ExtendTerrainMaterial.DIFFUSETEXTURE4);},set:function set(value){this._shaderValues.setTexture(ExtendTerrainMaterial.DIFFUSETEXTURE4,value);this._setDetailNum(4);}},{key:"diffuseTexture5",get:function get(){return this._shaderValues.getTexture(ExtendTerrainMaterial.DIFFUSETEXTURE5);},set:function set(value){this._shaderValues.setTexture(ExtendTerrainMaterial.DIFFUSETEXTURE5,value);this._setDetailNum(5);}},{key:"diffuseScaleOffset1",set:function set(scaleOffset1){this._shaderValues.setVector(ExtendTerrainMaterial.DIFFUSESCALEOFFSET1,scaleOffset1);}},{key:"diffuseScaleOffset2",set:function set(scaleOffset2){this._shaderValues.setVector(ExtendTerrainMaterial.DIFFUSESCALEOFFSET2,scaleOffset2);}},{key:"diffuseScaleOffset3",set:function set(scaleOffset3){this._shaderValues.setVector(ExtendTerrainMaterial.DIFFUSESCALEOFFSET3,scaleOffset3);}},{key:"diffuseScaleOffset4",set:function set(scaleOffset4){this._shaderValues.setVector(ExtendTerrainMaterial.DIFFUSESCALEOFFSET4,scaleOffset4);}},{key:"diffuseScaleOffset5",set:function set(scaleOffset5){this._shaderValues.setVector(ExtendTerrainMaterial.DIFFUSESCALEOFFSET5,scaleOffset5);}},{key:"renderMode",set:function set(value){switch(value){case ExtendTerrainMaterial.RENDERMODE_OPAQUE:this.renderQueue=Material.RENDERQUEUE_OPAQUE;this.depthWrite=true;this.cull=RenderState.CULL_BACK;this.blend=RenderState.BLEND_DISABLE;this.depthTest=RenderState.DEPTHTEST_LESS;break;case ExtendTerrainMaterial.RENDERMODE_TRANSPARENT:this.renderQueue=Material.RENDERQUEUE_OPAQUE;this.depthWrite=false;this.cull=RenderState.CULL_BACK;this.blend=RenderState.BLEND_ENABLE_ALL;this.blendSrc=RenderState.BLENDPARAM_SRC_ALPHA;this.blendDst=RenderState.BLENDPARAM_ONE_MINUS_SRC_ALPHA;this.depthTest=RenderState.DEPTHTEST_LEQUAL;break;default:throw new Error("ExtendTerrainMaterial:renderMode value error.");}}},{key:"depthWrite",get:function get(){return this._shaderValues.getBool(ExtendTerrainMaterial.DEPTH_WRITE);},set:function set(value){this._shaderValues.setBool(ExtendTerrainMaterial.DEPTH_WRITE,value);}},{key:"cull",get:function get(){return this._shaderValues.getInt(ExtendTerrainMaterial.CULL);},set:function set(value){this._shaderValues.setInt(ExtendTerrainMaterial.CULL,value);}},{key:"blend",get:function get(){return this._shaderValues.getInt(ExtendTerrainMaterial.BLEND);},set:function set(value){this._shaderValues.setInt(ExtendTerrainMaterial.BLEND,value);}},{key:"blendSrc",get:function get(){return this._shaderValues.getInt(ExtendTerrainMaterial.BLEND_SRC);},set:function set(value){this._shaderValues.setInt(ExtendTerrainMaterial.BLEND_SRC,value);}},{key:"blendDst",get:function get(){return this._shaderValues.getInt(ExtendTerrainMaterial.BLEND_DST);},set:function set(value){this._shaderValues.setInt(ExtendTerrainMaterial.BLEND_DST,value);}},{key:"depthTest",get:function get(){return this._shaderValues.getInt(ExtendTerrainMaterial.DEPTH_TEST);},set:function set(value){this._shaderValues.setInt(ExtendTerrainMaterial.DEPTH_TEST,value);}}]);return ExtendTerrainMaterial;}(Material);ExtendTerrainMaterial.RENDERMODE_OPAQUE=1;ExtendTerrainMaterial.RENDERMODE_TRANSPARENT=2;ExtendTerrainMaterial.SPLATALPHATEXTURE=Shader3D.propertyNameToID("u_SplatAlphaTexture");ExtendTerrainMaterial.DIFFUSETEXTURE1=Shader3D.propertyNameToID("u_DiffuseTexture1");ExtendTerrainMaterial.DIFFUSETEXTURE2=Shader3D.propertyNameToID("u_DiffuseTexture2");ExtendTerrainMaterial.DIFFUSETEXTURE3=Shader3D.propertyNameToID("u_DiffuseTexture3");ExtendTerrainMaterial.DIFFUSETEXTURE4=Shader3D.propertyNameToID("u_DiffuseTexture4");ExtendTerrainMaterial.DIFFUSETEXTURE5=Shader3D.propertyNameToID("u_DiffuseTexture5");ExtendTerrainMaterial.DIFFUSESCALEOFFSET1=Shader3D.propertyNameToID("u_DiffuseScaleOffset1");ExtendTerrainMaterial.DIFFUSESCALEOFFSET2=Shader3D.propertyNameToID("u_DiffuseScaleOffset2");ExtendTerrainMaterial.DIFFUSESCALEOFFSET3=Shader3D.propertyNameToID("u_DiffuseScaleOffset3");ExtendTerrainMaterial.DIFFUSESCALEOFFSET4=Shader3D.propertyNameToID("u_DiffuseScaleOffset4");ExtendTerrainMaterial.DIFFUSESCALEOFFSET5=Shader3D.propertyNameToID("u_DiffuseScaleOffset5");ExtendTerrainMaterial.CULL=Shader3D.propertyNameToID("s_Cull");ExtendTerrainMaterial.BLEND=Shader3D.propertyNameToID("s_Blend");ExtendTerrainMaterial.BLEND_SRC=Shader3D.propertyNameToID("s_BlendSrc");ExtendTerrainMaterial.BLEND_DST=Shader3D.propertyNameToID("s_BlendDst");ExtendTerrainMaterial.DEPTH_TEST=Shader3D.propertyNameToID("s_DepthTest");ExtendTerrainMaterial.DEPTH_WRITE=Shader3D.propertyNameToID("s_DepthWrite");(function(PBRRenderMode){PBRRenderMode[PBRRenderMode["Opaque"]=0]="Opaque";PBRRenderMode[PBRRenderMode["Cutout"]=1]="Cutout";PBRRenderMode[PBRRenderMode["Fade"]=2]="Fade";PBRRenderMode[PBRRenderMode["Transparent"]=3]="Transparent";})(exports.PBRRenderMode||(exports.PBRRenderMode={}));var PBRMaterial=/*#__PURE__*/function(_Material4){_inheritsLoose(PBRMaterial,_Material4);function PBRMaterial(){var _this25;_this25=_Material4.call(this)||this;_this25._enableEmission=false;_this25._shaderValues.setVector(PBRMaterial.ALBEDOCOLOR,new Vector4(1.0,1.0,1.0,1.0));_this25._shaderValues.setVector(PBRMaterial.EMISSIONCOLOR,new Vector4(1.0,1.0,1.0,1.0));_this25._shaderValues.setNumber(PBRMaterial.SMOOTHNESS,0.5);_this25._shaderValues.setNumber(PBRMaterial.SMOOTHNESSSCALE,1.0);_this25._shaderValues.setNumber(PBRMaterial.OCCLUSIONSTRENGTH,1.0);_this25._shaderValues.setNumber(PBRMaterial.NORMALSCALE,1.0);_this25._shaderValues.setNumber(PBRMaterial.PARALLAXSCALE,0.001);_this25._shaderValues.setNumber(Material.ALPHATESTVALUE,0.5);_this25.renderMode=exports.PBRRenderMode.Opaque;return _this25;}PBRMaterial.__init__=function __init__(){PBRMaterial.SHADERDEFINE_ALBEDOTEXTURE=Shader3D.getDefineByName("ALBEDOTEXTURE");PBRMaterial.SHADERDEFINE_NORMALTEXTURE=Shader3D.getDefineByName("NORMALTEXTURE");PBRMaterial.SHADERDEFINE_PARALLAXTEXTURE=Shader3D.getDefineByName("PARALLAXTEXTURE");PBRMaterial.SHADERDEFINE_OCCLUSIONTEXTURE=Shader3D.getDefineByName("OCCLUSIONTEXTURE");PBRMaterial.SHADERDEFINE_EMISSION=Shader3D.getDefineByName("EMISSION");PBRMaterial.SHADERDEFINE_EMISSIONTEXTURE=Shader3D.getDefineByName("EMISSIONTEXTURE");PBRMaterial.SHADERDEFINE_TILINGOFFSET=Shader3D.getDefineByName("TILINGOFFSET");PBRMaterial.SHADERDEFINE_TRANSPARENTBLEND=Shader3D.getDefineByName("TRANSPARENTBLEND");PBRMaterial.SHADERDEFINE_LAYA_PBR_BRDF_HIGH=Shader3D.getDefineByName("LAYA_PBR_BRDF_HIGH");PBRMaterial.SHADERDEFINE_LAYA_PBR_BRDF_LOW=Shader3D.getDefineByName("LAYA_PBR_BRDF_LOW");};_createClass(PBRMaterial,[{key:"albedoColor",get:function get(){return this._shaderValues.getVector(PBRMaterial.ALBEDOCOLOR);},set:function set(value){this._shaderValues.setVector(PBRMaterial.ALBEDOCOLOR,value);}},{key:"albedoTexture",get:function get(){return this._shaderValues.getTexture(PBRMaterial.ALBEDOTEXTURE);},set:function set(value){if(value)this._shaderValues.addDefine(PBRMaterial.SHADERDEFINE_ALBEDOTEXTURE);else this._shaderValues.removeDefine(PBRMaterial.SHADERDEFINE_ALBEDOTEXTURE);this._shaderValues.setTexture(PBRMaterial.ALBEDOTEXTURE,value);}},{key:"normalTexture",get:function get(){return this._shaderValues.getTexture(PBRMaterial.NORMALTEXTURE);},set:function set(value){if(value){this._shaderValues.addDefine(PBRMaterial.SHADERDEFINE_NORMALTEXTURE);}else {this._shaderValues.removeDefine(PBRMaterial.SHADERDEFINE_NORMALTEXTURE);}this._shaderValues.setTexture(PBRMaterial.NORMALTEXTURE,value);}},{key:"normalTextureScale",get:function get(){return this._shaderValues.getNumber(PBRMaterial.NORMALSCALE);},set:function set(value){this._shaderValues.setNumber(PBRMaterial.NORMALSCALE,value);}},{key:"parallaxTexture",get:function get(){return this._shaderValues.getTexture(PBRMaterial.PARALLAXTEXTURE);},set:function set(value){if(value)this._shaderValues.addDefine(PBRMaterial.SHADERDEFINE_PARALLAXTEXTURE);else this._shaderValues.removeDefine(PBRMaterial.SHADERDEFINE_PARALLAXTEXTURE);this._shaderValues.setTexture(PBRMaterial.PARALLAXTEXTURE,value);}},{key:"parallaxTextureScale",get:function get(){return this._shaderValues.getNumber(PBRMaterial.PARALLAXSCALE);},set:function set(value){this._shaderValues.setNumber(PBRMaterial.PARALLAXSCALE,Math.max(0.005,Math.min(0.08,value)));}},{key:"occlusionTexture",get:function get(){return this._shaderValues.getTexture(PBRMaterial.OCCLUSIONTEXTURE);},set:function set(value){if(value)this._shaderValues.addDefine(PBRMaterial.SHADERDEFINE_OCCLUSIONTEXTURE);else this._shaderValues.removeDefine(PBRMaterial.SHADERDEFINE_OCCLUSIONTEXTURE);this._shaderValues.setTexture(PBRMaterial.OCCLUSIONTEXTURE,value);}},{key:"occlusionTextureStrength",get:function get(){return this._shaderValues.getNumber(PBRMaterial.OCCLUSIONSTRENGTH);},set:function set(value){this._shaderValues.setNumber(PBRMaterial.OCCLUSIONSTRENGTH,Math.max(0.0,Math.min(1.0,value)));}},{key:"smoothness",get:function get(){return this._shaderValues.getNumber(PBRMaterial.SMOOTHNESS);},set:function set(value){this._shaderValues.setNumber(PBRMaterial.SMOOTHNESS,Math.max(0.0,Math.min(1.0,value)));}},{key:"smoothnessTextureScale",get:function get(){return this._shaderValues.getNumber(PBRMaterial.SMOOTHNESSSCALE);},set:function set(value){this._shaderValues.setNumber(PBRMaterial.SMOOTHNESSSCALE,Math.max(0.0,Math.min(1.0,value)));}},{key:"enableEmission",get:function get(){return this._enableEmission;},set:function set(value){if(value)this._shaderValues.addDefine(PBRMaterial.SHADERDEFINE_EMISSION);else this._shaderValues.removeDefine(PBRMaterial.SHADERDEFINE_EMISSION);this._enableEmission=value;}},{key:"emissionColor",get:function get(){return this._shaderValues.getVector(PBRMaterial.EMISSIONCOLOR);},set:function set(value){this._shaderValues.setVector(PBRMaterial.EMISSIONCOLOR,value);}},{key:"emissionTexture",get:function get(){return this._shaderValues.getTexture(PBRMaterial.EMISSIONTEXTURE);},set:function set(value){if(value)this._shaderValues.addDefine(PBRMaterial.SHADERDEFINE_EMISSIONTEXTURE);else this._shaderValues.removeDefine(PBRMaterial.SHADERDEFINE_EMISSIONTEXTURE);this._shaderValues.setTexture(PBRMaterial.EMISSIONTEXTURE,value);}},{key:"tilingOffset",get:function get(){return this._shaderValues.getVector(PBRMaterial.TILINGOFFSET);},set:function set(value){if(value){if(value.x!=1||value.y!=1||value.z!=0||value.w!=0)this._shaderValues.addDefine(PBRMaterial.SHADERDEFINE_TILINGOFFSET);else this._shaderValues.removeDefine(PBRMaterial.SHADERDEFINE_TILINGOFFSET);}else {this._shaderValues.removeDefine(PBRMaterial.SHADERDEFINE_TILINGOFFSET);}this._shaderValues.setVector(PBRMaterial.TILINGOFFSET,value);}},{key:"depthWrite",get:function get(){return this._shaderValues.getBool(PBRMaterial.DEPTH_WRITE);},set:function set(value){this._shaderValues.setBool(PBRMaterial.DEPTH_WRITE,value);}},{key:"cull",get:function get(){return this._shaderValues.getInt(PBRMaterial.CULL);},set:function set(value){this._shaderValues.setInt(PBRMaterial.CULL,value);}},{key:"blend",get:function get(){return this._shaderValues.getInt(PBRMaterial.BLEND);},set:function set(value){this._shaderValues.setInt(PBRMaterial.BLEND,value);}},{key:"blendSrc",get:function get(){return this._shaderValues.getInt(PBRMaterial.BLEND_SRC);},set:function set(value){this._shaderValues.setInt(PBRMaterial.BLEND_SRC,value);}},{key:"blendDst",get:function get(){return this._shaderValues.getInt(PBRMaterial.BLEND_DST);},set:function set(value){this._shaderValues.setInt(PBRMaterial.BLEND_DST,value);}},{key:"depthTest",get:function get(){return this._shaderValues.getInt(PBRMaterial.DEPTH_TEST);},set:function set(value){this._shaderValues.setInt(PBRMaterial.DEPTH_TEST,value);}},{key:"renderMode",set:function set(value){switch(value){case exports.PBRRenderMode.Opaque:this.alphaTest=false;this.renderQueue=Material.RENDERQUEUE_OPAQUE;this.depthWrite=true;this.cull=RenderState.CULL_BACK;this.blend=RenderState.BLEND_DISABLE;this.depthTest=RenderState.DEPTHTEST_LESS;this._shaderValues.removeDefine(PBRMaterial.SHADERDEFINE_TRANSPARENTBLEND);break;case exports.PBRRenderMode.Cutout:this.renderQueue=Material.RENDERQUEUE_ALPHATEST;this.alphaTest=true;this.depthWrite=true;this.cull=RenderState.CULL_BACK;this.blend=RenderState.BLEND_DISABLE;this.depthTest=RenderState.DEPTHTEST_LESS;this._shaderValues.removeDefine(PBRMaterial.SHADERDEFINE_TRANSPARENTBLEND);break;case exports.PBRRenderMode.Fade:this.renderQueue=Material.RENDERQUEUE_TRANSPARENT;this.alphaTest=false;this.depthWrite=false;this.cull=RenderState.CULL_BACK;this.blend=RenderState.BLEND_ENABLE_ALL;this.blendSrc=RenderState.BLENDPARAM_SRC_ALPHA;this.blendDst=RenderState.BLENDPARAM_ONE_MINUS_SRC_ALPHA;this.depthTest=RenderState.DEPTHTEST_LESS;this._shaderValues.removeDefine(PBRMaterial.SHADERDEFINE_TRANSPARENTBLEND);break;case exports.PBRRenderMode.Transparent:this.renderQueue=Material.RENDERQUEUE_TRANSPARENT;this.alphaTest=false;this.depthWrite=false;this.cull=RenderState.CULL_BACK;this.blend=RenderState.BLEND_ENABLE_ALL;this.blendSrc=RenderState.BLENDPARAM_ONE;this.blendDst=RenderState.BLENDPARAM_ONE_MINUS_SRC_ALPHA;this.depthTest=RenderState.DEPTHTEST_LESS;this._shaderValues.addDefine(PBRMaterial.SHADERDEFINE_TRANSPARENTBLEND);break;default:throw new Error("PBRMaterial:unknown renderMode value.");}}},{key:"enableReflection",get:function get(){return true;},set:function set(value){}}]);return PBRMaterial;}(Material);PBRMaterial.ALBEDOTEXTURE=Shader3D.propertyNameToID("u_AlbedoTexture");PBRMaterial.ALBEDOCOLOR=Shader3D.propertyNameToID("u_AlbedoColor");PBRMaterial.TILINGOFFSET=Shader3D.propertyNameToID("u_TilingOffset");PBRMaterial.NORMALTEXTURE=Shader3D.propertyNameToID("u_NormalTexture");PBRMaterial.NORMALSCALE=Shader3D.propertyNameToID("u_NormalScale");PBRMaterial.SMOOTHNESS=Shader3D.propertyNameToID("u_Smoothness");PBRMaterial.SMOOTHNESSSCALE=Shader3D.propertyNameToID("u_SmoothnessScale");PBRMaterial.OCCLUSIONTEXTURE=Shader3D.propertyNameToID("u_OcclusionTexture");PBRMaterial.OCCLUSIONSTRENGTH=Shader3D.propertyNameToID("u_occlusionStrength");PBRMaterial.PARALLAXTEXTURE=Shader3D.propertyNameToID("u_ParallaxTexture");PBRMaterial.PARALLAXSCALE=Shader3D.propertyNameToID("u_ParallaxScale");PBRMaterial.EMISSIONTEXTURE=Shader3D.propertyNameToID("u_EmissionTexture");PBRMaterial.EMISSIONCOLOR=Shader3D.propertyNameToID("u_EmissionColor");PBRMaterial.CULL=Shader3D.propertyNameToID("s_Cull");PBRMaterial.BLEND=Shader3D.propertyNameToID("s_Blend");PBRMaterial.BLEND_SRC=Shader3D.propertyNameToID("s_BlendSrc");PBRMaterial.BLEND_DST=Shader3D.propertyNameToID("s_BlendDst");PBRMaterial.DEPTH_TEST=Shader3D.propertyNameToID("s_DepthTest");PBRMaterial.DEPTH_WRITE=Shader3D.propertyNameToID("s_DepthWrite");PBRMaterial.renderQuality=exports.PBRRenderQuality.High;var PBRPS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n\tprecision highp int;\n#else\n\tprecision mediump float;\n\tprecision mediump int;\n#endif\n\n#define SETUP_BRDF_INPUT specularSetup\n\n#include \"Lighting.glsl\";\n#include \"PBRFSInput.glsl\";\n#include \"LayaPBRBRDF.glsl\";\n#include \"GlobalIllumination.glsl\";\n#include \"Shadow.glsl\"\n#include \"PBRCore.glsl\";\n\nvoid main()\n{\n\tfragmentForward();\n}";var PBRVS="#include \"PBRVSInput.glsl\";\n#include \"Lighting.glsl\";\n#include \"PBRVertex.glsl\";\n\nvoid main()\n{\n\tvertexForward();\n\tgl_Position=remapGLPositionZ(gl_Position);\n}";var PBRShadowCasterPS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n\tprecision highp int;\n#else\n\tprecision mediump float;\n\tprecision mediump int;\n#endif\n\n#include \"ShadowCasterFS.glsl\"\n\nvoid main()\n{\n\tgl_FragColor=shadowCasterFragment();\n}";var PBRShadowCasterVS="#include \"ShadowCasterVS.glsl\"\n\nvoid main()\n{\n\tvec4 positionCS =  shadowCasterVertex();\n\tgl_Position=remapGLPositionZ(positionCS);\n}";var ShaderVariable=function ShaderVariable(){this.textureID=-1;};var ShaderInstance=/*#__PURE__*/function(_Laya$Resource4){_inheritsLoose(ShaderInstance,_Laya$Resource4);function ShaderInstance(vs,ps,attributeMap,uniformMap,shaderPass){var _this26;_this26=_Laya$Resource4.call(this)||this;_this26._stateParamsMap=[];_this26._uploadMark=-1;_this26._uploadRenderType=-1;_this26._vs=vs;_this26._ps=ps;_this26._attributeMap=attributeMap;_this26._uniformMap=uniformMap;_this26._shaderPass=shaderPass;_this26._create();_this26.lock=true;return _this26;}var _proto57=ShaderInstance.prototype;_proto57._create=function _create(){var gl=Laya.LayaGL.instance;this._program=gl.createProgram();this._vshader=this._createShader(gl,this._vs,gl.VERTEX_SHADER);this._pshader=this._createShader(gl,this._ps,gl.FRAGMENT_SHADER);gl.attachShader(this._program,this._vshader);gl.attachShader(this._program,this._pshader);for(var k in this._attributeMap){gl.bindAttribLocation(this._program,this._attributeMap[k],k);}gl.linkProgram(this._program);if(!Laya.Render.isConchApp&&Shader3D.debugMode&&!gl.getProgramParameter(this._program,gl.LINK_STATUS))throw gl.getProgramInfoLog(this._program);var sceneParms=[];var cameraParms=[];var spriteParms=[];var materialParms=[];var customParms=[];this._customUniformParamsMap=[];var nUniformNum=gl.getProgramParameter(this._program,gl.ACTIVE_UNIFORMS);Laya.WebGLContext.useProgram(gl,this._program);this._curActTexIndex=0;var one,i,n;for(i=0;i<nUniformNum;i++){var uniformData=gl.getActiveUniform(this._program,i);var uniName=uniformData.name;one=new ShaderVariable();one.location=gl.getUniformLocation(this._program,uniName);if(uniName.indexOf('[0]')>0){one.name=uniName=uniName.substr(0,uniName.length-3);one.isArray=true;}else {one.name=uniName;one.isArray=false;}one.type=uniformData.type;this._addShaderUnifiormFun(one);var uniformPeriod=this._uniformMap[uniName];if(uniformPeriod!=null){one.dataOffset=Shader3D.propertyNameToID(uniName);switch(uniformPeriod){case Shader3D.PERIOD_CUSTOM:customParms.push(one);break;case Shader3D.PERIOD_MATERIAL:materialParms.push(one);break;case Shader3D.PERIOD_SPRITE:spriteParms.push(one);break;case Shader3D.PERIOD_CAMERA:cameraParms.push(one);break;case Shader3D.PERIOD_SCENE:sceneParms.push(one);break;default:throw new Error("Shader3D: period is unkonw.");}}}this._sceneUniformParamsMap=Laya.LayaGL.instance.createCommandEncoder(sceneParms.length*4*5+4,64,true);for(i=0,n=sceneParms.length;i<n;i++){this._sceneUniformParamsMap.addShaderUniform(sceneParms[i]);}this._cameraUniformParamsMap=Laya.LayaGL.instance.createCommandEncoder(cameraParms.length*4*5+4,64,true);for(i=0,n=cameraParms.length;i<n;i++){this._cameraUniformParamsMap.addShaderUniform(cameraParms[i]);}this._spriteUniformParamsMap=Laya.LayaGL.instance.createCommandEncoder(spriteParms.length*4*5+4,64,true);for(i=0,n=spriteParms.length;i<n;i++){this._spriteUniformParamsMap.addShaderUniform(spriteParms[i]);}this._materialUniformParamsMap=Laya.LayaGL.instance.createCommandEncoder(materialParms.length*4*5+4,64,true);for(i=0,n=materialParms.length;i<n;i++){this._materialUniformParamsMap.addShaderUniform(materialParms[i]);}this._customUniformParamsMap.length=customParms.length;for(i=0,n=customParms.length;i<n;i++){var custom=customParms[i];this._customUniformParamsMap[custom.dataOffset]=custom;}var stateMap=this._shaderPass._stateMap;for(var s in stateMap){this._stateParamsMap[stateMap[s]]=Shader3D.propertyNameToID(s);}};_proto57._getRenderState=function _getRenderState(shaderDatas,stateIndex){var stateID=this._stateParamsMap[stateIndex];if(stateID==null)return null;else return shaderDatas[stateID];};_proto57._disposeResource=function _disposeResource(){Laya.LayaGL.instance.deleteShader(this._vshader);Laya.LayaGL.instance.deleteShader(this._pshader);Laya.LayaGL.instance.deleteProgram(this._program);this._vshader=this._pshader=this._program=null;this._setGPUMemory(0);this._curActTexIndex=0;};_proto57._addShaderUnifiormFun=function _addShaderUnifiormFun(one){var gl=Laya.LayaGL.instance;one.caller=this;var isArray=one.isArray;switch(one.type){case gl.BOOL:one.fun=this._uniform1i;one.uploadedValue=new Array(1);break;case gl.INT:one.fun=isArray?this._uniform1iv:this._uniform1i;one.uploadedValue=new Array(1);break;case gl.FLOAT:one.fun=isArray?this._uniform1fv:this._uniform1f;one.uploadedValue=new Array(1);break;case gl.FLOAT_VEC2:one.fun=isArray?this._uniform_vec2v:this._uniform_vec2;one.uploadedValue=new Array(2);break;case gl.FLOAT_VEC3:one.fun=isArray?this._uniform_vec3v:this._uniform_vec3;one.uploadedValue=new Array(3);break;case gl.FLOAT_VEC4:one.fun=isArray?this._uniform_vec4v:this._uniform_vec4;one.uploadedValue=new Array(4);break;case gl.FLOAT_MAT2:one.fun=this._uniformMatrix2fv;break;case gl.FLOAT_MAT3:one.fun=this._uniformMatrix3fv;break;case gl.FLOAT_MAT4:one.fun=isArray?this._uniformMatrix4fv:this._uniformMatrix4f;break;case gl.SAMPLER_2D:case gl.SAMPLER_2D_SHADOW:gl.uniform1i(one.location,this._curActTexIndex);one.textureID=Laya.WebGLContext._glTextureIDs[this._curActTexIndex++];one.fun=this._uniform_sampler2D;break;case 0x8b5f:gl.uniform1i(one.location,this._curActTexIndex);one.textureID=Laya.WebGLContext._glTextureIDs[this._curActTexIndex++];one.fun=this._uniform_sampler3D;break;case gl.SAMPLER_CUBE:gl.uniform1i(one.location,this._curActTexIndex);one.textureID=Laya.WebGLContext._glTextureIDs[this._curActTexIndex++];one.fun=this._uniform_samplerCube;break;default:throw new Error("compile shader err!");}};_proto57._createShader=function _createShader(gl,str,type){var shader=gl.createShader(type);gl.shaderSource(shader,str);gl.compileShader(shader);if(Shader3D.debugMode&&!gl.getShaderParameter(shader,gl.COMPILE_STATUS))throw gl.getShaderInfoLog(shader);return shader;};_proto57._uniform1f=function _uniform1f(one,value){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value){Laya.LayaGL.instance.uniform1f(one.location,uploadedValue[0]=value);return 1;}return 0;};_proto57._uniform1fv=function _uniform1fv(one,value){if(value.length<4){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value[0]||uploadedValue[1]!==value[1]||uploadedValue[2]!==value[2]||uploadedValue[3]!==value[3]){Laya.LayaGL.instance.uniform1fv(one.location,value);uploadedValue[0]=value[0];uploadedValue[1]=value[1];uploadedValue[2]=value[2];uploadedValue[3]=value[3];return 1;}return 0;}else {Laya.LayaGL.instance.uniform1fv(one.location,value);return 1;}};_proto57._uniform_vec2=function _uniform_vec2(one,v){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==v.x||uploadedValue[1]!==v.y){Laya.LayaGL.instance.uniform2f(one.location,uploadedValue[0]=v.x,uploadedValue[1]=v.y);return 1;}return 0;};_proto57._uniform_vec2v=function _uniform_vec2v(one,value){if(value.length<2){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value[0]||uploadedValue[1]!==value[1]||uploadedValue[2]!==value[2]||uploadedValue[3]!==value[3]){Laya.LayaGL.instance.uniform2fv(one.location,value);uploadedValue[0]=value[0];uploadedValue[1]=value[1];uploadedValue[2]=value[2];uploadedValue[3]=value[3];return 1;}return 0;}else {Laya.LayaGL.instance.uniform2fv(one.location,value);return 1;}};_proto57._uniform_vec3=function _uniform_vec3(one,v){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==v.x||uploadedValue[1]!==v.y||uploadedValue[2]!==v.z){Laya.LayaGL.instance.uniform3f(one.location,uploadedValue[0]=v.x,uploadedValue[1]=v.y,uploadedValue[2]=v.z);return 1;}return 0;};_proto57._uniform_vec3v=function _uniform_vec3v(one,v){Laya.LayaGL.instance.uniform3fv(one.location,v);return 1;};_proto57._uniform_vec4=function _uniform_vec4(one,v){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==v.x||uploadedValue[1]!==v.y||uploadedValue[2]!==v.z||uploadedValue[3]!==v.w){Laya.LayaGL.instance.uniform4f(one.location,uploadedValue[0]=v.x,uploadedValue[1]=v.y,uploadedValue[2]=v.z,uploadedValue[3]=v.w);return 1;}return 0;};_proto57._uniform_vec4v=function _uniform_vec4v(one,v){Laya.LayaGL.instance.uniform4fv(one.location,v);return 1;};_proto57._uniformMatrix2fv=function _uniformMatrix2fv(one,value){Laya.LayaGL.instance.uniformMatrix2fv(one.location,false,value);return 1;};_proto57._uniformMatrix3fv=function _uniformMatrix3fv(one,value){Laya.LayaGL.instance.uniformMatrix3fv(one.location,false,value);return 1;};_proto57._uniformMatrix4f=function _uniformMatrix4f(one,m){var value=m.elements;Laya.LayaGL.instance.uniformMatrix4fv(one.location,false,value);return 1;};_proto57._uniformMatrix4fv=function _uniformMatrix4fv(one,m){Laya.LayaGL.instance.uniformMatrix4fv(one.location,false,m);return 1;};_proto57._uniform1i=function _uniform1i(one,value){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value){Laya.LayaGL.instance.uniform1i(one.location,uploadedValue[0]=value);return 1;}return 0;};_proto57._uniform1iv=function _uniform1iv(one,value){Laya.LayaGL.instance.uniform1iv(one.location,value);return 1;};_proto57._uniform_ivec2=function _uniform_ivec2(one,value){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value[0]||uploadedValue[1]!==value[1]){Laya.LayaGL.instance.uniform2i(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1]);return 1;}return 0;};_proto57._uniform_ivec2v=function _uniform_ivec2v(one,value){Laya.LayaGL.instance.uniform2iv(one.location,value);return 1;};_proto57._uniform_vec3i=function _uniform_vec3i(one,value){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value[0]||uploadedValue[1]!==value[1]||uploadedValue[2]!==value[2]){Laya.LayaGL.instance.uniform3i(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2]);return 1;}return 0;};_proto57._uniform_vec3vi=function _uniform_vec3vi(one,value){Laya.LayaGL.instance.uniform3iv(one.location,value);return 1;};_proto57._uniform_vec4i=function _uniform_vec4i(one,value){var uploadedValue=one.uploadedValue;if(uploadedValue[0]!==value[0]||uploadedValue[1]!==value[1]||uploadedValue[2]!==value[2]||uploadedValue[3]!==value[3]){Laya.LayaGL.instance.uniform4i(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2],uploadedValue[3]=value[3]);return 1;}return 0;};_proto57._uniform_vec4vi=function _uniform_vec4vi(one,value){Laya.LayaGL.instance.uniform4iv(one.location,value);return 1;};_proto57._uniform_sampler2D=function _uniform_sampler2D(one,texture){var value=texture._getSource()||texture.defaulteTexture._getSource();var gl=Laya.LayaGL.instance;Laya.WebGLContext.activeTexture(gl,one.textureID);Laya.WebGLContext.bindTexture(gl,gl.TEXTURE_2D,value);return 0;};_proto57._uniform_sampler3D=function _uniform_sampler3D(one,texture){var value=texture._getSource()||texture.defaulteTexture._getSource();var gl=Laya.LayaGL.instance;Laya.WebGLContext.activeTexture(gl,one.textureID);Laya.WebGLContext.bindTexture(gl,WebGL2RenderingContext.TEXTURE_3D,value);return 0;};_proto57._uniform_samplerCube=function _uniform_samplerCube(one,texture){var value=texture._getSource()||texture.defaulteTexture._getSource();var gl=Laya.LayaGL.instance;Laya.WebGLContext.activeTexture(gl,one.textureID);Laya.WebGLContext.bindTexture(gl,gl.TEXTURE_CUBE_MAP,value);return 0;};_proto57.bind=function bind(){return Laya.WebGLContext.useProgram(Laya.LayaGL.instance,this._program);};_proto57.uploadUniforms=function uploadUniforms(shaderUniform,shaderDatas,uploadUnTexture){Laya.Stat.shaderCall+=Laya.LayaGLRunner.uploadShaderUniforms(Laya.LayaGL.instance,shaderUniform,shaderDatas,uploadUnTexture);};_proto57.uploadRenderStateBlendDepth=function uploadRenderStateBlendDepth(shaderDatas){var gl=Laya.LayaGL.instance;var renderState=this._shaderPass.renderState;var datas=shaderDatas.getData();var depthWrite=this._getRenderState(datas,Shader3D.RENDER_STATE_DEPTH_WRITE);var depthTest=this._getRenderState(datas,Shader3D.RENDER_STATE_DEPTH_TEST);var blend=this._getRenderState(datas,Shader3D.RENDER_STATE_BLEND);depthWrite==null&&(depthWrite=renderState.depthWrite);depthTest==null&&(depthTest=renderState.depthTest);blend==null&&(blend=renderState.blend);Laya.WebGLContext.setDepthMask(gl,depthWrite);if(depthTest===RenderState.DEPTHTEST_OFF)Laya.WebGLContext.setDepthTest(gl,false);else {Laya.WebGLContext.setDepthTest(gl,true);Laya.WebGLContext.setDepthFunc(gl,depthTest);}switch(blend){case RenderState.BLEND_DISABLE:Laya.WebGLContext.setBlend(gl,false);break;case RenderState.BLEND_ENABLE_ALL:var blendEquation=this._getRenderState(datas,Shader3D.RENDER_STATE_BLEND_EQUATION);var srcBlend=this._getRenderState(datas,Shader3D.RENDER_STATE_BLEND_SRC);var dstBlend=this._getRenderState(datas,Shader3D.RENDER_STATE_BLEND_DST);blendEquation==null&&(blendEquation=renderState.blendEquation);srcBlend==null&&(srcBlend=renderState.srcBlend);dstBlend==null&&(dstBlend=renderState.dstBlend);Laya.WebGLContext.setBlend(gl,true);Laya.WebGLContext.setBlendEquation(gl,blendEquation);Laya.WebGLContext.setBlendFunc(gl,srcBlend,dstBlend);break;case RenderState.BLEND_ENABLE_SEPERATE:var blendEquationRGB=this._getRenderState(datas,Shader3D.RENDER_STATE_BLEND_EQUATION_RGB);var blendEquationAlpha=this._getRenderState(datas,Shader3D.RENDER_STATE_BLEND_EQUATION_ALPHA);var srcRGB=this._getRenderState(datas,Shader3D.RENDER_STATE_BLEND_SRC_RGB);var dstRGB=this._getRenderState(datas,Shader3D.RENDER_STATE_BLEND_DST_RGB);var srcAlpha=this._getRenderState(datas,Shader3D.RENDER_STATE_BLEND_SRC_ALPHA);var dstAlpha=this._getRenderState(datas,Shader3D.RENDER_STATE_BLEND_DST_ALPHA);blendEquationRGB==null&&(blendEquationRGB=renderState.blendEquationRGB);blendEquationAlpha==null&&(blendEquationAlpha=renderState.blendEquationAlpha);srcRGB==null&&(srcRGB=renderState.srcBlendRGB);dstRGB==null&&(dstRGB=renderState.dstBlendRGB);srcAlpha==null&&(srcAlpha=renderState.srcBlendAlpha);dstAlpha==null&&(dstAlpha=renderState.dstBlendAlpha);Laya.WebGLContext.setBlend(gl,true);Laya.WebGLContext.setBlendEquationSeparate(gl,blendEquationRGB,blendEquationAlpha);Laya.WebGLContext.setBlendFuncSeperate(gl,srcRGB,dstRGB,srcAlpha,dstAlpha);break;}};_proto57.uploadRenderStateFrontFace=function uploadRenderStateFrontFace(shaderDatas,isTarget,invertFront){var gl=Laya.LayaGL.instance;var renderState=this._shaderPass.renderState;var datas=shaderDatas.getData();var cull=this._getRenderState(datas,Shader3D.RENDER_STATE_CULL);cull==null&&(cull=renderState.cull);var forntFace;switch(cull){case RenderState.CULL_NONE:Laya.WebGLContext.setCullFace(gl,false);break;case RenderState.CULL_FRONT:Laya.WebGLContext.setCullFace(gl,true);if(isTarget){if(invertFront)forntFace=gl.CCW;else forntFace=gl.CW;}else {if(invertFront)forntFace=gl.CW;else forntFace=gl.CCW;}Laya.WebGLContext.setFrontFace(gl,forntFace);break;case RenderState.CULL_BACK:Laya.WebGLContext.setCullFace(gl,true);if(isTarget){if(invertFront)forntFace=gl.CW;else forntFace=gl.CCW;}else {if(invertFront)forntFace=gl.CCW;else forntFace=gl.CW;}Laya.WebGLContext.setFrontFace(gl,forntFace);break;}};_proto57.uploadCustomUniform=function uploadCustomUniform(index,data){Laya.Stat.shaderCall+=Laya.LayaGLRunner.uploadCustomUniform(Laya.LayaGL.instance,this._customUniformParamsMap,index,data);};_proto57._uniformMatrix2fvForNative=function _uniformMatrix2fvForNative(one,value){Laya.LayaGL.instance.uniformMatrix2fvEx(one.location,false,value);return 1;};_proto57._uniformMatrix3fvForNative=function _uniformMatrix3fvForNative(one,value){Laya.LayaGL.instance.uniformMatrix3fvEx(one.location,false,value);return 1;};_proto57._uniformMatrix4fvForNative=function _uniformMatrix4fvForNative(one,m){Laya.LayaGL.instance.uniformMatrix4fvEx(one.location,false,m);return 1;};return ShaderInstance;}(Laya.Resource);var SimpleSingletonList=/*#__PURE__*/function(_SingletonList2){_inheritsLoose(SimpleSingletonList,_SingletonList2);function SimpleSingletonList(){return _SingletonList2.call(this)||this;}var _proto58=SimpleSingletonList.prototype;_proto58.add=function add(element){var index=element._getIndexInList();if(index!==-1)throw "SimpleSingletonList:"+element+" has  in  SingletonList.";this._add(element);element._setIndexInList(this.length++);};_proto58.remove=function remove(element){var index=element._getIndexInList();this.length--;if(index!==this.length){var end=this.elements[this.length];this.elements[index]=end;end._setIndexInList(index);}element._setIndexInList(-1);};_proto58.clear=function clear(){var elements=this.elements;for(var i=0,n=this.length;i<n;i++){elements[i]._setIndexInList(-1);}this.length=0;};return SimpleSingletonList;}(SingletonList);var Color=/*#__PURE__*/function(){function Color(r,g,b,a){if(r===void 0){r=1;}if(g===void 0){g=1;}if(b===void 0){b=1;}if(a===void 0){a=1;}this.r=r;this.g=g;this.b=b;this.a=a;}Color.gammaToLinearSpace=function gammaToLinearSpace(value){if(value<=0.04045)return value/12.92;else if(value<1.0)return Math.pow((value+0.055)/1.055,2.4);else return Math.pow(value,2.4);};Color.linearToGammaSpace=function linearToGammaSpace(value){if(value<=0.0)return 0.0;else if(value<=0.0031308)return 12.92*value;else if(value<=1.0)return 1.055*Math.pow(value,0.41666)-0.055;else return Math.pow(value,0.41666);};var _proto59=Color.prototype;_proto59.toLinear=function toLinear(out){out.r=Color.gammaToLinearSpace(this.r);out.g=Color.gammaToLinearSpace(this.g);out.b=Color.gammaToLinearSpace(this.b);};_proto59.toGamma=function toGamma(out){out.r=Color.linearToGammaSpace(this.r);out.g=Color.linearToGammaSpace(this.g);out.b=Color.linearToGammaSpace(this.b);};_proto59.cloneTo=function cloneTo(destObject){var destColor=destObject;destColor.r=this.r;destColor.g=this.g;destColor.b=this.b;destColor.a=this.a;};_proto59.clone=function clone(){var dest=new Color();this.cloneTo(dest);return dest;};_proto59.forNativeElement=function forNativeElement(){};return Color;}();Color.RED=new Color(1,0,0,1);Color.GREEN=new Color(0,1,0,1);Color.BLUE=new Color(0,0,1,1);Color.CYAN=new Color(0,1,1,1);Color.YELLOW=new Color(1,0.92,0.016,1);Color.MAGENTA=new Color(1,0,1,1);Color.GRAY=new Color(0.5,0.5,0.5,1);Color.WHITE=new Color(1,1,1,1);Color.BLACK=new Color(0,0,0,1);var CameraCullInfo=function CameraCullInfo(){};var ShadowCullInfo=function ShadowCullInfo(){};var FrustumCulling=/*#__PURE__*/function(){function FrustumCulling(){}FrustumCulling.__init__=function __init__(){if(Laya.Render.supportWebGLPlusCulling){FrustumCulling._cullingBufferLength=0;FrustumCulling._cullingBuffer=new Float32Array(4096);}};FrustumCulling._drawTraversalCullingBound=function _drawTraversalCullingBound(renderList,debugTool){var renders=renderList.elements;for(var i=0,n=renderList.length;i<n;i++){var color=FrustumCulling._tempColor0;color.r=0;color.g=1;color.b=0;color.a=1;Utils3D._drawBound(debugTool,renders[i].bounds._getBoundBox(),color);}};FrustumCulling._traversalCulling=function _traversalCulling(cameraCullInfo,scene,context,renderList,customShader,replacementTag,isShadowCasterCull){var renders=renderList.elements;var boundFrustum=cameraCullInfo.boundFrustum;var camPos=cameraCullInfo.position;var cullMask=cameraCullInfo.cullingMask;var loopCount=Laya.Stat.loopCount;for(var i=0,n=renderList.length;i<n;i++){var render=renders[i];var canPass;if(isShadowCasterCull)canPass=render._castShadow&&render._enable;else canPass=(Math.pow(2,render._owner._layer)&cullMask)!=0&&render._enable;if(canPass){Laya.Stat.frustumCulling++;if(!cameraCullInfo.useOcclusionCulling||render._needRender(boundFrustum,context)){render._renderMark=loopCount;render._distanceForSort=Vector3.distance(render.bounds.getCenter(),camPos);var elements=render._renderElements;for(var j=0,m=elements.length;j<m;j++){elements[j]._update(scene,context,customShader,replacementTag);}}}}};FrustumCulling.renderObjectCulling=function renderObjectCulling(cameraCullInfo,scene,context,customShader,replacementTag,isShadowCasterCull){var opaqueQueue=scene._opaqueQueue;var transparentQueue=scene._transparentQueue;var renderList=scene._renders;scene._clearRenderQueue();var octree=scene._octree;if(octree){octree.updateMotionObjects();octree.shrinkRootIfPossible();octree.getCollidingWithFrustum(cameraCullInfo,context,customShader,replacementTag,isShadowCasterCull);}FrustumCulling._traversalCulling(cameraCullInfo,scene,context,renderList,customShader,replacementTag,isShadowCasterCull);if(FrustumCulling.debugFrustumCulling){var debugTool=scene._debugTool;debugTool.clear();if(octree){octree.drawAllBounds(debugTool);octree.drawAllObjects(debugTool);}FrustumCulling._drawTraversalCullingBound(renderList,debugTool);}var count=opaqueQueue.elements.length;count>0&&opaqueQueue._quickSort(0,count-1);count=transparentQueue.elements.length;count>0&&transparentQueue._quickSort(0,count-1);};FrustumCulling.cullingShadow=function cullingShadow(cullInfo,scene,context){var renderList=scene._renders;scene._clearRenderQueue();var opaqueQueue=scene._opaqueQueue;var position=cullInfo.position;var cullPlaneCount=cullInfo.cullPlaneCount;var cullPlanes=cullInfo.cullPlanes;var cullSphere=cullInfo.cullSphere;var direction=cullInfo.direction;var renders=renderList.elements;var loopCount=Laya.Stat.loopCount;for(var i=0,n=renderList.length;i<n;i++){var render=renders[i];var canPass=render._castShadow&&render._enable;if(canPass){Laya.Stat.frustumCulling++;var bounds=render.bounds;var min=bounds.getMin();var max=bounds.getMax();var minX=min.x;var minY=min.y;var minZ=min.z;var maxX=max.x;var maxY=max.y;var maxZ=max.z;var pass=true;for(var j=0;j<cullPlaneCount;j++){var plane=cullPlanes[j];var normal=plane.normal;if(plane.distance+normal.x*(normal.x<0.0?minX:maxX)+normal.y*(normal.y<0.0?minY:maxY)+normal.z*(normal.z<0.0?minZ:maxZ)<0.0){pass=false;break;}}if(pass){render._renderMark=loopCount;render._distanceForSort=Vector3.distance(bounds.getCenter(),position);var elements=render._renderElements;for(var j=0,m=elements.length;j<m;j++){elements[j]._update(scene,context,null,null);}}}}return opaqueQueue.elements.length>0?true:false;};FrustumCulling.cullingSpotShadow=function cullingSpotShadow(cameraCullInfo,scene,context){var renderList=scene._renders;scene._clearRenderQueue();var opaqueQueue=scene._opaqueQueue;var renders=renderList.elements;var loopCount=Laya.Stat.loopCount;for(var i=0,n=renderList.length;i<n;i++){var render=renders[i];var canPass=render._castShadow&&render._enable;if(canPass){if(render._needRender(cameraCullInfo.boundFrustum,context)){var bounds=render.bounds;render._renderMark=loopCount;render._distanceForSort=Vector3.distance(bounds.getCenter(),cameraCullInfo.position);var elements=render._renderElements;for(var j=0,m=elements.length;j<m;j++){elements[j]._update(scene,context,null,null);}}}}return opaqueQueue.elements.length>0?true:false;};FrustumCulling.renderObjectCullingNative=function renderObjectCullingNative(camera,scene,context,renderList,customShader,replacementTag){var i,j,m;var opaqueQueue=scene._opaqueQueue;var transparentQueue=scene._transparentQueue;scene._clearRenderQueue();var validCount=renderList.length;var renders=renderList.elements;for(i=0;i<validCount;i++){renders[i].bounds;renders[i]._updateForNative&&renders[i]._updateForNative(context);}var boundFrustum=camera.boundFrustum;FrustumCulling.cullingNative(camera._boundFrustumBuffer,FrustumCulling._cullingBuffer,scene._cullingBufferIndices,validCount,scene._cullingBufferResult);var loopCount=Laya.Stat.loopCount;var camPos=context.camera._transform.position;for(i=0;i<validCount;i++){var render=renders[i];if(!camera.useOcclusionCulling||camera._isLayerVisible(render._owner._layer)&&render._enable&&scene._cullingBufferResult[i]){render._renderMark=loopCount;render._distanceForSort=Vector3.distance(render.bounds.getCenter(),camPos);var elements=render._renderElements;for(j=0,m=elements.length;j<m;j++){var element=elements[j];element._update(scene,context,customShader,replacementTag);}}}var count=opaqueQueue.elements.length;count>0&&opaqueQueue._quickSort(0,count-1);count=transparentQueue.elements.length;count>0&&transparentQueue._quickSort(0,count-1);};FrustumCulling.cullingNative=function cullingNative(boundFrustumBuffer,cullingBuffer,cullingBufferIndices,cullingCount,cullingBufferResult){return Laya.LayaGL.instance.culling(boundFrustumBuffer,cullingBuffer,cullingBufferIndices,cullingCount,cullingBufferResult);};return FrustumCulling;}();FrustumCulling._tempColor0=new Color();FrustumCulling._tempVector0=new Vector3();FrustumCulling._cameraCullInfo=new CameraCullInfo();FrustumCulling._shadowCullInfo=new ShadowCullInfo();FrustumCulling.debugFrustumCulling=false;var LightBound=function LightBound(){};var ClusterData=function ClusterData(){this.updateMark=-1;this.pointLightCount=0;this.spotLightCount=0;this.indices=[];};var Cluster=/*#__PURE__*/function(){function Cluster(xSlices,ySlices,zSlices,maxLightsPerClusterAverage){this._updateMark=0;this._depthSliceParam=new Vector2();this._xSlices=xSlices;this._ySlices=ySlices;this._zSlices=zSlices;var clusterTexWidth=xSlices*ySlices;var clisterTexHeight=zSlices*(1+Math.ceil(maxLightsPerClusterAverage/4));this._clusterTexture=Utils3D._createFloatTextureBuffer(clusterTexWidth,clisterTexHeight);this._clusterTexture.lock=true;this._clusterPixels=new Float32Array(clusterTexWidth*clisterTexHeight*4);var clusterDatas=new Array(this._zSlices);for(var z=0;z<this._zSlices;z++){clusterDatas[z]=new Array(this._ySlices);for(var y=0;y<this._ySlices;y++){clusterDatas[z][y]=new Array(this._xSlices);for(var x=0;x<this._xSlices;x++){clusterDatas[z][y][x]=new ClusterData();}}}this._clusterDatas=clusterDatas;}var _proto60=Cluster.prototype;_proto60._insertSpotLightSphere=function _insertSpotLightSphere(origin,forward,size,angle,testSphere){var V=Cluster._tempVector35;V.x=testSphere.x-origin.x;V.y=testSphere.y-origin.y;V.z=testSphere.z-origin.z;var VlenSq=Vector3.dot(V,V);var sphereRadius=testSphere.w;var rangeCull=VlenSq>sphereRadius*sphereRadius;if(!rangeCull)return false;var V1len=Vector3.dot(V,forward);var distanceClosestPoint=Math.cos(angle)*Math.sqrt(VlenSq-V1len*V1len)-V1len*Math.sin(angle);var angleCull=distanceClosestPoint>sphereRadius;var frontCull=V1len>sphereRadius+size;var backCull=V1len<-sphereRadius;return !(angleCull||frontCull||backCull);};_proto60._placePointLightToClusters=function _placePointLightToClusters(lightIndex,lightBound){var clusterDatas=this._clusterDatas;var updateMark=this._updateMark;for(var z=lightBound.zMin,zEnd=lightBound.zMax;z<zEnd;z++){for(var y=lightBound.yMin,yEnd=lightBound.yMax;y<yEnd;y++){for(var x=lightBound.xMin,xEnd=lightBound.xMax;x<xEnd;x++){var data=clusterDatas[z][y][x];if(data.updateMark!=updateMark){data.pointLightCount=0;data.spotLightCount=0;data.updateMark=updateMark;}var indices=data.indices;var lightCount=data.pointLightCount++;if(lightCount<indices.length)indices[lightCount]=lightIndex;else indices.push(lightIndex);}}}};_proto60._placeSpotLightToClusters=function _placeSpotLightToClusters(lightIndex,lightBound){var clusterDatas=this._clusterDatas;var updateMark=this._updateMark;for(var z=lightBound.zMin,zEnd=lightBound.zMax;z<zEnd;z++){for(var y=lightBound.yMin,yEnd=lightBound.yMax;y<yEnd;y++){for(var x=lightBound.xMin,xEnd=lightBound.xMax;x<xEnd;x++){var data=clusterDatas[z][y][x];if(data.updateMark!=updateMark){data.pointLightCount=0;data.spotLightCount=0;data.updateMark=updateMark;}var indices=data.indices;var lightCount=data.pointLightCount+data.spotLightCount++;if(lightCount<indices.length)indices[lightCount]=lightIndex;else indices.push(lightIndex);}}}};_proto60._insertConePlane=function _insertConePlane(origin,forward,radius,halfAngle,pNor){var V1=Cluster._tempVector36;var V2=Cluster._tempVector37;Vector3.cross(pNor,forward,V1);Vector3.cross(V1,forward,V2);Vector3.normalize(V2,V2);var tanR=radius*Math.tan(halfAngle);var capRimX=origin.x+radius*forward.x+tanR*V2.x;var capRimY=origin.y+radius*forward.y+tanR*V2.y;var capRimZ=origin.z+radius*forward.z+tanR*V2.z;return capRimX*pNor.x+capRimY*pNor.y+capRimZ*pNor.z<=0||origin.x*pNor.x+origin.y*pNor.y+origin.z*pNor.z<=0;};_proto60._shrinkSphereLightZPerspective=function _shrinkSphereLightZPerspective(near,far,lightviewPos,radius,lightBound){var lvZ=lightviewPos.z;var minZ=lvZ-radius;var maxZ=lvZ+radius;if(minZ>far||maxZ<=near)return false;var depthSliceParam=this._depthSliceParam;lightBound.zMin=Math.floor(Math.log2(Math.max(minZ,near))*depthSliceParam.x-depthSliceParam.y);lightBound.zMax=Math.min(Math.ceil(Math.log2(maxZ)*depthSliceParam.x-depthSliceParam.y),this._zSlices);return true;};_proto60._shrinkSpotLightZPerspective=function _shrinkSpotLightZPerspective(near,far,viewLightPos,viewConeCap,radius,halfAngle,lightBound){var pbX=viewConeCap.x,pbY=viewConeCap.y,pbZ=viewConeCap.z;var rb=Math.tan(halfAngle)*radius;var paX=viewLightPos.x,paY=viewLightPos.y,paZ=viewLightPos.z;var aX=pbX-paX,aY=pbY-paY,aZ=pbZ-paZ;var dotA=aX*aX+aY*aY+aZ*aZ;var eZ=Math.sqrt(1.0-aZ*aZ/dotA);var minZ=Math.max(Math.min(paZ,pbZ-eZ*rb),viewLightPos.z-radius);var maxZ=Math.min(Math.max(paZ,pbZ+eZ*rb),viewLightPos.z+radius);if(minZ>far||maxZ<=near)return false;var depthSliceParam=this._depthSliceParam;lightBound.zMin=Math.floor(Math.log2(Math.max(minZ,near))*depthSliceParam.x-depthSliceParam.y);lightBound.zMax=Math.min(Math.ceil(Math.log2(maxZ)*depthSliceParam.x-depthSliceParam.y),this._zSlices);return true;};_proto60._shrinkSphereLightByBoundOrth=function _shrinkSphereLightByBoundOrth(halfX,halfY,near,far,lightviewPos,radius,lightBound){var lvZ=lightviewPos.z;var minZ=lvZ-radius,maxZ=lvZ+radius;if(minZ>far||maxZ<=near)return false;var lvX=lightviewPos.x;var minX=lvX-radius,maxX=lvX+radius;if(minX>halfX||maxX<=-halfX)return false;var lvY=lightviewPos.y;var minY=lvY-radius,maxY=lvY+radius;if(minY>halfY||maxY<=-halfY)return false;var xSlices=this._xSlices,ySlices=this._ySlices;var depthSliceParam=this._depthSliceParam;var xStride=halfX*2/xSlices,yStride=halfY*2/ySlices;lightBound.xMin=Math.max(Math.floor((minX+halfX)/xStride),0);lightBound.xMax=Math.min(Math.ceil((maxX+halfX)/xStride),xSlices);lightBound.yMin=Math.max(Math.floor((halfY-maxY)/yStride),0);lightBound.yMax=Math.min(Math.ceil((halfY-minY)/yStride),ySlices);lightBound.zMin=Math.floor(Math.log2(Math.max(minZ,near))*depthSliceParam.x-depthSliceParam.y);lightBound.zMax=Math.min(Math.ceil(Math.log2(maxZ)*depthSliceParam.x-depthSliceParam.y),this._zSlices);return true;};_proto60._shrinkSpotLightByBoundOrth=function _shrinkSpotLightByBoundOrth(halfX,halfY,near,far,viewLightPos,viewConeCap,radius,halfAngle,lightBound){var pbX=viewConeCap.x,pbY=viewConeCap.y,pbZ=viewConeCap.z;var rb=Math.tan(halfAngle)*radius;var paX=viewLightPos.x,paY=viewLightPos.y,paZ=viewLightPos.z;var aX=pbX-paX,aY=pbY-paY,aZ=pbZ-paZ;var dotA=aX*aX+aY*aY+aZ*aZ;var eZ=Math.sqrt(1.0-aZ*aZ/dotA);var minZ=Math.max(Math.min(paZ,pbZ-eZ*rb),viewLightPos.z-radius);var maxZ=Math.min(Math.max(paZ,pbZ+eZ*rb),viewLightPos.z+radius);if(minZ>far||maxZ<=near)return false;var eX=Math.sqrt(1.0-aX*aX/dotA);var minX=Math.max(Math.min(paX,pbX-eX*rb),viewLightPos.x-radius);var maxX=Math.min(Math.max(paX,pbX+eX*rb),viewLightPos.x+radius);if(minX>halfX||maxX<=-halfX)return false;var eY=Math.sqrt(1.0-aY*aY/dotA);var minY=Math.max(Math.min(paY,pbY-eY*rb),viewLightPos.y-radius);var maxY=Math.min(Math.max(paY,pbY+eY*rb),viewLightPos.y+radius);if(minY>halfY||maxY<=-halfY)return false;var xSlices=this._xSlices,ySlices=this._ySlices;var depthSliceParam=this._depthSliceParam;var xStride=halfX*2/xSlices,yStride=halfY*2/ySlices;lightBound.xMin=Math.max(Math.floor((minX+halfX)/xStride),0);lightBound.xMax=Math.min(Math.ceil((maxX+halfX)/xStride),xSlices);lightBound.yMin=Math.max(Math.floor((halfY-maxY)/yStride),0);lightBound.yMax=Math.min(Math.ceil((halfY-minY)/yStride),ySlices);lightBound.zMin=Math.floor(Math.log2(Math.max(minZ,near))*depthSliceParam.x-depthSliceParam.y);lightBound.zMax=Math.min(Math.ceil(Math.log2(maxZ)*depthSliceParam.x-depthSliceParam.y),this._zSlices);return true;};_proto60._shrinkXYByRadiusPerspective=function _shrinkXYByRadiusPerspective(lightviewPos,radius,lightBound,xPlanes,yPlanes){var xMin,yMin;var xMax,yMax;var lvX=lightviewPos.x,lvY=lightviewPos.y,lvZ=lightviewPos.z;var i;var n=this._ySlices+1;for(i=0;i<n;i++){var plane=yPlanes[i];if(lvY*plane.y+lvZ*plane.z<radius){yMin=Math.max(0,i-1);break;}}if(i==n)return false;yMax=this._ySlices;for(i=yMin+1;i<n;i++){var plane=yPlanes[i];if(lvY*plane.y+lvZ*plane.z<=-radius){yMax=Math.max(0,i);break;}}n=this._xSlices+1;for(i=0;i<n;i++){var plane=xPlanes[i];if(lvX*plane.x+lvZ*plane.z<radius){xMin=Math.max(0,i-1);break;}}xMax=this._xSlices;for(i=xMin+1;i<n;i++){var plane=xPlanes[i];if(lvX*plane.x+lvZ*plane.z<=-radius){xMax=Math.max(0,i);break;}}lightBound.xMin=xMin;lightBound.xMax=xMax;lightBound.yMin=yMin;lightBound.yMax=yMax;return true;};_proto60._shrinkSpotXYByConePerspective=function _shrinkSpotXYByConePerspective(lightviewPos,viewForward,radius,halfAngle,lightBound,xPlanes,yPlanes){var xMin,yMin;var xMax,yMax;var normal=Cluster._tempVector32;var n=lightBound.yMax+1;for(var i=lightBound.yMin+1;i<n;i++){if(this._insertConePlane(lightviewPos,viewForward,radius,halfAngle,yPlanes[i])){yMin=Math.max(0,i-1);break;}}yMax=lightBound.yMax;for(var i=yMin+1;i<n;i++){var plane=yPlanes[i];normal.setValue(0,-plane.y,-plane.z);if(!this._insertConePlane(lightviewPos,viewForward,radius,halfAngle,normal)){yMax=Math.max(0,i);break;}}n=lightBound.xMax+1;for(var i=lightBound.xMin+1;i<n;i++){if(this._insertConePlane(lightviewPos,viewForward,radius,halfAngle,xPlanes[i])){xMin=Math.max(0,i-1);break;}}xMax=lightBound.xMax;for(var i=xMin+1;i<n;i++){var plane=xPlanes[i];normal.setValue(-plane.x,0,-plane.z);if(!this._insertConePlane(lightviewPos,viewForward,radius,halfAngle,normal)){xMax=Math.max(0,i);break;}}lightBound.xMin=xMin;lightBound.xMax=xMax;lightBound.yMin=yMin;lightBound.yMax=yMax;};_proto60._updatePointLightPerspective=function _updatePointLightPerspective(near,far,viewMat,pointLight,lightIndex,xPlanes,yPlanes){var lightBound=Cluster._tempLightBound;var lightviewPos=Cluster._tempVector30;Vector3.transformV3ToV3(pointLight._transform.position,viewMat,lightviewPos);lightviewPos.z*=-1;if(!this._shrinkSphereLightZPerspective(near,far,lightviewPos,pointLight.range,lightBound))return;if(!this._shrinkXYByRadiusPerspective(lightviewPos,pointLight.range,lightBound,xPlanes,yPlanes))return;this._placePointLightToClusters(lightIndex,lightBound);};_proto60._updateSpotLightPerspective=function _updateSpotLightPerspective(near,far,viewMat,spotLight,lightIndex,xPlanes,yPlanes){var lightBound=Cluster._tempLightBound;var viewPos=Cluster._tempVector30;var forward=Cluster._tempVector31;var viewConeCap=Cluster._tempVector34;var position=spotLight._transform.position;var range=spotLight.range;spotLight._transform.worldMatrix.getForward(forward);Vector3.normalize(forward,forward);Vector3.scale(forward,range,viewConeCap);Vector3.add(position,viewConeCap,viewConeCap);Vector3.transformV3ToV3(position,viewMat,viewPos);Vector3.transformV3ToV3(viewConeCap,viewMat,viewConeCap);viewPos.z*=-1;viewConeCap.z*=-1;var halfAngle=spotLight.spotAngle/2*Math.PI/180;if(!this._shrinkSpotLightZPerspective(near,far,viewPos,viewConeCap,range,halfAngle,lightBound))return;if(!this._shrinkXYByRadiusPerspective(viewPos,range,lightBound,xPlanes,yPlanes))return;var viewFor=Cluster._tempVector33;viewFor.x=viewConeCap.x-viewPos.x,viewFor.y=viewConeCap.y-viewPos.y,viewFor.z=viewConeCap.z-viewPos.z;Vector3.normalize(viewFor,viewFor);this._shrinkSpotXYByConePerspective(viewPos,viewFor,range,halfAngle,lightBound,xPlanes,yPlanes);this._placeSpotLightToClusters(lightIndex,lightBound);};_proto60._updatePointLightOrth=function _updatePointLightOrth(halfX,halfY,near,far,viewMat,pointLight,lightIndex){var lightBound=Cluster._tempLightBound;var lightviewPos=Cluster._tempVector30;Vector3.transformV3ToV3(pointLight._transform.position,viewMat,lightviewPos);lightviewPos.z*=-1;if(!this._shrinkSphereLightByBoundOrth(halfX,halfY,near,far,lightviewPos,pointLight.range,lightBound))return;this._placePointLightToClusters(lightIndex,lightBound);};_proto60._updateSpotLightOrth=function _updateSpotLightOrth(halfX,halfY,near,far,viewMat,spotLight,lightIndex){var lightBound=Cluster._tempLightBound;var viewPos=Cluster._tempVector30;var forward=Cluster._tempVector31;var viewConeCap=Cluster._tempVector34;var position=spotLight._transform.position;var range=spotLight.range;spotLight._transform.worldMatrix.getForward(forward);Vector3.normalize(forward,forward);Vector3.scale(forward,range,viewConeCap);Vector3.add(position,viewConeCap,viewConeCap);Vector3.transformV3ToV3(position,viewMat,viewPos);Vector3.transformV3ToV3(viewConeCap,viewMat,viewConeCap);viewPos.z*=-1;viewConeCap.z*=-1;var halfAngle=spotLight.spotAngle/2*Math.PI/180;if(!this._shrinkSpotLightByBoundOrth(halfX,halfY,near,far,viewPos,viewConeCap,range,halfAngle,lightBound))return;this._placeSpotLightToClusters(lightIndex,lightBound);};_proto60.update=function update(camera,scene){this._updateMark++;var camNear=camera.nearPlane;this._depthSliceParam.x=Config3D._config.lightClusterCount.z/Math.log2(camera.farPlane/camNear);this._depthSliceParam.y=Math.log2(camNear)*this._depthSliceParam.x;var near=camera.nearPlane;var far=camera.farPlane;var viewMat=camera.viewMatrix;var curCount=scene._directionLights._length;var pointLights=scene._pointLights;var poiCount=pointLights._length;var poiElements=pointLights._elements;var spotLights=scene._spotLights;var spoCount=spotLights._length;var spoElements=spotLights._elements;if(camera.orthographic){var halfY=camera.orthographicVerticalSize/2.0;var halfX=halfY*camera.aspectRatio;for(var i=0;i<poiCount;i++,curCount++){this._updatePointLightOrth(halfX,halfY,near,far,viewMat,poiElements[i],curCount);}for(var i=0;i<spoCount;i++,curCount++){this._updateSpotLightOrth(halfX,halfY,near,far,viewMat,spoElements[i],curCount);}}else {camera._updateClusterPlaneXY();var xPlanes=camera._clusterXPlanes;var yPlanes=camera._clusterYPlanes;for(var i=0;i<poiCount;i++,curCount++){this._updatePointLightPerspective(near,far,viewMat,poiElements[i],curCount,xPlanes,yPlanes);}for(var i=0;i<spoCount;i++,curCount++){this._updateSpotLightPerspective(near,far,viewMat,spoElements[i],curCount,xPlanes,yPlanes);}}if(poiCount+spoCount>0){var xSlices=this._xSlices,ySlices=this._ySlices,zSlices=this._zSlices;var widthFloat=xSlices*ySlices*4;var lightOff=widthFloat*zSlices;var clusterPixels=this._clusterPixels;var clusterPixelsCount=clusterPixels.length;var clusterDatas=this._clusterDatas;var updateMark=this._updateMark;var freeSpace=true;for(var z=0;z<zSlices;z++){for(var y=0;y<ySlices;y++){for(var x=0;x<xSlices;x++){var data=clusterDatas[z][y][x];var clusterOff=(x+y*xSlices+z*xSlices*ySlices)*4;if(data.updateMark!==updateMark){clusterPixels[clusterOff]=0;clusterPixels[clusterOff+1]=0;}else {if(freeSpace){var indices=data.indices;var pCount=data.pointLightCount;var sCount=data.spotLightCount;var count=pCount+sCount;if(lightOff+count<clusterPixelsCount){clusterPixels[clusterOff]=pCount;clusterPixels[clusterOff+1]=sCount;clusterPixels[clusterOff+2]=Math.floor(lightOff/widthFloat);clusterPixels[clusterOff+3]=lightOff%widthFloat;for(var i=0;i<count;i++){clusterPixels[lightOff++]=indices[i];}}else {count=clusterPixelsCount-(lightOff+count);pCount=Math.min(pCount,count);clusterPixels[clusterOff]=pCount;clusterPixels[clusterOff+1]=Math.min(sCount,count-pCount);clusterPixels[clusterOff+2]=Math.floor(lightOff/widthFloat);clusterPixels[clusterOff+3]=lightOff%widthFloat;for(var i=0;i<count;i++){clusterPixels[lightOff++]=indices[i];}freeSpace=false;}}}}}}var width=this._clusterTexture.width;this._clusterTexture.setSubPixels(0,0,width,Math.ceil(lightOff/(4*width)),clusterPixels);}};return Cluster;}();Cluster._tempVector30=new Vector3();Cluster._tempVector31=new Vector3();Cluster._tempVector32=new Vector3();Cluster._tempVector33=new Vector3();Cluster._tempVector34=new Vector3();Cluster._tempVector35=new Vector3();Cluster._tempVector36=new Vector3();Cluster._tempVector37=new Vector3();Cluster._tempLightBound=new LightBound();var SphericalHarmonicsL2=/*#__PURE__*/function(){function SphericalHarmonicsL2(){this._coefficients=new Float32Array(27);}var _proto61=SphericalHarmonicsL2.prototype;_proto61.getCoefficient=function getCoefficient(i,j){return this._coefficients[i*9+j];};_proto61.setCoefficient=function setCoefficient(i,j,coefficient){this._coefficients[i*9+j]=coefficient;};_proto61.setCoefficients=function setCoefficients(i,coefficient0,coefficient1,coefficient2,coefficient3,coefficient4,coefficient5,coefficient6,coefficient7,coefficient8){var offset=i*9;this._coefficients[offset]=coefficient0;this._coefficients[++offset]=coefficient1;this._coefficients[++offset]=coefficient2;this._coefficients[++offset]=coefficient3;this._coefficients[++offset]=coefficient4;this._coefficients[++offset]=coefficient5;this._coefficients[++offset]=coefficient6;this._coefficients[++offset]=coefficient7;this._coefficients[++offset]=coefficient8;};_proto61.cloneTo=function cloneTo(dest){if(this===dest)return;var coes=this._coefficients;var destCoes=dest._coefficients;for(var i=0;i<27;i++){destCoes[i]=coes[i];}};return SphericalHarmonicsL2;}();SphericalHarmonicsL2._default=new SphericalHarmonicsL2();var MouseTouch=function MouseTouch(){this._pressedSprite=null;this._pressedLoopCount=-1;this.sprite=null;this.mousePositionX=0;this.mousePositionY=0;};var Touch=/*#__PURE__*/function(){function Touch(){this._indexInList=-1;this._identifier=-1;this._position=new Vector2();}var _proto62=Touch.prototype;_proto62._getIndexInList=function _getIndexInList(){return this._indexInList;};_proto62._setIndexInList=function _setIndexInList(index){this._indexInList=index;};_createClass(Touch,[{key:"identifier",get:function get(){return this._identifier;}},{key:"position",get:function get(){return this._position;}}]);return Touch;}();var Plane=/*#__PURE__*/function(){function Plane(normal,d){if(d===void 0){d=0;}this.normal=normal;this.distance=d;}Plane.createPlaneBy3P=function createPlaneBy3P(point0,point1,point2,out){var x1=point1.x-point0.x;var y1=point1.y-point0.y;var z1=point1.z-point0.z;var x2=point2.x-point0.x;var y2=point2.y-point0.y;var z2=point2.z-point0.z;var yz=y1*z2-z1*y2;var xz=z1*x2-x1*z2;var xy=x1*y2-y1*x2;var invPyth=1.0/Math.sqrt(yz*yz+xz*xz+xy*xy);var x=yz*invPyth;var y=xz*invPyth;var z=xy*invPyth;var normal=out.normal;normal.x=x;normal.y=y;normal.z=z;out.distance=-(x*point0.x+y*point0.y+z*point0.z);};var _proto63=Plane.prototype;_proto63.normalize=function normalize(){var normalEX=this.normal.x;var normalEY=this.normal.y;var normalEZ=this.normal.z;var magnitude=1.0/Math.sqrt(normalEX*normalEX+normalEY*normalEY+normalEZ*normalEZ);this.normal.x=normalEX*magnitude;this.normal.y=normalEY*magnitude;this.normal.z=normalEZ*magnitude;this.distance*=magnitude;};_proto63.cloneTo=function cloneTo(destObject){var dest=destObject;this.normal.cloneTo(dest.normal);dest.distance=this.distance;};_proto63.clone=function clone(){var dest=new Plane(new Vector3());this.cloneTo(dest);return dest;};return Plane;}();Plane.PlaneIntersectionType_Back=0;Plane.PlaneIntersectionType_Front=1;Plane.PlaneIntersectionType_Intersecting=2;var Ray=function Ray(origin,direction){this.origin=origin;this.direction=direction;};var ContainmentType=function ContainmentType(){};ContainmentType.Disjoint=0;ContainmentType.Contains=1;ContainmentType.Intersects=2;var CollisionUtils=/*#__PURE__*/function(){function CollisionUtils(){}CollisionUtils.distancePlaneToPoint=function distancePlaneToPoint(plane,point){var dot=Vector3.dot(plane.normal,point);return dot-plane.distance;};CollisionUtils.distanceBoxToPoint=function distanceBoxToPoint(box,point){var boxMin=box.min;var boxMineX=boxMin.x;var boxMineY=boxMin.y;var boxMineZ=boxMin.z;var boxMax=box.max;var boxMaxeX=boxMax.x;var boxMaxeY=boxMax.y;var boxMaxeZ=boxMax.z;var pointeX=point.x;var pointeY=point.y;var pointeZ=point.z;var distance=0;if(pointeX<boxMineX)distance+=(boxMineX-pointeX)*(boxMineX-pointeX);if(pointeX>boxMaxeX)distance+=(boxMaxeX-pointeX)*(boxMaxeX-pointeX);if(pointeY<boxMineY)distance+=(boxMineY-pointeY)*(boxMineY-pointeY);if(pointeY>boxMaxeY)distance+=(boxMaxeY-pointeY)*(boxMaxeY-pointeY);if(pointeZ<boxMineZ)distance+=(boxMineZ-pointeZ)*(boxMineZ-pointeZ);if(pointeZ>boxMaxeZ)distance+=(boxMaxeZ-pointeZ)*(boxMaxeZ-pointeZ);return Math.sqrt(distance);};CollisionUtils.distanceBoxToBox=function distanceBoxToBox(box1,box2){var box1Mine=box1.min;var box1MineX=box1Mine.x;var box1MineY=box1Mine.y;var box1MineZ=box1Mine.z;var box1Maxe=box1.max;var box1MaxeX=box1Maxe.x;var box1MaxeY=box1Maxe.y;var box1MaxeZ=box1Maxe.z;var box2Mine=box2.min;var box2MineX=box2Mine.x;var box2MineY=box2Mine.y;var box2MineZ=box2Mine.z;var box2Maxe=box2.max;var box2MaxeX=box2Maxe.x;var box2MaxeY=box2Maxe.y;var box2MaxeZ=box2Maxe.z;var distance=0;var delta;if(box1MineX>box2MaxeX){delta=box1MineX-box2MaxeX;distance+=delta*delta;}else if(box2MineX>box1MaxeX){delta=box2MineX-box1MaxeX;distance+=delta*delta;}if(box1MineY>box2MaxeY){delta=box1MineY-box2MaxeY;distance+=delta*delta;}else if(box2MineY>box1MaxeY){delta=box2MineY-box1MaxeY;distance+=delta*delta;}if(box1MineZ>box2MaxeZ){delta=box1MineZ-box2MaxeZ;distance+=delta*delta;}else if(box2MineZ>box1MaxeZ){delta=box2MineZ-box1MaxeZ;distance+=delta*delta;}return Math.sqrt(distance);};CollisionUtils.distanceSphereToPoint=function distanceSphereToPoint(sphere,point){var distance=Math.sqrt(Vector3.distanceSquared(sphere.center,point));distance-=sphere.radius;return Math.max(distance,0);};CollisionUtils.distanceSphereToSphere=function distanceSphereToSphere(sphere1,sphere2){var distance=Math.sqrt(Vector3.distanceSquared(sphere1.center,sphere2.center));distance-=sphere1.radius+sphere2.radius;return Math.max(distance,0);};CollisionUtils.intersectsRayAndTriangleRD=function intersectsRayAndTriangleRD(ray,vertex1,vertex2,vertex3,out){var rayO=ray.origin;var rayOeX=rayO.x;var rayOeY=rayO.y;var rayOeZ=rayO.z;var rayD=ray.direction;var rayDeX=rayD.x;var rayDeY=rayD.y;var rayDeZ=rayD.z;var v1eX=vertex1.x;var v1eY=vertex1.y;var v1eZ=vertex1.z;var v2eX=vertex2.x;var v2eY=vertex2.y;var v2eZ=vertex2.z;var v3eX=vertex3.x;var v3eY=vertex3.y;var v3eZ=vertex3.z;var _tempV30eX=CollisionUtils._tempV30.x;var _tempV30eY=CollisionUtils._tempV30.y;var _tempV30eZ=CollisionUtils._tempV30.z;_tempV30eX=v2eX-v1eX;_tempV30eY=v2eY-v1eY;_tempV30eZ=v2eZ-v1eZ;var _tempV31eX=CollisionUtils._tempV31.x;var _tempV31eY=CollisionUtils._tempV31.y;var _tempV31eZ=CollisionUtils._tempV31.z;_tempV31eX=v3eX-v1eX;_tempV31eY=v3eY-v1eY;_tempV31eZ=v3eZ-v1eZ;var _tempV32eX=CollisionUtils._tempV32.x;var _tempV32eY=CollisionUtils._tempV32.y;var _tempV32eZ=CollisionUtils._tempV32.z;_tempV32eX=rayDeY*_tempV31eZ-rayDeZ*_tempV31eY;_tempV32eY=rayDeZ*_tempV31eX-rayDeX*_tempV31eZ;_tempV32eZ=rayDeX*_tempV31eY-rayDeY*_tempV31eX;var determinant=_tempV30eX*_tempV32eX+_tempV30eY*_tempV32eY+_tempV30eZ*_tempV32eZ;if(MathUtils3D.isZero(determinant)){return false;}var inversedeterminant=1/determinant;var _tempV33eX=CollisionUtils._tempV33.x;var _tempV33eY=CollisionUtils._tempV33.y;var _tempV33eZ=CollisionUtils._tempV33.z;_tempV33eX=rayOeX-v1eX;_tempV33eY=rayOeY-v1eY;_tempV33eZ=rayOeZ-v1eZ;var triangleU=_tempV33eX*_tempV32eX+_tempV33eY*_tempV32eY+_tempV33eZ*_tempV32eZ;triangleU*=inversedeterminant;if(triangleU<0||triangleU>1){return false;}var _tempV34eX=CollisionUtils._tempV34.x;var _tempV34eY=CollisionUtils._tempV34.y;var _tempV34eZ=CollisionUtils._tempV34.z;_tempV34eX=_tempV33eY*_tempV30eZ-_tempV33eZ*_tempV30eY;_tempV34eY=_tempV33eZ*_tempV30eX-_tempV33eX*_tempV30eZ;_tempV34eZ=_tempV33eX*_tempV30eY-_tempV33eY*_tempV30eX;var triangleV=rayDeX*_tempV34eX+rayDeY*_tempV34eY+rayDeZ*_tempV34eZ;triangleV*=inversedeterminant;if(triangleV<0||triangleU+triangleV>1){return false;}var raydistance=_tempV31eX*_tempV34eX+_tempV31eY*_tempV34eY+_tempV31eZ*_tempV34eZ;raydistance*=inversedeterminant;if(raydistance<0){return false;}return true;};CollisionUtils.intersectsRayAndTriangleRP=function intersectsRayAndTriangleRP(ray,vertex1,vertex2,vertex3,out){var distance;if(!CollisionUtils.intersectsRayAndTriangleRD(ray,vertex1,vertex2,vertex3,distance)){out=Vector3._ZERO;return false;}Vector3.scale(ray.direction,distance,CollisionUtils._tempV30);Vector3.add(ray.origin,CollisionUtils._tempV30,out);return true;};CollisionUtils.intersectsRayAndPoint=function intersectsRayAndPoint(ray,point){Vector3.subtract(ray.origin,point,CollisionUtils._tempV30);var b=Vector3.dot(CollisionUtils._tempV30,ray.direction);var c=Vector3.dot(CollisionUtils._tempV30,CollisionUtils._tempV30)-MathUtils3D.zeroTolerance;if(c>0&&b>0)return false;var discriminant=b*b-c;if(discriminant<0)return false;return true;};CollisionUtils.intersectsRayAndRay=function intersectsRayAndRay(ray1,ray2,out){var ray1o=ray1.origin;var ray1oeX=ray1o.x;var ray1oeY=ray1o.y;var ray1oeZ=ray1o.z;var ray1d=ray1.direction;var ray1deX=ray1d.x;var ray1deY=ray1d.y;var ray1deZ=ray1d.z;var ray2o=ray2.origin;var ray2oeX=ray2o.x;var ray2oeY=ray2o.y;var ray2oeZ=ray2o.z;var ray2d=ray2.direction;var ray2deX=ray2d.x;var ray2deY=ray2d.y;var ray2deZ=ray2d.z;Vector3.cross(ray1d,ray2d,CollisionUtils._tempV30);var tempV3=CollisionUtils._tempV30;var denominator=Vector3.scalarLength(CollisionUtils._tempV30);if(MathUtils3D.isZero(denominator)){if(MathUtils3D.nearEqual(ray2oeX,ray1oeX)&&MathUtils3D.nearEqual(ray2oeY,ray1oeY)&&MathUtils3D.nearEqual(ray2oeZ,ray1oeZ)){return true;}}denominator=denominator*denominator;var m11=ray2oeX-ray1oeX;var m12=ray2oeY-ray1oeY;var m13=ray2oeZ-ray1oeZ;var m21=ray2deX;var m22=ray2deY;var m23=ray2deZ;var m31=tempV3.x;var m32=tempV3.y;var m33=tempV3.z;var dets=m11*m22*m33+m12*m23*m31+m13*m21*m32-m11*m23*m32-m12*m21*m33-m13*m22*m31;m21=ray1deX;m22=ray1deY;m23=ray1deZ;var s=dets/denominator;Vector3.scale(ray1d,s,CollisionUtils._tempV30);Vector3.scale(ray2d,s,CollisionUtils._tempV31);Vector3.add(ray1o,CollisionUtils._tempV30,CollisionUtils._tempV32);Vector3.add(ray2o,CollisionUtils._tempV31,CollisionUtils._tempV33);var point1e=CollisionUtils._tempV32;var point2e=CollisionUtils._tempV33;if(!MathUtils3D.nearEqual(point2e.x,point1e.x)||!MathUtils3D.nearEqual(point2e.y,point1e.y)||!MathUtils3D.nearEqual(point2e.z,point1e.z)){return false;}return true;};CollisionUtils.intersectsPlaneAndTriangle=function intersectsPlaneAndTriangle(plane,vertex1,vertex2,vertex3){var test1=CollisionUtils.intersectsPlaneAndPoint(plane,vertex1);var test2=CollisionUtils.intersectsPlaneAndPoint(plane,vertex2);var test3=CollisionUtils.intersectsPlaneAndPoint(plane,vertex3);if(test1==Plane.PlaneIntersectionType_Front&&test2==Plane.PlaneIntersectionType_Front&&test3==Plane.PlaneIntersectionType_Front)return Plane.PlaneIntersectionType_Front;if(test1==Plane.PlaneIntersectionType_Back&&test2==Plane.PlaneIntersectionType_Back&&test3==Plane.PlaneIntersectionType_Back)return Plane.PlaneIntersectionType_Back;return Plane.PlaneIntersectionType_Intersecting;};CollisionUtils.intersectsRayAndPlaneRD=function intersectsRayAndPlaneRD(ray,plane){var planeNor=plane.normal;var direction=Vector3.dot(planeNor,ray.direction);if(Math.abs(direction)<MathUtils3D.zeroTolerance)return -1;var position=Vector3.dot(planeNor,ray.origin);var distance=(-plane.distance-position)/direction;if(distance<0){if(distance<-MathUtils3D.zeroTolerance)return -1;distance=0;}return distance;};CollisionUtils.intersectsRayAndPlaneRP=function intersectsRayAndPlaneRP(ray,plane,out){var distance=CollisionUtils.intersectsRayAndPlaneRD(ray,plane);if(distance==-1){out.setValue(0,0,0);return false;}var scaDis=CollisionUtils._tempV30;Vector3.scale(ray.direction,distance,scaDis);Vector3.add(ray.origin,scaDis,out);return true;};CollisionUtils.intersectsRayAndBoxRD=function intersectsRayAndBoxRD(ray,box){var rayoe=ray.origin;var rayoeX=rayoe.x;var rayoeY=rayoe.y;var rayoeZ=rayoe.z;var rayde=ray.direction;var raydeX=rayde.x;var raydeY=rayde.y;var raydeZ=rayde.z;var boxMine=box.min;var boxMineX=boxMine.x;var boxMineY=boxMine.y;var boxMineZ=boxMine.z;var boxMaxe=box.max;var boxMaxeX=boxMaxe.x;var boxMaxeY=boxMaxe.y;var boxMaxeZ=boxMaxe.z;var out=0;var tmax=MathUtils3D.MaxValue;if(MathUtils3D.isZero(raydeX)){if(rayoeX<boxMineX||rayoeX>boxMaxeX){return -1;}}else {var inverse=1/raydeX;var t1=(boxMineX-rayoeX)*inverse;var t2=(boxMaxeX-rayoeX)*inverse;if(t1>t2){var temp=t1;t1=t2;t2=temp;}out=Math.max(t1,out);tmax=Math.min(t2,tmax);if(out>tmax){return -1;}}if(MathUtils3D.isZero(raydeY)){if(rayoeY<boxMineY||rayoeY>boxMaxeY){return -1;}}else {var inverse1=1/raydeY;var t3=(boxMineY-rayoeY)*inverse1;var t4=(boxMaxeY-rayoeY)*inverse1;if(t3>t4){var temp1=t3;t3=t4;t4=temp1;}out=Math.max(t3,out);tmax=Math.min(t4,tmax);if(out>tmax){return -1;}}if(MathUtils3D.isZero(raydeZ)){if(rayoeZ<boxMineZ||rayoeZ>boxMaxeZ){return -1;}}else {var inverse2=1/raydeZ;var t5=(boxMineZ-rayoeZ)*inverse2;var t6=(boxMaxeZ-rayoeZ)*inverse2;if(t5>t6){var temp2=t5;t5=t6;t6=temp2;}out=Math.max(t5,out);tmax=Math.min(t6,tmax);if(out>tmax){return -1;}}return out;};CollisionUtils.intersectsRayAndBoxRP=function intersectsRayAndBoxRP(ray,box,out){var distance=CollisionUtils.intersectsRayAndBoxRD(ray,box);if(distance===-1){Vector3._ZERO.cloneTo(out);return distance;}Vector3.scale(ray.direction,distance,CollisionUtils._tempV30);Vector3.add(ray.origin,CollisionUtils._tempV30,CollisionUtils._tempV31);CollisionUtils._tempV31.cloneTo(out);return distance;};CollisionUtils.intersectsRayAndSphereRD=function intersectsRayAndSphereRD(ray,sphere){var sphereR=sphere.radius;Vector3.subtract(ray.origin,sphere.center,CollisionUtils._tempV30);var b=Vector3.dot(CollisionUtils._tempV30,ray.direction);var c=Vector3.dot(CollisionUtils._tempV30,CollisionUtils._tempV30)-sphereR*sphereR;if(c>0&&b>0){return -1;}var discriminant=b*b-c;if(discriminant<0){return -1;}var distance=-b-Math.sqrt(discriminant);if(distance<0)distance=0;return distance;};CollisionUtils.intersectsRayAndSphereRP=function intersectsRayAndSphereRP(ray,sphere,out){var distance=CollisionUtils.intersectsRayAndSphereRD(ray,sphere);if(distance===-1){Vector3._ZERO.cloneTo(out);return distance;}Vector3.scale(ray.direction,distance,CollisionUtils._tempV30);Vector3.add(ray.origin,CollisionUtils._tempV30,CollisionUtils._tempV31);CollisionUtils._tempV31.cloneTo(out);return distance;};CollisionUtils.intersectsSphereAndTriangle=function intersectsSphereAndTriangle(sphere,vertex1,vertex2,vertex3){var sphereC=sphere.center;var sphereR=sphere.radius;CollisionUtils.closestPointPointTriangle(sphereC,vertex1,vertex2,vertex3,CollisionUtils._tempV30);Vector3.subtract(CollisionUtils._tempV30,sphereC,CollisionUtils._tempV31);var dot=Vector3.dot(CollisionUtils._tempV31,CollisionUtils._tempV31);return dot<=sphereR*sphereR;};CollisionUtils.intersectsPlaneAndPoint=function intersectsPlaneAndPoint(plane,point){var distance=Vector3.dot(plane.normal,point)+plane.distance;if(distance>0)return Plane.PlaneIntersectionType_Front;if(distance<0)return Plane.PlaneIntersectionType_Back;return Plane.PlaneIntersectionType_Intersecting;};CollisionUtils.intersectsPlaneAndPlane=function intersectsPlaneAndPlane(plane1,plane2){Vector3.cross(plane1.normal,plane2.normal,CollisionUtils._tempV30);var denominator=Vector3.dot(CollisionUtils._tempV30,CollisionUtils._tempV30);if(MathUtils3D.isZero(denominator))return false;return true;};CollisionUtils.intersectsPlaneAndPlaneRL=function intersectsPlaneAndPlaneRL(plane1,plane2,line){var plane1nor=plane1.normal;var plane2nor=plane2.normal;Vector3.cross(plane1nor,plane2nor,CollisionUtils._tempV34);var denominator=Vector3.dot(CollisionUtils._tempV34,CollisionUtils._tempV34);if(MathUtils3D.isZero(denominator))return false;Vector3.scale(plane2nor,plane1.distance,CollisionUtils._tempV30);Vector3.scale(plane1nor,plane2.distance,CollisionUtils._tempV31);Vector3.subtract(CollisionUtils._tempV30,CollisionUtils._tempV31,CollisionUtils._tempV32);Vector3.cross(CollisionUtils._tempV32,CollisionUtils._tempV34,CollisionUtils._tempV33);Vector3.normalize(CollisionUtils._tempV34,CollisionUtils._tempV34);return true;};CollisionUtils.intersectsPlaneAndBox=function intersectsPlaneAndBox(plane,box){var planeD=plane.distance;var planeNor=plane.normal;var planeNoreX=planeNor.x;var planeNoreY=planeNor.y;var planeNoreZ=planeNor.z;var boxMine=box.min;var boxMineX=boxMine.x;var boxMineY=boxMine.y;var boxMineZ=boxMine.z;var boxMaxe=box.max;var boxMaxeX=boxMaxe.x;var boxMaxeY=boxMaxe.y;var boxMaxeZ=boxMaxe.z;CollisionUtils._tempV30.x=planeNoreX>0?boxMineX:boxMaxeX;CollisionUtils._tempV30.y=planeNoreY>0?boxMineY:boxMaxeY;CollisionUtils._tempV30.z=planeNoreZ>0?boxMineZ:boxMaxeZ;CollisionUtils._tempV31.x=planeNoreX>0?boxMaxeX:boxMineX;CollisionUtils._tempV31.y=planeNoreY>0?boxMaxeY:boxMineY;CollisionUtils._tempV31.z=planeNoreZ>0?boxMaxeZ:boxMineZ;var distance=Vector3.dot(planeNor,CollisionUtils._tempV30);if(distance+planeD>0)return Plane.PlaneIntersectionType_Front;distance=Vector3.dot(planeNor,CollisionUtils._tempV31);if(distance+planeD<0)return Plane.PlaneIntersectionType_Back;return Plane.PlaneIntersectionType_Intersecting;};CollisionUtils.intersectsPlaneAndSphere=function intersectsPlaneAndSphere(plane,sphere){var sphereR=sphere.radius;var distance=Vector3.dot(plane.normal,sphere.center)+plane.distance;if(distance>sphereR)return Plane.PlaneIntersectionType_Front;if(distance<-sphereR)return Plane.PlaneIntersectionType_Back;return Plane.PlaneIntersectionType_Intersecting;};CollisionUtils.intersectsBoxAndBox=function intersectsBoxAndBox(box1,box2){var box1Mine=box1.min;var box1Maxe=box1.max;var box2Mine=box2.min;var box2Maxe=box2.max;if(box1Mine.x>box2Maxe.x||box2Mine.x>box1Maxe.x)return false;if(box1Mine.y>box2Maxe.y||box2Mine.y>box1Maxe.y)return false;if(box1Mine.z>box2Maxe.z||box2Mine.z>box1Maxe.z)return false;return true;};CollisionUtils.intersectsBoxAndSphere=function intersectsBoxAndSphere(box,sphere){var center=sphere.center;var radius=sphere.radius;var nearest=CollisionUtils._tempV30;Vector3.Clamp(center,box.min,box.max,nearest);var distance=Vector3.distanceSquared(center,nearest);return distance<=radius*radius;};CollisionUtils.intersectsSphereAndSphere=function intersectsSphereAndSphere(sphere1,sphere2){var radiisum=sphere1.radius+sphere2.radius;return Vector3.distanceSquared(sphere1.center,sphere2.center)<=radiisum*radiisum;};CollisionUtils.boxContainsPoint=function boxContainsPoint(box,point){var boxMine=box.min;var boxMaxe=box.max;if(boxMine.x<=point.x&&boxMaxe.x>=point.x&&boxMine.y<=point.y&&boxMaxe.y>=point.y&&boxMine.z<=point.z&&boxMaxe.z>=point.z)return ContainmentType.Contains;return ContainmentType.Disjoint;};CollisionUtils.boxContainsBox=function boxContainsBox(box1,box2){var box1Mine=box1.min;var box1MineX=box1Mine.x;var box1MineY=box1Mine.y;var box1MineZ=box1Mine.z;var box1Maxe=box1.max;var box1MaxeX=box1Maxe.x;var box1MaxeY=box1Maxe.y;var box1MaxeZ=box1Maxe.z;var box2Mine=box2.min;var box2MineX=box2Mine.x;var box2MineY=box2Mine.y;var box2MineZ=box2Mine.z;var box2Maxe=box2.max;var box2MaxeX=box2Maxe.x;var box2MaxeY=box2Maxe.y;var box2MaxeZ=box2Maxe.z;if(box1MaxeX<box2MineX||box1MineX>box2MaxeX)return ContainmentType.Disjoint;if(box1MaxeY<box2MineY||box1MineY>box2MaxeY)return ContainmentType.Disjoint;if(box1MaxeZ<box2MineZ||box1MineZ>box2MaxeZ)return ContainmentType.Disjoint;if(box1MineX<=box2MineX&&box2MaxeX<=box1MaxeX&&box1MineY<=box2MineY&&box2MaxeY<=box1MaxeY&&box1MineZ<=box2MineZ&&box2MaxeZ<=box1MaxeZ){return ContainmentType.Contains;}return ContainmentType.Intersects;};CollisionUtils.boxContainsSphere=function boxContainsSphere(box,sphere){var boxMin=box.min;var boxMineX=boxMin.x;var boxMineY=boxMin.y;var boxMineZ=boxMin.z;var boxMax=box.max;var boxMaxeX=boxMax.x;var boxMaxeY=boxMax.y;var boxMaxeZ=boxMax.z;var sphereC=sphere.center;var sphereCeX=sphereC.x;var sphereCeY=sphereC.y;var sphereCeZ=sphereC.z;var sphereR=sphere.radius;Vector3.Clamp(sphereC,boxMin,boxMax,CollisionUtils._tempV30);var distance=Vector3.distanceSquared(sphereC,CollisionUtils._tempV30);if(distance>sphereR*sphereR)return ContainmentType.Disjoint;if(boxMineX+sphereR<=sphereCeX&&sphereCeX<=boxMaxeX-sphereR&&boxMaxeX-boxMineX>sphereR&&boxMineY+sphereR<=sphereCeY&&sphereCeY<=boxMaxeY-sphereR&&boxMaxeY-boxMineY>sphereR&&boxMineZ+sphereR<=sphereCeZ&&sphereCeZ<=boxMaxeZ-sphereR&&boxMaxeZ-boxMineZ>sphereR)return ContainmentType.Contains;return ContainmentType.Intersects;};CollisionUtils.sphereContainsPoint=function sphereContainsPoint(sphere,point){if(Vector3.distanceSquared(point,sphere.center)<=sphere.radius*sphere.radius)return ContainmentType.Contains;return ContainmentType.Disjoint;};CollisionUtils.sphereContainsTriangle=function sphereContainsTriangle(sphere,vertex1,vertex2,vertex3){var test1=CollisionUtils.sphereContainsPoint(sphere,vertex1);var test2=CollisionUtils.sphereContainsPoint(sphere,vertex2);var test3=CollisionUtils.sphereContainsPoint(sphere,vertex3);if(test1==ContainmentType.Contains&&test2==ContainmentType.Contains&&test3==ContainmentType.Contains)return ContainmentType.Contains;if(CollisionUtils.intersectsSphereAndTriangle(sphere,vertex1,vertex2,vertex3))return ContainmentType.Intersects;return ContainmentType.Disjoint;};CollisionUtils.sphereContainsBox=function sphereContainsBox(sphere,box){var sphereC=sphere.center;var sphereCeX=sphereC.x;var sphereCeY=sphereC.y;var sphereCeZ=sphereC.z;var sphereR=sphere.radius;var boxMin=box.min;var boxMineX=boxMin.x;var boxMineY=boxMin.y;var boxMineZ=boxMin.z;var boxMax=box.max;var boxMaxeX=boxMax.x;var boxMaxeY=boxMax.y;var boxMaxeZ=boxMax.z;var _tempV30e=CollisionUtils._tempV30;var _tempV30eX=_tempV30e.x;var _tempV30eY=_tempV30e.y;var _tempV30eZ=_tempV30e.z;if(!CollisionUtils.intersectsBoxAndSphere(box,sphere))return ContainmentType.Disjoint;var radiusSquared=sphereR*sphereR;_tempV30eX=sphereCeX-boxMineX;_tempV30eY=sphereCeY-boxMaxeY;_tempV30eZ=sphereCeZ-boxMaxeZ;if(Vector3.scalarLengthSquared(CollisionUtils._tempV30)>radiusSquared)return ContainmentType.Intersects;_tempV30eX=sphereCeX-boxMaxeX;_tempV30eY=sphereCeY-boxMaxeY;_tempV30eZ=sphereCeZ-boxMaxeZ;if(Vector3.scalarLengthSquared(CollisionUtils._tempV30)>radiusSquared)return ContainmentType.Intersects;_tempV30eX=sphereCeX-boxMaxeX;_tempV30eY=sphereCeY-boxMineY;_tempV30eZ=sphereCeZ-boxMaxeZ;if(Vector3.scalarLengthSquared(CollisionUtils._tempV30)>radiusSquared)return ContainmentType.Intersects;_tempV30eX=sphereCeX-boxMineX;_tempV30eY=sphereCeY-boxMineY;_tempV30eZ=sphereCeZ-boxMaxeZ;if(Vector3.scalarLengthSquared(CollisionUtils._tempV30)>radiusSquared)return ContainmentType.Intersects;_tempV30eX=sphereCeX-boxMineX;_tempV30eY=sphereCeY-boxMaxeY;_tempV30eZ=sphereCeZ-boxMineZ;if(Vector3.scalarLengthSquared(CollisionUtils._tempV30)>radiusSquared)return ContainmentType.Intersects;_tempV30eX=sphereCeX-boxMaxeX;_tempV30eY=sphereCeY-boxMaxeY;_tempV30eZ=sphereCeZ-boxMineZ;if(Vector3.scalarLengthSquared(CollisionUtils._tempV30)>radiusSquared)return ContainmentType.Intersects;_tempV30eX=sphereCeX-boxMaxeX;_tempV30eY=sphereCeY-boxMineY;_tempV30eZ=sphereCeZ-boxMineZ;if(Vector3.scalarLengthSquared(CollisionUtils._tempV30)>radiusSquared)return ContainmentType.Intersects;_tempV30eX=sphereCeX-boxMineX;_tempV30eY=sphereCeY-boxMineY;_tempV30eZ=sphereCeZ-boxMineZ;if(Vector3.scalarLengthSquared(CollisionUtils._tempV30)>radiusSquared)return ContainmentType.Intersects;return ContainmentType.Contains;};CollisionUtils.sphereContainsSphere=function sphereContainsSphere(sphere1,sphere2){var sphere1R=sphere1.radius;var sphere2R=sphere2.radius;var distance=Vector3.distance(sphere1.center,sphere2.center);if(sphere1R+sphere2R<distance)return ContainmentType.Disjoint;if(sphere1R-sphere2R<distance)return ContainmentType.Intersects;return ContainmentType.Contains;};CollisionUtils.closestPointPointTriangle=function closestPointPointTriangle(point,vertex1,vertex2,vertex3,out){Vector3.subtract(vertex2,vertex1,CollisionUtils._tempV30);Vector3.subtract(vertex3,vertex1,CollisionUtils._tempV31);Vector3.subtract(point,vertex1,CollisionUtils._tempV32);Vector3.subtract(point,vertex2,CollisionUtils._tempV33);Vector3.subtract(point,vertex3,CollisionUtils._tempV34);var d1=Vector3.dot(CollisionUtils._tempV30,CollisionUtils._tempV32);var d2=Vector3.dot(CollisionUtils._tempV31,CollisionUtils._tempV32);var d3=Vector3.dot(CollisionUtils._tempV30,CollisionUtils._tempV33);var d4=Vector3.dot(CollisionUtils._tempV31,CollisionUtils._tempV33);var d5=Vector3.dot(CollisionUtils._tempV30,CollisionUtils._tempV34);var d6=Vector3.dot(CollisionUtils._tempV31,CollisionUtils._tempV34);if(d1<=0&&d2<=0){vertex1.cloneTo(out);return;}if(d3>=0&&d4<=d3){vertex2.cloneTo(out);return;}var vc=d1*d4-d3*d2;if(vc<=0&&d1>=0&&d3<=0){var v=d1/(d1-d3);Vector3.scale(CollisionUtils._tempV30,v,out);Vector3.add(vertex1,out,out);return;}if(d6>=0&&d5<=d6){vertex3.cloneTo(out);return;}var vb=d5*d2-d1*d6;if(vb<=0&&d2>=0&&d6<=0){var w=d2/(d2-d6);Vector3.scale(CollisionUtils._tempV31,w,out);Vector3.add(vertex1,out,out);return;}var va=d3*d6-d5*d4;if(va<=0&&d4-d3>=0&&d5-d6>=0){var w3=(d4-d3)/(d4-d3+(d5-d6));Vector3.subtract(vertex3,vertex2,out);Vector3.scale(out,w3,out);Vector3.add(vertex2,out,out);return;}var denom=1/(va+vb+vc);var v2=vb*denom;var w2=vc*denom;Vector3.scale(CollisionUtils._tempV30,v2,CollisionUtils._tempV35);Vector3.scale(CollisionUtils._tempV31,w2,CollisionUtils._tempV36);Vector3.add(CollisionUtils._tempV35,CollisionUtils._tempV36,out);Vector3.add(vertex1,out,out);};CollisionUtils.closestPointPlanePoint=function closestPointPlanePoint(plane,point,out){var planeN=plane.normal;var t=Vector3.dot(planeN,point)-plane.distance;Vector3.scale(planeN,t,CollisionUtils._tempV30);Vector3.subtract(point,CollisionUtils._tempV30,out);};CollisionUtils.closestPointBoxPoint=function closestPointBoxPoint(box,point,out){Vector3.max(point,box.min,CollisionUtils._tempV30);Vector3.min(CollisionUtils._tempV30,box.max,out);};CollisionUtils.closestPointSpherePoint=function closestPointSpherePoint(sphere,point,out){var sphereC=sphere.center;Vector3.subtract(point,sphereC,out);Vector3.normalize(out,out);Vector3.scale(out,sphere.radius,out);Vector3.add(out,sphereC,out);};CollisionUtils.closestPointSphereSphere=function closestPointSphereSphere(sphere1,sphere2,out){var sphere1C=sphere1.center;Vector3.subtract(sphere2.center,sphere1C,out);Vector3.normalize(out,out);Vector3.scale(out,sphere1.radius,out);Vector3.add(out,sphere1C,out);};return CollisionUtils;}();CollisionUtils._tempV30=new Vector3();CollisionUtils._tempV31=new Vector3();CollisionUtils._tempV32=new Vector3();CollisionUtils._tempV33=new Vector3();CollisionUtils._tempV34=new Vector3();CollisionUtils._tempV35=new Vector3();CollisionUtils._tempV36=new Vector3();(function(FrustumCorner){FrustumCorner[FrustumCorner["FarBottomLeft"]=0]="FarBottomLeft";FrustumCorner[FrustumCorner["FarTopLeft"]=1]="FarTopLeft";FrustumCorner[FrustumCorner["FarTopRight"]=2]="FarTopRight";FrustumCorner[FrustumCorner["FarBottomRight"]=3]="FarBottomRight";FrustumCorner[FrustumCorner["nearBottomLeft"]=4]="nearBottomLeft";FrustumCorner[FrustumCorner["nearTopLeft"]=5]="nearTopLeft";FrustumCorner[FrustumCorner["nearTopRight"]=6]="nearTopRight";FrustumCorner[FrustumCorner["nearBottomRight"]=7]="nearBottomRight";FrustumCorner[FrustumCorner["unknown"]=8]="unknown";})(exports.FrustumCorner||(exports.FrustumCorner={}));var BoundFrustum=/*#__PURE__*/function(){function BoundFrustum(matrix){this._matrix=matrix;this._near=new Plane(new Vector3());this._far=new Plane(new Vector3());this._left=new Plane(new Vector3());this._right=new Plane(new Vector3());this._top=new Plane(new Vector3());this._bottom=new Plane(new Vector3());BoundFrustum.getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom);}BoundFrustum.getPlanesFromMatrix=function getPlanesFromMatrix(m,np,fp,lp,rp,tp,bp){var matrixE=m.elements;var m11=matrixE[0];var m12=matrixE[1];var m13=matrixE[2];var m14=matrixE[3];var m21=matrixE[4];var m22=matrixE[5];var m23=matrixE[6];var m24=matrixE[7];var m31=matrixE[8];var m32=matrixE[9];var m33=matrixE[10];var m34=matrixE[11];var m41=matrixE[12];var m42=matrixE[13];var m43=matrixE[14];var m44=matrixE[15];var nearNorE=np.normal;nearNorE.x=m13;nearNorE.y=m23;nearNorE.z=m33;np.distance=m43;np.normalize();var farNorE=fp.normal;farNorE.x=m14-m13;farNorE.y=m24-m23;farNorE.z=m34-m33;fp.distance=m44-m43;fp.normalize();var leftNorE=lp.normal;leftNorE.x=m14+m11;leftNorE.y=m24+m21;leftNorE.z=m34+m31;lp.distance=m44+m41;lp.normalize();var rightNorE=rp.normal;rightNorE.x=m14-m11;rightNorE.y=m24-m21;rightNorE.z=m34-m31;rp.distance=m44-m41;rp.normalize();var topNorE=tp.normal;topNorE.x=m14-m12;topNorE.y=m24-m22;topNorE.z=m34-m32;tp.distance=m44-m42;tp.normalize();var bottomNorE=bp.normal;bottomNorE.x=m14+m12;bottomNorE.y=m24+m22;bottomNorE.z=m34+m32;bp.distance=m44+m42;bp.normalize();};var _proto64=BoundFrustum.prototype;_proto64.equalsBoundFrustum=function equalsBoundFrustum(other){return this._matrix.equalsOtherMatrix(other.matrix);};_proto64.equalsObj=function equalsObj(obj){if(obj instanceof BoundFrustum){var bf=obj;return this.equalsBoundFrustum(bf);}return false;};_proto64.getPlane=function getPlane(index){switch(index){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null;}};BoundFrustum.get3PlaneInterPoint=function get3PlaneInterPoint(p1,p2,p3,out){var p1Nor=p1.normal;var p2Nor=p2.normal;var p3Nor=p3.normal;Vector3.cross(p2Nor,p3Nor,BoundFrustum._tempV30);Vector3.cross(p3Nor,p1Nor,BoundFrustum._tempV31);Vector3.cross(p1Nor,p2Nor,BoundFrustum._tempV32);var a=Vector3.dot(p1Nor,BoundFrustum._tempV30);var b=Vector3.dot(p2Nor,BoundFrustum._tempV31);var c=Vector3.dot(p3Nor,BoundFrustum._tempV32);Vector3.scale(BoundFrustum._tempV30,-p1.distance/a,BoundFrustum._tempV33);Vector3.scale(BoundFrustum._tempV31,-p2.distance/b,BoundFrustum._tempV34);Vector3.scale(BoundFrustum._tempV32,-p3.distance/c,BoundFrustum._tempV35);Vector3.add(BoundFrustum._tempV33,BoundFrustum._tempV34,BoundFrustum._tempV36);Vector3.add(BoundFrustum._tempV35,BoundFrustum._tempV36,out);};_proto64.getCorners=function getCorners(corners){BoundFrustum.get3PlaneInterPoint(this._near,this._bottom,this._right,corners[exports.FrustumCorner.nearBottomRight]);BoundFrustum.get3PlaneInterPoint(this._near,this._top,this._right,corners[exports.FrustumCorner.nearTopRight]);BoundFrustum.get3PlaneInterPoint(this._near,this._top,this._left,corners[exports.FrustumCorner.nearTopLeft]);BoundFrustum.get3PlaneInterPoint(this._near,this._bottom,this._left,corners[exports.FrustumCorner.nearBottomLeft]);BoundFrustum.get3PlaneInterPoint(this._far,this._bottom,this._right,corners[exports.FrustumCorner.FarBottomRight]);BoundFrustum.get3PlaneInterPoint(this._far,this._top,this._right,corners[exports.FrustumCorner.FarTopRight]);BoundFrustum.get3PlaneInterPoint(this._far,this._top,this._left,corners[exports.FrustumCorner.FarTopLeft]);BoundFrustum.get3PlaneInterPoint(this._far,this._bottom,this._left,corners[exports.FrustumCorner.FarBottomLeft]);};_proto64.containsPoint=function containsPoint(point){var result=Plane.PlaneIntersectionType_Front;var planeResult=Plane.PlaneIntersectionType_Front;for(var i=0;i<6;i++){switch(i){case 0:planeResult=CollisionUtils.intersectsPlaneAndPoint(this._near,point);break;case 1:planeResult=CollisionUtils.intersectsPlaneAndPoint(this._far,point);break;case 2:planeResult=CollisionUtils.intersectsPlaneAndPoint(this._left,point);break;case 3:planeResult=CollisionUtils.intersectsPlaneAndPoint(this._right,point);break;case 4:planeResult=CollisionUtils.intersectsPlaneAndPoint(this._top,point);break;case 5:planeResult=CollisionUtils.intersectsPlaneAndPoint(this._bottom,point);break;}switch(planeResult){case Plane.PlaneIntersectionType_Back:return ContainmentType.Disjoint;case Plane.PlaneIntersectionType_Intersecting:result=Plane.PlaneIntersectionType_Intersecting;break;}}switch(result){case Plane.PlaneIntersectionType_Intersecting:return ContainmentType.Intersects;default:return ContainmentType.Contains;}};_proto64.intersects=function intersects(box){var min=box.min;var max=box.max;var minX=min.x;var minY=min.y;var minZ=min.z;var maxX=max.x;var maxY=max.y;var maxZ=max.z;var nearNormal=this._near.normal;if(this._near.distance+nearNormal.x*(nearNormal.x<0?minX:maxX)+nearNormal.y*(nearNormal.y<0?minY:maxY)+nearNormal.z*(nearNormal.z<0?minZ:maxZ)<0)return false;var leftNormal=this._left.normal;if(this._left.distance+leftNormal.x*(leftNormal.x<0?minX:maxX)+leftNormal.y*(leftNormal.y<0?minY:maxY)+leftNormal.z*(leftNormal.z<0?minZ:maxZ)<0)return false;var rightNormal=this._right.normal;if(this._right.distance+rightNormal.x*(rightNormal.x<0?minX:maxX)+rightNormal.y*(rightNormal.y<0?minY:maxY)+rightNormal.z*(rightNormal.z<0?minZ:maxZ)<0)return false;var bottomNormal=this._bottom.normal;if(this._bottom.distance+bottomNormal.x*(bottomNormal.x<0?minX:maxX)+bottomNormal.y*(bottomNormal.y<0?minY:maxY)+bottomNormal.z*(bottomNormal.z<0?minZ:maxZ)<0)return false;var topNormal=this._top.normal;if(this._top.distance+topNormal.x*(topNormal.x<0?minX:maxX)+topNormal.y*(topNormal.y<0?minY:maxY)+topNormal.z*(topNormal.z<0?minZ:maxZ)<0)return false;var farNormal=this._far.normal;if(this._far.distance+farNormal.x*(farNormal.x<0?minX:maxX)+farNormal.y*(farNormal.y<0?minY:maxY)+farNormal.z*(farNormal.z<0?minZ:maxZ)<0)return false;return true;};_proto64.containsBoundBox=function containsBoundBox(box){var p=BoundFrustum._tempV30,n=BoundFrustum._tempV31;var boxMin=box.min;var boxMax=box.max;var result=ContainmentType.Contains;for(var i=0;i<6;i++){var plane=this.getPlane(i);var planeNor=plane.normal;if(planeNor.x>=0){p.x=boxMax.x;n.x=boxMin.x;}else {p.x=boxMin.x;n.x=boxMax.x;}if(planeNor.y>=0){p.y=boxMax.y;n.y=boxMin.y;}else {p.y=boxMin.y;n.y=boxMax.y;}if(planeNor.z>=0){p.z=boxMax.z;n.z=boxMin.z;}else {p.z=boxMin.z;n.z=boxMax.z;}if(CollisionUtils.intersectsPlaneAndPoint(plane,p)===Plane.PlaneIntersectionType_Back)return ContainmentType.Disjoint;if(CollisionUtils.intersectsPlaneAndPoint(plane,n)===Plane.PlaneIntersectionType_Back)result=ContainmentType.Intersects;}return result;};_proto64.containsBoundSphere=function containsBoundSphere(sphere){var result=Plane.PlaneIntersectionType_Front;var planeResult=Plane.PlaneIntersectionType_Front;for(var i=0;i<6;i++){switch(i){case 0:planeResult=CollisionUtils.intersectsPlaneAndSphere(this._near,sphere);break;case 1:planeResult=CollisionUtils.intersectsPlaneAndSphere(this._far,sphere);break;case 2:planeResult=CollisionUtils.intersectsPlaneAndSphere(this._left,sphere);break;case 3:planeResult=CollisionUtils.intersectsPlaneAndSphere(this._right,sphere);break;case 4:planeResult=CollisionUtils.intersectsPlaneAndSphere(this._top,sphere);break;case 5:planeResult=CollisionUtils.intersectsPlaneAndSphere(this._bottom,sphere);break;}switch(planeResult){case Plane.PlaneIntersectionType_Back:return ContainmentType.Disjoint;case Plane.PlaneIntersectionType_Intersecting:result=Plane.PlaneIntersectionType_Intersecting;break;}}switch(result){case Plane.PlaneIntersectionType_Intersecting:return ContainmentType.Intersects;default:return ContainmentType.Contains;}};_createClass(BoundFrustum,[{key:"matrix",get:function get(){return this._matrix;},set:function set(matrix){matrix.cloneTo(this._matrix);BoundFrustum.getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom);}},{key:"near",get:function get(){return this._near;}},{key:"far",get:function get(){return this._far;}},{key:"left",get:function get(){return this._left;}},{key:"right",get:function get(){return this._right;}},{key:"top",get:function get(){return this._top;}},{key:"bottom",get:function get(){return this._bottom;}}]);return BoundFrustum;}();BoundFrustum._tempV30=new Vector3();BoundFrustum._tempV31=new Vector3();BoundFrustum._tempV32=new Vector3();BoundFrustum._tempV33=new Vector3();BoundFrustum._tempV34=new Vector3();BoundFrustum._tempV35=new Vector3();BoundFrustum._tempV36=new Vector3();var Viewport=/*#__PURE__*/function(){function Viewport(x,y,width,height){this.minDepth=0.0;this.maxDepth=1.0;this.x=x;this.y=y;this.width=width;this.height=height;}var _proto65=Viewport.prototype;_proto65.project=function project(source,matrix,out){Vector3.transformV3ToV4(source,matrix,out);var x=out.x,y=out.y,z=out.z;var w=out.w;if(w!==1.0){x=x/w;y=y/w;z=z/w;}out.x=(x+1.0)*0.5*this.width+this.x;out.y=(-y+1.0)*0.5*this.height+this.y;out.z=z*(this.maxDepth-this.minDepth)+this.minDepth;};_proto65.unprojectFromMat=function unprojectFromMat(source,matrix,out){var matrixEleme=matrix.elements;out.x=(source.x-this.x)/this.width*2.0-1.0;out.y=-((source.y-this.y)/this.height*2.0-1.0);out.z=(source.z-this.minDepth)/(this.maxDepth-this.minDepth);var a=out.x*matrixEleme[3]+out.y*matrixEleme[7]+out.z*matrixEleme[11]+matrixEleme[15];Vector3.transformV3ToV3(out,matrix,out);if(a!==1.0){out.x=out.x/a;out.y=out.y/a;out.z=out.z/a;}};_proto65.unprojectFromWVP=function unprojectFromWVP(source,projection,view,world,out){Matrix4x4.multiply(projection,view,Viewport._tempMatrix4x4);world&&Matrix4x4.multiply(Viewport._tempMatrix4x4,world,Viewport._tempMatrix4x4);Viewport._tempMatrix4x4.invert(Viewport._tempMatrix4x4);this.unprojectFromMat(source,Viewport._tempMatrix4x4,out);};_proto65.cloneTo=function cloneTo(out){out.x=this.x;out.y=this.y;out.width=this.width;out.height=this.height;out.minDepth=this.minDepth;out.maxDepth=this.maxDepth;};return Viewport;}();Viewport._tempMatrix4x4=new Matrix4x4();var Picker=/*#__PURE__*/function(){function Picker(){}Picker.calculateCursorRay=function calculateCursorRay(point,viewPort,projectionMatrix,viewMatrix,world,out){var x=point.x;var y=point.y;var nearSource=Picker._tempVector30;var nerSourceE=nearSource;nerSourceE.x=x;nerSourceE.y=y;nerSourceE.z=viewPort.minDepth;var farSource=Picker._tempVector31;var farSourceE=farSource;farSourceE.x=x;farSourceE.y=y;farSourceE.z=viewPort.maxDepth;var nearPoint=out.origin;var farPoint=Picker._tempVector32;viewPort.unprojectFromWVP(nearSource,projectionMatrix,viewMatrix,world,nearPoint);viewPort.unprojectFromWVP(farSource,projectionMatrix,viewMatrix,world,farPoint);var outDire=out.direction;outDire.x=farPoint.x-nearPoint.x;outDire.y=farPoint.y-nearPoint.y;outDire.z=farPoint.z-nearPoint.z;Vector3.normalize(out.direction,out.direction);};Picker.rayIntersectsTriangle=function rayIntersectsTriangle(ray,vertex1,vertex2,vertex3){var result;var edge1=Picker._tempVector30,edge2=Picker._tempVector31;Vector3.subtract(vertex2,vertex1,edge1);Vector3.subtract(vertex3,vertex1,edge2);var directionCrossEdge2=Picker._tempVector32;Vector3.cross(ray.direction,edge2,directionCrossEdge2);var determinant;determinant=Vector3.dot(edge1,directionCrossEdge2);if(determinant>-Number.MIN_VALUE&&determinant<Number.MIN_VALUE){result=Number.NaN;return result;}var inverseDeterminant=1.0/determinant;var distanceVector=Picker._tempVector33;Vector3.subtract(ray.origin,vertex1,distanceVector);var triangleU;triangleU=Vector3.dot(distanceVector,directionCrossEdge2);triangleU*=inverseDeterminant;if(triangleU<0||triangleU>1){result=Number.NaN;return result;}var distanceCrossEdge1=Picker._tempVector34;Vector3.cross(distanceVector,edge1,distanceCrossEdge1);var triangleV;triangleV=Vector3.dot(ray.direction,distanceCrossEdge1);triangleV*=inverseDeterminant;if(triangleV<0||triangleU+triangleV>1){result=Number.NaN;return result;}var rayDistance;rayDistance=Vector3.dot(edge2,distanceCrossEdge1);rayDistance*=inverseDeterminant;if(rayDistance<0){result=Number.NaN;return result;}result=rayDistance;return result;};return Picker;}();Picker._tempVector30=new Vector3();Picker._tempVector31=new Vector3();Picker._tempVector32=new Vector3();Picker._tempVector33=new Vector3();Picker._tempVector34=new Vector3();var BufferState=/*#__PURE__*/function(_Laya$BufferStateBase){_inheritsLoose(BufferState,_Laya$BufferStateBase);function BufferState(){return _Laya$BufferStateBase.call(this)||this;}var _proto66=BufferState.prototype;_proto66.applyVertexBuffer=function applyVertexBuffer(vertexBuffer){if(Laya.BufferStateBase._curBindedBufferState===this){var gl=Laya.LayaGL.instance;var verDec=vertexBuffer.vertexDeclaration;var valueData=verDec._shaderValues.getData();this.vertexDeclaration=verDec;vertexBuffer.bind();for(var k in valueData){var loc=parseInt(k);var attribute=valueData[k];gl.enableVertexAttribArray(loc);gl.vertexAttribPointer(loc,attribute[0],attribute[1],!!attribute[2],attribute[3],attribute[4]);}}else {throw "BufferState: must call bind() function first.";}};_proto66.applyVertexBuffers=function applyVertexBuffers(vertexBuffers){if(Laya.BufferStateBase._curBindedBufferState===this){var gl=Laya.LayaGL.instance;for(var i=0,n=vertexBuffers.length;i<n;i++){var verBuf=vertexBuffers[i];var verDec=verBuf.vertexDeclaration;var valueData=verDec._shaderValues.getData();verBuf.bind();for(var k in valueData){var loc=parseInt(k);var attribute=valueData[k];gl.enableVertexAttribArray(loc);gl.vertexAttribPointer(loc,attribute[0],attribute[1],!!attribute[2],attribute[3],attribute[4]);}}}else {throw "BufferState: must call bind() function first.";}};_proto66.applyInstanceVertexBuffer=function applyInstanceVertexBuffer(vertexBuffer){if(Laya.LayaGL.layaGPUInstance.supportInstance()){if(Laya.BufferStateBase._curBindedBufferState===this){var gl=Laya.LayaGL.instance;var verDec=vertexBuffer.vertexDeclaration;var valueData=verDec._shaderValues.getData();vertexBuffer.bind();for(var k in valueData){var loc=parseInt(k);var attribute=valueData[k];gl.enableVertexAttribArray(loc);gl.vertexAttribPointer(loc,attribute[0],attribute[1],!!attribute[2],attribute[3],attribute[4]);Laya.LayaGL.layaGPUInstance.vertexAttribDivisor(loc,1);}}else {throw "BufferState: must call bind() function first.";}}};_proto66.applyIndexBuffer=function applyIndexBuffer(indexBuffer){if(Laya.BufferStateBase._curBindedBufferState===this){if(this._bindedIndexBuffer!==indexBuffer){indexBuffer._bindForVAO();this._bindedIndexBuffer=indexBuffer;}}else {throw "BufferState: must call bind() function first.";}};return BufferState;}(Laya.BufferStateBase);(function(IndexFormat){IndexFormat[IndexFormat["UInt8"]=0]="UInt8";IndexFormat[IndexFormat["UInt16"]=1]="UInt16";IndexFormat[IndexFormat["UInt32"]=2]="UInt32";})(exports.IndexFormat||(exports.IndexFormat={}));var IndexBuffer3D=/*#__PURE__*/function(_Laya$Buffer){_inheritsLoose(IndexBuffer3D,_Laya$Buffer);function IndexBuffer3D(indexType,indexCount,bufferUsage,canRead){var _this27;if(bufferUsage===void 0){bufferUsage=0x88E4;}if(canRead===void 0){canRead=false;}_this27=_Laya$Buffer.call(this)||this;_this27._indexType=indexType;_this27._indexCount=indexCount;_this27._bufferUsage=bufferUsage;_this27._bufferType=Laya.LayaGL.instance.ELEMENT_ARRAY_BUFFER;_this27._canRead=canRead;switch(indexType){case exports.IndexFormat.UInt32:_this27._indexTypeByteCount=4;break;case exports.IndexFormat.UInt16:_this27._indexTypeByteCount=2;break;case exports.IndexFormat.UInt8:_this27._indexTypeByteCount=1;break;default:throw new Error("unidentification index type.");}var byteLength=_this27._indexTypeByteCount*indexCount;var curBufSta=Laya.BufferStateBase._curBindedBufferState;_this27._byteLength=byteLength;if(curBufSta){if(curBufSta._bindedIndexBuffer===_assertThisInitialized(_this27)){Laya.LayaGL.instance.bufferData(_this27._bufferType,byteLength,_this27._bufferUsage);}else {curBufSta.unBind();_this27.bind();Laya.LayaGL.instance.bufferData(_this27._bufferType,byteLength,_this27._bufferUsage);curBufSta.bind();}}else {_this27.bind();Laya.LayaGL.instance.bufferData(_this27._bufferType,byteLength,_this27._bufferUsage);}if(canRead){switch(indexType){case exports.IndexFormat.UInt32:_this27._buffer=new Uint32Array(indexCount);break;case exports.IndexFormat.UInt16:_this27._buffer=new Uint16Array(indexCount);break;case exports.IndexFormat.UInt8:_this27._buffer=new Uint8Array(indexCount);break;}}return _this27;}var _proto67=IndexBuffer3D.prototype;_proto67._bindForVAO=function _bindForVAO(){if(Laya.BufferStateBase._curBindedBufferState){var gl=Laya.LayaGL.instance;gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this._glBuffer);}else {throw "IndexBuffer3D: must bind current BufferState.";}};_proto67.bind=function bind(){if(Laya.BufferStateBase._curBindedBufferState){throw "IndexBuffer3D: must unbind current BufferState.";}else {if(Laya.Buffer._bindedIndexBuffer!==this._glBuffer){var gl=Laya.LayaGL.instance;gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this._glBuffer);Laya.Buffer._bindedIndexBuffer=this._glBuffer;return true;}else {return false;}}};_proto67.setData=function setData(data,bufferOffset,dataStartIndex,dataCount){if(bufferOffset===void 0){bufferOffset=0;}if(dataStartIndex===void 0){dataStartIndex=0;}if(dataCount===void 0){dataCount=4294967295;}var byteCount=this._indexTypeByteCount;if(dataStartIndex!==0||dataCount!==4294967295){switch(this._indexType){case exports.IndexFormat.UInt32:data=new Uint32Array(data.buffer,dataStartIndex*byteCount,dataCount);break;case exports.IndexFormat.UInt16:data=new Uint16Array(data.buffer,dataStartIndex*byteCount,dataCount);break;case exports.IndexFormat.UInt8:data=new Uint8Array(data.buffer,dataStartIndex*byteCount,dataCount);break;}}var curBufSta=Laya.BufferStateBase._curBindedBufferState;if(curBufSta){if(curBufSta._bindedIndexBuffer===this){Laya.LayaGL.instance.bufferSubData(this._bufferType,bufferOffset*byteCount,data);}else {curBufSta.unBind();this.bind();Laya.LayaGL.instance.bufferSubData(this._bufferType,bufferOffset*byteCount,data);curBufSta.bind();}}else {this.bind();Laya.LayaGL.instance.bufferSubData(this._bufferType,bufferOffset*byteCount,data);}if(this._canRead){if(bufferOffset!==0||dataStartIndex!==0||dataCount!==4294967295){var maxLength=this._buffer.length-bufferOffset;if(dataCount>maxLength)dataCount=maxLength;for(var i=0;i<dataCount;i++){this._buffer[bufferOffset+i]=data[i];}}else {this._buffer=data;}}};_proto67.getData=function getData(){if(this._canRead)return this._buffer;else throw new Error("Can't read data from VertexBuffer with only write flag!");};_proto67.destroy=function destroy(){_Laya$Buffer.prototype.destroy.call(this);this._buffer=null;};_createClass(IndexBuffer3D,[{key:"indexType",get:function get(){return this._indexType;}},{key:"indexTypeByteCount",get:function get(){return this._indexTypeByteCount;}},{key:"indexCount",get:function get(){return this._indexCount;}},{key:"canRead",get:function get(){return this._canRead;}}]);return IndexBuffer3D;}(Laya.Buffer);var VertexElementFormat=/*#__PURE__*/function(){function VertexElementFormat(){}VertexElementFormat.__init__=function __init__(){var gl=Laya.LayaGL.instance;VertexElementFormat._elementInfos={"single":[1,gl.FLOAT,0],"vector2":[2,gl.FLOAT,0],"vector3":[3,gl.FLOAT,0],"vector4":[4,gl.FLOAT,0],"color":[4,gl.FLOAT,0],"byte4":[4,gl.UNSIGNED_BYTE,0],"short2":[2,gl.FLOAT,0],"short4":[4,gl.FLOAT,0],"normalizedshort2":[2,gl.FLOAT,0],"normalizedshort4":[4,gl.FLOAT,0],"halfvector2":[2,gl.FLOAT,0],"halfvector4":[4,gl.FLOAT,0]};};VertexElementFormat.getElementInfos=function getElementInfos(element){var info=VertexElementFormat._elementInfos[element];if(info)return info;else throw "VertexElementFormat: this vertexElementFormat is not implement.";};return VertexElementFormat;}();VertexElementFormat.Single="single";VertexElementFormat.Vector2="vector2";VertexElementFormat.Vector3="vector3";VertexElementFormat.Vector4="vector4";VertexElementFormat.Color="color";VertexElementFormat.Byte4="byte4";VertexElementFormat.Short2="short2";VertexElementFormat.Short4="short4";VertexElementFormat.NormalizedShort2="normalizedshort2";VertexElementFormat.NormalizedShort4="normalizedshort4";VertexElementFormat.HalfVector2="halfvector2";VertexElementFormat.HalfVector4="halfvector4";var VertexDeclaration=/*#__PURE__*/function(){function VertexDeclaration(vertexStride,vertexElements){this._id=++VertexDeclaration._uniqueIDCounter;this._vertexElementsDic={};this._vertexStride=vertexStride;this._vertexElements=vertexElements;var count=vertexElements.length;this._shaderValues=new ShaderData(null);for(var j=0;j<count;j++){var vertexElement=vertexElements[j];var name=vertexElement._elementUsage;this._vertexElementsDic[name]=vertexElement;var value=new Int32Array(5);var elmentInfo=VertexElementFormat.getElementInfos(vertexElement._elementFormat);value[0]=elmentInfo[0];value[1]=elmentInfo[1];value[2]=elmentInfo[2];value[3]=this._vertexStride;value[4]=vertexElement._offset;this._shaderValues.setAttribute(name,value);}}var _proto68=VertexDeclaration.prototype;_proto68.getVertexElementByIndex=function getVertexElementByIndex(index){return this._vertexElements[index];};_proto68.getVertexElementByUsage=function getVertexElementByUsage(usage){return this._vertexElementsDic[usage];};_createClass(VertexDeclaration,[{key:"id",get:function get(){return this._id;}},{key:"vertexStride",get:function get(){return this._vertexStride;}},{key:"vertexElementCount",get:function get(){return this._vertexElements.length;}}]);return VertexDeclaration;}();VertexDeclaration._uniqueIDCounter=1;var VertexElement=/*#__PURE__*/function(){function VertexElement(offset,elementFormat,elementUsage){this._offset=offset;this._elementFormat=elementFormat;this._elementUsage=elementUsage;}_createClass(VertexElement,[{key:"offset",get:function get(){return this._offset;}},{key:"elementFormat",get:function get(){return this._elementFormat;}},{key:"elementUsage",get:function get(){return this._elementUsage;}}]);return VertexElement;}();var VertexMesh=/*#__PURE__*/function(){function VertexMesh(){}VertexMesh.__init__=function __init__(){VertexMesh.instanceWorldMatrixDeclaration=new VertexDeclaration(64,[new VertexElement(0,VertexElementFormat.Vector4,VertexMesh.MESH_WORLDMATRIX_ROW0),new VertexElement(16,VertexElementFormat.Vector4,VertexMesh.MESH_WORLDMATRIX_ROW1),new VertexElement(32,VertexElementFormat.Vector4,VertexMesh.MESH_WORLDMATRIX_ROW2),new VertexElement(48,VertexElementFormat.Vector4,VertexMesh.MESH_WORLDMATRIX_ROW3)]);VertexMesh.instanceMVPMatrixDeclaration=new VertexDeclaration(64,[new VertexElement(0,VertexElementFormat.Vector4,VertexMesh.MESH_MVPMATRIX_ROW0),new VertexElement(16,VertexElementFormat.Vector4,VertexMesh.MESH_MVPMATRIX_ROW1),new VertexElement(32,VertexElementFormat.Vector4,VertexMesh.MESH_MVPMATRIX_ROW2),new VertexElement(48,VertexElementFormat.Vector4,VertexMesh.MESH_MVPMATRIX_ROW3)]);VertexMesh.instanceSimpleAnimatorDeclaration=new VertexDeclaration(16,[new VertexElement(0,VertexElementFormat.Vector4,VertexMesh.MESH_SIMPLEANIMATOR)]);};VertexMesh.getVertexDeclaration=function getVertexDeclaration(vertexFlag,compatible){if(compatible===void 0){compatible=true;}var verDec=VertexMesh._vertexDeclarationMap[vertexFlag+(compatible?"_0":"_1")];if(!verDec){var subFlags=vertexFlag.split(",");var offset=0;var elements=[];for(var i=0,n=subFlags.length;i<n;i++){var element;switch(subFlags[i]){case"POSITION":element=new VertexElement(offset,VertexElementFormat.Vector3,VertexMesh.MESH_POSITION0);offset+=12;break;case"NORMAL":element=new VertexElement(offset,VertexElementFormat.Vector3,VertexMesh.MESH_NORMAL0);offset+=12;break;case"COLOR":element=new VertexElement(offset,VertexElementFormat.Vector4,VertexMesh.MESH_COLOR0);offset+=16;break;case"UV":element=new VertexElement(offset,VertexElementFormat.Vector2,VertexMesh.MESH_TEXTURECOORDINATE0);offset+=8;break;case"UV1":element=new VertexElement(offset,VertexElementFormat.Vector2,VertexMesh.MESH_TEXTURECOORDINATE1);offset+=8;break;case"BLENDWEIGHT":element=new VertexElement(offset,VertexElementFormat.Vector4,VertexMesh.MESH_BLENDWEIGHT0);offset+=16;break;case"BLENDINDICES":if(compatible){element=new VertexElement(offset,VertexElementFormat.Vector4,VertexMesh.MESH_BLENDINDICES0);offset+=16;}else {element=new VertexElement(offset,VertexElementFormat.Byte4,VertexMesh.MESH_BLENDINDICES0);offset+=4;}break;case"TANGENT":element=new VertexElement(offset,VertexElementFormat.Vector4,VertexMesh.MESH_TANGENT0);offset+=16;break;default:throw "VertexMesh: unknown vertex flag.";}elements.push(element);}verDec=new VertexDeclaration(offset,elements);VertexMesh._vertexDeclarationMap[vertexFlag+(compatible?"_0":"_1")]=verDec;}return verDec;};return VertexMesh;}();VertexMesh.MESH_POSITION0=0;VertexMesh.MESH_COLOR0=1;VertexMesh.MESH_TEXTURECOORDINATE0=2;VertexMesh.MESH_NORMAL0=3;VertexMesh.MESH_TANGENT0=4;VertexMesh.MESH_BLENDINDICES0=5;VertexMesh.MESH_BLENDWEIGHT0=6;VertexMesh.MESH_TEXTURECOORDINATE1=7;VertexMesh.MESH_WORLDMATRIX_ROW0=8;VertexMesh.MESH_WORLDMATRIX_ROW1=9;VertexMesh.MESH_WORLDMATRIX_ROW2=10;VertexMesh.MESH_WORLDMATRIX_ROW3=11;VertexMesh.MESH_MVPMATRIX_ROW0=12;VertexMesh.MESH_MVPMATRIX_ROW1=13;VertexMesh.MESH_MVPMATRIX_ROW2=14;VertexMesh.MESH_MVPMATRIX_ROW3=15;VertexMesh.MESH_SIMPLEANIMATOR=7;VertexMesh._vertexDeclarationMap={};var VertexBuffer3D=/*#__PURE__*/function(_Laya$Buffer2){_inheritsLoose(VertexBuffer3D,_Laya$Buffer2);function VertexBuffer3D(byteLength,bufferUsage,canRead){var _this28;if(canRead===void 0){canRead=false;}_this28=_Laya$Buffer2.call(this)||this;_this28._vertexDeclaration=null;_this28._float32Reader=null;var gl=Laya.LayaGL.instance;_this28._bufferUsage=bufferUsage;_this28._bufferType=gl.ARRAY_BUFFER;_this28._canRead=canRead;_this28._byteLength=byteLength;_this28.bind();gl.bufferData(_this28._bufferType,_this28._byteLength,_this28._bufferUsage);if(canRead){_this28._buffer=new Uint8Array(byteLength);_this28._float32Reader=new Float32Array(_this28._buffer.buffer);}return _this28;}var _proto69=VertexBuffer3D.prototype;_proto69.bind=function bind(){if(Laya.Buffer._bindedVertexBuffer!==this._glBuffer){var gl=Laya.LayaGL.instance;gl.bindBuffer(gl.ARRAY_BUFFER,this._glBuffer);Laya.Buffer._bindedVertexBuffer=this._glBuffer;return true;}else {return false;}};_proto69.orphanStorage=function orphanStorage(){this.bind();Laya.LayaGL.instance.bufferData(this._bufferType,this._byteLength,this._bufferUsage);};_proto69.setData=function setData(buffer,bufferOffset,dataStartIndex,dataCount){if(bufferOffset===void 0){bufferOffset=0;}if(dataStartIndex===void 0){dataStartIndex=0;}if(dataCount===void 0){dataCount=Number.MAX_SAFE_INTEGER;}this.bind();var needSubData=dataStartIndex!==0||dataCount!==Number.MAX_SAFE_INTEGER;if(needSubData){var subData=new Uint8Array(buffer,dataStartIndex,dataCount);Laya.LayaGL.instance.bufferSubData(this._bufferType,bufferOffset,subData);if(this._canRead)this._buffer.set(subData,bufferOffset);}else {Laya.LayaGL.instance.bufferSubData(this._bufferType,bufferOffset,buffer);if(this._canRead)this._buffer.set(new Uint8Array(buffer),bufferOffset);}};_proto69.getUint8Data=function getUint8Data(){if(this._canRead)return this._buffer;else throw new Error("Can't read data from VertexBuffer with only write flag!");};_proto69.getFloat32Data=function getFloat32Data(){if(this._canRead)return this._float32Reader;else throw new Error("Can't read data from VertexBuffer with only write flag!");};_proto69.markAsUnreadbale=function markAsUnreadbale(){this._canRead=false;this._buffer=null;this._float32Reader=null;};_proto69.destroy=function destroy(){_Laya$Buffer2.prototype.destroy.call(this);this._buffer=null;this._float32Reader=null;this._vertexDeclaration=null;};_createClass(VertexBuffer3D,[{key:"vertexDeclaration",get:function get(){return this._vertexDeclaration;},set:function set(value){this._vertexDeclaration=value;}},{key:"canRead",get:function get(){return this._canRead;}}]);return VertexBuffer3D;}(Laya.Buffer);VertexBuffer3D.DATATYPE_FLOAT32ARRAY=0;VertexBuffer3D.DATATYPE_UINT8ARRAY=1;var SkyMesh=/*#__PURE__*/function(){function SkyMesh(){}var _proto70=SkyMesh.prototype;_proto70._render=function _render(state){};return SkyMesh;}();var SkyBox=/*#__PURE__*/function(_SkyMesh){_inheritsLoose(SkyBox,_SkyMesh);function SkyBox(){var _this29;_this29=_SkyMesh.call(this)||this;var gl=Laya.LayaGL.instance;var halfHeight=1.0;var halfWidth=1.0;var halfDepth=1.0;var vertices=new Float32Array([-halfDepth,halfHeight,-halfWidth,halfDepth,halfHeight,-halfWidth,halfDepth,halfHeight,halfWidth,-halfDepth,halfHeight,halfWidth,-halfDepth,-halfHeight,-halfWidth,halfDepth,-halfHeight,-halfWidth,halfDepth,-halfHeight,halfWidth,-halfDepth,-halfHeight,halfWidth]);var indices=new Uint8Array([0,1,2,2,3,0,4,7,6,6,5,4,0,3,7,7,4,0,1,5,6,6,2,1,3,2,6,6,7,3,0,4,5,5,1,0]);var verDec=VertexMesh.getVertexDeclaration("POSITION");_this29._vertexBuffer=new VertexBuffer3D(verDec.vertexStride*8,gl.STATIC_DRAW,false);_this29._vertexBuffer.vertexDeclaration=verDec;_this29._indexBuffer=new IndexBuffer3D(exports.IndexFormat.UInt8,36,gl.STATIC_DRAW,false);_this29._vertexBuffer.setData(vertices.buffer);_this29._indexBuffer.setData(indices);var bufferState=new BufferState();bufferState.bind();bufferState.applyVertexBuffer(_this29._vertexBuffer);bufferState.applyIndexBuffer(_this29._indexBuffer);bufferState.unBind();_this29._bufferState=bufferState;return _this29;}SkyBox.__init__=function __init__(){SkyBox.instance=new SkyBox();};var _proto71=SkyBox.prototype;_proto71._render=function _render(state){var gl=Laya.LayaGL.instance;gl.drawElements(gl.TRIANGLES,36,gl.UNSIGNED_BYTE,0);Laya.Stat.trianglesFaces+=12;Laya.Stat.renderBatches++;};return SkyBox;}(SkyMesh);var SkyRenderer=/*#__PURE__*/function(){function SkyRenderer(){this._mesh=SkyBox.instance;}var _proto72=SkyRenderer.prototype;_proto72._isAvailable=function _isAvailable(){return this._material&&this._mesh?true:false;};_proto72._render=function _render(context){if(this._material&&this._mesh){var gl=Laya.LayaGL.instance;var scene=context.scene;var cameraShaderValue=context.cameraShaderValue;var camera=context.camera;var noteValue=ShaderData._SET_RUNTIME_VALUE_MODE_REFERENCE_;Laya.ILaya.Render.supportWebGLPlusRendering&&ShaderData.setRuntimeValueMode(false);Laya.WebGLContext.setCullFace(gl,false);Laya.WebGLContext.setDepthFunc(gl,gl.LEQUAL);Laya.WebGLContext.setDepthMask(gl,false);var comDef=SkyRenderer._compileDefine;this._material._shaderValues._defineDatas.cloneTo(comDef);var shader=context.shader=this._material._shader.getSubShaderAt(0)._passes[0].withCompile(comDef);var switchShader=shader.bind();var switchShaderLoop=Laya.Stat.loopCount!==shader._uploadMark;var uploadScene=shader._uploadScene!==scene||switchShaderLoop;if(uploadScene||switchShader){shader.uploadUniforms(shader._sceneUniformParamsMap,scene._shaderValues,uploadScene);shader._uploadScene=scene;}var renderTex=camera._getRenderTexture();var uploadCamera=shader._uploadCameraShaderValue!==cameraShaderValue||switchShaderLoop;if(uploadCamera||switchShader){var viewMatrix=SkyRenderer._tempMatrix0;var projectionMatrix=SkyRenderer._tempMatrix1;camera.viewMatrix.cloneTo(viewMatrix);camera.projectionMatrix.cloneTo(projectionMatrix);viewMatrix.setTranslationVector(Vector3._ZERO);if(camera.orthographic)Matrix4x4.createPerspective(camera.fieldOfView,camera.aspectRatio,camera.nearPlane,camera.farPlane,projectionMatrix);var epsilon=1e-6;var yScale=1.0/Math.tan(3.1416*camera.fieldOfView/180*0.5);projectionMatrix.elements[0]=yScale/camera.aspectRatio;projectionMatrix.elements[5]=yScale;projectionMatrix.elements[10]=epsilon-1.0;projectionMatrix.elements[11]=-1.0;projectionMatrix.elements[14]=-0;camera._applyViewProject(context,viewMatrix,projectionMatrix);shader.uploadUniforms(shader._cameraUniformParamsMap,cameraShaderValue,uploadCamera);shader._uploadCameraShaderValue=cameraShaderValue;}var uploadMaterial=shader._uploadMaterial!==this._material||switchShaderLoop;if(uploadMaterial||switchShader){shader.uploadUniforms(shader._materialUniformParamsMap,this._material._shaderValues,uploadMaterial);shader._uploadMaterial=this._material;}this._mesh._bufferState.bind();this._mesh._render(context);Laya.ILaya.Render.supportWebGLPlusRendering&&ShaderData.setRuntimeValueMode(noteValue);Laya.WebGLContext.setDepthFunc(gl,gl.LESS);Laya.WebGLContext.setDepthMask(gl,true);camera._applyViewProject(context,camera.viewMatrix,camera.projectionMatrix);}};_proto72.destroy=function destroy(){if(this._material){this._material._removeReference();this._material=null;}};_createClass(SkyRenderer,[{key:"material",get:function get(){return this._material;},set:function set(value){if(this._material!==value){this._material&&this._material._removeReference();value&&value._addReference();this._material=value;}}},{key:"mesh",get:function get(){return this._mesh;},set:function set(value){if(this._mesh!==value){this._mesh=value;}}}]);return SkyRenderer;}();SkyRenderer._tempMatrix0=new Matrix4x4();SkyRenderer._tempMatrix1=new Matrix4x4();SkyRenderer._compileDefine=new DefineDatas();var Sprite3D=/*#__PURE__*/function(_Laya$Node){_inheritsLoose(Sprite3D,_Laya$Node);function Sprite3D(name,isStatic){var _this30;if(name===void 0){name=null;}if(isStatic===void 0){isStatic=false;}_this30=_Laya$Node.call(this)||this;_this30._needProcessCollisions=false;_this30._needProcessTriggers=false;_this30._id=++Sprite3D._uniqueIDCounter;_this30._transform=new Transform3D(_assertThisInitialized(_this30));_this30._isStatic=isStatic;_this30.layer=0;_this30.name=name?name:"New Sprite3D";return _this30;}Sprite3D.__init__=function __init__(){};Sprite3D.instantiate=function instantiate(original,parent,worldPositionStays,position,rotation){if(parent===void 0){parent=null;}if(worldPositionStays===void 0){worldPositionStays=true;}if(position===void 0){position=null;}if(rotation===void 0){rotation=null;}var destSprite3D=original.clone();parent&&parent.addChild(destSprite3D);var transform=destSprite3D.transform;if(worldPositionStays){var worldMatrix=transform.worldMatrix;original.transform.worldMatrix.cloneTo(worldMatrix);transform.worldMatrix=worldMatrix;}else {position&&(transform.position=position);rotation&&(transform.rotation=rotation);}return destSprite3D;};Sprite3D.load=function load(url,complete){Laya.Laya.loader.create(url,complete,null,Sprite3D.HIERARCHY);};var _proto73=Sprite3D.prototype;_proto73._setCreateURL=function _setCreateURL(url){this._url=Laya.URL.formatURL(url);};_proto73._changeAnimatorsToLinkSprite3D=function _changeAnimatorsToLinkSprite3D(sprite3D,isLink,path){var animator=this.getComponent(Animator);if(animator){if(!animator.avatar)sprite3D._changeAnimatorToLinkSprite3DNoAvatar(animator,isLink,path);}if(this._parent&&this._parent instanceof Sprite3D){path.unshift(this._parent.name);var p=this._parent;p._hierarchyAnimator&&p._changeAnimatorsToLinkSprite3D(sprite3D,isLink,path);}};_proto73._setHierarchyAnimator=function _setHierarchyAnimator(animator,parentAnimator){this._changeHierarchyAnimator(animator);this._changeAnimatorAvatar(animator.avatar);for(var i=0,n=this._children.length;i<n;i++){var child=this._children[i];child._hierarchyAnimator==parentAnimator&&child._setHierarchyAnimator(animator,parentAnimator);}};_proto73._clearHierarchyAnimator=function _clearHierarchyAnimator(animator,parentAnimator){this._changeHierarchyAnimator(parentAnimator);this._changeAnimatorAvatar(parentAnimator?parentAnimator.avatar:null);for(var i=0,n=this._children.length;i<n;i++){var child=this._children[i];child._hierarchyAnimator==animator&&child._clearHierarchyAnimator(animator,parentAnimator);}};_proto73._changeHierarchyAnimatorAvatar=function _changeHierarchyAnimatorAvatar(animator,avatar){this._changeAnimatorAvatar(avatar);for(var i=0,n=this._children.length;i<n;i++){var child=this._children[i];child._hierarchyAnimator==animator&&child._changeHierarchyAnimatorAvatar(animator,avatar);}};_proto73._changeAnimatorToLinkSprite3DNoAvatar=function _changeAnimatorToLinkSprite3DNoAvatar(animator,isLink,path){animator._handleSpriteOwnersBySprite(isLink,path,this);for(var i=0,n=this._children.length;i<n;i++){var child=this._children[i];var index=path.length;path.push(child.name);child._changeAnimatorToLinkSprite3DNoAvatar(animator,isLink,path);path.splice(index,1);}};_proto73._changeHierarchyAnimator=function _changeHierarchyAnimator(animator){this._hierarchyAnimator=animator;};_proto73._changeAnimatorAvatar=function _changeAnimatorAvatar(avatar){};_proto73._onAdded=function _onAdded(){if(this._parent instanceof Sprite3D){var parent3D=this._parent;this.transform._setParent(parent3D.transform);if(parent3D._hierarchyAnimator){!this._hierarchyAnimator&&this._setHierarchyAnimator(parent3D._hierarchyAnimator,null);parent3D._changeAnimatorsToLinkSprite3D(this,true,[this.name]);}}_Laya$Node.prototype._onAdded.call(this);};_proto73._onRemoved=function _onRemoved(){_Laya$Node.prototype._onRemoved.call(this);if(this._parent instanceof Sprite3D){var parent3D=this._parent;this.transform._setParent(null);if(parent3D._hierarchyAnimator){this._hierarchyAnimator==parent3D._hierarchyAnimator&&this._clearHierarchyAnimator(parent3D._hierarchyAnimator,null);parent3D._changeAnimatorsToLinkSprite3D(this,false,[this.name]);}}};_proto73._parse=function _parse(data,spriteMap){data.isStatic!==undefined&&(this._isStatic=data.isStatic);data.active!==undefined&&(this.active=data.active);data.name!=undefined&&(this.name=data.name);if(data.position!==undefined){var loccalPosition=this.transform.localPosition;loccalPosition.fromArray(data.position);this.transform.localPosition=loccalPosition;}if(data.rotationEuler!==undefined){var localRotationEuler=this.transform.localRotationEuler;localRotationEuler.fromArray(data.rotationEuler);this.transform.localRotationEuler=localRotationEuler;}if(data.rotation!==undefined){var localRotation=this.transform.localRotation;localRotation.fromArray(data.rotation);this.transform.localRotation=localRotation;}if(data.scale!==undefined){var localScale=this.transform.localScale;localScale.fromArray(data.scale);this.transform.localScale=localScale;}data.layer!=undefined&&(this.layer=data.layer);};_proto73._cloneTo=function _cloneTo(destObject,srcRoot,dstRoot){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var destSprite3D=destObject;var trans=this._transform;var destTrans=destSprite3D._transform;destSprite3D.name=this.name;destSprite3D.destroyed=this.destroyed;destSprite3D.active=this.active;destTrans.localPosition=trans.localPosition;destTrans.localRotation=trans.localRotation;destTrans.localScale=trans.localScale;destSprite3D._isStatic=this._isStatic;destSprite3D.layer=this.layer;_Laya$Node.prototype._cloneTo.call(this,destSprite3D,srcRoot,dstRoot);};Sprite3D._createSprite3DInstance=function _createSprite3DInstance(scrSprite){var node=scrSprite._create();var children=scrSprite._children;for(var i=0,n=children.length;i<n;i++){var child=Sprite3D._createSprite3DInstance(children[i]);node.addChild(child);}return node;};Sprite3D._parseSprite3DInstance=function _parseSprite3DInstance(srcRoot,dstRoot,scrSprite,dstSprite){var srcChildren=scrSprite._children;var dstChildren=dstSprite._children;for(var i=0,n=srcChildren.length;i<n;i++){Sprite3D._parseSprite3DInstance(srcRoot,dstRoot,srcChildren[i],dstChildren[i]);}scrSprite._cloneTo(dstSprite,srcRoot,dstRoot);};_proto73.clone=function clone(){var dstSprite3D=Sprite3D._createSprite3DInstance(this);Sprite3D._parseSprite3DInstance(this,dstSprite3D,this,dstSprite3D);return dstSprite3D;};_proto73.destroy=function destroy(destroyChild){if(destroyChild===void 0){destroyChild=true;}if(this.destroyed)return;_Laya$Node.prototype.destroy.call(this,destroyChild);this._transform=null;this._scripts=null;this._url&&Laya.Loader.clearRes(this._url);};_proto73._create=function _create(){return new Sprite3D();};_createClass(Sprite3D,[{key:"id",get:function get(){return this._id;}},{key:"layer",get:function get(){return this._layer;},set:function set(value){if(this._layer!==value){if(value>=0&&value<=30){this._layer=value;}else {throw new Error("Layer value must be 0-30.");}}}},{key:"url",get:function get(){return this._url;}},{key:"isStatic",get:function get(){return this._isStatic;}},{key:"transform",get:function get(){return this._transform;}}]);return Sprite3D;}(Laya.Node);Sprite3D.HIERARCHY="HIERARCHY";Sprite3D.WORLDMATRIX=Shader3D.propertyNameToID("u_WorldMat");Sprite3D.MVPMATRIX=Shader3D.propertyNameToID("u_MvpMatrix");Sprite3D._uniqueIDCounter=0;var BaseCamera=/*#__PURE__*/function(_Sprite3D){_inheritsLoose(BaseCamera,_Sprite3D);function BaseCamera(nearPlane,farPlane){var _this31;if(nearPlane===void 0){nearPlane=0.3;}if(farPlane===void 0){farPlane=1000;}_this31=_Sprite3D.call(this)||this;_this31._skyRenderer=new SkyRenderer();_this31._forward=new Vector3();_this31._up=new Vector3();_this31.clearColor=new Vector4(100/255,149/255,237/255,255/255);_this31._shaderValues=new ShaderData(null);_this31._fieldOfView=60;_this31._useUserProjectionMatrix=false;_this31._orthographic=false;_this31._orthographicVerticalSize=10;_this31.renderingOrder=0;_this31._nearPlane=nearPlane;_this31._farPlane=farPlane;_this31.cullingMask=2147483647;_this31.useOcclusionCulling=true;return _this31;}var _proto74=BaseCamera.prototype;_proto74._sortCamerasByRenderingOrder=function _sortCamerasByRenderingOrder(){if(this.displayedInStage){var cameraPool=this.scene._cameraPool;var n=cameraPool.length-1;for(var i=0;i<n;i++){if(cameraPool[i].renderingOrder>cameraPool[n].renderingOrder){var tempCamera=cameraPool[i];cameraPool[i]=cameraPool[n];cameraPool[n]=tempCamera;}}}};_proto74._calculateProjectionMatrix=function _calculateProjectionMatrix(){};_proto74._onScreenSizeChanged=function _onScreenSizeChanged(){this._calculateProjectionMatrix();};_proto74._prepareCameraToRender=function _prepareCameraToRender(){var cameraSV=this._shaderValues;this.transform.getForward(this._forward);this.transform.getUp(this._up);cameraSV.setVector3(BaseCamera.CAMERAPOS,this.transform.position);cameraSV.setVector3(BaseCamera.CAMERADIRECTION,this._forward);cameraSV.setVector3(BaseCamera.CAMERAUP,this._up);};_proto74.render=function render(shader,replacementTag){};_proto74.addLayer=function addLayer(layer){this.cullingMask|=Math.pow(2,layer);};_proto74.removeLayer=function removeLayer(layer){this.cullingMask&=~Math.pow(2,layer);};_proto74.addAllLayers=function addAllLayers(){this.cullingMask=2147483647;};_proto74.removeAllLayers=function removeAllLayers(){this.cullingMask=0;};_proto74.resetProjectionMatrix=function resetProjectionMatrix(){this._useUserProjectionMatrix=false;this._calculateProjectionMatrix();};_proto74._onActive=function _onActive(){this._scene._addCamera(this);_Sprite3D.prototype._onActive.call(this);};_proto74._onInActive=function _onInActive(){this._scene._removeCamera(this);_Sprite3D.prototype._onInActive.call(this);};_proto74._parse=function _parse(data,spriteMap){_Sprite3D.prototype._parse.call(this,data,spriteMap);this.orthographic=data.orthographic;data.orthographicVerticalSize!==undefined&&(this.orthographicVerticalSize=data.orthographicVerticalSize);data.fieldOfView!==undefined&&(this.fieldOfView=data.fieldOfView);this.nearPlane=data.nearPlane;this.farPlane=data.farPlane;var color=data.clearColor;this.clearColor=new Vector4(color[0],color[1],color[2],color[3]);var skyboxMaterial=data.skyboxMaterial;if(skyboxMaterial){this._skyRenderer.material=Laya.Loader.getRes(skyboxMaterial.path);}};_proto74.destroy=function destroy(destroyChild){if(destroyChild===void 0){destroyChild=true;}this._skyRenderer.destroy();this._skyRenderer=null;Laya.Laya.stage.off(Laya.Event.RESIZE,this,this._onScreenSizeChanged);_Sprite3D.prototype.destroy.call(this,destroyChild);};_proto74._create=function _create(){return new BaseCamera();};_createClass(BaseCamera,[{key:"skyRenderer",get:function get(){return this._skyRenderer;}},{key:"fieldOfView",get:function get(){return this._fieldOfView;},set:function set(value){this._fieldOfView=value;this._calculateProjectionMatrix();}},{key:"nearPlane",get:function get(){return this._nearPlane;},set:function set(value){this._nearPlane=value;this._calculateProjectionMatrix();}},{key:"farPlane",get:function get(){return this._farPlane;},set:function set(vaule){this._farPlane=vaule;this._calculateProjectionMatrix();}},{key:"orthographic",get:function get(){return this._orthographic;},set:function set(vaule){this._orthographic=vaule;this._calculateProjectionMatrix();}},{key:"orthographicVerticalSize",get:function get(){return this._orthographicVerticalSize;},set:function set(vaule){this._orthographicVerticalSize=vaule;this._calculateProjectionMatrix();}},{key:"renderingOrder",get:function get(){return this._renderingOrder;},set:function set(value){this._renderingOrder=value;this._sortCamerasByRenderingOrder();}}]);return BaseCamera;}(Sprite3D);BaseCamera._tempMatrix4x40=new Matrix4x4();BaseCamera.CAMERAPOS=Shader3D.propertyNameToID("u_CameraPos");BaseCamera.VIEWMATRIX=Shader3D.propertyNameToID("u_View");BaseCamera.PROJECTMATRIX=Shader3D.propertyNameToID("u_Projection");BaseCamera.VIEWPROJECTMATRIX=Shader3D.propertyNameToID("u_ViewProjection");BaseCamera.CAMERADIRECTION=Shader3D.propertyNameToID("u_CameraDirection");BaseCamera.CAMERAUP=Shader3D.propertyNameToID("u_CameraUp");BaseCamera.VIEWPORT=Shader3D.propertyNameToID("u_Viewport");BaseCamera.PROJECTION_PARAMS=Shader3D.propertyNameToID("u_ProjectionParams");BaseCamera.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING";BaseCamera.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING";BaseCamera._invertYScaleMatrix=new Matrix4x4(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1);BaseCamera._invertYProjectionMatrix=new Matrix4x4();BaseCamera._invertYProjectionViewMatrix=new Matrix4x4();BaseCamera.CLEARFLAG_SOLIDCOLOR=0;BaseCamera.CLEARFLAG_SKY=1;BaseCamera.CLEARFLAG_DEPTHONLY=2;BaseCamera.CLEARFLAG_NONE=3;(function(ShadowMode){ShadowMode[ShadowMode["None"]=0]="None";ShadowMode[ShadowMode["Hard"]=1]="Hard";ShadowMode[ShadowMode["SoftLow"]=2]="SoftLow";ShadowMode[ShadowMode["SoftHigh"]=3]="SoftHigh";})(exports.ShadowMode||(exports.ShadowMode={}));var ScreenQuad=/*#__PURE__*/function(_Laya$Resource5){_inheritsLoose(ScreenQuad,_Laya$Resource5);function ScreenQuad(){var _this32;_this32=_Laya$Resource5.call(this)||this;_this32._bufferState=new BufferState();_this32._bufferStateInvertUV=new BufferState();var gl=Laya.LayaGL.instance;_this32._vertexBuffer=new VertexBuffer3D(16*4,gl.STATIC_DRAW,false);_this32._vertexBuffer.vertexDeclaration=ScreenQuad._vertexDeclaration;_this32._vertexBuffer.setData(ScreenQuad._vertices.buffer);_this32._bufferState.bind();_this32._bufferState.applyVertexBuffer(_this32._vertexBuffer);_this32._bufferState.unBind();_this32._vertexBufferInvertUV=new VertexBuffer3D(16*4,gl.STATIC_DRAW,false);_this32._vertexBufferInvertUV.vertexDeclaration=ScreenQuad._vertexDeclaration;_this32._vertexBufferInvertUV.setData(ScreenQuad._verticesInvertUV.buffer);_this32._bufferStateInvertUV.bind();_this32._bufferStateInvertUV.applyVertexBuffer(_this32._vertexBufferInvertUV);_this32._bufferStateInvertUV.unBind();_this32._setGPUMemory(_this32._vertexBuffer._byteLength+_this32._vertexBufferInvertUV._byteLength);return _this32;}ScreenQuad.__init__=function __init__(){ScreenQuad._vertexDeclaration=new VertexDeclaration(16,[new VertexElement(0,VertexElementFormat.Vector4,ScreenQuad.SCREENQUAD_POSITION_UV)]);ScreenQuad.instance=new ScreenQuad();ScreenQuad.instance.lock=true;};var _proto75=ScreenQuad.prototype;_proto75.render=function render(){var gl=Laya.LayaGL.instance;this._bufferState.bind();gl.drawArrays(gl.TRIANGLE_STRIP,0,4);Laya.Stat.renderBatches++;};_proto75.renderInvertUV=function renderInvertUV(){var gl=Laya.LayaGL.instance;this._bufferStateInvertUV.bind();gl.drawArrays(gl.TRIANGLE_STRIP,0,4);Laya.Stat.renderBatches++;};_proto75.destroy=function destroy(){_Laya$Resource5.prototype.destroy.call(this);this._bufferState.destroy();this._vertexBuffer.destroy();this._bufferStateInvertUV.destroy();this._vertexBufferInvertUV.destroy();this._setGPUMemory(0);};return ScreenQuad;}(Laya.Resource);ScreenQuad.SCREENQUAD_POSITION_UV=0;ScreenQuad._vertices=new Float32Array([1,1,1,1,1,-1,1,0,-1,1,0,1,-1,-1,0,0]);ScreenQuad._verticesInvertUV=new Float32Array([1,1,1,0,1,-1,1,1,-1,1,0,0,-1,-1,0,1]);var ScreenTriangle=/*#__PURE__*/function(_Laya$Resource6){_inheritsLoose(ScreenTriangle,_Laya$Resource6);function ScreenTriangle(){var _this33;_this33=_Laya$Resource6.call(this)||this;_this33._bufferState=new BufferState();_this33._bufferStateInvertUV=new BufferState();var gl=Laya.LayaGL.instance;_this33._vertexBuffer=new VertexBuffer3D(12*4,gl.STATIC_DRAW,false);_this33._vertexBuffer.vertexDeclaration=ScreenTriangle._vertexDeclaration;_this33._vertexBuffer.setData(ScreenTriangle._vertices.buffer);_this33._bufferState.bind();_this33._bufferState.applyVertexBuffer(_this33._vertexBuffer);_this33._bufferState.unBind();_this33._vertexBufferInvertUV=new VertexBuffer3D(12*4,gl.STATIC_DRAW,false);_this33._vertexBufferInvertUV.vertexDeclaration=ScreenTriangle._vertexDeclaration;_this33._vertexBufferInvertUV.setData(ScreenTriangle._verticesInvertUV.buffer);_this33._bufferStateInvertUV.bind();_this33._bufferStateInvertUV.applyVertexBuffer(_this33._vertexBufferInvertUV);_this33._bufferStateInvertUV.unBind();_this33._setGPUMemory(_this33._vertexBuffer._byteLength+_this33._vertexBufferInvertUV._byteLength);return _this33;}ScreenTriangle.__init__=function __init__(){ScreenTriangle._vertexDeclaration=new VertexDeclaration(16,[new VertexElement(0,VertexElementFormat.Vector4,ScreenTriangle.SCREENTRIANGLE_POSITION_UV)]);ScreenTriangle.instance=new ScreenTriangle();ScreenTriangle.instance.lock=true;};var _proto76=ScreenTriangle.prototype;_proto76.render=function render(){var gl=Laya.LayaGL.instance;this._bufferState.bind();gl.drawArrays(gl.TRIANGLES,0,3);Laya.Stat.renderBatches++;};_proto76.renderInvertUV=function renderInvertUV(){var gl=Laya.LayaGL.instance;this._bufferStateInvertUV.bind();gl.drawArrays(gl.TRIANGLES,0,3);Laya.Stat.renderBatches++;};_proto76.destroy=function destroy(){_Laya$Resource6.prototype.destroy.call(this);this._bufferState.destroy();this._vertexBuffer.destroy();this._bufferStateInvertUV.destroy();this._vertexBufferInvertUV.destroy();this._setGPUMemory(0);};return ScreenTriangle;}(Laya.Resource);ScreenTriangle.SCREENTRIANGLE_POSITION_UV=0;ScreenTriangle._vertices=new Float32Array([-1,-1,0,0,-1,3,0,2,3,-1,2,0]);ScreenTriangle._verticesInvertUV=new Float32Array([-1,-1,0,1,-1,3,0,-1,3,-1,2,1]);var Command=/*#__PURE__*/function(){function Command(){this._commandBuffer=null;}Command.__init__=function __init__(){Command._screenShaderData=new ShaderData();Command._screenShader=Shader3D.find("BlitScreen");};var _proto77=Command.prototype;_proto77.run=function run(){};_proto77.recover=function recover(){this._commandBuffer=null;};return Command;}();Command.SCREENTEXTURE_NAME="u_MainTex";Command.SCREENTEXTUREOFFSETSCALE_NAME="u_OffsetScale";Command.MAINTEXTURE_TEXELSIZE_NAME="u_MainTex_TexelSize";Command.SCREENTEXTURE_ID=Shader3D.propertyNameToID(Command.SCREENTEXTURE_NAME);Command.SCREENTEXTUREOFFSETSCALE_ID=Shader3D.propertyNameToID(Command.SCREENTEXTUREOFFSETSCALE_NAME);Command.MAINTEXTURE_TEXELSIZE_ID=Shader3D.propertyNameToID(Command.MAINTEXTURE_TEXELSIZE_NAME);var BlitScreenQuadCMD=/*#__PURE__*/function(_Command){_inheritsLoose(BlitScreenQuadCMD,_Command);function BlitScreenQuadCMD(){var _this34;_this34=_Command.apply(this,arguments)||this;_this34._source=null;_this34._dest=null;_this34._offsetScale=null;_this34._shader=null;_this34._shaderData=null;_this34._subShader=0;_this34._sourceTexelSize=new Vector4();_this34._screenType=0;return _this34;}BlitScreenQuadCMD.create=function create(source,dest,offsetScale,shader,shaderData,subShader,screenType){if(offsetScale===void 0){offsetScale=null;}if(shader===void 0){shader=null;}if(shaderData===void 0){shaderData=null;}if(subShader===void 0){subShader=0;}if(screenType===void 0){screenType=BlitScreenQuadCMD._SCREENTYPE_QUAD;}var cmd;cmd=BlitScreenQuadCMD._pool.length>0?BlitScreenQuadCMD._pool.pop():new BlitScreenQuadCMD();cmd._source=source;cmd._dest=dest;cmd._offsetScale=offsetScale;cmd._shader=shader;cmd._shaderData=shaderData;cmd._subShader=subShader;cmd._screenType=screenType;return cmd;};var _proto78=BlitScreenQuadCMD.prototype;_proto78.run=function run(){var shader=this._shader||Command._screenShader;var shaderData=this._shaderData||Command._screenShaderData;var dest=this._dest;Laya.LayaGL.instance.viewport(0,0,dest?dest.width:RenderContext3D.clientWidth,dest?dest.height:RenderContext3D.clientHeight);shaderData.setTexture(Command.SCREENTEXTURE_ID,this._source);shaderData.setVector(Command.SCREENTEXTUREOFFSETSCALE_ID,this._offsetScale||BlitScreenQuadCMD._defaultOffsetScale);this._sourceTexelSize.setValue(1.0/this._source.width,1.0/this._source.height,this._source.width,this._source.height);shaderData.setVector(Command.MAINTEXTURE_TEXELSIZE_ID,this._sourceTexelSize);dest&&dest._start();var subShader=shader.getSubShaderAt(this._subShader);var passes=subShader._passes;for(var i=0,n=passes.length;i<n;i++){var comDef=BlitScreenQuadCMD._compileDefine;shaderData._defineDatas.cloneTo(comDef);var shaderPass=passes[i].withCompile(comDef);shaderPass.bind();shaderPass.uploadUniforms(shaderPass._materialUniformParamsMap,shaderData,true);shaderPass.uploadRenderStateBlendDepth(shaderData);shaderPass.uploadRenderStateFrontFace(shaderData,false,null);switch(this._screenType){case BlitScreenQuadCMD._SCREENTYPE_QUAD:RenderContext3D._instance.invertY?ScreenQuad.instance.renderInvertUV():ScreenQuad.instance.render();break;case BlitScreenQuadCMD._SCREENTYPE_TRIANGLE:RenderContext3D._instance.invertY?ScreenTriangle.instance.renderInvertUV():ScreenTriangle.instance.render();break;default:throw "BlitScreenQuadCMD:unknown screen Type.";}}dest&&dest._end();};_proto78.recover=function recover(){BlitScreenQuadCMD._pool.push(this);this._source=null;this._dest=null;this._offsetScale=null;this._shader=null;this._shaderData=null;_Command.prototype.recover.call(this);};return BlitScreenQuadCMD;}(Command);BlitScreenQuadCMD._SCREENTYPE_QUAD=0;BlitScreenQuadCMD._SCREENTYPE_TRIANGLE=1;BlitScreenQuadCMD._compileDefine=new DefineDatas();BlitScreenQuadCMD._pool=[];BlitScreenQuadCMD._defaultOffsetScale=new Vector4(0,0,1,1);var SetRenderTargetCMD=/*#__PURE__*/function(_Command2){_inheritsLoose(SetRenderTargetCMD,_Command2);function SetRenderTargetCMD(){var _this35;_this35=_Command2.apply(this,arguments)||this;_this35._renderTexture=null;return _this35;}SetRenderTargetCMD.create=function create(renderTexture){var cmd;cmd=SetRenderTargetCMD._pool.length>0?SetRenderTargetCMD._pool.pop():new SetRenderTargetCMD();cmd._renderTexture=renderTexture;return cmd;};var _proto79=SetRenderTargetCMD.prototype;_proto79.run=function run(){this._renderTexture._start();};_proto79.recover=function recover(){SetRenderTargetCMD._pool.push(this);this._renderTexture=null;};return SetRenderTargetCMD;}(Command);SetRenderTargetCMD._pool=[];var SetShaderDataTextureCMD=/*#__PURE__*/function(_Command3){_inheritsLoose(SetShaderDataTextureCMD,_Command3);function SetShaderDataTextureCMD(){var _this36;_this36=_Command3.apply(this,arguments)||this;_this36._shaderData=null;_this36._nameID=0;_this36._texture=null;return _this36;}SetShaderDataTextureCMD.create=function create(shaderData,nameID,texture){var cmd;cmd=SetShaderDataTextureCMD._pool.length>0?SetShaderDataTextureCMD._pool.pop():new SetShaderDataTextureCMD();cmd._shaderData=shaderData;cmd._nameID=nameID;cmd._texture=texture;return cmd;};var _proto80=SetShaderDataTextureCMD.prototype;_proto80.run=function run(){this._shaderData.setTexture(this._nameID,this._texture);};_proto80.recover=function recover(){SetShaderDataTextureCMD._pool.push(this);this._shaderData=null;this._nameID=0;this._texture=null;};return SetShaderDataTextureCMD;}(Command);SetShaderDataTextureCMD._pool=[];var CommandBuffer=/*#__PURE__*/function(){function CommandBuffer(){this._camera=null;this._commands=[];}var _proto81=CommandBuffer.prototype;_proto81._apply=function _apply(){for(var i=0,n=this._commands.length;i<n;i++){this._commands[i].run();}};_proto81.setShaderDataTexture=function setShaderDataTexture(shaderData,nameID,source){this._commands.push(SetShaderDataTextureCMD.create(shaderData,nameID,source));};_proto81.blitScreenQuad=function blitScreenQuad(source,dest,offsetScale,shader,shaderData,subShader){if(offsetScale===void 0){offsetScale=null;}if(shader===void 0){shader=null;}if(shaderData===void 0){shaderData=null;}if(subShader===void 0){subShader=0;}this._commands.push(BlitScreenQuadCMD.create(source,dest,offsetScale,shader,shaderData,subShader,BlitScreenQuadCMD._SCREENTYPE_QUAD));};_proto81.blitScreenTriangle=function blitScreenTriangle(source,dest,offsetScale,shader,shaderData,subShader){if(offsetScale===void 0){offsetScale=null;}if(shader===void 0){shader=null;}if(shaderData===void 0){shaderData=null;}if(subShader===void 0){subShader=0;}this._commands.push(BlitScreenQuadCMD.create(source,dest,offsetScale,shader,shaderData,subShader,BlitScreenQuadCMD._SCREENTYPE_TRIANGLE));};_proto81.setRenderTarget=function setRenderTarget(renderTexture){this._commands.push(SetRenderTargetCMD.create(renderTexture));};_proto81.clear=function clear(){for(var i=0,n=this._commands.length;i<n;i++){this._commands[i].recover();}this._commands.length=0;};return CommandBuffer;}();var Scene3DShaderDeclaration=function Scene3DShaderDeclaration(){};(function(LightType){LightType[LightType["Directional"]=0]="Directional";LightType[LightType["Spot"]=1]="Spot";LightType[LightType["Point"]=2]="Point";})(exports.LightType||(exports.LightType={}));var LightSprite=/*#__PURE__*/function(_Sprite3D2){_inheritsLoose(LightSprite,_Sprite3D2);function LightSprite(){var _this37;_this37=_Sprite3D2.call(this)||this;_this37._shadowMode=exports.ShadowMode.None;_this37._isAlternate=false;_this37._shadowResolution=2048;_this37._shadowDistance=50.0;_this37._shadowDepthBias=1.0;_this37._shadowNormalBias=1.0;_this37._shadowNearPlane=0.1;_this37._shadowStrength=1.0;_this37._intensity=1.0;_this37._intensityColor=new Vector3();_this37.color=new Vector3(1.0,1.0,1.0);_this37._lightmapBakedType=LightSprite.LIGHTMAPBAKEDTYPE_REALTIME;return _this37;}var _proto82=LightSprite.prototype;_proto82._parse=function _parse(data,spriteMap){_Sprite3D2.prototype._parse.call(this,data,spriteMap);var colorData=data.color;this.color.fromArray(colorData);this.intensity=data.intensity;this.lightmapBakedType=data.lightmapBakedType;};_proto82._addToScene=function _addToScene(){var scene=this._scene;var maxLightCount=Config3D._config.maxLightCount;if(scene._lightCount<maxLightCount){scene._lightCount++;this._addToLightQueue();this._isAlternate=false;}else {scene._alternateLights.add(this);this._isAlternate=true;console.warn("LightSprite:light count has large than maxLightCount,the latest added light will be ignore.");}};_proto82._removeFromScene=function _removeFromScene(){var scene=this._scene;if(this._isAlternate){scene._alternateLights.remove(this);}else {scene._lightCount--;this._removeFromLightQueue();if(scene._alternateLights._length>0){var alternateLight=scene._alternateLights.shift();alternateLight._addToLightQueue();alternateLight._isAlternate=false;scene._lightCount++;}}};_proto82._addToLightQueue=function _addToLightQueue(){};_proto82._removeFromLightQueue=function _removeFromLightQueue(){};_proto82._onActive=function _onActive(){_Sprite3D2.prototype._onActive.call(this);this.lightmapBakedType!==LightSprite.LIGHTMAPBAKEDTYPE_BAKED&&this._addToScene();};_proto82._onInActive=function _onInActive(){_Sprite3D2.prototype._onInActive.call(this);this.lightmapBakedType!==LightSprite.LIGHTMAPBAKEDTYPE_BAKED&&this._removeFromScene();};_proto82._create=function _create(){return new LightSprite();};_createClass(LightSprite,[{key:"intensity",get:function get(){return this._intensity;},set:function set(value){this._intensity=value;}},{key:"shadowMode",get:function get(){return this._shadowMode;},set:function set(value){this._shadowMode=value;}},{key:"shadowDistance",get:function get(){return this._shadowDistance;},set:function set(value){this._shadowDistance=value;}},{key:"shadowResolution",get:function get(){return this._shadowResolution;},set:function set(value){this._shadowResolution=value;}},{key:"shadowDepthBias",get:function get(){return this._shadowDepthBias;},set:function set(value){this._shadowDepthBias=value;}},{key:"shadowNormalBias",get:function get(){return this._shadowNormalBias;},set:function set(value){this._shadowNormalBias=value;}},{key:"shadowStrength",get:function get(){return this._shadowStrength;},set:function set(value){this._shadowStrength=value;}},{key:"shadowNearPlane",get:function get(){return this._shadowNearPlane;},set:function set(value){this._shadowNearPlane=value;}},{key:"lightmapBakedType",get:function get(){return this._lightmapBakedType;},set:function set(value){if(this._lightmapBakedType!==value){this._lightmapBakedType=value;if(this.activeInHierarchy){if(value!==LightSprite.LIGHTMAPBAKEDTYPE_BAKED)this._addToScene();else this._removeFromScene();}}}},{key:"diffuseColor",get:function get(){console.log("LightSprite: discard property,please use color property instead.");return this.color;},set:function set(value){console.log("LightSprite: discard property,please use color property instead.");this.color=value;}}]);return LightSprite;}(Sprite3D);LightSprite.LIGHTMAPBAKEDTYPE_REALTIME=0;LightSprite.LIGHTMAPBAKEDTYPE_MIXED=1;LightSprite.LIGHTMAPBAKEDTYPE_BAKED=2;(function(ShadowCascadesMode){ShadowCascadesMode[ShadowCascadesMode["NoCascades"]=0]="NoCascades";ShadowCascadesMode[ShadowCascadesMode["TwoCascades"]=1]="TwoCascades";ShadowCascadesMode[ShadowCascadesMode["FourCascades"]=2]="FourCascades";})(exports.ShadowCascadesMode||(exports.ShadowCascadesMode={}));var FrustumFace;(function(FrustumFace){FrustumFace[FrustumFace["Near"]=0]="Near";FrustumFace[FrustumFace["Far"]=1]="Far";FrustumFace[FrustumFace["Left"]=2]="Left";FrustumFace[FrustumFace["Right"]=3]="Right";FrustumFace[FrustumFace["Bottom"]=4]="Bottom";FrustumFace[FrustumFace["Top"]=5]="Top";})(FrustumFace||(FrustumFace={}));var ShadowUtils=/*#__PURE__*/function(){function ShadowUtils(){}ShadowUtils.supportShadow=function supportShadow(){return Laya.LayaGL.layaGPUInstance._isWebGL2||Laya.SystemUtils.supportRenderTextureFormat(Laya.RenderTextureFormat.Depth);};ShadowUtils.init=function init(){if(Laya.LayaGL.layaGPUInstance._isWebGL2)ShadowUtils._shadowTextureFormat=Laya.RenderTextureFormat.ShadowMap;else ShadowUtils._shadowTextureFormat=Laya.RenderTextureFormat.Depth;};ShadowUtils.getTemporaryShadowTexture=function getTemporaryShadowTexture(witdh,height,depthFormat){var shadowMap=RenderTexture.createFromPool(witdh,height,ShadowUtils._shadowTextureFormat,depthFormat);shadowMap.filterMode=Laya.FilterMode.Bilinear;shadowMap.wrapModeU=Laya.WarpMode.Clamp;shadowMap.wrapModeV=Laya.WarpMode.Clamp;return shadowMap;};ShadowUtils.getShadowBias=function getShadowBias(light,shadowProjectionMatrix,shadowResolution,out){var frustumSize;if(light._lightType==exports.LightType.Directional){frustumSize=2.0/shadowProjectionMatrix.elements[0];}else if(light._lightType==exports.LightType.Spot){frustumSize=Math.tan(light.spotAngle*0.5*MathUtils3D.Deg2Rad)*light.range;}else {console.warn("ShadowUtils:Only spot and directional shadow casters are supported now.");frustumSize=0.0;}var texelSize=frustumSize/shadowResolution;var depthBias=-light._shadowDepthBias*texelSize;var normalBias=-light._shadowNormalBias*texelSize;if(light.shadowMode==exports.ShadowMode.SoftHigh){var kernelRadius=2.5;depthBias*=kernelRadius;normalBias*=kernelRadius;}out.setValue(depthBias,normalBias,0.0,0.0);};ShadowUtils.getCameraFrustumPlanes=function getCameraFrustumPlanes(cameraViewProjectMatrix,frustumPlanes){BoundFrustum.getPlanesFromMatrix(cameraViewProjectMatrix,frustumPlanes[FrustumFace.Near],frustumPlanes[FrustumFace.Far],frustumPlanes[FrustumFace.Left],frustumPlanes[FrustumFace.Right],frustumPlanes[FrustumFace.Top],frustumPlanes[FrustumFace.Bottom]);};ShadowUtils.getFarWithRadius=function getFarWithRadius(radius,denominator){return Math.sqrt(radius*radius/denominator);};ShadowUtils.getCascadesSplitDistance=function getCascadesSplitDistance(twoSplitRatio,fourSplitRatio,cameraNear,shadowFar,fov,aspectRatio,cascadesMode,out){out[0]=cameraNear;var range=shadowFar-cameraNear;var tFov=Math.tan(fov*0.5);var denominator=1.0+tFov*tFov*(aspectRatio*aspectRatio+1.0);switch(cascadesMode){case exports.ShadowCascadesMode.NoCascades:out[1]=ShadowUtils.getFarWithRadius(shadowFar,denominator);break;case exports.ShadowCascadesMode.TwoCascades:out[1]=ShadowUtils.getFarWithRadius(cameraNear+range*twoSplitRatio,denominator);out[2]=ShadowUtils.getFarWithRadius(shadowFar,denominator);break;case exports.ShadowCascadesMode.FourCascades:out[1]=ShadowUtils.getFarWithRadius(cameraNear+range*fourSplitRatio.x,denominator);out[2]=ShadowUtils.getFarWithRadius(cameraNear+range*fourSplitRatio.y,denominator);out[3]=ShadowUtils.getFarWithRadius(cameraNear+range*fourSplitRatio.z,denominator);out[4]=ShadowUtils.getFarWithRadius(shadowFar,denominator);break;}};ShadowUtils.applySliceTransform=function applySliceTransform(shadowSliceData,atlasWidth,atlasHeight,cascadeIndex,outShadowMatrices){var sliceE=ShadowUtils._tempMatrix0.elements;var oneOverAtlasWidth=1.0/atlasWidth;var oneOverAtlasHeight=1.0/atlasHeight;sliceE[0]=shadowSliceData.resolution*oneOverAtlasWidth;sliceE[5]=shadowSliceData.resolution*oneOverAtlasHeight;sliceE[12]=shadowSliceData.offsetX*oneOverAtlasWidth;sliceE[13]=shadowSliceData.offsetY*oneOverAtlasHeight;sliceE[1]=sliceE[2]=sliceE[2]=sliceE[4]=sliceE[6]=sliceE[7]=sliceE[8]=sliceE[9]=sliceE[11]=sliceE[14]=0;sliceE[10]=sliceE[15]=1;var offset=cascadeIndex*16;Utils3D._mulMatrixArray(sliceE,outShadowMatrices,offset,outShadowMatrices,offset);};ShadowUtils.getDirectionLightShadowCullPlanes=function getDirectionLightShadowCullPlanes(cameraFrustumPlanes,cascadeIndex,splitDistance,cameraNear,direction,shadowSliceData){var frustumCorners=ShadowUtils._frustumCorners;var backPlaneFaces=ShadowUtils._backPlaneFaces;var planeNeighbors=ShadowUtils._frustumPlaneNeighbors;var twoPlaneCorners=ShadowUtils._frustumTwoPlaneCorners;var edgePlanePoint2=ShadowUtils._edgePlanePoint2;var out=shadowSliceData.cullPlanes;var near=cameraFrustumPlanes[FrustumFace.Near],far=cameraFrustumPlanes[FrustumFace.Far];var left=cameraFrustumPlanes[FrustumFace.Left],right=cameraFrustumPlanes[FrustumFace.Right];var bottom=cameraFrustumPlanes[FrustumFace.Bottom],top=cameraFrustumPlanes[FrustumFace.Top];var splitNearDistance=splitDistance[cascadeIndex]-cameraNear;var splitNear=ShadowUtils._adjustNearPlane;var splitFar=ShadowUtils._adjustFarPlane;near.normal.cloneTo(splitNear.normal);far.normal.cloneTo(splitFar.normal);splitNear.distance=near.distance-splitNearDistance;splitFar.distance=Math.min(-near.distance+shadowSliceData.sphereCenterZ+shadowSliceData.splitBoundSphere.radius,far.distance);BoundFrustum.get3PlaneInterPoint(splitNear,bottom,right,frustumCorners[exports.FrustumCorner.nearBottomRight]);BoundFrustum.get3PlaneInterPoint(splitNear,top,right,frustumCorners[exports.FrustumCorner.nearTopRight]);BoundFrustum.get3PlaneInterPoint(splitNear,top,left,frustumCorners[exports.FrustumCorner.nearTopLeft]);BoundFrustum.get3PlaneInterPoint(splitNear,bottom,left,frustumCorners[exports.FrustumCorner.nearBottomLeft]);BoundFrustum.get3PlaneInterPoint(splitFar,bottom,right,frustumCorners[exports.FrustumCorner.FarBottomRight]);BoundFrustum.get3PlaneInterPoint(splitFar,top,right,frustumCorners[exports.FrustumCorner.FarTopRight]);BoundFrustum.get3PlaneInterPoint(splitFar,top,left,frustumCorners[exports.FrustumCorner.FarTopLeft]);BoundFrustum.get3PlaneInterPoint(splitFar,bottom,left,frustumCorners[exports.FrustumCorner.FarBottomLeft]);var backIndex=0;for(var i=0;i<6;i++){var plane;switch(i){case FrustumFace.Near:plane=splitNear;break;case FrustumFace.Far:plane=splitFar;break;default:plane=cameraFrustumPlanes[i];break;}if(Vector3.dot(plane.normal,direction)<0.0){plane.cloneTo(out[backIndex]);backPlaneFaces[backIndex]=i;backIndex++;}}var edgeIndex=backIndex;for(var i=0;i<backIndex;i++){var backFace=backPlaneFaces[i];var neighborFaces=planeNeighbors[backFace];for(var j=0;j<4;j++){var neighborFace=neighborFaces[j];var notBackFace=true;for(var k=0;k<backIndex;k++){if(neighborFace==backPlaneFaces[k]){notBackFace=false;break;}}if(notBackFace){var corners=twoPlaneCorners[backFace][neighborFace];var point0=frustumCorners[corners[0]];var point1=frustumCorners[corners[1]];Vector3.add(point0,direction,edgePlanePoint2);Plane.createPlaneBy3P(point0,point1,edgePlanePoint2,out[edgeIndex++]);}}}shadowSliceData.cullPlaneCount=edgeIndex;};ShadowUtils.getBoundSphereByFrustum=function getBoundSphereByFrustum(near,far,fov,aspectRatio,cameraPos,forward,outBoundSphere){var centerZ;var radius;var k=Math.sqrt(1.0+aspectRatio*aspectRatio)*Math.tan(fov/2.0);var k2=k*k;var farSNear=far-near;var farANear=far+near;if(k2>farSNear/farANear){centerZ=far;radius=far*k;}else {centerZ=0.5*farANear*(1+k2);radius=0.5*Math.sqrt(farSNear*farSNear+2.0*(far*far+near*near)*k2+farANear*farANear*k2*k2);}var center=outBoundSphere.center;outBoundSphere.radius=radius;Vector3.scale(forward,centerZ,center);Vector3.add(cameraPos,center,center);return centerZ;};ShadowUtils.getMaxTileResolutionInAtlas=function getMaxTileResolutionInAtlas(atlasWidth,atlasHeight,tileCount){var resolution=Math.min(atlasWidth,atlasHeight);var currentTileCount=Math.floor(atlasWidth/resolution)*Math.floor(atlasHeight/resolution);while(currentTileCount<tileCount){resolution=Math.floor(resolution>>1);currentTileCount=Math.floor(atlasWidth/resolution)*Math.floor(atlasHeight/resolution);}return resolution;};ShadowUtils.getDirectionalLightMatrices=function getDirectionalLightMatrices(lightUp,lightSide,lightForward,cascadeIndex,nearPlane,shadowResolution,shadowSliceData,shadowMatrices){var boundSphere=shadowSliceData.splitBoundSphere;var center=boundSphere.center;var radius=boundSphere.radius;var halfShadowResolution=shadowResolution/2;var borderRadius=radius*halfShadowResolution/(halfShadowResolution-ShadowUtils.atlasBorderSize);var borderDiam=borderRadius*2.0;var sizeUnit=shadowResolution/borderDiam;var radiusUnit=borderDiam/shadowResolution;var upLen=Math.ceil(Vector3.dot(center,lightUp)*sizeUnit)*radiusUnit;var sideLen=Math.ceil(Vector3.dot(center,lightSide)*sizeUnit)*radiusUnit;var forwardLen=Vector3.dot(center,lightForward);center.x=lightUp.x*upLen+lightSide.x*sideLen+lightForward.x*forwardLen;center.y=lightUp.y*upLen+lightSide.y*sideLen+lightForward.y*forwardLen;center.z=lightUp.z*upLen+lightSide.z*sideLen+lightForward.z*forwardLen;var origin=shadowSliceData.position;var viewMatrix=shadowSliceData.viewMatrix;var projectMatrix=shadowSliceData.projectionMatrix;var viewProjectMatrix=shadowSliceData.viewProjectMatrix;shadowSliceData.resolution=shadowResolution;shadowSliceData.offsetX=cascadeIndex%2*shadowResolution;shadowSliceData.offsetY=Math.floor(cascadeIndex/2)*shadowResolution;Vector3.scale(lightForward,radius+nearPlane,origin);Vector3.subtract(center,origin,origin);Matrix4x4.createLookAt(origin,center,lightUp,viewMatrix);Matrix4x4.createOrthoOffCenter(-borderRadius,borderRadius,-borderRadius,borderRadius,0.0,radius*2.0+nearPlane,projectMatrix);Matrix4x4.multiply(projectMatrix,viewMatrix,viewProjectMatrix);Utils3D._mulMatrixArray(ShadowUtils._shadowMapScaleOffsetMatrix.elements,viewProjectMatrix.elements,0,shadowMatrices,cascadeIndex*16);};ShadowUtils.getSpotLightShadowData=function getSpotLightShadowData(shadowSpotData,spotLight,resolution,shadowParams,shadowSpotMatrices,shadowMapSize){var out=shadowSpotData.position=spotLight.transform.position;shadowSpotData.resolution=resolution;shadowMapSize.setValue(1.0/resolution,1.0/resolution,resolution,resolution);shadowSpotData.offsetX=0;shadowSpotData.offsetY=0;var spotWorldMatrix=spotLight.transform.worldMatrix;var viewMatrix=shadowSpotData.viewMatrix;var projectMatrix=shadowSpotData.projectionMatrix;var viewProjectMatrix=shadowSpotData.viewProjectMatrix;var BoundFrustum=shadowSpotData.cameraCullInfo.boundFrustum;spotWorldMatrix.invert(viewMatrix);Matrix4x4.createPerspective(3.1416*spotLight.spotAngle/180.0,1,0.1,spotLight.range,projectMatrix);shadowParams.y=spotLight.shadowStrength;Matrix4x4.multiply(projectMatrix,viewMatrix,viewProjectMatrix);BoundFrustum.matrix=viewProjectMatrix;viewProjectMatrix.cloneTo(shadowSpotMatrices);shadowSpotData.cameraCullInfo.position=out;};ShadowUtils.prepareShadowReceiverShaderValues=function prepareShadowReceiverShaderValues(light,shadowMapWidth,shadowMapHeight,shadowSliceDatas,cascadeCount,shadowMapSize,shadowParams,shadowMatrices,splitBoundSpheres){shadowMapSize.setValue(1.0/shadowMapWidth,1.0/shadowMapHeight,shadowMapWidth,shadowMapHeight);shadowParams.setValue(light._shadowStrength,0.0,0.0,0.0);if(cascadeCount>1){var matrixFloatCount=16;for(var i=cascadeCount*matrixFloatCount,n=4*matrixFloatCount;i<n;i++){shadowMatrices[i]=0.0;}for(var i=0;i<cascadeCount;i++){var boundSphere=shadowSliceDatas[i].splitBoundSphere;var center=boundSphere.center;var radius=boundSphere.radius;var offset=i*4;splitBoundSpheres[offset]=center.x;splitBoundSpheres[offset+1]=center.y;splitBoundSpheres[offset+2]=center.z;splitBoundSpheres[offset+3]=radius*radius;}var sphereFloatCount=4;for(var i=cascadeCount*sphereFloatCount,n=4*sphereFloatCount;i<n;i++){splitBoundSpheres[i]=0.0;}}};return ShadowUtils;}();ShadowUtils._tempMatrix0=new Matrix4x4();ShadowUtils._shadowMapScaleOffsetMatrix=new Matrix4x4(0.5,0.0,0.0,0.0,0.0,0.5,0.0,0.0,0.0,0.0,1.0,0.0,0.5,0.5,0.0,1.0);ShadowUtils._frustumCorners=[new Vector3(),new Vector3(),new Vector3(),new Vector3(),new Vector3(),new Vector3(),new Vector3(),new Vector3()];ShadowUtils._adjustNearPlane=new Plane(new Vector3());ShadowUtils._adjustFarPlane=new Plane(new Vector3());ShadowUtils._backPlaneFaces=new Array(5);ShadowUtils._edgePlanePoint2=new Vector3();ShadowUtils._frustumPlaneNeighbors=[[FrustumFace.Left,FrustumFace.Right,FrustumFace.Top,FrustumFace.Bottom],[FrustumFace.Left,FrustumFace.Right,FrustumFace.Top,FrustumFace.Bottom],[FrustumFace.Near,FrustumFace.Far,FrustumFace.Top,FrustumFace.Bottom],[FrustumFace.Near,FrustumFace.Far,FrustumFace.Top,FrustumFace.Bottom],[FrustumFace.Near,FrustumFace.Far,FrustumFace.Left,FrustumFace.Right],[FrustumFace.Near,FrustumFace.Far,FrustumFace.Left,FrustumFace.Right]];ShadowUtils._frustumTwoPlaneCorners=[[[exports.FrustumCorner.unknown,exports.FrustumCorner.unknown],[exports.FrustumCorner.unknown,exports.FrustumCorner.unknown],[exports.FrustumCorner.nearBottomLeft,exports.FrustumCorner.nearTopLeft],[exports.FrustumCorner.nearTopRight,exports.FrustumCorner.nearBottomRight],[exports.FrustumCorner.nearBottomRight,exports.FrustumCorner.nearBottomLeft],[exports.FrustumCorner.nearTopLeft,exports.FrustumCorner.nearTopRight]],[[exports.FrustumCorner.unknown,exports.FrustumCorner.unknown],[exports.FrustumCorner.unknown,exports.FrustumCorner.unknown],[exports.FrustumCorner.FarTopLeft,exports.FrustumCorner.FarBottomLeft],[exports.FrustumCorner.FarBottomRight,exports.FrustumCorner.FarTopRight],[exports.FrustumCorner.FarBottomLeft,exports.FrustumCorner.FarBottomRight],[exports.FrustumCorner.FarTopRight,exports.FrustumCorner.FarTopLeft]],[[exports.FrustumCorner.nearTopLeft,exports.FrustumCorner.nearBottomLeft],[exports.FrustumCorner.FarBottomLeft,exports.FrustumCorner.FarTopLeft],[exports.FrustumCorner.unknown,exports.FrustumCorner.unknown],[exports.FrustumCorner.unknown,exports.FrustumCorner.unknown],[exports.FrustumCorner.nearBottomLeft,exports.FrustumCorner.FarBottomLeft],[exports.FrustumCorner.FarTopLeft,exports.FrustumCorner.nearTopLeft]],[[exports.FrustumCorner.nearBottomRight,exports.FrustumCorner.nearTopRight],[exports.FrustumCorner.FarTopRight,exports.FrustumCorner.FarBottomRight],[exports.FrustumCorner.unknown,exports.FrustumCorner.unknown],[exports.FrustumCorner.unknown,exports.FrustumCorner.unknown],[exports.FrustumCorner.FarBottomRight,exports.FrustumCorner.nearBottomRight],[exports.FrustumCorner.nearTopRight,exports.FrustumCorner.FarTopRight]],[[exports.FrustumCorner.nearBottomLeft,exports.FrustumCorner.nearBottomRight],[exports.FrustumCorner.FarBottomRight,exports.FrustumCorner.FarBottomLeft],[exports.FrustumCorner.FarBottomLeft,exports.FrustumCorner.nearBottomLeft],[exports.FrustumCorner.nearBottomRight,exports.FrustumCorner.FarBottomRight],[exports.FrustumCorner.unknown,exports.FrustumCorner.unknown],[exports.FrustumCorner.unknown,exports.FrustumCorner.unknown]],[[exports.FrustumCorner.nearTopRight,exports.FrustumCorner.nearTopLeft],[exports.FrustumCorner.FarTopLeft,exports.FrustumCorner.FarTopRight],[exports.FrustumCorner.nearTopLeft,exports.FrustumCorner.FarTopLeft],[exports.FrustumCorner.FarTopRight,exports.FrustumCorner.nearTopRight],[exports.FrustumCorner.unknown,exports.FrustumCorner.unknown],[exports.FrustumCorner.unknown,exports.FrustumCorner.unknown]]];ShadowUtils.atlasBorderSize=4.0;(function(CameraClearFlags){CameraClearFlags[CameraClearFlags["SolidColor"]=0]="SolidColor";CameraClearFlags[CameraClearFlags["Sky"]=1]="Sky";CameraClearFlags[CameraClearFlags["DepthOnly"]=2]="DepthOnly";CameraClearFlags[CameraClearFlags["Nothing"]=3]="Nothing";})(exports.CameraClearFlags||(exports.CameraClearFlags={}));var Camera=/*#__PURE__*/function(_BaseCamera){_inheritsLoose(Camera,_BaseCamera);function Camera(aspectRatio,nearPlane,farPlane){var _this38;if(aspectRatio===void 0){aspectRatio=0;}if(nearPlane===void 0){nearPlane=0.3;}if(farPlane===void 0){farPlane=1000;}_this38=_BaseCamera.call(this,nearPlane,farPlane)||this;_this38._updateViewMatrix=true;_this38._postProcess=null;_this38._enableHDR=false;_this38._viewportParams=new Vector4();_this38._projectionParams=new Vector4();_this38._offScreenRenderTexture=null;_this38._internalRenderTexture=null;_this38._postProcessCommandBuffers=[];_this38._clusterPlaneCacheFlag=new Vector2(-1,-1);_this38._screenOffsetScale=new Vector4();_this38.enableRender=true;_this38.clearFlag=exports.CameraClearFlags.SolidColor;_this38._viewMatrix=new Matrix4x4();_this38._projectionMatrix=new Matrix4x4();_this38._projectionViewMatrix=new Matrix4x4();_this38._viewport=new Viewport(0,0,0,0);_this38._normalizedViewport=new Viewport(0,0,1,1);_this38._aspectRatio=aspectRatio;_this38._boundFrustum=new BoundFrustum(new Matrix4x4());if(Laya.Render.supportWebGLPlusCulling)_this38._boundFrustumBuffer=new Float32Array(24);_this38._calculateProjectionMatrix();Laya.Laya.stage.on(Laya.Event.RESIZE,_assertThisInitialized(_this38),_this38._onScreenSizeChanged);_this38.transform.on(Laya.Event.TRANSFORM_CHANGED,_assertThisInitialized(_this38),_this38._onTransformChanged);return _this38;}var _proto83=Camera.prototype;_proto83._calculationViewport=function _calculationViewport(normalizedViewport,width,height){var lx=normalizedViewport.x*width;var ly=normalizedViewport.y*height;var rx=lx+Math.max(normalizedViewport.width*width,0);var ry=ly+Math.max(normalizedViewport.height*height,0);var ceilLeftX=Math.ceil(lx);var ceilLeftY=Math.ceil(ly);var floorRightX=Math.floor(rx);var floorRightY=Math.floor(ry);var pixelLeftX=ceilLeftX-lx>=0.5?Math.floor(lx):ceilLeftX;var pixelLeftY=ceilLeftY-ly>=0.5?Math.floor(ly):ceilLeftY;var pixelRightX=rx-floorRightX>=0.5?Math.ceil(rx):floorRightX;var pixelRightY=ry-floorRightY>=0.5?Math.ceil(ry):floorRightY;this._viewport.x=pixelLeftX;this._viewport.y=pixelLeftY;this._viewport.width=pixelRightX-pixelLeftX;this._viewport.height=pixelRightY-pixelLeftY;};_proto83._calculateProjectionMatrix=function _calculateProjectionMatrix(){if(!this._useUserProjectionMatrix){if(this._orthographic){var halfHeight=this.orthographicVerticalSize*0.5;var halfWidth=halfHeight*this.aspectRatio;Matrix4x4.createOrthoOffCenter(-halfWidth,halfWidth,-halfHeight,halfHeight,this.nearPlane,this.farPlane,this._projectionMatrix);}else {Matrix4x4.createPerspective(3.1416*this.fieldOfView/180.0,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);}}};_proto83._isLayerVisible=function _isLayerVisible(layer){return (Math.pow(2,layer)&this.cullingMask)!=0;};_proto83._onTransformChanged=function _onTransformChanged(flag){flag&=Transform3D.TRANSFORM_WORLDMATRIX;flag&&(this._updateViewMatrix=true);};_proto83._parse=function _parse(data,spriteMap){_BaseCamera.prototype._parse.call(this,data,spriteMap);var clearFlagData=data.clearFlag;clearFlagData!==undefined&&(this.clearFlag=clearFlagData);var viewport=data.viewport;this.normalizedViewport=new Viewport(viewport[0],viewport[1],viewport[2],viewport[3]);var enableHDR=data.enableHDR;enableHDR!==undefined&&(this.enableHDR=enableHDR);};_proto83._getCanvasWidth=function _getCanvasWidth(){if(this._offScreenRenderTexture)return this._offScreenRenderTexture.width;else return RenderContext3D.clientWidth;};_proto83._getCanvasHeight=function _getCanvasHeight(){if(this._offScreenRenderTexture)return this._offScreenRenderTexture.height;else return RenderContext3D.clientHeight;};_proto83._getRenderTexture=function _getRenderTexture(){return this._internalRenderTexture||this._offScreenRenderTexture;};_proto83._needInternalRenderTexture=function _needInternalRenderTexture(){return this._postProcess||this._enableHDR?true:false;};_proto83._applyPostProcessCommandBuffers=function _applyPostProcessCommandBuffers(){for(var i=0,n=this._postProcessCommandBuffers.length;i<n;i++){this._postProcessCommandBuffers[i]._apply();}};_proto83._getRenderTextureFormat=function _getRenderTextureFormat(){if(this._enableHDR)return Laya.RenderTextureFormat.R16G16B16A16;else return Laya.RenderTextureFormat.R8G8B8;};_proto83._prepareCameraToRender=function _prepareCameraToRender(){_BaseCamera.prototype._prepareCameraToRender.call(this);var vp=this.viewport;this._viewportParams.setValue(vp.x,vp.y,vp.width,vp.height);this._projectionParams.setValue(this._nearPlane,this._farPlane,RenderContext3D._instance.invertY?-1:1,0);this._shaderValues.setVector(BaseCamera.VIEWPORT,this._viewportParams);this._shaderValues.setVector(BaseCamera.PROJECTION_PARAMS,this._projectionParams);};_proto83._applyViewProject=function _applyViewProject(context,viewMat,proMat){var projectView;var shaderData=this._shaderValues;if(context.invertY){Matrix4x4.multiply(BaseCamera._invertYScaleMatrix,proMat,BaseCamera._invertYProjectionMatrix);Matrix4x4.multiply(BaseCamera._invertYProjectionMatrix,viewMat,BaseCamera._invertYProjectionViewMatrix);proMat=BaseCamera._invertYProjectionMatrix;projectView=BaseCamera._invertYProjectionViewMatrix;}else {Matrix4x4.multiply(proMat,viewMat,this._projectionViewMatrix);projectView=this._projectionViewMatrix;}context.viewMatrix=viewMat;context.projectionMatrix=proMat;context.projectionViewMatrix=projectView;shaderData.setMatrix4x4(BaseCamera.VIEWMATRIX,viewMat);shaderData.setMatrix4x4(BaseCamera.PROJECTMATRIX,proMat);shaderData.setMatrix4x4(BaseCamera.VIEWPROJECTMATRIX,projectView);};_proto83._updateClusterPlaneXY=function _updateClusterPlaneXY(){var fieldOfView=this.fieldOfView;var aspectRatio=this.aspectRatio;if(this._clusterPlaneCacheFlag.x!==fieldOfView||this._clusterPlaneCacheFlag.y!==aspectRatio){var clusterCount=Config3D._config.lightClusterCount;var xSlixe=clusterCount.x,ySlice=clusterCount.y;var xCount=xSlixe+1,yCount=ySlice+1;var xPlanes=this._clusterXPlanes,yPlanes=this._clusterYPlanes;if(!xPlanes){xPlanes=this._clusterXPlanes=new Array(xCount);yPlanes=this._clusterYPlanes=new Array(yCount);for(var i=0;i<xCount;i++){xPlanes[i]=new Vector3();}for(var i=0;i<yCount;i++){yPlanes[i]=new Vector3();}}var halfY=Math.tan(this.fieldOfView/2*Math.PI/180);var halfX=this.aspectRatio*halfY;var yLengthPerCluster=2*halfY/xSlixe;var xLengthPerCluster=2*halfX/ySlice;for(var i=0;i<xCount;i++){var angle=-halfX+xLengthPerCluster*i;var bigHypot=Math.sqrt(1+angle*angle);var normX=1/bigHypot;var xPlane=xPlanes[i];xPlane.setValue(normX,0,-angle*normX);}for(var i=0;i<yCount;i++){var angle=halfY-yLengthPerCluster*i;var bigHypot=Math.sqrt(1+angle*angle);var normY=-1/bigHypot;var yPlane=yPlanes[i];yPlane.setValue(0,normY,-angle*normY);}this._clusterPlaneCacheFlag.x=fieldOfView;this._clusterPlaneCacheFlag.y=aspectRatio;}};_proto83.render=function render(shader,replacementTag){if(shader===void 0){shader=null;}if(replacementTag===void 0){replacementTag=null;}if(!this.activeInHierarchy)return;var viewport=this.viewport;var needInternalRT=this._needInternalRenderTexture();var gl=Laya.LayaGL.instance;var context=RenderContext3D._instance;var scene=context.scene=this._scene;context.pipelineMode="Forward";if(needInternalRT){this._internalRenderTexture=RenderTexture.createFromPool(viewport.width,viewport.height,this._getRenderTextureFormat(),Laya.RenderTextureDepthFormat.DEPTH_16);this._internalRenderTexture.filterMode=Laya.FilterMode.Bilinear;}else {this._internalRenderTexture=null;}var shadowCasterPass;var mainDirectLight=scene._mainDirectionLight;var needShadowCasterPass=mainDirectLight&&mainDirectLight.shadowMode!==exports.ShadowMode.None&&ShadowUtils.supportShadow();if(needShadowCasterPass){scene._shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SPOT);scene._shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW);shadowCasterPass=ILaya3D.Scene3D._shadowCasterPass;shadowCasterPass.update(this,mainDirectLight,ILaya3D.ShadowLightType.DirectionLight);shadowCasterPass.render(context,scene,ILaya3D.ShadowLightType.DirectionLight);}else {scene._shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW);}var spotMainLight=scene._mainSpotLight;var spotneedShadowCasterPass=spotMainLight&&spotMainLight.shadowMode!==exports.ShadowMode.None&&ShadowUtils.supportShadow();if(spotneedShadowCasterPass){scene._shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW);scene._shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SPOT);shadowCasterPass=ILaya3D.Scene3D._shadowCasterPass;shadowCasterPass.update(this,spotMainLight,ILaya3D.ShadowLightType.SpotLight);shadowCasterPass.render(context,scene,ILaya3D.ShadowLightType.SpotLight);}else {scene._shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SPOT);}if(needShadowCasterPass)scene._shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW);if(spotneedShadowCasterPass)scene._shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SPOT);context.camera=this;context.cameraShaderValue=this._shaderValues;Camera._updateMark++;scene._preRenderScript();if(needInternalRT&&!this._offScreenRenderTexture&&(this.clearFlag==exports.CameraClearFlags.DepthOnly||this.clearFlag==exports.CameraClearFlags.Nothing)){if(this._enableHDR){var grabTexture=RenderTexture.createFromPool(viewport.width,viewport.height,Laya.RenderTextureFormat.R8G8B8,Laya.RenderTextureDepthFormat.DEPTH_16);grabTexture.filterMode=Laya.FilterMode.Bilinear;Laya.WebGLContext.bindTexture(gl,gl.TEXTURE_2D,grabTexture._getSource());gl.copyTexSubImage2D(gl.TEXTURE_2D,0,0,0,viewport.x,RenderContext3D.clientHeight-(viewport.y+viewport.height),viewport.width,viewport.height);var blit=BlitScreenQuadCMD.create(grabTexture,this._internalRenderTexture);blit.run();blit.recover();RenderTexture.recoverToPool(grabTexture);}else {Laya.WebGLContext.bindTexture(gl,gl.TEXTURE_2D,this._internalRenderTexture._getSource());gl.copyTexSubImage2D(gl.TEXTURE_2D,0,0,0,viewport.x,RenderContext3D.clientHeight-(viewport.y+viewport.height),viewport.width,viewport.height);}}var renderTex=this._getRenderTexture();renderTex&&renderTex._start();context.viewport=viewport;this._prepareCameraToRender();var multiLighting=Config3D._config._multiLighting;multiLighting&&Cluster.instance.update(this,this._scene);this._applyViewProject(context,this.viewMatrix,this._projectionMatrix);scene._preCulling(context,this,shader,replacementTag);scene._clear(gl,context);scene._renderScene(context);scene._postRenderScript();renderTex&&renderTex._end();if(needInternalRT){if(this._postProcess){this._postProcess._render();this._applyPostProcessCommandBuffers();}else if(this._enableHDR){var canvasWidth=this._getCanvasWidth(),canvasHeight=this._getCanvasHeight();this._screenOffsetScale.setValue(viewport.x/canvasWidth,viewport.y/canvasHeight,viewport.width/canvasWidth,viewport.height/canvasHeight);var blit=BlitScreenQuadCMD.create(this._internalRenderTexture,this._offScreenRenderTexture?this._offScreenRenderTexture:null,this._screenOffsetScale);blit.run();blit.recover();}RenderTexture.recoverToPool(this._internalRenderTexture);}if(needShadowCasterPass||spotneedShadowCasterPass)shadowCasterPass.cleanUp();};_proto83.viewportPointToRay=function viewportPointToRay(point,out){Picker.calculateCursorRay(point,this.viewport,this._projectionMatrix,this.viewMatrix,null,out);};_proto83.normalizedViewportPointToRay=function normalizedViewportPointToRay(point,out){var finalPoint=Camera._tempVector20;var vp=this.viewport;finalPoint.x=point.x*vp.width;finalPoint.y=point.y*vp.height;Picker.calculateCursorRay(finalPoint,this.viewport,this._projectionMatrix,this.viewMatrix,null,out);};_proto83.worldToViewportPoint=function worldToViewportPoint(position,out){Matrix4x4.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix);this.viewport.project(position,this._projectionViewMatrix,out);out.x=out.x/Laya.Laya.stage.clientScaleX;out.y=out.y/Laya.Laya.stage.clientScaleY;};_proto83.worldToNormalizedViewportPoint=function worldToNormalizedViewportPoint(position,out){Matrix4x4.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix);this.normalizedViewport.project(position,this._projectionViewMatrix,out);out.x=out.x/Laya.Laya.stage.clientScaleX;out.y=out.y/Laya.Laya.stage.clientScaleY;};_proto83.convertScreenCoordToOrthographicCoord=function convertScreenCoordToOrthographicCoord(source,out){if(this._orthographic){var clientWidth=RenderContext3D.clientWidth;var clientHeight=RenderContext3D.clientHeight;var ratioX=this.orthographicVerticalSize*this.aspectRatio/clientWidth;var ratioY=this.orthographicVerticalSize/clientHeight;out.x=(-clientWidth/2+source.x*Laya.Laya.stage.clientScaleX)*ratioX;out.y=(clientHeight/2-source.y*Laya.Laya.stage.clientScaleY)*ratioY;out.z=(this.nearPlane-this.farPlane)*(source.z+1)/2-this.nearPlane;Vector3.transformCoordinate(out,this.transform.worldMatrix,out);return true;}else {return false;}};_proto83.destroy=function destroy(destroyChild){if(destroyChild===void 0){destroyChild=true;}this._offScreenRenderTexture=null;this.transform.off(Laya.Event.TRANSFORM_CHANGED,this,this._onTransformChanged);_BaseCamera.prototype.destroy.call(this,destroyChild);};_proto83.addCommandBuffer=function addCommandBuffer(event,commandBuffer){switch(event){case Camera.CAMERAEVENT_POSTPROCESS:this._postProcessCommandBuffers.push(commandBuffer);commandBuffer._camera=this;break;default:throw "Camera:unknown event.";}};_proto83.removeCommandBuffer=function removeCommandBuffer(event,commandBuffer){switch(event){case Camera.CAMERAEVENT_POSTPROCESS:var index=this._postProcessCommandBuffers.indexOf(commandBuffer);if(index!==-1)this._postProcessCommandBuffers.splice(index,1);break;default:throw "Camera:unknown event.";}};_proto83.removeCommandBuffers=function removeCommandBuffers(event){switch(event){case Camera.CAMERAEVENT_POSTPROCESS:this._postProcessCommandBuffers.length=0;break;default:throw "Camera:unknown event.";}};_proto83._create=function _create(){return new Camera();};_createClass(Camera,[{key:"aspectRatio",get:function get(){if(this._aspectRatio===0){var vp=this.viewport;return vp.width/vp.height;}return this._aspectRatio;},set:function set(value){if(value<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=value;this._calculateProjectionMatrix();}},{key:"viewport",get:function get(){if(this._offScreenRenderTexture)this._calculationViewport(this._normalizedViewport,this._offScreenRenderTexture.width,this._offScreenRenderTexture.height);else this._calculationViewport(this._normalizedViewport,RenderContext3D.clientWidth,RenderContext3D.clientHeight);return this._viewport;},set:function set(value){var width;var height;if(this._offScreenRenderTexture){width=this._offScreenRenderTexture.width;height=this._offScreenRenderTexture.height;}else {width=RenderContext3D.clientWidth;height=RenderContext3D.clientHeight;}this._normalizedViewport.x=value.x/width;this._normalizedViewport.y=value.y/height;this._normalizedViewport.width=value.width/width;this._normalizedViewport.height=value.height/height;this._calculationViewport(this._normalizedViewport,width,height);this._calculateProjectionMatrix();}},{key:"normalizedViewport",get:function get(){return this._normalizedViewport;},set:function set(value){var width;var height;if(this._offScreenRenderTexture){width=this._offScreenRenderTexture.width;height=this._offScreenRenderTexture.height;}else {width=RenderContext3D.clientWidth;height=RenderContext3D.clientHeight;}if(this._normalizedViewport!==value)value.cloneTo(this._normalizedViewport);this._calculationViewport(value,width,height);this._calculateProjectionMatrix();}},{key:"viewMatrix",get:function get(){if(this._updateViewMatrix){var scale=this.transform.getWorldLossyScale();var scaleX=scale.x;var scaleY=scale.y;var scaleZ=scale.z;var viewMatE=this._viewMatrix.elements;this.transform.worldMatrix.cloneTo(this._viewMatrix);viewMatE[0]/=scaleX;viewMatE[1]/=scaleX;viewMatE[2]/=scaleX;viewMatE[4]/=scaleY;viewMatE[5]/=scaleY;viewMatE[6]/=scaleY;viewMatE[8]/=scaleZ;viewMatE[9]/=scaleZ;viewMatE[10]/=scaleZ;this._viewMatrix.invert(this._viewMatrix);this._updateViewMatrix=false;}return this._viewMatrix;}},{key:"projectionMatrix",get:function get(){return this._projectionMatrix;},set:function set(value){this._projectionMatrix=value;this._useUserProjectionMatrix=true;}},{key:"projectionViewMatrix",get:function get(){Matrix4x4.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix);return this._projectionViewMatrix;}},{key:"boundFrustum",get:function get(){this._boundFrustum.matrix=this.projectionViewMatrix;if(Laya.Render.supportWebGLPlusCulling){var near=this._boundFrustum.near;var far=this._boundFrustum.far;var left=this._boundFrustum.left;var right=this._boundFrustum.right;var top=this._boundFrustum.top;var bottom=this._boundFrustum.bottom;var nearNE=near.normal;var farNE=far.normal;var leftNE=left.normal;var rightNE=right.normal;var topNE=top.normal;var bottomNE=bottom.normal;var buffer=this._boundFrustumBuffer;buffer[0]=nearNE.x,buffer[1]=nearNE.y,buffer[2]=nearNE.z,buffer[3]=near.distance;buffer[4]=farNE.x,buffer[5]=farNE.y,buffer[6]=farNE.z,buffer[7]=far.distance;buffer[8]=leftNE.x,buffer[9]=leftNE.y,buffer[10]=leftNE.z,buffer[11]=left.distance;buffer[12]=rightNE.x,buffer[13]=rightNE.y,buffer[14]=rightNE.z,buffer[15]=right.distance;buffer[16]=topNE.x,buffer[17]=topNE.y,buffer[18]=topNE.z,buffer[19]=top.distance;buffer[20]=bottomNE.x,buffer[21]=bottomNE.y,buffer[22]=bottomNE.z,buffer[23]=bottom.distance;}return this._boundFrustum;}},{key:"renderTarget",get:function get(){return this._offScreenRenderTexture;},set:function set(value){var lastValue=this._offScreenRenderTexture;if(lastValue!==value){lastValue&&(lastValue._isCameraTarget=false);value&&(value._isCameraTarget=true);this._offScreenRenderTexture=value;this._calculateProjectionMatrix();}}},{key:"postProcess",get:function get(){return this._postProcess;},set:function set(value){this._postProcess=value;var postProcessCommandBuffer=new CommandBuffer();this.addCommandBuffer(Camera.CAMERAEVENT_POSTPROCESS,postProcessCommandBuffer);value._init(this,postProcessCommandBuffer);}},{key:"enableHDR",get:function get(){return this._enableHDR;},set:function set(value){if(value&&!Laya.SystemUtils.supportRenderTextureFormat(Laya.RenderTextureFormat.R16G16B16A16)){console.warn("Camera:can't enable HDR in this device.");return;}this._enableHDR=value;}}]);return Camera;}(BaseCamera);Camera.CAMERAEVENT_POSTPROCESS=0;Camera._tempVector20=new Vector2();Camera._updateMark=0;var Input3D=/*#__PURE__*/function(){function Input3D(){var _this39=this;this._eventList=[];this._mouseTouch=new MouseTouch();this._touchPool=[];this._touches=new SimpleSingletonList();this._multiTouchEnabled=true;this._pushEventList=function(e){e.cancelable&&e.preventDefault();_this39._eventList.push(e);}.bind(this);}var _proto84=Input3D.prototype;_proto84.__init__=function __init__(canvas,scene){this._scene=scene;canvas.oncontextmenu=function(e){return false;};};_proto84._onCanvasEvent=function _onCanvasEvent(canvas){canvas.addEventListener('mousedown',this._pushEventList);canvas.addEventListener('mouseup',this._pushEventList,true);canvas.addEventListener('mousemove',this._pushEventList,true);canvas.addEventListener("touchstart",this._pushEventList);canvas.addEventListener("touchend",this._pushEventList,true);canvas.addEventListener("touchmove",this._pushEventList,true);canvas.addEventListener("touchcancel",this._pushEventList,true);};_proto84._offCanvasEvent=function _offCanvasEvent(canvas){canvas.removeEventListener('mousedown',this._pushEventList);canvas.removeEventListener('mouseup',this._pushEventList,true);canvas.removeEventListener('mousemove',this._pushEventList,true);canvas.removeEventListener("touchstart",this._pushEventList);canvas.removeEventListener("touchend",this._pushEventList,true);canvas.removeEventListener("touchmove",this._pushEventList,true);canvas.removeEventListener("touchcancel",this._pushEventList,true);this._eventList.length=0;this._touches.clear();};_proto84.touchCount=function touchCount(){return this._touches.length;};_proto84._getTouch=function _getTouch(touchID,type){var touch=this._touchPool[touchID];if(type==0&&touch&&touch._getIndexInList()!=-1)return null;if(type==1&&touch&&touch._getIndexInList()==-1)return null;if(!touch){touch=new Touch();this._touchPool[touchID]=touch;touch._identifier=touchID;}return touch;};_proto84._mouseTouchDown=function _mouseTouchDown(){var touch=this._mouseTouch;var sprite=touch.sprite;touch._pressedSprite=sprite;touch._pressedLoopCount=Laya.Stat.loopCount;if(sprite){var scripts=sprite._scripts;if(scripts){for(var i=0,n=scripts.length;i<n;i++){scripts[i].onMouseDown();}}}};_proto84._mouseTouchUp=function _mouseTouchUp(){var i,n;var touch=this._mouseTouch;var lastPressedSprite=touch._pressedSprite;touch._pressedSprite=null;touch._pressedLoopCount=-1;var sprite=touch.sprite;if(sprite){if(sprite===lastPressedSprite){var scripts=sprite._scripts;if(scripts){for(i=0,n=scripts.length;i<n;i++){scripts[i].onMouseClick();}}}}if(lastPressedSprite){var lastScripts=lastPressedSprite._scripts;if(lastScripts){for(i=0,n=lastScripts.length;i<n;i++){lastScripts[i].onMouseUp();}}}};_proto84._mouseTouchRayCast=function _mouseTouchRayCast(cameras){var touchHitResult=Input3D._tempHitResult0;var touchPos=Input3D._tempVector20;var touchRay=Input3D._tempRay0;touchHitResult.succeeded=false;var x=this._mouseTouch.mousePositionX;var y=this._mouseTouch.mousePositionY;touchPos.x=x;touchPos.y=y;for(var i=cameras.length-1;i>=0;i--){var camera=cameras[i];var viewport=camera.viewport;if(touchPos.x>=viewport.x&&touchPos.y>=viewport.y&&touchPos.x<=viewport.width&&touchPos.y<=viewport.height){camera.viewportPointToRay(touchPos,touchRay);var sucess=this._scene._physicsSimulation.rayCast(touchRay,touchHitResult);if(sucess||camera.clearFlag===exports.CameraClearFlags.SolidColor||camera.clearFlag===exports.CameraClearFlags.Sky)break;}}var touch=this._mouseTouch;var lastSprite=touch.sprite;if(touchHitResult.succeeded){var touchSprite=touchHitResult.collider.owner;touch.sprite=touchSprite;var scripts=touchSprite._scripts;if(lastSprite!==touchSprite){if(scripts){for(var j=0,m=scripts.length;j<m;j++){scripts[j].onMouseEnter();}}}}else {touch.sprite=null;}if(lastSprite&&lastSprite!==touchSprite){var outScripts=lastSprite._scripts;if(outScripts){for(j=0,m=outScripts.length;j<m;j++){outScripts[j].onMouseOut();}}}};_proto84._changeTouches=function _changeTouches(changedTouches,flag){var offsetX=0,offsetY=0;var lastCount=this._touches.length;for(var j=0,m=changedTouches.length;j<m;j++){var nativeTouch=changedTouches[j];var identifier=nativeTouch.identifier;if(!this._multiTouchEnabled&&identifier!==0)continue;var touch=this._getTouch(identifier,flag);var pos=this._touchPool[identifier]._position;var mousePoint=Input3D._tempPoint;mousePoint.setTo(nativeTouch.pageX,nativeTouch.pageY);Laya.ILaya.stage._canvasTransform.invertTransformPoint(mousePoint);var posX=mousePoint.x;var posY=mousePoint.y;switch(flag){case 0:if(!!touch)this._touches.add(touch);offsetX+=posX;offsetY+=posY;break;case 1:if(!!touch)this._touches.remove(touch);offsetX-=posX;offsetY-=posY;break;case 2:offsetX=posX-pos.x;offsetY=posY-pos.y;break;}pos.x=posX;pos.y=posY;}var touchCount=this._touches.length;if(touchCount===0){this._mouseTouch.mousePositionX=0;this._mouseTouch.mousePositionY=0;}else {this._mouseTouch.mousePositionX=(this._mouseTouch.mousePositionX*lastCount+offsetX)/touchCount;this._mouseTouch.mousePositionY=(this._mouseTouch.mousePositionY*lastCount+offsetY)/touchCount;}};_proto84._update=function _update(){var enablePhysics=Physics3D._enablePhysics&&!PhysicsSimulation.disableSimulation;var i,n,j,m;n=this._eventList.length;var cameras=this._scene._cameraPool;if(n>0){var rayCast=false;for(i=0;i<n;i++){var e=this._eventList[i];switch(e.type){case"mousedown":enablePhysics&&this._mouseTouchDown();break;case"mouseup":enablePhysics&&this._mouseTouchUp();break;case"mousemove":var mousePoint=Input3D._tempPoint;mousePoint.setTo(e.pageX,e.pageY);Laya.ILaya.stage._canvasTransform.invertTransformPoint(mousePoint);this._mouseTouch.mousePositionX=mousePoint.x;this._mouseTouch.mousePositionY=mousePoint.y;enablePhysics&&(rayCast=true);break;case"touchstart":var lastLength=this._touches.length;this._changeTouches(e.changedTouches,0);if(enablePhysics){!Config3D._config.isUseCannonPhysicsEngine&&this._mouseTouchRayCast(cameras);lastLength===0&&this._mouseTouchDown();}break;case"touchend":case"touchcancel":this._changeTouches(e.changedTouches,1);enablePhysics&&this._touches.length===0&&this._mouseTouchUp();break;case"touchmove":this._changeTouches(e.changedTouches,2);enablePhysics&&(rayCast=true);break;default:throw "Input3D:unkonwn event type.";}}rayCast&&!Config3D._config.isUseCannonPhysicsEngine&&this._mouseTouchRayCast(cameras);this._eventList.length=0;}if(enablePhysics){var mouseTouch=this._mouseTouch;var pressedSprite=mouseTouch._pressedSprite;if(pressedSprite&&Laya.Stat.loopCount>mouseTouch._pressedLoopCount){var pressedScripts=pressedSprite._scripts;if(pressedScripts){for(j=0,m=pressedScripts.length;j<m;j++){pressedScripts[j].onMouseDrag();}}}var touchSprite=mouseTouch.sprite;if(touchSprite){var scripts=touchSprite._scripts;if(scripts){for(j=0,m=scripts.length;j<m;j++){scripts[j].onMouseOver();}}}}};_proto84.getTouch=function getTouch(index){if(index<this._touches.length){return this._touches.elements[index];}else {return null;}};_createClass(Input3D,[{key:"multiTouchEnabled",get:function get(){return this._multiTouchEnabled;},set:function set(value){this._multiTouchEnabled=value;}}]);return Input3D;}();Input3D._tempPoint=new Laya.Point();Input3D._tempVector20=new Vector2();Input3D._tempRay0=new Ray(new Vector3(),new Vector3());Input3D._tempHitResult0=new HitResult();var PhysicsSettings=function PhysicsSettings(){this.flags=0;this.maxSubSteps=1;this.fixedTimeStep=1.0/60.0;};var VertexPositionTexture0=/*#__PURE__*/function(){function VertexPositionTexture0(position,textureCoordinate0){this._position=position;this._textureCoordinate0=textureCoordinate0;}VertexPositionTexture0.__init__=function __init__(){VertexPositionTexture0._vertexDeclaration=new VertexDeclaration(20,[new VertexElement(0,VertexElementFormat.Vector3,VertexMesh.MESH_POSITION0),new VertexElement(12,VertexElementFormat.Vector2,VertexMesh.MESH_TEXTURECOORDINATE0)]);};_createClass(VertexPositionTexture0,[{key:"position",get:function get(){return this._position;}},{key:"textureCoordinate0",get:function get(){return this._textureCoordinate0;}},{key:"vertexDeclaration",get:function get(){return VertexPositionTexture0._vertexDeclaration;}}],[{key:"vertexDeclaration",get:function get(){return VertexPositionTexture0._vertexDeclaration;}}]);return VertexPositionTexture0;}();var SkyDome=/*#__PURE__*/function(_SkyMesh2){_inheritsLoose(SkyDome,_SkyMesh2);function SkyDome(stacks,slices){var _this40;if(stacks===void 0){stacks=48;}if(slices===void 0){slices=48;}_this40=_SkyMesh2.call(this)||this;var gl=Laya.LayaGL.instance;_this40._stacks=stacks;_this40._slices=slices;var vertexDeclaration=VertexPositionTexture0.vertexDeclaration;var vertexFloatCount=vertexDeclaration.vertexStride/4;var numberVertices=(_this40._stacks+1)*(_this40._slices+1);var numberIndices=3*_this40._stacks*(_this40._slices+1)*2;var vertices=new Float32Array(numberVertices*vertexFloatCount);var indices=new Uint16Array(numberIndices);var stackAngle=Math.PI/_this40._stacks;var sliceAngle=Math.PI*2.0/_this40._slices;var vertexIndex=0;var vertexCount=0;var indexCount=0;for(var stack=0;stack<_this40._stacks+1;stack++){var r=Math.sin(stack*stackAngle);var y=Math.cos(stack*stackAngle);for(var slice=0;slice<_this40._slices+1;slice++){var x=r*Math.sin(slice*sliceAngle);var z=r*Math.cos(slice*sliceAngle);vertices[vertexCount+0]=x*SkyDome._radius;vertices[vertexCount+1]=y*SkyDome._radius;vertices[vertexCount+2]=z*SkyDome._radius;vertices[vertexCount+3]=-(slice/_this40._slices)+0.75;vertices[vertexCount+4]=stack/_this40._stacks;vertexCount+=vertexFloatCount;if(stack!=_this40._stacks-1){indices[indexCount++]=vertexIndex+1;indices[indexCount++]=vertexIndex;indices[indexCount++]=vertexIndex+(_this40._slices+1);indices[indexCount++]=vertexIndex+(_this40._slices+1);indices[indexCount++]=vertexIndex;indices[indexCount++]=vertexIndex+_this40._slices;vertexIndex++;}}}_this40._vertexBuffer=new VertexBuffer3D(vertices.length*4,gl.STATIC_DRAW,false);_this40._vertexBuffer.vertexDeclaration=vertexDeclaration;_this40._indexBuffer=new IndexBuffer3D(exports.IndexFormat.UInt16,indices.length,gl.STATIC_DRAW,false);_this40._vertexBuffer.setData(vertices.buffer);_this40._indexBuffer.setData(indices);var bufferState=new BufferState();bufferState.bind();bufferState.applyVertexBuffer(_this40._vertexBuffer);bufferState.applyIndexBuffer(_this40._indexBuffer);bufferState.unBind();_this40._bufferState=bufferState;return _this40;}SkyDome.__init__=function __init__(){SkyDome.instance=new SkyDome();};var _proto85=SkyDome.prototype;_proto85._render=function _render(state){var gl=Laya.LayaGL.instance;var indexCount=this._indexBuffer.indexCount;gl.drawElements(gl.TRIANGLES,indexCount,gl.UNSIGNED_SHORT,0);Laya.Stat.trianglesFaces+=indexCount/3;Laya.Stat.renderBatches++;};_createClass(SkyDome,[{key:"stacks",get:function get(){return this._stacks;}},{key:"slices",get:function get(){return this._slices;}}]);return SkyDome;}(SkyMesh);SkyDome._radius=1;(function(TextureCubeFace){TextureCubeFace[TextureCubeFace["PositiveX"]=0]="PositiveX";TextureCubeFace[TextureCubeFace["NegativeX"]=1]="NegativeX";TextureCubeFace[TextureCubeFace["PositiveY"]=2]="PositiveY";TextureCubeFace[TextureCubeFace["NegativeY"]=3]="NegativeY";TextureCubeFace[TextureCubeFace["PositiveZ"]=4]="PositiveZ";TextureCubeFace[TextureCubeFace["NegativeZ"]=5]="NegativeZ";})(exports.TextureCubeFace||(exports.TextureCubeFace={}));var TextureCube=/*#__PURE__*/function(_Laya$BaseTexture2){_inheritsLoose(TextureCube,_Laya$BaseTexture2);function TextureCube(size,format,mipmap){var _this41;if(format===void 0){format=Laya.TextureFormat.R8G8B8;}if(mipmap===void 0){mipmap=false;}_this41=_Laya$BaseTexture2.call(this,format,mipmap)||this;_this41._glTextureType=Laya.LayaGL.instance.TEXTURE_CUBE_MAP;_this41._width=size;_this41._height=size;var gl=Laya.LayaGL.instance;_this41._setWarpMode(gl.TEXTURE_WRAP_S,_this41._wrapModeU);_this41._setWarpMode(gl.TEXTURE_WRAP_T,_this41._wrapModeV);_this41._setFilterMode(_this41._filterMode);_this41._setAnisotropy(_this41._anisoLevel);if(_this41._mipmap){_this41._mipmapCount=Math.ceil(Math.log2(size))+1;for(var i=0;i<_this41._mipmapCount;i++){_this41._setPixels([],i,Math.max(size>>i,1),Math.max(size>>i,1));}_this41._setGPUMemory(size*size*4*(1+1/3)*6);}else {_this41._mipmapCount=1;_this41._setGPUMemory(size*size*4*6);}return _this41;}TextureCube.__init__=function __init__(){var blackTexture=new TextureCube(1,Laya.TextureFormat.R8G8B8,false);var grayTexture=new TextureCube(1,Laya.TextureFormat.R8G8B8,false);var pixels=new Uint8Array(3);pixels[0]=0,pixels[1]=0,pixels[2]=0;blackTexture.setSixSidePixels([pixels,pixels,pixels,pixels,pixels,pixels]);blackTexture.lock=true;pixels[0]=128,pixels[1]=128,pixels[2]=128;grayTexture.setSixSidePixels([pixels,pixels,pixels,pixels,pixels,pixels]);grayTexture.lock=true;TextureCube._grayTexture=grayTexture;TextureCube._blackTexture=blackTexture;};TextureCube._parse=function _parse(data,propertyParams,constructParams){if(constructParams===void 0){constructParams=null;}var texture=constructParams?new TextureCube(0,constructParams[0],constructParams[1]):new TextureCube(0);texture.setSixSideImageSources(data);return texture;};TextureCube._parseBin=function _parseBin(data,propertyParams,constructParams){if(constructParams===void 0){constructParams=null;}var texture=constructParams?new TextureCube(0,constructParams[0],constructParams[1]):new TextureCube(0);texture.setSixSideImageSources(data);return texture;};TextureCube.load=function load(url,complete){Laya.ILaya.loader.create(url,complete,null,TextureCube.TEXTURECUBE);};var _proto86=TextureCube.prototype;_proto86._setPixels=function _setPixels(pixels,miplevel,width,height){var gl=Laya.LayaGL.instance;var glFormat=this._getGLFormat();Laya.WebGLContext.bindTexture(gl,this._glTextureType,this._glTexture);if(this.format===Laya.TextureFormat.R8G8B8){gl.pixelStorei(gl.UNPACK_ALIGNMENT,1);gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_Z,miplevel,glFormat,width,height,0,glFormat,gl.UNSIGNED_BYTE,pixels[0]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_Z,miplevel,glFormat,width,height,0,glFormat,gl.UNSIGNED_BYTE,pixels[1]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X,miplevel,glFormat,width,height,0,glFormat,gl.UNSIGNED_BYTE,pixels[2]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_X,miplevel,glFormat,width,height,0,glFormat,gl.UNSIGNED_BYTE,pixels[3]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_Y,miplevel,glFormat,width,height,0,glFormat,gl.UNSIGNED_BYTE,pixels[4]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,miplevel,glFormat,width,height,0,glFormat,gl.UNSIGNED_BYTE,pixels[5]);gl.pixelStorei(gl.UNPACK_ALIGNMENT,4);}else {gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_Z,miplevel,glFormat,width,height,0,glFormat,gl.UNSIGNED_BYTE,pixels[0]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_Z,miplevel,glFormat,width,height,0,glFormat,gl.UNSIGNED_BYTE,pixels[1]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X,miplevel,glFormat,width,height,0,glFormat,gl.UNSIGNED_BYTE,pixels[2]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_X,miplevel,glFormat,width,height,0,glFormat,gl.UNSIGNED_BYTE,pixels[3]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_Y,miplevel,glFormat,width,height,0,glFormat,gl.UNSIGNED_BYTE,pixels[4]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,miplevel,glFormat,width,height,0,glFormat,gl.UNSIGNED_BYTE,pixels[5]);}};_proto86.setSixSideImageSources=function setSixSideImageSources(source,premultiplyAlpha){if(premultiplyAlpha===void 0){premultiplyAlpha=false;}var width;var height;for(var i=0;i<6;i++){var img=source[i];if(!img){console.log("TextureCube: image Source can't be null.");return;}var nextWidth=img.width;var nextHeight=img.height;if(i>0){if(width!==nextWidth){console.log("TextureCube: each side image's width and height must same.");return;}}width=nextWidth;height=nextHeight;if(width!==height){console.log("TextureCube: each side image's width and height must same.");return;}}this._width=width;this._height=height;var gl=Laya.LayaGL.instance;Laya.WebGLContext.bindTexture(gl,this._glTextureType,this._glTexture);var glFormat=this._getGLFormat();if(!Laya.Render.isConchApp){premultiplyAlpha&&gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_Z,0,glFormat,glFormat,gl.UNSIGNED_BYTE,source[0]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,glFormat,glFormat,gl.UNSIGNED_BYTE,source[1]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X,0,glFormat,glFormat,gl.UNSIGNED_BYTE,source[2]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_X,0,glFormat,glFormat,gl.UNSIGNED_BYTE,source[3]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_Y,0,glFormat,glFormat,gl.UNSIGNED_BYTE,source[4]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,glFormat,glFormat,gl.UNSIGNED_BYTE,source[5]);premultiplyAlpha&&gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,false);}else {if(premultiplyAlpha==true){for(var j=0;j<6;j++){source[j].setPremultiplyAlpha(premultiplyAlpha);}}gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_Z,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,source[0]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,source[1]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,source[2]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_X,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,source[3]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_Y,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,source[4]);gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,source[5]);}if(this._mipmap&&this._isPot(width)&&this._isPot(height)){gl.generateMipmap(this._glTextureType);this._setGPUMemory(width*height*4*(1+1/3)*6);}else {this._setGPUMemory(width*height*4*6);}this._setWarpMode(gl.TEXTURE_WRAP_S,this._wrapModeU);this._setWarpMode(gl.TEXTURE_WRAP_T,this._wrapModeV);this._setFilterMode(this._filterMode);this._readyed=true;this._activeResource();};_proto86.setSixSidePixels=function setSixSidePixels(pixels,miplevel){if(miplevel===void 0){miplevel=0;}if(!pixels)throw new Error("TextureCube:pixels can't be null.");var width=Math.max(this._width>>miplevel,1);var height=Math.max(this._height>>miplevel,1);var pixelsCount=width*height*this._getFormatByteCount();if(pixels[0].length<pixelsCount)throw "TextureCube:pixels length should at least "+pixelsCount+".";this._setPixels(pixels,miplevel,width,height);if(miplevel===0){var gl=Laya.LayaGL.instance;this._setWarpMode(gl.TEXTURE_WRAP_S,this._wrapModeU);this._setWarpMode(gl.TEXTURE_WRAP_T,this._wrapModeV);}this._readyed=true;this._activeResource();};_proto86.setImageSource=function setImageSource(face,imageSource,miplevel){if(miplevel===void 0){miplevel=0;}var width=this._width;var height=this._height;if(imageSource){if(width!==imageSource.width||height!==imageSource.height){console.log("TextureCube: imageSource's width and height must same.");return;}}var gl=Laya.LayaGL.instance;Laya.WebGLContext.bindTexture(gl,this._glTextureType,this._glTexture);var glFormat=this._getGLFormat();switch(face){case exports.TextureCubeFace.NegativeX:gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_X,miplevel,glFormat,glFormat,gl.UNSIGNED_BYTE,imageSource);break;case exports.TextureCubeFace.PositiveX:gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X,miplevel,glFormat,glFormat,gl.UNSIGNED_BYTE,imageSource);break;case exports.TextureCubeFace.NegativeY:gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,miplevel,glFormat,glFormat,gl.UNSIGNED_BYTE,imageSource);break;case exports.TextureCubeFace.PositiveY:gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_Y,miplevel,glFormat,glFormat,gl.UNSIGNED_BYTE,imageSource);break;case exports.TextureCubeFace.NegativeZ:gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_Z,miplevel,glFormat,glFormat,gl.UNSIGNED_BYTE,imageSource);break;case exports.TextureCubeFace.PositiveZ:gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_Z,miplevel,glFormat,glFormat,gl.UNSIGNED_BYTE,imageSource);break;}if(this._mipmap&&this._isPot(width)&&this._isPot(height)){gl.generateMipmap(this._glTextureType);this._setGPUMemory(width*height*4*(1+1/3)*6);}else {this._setGPUMemory(width*height*4*6);}this._setWarpMode(gl.TEXTURE_WRAP_S,this._wrapModeU);this._setWarpMode(gl.TEXTURE_WRAP_T,this._wrapModeV);this._setFilterMode(this._filterMode);this._readyed=true;};_createClass(TextureCube,[{key:"defaulteTexture",get:function get(){return TextureCube.grayTexture;}}],[{key:"blackTexture",get:function get(){return TextureCube._blackTexture;}},{key:"grayTexture",get:function get(){return TextureCube._grayTexture;}}]);return TextureCube;}(Laya.BaseTexture);TextureCube.TEXTURECUBE="TEXTURECUBE";var LightQueue=/*#__PURE__*/function(){function LightQueue(){this._length=0;this._elements=[];}var _proto87=LightQueue.prototype;_proto87.add=function add(light){if(this._length===this._elements.length)this._elements.push(light);else this._elements[this._length]=light;this._length++;};_proto87.remove=function remove(light){var index=this._elements.indexOf(light);this._length--;if(index!==this._length){var end=this._elements[this._length];this._elements[index]=end;}};_proto87.shift=function shift(){this._length--;return this._elements.shift();};_proto87.getBrightestLight=function getBrightestLight(){var maxIntIndex;var maxIntensity=-1;var elements=this._elements;for(var i=0;i<this._length;i++){var intensity=elements[i]._intensity;if(maxIntensity<intensity){maxIntensity=intensity;maxIntIndex=i;}}return maxIntIndex;};_proto87.normalLightOrdering=function normalLightOrdering(brightestIndex){var slements=this._elements;var firstLight=this._elements[0];this._elements[0]=this._elements[brightestIndex];this._elements[brightestIndex]=firstLight;};return LightQueue;}();var AlternateLightQueue=/*#__PURE__*/function(_LightQueue){_inheritsLoose(AlternateLightQueue,_LightQueue);function AlternateLightQueue(){return _LightQueue.apply(this,arguments)||this;}var _proto88=AlternateLightQueue.prototype;_proto88.remove=function remove(light){var index=this._elements.indexOf(light);this._elements.splice(index,1);this._length--;};return AlternateLightQueue;}(LightQueue);var PixelLineMaterial=/*#__PURE__*/function(_Material5){_inheritsLoose(PixelLineMaterial,_Material5);function PixelLineMaterial(){var _this42;_this42=_Material5.call(this)||this;_this42.setShaderName("LineShader");_this42._shaderValues.setVector(PixelLineMaterial.COLOR,new Vector4(1.0,1.0,1.0,1.0));return _this42;}PixelLineMaterial.__initDefine__=function __initDefine__(){};var _proto89=PixelLineMaterial.prototype;_proto89.clone=function clone(){var dest=new PixelLineMaterial();this.cloneTo(dest);return dest;};_createClass(PixelLineMaterial,[{key:"color",get:function get(){return this._shaderValues.getVector(PixelLineMaterial.COLOR);},set:function set(value){this._shaderValues.setVector(PixelLineMaterial.COLOR,value);}},{key:"depthWrite",set:function set(value){this._shaderValues.setBool(PixelLineMaterial.DEPTH_WRITE,value);},get:function get(){return this._shaderValues.getBool(PixelLineMaterial.DEPTH_WRITE);}},{key:"cull",set:function set(value){this._shaderValues.setInt(PixelLineMaterial.CULL,value);},get:function get(){return this._shaderValues.getInt(PixelLineMaterial.CULL);}},{key:"blend",set:function set(value){this._shaderValues.setInt(PixelLineMaterial.BLEND,value);},get:function get(){return this._shaderValues.getInt(PixelLineMaterial.BLEND);}},{key:"blendSrc",set:function set(value){this._shaderValues.setInt(PixelLineMaterial.BLEND_SRC,value);},get:function get(){return this._shaderValues.getInt(PixelLineMaterial.BLEND_SRC);}},{key:"blendDst",set:function set(value){this._shaderValues.setInt(PixelLineMaterial.BLEND_DST,value);},get:function get(){return this._shaderValues.getInt(PixelLineMaterial.BLEND_DST);}},{key:"depthTest",set:function set(value){this._shaderValues.setInt(PixelLineMaterial.DEPTH_TEST,value);},get:function get(){return this._shaderValues.getInt(PixelLineMaterial.DEPTH_TEST);}}]);return PixelLineMaterial;}(Material);PixelLineMaterial.COLOR=Shader3D.propertyNameToID("u_Color");PixelLineMaterial.CULL=Shader3D.propertyNameToID("s_Cull");PixelLineMaterial.BLEND=Shader3D.propertyNameToID("s_Blend");PixelLineMaterial.BLEND_SRC=Shader3D.propertyNameToID("s_BlendSrc");PixelLineMaterial.BLEND_DST=Shader3D.propertyNameToID("s_BlendDst");PixelLineMaterial.DEPTH_TEST=Shader3D.propertyNameToID("s_DepthTest");PixelLineMaterial.DEPTH_WRITE=Shader3D.propertyNameToID("s_DepthWrite");var BoundBox=/*#__PURE__*/function(){function BoundBox(min,max){this.min=min;this.max=max;}var _proto90=BoundBox.prototype;_proto90._rotateExtents=function _rotateExtents(extents,rotation,out){var extentsX=extents.x;var extentsY=extents.y;var extentsZ=extents.z;var matElements=rotation.elements;out.x=Math.abs(matElements[0]*extentsX)+Math.abs(matElements[4]*extentsY)+Math.abs(matElements[8]*extentsZ);out.y=Math.abs(matElements[1]*extentsX)+Math.abs(matElements[5]*extentsY)+Math.abs(matElements[9]*extentsZ);out.z=Math.abs(matElements[2]*extentsX)+Math.abs(matElements[6]*extentsY)+Math.abs(matElements[10]*extentsZ);};_proto90.getCorners=function getCorners(corners){corners.length=8;var minX=this.min.x;var minY=this.min.y;var minZ=this.min.z;var maxX=this.max.x;var maxY=this.max.y;var maxZ=this.max.z;corners[0]=new Vector3(minX,maxY,maxZ);corners[1]=new Vector3(maxX,maxY,maxZ);corners[2]=new Vector3(maxX,minY,maxZ);corners[3]=new Vector3(minX,minY,maxZ);corners[4]=new Vector3(minX,maxY,minZ);corners[5]=new Vector3(maxX,maxY,minZ);corners[6]=new Vector3(maxX,minY,minZ);corners[7]=new Vector3(minX,minY,minZ);};_proto90.getCenter=function getCenter(out){Vector3.add(this.min,this.max,out);Vector3.scale(out,0.5,out);};_proto90.getExtent=function getExtent(out){Vector3.subtract(this.max,this.min,out);Vector3.scale(out,0.5,out);};_proto90.setCenterAndExtent=function setCenterAndExtent(center,extent){Vector3.subtract(center,extent,this.min);Vector3.add(center,extent,this.max);};_proto90.tranform=function tranform(matrix,out){var center=BoundBox._tempVector30;var extent=BoundBox._tempVector31;this.getCenter(center);this.getExtent(extent);Vector3.transformCoordinate(center,matrix,center);this._rotateExtents(extent,matrix,extent);out.setCenterAndExtent(center,extent);};_proto90.toDefault=function toDefault(){this.min.toDefault();this.max.toDefault();};BoundBox.createfromPoints=function createfromPoints(points,out){if(points==null)throw new Error("points");var min=out.min;var max=out.max;min.x=Number.MAX_VALUE;min.y=Number.MAX_VALUE;min.z=Number.MAX_VALUE;max.x=-Number.MAX_VALUE;max.y=-Number.MAX_VALUE;max.z=-Number.MAX_VALUE;for(var i=0,n=points.length;i<n;++i){Vector3.min(min,points[i],min);Vector3.max(max,points[i],max);}};BoundBox.merge=function merge(box1,box2,out){Vector3.min(box1.min,box2.min,out.min);Vector3.max(box1.max,box2.max,out.max);};_proto90.cloneTo=function cloneTo(destObject){var dest=destObject;this.min.cloneTo(dest.min);this.max.cloneTo(dest.max);};_proto90.clone=function clone(){var dest=new BoundBox(new Vector3(),new Vector3());this.cloneTo(dest);return dest;};return BoundBox;}();BoundBox._tempVector30=new Vector3();BoundBox._tempVector31=new Vector3();var Bounds=/*#__PURE__*/function(){function Bounds(min,max){this._updateFlag=0;this._center=new Vector3();this._extent=new Vector3();this._boundBox=new BoundBox(new Vector3(),new Vector3());min.cloneTo(this._boundBox.min);max.cloneTo(this._boundBox.max);this._setUpdateFlag(Bounds._UPDATE_CENTER|Bounds._UPDATE_EXTENT,true);}var _proto91=Bounds.prototype;_proto91.setMin=function setMin(value){var min=this._boundBox.min;if(value!==min)value.cloneTo(min);this._setUpdateFlag(Bounds._UPDATE_CENTER|Bounds._UPDATE_EXTENT,true);this._setUpdateFlag(Bounds._UPDATE_MIN,false);};_proto91.getMin=function getMin(){var min=this._boundBox.min;if(this._getUpdateFlag(Bounds._UPDATE_MIN)){this._getMin(this.getCenter(),this.getExtent(),min);this._setUpdateFlag(Bounds._UPDATE_MIN,false);}return min;};_proto91.setMax=function setMax(value){var max=this._boundBox.max;if(value!==max)value.cloneTo(max);this._setUpdateFlag(Bounds._UPDATE_CENTER|Bounds._UPDATE_EXTENT,true);this._setUpdateFlag(Bounds._UPDATE_MAX,false);};_proto91.getMax=function getMax(){var max=this._boundBox.max;if(this._getUpdateFlag(Bounds._UPDATE_MAX)){this._getMax(this.getCenter(),this.getExtent(),max);this._setUpdateFlag(Bounds._UPDATE_MAX,false);}return max;};_proto91.setCenter=function setCenter(value){if(value!==this._center)value.cloneTo(this._center);this._setUpdateFlag(Bounds._UPDATE_MIN|Bounds._UPDATE_MAX,true);this._setUpdateFlag(Bounds._UPDATE_CENTER,false);};_proto91.getCenter=function getCenter(){if(this._getUpdateFlag(Bounds._UPDATE_CENTER)){this._getCenter(this.getMin(),this.getMax(),this._center);this._setUpdateFlag(Bounds._UPDATE_CENTER,false);}return this._center;};_proto91.setExtent=function setExtent(value){if(value!==this._extent)value.cloneTo(this._extent);this._setUpdateFlag(Bounds._UPDATE_MIN|Bounds._UPDATE_MAX,true);this._setUpdateFlag(Bounds._UPDATE_EXTENT,false);};_proto91.getExtent=function getExtent(){if(this._getUpdateFlag(Bounds._UPDATE_EXTENT)){this._getExtent(this.getMin(),this.getMax(),this._extent);this._setUpdateFlag(Bounds._UPDATE_EXTENT,false);}return this._extent;};_proto91._getUpdateFlag=function _getUpdateFlag(type){return (this._updateFlag&type)!=0;};_proto91._setUpdateFlag=function _setUpdateFlag(type,value){if(value)this._updateFlag|=type;else this._updateFlag&=~type;};_proto91._getCenter=function _getCenter(min,max,out){Vector3.add(min,max,out);Vector3.scale(out,0.5,out);};_proto91._getExtent=function _getExtent(min,max,out){Vector3.subtract(max,min,out);Vector3.scale(out,0.5,out);};_proto91._getMin=function _getMin(center,extent,out){Vector3.subtract(center,extent,out);};_proto91._getMax=function _getMax(center,extent,out){Vector3.add(center,extent,out);};_proto91._rotateExtents=function _rotateExtents(extents,rotation,out){var extentsX=extents.x;var extentsY=extents.y;var extentsZ=extents.z;var matE=rotation.elements;out.x=Math.abs(matE[0]*extentsX)+Math.abs(matE[4]*extentsY)+Math.abs(matE[8]*extentsZ);out.y=Math.abs(matE[1]*extentsX)+Math.abs(matE[5]*extentsY)+Math.abs(matE[9]*extentsZ);out.z=Math.abs(matE[2]*extentsX)+Math.abs(matE[6]*extentsY)+Math.abs(matE[10]*extentsZ);};_proto91._tranform=function _tranform(matrix,out){var outCen=out._center;var outExt=out._extent;Vector3.transformCoordinate(this.getCenter(),matrix,outCen);this._rotateExtents(this.getExtent(),matrix,outExt);out._boundBox.setCenterAndExtent(outCen,outExt);out._updateFlag=0;};_proto91._getBoundBox=function _getBoundBox(){if(this._updateFlag&Bounds._UPDATE_MIN){var min=this._boundBox.min;this._getMin(this.getCenter(),this.getExtent(),min);this._setUpdateFlag(Bounds._UPDATE_MIN,false);}if(this._updateFlag&Bounds._UPDATE_MAX){var max=this._boundBox.max;this._getMax(this.getCenter(),this.getExtent(),max);this._setUpdateFlag(Bounds._UPDATE_MAX,false);}return this._boundBox;};_proto91.cloneTo=function cloneTo(destObject){var destBounds=destObject;this.getMin().cloneTo(destBounds._boundBox.min);this.getMax().cloneTo(destBounds._boundBox.max);this.getCenter().cloneTo(destBounds._center);this.getExtent().cloneTo(destBounds._extent);destBounds._updateFlag=0;};_proto91.clone=function clone(){var dest=new Bounds(new Vector3(),new Vector3());this.cloneTo(dest);return dest;};return Bounds;}();Bounds._UPDATE_MIN=0x01;Bounds._UPDATE_MAX=0x02;Bounds._UPDATE_CENTER=0x04;Bounds._UPDATE_EXTENT=0x08;var GeometryElement=/*#__PURE__*/function(){function GeometryElement(){this._destroyed=false;}var _proto92=GeometryElement.prototype;_proto92._getType=function _getType(){throw "GeometryElement:must override it.";};_proto92._prepareRender=function _prepareRender(state){return true;};_proto92._render=function _render(state){throw "GeometryElement:must override it.";};_proto92.destroy=function destroy(){if(this._destroyed)return;this._destroyed=true;};_createClass(GeometryElement,[{key:"destroyed",get:function get(){return this._destroyed;}}]);return GeometryElement;}();GeometryElement._typeCounter=0;var PixelLineVertex=/*#__PURE__*/function(){function PixelLineVertex(){}PixelLineVertex.__init__=function __init__(){PixelLineVertex._vertexDeclaration=new VertexDeclaration(28,[new VertexElement(0,VertexElementFormat.Vector3,VertexMesh.MESH_POSITION0),new VertexElement(12,VertexElementFormat.Vector4,VertexMesh.MESH_COLOR0)]);};_createClass(PixelLineVertex,[{key:"vertexDeclaration",get:function get(){return PixelLineVertex._vertexDeclaration;}}],[{key:"vertexDeclaration",get:function get(){return PixelLineVertex._vertexDeclaration;}}]);return PixelLineVertex;}();var PixelLineFilter=/*#__PURE__*/function(_GeometryElement){_inheritsLoose(PixelLineFilter,_GeometryElement);function PixelLineFilter(owner,maxLineCount){var _this43;_this43=_GeometryElement.call(this)||this;_this43._floatCountPerVertices=7;_this43._minUpdate=Number.MAX_VALUE;_this43._maxUpdate=Number.MIN_VALUE;_this43._bufferState=new BufferState();_this43._floatBound=new Float32Array(6);_this43._calculateBound=false;_this43._maxLineCount=0;_this43._lineCount=0;var pointCount=maxLineCount*2;_this43._owner=owner;_this43._maxLineCount=maxLineCount;_this43._vertices=new Float32Array(pointCount*_this43._floatCountPerVertices);_this43._vertexBuffer=new VertexBuffer3D(PixelLineVertex.vertexDeclaration.vertexStride*pointCount,Laya.LayaGL.instance.STATIC_DRAW,false);_this43._vertexBuffer.vertexDeclaration=PixelLineVertex.vertexDeclaration;_this43._bufferState.bind();_this43._bufferState.applyVertexBuffer(_this43._vertexBuffer);_this43._bufferState.unBind();var min=PixelLineFilter._tempVector0;var max=PixelLineFilter._tempVector1;min.setValue(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);max.setValue(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);_this43._bounds=new Bounds(min,max);return _this43;}var _proto93=PixelLineFilter.prototype;_proto93._getType=function _getType(){return PixelLineFilter._type;};_proto93._resizeLineData=function _resizeLineData(maxCount){var pointCount=maxCount*2;var lastVertices=this._vertices;this._vertexBuffer.destroy();this._maxLineCount=maxCount;var vertexCount=pointCount*this._floatCountPerVertices;this._vertices=new Float32Array(vertexCount);this._vertexBuffer=new VertexBuffer3D(PixelLineVertex.vertexDeclaration.vertexStride*pointCount,Laya.LayaGL.instance.STATIC_DRAW,false);this._vertexBuffer.vertexDeclaration=PixelLineVertex.vertexDeclaration;if(vertexCount<lastVertices.length){this._vertices.set(new Float32Array(lastVertices.buffer,0,vertexCount));this._vertexBuffer.setData(this._vertices.buffer,0,0,vertexCount*4);}else {this._vertices.set(lastVertices);this._vertexBuffer.setData(this._vertices.buffer,0,0,lastVertices.length*4);}this._bufferState.bind();this._bufferState.applyVertexBuffer(this._vertexBuffer);this._bufferState.unBind();};_proto93._updateLineVertices=function _updateLineVertices(offset,startPosition,endPosition,startColor,endColor){if(startPosition){this._vertices[offset+0]=startPosition.x;this._vertices[offset+1]=startPosition.y;this._vertices[offset+2]=startPosition.z;}if(startColor){this._vertices[offset+3]=startColor.r;this._vertices[offset+4]=startColor.g;this._vertices[offset+5]=startColor.b;this._vertices[offset+6]=startColor.a;}if(endPosition){this._vertices[offset+7]=endPosition.x;this._vertices[offset+8]=endPosition.y;this._vertices[offset+9]=endPosition.z;}if(endColor){this._vertices[offset+10]=endColor.r;this._vertices[offset+11]=endColor.g;this._vertices[offset+12]=endColor.b;this._vertices[offset+13]=endColor.a;}this._minUpdate=Math.min(this._minUpdate,offset);this._maxUpdate=Math.max(this._maxUpdate,offset+this._floatCountPerVertices*2);var bounds=this._bounds;var floatBound=this._floatBound;var min=bounds.getMin(),max=bounds.getMax();Vector3.min(min,startPosition,min);Vector3.min(min,endPosition,min);Vector3.max(max,startPosition,max);Vector3.max(max,endPosition,max);bounds.setMin(min);bounds.setMax(max);floatBound[0]=min.x,floatBound[1]=min.y,floatBound[2]=min.z;floatBound[3]=max.x,floatBound[4]=max.y,floatBound[5]=max.z;};_proto93._reCalculateBound=function _reCalculateBound(){if(this._calculateBound){var vertices=this._vertices;var min=PixelLineFilter._tempVector0;var max=PixelLineFilter._tempVector1;min.setValue(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);max.setValue(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var i=0;i<this._lineCount*2;++i){var offset=this._floatCountPerVertices*i;var x=vertices[offset+0],y=vertices[offset+1],z=vertices[offset+2];min.x=Math.min(x,min.x);min.y=Math.min(y,min.y);min.z=Math.min(z,min.z);max.x=Math.max(x,max.x);max.y=Math.max(y,max.y);max.z=Math.max(z,max.z);}this._bounds.setMin(min);this._bounds.setMax(max);var floatBound=this._floatBound;floatBound[0]=min.x,floatBound[1]=min.y,floatBound[2]=min.z;floatBound[3]=max.x,floatBound[4]=max.y,floatBound[5]=max.z;this._calculateBound=false;}};_proto93._removeLineData=function _removeLineData(index){var floatCount=this._floatCountPerVertices*2;var nextIndex=index+1;var offset=index*floatCount;var vertices=this._vertices;var rightPartVertices=new Float32Array(vertices.buffer,nextIndex*floatCount*4,(this._lineCount-nextIndex)*floatCount);vertices.set(rightPartVertices,offset);this._minUpdate=Math.min(this._minUpdate,offset);this._maxUpdate=Math.max(this._maxUpdate,offset+rightPartVertices.length);this._lineCount--;var floatBound=this._floatBound;var startX=vertices[offset],startY=vertices[offset+1],startZ=vertices[offset+2];var endX=vertices[offset+7],endY=vertices[offset+8],endZ=vertices[offset+9];var minX=floatBound[0],minY=floatBound[1],minZ=floatBound[2];var maxX=floatBound[3],maxY=floatBound[4],maxZ=floatBound[5];if(startX===minX||startX===maxX||startY===minY||startY===maxY||startZ===minZ||startZ===maxZ||endX===minX||endX===maxX||endY===minY||endY===maxY||endZ===minZ||endZ===maxZ)this._calculateBound=true;};_proto93._updateLineData=function _updateLineData(index,startPosition,endPosition,startColor,endColor){var floatCount=this._floatCountPerVertices*2;this._updateLineVertices(index*floatCount,startPosition,endPosition,startColor,endColor);};_proto93._updateLineDatas=function _updateLineDatas(index,data){var floatCount=this._floatCountPerVertices*2;var count=data.length;for(var i=0;i<count;i++){var line=data[i];this._updateLineVertices((index+i)*floatCount,line.startPosition,line.endPosition,line.startColor,line.endColor);}};_proto93._getLineData=function _getLineData(index,out){var startPosition=out.startPosition;var startColor=out.startColor;var endPosition=out.endPosition;var endColor=out.endColor;var vertices=this._vertices;var offset=index*this._floatCountPerVertices*2;startPosition.x=vertices[offset+0];startPosition.y=vertices[offset+1];startPosition.z=vertices[offset+2];startColor.r=vertices[offset+3];startColor.g=vertices[offset+4];startColor.b=vertices[offset+5];startColor.a=vertices[offset+6];endPosition.x=vertices[offset+7];endPosition.y=vertices[offset+8];endPosition.z=vertices[offset+9];endColor.r=vertices[offset+10];endColor.g=vertices[offset+11];endColor.b=vertices[offset+12];endColor.a=vertices[offset+13];};_proto93._prepareRender=function _prepareRender(state){return true;};_proto93._render=function _render(state){if(this._minUpdate!==Number.MAX_VALUE&&this._maxUpdate!==Number.MIN_VALUE){this._vertexBuffer.setData(this._vertices.buffer,this._minUpdate*4,this._minUpdate*4,(this._maxUpdate-this._minUpdate)*4);this._minUpdate=Number.MAX_VALUE;this._maxUpdate=Number.MIN_VALUE;}if(this._lineCount>0){this._bufferState.bind();var gl=Laya.LayaGL.instance;gl.drawArrays(gl.LINES,0,this._lineCount*2);Laya.Stat.renderBatches++;}};_proto93.destroy=function destroy(){if(this._destroyed)return;_GeometryElement.prototype.destroy.call(this);this._bufferState.destroy();this._vertexBuffer.destroy();this._bufferState=null;this._vertexBuffer=null;this._vertices=null;};return PixelLineFilter;}(GeometryElement);PixelLineFilter._tempVector0=new Vector3();PixelLineFilter._tempVector1=new Vector3();PixelLineFilter._type=GeometryElement._typeCounter++;var RenderableSprite3D=/*#__PURE__*/function(_Sprite3D3){_inheritsLoose(RenderableSprite3D,_Sprite3D3);function RenderableSprite3D(name){return _Sprite3D3.call(this,name)||this;}RenderableSprite3D.__init__=function __init__(){RenderableSprite3D.SHADERDEFINE_RECEIVE_SHADOW=Shader3D.getDefineByName("RECEIVESHADOW");RenderableSprite3D.SAHDERDEFINE_LIGHTMAP=Shader3D.getDefineByName("LIGHTMAP");RenderableSprite3D.SHADERDEFINE_LIGHTMAP_DIRECTIONAL=Shader3D.getDefineByName("LIGHTMAP_DIRECTIONAL");};var _proto94=RenderableSprite3D.prototype;_proto94._onInActive=function _onInActive(){_Sprite3D3.prototype._onInActive.call(this);this._scene._removeRenderObject(this._render);};_proto94._onActive=function _onActive(){_Sprite3D3.prototype._onActive.call(this);this._scene._addRenderObject(this._render);};_proto94._onActiveInScene=function _onActiveInScene(){_Sprite3D3.prototype._onActiveInScene.call(this);if(ILaya3D.Laya3D._editerEnvironment){var scene=this._scene;var pickColor=new Vector4();scene._allotPickColorByID(this.id,pickColor);scene._pickIdToSprite[this.id]=this;this._render._shaderValues.setVector(RenderableSprite3D.PICKCOLOR,pickColor);}};_proto94._addToInitStaticBatchManager=function _addToInitStaticBatchManager(){};_proto94._setBelongScene=function _setBelongScene(scene){_Sprite3D3.prototype._setBelongScene.call(this,scene);this._render._setBelongScene(scene);};_proto94._setUnBelongScene=function _setUnBelongScene(){this._render._shaderValues.removeDefine(RenderableSprite3D.SAHDERDEFINE_LIGHTMAP);_Sprite3D3.prototype._setUnBelongScene.call(this);};_proto94._changeHierarchyAnimator=function _changeHierarchyAnimator(animator){if(this._hierarchyAnimator){var renderableSprites=this._hierarchyAnimator._renderableSprites;renderableSprites.splice(renderableSprites.indexOf(this),1);}if(animator)animator._renderableSprites.push(this);_Sprite3D3.prototype._changeHierarchyAnimator.call(this,animator);};_proto94.destroy=function destroy(destroyChild){if(destroyChild===void 0){destroyChild=true;}_Sprite3D3.prototype.destroy.call(this,destroyChild);this._render._destroy();this._render=null;};_proto94._create=function _create(){return new RenderableSprite3D(this.name);};return RenderableSprite3D;}(Sprite3D);RenderableSprite3D.LIGHTMAPSCALEOFFSET=Shader3D.propertyNameToID("u_LightmapScaleOffset");RenderableSprite3D.LIGHTMAP=Shader3D.propertyNameToID("u_LightMap");RenderableSprite3D.LIGHTMAP_DIRECTION=Shader3D.propertyNameToID("u_LightMapDirection");RenderableSprite3D.PICKCOLOR=Shader3D.propertyNameToID("u_PickColor");var BatchMark=function BatchMark(){this.updateMark=-1;this.indexInList=-1;this.batched=false;};var SubMeshInstanceBatch=/*#__PURE__*/function(_GeometryElement2){_inheritsLoose(SubMeshInstanceBatch,_GeometryElement2);function SubMeshInstanceBatch(){var _this44;_this44=_GeometryElement2.call(this)||this;_this44.maxInstanceCount=1024;_this44.instanceWorldMatrixData=new Float32Array(_this44.maxInstanceCount*16);_this44.instanceMVPMatrixData=new Float32Array(_this44.maxInstanceCount*16);_this44.instanceSimpleAnimatorData=new Float32Array(_this44.maxInstanceCount*4);var gl=Laya.LayaGL.instance;_this44.instanceWorldMatrixBuffer=new VertexBuffer3D(_this44.instanceWorldMatrixData.length*4,gl.DYNAMIC_DRAW);_this44.instanceMVPMatrixBuffer=new VertexBuffer3D(_this44.instanceMVPMatrixData.length*4,gl.DYNAMIC_DRAW);_this44.instanceWorldMatrixBuffer.vertexDeclaration=VertexMesh.instanceWorldMatrixDeclaration;_this44.instanceMVPMatrixBuffer.vertexDeclaration=VertexMesh.instanceMVPMatrixDeclaration;_this44.instanceSimpleAnimatorBuffer=new VertexBuffer3D(_this44.instanceSimpleAnimatorData.length*4,gl.DYNAMIC_DRAW);_this44.instanceSimpleAnimatorBuffer.vertexDeclaration=VertexMesh.instanceSimpleAnimatorDeclaration;return _this44;}SubMeshInstanceBatch.__init__=function __init__(){SubMeshInstanceBatch.instance=new SubMeshInstanceBatch();};var _proto95=SubMeshInstanceBatch.prototype;_proto95._render=function _render(state){var gl=Laya.LayaGL.instance;var element=state.renderElement;var subMesh=element.instanceSubMesh;var count=element.instanceBatchElementList.length;var indexCount=subMesh._indexCount;subMesh._mesh._instanceBufferState.bind();Laya.LayaGL.layaGPUInstance.drawElementsInstanced(gl.TRIANGLES,indexCount,gl.UNSIGNED_SHORT,subMesh._indexStart*2,count);Laya.Stat.renderBatches++;Laya.Stat.savedRenderBatches+=count-1;Laya.Stat.trianglesFaces+=indexCount*count/3;};return SubMeshInstanceBatch;}(GeometryElement);var RenderElement=/*#__PURE__*/function(){function RenderElement(){this.renderSubShader=null;this.renderType=RenderElement.RENDERTYPE_NORMAL;}var _proto96=RenderElement.prototype;_proto96.getInvertFront=function getInvertFront(){return this._transform._isFrontFaceInvert;};_proto96.setTransform=function setTransform(transform){this._transform=transform;};_proto96.setGeometry=function setGeometry(geometry){this._geometry=geometry;};_proto96.addToOpaqueRenderQueue=function addToOpaqueRenderQueue(context,queue){queue.elements.add(this);};_proto96.addToTransparentRenderQueue=function addToTransparentRenderQueue(context,queue){queue.elements.add(this);queue.lastTransparentBatched=false;queue.lastTransparentRenderElement=this;};_proto96._update=function _update(scene,context,customShader,replacementTag){if(this.material){var subShader=this.material._shader.getSubShaderAt(0);this.renderSubShader=null;if(customShader){if(replacementTag){var oriTag=subShader.getFlag(replacementTag);if(oriTag){var customSubShaders=customShader._subShaders;for(var k=0,p=customSubShaders.length;k<p;k++){var customSubShader=customSubShaders[k];if(oriTag===customSubShader.getFlag(replacementTag)){this.renderSubShader=customSubShader;break;}}if(!this.renderSubShader)return;}else {return;}}else {this.renderSubShader=customShader.getSubShaderAt(0);}}else {this.renderSubShader=subShader;}var renderQueue=scene._getRenderQueue(this.material.renderQueue);if(renderQueue.isTransparent)this.addToTransparentRenderQueue(context,renderQueue);else this.addToOpaqueRenderQueue(context,renderQueue);}};_proto96._render=function _render(context){var forceInvertFace=context.invertY;var lastStateMaterial,lastStateShaderInstance,lastStateRender;var updateMark=Camera._updateMark;var scene=context.scene;var cameraShaderValue=context.cameraShaderValue;var transform=this._transform;var geometry=this._geometry;context.renderElement=this;var updateRender=updateMark!==this.render._updateMark||this.renderType!==this.render._updateRenderType;if(updateRender){this.render._renderUpdate(context,transform);this.render._renderUpdateWithCamera(context,transform);this.render._updateMark=updateMark;this.render._updateRenderType=this.renderType;}else {if(this.renderType==RenderElement.RENDERTYPE_INSTANCEBATCH){this.render._renderUpdate(context,transform);this.render._renderUpdateWithCamera(context,transform);}}var currentPipelineMode=context.pipelineMode;if(geometry._prepareRender(context)){var passes=this.renderSubShader._passes;for(var j=0,m=passes.length;j<m;j++){var pass=passes[j];if(pass._pipelineMode!==currentPipelineMode)continue;var comDef=RenderElement._compileDefine;scene._shaderValues._defineDatas.cloneTo(comDef);comDef.addDefineDatas(this.render._shaderValues._defineDatas);comDef.addDefineDatas(this.material._shaderValues._defineDatas);var shaderIns=context.shader=pass.withCompile(comDef);var switchShader=shaderIns.bind();var switchUpdateMark=updateMark!==shaderIns._uploadMark;var uploadScene=shaderIns._uploadScene!==scene||switchUpdateMark;if(uploadScene||switchShader){shaderIns.uploadUniforms(shaderIns._sceneUniformParamsMap,scene._shaderValues,uploadScene);shaderIns._uploadScene=scene;}var uploadSprite3D=shaderIns._uploadRender!==this.render||shaderIns._uploadRenderType!==this.renderType||switchUpdateMark;if(uploadSprite3D||switchShader){shaderIns.uploadUniforms(shaderIns._spriteUniformParamsMap,this.render._shaderValues,uploadSprite3D);shaderIns._uploadRender=this.render;shaderIns._uploadRenderType=this.renderType;}var uploadCamera=shaderIns._uploadCameraShaderValue!==cameraShaderValue||switchUpdateMark;if(uploadCamera||switchShader){shaderIns.uploadUniforms(shaderIns._cameraUniformParamsMap,cameraShaderValue,uploadCamera);shaderIns._uploadCameraShaderValue=cameraShaderValue;}var uploadMaterial=shaderIns._uploadMaterial!==this.material||switchUpdateMark;if(uploadMaterial||switchShader){shaderIns.uploadUniforms(shaderIns._materialUniformParamsMap,this.material._shaderValues,uploadMaterial);shaderIns._uploadMaterial=this.material;}var matValues=this.material._shaderValues;if(lastStateMaterial!==this.material||lastStateShaderInstance!==shaderIns){shaderIns.uploadRenderStateBlendDepth(matValues);shaderIns.uploadRenderStateFrontFace(matValues,forceInvertFace,this.getInvertFront());lastStateMaterial=this.material;lastStateShaderInstance=shaderIns;lastStateRender=this.render;}else {if(lastStateRender!==this.render){shaderIns.uploadRenderStateFrontFace(matValues,forceInvertFace,this.getInvertFront());lastStateRender=this.render;}}geometry._render(context);shaderIns._uploadMark=updateMark;}}if(this.renderType!==RenderElement.RENDERTYPE_NORMAL)this.render._revertBatchRenderUpdate(context);};_proto96.destroy=function destroy(){this._transform=null;this._geometry=null;this.material=null;this.render=null;};return RenderElement;}();RenderElement.RENDERTYPE_NORMAL=0;RenderElement.RENDERTYPE_STATICBATCH=1;RenderElement.RENDERTYPE_INSTANCEBATCH=2;RenderElement.RENDERTYPE_VERTEXBATCH=3;RenderElement._compileDefine=new DefineDatas();var SubMeshRenderElement=/*#__PURE__*/function(_RenderElement){_inheritsLoose(SubMeshRenderElement,_RenderElement);function SubMeshRenderElement(){var _this45;_this45=_RenderElement.call(this)||this;_this45._dynamicWorldPositionNormalNeedUpdate=true;return _this45;}var _proto97=SubMeshRenderElement.prototype;_proto97._onWorldMatrixChanged=function _onWorldMatrixChanged(){this._dynamicWorldPositionNormalNeedUpdate=true;};_proto97._computeWorldPositionsAndNormals=function _computeWorldPositionsAndNormals(positionOffset,normalOffset,multiSubMesh,vertexCount){if(this._dynamicWorldPositionNormalNeedUpdate){var subMesh=this._geometry;var vertexBuffer=subMesh._vertexBuffer;var vertexFloatCount=vertexBuffer.vertexDeclaration.vertexStride/4;var oriVertexes=vertexBuffer.getFloat32Data();var worldMat=this._transform.worldMatrix;var rotation=this._transform.rotation;var indices=subMesh._indices;for(var i=0;i<vertexCount;i++){var index=multiSubMesh?indices[i]:i;var oriOffset=index*vertexFloatCount;var bakeOffset=i*3;Utils3D.transformVector3ArrayToVector3ArrayCoordinate(oriVertexes,oriOffset+positionOffset,worldMat,this._dynamicWorldPositions,bakeOffset);normalOffset!==-1&&Utils3D.transformVector3ArrayByQuat(oriVertexes,oriOffset+normalOffset,rotation,this._dynamicWorldNormals,bakeOffset);}this._dynamicWorldPositionNormalNeedUpdate=false;}};_proto97.setTransform=function setTransform(transform){if(this._transform!==transform){this._transform&&this._transform.off(Laya.Event.TRANSFORM_CHANGED,this,this._onWorldMatrixChanged);transform&&transform.on(Laya.Event.TRANSFORM_CHANGED,this,this._onWorldMatrixChanged);this._dynamicWorldPositionNormalNeedUpdate=true;this._transform=transform;}};_proto97.setGeometry=function setGeometry(geometry){if(this._geometry!==geometry){var subMesh=geometry;var mesh=subMesh._mesh;if(mesh){var multiSubMesh=mesh._subMeshes.length>1;var dynBatVerCount=multiSubMesh?subMesh._indexCount:mesh._vertexCount;if(dynBatVerCount<=ILaya3D.SubMeshDynamicBatch.maxAllowVertexCount){var length=dynBatVerCount*3;this._dynamicVertexBatch=true;this._dynamicWorldPositions=new Float32Array(length);this._dynamicWorldNormals=new Float32Array(length);this._dynamicVertexCount=dynBatVerCount;this._dynamicMultiSubMesh=multiSubMesh;}else {this._dynamicVertexBatch=false;}}this._geometry=geometry;}};_proto97.addToOpaqueRenderQueue=function addToOpaqueRenderQueue(context,queue){var subMeshStaticBatch=this.staticBatch;var queueElements=queue.elements;var elements=queueElements.elements;if(subMeshStaticBatch){var staManager=ILaya3D.MeshRenderStaticBatchManager.instance;var staBatchMarks=staManager.getBatchOpaquaMark(this.render.lightmapIndex+1,this.render.receiveShadow,this.material.id,subMeshStaticBatch._batchID);if(staManager._updateCountMark===staBatchMarks.updateMark){var staBatchIndex=staBatchMarks.indexInList;if(staBatchMarks.batched){elements[staBatchIndex].staticBatchElementList.add(this);}else {var staOriElement=elements[staBatchIndex];var staOriRender=staOriElement.render;var staBatchElement=staManager._getBatchRenderElementFromPool();staBatchElement.renderType=RenderElement.RENDERTYPE_STATICBATCH;staBatchElement.setGeometry(subMeshStaticBatch);staBatchElement.material=staOriElement.material;var staRootOwner=subMeshStaticBatch.batchOwner;var staBatchTransform=staRootOwner?staRootOwner._transform:null;staBatchElement.setTransform(staBatchTransform);staBatchElement.render=staOriRender;staBatchElement.renderSubShader=staOriElement.renderSubShader;var staBatchList=staBatchElement.staticBatchElementList;staBatchList.length=0;staBatchList.add(staOriElement);staBatchList.add(this);elements[staBatchIndex]=staBatchElement;staBatchMarks.batched=true;}}else {staBatchMarks.updateMark=staManager._updateCountMark;staBatchMarks.indexInList=queueElements.length;staBatchMarks.batched=false;queueElements.add(this);}}else if(this.renderSubShader._owner._enableInstancing&&Laya.LayaGL.layaGPUInstance.supportInstance()&&this.render.lightmapIndex<0){var subMesh=this._geometry;var insManager=ILaya3D.MeshRenderDynamicBatchManager.instance;var insBatchMarks=insManager.getInstanceBatchOpaquaMark(this.render.receiveShadow,this.material.id,subMesh._id,this._transform._isFrontFaceInvert);if(insManager._updateCountMark===insBatchMarks.updateMark){var insBatchIndex=insBatchMarks.indexInList;if(insBatchMarks.batched){var instanceBatchElementList=elements[insBatchIndex].instanceBatchElementList;if(instanceBatchElementList.length===SubMeshInstanceBatch.instance.maxInstanceCount){insBatchMarks.updateMark=insManager._updateCountMark;insBatchMarks.indexInList=queueElements.length;insBatchMarks.batched=false;queueElements.add(this);}else {instanceBatchElementList.add(this);}}else {var insOriElement=elements[insBatchIndex];var insOriRender=insOriElement.render;var insBatchElement=insManager._getBatchRenderElementFromPool();insBatchElement.renderType=RenderElement.RENDERTYPE_INSTANCEBATCH;insBatchElement.setGeometry(SubMeshInstanceBatch.instance);insBatchElement.material=insOriElement.material;insBatchElement.setTransform(null);insBatchElement.render=insOriRender;insBatchElement.instanceSubMesh=subMesh;insBatchElement.renderSubShader=insOriElement.renderSubShader;var insBatchList=insBatchElement.instanceBatchElementList;insBatchList.length=0;insBatchList.add(insOriElement);insBatchList.add(this);elements[insBatchIndex]=insBatchElement;insBatchMarks.batched=true;}}else {insBatchMarks.updateMark=insManager._updateCountMark;insBatchMarks.indexInList=queueElements.length;insBatchMarks.batched=false;queueElements.add(this);}}else if(this._dynamicVertexBatch){var verDec=this._geometry._vertexBuffer.vertexDeclaration;var dynManager=ILaya3D.MeshRenderDynamicBatchManager.instance;var dynBatchMarks=dynManager.getVertexBatchOpaquaMark(this.render.lightmapIndex+1,this.render.receiveShadow,this.material.id,verDec.id);if(dynManager._updateCountMark===dynBatchMarks.updateMark){var dynBatchIndex=dynBatchMarks.indexInList;if(dynBatchMarks.batched){elements[dynBatchIndex].vertexBatchElementList.add(this);}else {var dynOriElement=elements[dynBatchIndex];var dynOriRender=dynOriElement.render;var dynBatchElement=dynManager._getBatchRenderElementFromPool();dynBatchElement.renderType=RenderElement.RENDERTYPE_VERTEXBATCH;dynBatchElement.setGeometry(ILaya3D.SubMeshDynamicBatch.instance);dynBatchElement.material=dynOriElement.material;dynBatchElement.setTransform(null);dynBatchElement.render=dynOriRender;dynBatchElement.vertexBatchVertexDeclaration=verDec;dynBatchElement.renderSubShader=dynOriElement.renderSubShader;var dynBatchList=dynBatchElement.vertexBatchElementList;dynBatchList.length=0;dynBatchList.add(dynOriElement);dynBatchList.add(this);elements[dynBatchIndex]=dynBatchElement;dynBatchMarks.batched=true;}}else {dynBatchMarks.updateMark=dynManager._updateCountMark;dynBatchMarks.indexInList=queueElements.length;dynBatchMarks.batched=false;queueElements.add(this);}}else {queueElements.add(this);}};_proto97.addToTransparentRenderQueue=function addToTransparentRenderQueue(context,queue){var subMeshStaticBatch=this.staticBatch;var queueElements=queue.elements;var elements=queueElements.elements;if(subMeshStaticBatch){var staManager=ILaya3D.MeshRenderStaticBatchManager.instance;var staLastElement=queue.lastTransparentRenderElement;if(staLastElement){var staLastRender=staLastElement.render;if(staLastElement._geometry._getType()!==this._geometry._getType()||staLastElement.staticBatch!==subMeshStaticBatch||staLastElement.material!==this.material||staLastRender.receiveShadow!==this.render.receiveShadow||staLastRender.lightmapIndex!==this.render.lightmapIndex){queueElements.add(this);queue.lastTransparentBatched=false;}else {if(queue.lastTransparentBatched){elements[queueElements.length-1].staticBatchElementList.add(this);}else {var staBatchElement=staManager._getBatchRenderElementFromPool();staBatchElement.renderType=RenderElement.RENDERTYPE_STATICBATCH;staBatchElement.setGeometry(subMeshStaticBatch);staBatchElement.material=staLastElement.material;var staRootOwner=subMeshStaticBatch.batchOwner;var staBatchTransform=staRootOwner?staRootOwner._transform:null;staBatchElement.setTransform(staBatchTransform);staBatchElement.render=this.render;staBatchElement.renderSubShader=staLastElement.renderSubShader;var staBatchList=staBatchElement.staticBatchElementList;staBatchList.length=0;staBatchList.add(staLastElement);staBatchList.add(this);elements[queueElements.length-1]=staBatchElement;}queue.lastTransparentBatched=true;}}else {queueElements.add(this);queue.lastTransparentBatched=false;}}else if(this.renderSubShader._owner._enableInstancing&&Laya.LayaGL.layaGPUInstance.supportInstance()&&this.render.lightmapIndex<0){var subMesh=this._geometry;var insManager=ILaya3D.MeshRenderDynamicBatchManager.instance;var insLastElement=queue.lastTransparentRenderElement;if(insLastElement){var insLastRender=insLastElement.render;if(insLastElement._geometry._getType()!==this._geometry._getType()||insLastElement._geometry!==subMesh||insLastElement.material!==this.material||insLastRender.receiveShadow!==this.render.receiveShadow){queueElements.add(this);queue.lastTransparentBatched=false;}else {if(queue.lastTransparentBatched){var instanceBatchElementList=elements[queueElements.length-1].instanceBatchElementList;if(instanceBatchElementList.length===SubMeshInstanceBatch.instance.maxInstanceCount){queueElements.add(this);queue.lastTransparentBatched=false;}else {instanceBatchElementList.add(this);queue.lastTransparentBatched=true;}}else {var insBatchElement=insManager._getBatchRenderElementFromPool();insBatchElement.renderType=RenderElement.RENDERTYPE_INSTANCEBATCH;insBatchElement.setGeometry(SubMeshInstanceBatch.instance);insBatchElement.material=insLastElement.material;insBatchElement.setTransform(null);insBatchElement.render=this.render;insBatchElement.instanceSubMesh=subMesh;insBatchElement.renderSubShader=insLastElement.renderSubShader;var insBatchList=insBatchElement.instanceBatchElementList;insBatchList.length=0;insBatchList.add(insLastElement);insBatchList.add(this);elements[queueElements.length-1]=insBatchElement;queue.lastTransparentBatched=true;}}}else {queueElements.add(this);queue.lastTransparentBatched=false;}}else if(this._dynamicVertexBatch){var verDec=this._geometry._vertexBuffer.vertexDeclaration;var dynManager=ILaya3D.MeshRenderDynamicBatchManager.instance;var dynLastElement=queue.lastTransparentRenderElement;if(dynLastElement){var dynLastRender=dynLastElement.render;if(!dynLastElement._dynamicVertexBatch||dynLastElement._geometry._getType()!==this._geometry._getType()||dynLastElement._geometry._vertexBuffer._vertexDeclaration!==verDec||dynLastElement.material!==this.material||dynLastRender.receiveShadow!==this.render.receiveShadow||dynLastRender.lightmapIndex!==this.render.lightmapIndex){queueElements.add(this);queue.lastTransparentBatched=false;}else {if(queue.lastTransparentBatched){elements[queueElements.length-1].vertexBatchElementList.add(this);}else {var dynBatchElement=dynManager._getBatchRenderElementFromPool();dynBatchElement.renderType=RenderElement.RENDERTYPE_VERTEXBATCH;dynBatchElement.setGeometry(ILaya3D.SubMeshDynamicBatch.instance);dynBatchElement.material=dynLastElement.material;dynBatchElement.setTransform(null);dynBatchElement.render=this.render;dynBatchElement.vertexBatchVertexDeclaration=verDec;dynBatchElement.renderSubShader=dynLastElement.renderSubShader;var dynBatchList=dynBatchElement.vertexBatchElementList;dynBatchList.length=0;dynBatchList.add(dynLastElement);dynBatchList.add(this);elements[queueElements.length-1]=dynBatchElement;}queue.lastTransparentBatched=true;}}else {queueElements.add(this);queue.lastTransparentBatched=false;}}else {queueElements.add(this);}queue.lastTransparentRenderElement=this;};_proto97.getInvertFront=function getInvertFront(){switch(this.renderType){case RenderElement.RENDERTYPE_NORMAL:return this._transform._isFrontFaceInvert;case RenderElement.RENDERTYPE_STATICBATCH:case RenderElement.RENDERTYPE_VERTEXBATCH:return false;case RenderElement.RENDERTYPE_INSTANCEBATCH:return this.instanceBatchElementList.elements[0]._transform._isFrontFaceInvert;default:throw "SubMeshRenderElement: unknown renderType";}};_proto97.destroy=function destroy(){_RenderElement.prototype.destroy.call(this);this._dynamicWorldPositions=null;this._dynamicWorldNormals=null;this.staticBatch=null;this.staticBatchElementList=null;this.vertexBatchElementList=null;this.vertexBatchVertexDeclaration=null;};return SubMeshRenderElement;}(RenderElement);var StaticBatchManager=/*#__PURE__*/function(){function StaticBatchManager(){this._initBatchSprites=[];this._staticBatches={};this._batchRenderElementPoolIndex=0;this._batchRenderElementPool=[];}StaticBatchManager._addToStaticBatchQueue=function _addToStaticBatchQueue(sprite3D,renderableSprite3D){if(sprite3D instanceof RenderableSprite3D)renderableSprite3D.push(sprite3D);for(var i=0,n=sprite3D.numChildren;i<n;i++){StaticBatchManager._addToStaticBatchQueue(sprite3D._children[i],renderableSprite3D);}};StaticBatchManager._registerManager=function _registerManager(manager){StaticBatchManager._managers.push(manager);};StaticBatchManager.combine=function combine(staticBatchRoot,renderableSprite3Ds){if(renderableSprite3Ds===void 0){renderableSprite3Ds=null;}if(!renderableSprite3Ds){renderableSprite3Ds=[];if(staticBatchRoot)StaticBatchManager._addToStaticBatchQueue(staticBatchRoot,renderableSprite3Ds);}var batchSpritesCount=renderableSprite3Ds.length;if(batchSpritesCount>0){for(var i=0;i<batchSpritesCount;i++){var sprite=renderableSprite3Ds[i];if(!sprite.destroyed){if(sprite._render._isPartOfStaticBatch)console.warn("StaticBatchManager: Sprite "+sprite.name+" has a part of Static Batch,it will be ignore.");else sprite._addToInitStaticBatchManager();}}for(var k=0,m=StaticBatchManager._managers.length;k<m;k++){var manager=StaticBatchManager._managers[k];manager._initStaticBatchs(staticBatchRoot);}}};var _proto98=StaticBatchManager.prototype;_proto98._partition=function _partition(items,left,right){var pivot=items[Math.floor((right+left)/2)];while(left<=right){while(this._compare(items[left],pivot)<0){left++;}while(this._compare(items[right],pivot)>0){right--;}if(left<right){var temp=items[left];items[left]=items[right];items[right]=temp;left++;right--;}else if(left===right){left++;break;}}return left;};_proto98._quickSort=function _quickSort(items,left,right){if(items.length>1){var index=this._partition(items,left,right);var leftIndex=index-1;if(left<leftIndex)this._quickSort(items,left,leftIndex);if(index<right)this._quickSort(items,index,right);}};_proto98._compare=function _compare(left,right){throw "StaticBatch:must override this function.";};_proto98._initStaticBatchs=function _initStaticBatchs(rootSprite){throw "StaticBatch:must override this function.";};_proto98._getBatchRenderElementFromPool=function _getBatchRenderElementFromPool(){throw "StaticBatch:must override this function.";};_proto98._addBatchSprite=function _addBatchSprite(renderableSprite3D){this._initBatchSprites.push(renderableSprite3D);};_proto98._clear=function _clear(){this._batchRenderElementPoolIndex=0;};_proto98._garbageCollection=function _garbageCollection(){throw "StaticBatchManager: must override it.";};_proto98.dispose=function dispose(){this._staticBatches=null;};return StaticBatchManager;}();StaticBatchManager._managers=[];var SubMeshStaticBatch=/*#__PURE__*/function(_GeometryElement3){_inheritsLoose(SubMeshStaticBatch,_GeometryElement3);function SubMeshStaticBatch(batchOwner,vertexDeclaration){var _this46;_this46=_GeometryElement3.call(this)||this;_this46._bufferState=new BufferState();_this46._batchID=SubMeshStaticBatch._batchIDCounter++;_this46._batchElements=[];_this46._currentBatchVertexCount=0;_this46._currentBatchIndexCount=0;_this46._vertexDeclaration=vertexDeclaration;_this46.batchOwner=batchOwner;return _this46;}var _proto99=SubMeshStaticBatch.prototype;_proto99._getStaticBatchBakedVertexs=function _getStaticBatchBakedVertexs(batchVertices,batchOffset,batchOwnerTransform,transform,render,mesh){var vertexBuffer=mesh._vertexBuffer;var vertexDeclaration=vertexBuffer.vertexDeclaration;var positionOffset=vertexDeclaration.getVertexElementByUsage(VertexMesh.MESH_POSITION0)._offset/4;var normalElement=vertexDeclaration.getVertexElementByUsage(VertexMesh.MESH_NORMAL0);var normalOffset=normalElement?normalElement._offset/4:-1;var colorElement=vertexDeclaration.getVertexElementByUsage(VertexMesh.MESH_COLOR0);var colorOffset=colorElement?colorElement._offset/4:-1;var uv0Element=vertexDeclaration.getVertexElementByUsage(VertexMesh.MESH_TEXTURECOORDINATE0);var uv0Offset=uv0Element?uv0Element._offset/4:-1;var uv1Element=vertexDeclaration.getVertexElementByUsage(VertexMesh.MESH_TEXTURECOORDINATE1);var uv1Offset=uv1Element?uv1Element._offset/4:-1;var tangentElement=vertexDeclaration.getVertexElementByUsage(VertexMesh.MESH_TANGENT0);var sTangentOffset=tangentElement?tangentElement._offset/4:-1;var bakeVertexFloatCount=18;var oriVertexFloatCount=vertexDeclaration.vertexStride/4;var oriVertexes=vertexBuffer.getFloat32Data();var worldMat;if(batchOwnerTransform){var rootMat=batchOwnerTransform.worldMatrix;rootMat.invert(SubMeshStaticBatch._tempMatrix4x40);worldMat=SubMeshStaticBatch._tempMatrix4x41;Matrix4x4.multiply(SubMeshStaticBatch._tempMatrix4x40,transform.worldMatrix,worldMat);}else {worldMat=transform.worldMatrix;}var normalMat=SubMeshStaticBatch._tempMatrix4x42;worldMat.invert(normalMat);normalMat.transpose();var rotation=SubMeshStaticBatch._tempQuaternion0;worldMat.decomposeTransRotScale(SubMeshStaticBatch._tempVector30,rotation,SubMeshStaticBatch._tempVector31);var lightmapScaleOffset=render.lightmapScaleOffset;var vertexCount=mesh.vertexCount;for(var i=0;i<vertexCount;i++){var oriOffset=i*oriVertexFloatCount;var bakeOffset=(i+batchOffset)*bakeVertexFloatCount;Utils3D.transformVector3ArrayToVector3ArrayCoordinate(oriVertexes,oriOffset+positionOffset,worldMat,batchVertices,bakeOffset+0);if(normalOffset!==-1)Utils3D.transformVector3ArrayToVector3ArrayNormal(oriVertexes,oriOffset+normalOffset,normalMat,batchVertices,bakeOffset+3);var j,m;var bakOff=bakeOffset+6;if(colorOffset!==-1){var oriOff=oriOffset+colorOffset;for(j=0,m=4;j<m;j++){batchVertices[bakOff+j]=oriVertexes[oriOff+j];}}else {for(j=0,m=4;j<m;j++){batchVertices[bakOff+j]=1.0;}}if(uv0Offset!==-1){var absUv0Offset=oriOffset+uv0Offset;batchVertices[bakeOffset+10]=oriVertexes[absUv0Offset];batchVertices[bakeOffset+11]=oriVertexes[absUv0Offset+1];}if(lightmapScaleOffset){if(uv1Offset!==-1)Utils3D.transformLightingMapTexcoordArray(oriVertexes,oriOffset+uv1Offset,lightmapScaleOffset,batchVertices,bakeOffset+12);else Utils3D.transformLightingMapTexcoordArray(oriVertexes,oriOffset+uv0Offset,lightmapScaleOffset,batchVertices,bakeOffset+12);}if(sTangentOffset!==-1){var absSTanegntOffset=oriOffset+sTangentOffset;batchVertices[bakeOffset+14]=oriVertexes[absSTanegntOffset];batchVertices[bakeOffset+15]=oriVertexes[absSTanegntOffset+1];batchVertices[bakeOffset+16]=oriVertexes[absSTanegntOffset+2];batchVertices[bakeOffset+17]=oriVertexes[absSTanegntOffset+3];}}return vertexCount;};_proto99.addTest=function addTest(sprite){var vertexCount;var subMeshVertexCount=sprite.meshFilter.sharedMesh.vertexCount;vertexCount=this._currentBatchVertexCount+subMeshVertexCount;if(vertexCount>SubMeshStaticBatch.maxBatchVertexCount)return false;return true;};_proto99.add=function add(sprite){var mesh=sprite.meshFilter.sharedMesh;var subMeshVertexCount=mesh.vertexCount;this._batchElements.push(sprite);var render=sprite._render;render._isPartOfStaticBatch=true;render._staticBatch=this;var renderElements=render._renderElements;for(var i=0,n=renderElements.length;i<n;i++){renderElements[i].staticBatch=this;}this._currentBatchIndexCount+=mesh._indexBuffer.indexCount;this._currentBatchVertexCount+=subMeshVertexCount;};_proto99.remove=function remove(sprite){var mesh=sprite.meshFilter.sharedMesh;var index=this._batchElements.indexOf(sprite);if(index!==-1){this._batchElements.splice(index,1);var renderElements=sprite._render._renderElements;for(var i=0,n=renderElements.length;i<n;i++){renderElements[i].staticBatch=null;}this._currentBatchIndexCount=this._currentBatchIndexCount-mesh._indexBuffer.indexCount;this._currentBatchVertexCount=this._currentBatchVertexCount-mesh.vertexCount;sprite._render._isPartOfStaticBatch=false;}};_proto99.finishInit=function finishInit(){if(this._vertexBuffer){this._vertexBuffer.destroy();this._indexBuffer.destroy();Laya.Resource._addGPUMemory(-(this._vertexBuffer._byteLength+this._indexBuffer._byteLength));}var gl=Laya.LayaGL.instance;var batchVertexCount=0;var batchIndexCount=0;var rootOwner=this.batchOwner;var floatStride=this._vertexDeclaration.vertexStride/4;var vertexDatas=new Float32Array(floatStride*this._currentBatchVertexCount);var indexDatas=new Uint16Array(this._currentBatchIndexCount);this._vertexBuffer=new VertexBuffer3D(this._vertexDeclaration.vertexStride*this._currentBatchVertexCount,gl.STATIC_DRAW);this._vertexBuffer.vertexDeclaration=this._vertexDeclaration;this._indexBuffer=new IndexBuffer3D(exports.IndexFormat.UInt16,this._currentBatchIndexCount,gl.STATIC_DRAW);for(var i=0,n=this._batchElements.length;i<n;i++){var sprite=this._batchElements[i];var mesh=sprite.meshFilter.sharedMesh;var meshVerCount=this._getStaticBatchBakedVertexs(vertexDatas,batchVertexCount,rootOwner?rootOwner._transform:null,sprite._transform,sprite._render,mesh);var indices=mesh._indexBuffer.getData();var indexOffset=batchVertexCount;var indexEnd=batchIndexCount+indices.length;var elements=sprite._render._renderElements;for(var j=0,m=mesh.subMeshCount;j<m;j++){var subMesh=mesh._subMeshes[j];var start=batchIndexCount+subMesh._indexStart;var element=elements[j];element.staticBatchIndexStart=start;element.staticBatchIndexEnd=start+subMesh._indexCount;}indexDatas.set(indices,batchIndexCount);var k;var isInvert=rootOwner?sprite._transform._isFrontFaceInvert!==rootOwner.transform._isFrontFaceInvert:sprite._transform._isFrontFaceInvert;if(isInvert){for(k=batchIndexCount;k<indexEnd;k+=3){indexDatas[k]=indexOffset+indexDatas[k];var index1=indexDatas[k+1];var index2=indexDatas[k+2];indexDatas[k+1]=indexOffset+index2;indexDatas[k+2]=indexOffset+index1;}}else {for(k=batchIndexCount;k<indexEnd;k+=3){indexDatas[k]=indexOffset+indexDatas[k];indexDatas[k+1]=indexOffset+indexDatas[k+1];indexDatas[k+2]=indexOffset+indexDatas[k+2];}}batchIndexCount+=indices.length;batchVertexCount+=meshVerCount;}this._vertexBuffer.setData(vertexDatas.buffer);this._indexBuffer.setData(indexDatas);var memorySize=this._vertexBuffer._byteLength+this._indexBuffer._byteLength;Laya.Resource._addGPUMemory(memorySize);this._bufferState.bind();this._bufferState.applyVertexBuffer(this._vertexBuffer);this._bufferState.applyIndexBuffer(this._indexBuffer);this._bufferState.unBind();};_proto99._render=function _render(state){this._bufferState.bind();var gl=Laya.LayaGL.instance;var element=state.renderElement;var staticBatchElementList=element.staticBatchElementList;var batchElementList=staticBatchElementList.elements;var from=0;var end=0;var count=staticBatchElementList.length;for(var i=1;i<count;i++){var lastElement=batchElementList[i-1];if(lastElement.staticBatchIndexEnd===batchElementList[i].staticBatchIndexStart){end++;continue;}else {var start=batchElementList[from].staticBatchIndexStart;var indexCount=batchElementList[end].staticBatchIndexEnd-start;gl.drawElements(gl.TRIANGLES,indexCount,gl.UNSIGNED_SHORT,start*2);from=++end;Laya.Stat.trianglesFaces+=indexCount/3;}}start=batchElementList[from].staticBatchIndexStart;indexCount=batchElementList[end].staticBatchIndexEnd-start;gl.drawElements(gl.TRIANGLES,indexCount,gl.UNSIGNED_SHORT,start*2);Laya.Stat.renderBatches++;Laya.Stat.savedRenderBatches+=count-1;Laya.Stat.trianglesFaces+=indexCount/3;};_proto99.dispose=function dispose(){var memorySize=this._vertexBuffer._byteLength+this._indexBuffer._byteLength;Laya.Resource._addGPUMemory(-memorySize);this._batchElements=null;this.batchOwner=null;this._vertexDeclaration=null;this._bufferState.destroy();this._vertexBuffer.destroy();this._indexBuffer.destroy();this._vertexBuffer=null;this._indexBuffer=null;this._bufferState=null;};return SubMeshStaticBatch;}(GeometryElement);SubMeshStaticBatch._tempVector30=new Vector3();SubMeshStaticBatch._tempVector31=new Vector3();SubMeshStaticBatch._tempQuaternion0=new Quaternion();SubMeshStaticBatch._tempMatrix4x40=new Matrix4x4();SubMeshStaticBatch._tempMatrix4x41=new Matrix4x4();SubMeshStaticBatch._tempMatrix4x42=new Matrix4x4();SubMeshStaticBatch.maxBatchVertexCount=65535;SubMeshStaticBatch._batchIDCounter=0;var MeshRenderStaticBatchManager=/*#__PURE__*/function(_StaticBatchManager){_inheritsLoose(MeshRenderStaticBatchManager,_StaticBatchManager);function MeshRenderStaticBatchManager(){var _this47;_this47=_StaticBatchManager.call(this)||this;_this47._opaqueBatchMarks=[];_this47._updateCountMark=0;return _this47;}MeshRenderStaticBatchManager.__init__=function __init__(){MeshRenderStaticBatchManager._verDec=VertexMesh.getVertexDeclaration("POSITION,NORMAL,COLOR,UV,UV1,TANGENT");};var _proto100=MeshRenderStaticBatchManager.prototype;_proto100._compare=function _compare(left,right){var lRender=left._render,rRender=right._render;var leftGeo=left.meshFilter.sharedMesh,rightGeo=right.meshFilter.sharedMesh;var lightOffset=lRender.lightmapIndex-rRender.lightmapIndex;if(lightOffset===0){var receiveShadowOffset=(lRender.receiveShadow?1:0)-(rRender.receiveShadow?1:0);if(receiveShadowOffset===0){var materialOffset=lRender.sharedMaterial&&rRender.sharedMaterial?lRender.sharedMaterial.id-rRender.sharedMaterial.id:0;if(materialOffset===0){var verDec=leftGeo._vertexBuffer.vertexDeclaration.id-rightGeo._vertexBuffer.vertexDeclaration.id;if(verDec===0){return rightGeo._indexBuffer.indexCount-leftGeo._indexBuffer.indexCount;}else {return verDec;}}else {return materialOffset;}}else {return receiveShadowOffset;}}else {return lightOffset;}};_proto100._getBatchRenderElementFromPool=function _getBatchRenderElementFromPool(){var renderElement=this._batchRenderElementPool[this._batchRenderElementPoolIndex++];if(!renderElement){renderElement=new SubMeshRenderElement();this._batchRenderElementPool[this._batchRenderElementPoolIndex-1]=renderElement;renderElement.staticBatchElementList=new SingletonList();}return renderElement;};_proto100._getStaticBatch=function _getStaticBatch(staticBatches,rootOwner,number){var subMeshStaticBatch=staticBatches[number];if(!subMeshStaticBatch){subMeshStaticBatch=staticBatches[number]=new SubMeshStaticBatch(rootOwner,MeshRenderStaticBatchManager._verDec);this._staticBatches[subMeshStaticBatch._batchID]=subMeshStaticBatch;}return subMeshStaticBatch;};_proto100._initStaticBatchs=function _initStaticBatchs(rootOwner){var initBatchSprites=this._initBatchSprites;this._quickSort(initBatchSprites,0,initBatchSprites.length-1);var staticBatches=[];var lastCanMerage=false;var curStaticBatch;var batchNumber=0;for(var i=0,n=initBatchSprites.length;i<n;i++){var sprite=initBatchSprites[i];if(lastCanMerage){if(curStaticBatch.addTest(sprite)){curStaticBatch.add(sprite);}else {lastCanMerage=false;batchNumber++;}}else {var lastIndex=n-1;if(i!==lastIndex){curStaticBatch=this._getStaticBatch(staticBatches,rootOwner,batchNumber);curStaticBatch.add(sprite);lastCanMerage=true;}}}for(i=0,n=staticBatches.length;i<n;i++){var staticBatch=staticBatches[i];staticBatch&&staticBatch.finishInit();}this._initBatchSprites.length=0;};_proto100._removeRenderSprite=function _removeRenderSprite(sprite){var render=sprite._render;var staticBatch=render._staticBatch;var batchElements=staticBatch._batchElements;var index=batchElements.indexOf(sprite);if(index!==-1){batchElements.splice(index,1);render._staticBatch=null;var renderElements=render._renderElements;for(var i=0,n=renderElements.length;i<n;i++){renderElements[i].staticBatch=null;}}if(batchElements.length===0){delete this._staticBatches[staticBatch._batchID];staticBatch.dispose();}};_proto100._clear=function _clear(){_StaticBatchManager.prototype._clear.call(this);this._updateCountMark++;};_proto100._garbageCollection=function _garbageCollection(){for(var key in this._staticBatches){var staticBatch=this._staticBatches[key];if(staticBatch._batchElements.length===0){staticBatch.dispose();delete this._staticBatches[key];}}};_proto100.getBatchOpaquaMark=function getBatchOpaquaMark(lightMapIndex,receiveShadow,materialID,staticBatchID){var receiveShadowIndex=receiveShadow?1:0;var staLightMapMarks=this._opaqueBatchMarks[lightMapIndex]||(this._opaqueBatchMarks[lightMapIndex]=[]);var staReceiveShadowMarks=staLightMapMarks[receiveShadowIndex]||(staLightMapMarks[receiveShadowIndex]=[]);var staMaterialMarks=staReceiveShadowMarks[materialID]||(staReceiveShadowMarks[materialID]=[]);return staMaterialMarks[staticBatchID]||(staMaterialMarks[staticBatchID]=new BatchMark());};return MeshRenderStaticBatchManager;}(StaticBatchManager);MeshRenderStaticBatchManager.instance=new MeshRenderStaticBatchManager();var BaseRender=/*#__PURE__*/function(_Laya$EventDispatcher3){_inheritsLoose(BaseRender,_Laya$EventDispatcher3);function BaseRender(owner){var _this48;_this48=_Laya$EventDispatcher3.call(this)||this;_this48._lightmapScaleOffset=new Vector4(1,1,0,0);_this48._indexInList=-1;_this48._indexInCastShadowList=-1;_this48._boundsChange=true;_this48._castShadow=false;_this48._supportOctree=true;_this48._sharedMaterials=[];_this48._renderMark=-1;_this48._indexInOctreeMotionList=-1;_this48._updateMark=-1;_this48._updateRenderType=-1;_this48._isPartOfStaticBatch=false;_this48._staticBatch=null;_this48._id=++BaseRender._uniqueIDCounter;_this48._indexInCastShadowList=-1;_this48._bounds=new Bounds(Vector3._ZERO,Vector3._ZERO);if(Laya.Render.supportWebGLPlusCulling){var length=FrustumCulling._cullingBufferLength;_this48._cullingBufferIndex=length;var cullingBuffer=FrustumCulling._cullingBuffer;var resizeLength=length+7;if(resizeLength>=cullingBuffer.length){var temp=cullingBuffer;cullingBuffer=FrustumCulling._cullingBuffer=new Float32Array(cullingBuffer.length+4096);cullingBuffer.set(temp,0);}cullingBuffer[length]=2;FrustumCulling._cullingBufferLength=resizeLength;}_this48._renderElements=[];_this48._owner=owner;_this48._enable=true;_this48._materialsInstance=[];_this48._shaderValues=new ShaderData(null);_this48.lightmapIndex=-1;_this48.receiveShadow=false;_this48.sortingFudge=0.0;owner&&_this48._owner.transform.on(Laya.Event.TRANSFORM_CHANGED,_assertThisInitialized(_this48),_this48._onWorldMatNeedChange);return _this48;}var _proto101=BaseRender.prototype;_proto101._getOctreeNode=function _getOctreeNode(){return this._octreeNode;};_proto101._setOctreeNode=function _setOctreeNode(value){this._octreeNode=value;};_proto101._getIndexInMotionList=function _getIndexInMotionList(){return this._indexInOctreeMotionList;};_proto101._setIndexInMotionList=function _setIndexInMotionList(value){this._indexInOctreeMotionList=value;};_proto101._changeMaterialReference=function _changeMaterialReference(lastValue,value){lastValue&&lastValue._removeReference();value._addReference();};_proto101._getInstanceMaterial=function _getInstanceMaterial(material,index){var insMat=material.clone();insMat.name=insMat.name+"(Instance)";this._materialsInstance[index]=true;this._changeMaterialReference(this._sharedMaterials[index],insMat);this._sharedMaterials[index]=insMat;return insMat;};_proto101._applyLightMapParams=function _applyLightMapParams(){var lightMaps=this._scene.lightmaps;var shaderValues=this._shaderValues;var lightmapIndex=this._lightmapIndex;if(lightmapIndex>=0&&lightmapIndex<lightMaps.length){var lightMap=lightMaps[lightmapIndex];shaderValues.setTexture(RenderableSprite3D.LIGHTMAP,lightMap.lightmapColor);shaderValues.addDefine(RenderableSprite3D.SAHDERDEFINE_LIGHTMAP);if(lightMap.lightmapDirection){shaderValues.setTexture(RenderableSprite3D.LIGHTMAP_DIRECTION,lightMap.lightmapDirection);shaderValues.addDefine(RenderableSprite3D.SHADERDEFINE_LIGHTMAP_DIRECTIONAL);}else {shaderValues.removeDefine(RenderableSprite3D.SHADERDEFINE_LIGHTMAP_DIRECTIONAL);}}else {shaderValues.removeDefine(RenderableSprite3D.SAHDERDEFINE_LIGHTMAP);shaderValues.removeDefine(RenderableSprite3D.SHADERDEFINE_LIGHTMAP_DIRECTIONAL);}};_proto101._onWorldMatNeedChange=function _onWorldMatNeedChange(flag){this._boundsChange=true;if(this._octreeNode){flag&=Transform3D.TRANSFORM_WORLDPOSITION|Transform3D.TRANSFORM_WORLDQUATERNION|Transform3D.TRANSFORM_WORLDSCALE;if(flag){if(this._indexInOctreeMotionList===-1)this._octreeNode._octree.addMotionObject(this);}}};_proto101._calculateBoundingBox=function _calculateBoundingBox(){throw "BaseRender: must override it.";};_proto101._getIndexInList=function _getIndexInList(){return this._indexInList;};_proto101._setIndexInList=function _setIndexInList(index){this._indexInList=index;};_proto101._setBelongScene=function _setBelongScene(scene){this._scene=scene;};_proto101._needRender=function _needRender(boundFrustum,context){return true;};_proto101._renderUpdate=function _renderUpdate(context,transform){};_proto101._renderUpdateWithCamera=function _renderUpdateWithCamera(context,transform){};_proto101._revertBatchRenderUpdate=function _revertBatchRenderUpdate(context){};_proto101._destroy=function _destroy(){this._indexInOctreeMotionList!==-1&&this._octreeNode._octree.removeMotionObject(this);this.offAll();var i=0,n=0;for(i=0,n=this._renderElements.length;i<n;i++){this._renderElements[i].destroy();}for(i=0,n=this._sharedMaterials.length;i<n;i++){this._sharedMaterials[i].destroyed||this._sharedMaterials[i]._removeReference();}this._renderElements=null;this._owner=null;this._sharedMaterials=null;this._bounds=null;this._lightmapScaleOffset=null;};_proto101.markAsUnStatic=function markAsUnStatic(){if(this._isPartOfStaticBatch){MeshRenderStaticBatchManager.instance._removeRenderSprite(this._owner);this._isPartOfStaticBatch=false;}};_createClass(BaseRender,[{key:"id",get:function get(){return this._id;}},{key:"lightmapIndex",get:function get(){return this._lightmapIndex;},set:function set(value){this._lightmapIndex=value;}},{key:"lightmapScaleOffset",get:function get(){return this._lightmapScaleOffset;},set:function set(value){if(!value)throw "BaseRender: lightmapScaleOffset can't be null.";this._lightmapScaleOffset=value;this._shaderValues.setVector(RenderableSprite3D.LIGHTMAPSCALEOFFSET,value);}},{key:"enable",get:function get(){return this._enable;},set:function set(value){this._enable=!!value;}},{key:"material",get:function get(){var material=this._sharedMaterials[0];if(material&&!this._materialsInstance[0]){var insMat=this._getInstanceMaterial(material,0);var renderElement=this._renderElements[0];renderElement&&(renderElement.material=insMat);}return this._sharedMaterials[0];},set:function set(value){this.sharedMaterial=value;}},{key:"materials",get:function get(){for(var i=0,n=this._sharedMaterials.length;i<n;i++){if(!this._materialsInstance[i]){var insMat=this._getInstanceMaterial(this._sharedMaterials[i],i);var renderElement=this._renderElements[i];renderElement&&(renderElement.material=insMat);}}return this._sharedMaterials.slice();},set:function set(value){this.sharedMaterials=value;}},{key:"sharedMaterial",get:function get(){return this._sharedMaterials[0];},set:function set(value){var lastValue=this._sharedMaterials[0];if(lastValue!==value){this._sharedMaterials[0]=value;this._materialsInstance[0]=false;this._changeMaterialReference(lastValue,value);var renderElement=this._renderElements[0];renderElement&&(renderElement.material=value);}}},{key:"sharedMaterials",get:function get(){return this._sharedMaterials.slice();},set:function set(value){var materialsInstance=this._materialsInstance;var sharedMats=this._sharedMaterials;for(var i=0,n=sharedMats.length;i<n;i++){var lastMat=sharedMats[i];lastMat&&lastMat._removeReference();}if(value){var count=value.length;materialsInstance.length=count;sharedMats.length=count;for(i=0;i<count;i++){lastMat=sharedMats[i];var mat=value[i];if(lastMat!==mat){materialsInstance[i]=false;var renderElement=this._renderElements[i];renderElement&&(renderElement.material=mat);}if(mat){mat._addReference();}sharedMats[i]=mat;}}else {throw new Error("BaseRender: shadredMaterials value can't be null.");}}},{key:"bounds",get:function get(){if(this._boundsChange){this._calculateBoundingBox();this._boundsChange=false;}return this._bounds;}},{key:"receiveShadow",set:function set(value){if(this._receiveShadow!==value){this._receiveShadow=value;if(value)this._shaderValues.addDefine(RenderableSprite3D.SHADERDEFINE_RECEIVE_SHADOW);else this._shaderValues.removeDefine(RenderableSprite3D.SHADERDEFINE_RECEIVE_SHADOW);}},get:function get(){return this._receiveShadow;}},{key:"castShadow",get:function get(){return this._castShadow;},set:function set(value){this._castShadow=value;}},{key:"isPartOfStaticBatch",get:function get(){return this._isPartOfStaticBatch;}},{key:"isRender",get:function get(){return this._renderMark==-1||this._renderMark==Laya.Stat.loopCount-1;}}]);return BaseRender;}(Laya.EventDispatcher);BaseRender._tempBoundBoxCorners=[new Vector3(),new Vector3(),new Vector3(),new Vector3(),new Vector3(),new Vector3(),new Vector3(),new Vector3()];BaseRender._uniqueIDCounter=0;BaseRender._defaultLightmapScaleOffset=new Vector4(1.0,1.0,0.0,0.0);var PixelLineRenderer=/*#__PURE__*/function(_BaseRender){_inheritsLoose(PixelLineRenderer,_BaseRender);function PixelLineRenderer(owner){var _this49;_this49=_BaseRender.call(this,owner)||this;_this49._projectionViewWorldMatrix=new Matrix4x4();return _this49;}var _proto102=PixelLineRenderer.prototype;_proto102._calculateBoundingBox=function _calculateBoundingBox(){var worldMat=this._owner.transform.worldMatrix;var lineFilter=this._owner._geometryFilter;lineFilter._reCalculateBound();lineFilter._bounds._tranform(worldMat,this._bounds);if(Laya.Render.supportWebGLPlusCulling){var min=this._bounds.getMin();var max=this._bounds.getMax();var buffer=FrustumCulling._cullingBuffer;buffer[this._cullingBufferIndex+1]=min.x;buffer[this._cullingBufferIndex+2]=min.y;buffer[this._cullingBufferIndex+3]=min.z;buffer[this._cullingBufferIndex+4]=max.x;buffer[this._cullingBufferIndex+5]=max.y;buffer[this._cullingBufferIndex+6]=max.z;}};_proto102._renderUpdateWithCamera=function _renderUpdateWithCamera(context,transform){var projectionView=context.projectionViewMatrix;var sv=this._shaderValues;if(transform){var worldMat=transform.worldMatrix;sv.setMatrix4x4(Sprite3D.WORLDMATRIX,worldMat);Matrix4x4.multiply(projectionView,worldMat,this._projectionViewWorldMatrix);sv.setMatrix4x4(Sprite3D.MVPMATRIX,this._projectionViewWorldMatrix);}else {sv.setMatrix4x4(Sprite3D.WORLDMATRIX,Matrix4x4.DEFAULT);sv.setMatrix4x4(Sprite3D.MVPMATRIX,projectionView);}};return PixelLineRenderer;}(BaseRender);var PixelLineSprite3D=/*#__PURE__*/function(_RenderableSprite3D){_inheritsLoose(PixelLineSprite3D,_RenderableSprite3D);function PixelLineSprite3D(maxCount,name){var _this50;if(maxCount===void 0){maxCount=2;}if(name===void 0){name=null;}_this50=_RenderableSprite3D.call(this,name)||this;_this50._geometryFilter=new PixelLineFilter(_assertThisInitialized(_this50),maxCount);_this50._render=new PixelLineRenderer(_assertThisInitialized(_this50));_this50._changeRenderObjects(_this50._render,0,PixelLineMaterial.defaultMaterial);return _this50;}var _proto103=PixelLineSprite3D.prototype;_proto103._changeRenderObjects=function _changeRenderObjects(sender,index,material){var renderObjects=this._render._renderElements;material||(material=PixelLineMaterial.defaultMaterial);var renderElement=renderObjects[index];renderElement||(renderElement=renderObjects[index]=new RenderElement());renderElement.setTransform(this._transform);renderElement.setGeometry(this._geometryFilter);renderElement.render=this._render;renderElement.material=material;};_proto103.addLine=function addLine(startPosition,endPosition,startColor,endColor){if(this._geometryFilter._lineCount!==this._geometryFilter._maxLineCount)this._geometryFilter._updateLineData(this._geometryFilter._lineCount++,startPosition,endPosition,startColor,endColor);else throw "PixelLineSprite3D: lineCount has equal with maxLineCount.";};_proto103.addLines=function addLines(lines){var lineCount=this._geometryFilter._lineCount;var addCount=lines.length;if(lineCount+addCount>this._geometryFilter._maxLineCount){throw "PixelLineSprite3D: lineCount plus lines count must less than maxLineCount.";}else {this._geometryFilter._updateLineDatas(lineCount,lines);this._geometryFilter._lineCount+=addCount;}};_proto103.removeLine=function removeLine(index){if(index<this._geometryFilter._lineCount)this._geometryFilter._removeLineData(index);else throw "PixelLineSprite3D: index must less than lineCount.";};_proto103.setLine=function setLine(index,startPosition,endPosition,startColor,endColor){if(index<this._geometryFilter._lineCount)this._geometryFilter._updateLineData(index,startPosition,endPosition,startColor,endColor);else throw "PixelLineSprite3D: index must less than lineCount.";};_proto103.getLine=function getLine(index,out){if(index<this.lineCount)this._geometryFilter._getLineData(index,out);else throw "PixelLineSprite3D: index must less than lineCount.";};_proto103.clear=function clear(){this._geometryFilter._lineCount=0;};_proto103._create=function _create(){return new PixelLineSprite3D();};_createClass(PixelLineSprite3D,[{key:"maxLineCount",get:function get(){return this._geometryFilter._maxLineCount;},set:function set(value){this._geometryFilter._resizeLineData(value);this._geometryFilter._lineCount=Math.min(this._geometryFilter._lineCount,value);}},{key:"lineCount",get:function get(){return this._geometryFilter._lineCount;},set:function set(value){if(value>this.maxLineCount)throw "PixelLineSprite3D: lineCount can't large than maxLineCount";else this._geometryFilter._lineCount=value;}},{key:"pixelLineRenderer",get:function get(){return this._render;}}]);return PixelLineSprite3D;}(RenderableSprite3D);var RenderQueue=/*#__PURE__*/function(){function RenderQueue(isTransparent){if(isTransparent===void 0){isTransparent=false;}this.isTransparent=false;this.elements=new SingletonList();this.lastTransparentRenderElement=null;this.lastTransparentBatched=false;this.isTransparent=isTransparent;}var _proto104=RenderQueue.prototype;_proto104._compare=function _compare(left,right){var renderQueue=left.material.renderQueue-right.material.renderQueue;if(renderQueue===0){var sort=this.isTransparent?right.render._distanceForSort-left.render._distanceForSort:left.render._distanceForSort-right.render._distanceForSort;return sort+right.render.sortingFudge-left.render.sortingFudge;}else {return renderQueue;}};_proto104._partitionRenderObject=function _partitionRenderObject(left,right){var elements=this.elements.elements;var pivot=elements[Math.floor((right+left)/2)];while(left<=right){while(this._compare(elements[left],pivot)<0){left++;}while(this._compare(elements[right],pivot)>0){right--;}if(left<right){var temp=elements[left];elements[left]=elements[right];elements[right]=temp;left++;right--;}else if(left===right){left++;break;}}return left;};_proto104._quickSort=function _quickSort(left,right){if(this.elements.length>1){var index=this._partitionRenderObject(left,right);var leftIndex=index-1;if(left<leftIndex)this._quickSort(left,leftIndex);if(index<right)this._quickSort(index,right);}};_proto104._render=function _render(context){var elements=this.elements.elements;for(var i=0,n=this.elements.length;i<n;i++){elements[i]._render(context);}};_proto104.clear=function clear(){this.elements.length=0;this.lastTransparentRenderElement=null;this.lastTransparentBatched=false;};return RenderQueue;}();var BoundsOctreeNode=/*#__PURE__*/function(){function BoundsOctreeNode(octree,parent,baseLength,center){this._bounds=new BoundBox(new Vector3(),new Vector3());this._objects=[];this._isContaion=false;this.center=new Vector3();this.baseLength=0.0;this._setValues(octree,parent,baseLength,center);}BoundsOctreeNode._encapsulates=function _encapsulates(outerBound,innerBound){return CollisionUtils.boxContainsBox(outerBound,innerBound)==ContainmentType.Contains;};var _proto105=BoundsOctreeNode.prototype;_proto105._setValues=function _setValues(octree,parent,baseLength,center){this._octree=octree;this._parent=parent;this.baseLength=baseLength;center.cloneTo(this.center);var min=this._bounds.min;var max=this._bounds.max;var halfSize=octree._looseness*baseLength/2;min.setValue(center.x-halfSize,center.y-halfSize,center.z-halfSize);max.setValue(center.x+halfSize,center.y+halfSize,center.z+halfSize);};_proto105._getChildBound=function _getChildBound(index){if(this._children!=null&&this._children[index]){return this._children[index]._bounds;}else {var quarter=this.baseLength/4;var halfChildSize=this.baseLength/2*this._octree._looseness/2;var bounds=BoundsOctreeNode._tempBoundBox;var min=bounds.min;var max=bounds.max;switch(index){case 0:min.x=this.center.x-quarter-halfChildSize;min.y=this.center.y+quarter-halfChildSize;min.z=this.center.z-quarter-halfChildSize;max.x=this.center.x-quarter+halfChildSize;max.y=this.center.y+quarter+halfChildSize;max.z=this.center.z-quarter+halfChildSize;break;case 1:min.x=this.center.x+quarter-halfChildSize;min.y=this.center.y+quarter-halfChildSize;min.z=this.center.z-quarter-halfChildSize;max.x=this.center.x+quarter+halfChildSize;max.y=this.center.y+quarter+halfChildSize;max.z=this.center.z-quarter+halfChildSize;break;case 2:min.x=this.center.x-quarter-halfChildSize;min.y=this.center.y+quarter-halfChildSize;min.z=this.center.z+quarter-halfChildSize;max.x=this.center.x-quarter+halfChildSize;max.y=this.center.y+quarter+halfChildSize;max.z=this.center.z+quarter+halfChildSize;break;case 3:min.x=this.center.x+quarter-halfChildSize;min.y=this.center.y+quarter-halfChildSize;min.z=this.center.z+quarter-halfChildSize;max.x=this.center.x+quarter+halfChildSize;max.y=this.center.y+quarter+halfChildSize;max.z=this.center.z+quarter+halfChildSize;break;case 4:min.x=this.center.x-quarter-halfChildSize;min.y=this.center.y-quarter-halfChildSize;min.z=this.center.z-quarter-halfChildSize;max.x=this.center.x-quarter+halfChildSize;max.y=this.center.y-quarter+halfChildSize;max.z=this.center.z-quarter+halfChildSize;break;case 5:min.x=this.center.x+quarter-halfChildSize;min.y=this.center.y-quarter-halfChildSize;min.z=this.center.z-quarter-halfChildSize;max.x=this.center.x+quarter+halfChildSize;max.y=this.center.y-quarter+halfChildSize;max.z=this.center.z-quarter+halfChildSize;break;case 6:min.x=this.center.x-quarter-halfChildSize;min.y=this.center.y-quarter-halfChildSize;min.z=this.center.z+quarter-halfChildSize;max.x=this.center.x-quarter+halfChildSize;max.y=this.center.y-quarter+halfChildSize;max.z=this.center.z+quarter+halfChildSize;break;case 7:min.x=this.center.x+quarter-halfChildSize;min.y=this.center.y-quarter-halfChildSize;min.z=this.center.z+quarter-halfChildSize;max.x=this.center.x+quarter+halfChildSize;max.y=this.center.y-quarter+halfChildSize;max.z=this.center.z+quarter+halfChildSize;break;}return bounds;}};_proto105._getChildCenter=function _getChildCenter(index){if(this._children!=null){return this._children[index].center;}else {var quarter=this.baseLength/4;var childCenter=BoundsOctreeNode._tempVector30;switch(index){case 0:childCenter.x=this.center.x-quarter;childCenter.y=this.center.y+quarter;childCenter.z=this.center.z-quarter;break;case 1:childCenter.x=this.center.x+quarter;childCenter.y=this.center.y+quarter;childCenter.z=this.center.z-quarter;break;case 2:childCenter.x=this.center.x-quarter;childCenter.y=this.center.y+quarter;childCenter.z=this.center.z+quarter;break;case 3:childCenter.x=this.center.x+quarter;childCenter.y=this.center.y+quarter;childCenter.z=this.center.z+quarter;break;case 4:childCenter.x=this.center.x-quarter;childCenter.y=this.center.y-quarter;childCenter.z=this.center.z-quarter;break;case 5:childCenter.x=this.center.x+quarter;childCenter.y=this.center.y-quarter;childCenter.z=this.center.z-quarter;break;case 6:childCenter.x=this.center.x-quarter;childCenter.y=this.center.y-quarter;childCenter.z=this.center.z+quarter;break;case 7:childCenter.x=this.center.x+quarter;childCenter.y=this.center.y-quarter;childCenter.z=this.center.z+quarter;break;}return childCenter;}};_proto105._getChild=function _getChild(index){var quarter=this.baseLength/4;this._children||(this._children=[]);switch(index){case 0:return this._children[0]||(this._children[0]=new BoundsOctreeNode(this._octree,this,this.baseLength/2,new Vector3(this.center.x+-quarter,this.center.y+quarter,this.center.z-quarter)));case 1:return this._children[1]||(this._children[1]=new BoundsOctreeNode(this._octree,this,this.baseLength/2,new Vector3(this.center.x+quarter,this.center.y+quarter,this.center.z-quarter)));case 2:return this._children[2]||(this._children[2]=new BoundsOctreeNode(this._octree,this,this.baseLength/2,new Vector3(this.center.x-quarter,this.center.y+quarter,this.center.z+quarter)));case 3:return this._children[3]||(this._children[3]=new BoundsOctreeNode(this._octree,this,this.baseLength/2,new Vector3(this.center.x+quarter,this.center.y+quarter,this.center.z+quarter)));case 4:return this._children[4]||(this._children[4]=new BoundsOctreeNode(this._octree,this,this.baseLength/2,new Vector3(this.center.x-quarter,this.center.y-quarter,this.center.z-quarter)));case 5:return this._children[5]||(this._children[5]=new BoundsOctreeNode(this._octree,this,this.baseLength/2,new Vector3(this.center.x+quarter,this.center.y-quarter,this.center.z-quarter)));case 6:return this._children[6]||(this._children[6]=new BoundsOctreeNode(this._octree,this,this.baseLength/2,new Vector3(this.center.x-quarter,this.center.y-quarter,this.center.z+quarter)));case 7:return this._children[7]||(this._children[7]=new BoundsOctreeNode(this._octree,this,this.baseLength/2,new Vector3(this.center.x+quarter,this.center.y-quarter,this.center.z+quarter)));default:throw "BoundsOctreeNode: unknown index.";}};_proto105._shouldMerge=function _shouldMerge(){var objectCount=this._objects.length;for(var i=0;i<8;i++){var child=this._children[i];if(child){if(child._children!=null)return false;objectCount+=child._objects.length;}}return objectCount<=BoundsOctreeNode._NUM_OBJECTS_ALLOWED;};_proto105._mergeChildren=function _mergeChildren(){for(var i=0;i<8;i++){var child=this._children[i];if(child){child._parent=null;var childObjects=child._objects;for(var j=childObjects.length-1;j>=0;j--){var childObject=childObjects[j];this._objects.push(childObject);childObject._setOctreeNode(this);}}}this._children=null;};_proto105._merge=function _merge(){if(this._children===null){var parent=this._parent;if(parent&&parent._shouldMerge()){parent._mergeChildren();parent._merge();}}};_proto105._checkAddNode=function _checkAddNode(object){if(this._children==null){if(this._objects.length<BoundsOctreeNode._NUM_OBJECTS_ALLOWED||this.baseLength/2<this._octree._minSize){return this;}for(var i=this._objects.length-1;i>=0;i--){var existObject=this._objects[i];var fitChildIndex=this._bestFitChild(existObject.bounds.getCenter());if(BoundsOctreeNode._encapsulates(this._getChildBound(fitChildIndex),existObject.bounds._getBoundBox())){this._objects.splice(this._objects.indexOf(existObject),1);this._getChild(fitChildIndex)._add(existObject);}}}var newFitChildIndex=this._bestFitChild(object.bounds.getCenter());if(BoundsOctreeNode._encapsulates(this._getChildBound(newFitChildIndex),object.bounds._getBoundBox()))return this._getChild(newFitChildIndex)._checkAddNode(object);else return this;};_proto105._add=function _add(object){var addNode=this._checkAddNode(object);addNode._objects.push(object);object._setOctreeNode(addNode);};_proto105._remove=function _remove(object){var index=this._objects.indexOf(object);this._objects.splice(index,1);object._setOctreeNode(null);this._merge();};_proto105._addUp=function _addUp(object){if(CollisionUtils.boxContainsBox(this._bounds,object.bounds._getBoundBox())===ContainmentType.Contains){this._add(object);return true;}else {if(this._parent)return this._parent._addUp(object);else return false;}};_proto105._getCollidingWithFrustum=function _getCollidingWithFrustum(cameraCullInfo,context,testVisible,customShader,replacementTag,isShadowCasterCull){var frustum=cameraCullInfo.boundFrustum;var camPos=cameraCullInfo.position;var cullMask=cameraCullInfo.cullingMask;if(testVisible){var type=frustum.containsBoundBox(this._bounds);Laya.Stat.octreeNodeCulling++;if(type===ContainmentType.Disjoint)return;testVisible=type===ContainmentType.Intersects;}this._isContaion=!testVisible;var scene=context.scene;var loopCount=Laya.Stat.loopCount;for(var i=0,n=this._objects.length;i<n;i++){var render=this._objects[i];var canPass;if(isShadowCasterCull)canPass=render._castShadow&&render._enable;else canPass=(Math.pow(2,render._owner._layer)&cullMask)!=0&&render._enable;if(canPass){if(testVisible){Laya.Stat.frustumCulling++;if(!render._needRender(frustum,context))continue;}render._renderMark=loopCount;render._distanceForSort=Vector3.distance(render.bounds.getCenter(),camPos);var elements=render._renderElements;for(var j=0,m=elements.length;j<m;j++){var element=elements[j];element._update(scene,context,customShader,replacementTag);}}}if(this._children!=null){for(i=0;i<8;i++){var child=this._children[i];child&&child._getCollidingWithFrustum(cameraCullInfo,context,testVisible,customShader,replacementTag,isShadowCasterCull);}}};_proto105._getCollidingWithBoundBox=function _getCollidingWithBoundBox(checkBound,testVisible,result){if(testVisible){var type=CollisionUtils.boxContainsBox(this._bounds,checkBound);if(type===ContainmentType.Disjoint)return;testVisible=type===ContainmentType.Intersects;}if(testVisible){for(var i=0,n=this._objects.length;i<n;i++){var object=this._objects[i];if(CollisionUtils.intersectsBoxAndBox(object.bounds._getBoundBox(),checkBound)){result.push(object);}}}if(this._children!=null){for(i=0;i<8;i++){var child=this._children[i];child._getCollidingWithBoundBox(checkBound,testVisible,result);}}};_proto105._bestFitChild=function _bestFitChild(boundCenter){return (boundCenter.x<=this.center.x?0:1)+(boundCenter.y>=this.center.y?0:4)+(boundCenter.z<=this.center.z?0:2);};_proto105._update=function _update(object){if(CollisionUtils.boxContainsBox(this._bounds,object.bounds._getBoundBox())===ContainmentType.Contains){var addNode=this._checkAddNode(object);if(addNode!==object._getOctreeNode()){addNode._objects.push(object);object._setOctreeNode(addNode);var index=this._objects.indexOf(object);this._objects.splice(index,1);this._merge();}return true;}else {if(this._parent){var sucess=this._parent._addUp(object);if(sucess){index=this._objects.indexOf(object);this._objects.splice(index,1);this._merge();}return sucess;}else {return false;}}};_proto105.add=function add(object){if(!BoundsOctreeNode._encapsulates(this._bounds,object.bounds._getBoundBox()))return false;this._add(object);return true;};_proto105.remove=function remove(object){if(object._getOctreeNode()!==this)return false;this._remove(object);return true;};_proto105.update=function update(object){if(object._getOctreeNode()!==this)return false;return this._update(object);};_proto105.shrinkIfPossible=function shrinkIfPossible(minLength){if(this.baseLength<minLength*2)return this;var bestFit=-1;for(var i=0,n=this._objects.length;i<n;i++){var object=this._objects[i];var newBestFit=this._bestFitChild(object.bounds.getCenter());if(i==0||newBestFit==bestFit){var childBounds=this._getChildBound(newBestFit);if(BoundsOctreeNode._encapsulates(childBounds,object.bounds._getBoundBox()))i==0&&(bestFit=newBestFit);else return this;}else {return this;}}if(this._children!=null){var childHadContent=false;for(i=0,n=this._children.length;i<n;i++){var child=this._children[i];if(child&&child.hasAnyObjects()){if(childHadContent)return this;if(bestFit>=0&&bestFit!=i)return this;childHadContent=true;bestFit=i;}}}else {if(bestFit!=-1){var childCenter=this._getChildCenter(bestFit);this._setValues(this._octree,null,this.baseLength/2,childCenter);}return this;}if(bestFit!=-1){var newRoot=this._children[bestFit];newRoot._parent=null;return newRoot;}else {return this;}};_proto105.hasAnyObjects=function hasAnyObjects(){if(this._objects.length>0)return true;if(this._children!=null){for(var i=0;i<8;i++){var child=this._children[i];if(child&&child.hasAnyObjects())return true;}}return false;};_proto105.getCollidingWithBoundBox=function getCollidingWithBoundBox(checkBound,result){this._getCollidingWithBoundBox(checkBound,true,result);};_proto105.getCollidingWithRay=function getCollidingWithRay(ray,result,maxDistance){if(maxDistance===void 0){maxDistance=Number.MAX_VALUE;}var distance=CollisionUtils.intersectsRayAndBoxRD(ray,this._bounds);if(distance==-1||distance>maxDistance)return;for(var i=0,n=this._objects.length;i<n;i++){var object=this._objects[i];distance=CollisionUtils.intersectsRayAndBoxRD(ray,object.bounds._getBoundBox());if(distance!==-1&&distance<=maxDistance)result.push(object);}if(this._children!=null){for(i=0;i<8;i++){var child=this._children[i];child.getCollidingWithRay(ray,result,maxDistance);}}};_proto105.getCollidingWithFrustum=function getCollidingWithFrustum(cameraCullInfo,context,customShader,replacementTag,isShadowCasterCull){this._getCollidingWithFrustum(cameraCullInfo,context,true,customShader,replacementTag,isShadowCasterCull);};_proto105.isCollidingWithBoundBox=function isCollidingWithBoundBox(checkBound){if(!CollisionUtils.intersectsBoxAndBox(this._bounds,checkBound))return false;for(var i=0,n=this._objects.length;i<n;i++){var object=this._objects[i];if(CollisionUtils.intersectsBoxAndBox(object.bounds._getBoundBox(),checkBound))return true;}if(this._children!=null){for(i=0;i<8;i++){var child=this._children[i];if(child.isCollidingWithBoundBox(checkBound))return true;}}return false;};_proto105.isCollidingWithRay=function isCollidingWithRay(ray,maxDistance){if(maxDistance===void 0){maxDistance=Number.MAX_VALUE;}var distance=CollisionUtils.intersectsRayAndBoxRD(ray,this._bounds);if(distance==-1||distance>maxDistance)return false;for(var i=0,n=this._objects.length;i<n;i++){var object=this._objects[i];distance=CollisionUtils.intersectsRayAndBoxRD(ray,object.bounds._getBoundBox());if(distance!==-1&&distance<=maxDistance)return true;}if(this._children!=null){for(i=0;i<8;i++){var child=this._children[i];if(child.isCollidingWithRay(ray,maxDistance))return true;}}return false;};_proto105.getBound=function getBound(){return this._bounds;};_proto105.drawAllBounds=function drawAllBounds(debugLine,currentDepth,maxDepth){if(this._children===null&&this._objects.length==0)return;currentDepth++;var color=BoundsOctreeNode._tempColor0;if(this._isContaion){color.r=0.0;color.g=0.0;color.b=1.0;}else {var tint=maxDepth?currentDepth/maxDepth:0;color.r=1.0-tint;color.g=tint;color.b=0.0;}color.a=0.3;Utils3D._drawBound(debugLine,this._bounds,color);if(this._children!=null){for(var i=0;i<8;i++){var child=this._children[i];child&&child.drawAllBounds(debugLine,currentDepth,maxDepth);}}};_proto105.drawAllObjects=function drawAllObjects(debugLine,currentDepth,maxDepth){currentDepth++;var color=BoundsOctreeNode._tempColor0;if(this._isContaion){color.r=0.0;color.g=0.0;color.b=1.0;}else {var tint=maxDepth?currentDepth/maxDepth:0;color.r=1.0-tint;color.g=tint;color.b=0.0;}color.a=1.0;for(var i=0,n=this._objects.length;i<n;i++){Utils3D._drawBound(debugLine,this._objects[i].bounds._getBoundBox(),color);}if(this._children!=null){for(i=0;i<8;i++){var child=this._children[i];child&&child.drawAllObjects(debugLine,currentDepth,maxDepth);}}};return BoundsOctreeNode;}();BoundsOctreeNode._tempVector3=new Vector3();BoundsOctreeNode._tempVector30=new Vector3();BoundsOctreeNode._tempVector31=new Vector3();BoundsOctreeNode._tempColor0=new Color();BoundsOctreeNode._tempBoundBox=new BoundBox(new Vector3(),new Vector3());BoundsOctreeNode._NUM_OBJECTS_ALLOWED=8;var OctreeMotionList=/*#__PURE__*/function(_SingletonList3){_inheritsLoose(OctreeMotionList,_SingletonList3);function OctreeMotionList(){return _SingletonList3.call(this)||this;}var _proto106=OctreeMotionList.prototype;_proto106.add=function add(element){var index=element._getIndexInMotionList();if(index!==-1)throw "OctreeMotionList:element has  in  PhysicsUpdateList.";this._add(element);element._setIndexInMotionList(this.length++);};_proto106.remove=function remove(element){var index=element._getIndexInMotionList();this.length--;if(index!==this.length){var end=this.elements[this.length];this.elements[index]=end;end._setIndexInMotionList(index);}element._setIndexInMotionList(-1);};return OctreeMotionList;}(SingletonList);var BoundsOctree=/*#__PURE__*/function(){function BoundsOctree(initialWorldSize,initialWorldPos,minNodeSize,looseness){this._motionObjects=new OctreeMotionList();this.count=0;if(minNodeSize>initialWorldSize){console.warn("Minimum node size must be at least as big as the initial world size. Was: "+minNodeSize+" Adjusted to: "+initialWorldSize);minNodeSize=initialWorldSize;}this._initialSize=initialWorldSize;this._minSize=minNodeSize;this._looseness=Math.min(Math.max(looseness,1.0),2.0);this._rootNode=new BoundsOctreeNode(this,null,initialWorldSize,initialWorldPos);}var _proto107=BoundsOctree.prototype;_proto107._getMaxDepth=function _getMaxDepth(node,depth){depth++;var children=node._children;if(children!=null){var curDepth=depth;for(var i=0,n=children.length;i<n;i++){var child=children[i];child&&(depth=Math.max(this._getMaxDepth(child,curDepth),depth));}}return depth;};_proto107._grow=function _grow(growObjectCenter){var xDirection=growObjectCenter.x>=0?1:-1;var yDirection=growObjectCenter.y>=0?1:-1;var zDirection=growObjectCenter.z>=0?1:-1;var oldRoot=this._rootNode;var half=this._rootNode.baseLength/2;var newLength=this._rootNode.baseLength*2;var rootCenter=this._rootNode.center;var newCenter=new Vector3(rootCenter.x+xDirection*half,rootCenter.y+yDirection*half,rootCenter.z+zDirection*half);this._rootNode=new BoundsOctreeNode(this,null,newLength,newCenter);if(oldRoot.hasAnyObjects()){var rootPos=this._rootNode._bestFitChild(oldRoot.center);var children=[];for(var i=0;i<8;i++){if(i==rootPos){oldRoot._parent=this._rootNode;children[i]=oldRoot;}}this._rootNode._children=children;}};_proto107.add=function add(object){var count=0;while(!this._rootNode.add(object)){var growCenter=BoundsOctree._tempVector30;Vector3.subtract(object.bounds.getCenter(),this._rootNode.center,growCenter);this._grow(growCenter);if(++count>20){throw "Aborted Add operation as it seemed to be going on forever ("+(count-1)+") attempts at growing the octree.";}}this.count++;};_proto107.remove=function remove(object){var removed=object._getOctreeNode().remove(object);if(removed){this.count--;}return removed;};_proto107.update=function update(object){var count=0;var octreeNode=object._getOctreeNode();if(octreeNode){while(!octreeNode._update(object)){var growCenter=BoundsOctree._tempVector30;Vector3.subtract(object.bounds.getCenter(),this._rootNode.center,growCenter);this._grow(growCenter);if(++count>20){throw "Aborted Add operation as it seemed to be going on forever ("+(count-1)+") attempts at growing the octree.";}}return true;}else {return false;}};_proto107.shrinkRootIfPossible=function shrinkRootIfPossible(){this._rootNode=this._rootNode.shrinkIfPossible(this._initialSize);};_proto107.addMotionObject=function addMotionObject(object){this._motionObjects.add(object);};_proto107.removeMotionObject=function removeMotionObject(object){this._motionObjects.remove(object);};_proto107.updateMotionObjects=function updateMotionObjects(){var elements=this._motionObjects.elements;for(var i=0,n=this._motionObjects.length;i<n;i++){var object=elements[i];this.update(object);object._setIndexInMotionList(-1);}this._motionObjects.length=0;};_proto107.isCollidingWithBoundBox=function isCollidingWithBoundBox(checkBounds){return this._rootNode.isCollidingWithBoundBox(checkBounds);};_proto107.isCollidingWithRay=function isCollidingWithRay(ray,maxDistance){if(maxDistance===void 0){maxDistance=Number.MAX_VALUE;}return this._rootNode.isCollidingWithRay(ray,maxDistance);};_proto107.getCollidingWithBoundBox=function getCollidingWithBoundBox(checkBound,result){this._rootNode.getCollidingWithBoundBox(checkBound,result);};_proto107.getCollidingWithRay=function getCollidingWithRay(ray,result,maxDistance){if(maxDistance===void 0){maxDistance=Number.MAX_VALUE;}this._rootNode.getCollidingWithRay(ray,result,maxDistance);};_proto107.getCollidingWithFrustum=function getCollidingWithFrustum(cameraCullInfo,context,shader,replacementTag,isShadowCasterCull){this._rootNode.getCollidingWithFrustum(cameraCullInfo,context,shader,replacementTag,isShadowCasterCull);};_proto107.getMaxBounds=function getMaxBounds(){return this._rootNode.getBound();};_proto107.drawAllBounds=function drawAllBounds(pixelLine){var maxDepth=this._getMaxDepth(this._rootNode,-1);this._rootNode.drawAllBounds(pixelLine,-1,maxDepth);};_proto107.drawAllObjects=function drawAllObjects(pixelLine){var maxDepth=this._getMaxDepth(this._rootNode,-1);this._rootNode.drawAllObjects(pixelLine,-1,maxDepth);};return BoundsOctree;}();BoundsOctree._tempVector30=new Vector3();var Lightmap=function Lightmap(){};var BoundSphere=/*#__PURE__*/function(){function BoundSphere(center,radius){this.center=center;this.radius=radius;}var _proto108=BoundSphere.prototype;_proto108.toDefault=function toDefault(){this.center.toDefault();this.radius=0;};BoundSphere.createFromSubPoints=function createFromSubPoints(points,start,count,out){if(points==null){throw new Error("points");}if(start<0||start>=points.length){throw new Error("start"+start+"Must be in the range [0, "+(points.length-1)+"]");}if(count<0||start+count>points.length){throw new Error("count"+count+"Must be in the range <= "+points.length+"}");}var upperEnd=start+count;var center=BoundSphere._tempVector3;center.x=0;center.y=0;center.z=0;for(var i=start;i<upperEnd;++i){Vector3.add(points[i],center,center);}var outCenter=out.center;Vector3.scale(center,1/count,outCenter);var radius=0.0;for(i=start;i<upperEnd;++i){var distance=Vector3.distanceSquared(outCenter,points[i]);if(distance>radius)radius=distance;}out.radius=Math.sqrt(radius);};BoundSphere.createfromPoints=function createfromPoints(points,out){if(points==null){throw new Error("points");}BoundSphere.createFromSubPoints(points,0,points.length,out);};_proto108.intersectsRayDistance=function intersectsRayDistance(ray){return CollisionUtils.intersectsRayAndSphereRD(ray,this);};_proto108.intersectsRayPoint=function intersectsRayPoint(ray,outPoint){return CollisionUtils.intersectsRayAndSphereRP(ray,this,outPoint);};_proto108.cloneTo=function cloneTo(destObject){var dest=destObject;this.center.cloneTo(dest.center);dest.radius=this.radius;};_proto108.clone=function clone(){var dest=new BoundSphere(new Vector3(),0);this.cloneTo(dest);return dest;};return BoundSphere;}();BoundSphere._tempVector3=new Vector3();var ShadowSliceData=function ShadowSliceData(){this.cameraShaderValue=new ShaderData();this.position=new Vector3();this.viewMatrix=new Matrix4x4();this.projectionMatrix=new Matrix4x4();this.viewProjectMatrix=new Matrix4x4();this.cullPlanes=[new Plane(new Vector3()),new Plane(new Vector3()),new Plane(new Vector3()),new Plane(new Vector3()),new Plane(new Vector3()),new Plane(new Vector3()),new Plane(new Vector3()),new Plane(new Vector3()),new Plane(new Vector3()),new Plane(new Vector3())];this.splitBoundSphere=new BoundSphere(new Vector3(),0.0);};var ShadowSpotData=function ShadowSpotData(){this.cameraShaderValue=new ShaderData();this.position=new Vector3();this.viewMatrix=new Matrix4x4();this.projectionMatrix=new Matrix4x4();this.viewProjectMatrix=new Matrix4x4();this.cameraCullInfo=new CameraCullInfo();};(function(ShadowLightType){ShadowLightType[ShadowLightType["DirectionLight"]=0]="DirectionLight";ShadowLightType[ShadowLightType["SpotLight"]=1]="SpotLight";ShadowLightType[ShadowLightType["PointLight"]=2]="PointLight";})(exports.ShadowLightType||(exports.ShadowLightType={}));var ShadowCasterPass=/*#__PURE__*/function(){function ShadowCasterPass(){this._shadowBias=new Vector4();this._shadowParams=new Vector4();this._shadowMapSize=new Vector4();this._shadowMatrices=new Float32Array(16*ShadowCasterPass._maxCascades);this._shadowSpotMatrices=new Matrix4x4();this._splitBoundSpheres=new Float32Array(ShadowCasterPass._maxCascades*4);this._cascadeCount=0;this._shadowMapWidth=0;this._shadowMapHeight=0;this._shadowSliceDatas=[new ShadowSliceData(),new ShadowSliceData(),new ShadowSliceData(),new ShadowSliceData()];this._shadowSpotData=new ShadowSpotData();this._lightUp=new Vector3();this._lightSide=new Vector3();this._lightForward=new Vector3();this._shadowSpotData.cameraCullInfo.boundFrustum=new BoundFrustum(new Matrix4x4());}var _proto109=ShadowCasterPass.prototype;_proto109._setupShadowCasterShaderValues=function _setupShadowCasterShaderValues(context,shaderValues,shadowSliceData,LightParam,shadowparams,shadowBias,lightType){shaderValues.setVector(ShadowCasterPass.SHADOW_BIAS,shadowBias);switch(lightType){case exports.LightType.Directional:shaderValues.setVector3(ShadowCasterPass.SHADOW_LIGHT_DIRECTION,LightParam);break;case exports.LightType.Spot:shaderValues.setVector(ShadowCasterPass.SHADOW_PARAMS,shadowparams);break;case exports.LightType.Point:break;}var cameraSV=shadowSliceData.cameraShaderValue;cameraSV.setMatrix4x4(BaseCamera.VIEWMATRIX,shadowSliceData.viewMatrix);cameraSV.setMatrix4x4(BaseCamera.PROJECTMATRIX,shadowSliceData.projectionMatrix);cameraSV.setMatrix4x4(BaseCamera.VIEWPROJECTMATRIX,shadowSliceData.viewProjectMatrix);context.viewMatrix=shadowSliceData.viewMatrix;context.projectionMatrix=shadowSliceData.projectionMatrix;context.projectionViewMatrix=shadowSliceData.viewProjectMatrix;};_proto109._setupShadowReceiverShaderValues=function _setupShadowReceiverShaderValues(shaderValues){var light=this._light;if(light.shadowCascadesMode!==exports.ShadowCascadesMode.NoCascades)shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_CASCADE);else shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_CASCADE);switch(light.shadowMode){case exports.ShadowMode.Hard:shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SOFT_SHADOW_LOW);shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SOFT_SHADOW_HIGH);break;case exports.ShadowMode.SoftLow:shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SOFT_SHADOW_LOW);shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SOFT_SHADOW_HIGH);break;case exports.ShadowMode.SoftHigh:shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SOFT_SHADOW_HIGH);shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SOFT_SHADOW_LOW);break;}shaderValues.setTexture(ShadowCasterPass.SHADOW_MAP,this._shadowDirectLightMap);shaderValues.setBuffer(ShadowCasterPass.SHADOW_MATRICES,this._shadowMatrices);shaderValues.setVector(ShadowCasterPass.SHADOW_MAP_SIZE,this._shadowMapSize);shaderValues.setVector(ShadowCasterPass.SHADOW_PARAMS,this._shadowParams);shaderValues.setBuffer(ShadowCasterPass.SHADOW_SPLIT_SPHERES,this._splitBoundSpheres);};_proto109._setupSpotShadowReceiverShaderValues=function _setupSpotShadowReceiverShaderValues(shaderValues){var spotLight=this._light;switch(spotLight.shadowMode){case exports.ShadowMode.Hard:shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SPOT_SOFT_SHADOW_HIGH);shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SPOT_SOFT_SHADOW_LOW);break;case exports.ShadowMode.SoftLow:shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SPOT_SOFT_SHADOW_LOW);shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SPOT_SOFT_SHADOW_HIGH);break;case exports.ShadowMode.SoftHigh:shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SPOT_SOFT_SHADOW_HIGH);shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SPOT_SOFT_SHADOW_LOW);break;}shaderValues.setTexture(ShadowCasterPass.SHADOW_SPOTMAP,this._shadowSpotLightMap);shaderValues.setMatrix4x4(ShadowCasterPass.SHADOW_SPOTMATRICES,this._shadowSpotMatrices);shaderValues.setVector(ShadowCasterPass.SHADOW_MAP_SIZE,this._shadowMapSize);shaderValues.setVector(ShadowCasterPass.SHADOW_PARAMS,this._shadowParams);};_proto109.update=function update(camera,light,lightType){switch(lightType){case exports.ShadowLightType.DirectionLight:this._light=light;var lightWorld=ShadowCasterPass._tempMatrix0;var lightWorldE=lightWorld.elements;var lightUp=this._lightUp;var lightSide=this._lightSide;var lightForward=this._lightForward;Matrix4x4.createFromQuaternion(light._transform.rotation,lightWorld);lightSide.setValue(lightWorldE[0],lightWorldE[1],lightWorldE[2]);lightUp.setValue(lightWorldE[4],lightWorldE[5],lightWorldE[6]);lightForward.setValue(-lightWorldE[8],-lightWorldE[9],-lightWorldE[10]);var atlasResolution=light._shadowResolution;var cascadesMode=light._shadowCascadesMode;var cascadesCount;var shadowTileResolution;var shadowMapWidth,shadowMapHeight;if(cascadesMode==exports.ShadowCascadesMode.NoCascades){cascadesCount=1;shadowTileResolution=atlasResolution;shadowMapWidth=atlasResolution;shadowMapHeight=atlasResolution;}else {cascadesCount=cascadesMode==exports.ShadowCascadesMode.TwoCascades?2:4;shadowTileResolution=ShadowUtils.getMaxTileResolutionInAtlas(atlasResolution,atlasResolution,cascadesCount);shadowMapWidth=shadowTileResolution*2;shadowMapHeight=cascadesMode==exports.ShadowCascadesMode.TwoCascades?shadowTileResolution:shadowTileResolution*2;}this._cascadeCount=cascadesCount;this._shadowMapWidth=shadowMapWidth;this._shadowMapHeight=shadowMapHeight;var splitDistance=ShadowCasterPass._cascadesSplitDistance;var frustumPlanes=ShadowCasterPass._frustumPlanes;var cameraNear=camera.nearPlane;var shadowFar=Math.min(camera.farPlane,light._shadowDistance);var shadowMatrices=this._shadowMatrices;var boundSpheres=this._splitBoundSpheres;ShadowUtils.getCascadesSplitDistance(light._shadowTwoCascadeSplits,light._shadowFourCascadeSplits,cameraNear,shadowFar,camera.fieldOfView*MathUtils3D.Deg2Rad,camera.aspectRatio,cascadesMode,splitDistance);ShadowUtils.getCameraFrustumPlanes(camera.projectionViewMatrix,frustumPlanes);var forward=ShadowCasterPass._tempVector30;camera._transform.getForward(forward);Vector3.normalize(forward,forward);for(var i=0;i<cascadesCount;i++){var sliceData=this._shadowSliceDatas[i];sliceData.sphereCenterZ=ShadowUtils.getBoundSphereByFrustum(splitDistance[i],splitDistance[i+1],camera.fieldOfView*MathUtils3D.Deg2Rad,camera.aspectRatio,camera._transform.position,forward,sliceData.splitBoundSphere);ShadowUtils.getDirectionLightShadowCullPlanes(frustumPlanes,i,splitDistance,cameraNear,lightForward,sliceData);ShadowUtils.getDirectionalLightMatrices(lightUp,lightSide,lightForward,i,light._shadowNearPlane,shadowTileResolution,sliceData,shadowMatrices);if(cascadesCount>1)ShadowUtils.applySliceTransform(sliceData,shadowMapWidth,shadowMapHeight,i,shadowMatrices);}ShadowUtils.prepareShadowReceiverShaderValues(light,shadowMapWidth,shadowMapHeight,this._shadowSliceDatas,cascadesCount,this._shadowMapSize,this._shadowParams,shadowMatrices,boundSpheres);break;case exports.ShadowLightType.SpotLight:this._light=light;var lightWorld=ShadowCasterPass._tempMatrix0;var lightForward=this._lightForward;var shadowResolution=this._light._shadowResolution;this._shadowMapWidth=shadowResolution;this._shadowMapHeight=shadowResolution;var shadowSpotData=this._shadowSpotData;ShadowUtils.getSpotLightShadowData(shadowSpotData,this._light,shadowResolution,this._shadowParams,this._shadowSpotMatrices,this._shadowMapSize);break;case exports.ShadowLightType.PointLight:break;default:throw "There is no shadow of this type";}};_proto109.render=function render(context,scene,lightType){switch(lightType){case exports.ShadowLightType.DirectionLight:var shaderValues=scene._shaderValues;context.pipelineMode="ShadowCaster";ShaderData.setRuntimeValueMode(false);var shadowMap=this._shadowDirectLightMap=ShadowUtils.getTemporaryShadowTexture(this._shadowMapWidth,this._shadowMapHeight,Laya.RenderTextureDepthFormat.DEPTH_16);shadowMap._start();var light=this._light;for(var i=0,n=this._cascadeCount;i<n;i++){var sliceData=this._shadowSliceDatas[i];ShadowUtils.getShadowBias(light,sliceData.projectionMatrix,sliceData.resolution,this._shadowBias);this._setupShadowCasterShaderValues(context,shaderValues,sliceData,this._lightForward,this._shadowParams,this._shadowBias,exports.LightType.Directional);var shadowCullInfo=FrustumCulling._shadowCullInfo;shadowCullInfo.position=sliceData.position;shadowCullInfo.cullPlanes=sliceData.cullPlanes;shadowCullInfo.cullPlaneCount=sliceData.cullPlaneCount;shadowCullInfo.cullSphere=sliceData.splitBoundSphere;shadowCullInfo.direction=this._lightForward;var needRender=FrustumCulling.cullingShadow(shadowCullInfo,scene,context);context.cameraShaderValue=sliceData.cameraShaderValue;Camera._updateMark++;var gl=Laya.LayaGL.instance;var resolution=sliceData.resolution;var offsetX=sliceData.offsetX;var offsetY=sliceData.offsetY;gl.enable(gl.SCISSOR_TEST);gl.viewport(offsetX,offsetY,resolution,resolution);gl.scissor(offsetX,offsetY,resolution,resolution);gl.clear(gl.DEPTH_BUFFER_BIT);if(needRender){gl.scissor(offsetX+1,offsetY+1,resolution-2,resolution-2);scene._opaqueQueue._render(context);}}shadowMap._end();this._setupShadowReceiverShaderValues(shaderValues);ShaderData.setRuntimeValueMode(true);context.pipelineMode="Forward";break;case exports.ShadowLightType.SpotLight:var shaderValues=scene._shaderValues;context.pipelineMode="ShadowCaster";ShaderData.setRuntimeValueMode(false);var spotlight=this._light;var shadowMap=this._shadowSpotLightMap=ShadowUtils.getTemporaryShadowTexture(this._shadowMapWidth,this._shadowMapHeight,Laya.RenderTextureDepthFormat.DEPTH_16);shadowMap._start();var shadowSpotData=this._shadowSpotData;ShadowUtils.getShadowBias(spotlight,shadowSpotData.projectionMatrix,shadowSpotData.resolution,this._shadowBias);this._setupShadowCasterShaderValues(context,shaderValues,shadowSpotData,this._light.transform.position,this._shadowParams,this._shadowBias,exports.LightType.Spot);var needRender=FrustumCulling.cullingSpotShadow(shadowSpotData.cameraCullInfo,scene,context);context.cameraShaderValue=shadowSpotData.cameraShaderValue;Camera._updateMark++;var gl=Laya.LayaGL.instance;gl.enable(gl.SCISSOR_TEST);gl.viewport(shadowSpotData.offsetX,shadowSpotData.offsetY,shadowSpotData.resolution,shadowSpotData.resolution);gl.scissor(shadowSpotData.offsetX,shadowSpotData.offsetY,shadowSpotData.resolution,shadowSpotData.resolution);gl.clear(gl.DEPTH_BUFFER_BIT);if(needRender){gl.scissor(shadowSpotData.offsetX,shadowSpotData.offsetY,shadowSpotData.resolution,shadowSpotData.resolution);scene._opaqueQueue._render(context);}shadowMap._end();this._setupSpotShadowReceiverShaderValues(shaderValues);ShaderData.setRuntimeValueMode(true);context.pipelineMode="Forward";break;case exports.ShadowLightType.PointLight:break;default:throw "There is no shadow of this type";}};_proto109.cleanUp=function cleanUp(){this._shadowDirectLightMap&&RenderTexture.recoverToPool(this._shadowDirectLightMap);this._shadowSpotLightMap&&RenderTexture.recoverToPool(this._shadowSpotLightMap);this._shadowDirectLightMap=null;this._shadowSpotLightMap=null;this._light=null;};return ShadowCasterPass;}();ShadowCasterPass._tempVector30=new Vector3();ShadowCasterPass._tempMatrix0=new Matrix4x4();ShadowCasterPass.SHADOW_BIAS=Shader3D.propertyNameToID("u_ShadowBias");ShadowCasterPass.SHADOW_LIGHT_DIRECTION=Shader3D.propertyNameToID("u_ShadowLightDirection");ShadowCasterPass.SHADOW_SPLIT_SPHERES=Shader3D.propertyNameToID("u_ShadowSplitSpheres");ShadowCasterPass.SHADOW_MATRICES=Shader3D.propertyNameToID("u_ShadowMatrices");ShadowCasterPass.SHADOW_MAP_SIZE=Shader3D.propertyNameToID("u_ShadowMapSize");ShadowCasterPass.SHADOW_MAP=Shader3D.propertyNameToID("u_ShadowMap");ShadowCasterPass.SHADOW_PARAMS=Shader3D.propertyNameToID("u_ShadowParams");ShadowCasterPass.SHADOW_SPOTMAP=Shader3D.propertyNameToID("u_SpotShadowMap");ShadowCasterPass.SHADOW_SPOTMATRICES=Shader3D.propertyNameToID("u_SpotViewProjectMatrix");ShadowCasterPass._maxCascades=4;ShadowCasterPass._cascadesSplitDistance=new Array(ShadowCasterPass._maxCascades+1);ShadowCasterPass._frustumPlanes=new Array(new Plane(new Vector3()),new Plane(new Vector3()),new Plane(new Vector3()),new Plane(new Vector3()),new Plane(new Vector3()),new Plane(new Vector3()));var DynamicBatchManager=/*#__PURE__*/function(){function DynamicBatchManager(){this._batchRenderElementPool=[];}DynamicBatchManager._registerManager=function _registerManager(manager){DynamicBatchManager._managers.push(manager);};var _proto110=DynamicBatchManager.prototype;_proto110._clear=function _clear(){this._batchRenderElementPoolIndex=0;};_proto110._getBatchRenderElementFromPool=function _getBatchRenderElementFromPool(){throw "StaticBatch:must override this function.";};_proto110.dispose=function dispose(){};return DynamicBatchManager;}();DynamicBatchManager._managers=[];(function(AmbientMode){AmbientMode[AmbientMode["SolidColor"]=0]="SolidColor";AmbientMode[AmbientMode["SphericalHarmonics"]=1]="SphericalHarmonics";})(exports.AmbientMode||(exports.AmbientMode={}));var Scene3D=/*#__PURE__*/function(_Laya$Sprite){_inheritsLoose(Scene3D,_Laya$Sprite);function Scene3D(){var _this51;_this51=_Laya$Sprite.call(this)||this;_this51._lightCount=0;_this51._pointLights=new LightQueue();_this51._spotLights=new LightQueue();_this51._directionLights=new LightQueue();_this51._alternateLights=new AlternateLightQueue();_this51._lightmaps=[];_this51._skyRenderer=new SkyRenderer();_this51._input=new Input3D();_this51._timer=Laya.ILaya.timer;_this51._time=0;_this51._shCoefficients=new Array(7);_this51._ambientMode=exports.AmbientMode.SolidColor;_this51._ambientSphericalHarmonics=new SphericalHarmonicsL2();_this51._ambientSphericalHarmonicsIntensity=1.0;_this51._reflectionDecodeFormat=Laya.TextureDecodeFormat.Normal;_this51._reflectionIntensity=1.0;_this51._collsionTestList=[];_this51._renders=new SimpleSingletonList();_this51._opaqueQueue=new RenderQueue(false);_this51._transparentQueue=new RenderQueue(true);_this51._cameraPool=[];_this51._animatorPool=new SimpleSingletonList();_this51._scriptPool=new Array();_this51._tempScriptPool=new Array();_this51._needClearScriptPool=false;_this51._reflectionCubeHDRParams=new Vector4();_this51.currentCreationLayer=Math.pow(2,0);_this51.enableLight=true;_this51._key=new Laya.SubmitKey();_this51._pickIdToSprite=new Object();_this51._reflectionMode=0;if(!Config3D._config.isUseCannonPhysicsEngine&&Physics3D._bullet)_this51._physicsSimulation=new PhysicsSimulation(Scene3D.physicsSettings);else if(Physics3D._cannon){_this51._cannonPhysicsSimulation=new Laya.CannonPhysicsSimulation(Scene3D.cannonPhysicsSettings);}_this51._shaderValues=new ShaderData(null);_this51.enableFog=false;_this51.fogStart=300;_this51.fogRange=1000;_this51.fogColor=new Vector3(0.7,0.7,0.7);_this51.ambientColor=new Vector3(0.212,0.227,0.259);_this51.reflectionIntensity=1.0;_this51.reflection=TextureCube.blackTexture;for(var i=0;i<7;i++){_this51._shCoefficients[i]=new Vector4();}_this51._shaderValues.setVector(Scene3D.REFLECTIONCUBE_HDR_PARAMS,_this51._reflectionCubeHDRParams);if(Laya.Render.supportWebGLPlusCulling){_this51._cullingBufferIndices=new Int32Array(1024);_this51._cullingBufferResult=new Int32Array(1024);}_this51._scene=_assertThisInitialized(_this51);_this51._input.__init__(Laya.Render.canvas,_assertThisInitialized(_this51));if(Scene3D.octreeCulling)_this51._octree=new BoundsOctree(Scene3D.octreeInitialSize,Scene3D.octreeInitialCenter,Scene3D.octreeMinNodeSize,Scene3D.octreeLooseness);if(FrustumCulling.debugFrustumCulling){_this51._debugTool=new PixelLineSprite3D();var lineMaterial=new PixelLineMaterial();lineMaterial.renderQueue=Material.RENDERQUEUE_TRANSPARENT;lineMaterial.alphaTest=false;lineMaterial.depthWrite=false;lineMaterial.cull=RenderState.CULL_BACK;lineMaterial.blend=RenderState.BLEND_ENABLE_ALL;lineMaterial.blendSrc=RenderState.BLENDPARAM_SRC_ALPHA;lineMaterial.blendDst=RenderState.BLENDPARAM_ONE_MINUS_SRC_ALPHA;lineMaterial.depthTest=RenderState.DEPTHTEST_LESS;_this51._debugTool.pixelLineRenderer.sharedMaterial=lineMaterial;}return _this51;}Scene3D.__init__=function __init__(){var con=Config3D._config;var multiLighting=con._multiLighting;if(multiLighting){var width=4;var maxLightCount=con.maxLightCount;var clusterSlices=con.lightClusterCount;Cluster.instance=new Cluster(clusterSlices.x,clusterSlices.y,clusterSlices.z,Math.min(con.maxLightCount,con._maxAreaLightCountPerClusterAverage));Scene3D._lightTexture=Utils3D._createFloatTextureBuffer(width,maxLightCount);Scene3D._lightTexture.lock=true;Scene3D._lightPixles=new Float32Array(maxLightCount*width*4);}Scene3DShaderDeclaration.SHADERDEFINE_FOG=Shader3D.getDefineByName("FOG");Scene3DShaderDeclaration.SHADERDEFINE_DIRECTIONLIGHT=Shader3D.getDefineByName("DIRECTIONLIGHT");Scene3DShaderDeclaration.SHADERDEFINE_POINTLIGHT=Shader3D.getDefineByName("POINTLIGHT");Scene3DShaderDeclaration.SHADERDEFINE_SPOTLIGHT=Shader3D.getDefineByName("SPOTLIGHT");Scene3DShaderDeclaration.SHADERDEFINE_SHADOW=Shader3D.getDefineByName("SHADOW");Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_CASCADE=Shader3D.getDefineByName("SHADOW_CASCADE");Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SOFT_SHADOW_LOW=Shader3D.getDefineByName("SHADOW_SOFT_SHADOW_LOW");Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SOFT_SHADOW_HIGH=Shader3D.getDefineByName("SHADOW_SOFT_SHADOW_HIGH");Scene3DShaderDeclaration.SHADERDEFINE_GI_AMBIENT_SH=Shader3D.getDefineByName("GI_AMBIENT_SH");Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SPOT=Shader3D.getDefineByName("SHADOW_SPOT");Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SPOT_SOFT_SHADOW_LOW=Shader3D.getDefineByName("SHADOW_SPOT_SOFT_SHADOW_LOW");Scene3DShaderDeclaration.SHADERDEFINE_SHADOW_SPOT_SOFT_SHADOW_HIGH=Shader3D.getDefineByName("SHADOW_SPOT_SOFT_SHADOW_HIGH");var config=Config3D._config;var configShaderValue=Scene3D._configDefineValues;config._multiLighting||configShaderValue.add(Shader3D.SHADERDEFINE_LEGACYSINGALLIGHTING);if(Laya.LayaGL.layaGPUInstance._isWebGL2)configShaderValue.add(Shader3D.SHADERDEFINE_GRAPHICS_API_GLES3);else configShaderValue.add(Shader3D.SHADERDEFINE_GRAPHICS_API_GLES2);switch(config.pbrRenderQuality){case exports.PBRRenderQuality.High:configShaderValue.add(PBRMaterial.SHADERDEFINE_LAYA_PBR_BRDF_HIGH);break;case exports.PBRRenderQuality.Low:configShaderValue.add(PBRMaterial.SHADERDEFINE_LAYA_PBR_BRDF_LOW);break;default:throw "Scene3D:unknown shader quality.";}if(config.isUseCannonPhysicsEngine){Scene3D.cannonPhysicsSettings=new Laya.CannonPhysicsSettings();}else {Scene3D.physicsSettings=new PhysicsSettings();}};Scene3D.load=function load(url,complete){Laya.ILaya.loader.create(url,complete,null,Scene3D.HIERARCHY);};var _proto111=Scene3D.prototype;_proto111._applySHCoefficients=function _applySHCoefficients(originalSH,intensity){var optSH=this._shCoefficients;for(var i=0;i<3;i++){var shaderSHA=optSH[i];var shaderSHB=optSH[i+3];shaderSHA.setValue(originalSH.getCoefficient(i,3)*intensity,originalSH.getCoefficient(i,1)*intensity,originalSH.getCoefficient(i,2)*intensity,(originalSH.getCoefficient(i,0)-originalSH.getCoefficient(i,6))*intensity);shaderSHB.setValue(originalSH.getCoefficient(i,4)*intensity,originalSH.getCoefficient(i,5)*intensity,originalSH.getCoefficient(i,6)*3*intensity,originalSH.getCoefficient(i,7)*intensity);}optSH[6].setValue(originalSH.getCoefficient(0,8)*intensity,originalSH.getCoefficient(1,8)*intensity,originalSH.getCoefficient(2,8)*intensity,1);var shaderValues=this._shaderValues;shaderValues.setVector(Scene3D.AMBIENTSHAR,optSH[0]);shaderValues.setVector(Scene3D.AMBIENTSHAG,optSH[1]);shaderValues.setVector(Scene3D.AMBIENTSHAB,optSH[2]);shaderValues.setVector(Scene3D.AMBIENTSHBR,optSH[3]);shaderValues.setVector(Scene3D.AMBIENTSHBG,optSH[4]);shaderValues.setVector(Scene3D.AMBIENTSHBB,optSH[5]);shaderValues.setVector(Scene3D.AMBIENTSHC,optSH[6]);};_proto111._update=function _update(){var delta=this.timer._delta/1000;this._time+=delta;this._shaderValues.setNumber(Scene3D.TIME,this._time);var simulation=this._physicsSimulation;if(Physics3D._enablePhysics&&!PhysicsSimulation.disableSimulation&&!Config3D._config.isUseCannonPhysicsEngine){simulation._updatePhysicsTransformFromRender();PhysicsComponent._addUpdateList=false;simulation._simulate(delta);simulation._updateCharacters();PhysicsComponent._addUpdateList=true;simulation._updateCollisions();simulation._eventScripts();}if(Physics3D._cannon&&Config3D._config.isUseCannonPhysicsEngine){var cannonSimulation=this._cannonPhysicsSimulation;cannonSimulation._updatePhysicsTransformFromRender();Laya.CannonPhysicsComponent._addUpdateList=false;cannonSimulation._simulate(delta);Laya.CannonPhysicsComponent._addUpdateList=true;cannonSimulation._updateCollisions();cannonSimulation._eventScripts();}this._input._update();this._clearScript();this._updateScript();Animator._update(this);Laya.VideoTexture._update();this._lateUpdateScript();};_proto111._binarySearchIndexInCameraPool=function _binarySearchIndexInCameraPool(camera){var start=0;var end=this._cameraPool.length-1;var mid;while(start<=end){mid=Math.floor((start+end)/2);var midValue=this._cameraPool[mid]._renderingOrder;if(midValue==camera._renderingOrder)return mid;else if(midValue>camera._renderingOrder)end=mid-1;else start=mid+1;}return start;};_proto111._allotPickColorByID=function _allotPickColorByID(id,pickColor){var pickColorR=Math.floor(id/(255*255));id-=pickColorR*255*255;var pickColorG=Math.floor(id/255);id-=pickColorG*255;var pickColorB=id;pickColor.x=pickColorR/255;pickColor.y=pickColorG/255;pickColor.z=pickColorB/255;pickColor.w=1.0;};_proto111._searchIDByPickColor=function _searchIDByPickColor(pickColor){var id=pickColor.x*255*255+pickColor.y*255+pickColor.z;return id;};_proto111.onEnable=function onEnable(){this._input._onCanvasEvent(Laya.Render.canvas);};_proto111.onDisable=function onDisable(){this._input._offCanvasEvent(Laya.Render.canvas);};_proto111._setCreateURL=function _setCreateURL(url){this._url=Laya.URL.formatURL(url);};_proto111._getGroup=function _getGroup(){return this._group;};_proto111._setGroup=function _setGroup(value){this._group=value;};_proto111._clearScript=function _clearScript(){if(this._needClearScriptPool){var scripts=this._scriptPool;for(var i=0,n=scripts.length;i<n;i++){var script=scripts[i];if(script){script._indexInPool=this._tempScriptPool.length;this._tempScriptPool.push(script);}}this._scriptPool=this._tempScriptPool;scripts.length=0;this._tempScriptPool=scripts;this._needClearScriptPool=false;}};_proto111._updateScript=function _updateScript(){var scripts=this._scriptPool;for(var i=0,n=scripts.length;i<n;i++){var script=scripts[i];script&&script.enabled&&script.onUpdate();}};_proto111._lateUpdateScript=function _lateUpdateScript(){var scripts=this._scriptPool;for(var i=0,n=scripts.length;i<n;i++){var script=scripts[i];script&&script.enabled&&script.onLateUpdate();}};_proto111._onActive=function _onActive(){_Laya$Sprite.prototype._onActive.call(this);Laya.ILaya.stage._scene3Ds.push(this);};_proto111._onInActive=function _onInActive(){_Laya$Sprite.prototype._onInActive.call(this);var scenes=Laya.ILaya.stage._scene3Ds;scenes.splice(scenes.indexOf(this),1);};_proto111._prepareSceneToRender=function _prepareSceneToRender(){var shaderValues=this._shaderValues;var multiLighting=Config3D._config._multiLighting;if(multiLighting){var ligTex=Scene3D._lightTexture;var ligPix=Scene3D._lightPixles;var pixelWidth=ligTex.width;var floatWidth=pixelWidth*4;var curCount=0;var dirCount=this._directionLights._length;var dirElements=this._directionLights._elements;if(dirCount>0){var sunLightIndex=this._directionLights.getBrightestLight();this._mainDirectionLight=dirElements[sunLightIndex];this._directionLights.normalLightOrdering(sunLightIndex);for(var i=0;i<dirCount;i++,curCount++){var dirLight=dirElements[i];var dir=dirLight._direction;var intCor=dirLight._intensityColor;var off=floatWidth*curCount;Vector3.scale(dirLight.color,dirLight._intensity,intCor);dirLight.transform.worldMatrix.getForward(dir);Vector3.normalize(dir,dir);ligPix[off]=intCor.x;ligPix[off+1]=intCor.y;ligPix[off+2]=intCor.z;ligPix[off+4]=dir.x;ligPix[off+5]=dir.y;ligPix[off+6]=dir.z;if(i==0){shaderValues.setVector3(Scene3D.SUNLIGHTDIRCOLOR,intCor);shaderValues.setVector3(Scene3D.SUNLIGHTDIRECTION,dir);}}shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_DIRECTIONLIGHT);}else {shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_DIRECTIONLIGHT);}var poiCount=this._pointLights._length;if(poiCount>0){var poiElements=this._pointLights._elements;var mainPointLightIndex=this._pointLights.getBrightestLight();this._mainPointLight=poiElements[mainPointLightIndex];this._pointLights.normalLightOrdering(mainPointLightIndex);for(var i=0;i<poiCount;i++,curCount++){var poiLight=poiElements[i];var pos=poiLight.transform.position;var intCor=poiLight._intensityColor;var off=floatWidth*curCount;Vector3.scale(poiLight.color,poiLight._intensity,intCor);ligPix[off]=intCor.x;ligPix[off+1]=intCor.y;ligPix[off+2]=intCor.z;ligPix[off+3]=poiLight.range;ligPix[off+4]=pos.x;ligPix[off+5]=pos.y;ligPix[off+6]=pos.z;}shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_POINTLIGHT);}else {shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_POINTLIGHT);}var spoCount=this._spotLights._length;if(spoCount>0){var spoElements=this._spotLights._elements;var mainSpotLightIndex=this._spotLights.getBrightestLight();this._mainSpotLight=spoElements[mainSpotLightIndex];this._spotLights.normalLightOrdering(mainSpotLightIndex);for(var i=0;i<spoCount;i++,curCount++){var spoLight=spoElements[i];var dir=spoLight._direction;var pos=spoLight.transform.position;var intCor=spoLight._intensityColor;var off=floatWidth*curCount;Vector3.scale(spoLight.color,spoLight._intensity,intCor);spoLight.transform.worldMatrix.getForward(dir);Vector3.normalize(dir,dir);ligPix[off]=intCor.x;ligPix[off+1]=intCor.y;ligPix[off+2]=intCor.z;ligPix[off+3]=spoLight.range;ligPix[off+4]=pos.x;ligPix[off+5]=pos.y;ligPix[off+6]=pos.z;ligPix[off+7]=spoLight.spotAngle*Math.PI/180;ligPix[off+8]=dir.x;ligPix[off+9]=dir.y;ligPix[off+10]=dir.z;}shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_SPOTLIGHT);}else {shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_SPOTLIGHT);}curCount>0&&ligTex.setSubPixels(0,0,pixelWidth,curCount,ligPix,0);shaderValues.setTexture(Scene3D.LIGHTBUFFER,ligTex);shaderValues.setInt(Scene3D.DIRECTIONLIGHTCOUNT,this._directionLights._length);shaderValues.setTexture(Scene3D.CLUSTERBUFFER,Cluster.instance._clusterTexture);}else {if(this._directionLights._length>0){var dirLight=this._directionLights._elements[0];this._mainDirectionLight=dirLight;Vector3.scale(dirLight.color,dirLight._intensity,dirLight._intensityColor);dirLight.transform.worldMatrix.getForward(dirLight._direction);Vector3.normalize(dirLight._direction,dirLight._direction);shaderValues.setVector3(Scene3D.LIGHTDIRCOLOR,dirLight._intensityColor);shaderValues.setVector3(Scene3D.LIGHTDIRECTION,dirLight._direction);shaderValues.setVector3(Scene3D.SUNLIGHTDIRCOLOR,dirLight._intensityColor);shaderValues.setVector3(Scene3D.SUNLIGHTDIRECTION,dirLight._direction);shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_DIRECTIONLIGHT);}else {shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_DIRECTIONLIGHT);}if(this._pointLights._length>0){var poiLight=this._pointLights._elements[0];Vector3.scale(poiLight.color,poiLight._intensity,poiLight._intensityColor);shaderValues.setVector3(Scene3D.POINTLIGHTCOLOR,poiLight._intensityColor);shaderValues.setVector3(Scene3D.POINTLIGHTPOS,poiLight.transform.position);shaderValues.setNumber(Scene3D.POINTLIGHTRANGE,poiLight.range);shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_POINTLIGHT);}else {shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_POINTLIGHT);}if(this._spotLights._length>0){var spotLight=this._spotLights._elements[0];Vector3.scale(spotLight.color,spotLight._intensity,spotLight._intensityColor);shaderValues.setVector3(Scene3D.SPOTLIGHTCOLOR,spotLight._intensityColor);shaderValues.setVector3(Scene3D.SPOTLIGHTPOS,spotLight.transform.position);spotLight.transform.worldMatrix.getForward(spotLight._direction);Vector3.normalize(spotLight._direction,spotLight._direction);shaderValues.setVector3(Scene3D.SPOTLIGHTDIRECTION,spotLight._direction);shaderValues.setNumber(Scene3D.SPOTLIGHTRANGE,spotLight.range);shaderValues.setNumber(Scene3D.SPOTLIGHTSPOTANGLE,spotLight.spotAngle*Math.PI/180);shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_SPOTLIGHT);}else {shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_SPOTLIGHT);}}};_proto111._addScript=function _addScript(script){var scripts=this._scriptPool;script._indexInPool=scripts.length;scripts.push(script);};_proto111._removeScript=function _removeScript(script){this._scriptPool[script._indexInPool]=null;script._indexInPool=-1;this._needClearScriptPool=true;};_proto111._preRenderScript=function _preRenderScript(){var scripts=this._scriptPool;for(var i=0,n=scripts.length;i<n;i++){var script=scripts[i];script&&script.enabled&&script.onPreRender();}};_proto111._postRenderScript=function _postRenderScript(){var scripts=this._scriptPool;for(var i=0,n=scripts.length;i<n;i++){var script=scripts[i];script&&script.enabled&&script.onPostRender();}};_proto111._addCamera=function _addCamera(camera){var index=this._binarySearchIndexInCameraPool(camera);var order=camera._renderingOrder;var count=this._cameraPool.length;while(index<count&&this._cameraPool[index]._renderingOrder<=order){index++;}this._cameraPool.splice(index,0,camera);};_proto111._removeCamera=function _removeCamera(camera){this._cameraPool.splice(this._cameraPool.indexOf(camera),1);};_proto111._preCulling=function _preCulling(context,camera,shader,replacementTag){var cameraCullInfo=FrustumCulling._cameraCullInfo;cameraCullInfo.position=camera._transform.position;cameraCullInfo.cullingMask=camera.cullingMask;cameraCullInfo.boundFrustum=camera.boundFrustum;cameraCullInfo.useOcclusionCulling=camera.useOcclusionCulling;FrustumCulling.renderObjectCulling(cameraCullInfo,this,context,shader,replacementTag,false);};_proto111._clear=function _clear(gl,state){var viewport=state.viewport;var camera=state.camera;var renderTex=camera._getRenderTexture();var vpX,vpY;var vpW=viewport.width;var vpH=viewport.height;if(camera._needInternalRenderTexture()){vpX=0;vpY=0;}else {vpX=viewport.x;vpY=camera._getCanvasHeight()-viewport.y-vpH;}gl.viewport(vpX,vpY,vpW,vpH);var flag;var clearFlag=camera.clearFlag;if(clearFlag===exports.CameraClearFlags.Sky&&!(camera.skyRenderer._isAvailable()||this._skyRenderer._isAvailable()))clearFlag=exports.CameraClearFlags.SolidColor;switch(clearFlag){case exports.CameraClearFlags.SolidColor:var clearColor=camera.clearColor;gl.enable(gl.SCISSOR_TEST);gl.scissor(vpX,vpY,vpW,vpH);if(clearColor)gl.clearColor(clearColor.x,clearColor.y,clearColor.z,clearColor.w);else gl.clearColor(0,0,0,0);if(renderTex){flag=gl.COLOR_BUFFER_BIT;switch(renderTex.depthStencilFormat){case Laya.RenderTextureDepthFormat.DEPTH_16:flag|=gl.DEPTH_BUFFER_BIT;break;case Laya.RenderTextureDepthFormat.STENCIL_8:flag|=gl.STENCIL_BUFFER_BIT;break;case Laya.RenderTextureDepthFormat.DEPTHSTENCIL_24_8:flag|=gl.DEPTH_BUFFER_BIT;flag|=gl.STENCIL_BUFFER_BIT;break;}}else {flag=gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT;}Laya.WebGLContext.setDepthMask(gl,true);gl.clear(flag);gl.disable(gl.SCISSOR_TEST);break;case exports.CameraClearFlags.Sky:case exports.CameraClearFlags.DepthOnly:gl.enable(gl.SCISSOR_TEST);gl.scissor(vpX,vpY,vpW,vpH);if(renderTex){switch(renderTex.depthStencilFormat){case Laya.RenderTextureDepthFormat.DEPTH_16:flag=gl.DEPTH_BUFFER_BIT;break;case Laya.RenderTextureDepthFormat.STENCIL_8:flag=gl.STENCIL_BUFFER_BIT;break;case Laya.RenderTextureDepthFormat.DEPTHSTENCIL_24_8:flag=gl.DEPTH_BUFFER_BIT|gl.STENCIL_BUFFER_BIT;break;}}else {flag=gl.DEPTH_BUFFER_BIT;}Laya.WebGLContext.setDepthMask(gl,true);gl.clear(flag);gl.disable(gl.SCISSOR_TEST);break;case exports.CameraClearFlags.Nothing:break;default:throw new Error("Scene3D:camera clearFlag invalid.");}};_proto111._renderScene=function _renderScene(context){var camera=context.camera;this._opaqueQueue._render(context);if(camera.clearFlag===exports.CameraClearFlags.Sky){if(camera.skyRenderer._isAvailable())camera.skyRenderer._render(context);else if(this._skyRenderer._isAvailable())this._skyRenderer._render(context);}this._transparentQueue._render(context);if(FrustumCulling.debugFrustumCulling){var renderElements=this._debugTool._render._renderElements;for(var i=0,n=renderElements.length;i<n;i++){renderElements[i]._update(this,context,null,null);renderElements[i]._render(context);}}};_proto111._parse=function _parse(data,spriteMap){var lightMapsData=data.lightmaps;if(lightMapsData){var lightMapCount=lightMapsData.length;var lightmaps=new Array(lightMapCount);for(var i=0;i<lightMapCount;i++){var lightMap=new Lightmap();var lightMapData=lightMapsData[i];if(lightMapData.path){lightMap.lightmapColor=Laya.Loader.getRes(lightMapData.path);}else {lightMap.lightmapColor=Laya.Loader.getRes(lightMapData.color.path);if(lightMapData.direction)lightMap.lightmapDirection=Laya.Loader.getRes(lightMapData.direction.path);}lightmaps[i]=lightMap;}this.lightmaps=lightmaps;}var ambientColorData=data.ambientColor;if(ambientColorData){var ambCol=this.ambientColor;ambCol.fromArray(ambientColorData);this.ambientColor=ambCol;}var skyData=data.sky;if(skyData){this._skyRenderer.material=Laya.Loader.getRes(skyData.material.path);switch(skyData.mesh){case"SkyBox":this._skyRenderer.mesh=SkyBox.instance;break;case"SkyDome":this._skyRenderer.mesh=SkyDome.instance;break;default:this.skyRenderer.mesh=SkyBox.instance;}}this.enableFog=data.enableFog;this.fogStart=data.fogStart;this.fogRange=data.fogRange;var fogColorData=data.fogColor;if(fogColorData){var fogCol=this.fogColor;fogCol.fromArray(fogColorData);this.fogColor=fogCol;}var ambientSphericalHarmonicsData=data.ambientSphericalHarmonics;if(ambientSphericalHarmonicsData){var ambientSH=this.ambientSphericalHarmonics;for(var i=0;i<3;i++){var off=i*9;ambientSH.setCoefficients(i,ambientSphericalHarmonicsData[off],ambientSphericalHarmonicsData[off+1],ambientSphericalHarmonicsData[off+2],ambientSphericalHarmonicsData[off+3],ambientSphericalHarmonicsData[off+4],ambientSphericalHarmonicsData[off+5],ambientSphericalHarmonicsData[off+6],ambientSphericalHarmonicsData[off+7],ambientSphericalHarmonicsData[off+8]);}this.ambientSphericalHarmonics=ambientSH;}var reflectionData=data.reflection;reflectionData!=undefined&&(this.reflection=Laya.Loader.getRes(reflectionData));var reflectionDecodingFormatData=data.reflectionDecodingFormat;reflectionDecodingFormatData!=undefined&&(this.reflectionDecodingFormat=reflectionDecodingFormatData);var ambientModeData=data.ambientMode;ambientModeData!=undefined&&(this.ambientMode=ambientModeData);var ambientSphericalHarmonicsIntensityData=data.ambientSphericalHarmonicsIntensity;ambientSphericalHarmonicsIntensityData!=undefined&&(this.ambientSphericalHarmonicsIntensity=ambientSphericalHarmonicsIntensityData);var reflectionIntensityData=data.reflectionIntensity;reflectionIntensityData!=undefined&&(this.reflectionIntensity=reflectionIntensityData);};_proto111._addRenderObject=function _addRenderObject(render){if(this._octree&&render._supportOctree){this._octree.add(render);}else {this._renders.add(render);if(Laya.Render.supportWebGLPlusCulling){var indexInList=render._getIndexInList();var length=this._cullingBufferIndices.length;if(indexInList>=length){var tempIndices=this._cullingBufferIndices;var tempResult=this._cullingBufferResult;this._cullingBufferIndices=new Int32Array(length+1024);this._cullingBufferResult=new Int32Array(length+1024);this._cullingBufferIndices.set(tempIndices,0);this._cullingBufferResult.set(tempResult,0);}this._cullingBufferIndices[indexInList]=render._cullingBufferIndex;}}};_proto111._removeRenderObject=function _removeRenderObject(render){if(this._octree&&render._supportOctree){this._octree.remove(render);}else {var endRender;if(Laya.Render.supportWebGLPlusCulling){endRender=this._renders.elements[this._renders.length-1];}this._renders.remove(render);if(Laya.Render.supportWebGLPlusCulling){this._cullingBufferIndices[endRender._getIndexInList()]=endRender._cullingBufferIndex;}}};_proto111._getRenderQueue=function _getRenderQueue(index){if(index<=2500)return this._opaqueQueue;else return this._transparentQueue;};_proto111._clearRenderQueue=function _clearRenderQueue(){this._opaqueQueue.clear();this._transparentQueue.clear();var staticBatchManagers=StaticBatchManager._managers;for(var i=0,n=staticBatchManagers.length;i<n;i++){staticBatchManagers[i]._clear();}var dynamicBatchManagers=DynamicBatchManager._managers;for(var i=0,n=dynamicBatchManagers.length;i<n;i++){dynamicBatchManagers[i]._clear();}};_proto111.destroy=function destroy(destroyChild){if(destroyChild===void 0){destroyChild=true;}if(this.destroyed)return;_Laya$Sprite.prototype.destroy.call(this,destroyChild);this._skyRenderer.destroy();this._skyRenderer=null;this._directionLights=null;this._pointLights=null;this._spotLights=null;this._alternateLights=null;this._lightmaps=null;this._shaderValues=null;this._renders=null;this._cameraPool=null;this._octree=null;this._physicsSimulation&&this._physicsSimulation._destroy();this._reflection._removeReference();this._reflection=null;Laya.Loader.clearRes(this.url);};_proto111.render=function render(ctx,x,y){ctx._curSubmit=Laya.SubmitBase.RENDERBASE;this._children.length>0&&ctx.addRenderObject(this);};_proto111.renderSubmit=function renderSubmit(){var gl=Laya.LayaGL.instance;this._prepareSceneToRender();var i,n,n1;for(i=0,n=this._cameraPool.length,n1=n-1;i<n;i++){if(Laya.Render.supportWebGLPlusRendering)ShaderData.setRuntimeValueMode(i==n1?true:false);var camera=this._cameraPool[i];camera.enableRender&&camera.render();}Laya.Context.set2DRenderConfig();return 1;};_proto111.getRenderType=function getRenderType(){return 0;};_proto111.releaseRender=function releaseRender(){};_proto111.reUse=function reUse(context,pos){return 0;};_proto111.setlightmaps=function setlightmaps(value){var maps=this._lightmaps;for(var i=0,n=maps.length;i<n;i++){maps[i].lightmapColor._removeReference();}if(value){var count=value.length;maps.length=count;for(i=0;i<count;i++){var lightMap=value[i];lightMap._addReference();maps[i]||(maps[i]=new Lightmap());maps[i].lightmapColor=lightMap;}}else {throw new Error("Scene3D: value value can't be null.");}};_proto111.getlightmaps=function getlightmaps(){var lightmapColors=new Array(this._lightmaps.length);for(var i=0;i<this._lightmaps.length;i++){lightmapColors[i]=this._lightmaps[i].lightmapColor;}return lightmapColors;};_createClass(Scene3D,[{key:"url",get:function get(){return this._url;}},{key:"enableFog",get:function get(){return this._enableFog;},set:function set(value){if(this._enableFog!==value){this._enableFog=value;if(value){this._shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_FOG);}else this._shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_FOG);}}},{key:"fogColor",get:function get(){return this._shaderValues.getVector3(Scene3D.FOGCOLOR);},set:function set(value){this._shaderValues.setVector3(Scene3D.FOGCOLOR,value);}},{key:"fogStart",get:function get(){return this._shaderValues.getNumber(Scene3D.FOGSTART);},set:function set(value){this._shaderValues.setNumber(Scene3D.FOGSTART,value);}},{key:"fogRange",get:function get(){return this._shaderValues.getNumber(Scene3D.FOGRANGE);},set:function set(value){this._shaderValues.setNumber(Scene3D.FOGRANGE,value);}},{key:"ambientMode",get:function get(){return this._ambientMode;},set:function set(value){if(this._ambientMode!==value){switch(value){case exports.AmbientMode.SolidColor:this._shaderValues.removeDefine(Scene3DShaderDeclaration.SHADERDEFINE_GI_AMBIENT_SH);break;case exports.AmbientMode.SphericalHarmonics:this._shaderValues.addDefine(Scene3DShaderDeclaration.SHADERDEFINE_GI_AMBIENT_SH);break;default:throw "Scene3D: unknown ambientMode.";}this._ambientMode=value;}}},{key:"ambientColor",get:function get(){return this._shaderValues.getVector3(Scene3D.AMBIENTCOLOR);},set:function set(value){this._shaderValues.setVector3(Scene3D.AMBIENTCOLOR,value);}},{key:"ambientSphericalHarmonics",get:function get(){return this._ambientSphericalHarmonics;},set:function set(value){var originalSH=value||SphericalHarmonicsL2._default;this._applySHCoefficients(originalSH,Math.pow(this._ambientSphericalHarmonicsIntensity,2.2));if(this._ambientSphericalHarmonics!=value)value.cloneTo(this._ambientSphericalHarmonics);}},{key:"ambientSphericalHarmonicsIntensity",get:function get(){return this._ambientSphericalHarmonicsIntensity;},set:function set(value){value=Math.max(Math.min(value,8.0),0.0);if(this._ambientSphericalHarmonicsIntensity!==value){var originalSH=this._ambientSphericalHarmonics||SphericalHarmonicsL2._default;this._applySHCoefficients(originalSH,Math.pow(value,2.2));this._ambientSphericalHarmonicsIntensity=value;}}},{key:"reflection",get:function get(){return this._reflection;},set:function set(value){if(this._reflection!=value){value._addReference();this._shaderValues.setTexture(Scene3D.REFLECTIONTEXTURE,value||TextureCube.blackTexture);this._reflection=value;}}},{key:"reflectionDecodingFormat",get:function get(){return this._reflectionDecodeFormat;},set:function set(value){if(this._reflectionDecodeFormat!=value){this._reflectionCubeHDRParams.x=this._reflectionIntensity;if(this._reflectionDecodeFormat==Laya.TextureDecodeFormat.RGBM)this._reflectionCubeHDRParams.x*=5.0;this._reflectionDecodeFormat=value;}}},{key:"reflectionIntensity",get:function get(){return this._reflectionIntensity;},set:function set(value){value=Math.max(Math.min(value,1.0),0.0);this._reflectionCubeHDRParams.x=value;if(this._reflectionDecodeFormat==Laya.TextureDecodeFormat.RGBM)this._reflectionCubeHDRParams.x*=5.0;this._reflectionIntensity=value;}},{key:"skyRenderer",get:function get(){return this._skyRenderer;}},{key:"physicsSimulation",get:function get(){return this._physicsSimulation;}},{key:"cannonPhysicsSimulation",get:function get(){return this._cannonPhysicsSimulation;}},{key:"timer",get:function get(){return this._timer;},set:function set(value){this._timer=value;}},{key:"input",get:function get(){return this._input;}},{key:"lightmaps",get:function get(){return this._lightmaps.slice();},set:function set(value){var maps=this._lightmaps;if(maps){for(var i=0,n=maps.length;i<n;i++){var map=maps[i];map.lightmapColor._removeReference();map.lightmapDirection._removeReference();}}if(value){var count=value.length;maps.length=count;for(i=0;i<count;i++){var map=value[i];map.lightmapColor&&map.lightmapColor._addReference();map.lightmapDirection&&map.lightmapDirection._addReference();maps[i]=map;}}else {maps.length=0;}}},{key:"customReflection",get:function get(){return this._reflection;},set:function set(value){if(this._reflection!=value){this._shaderValues.setTexture(Scene3D.REFLECTIONTEXTURE,value||TextureCube.blackTexture);this._reflection=value;}}},{key:"reflectionMode",get:function get(){return this._reflectionMode;},set:function set(value){this._reflectionMode=value;}}]);return Scene3D;}(Laya.Sprite);Scene3D._shadowCasterPass=new ShadowCasterPass();Scene3D.HIERARCHY="HIERARCHY";Scene3D.octreeCulling=false;Scene3D.octreeInitialSize=64.0;Scene3D.octreeInitialCenter=new Vector3(0,0,0);Scene3D.octreeMinNodeSize=2.0;Scene3D.octreeLooseness=1.25;Scene3D.REFLECTIONMODE_SKYBOX=0;Scene3D.REFLECTIONMODE_CUSTOM=1;Scene3D.FOGCOLOR=Shader3D.propertyNameToID("u_FogColor");Scene3D.FOGSTART=Shader3D.propertyNameToID("u_FogStart");Scene3D.FOGRANGE=Shader3D.propertyNameToID("u_FogRange");Scene3D.DIRECTIONLIGHTCOUNT=Shader3D.propertyNameToID("u_DirationLightCount");Scene3D.LIGHTBUFFER=Shader3D.propertyNameToID("u_LightBuffer");Scene3D.CLUSTERBUFFER=Shader3D.propertyNameToID("u_LightClusterBuffer");Scene3D.SUNLIGHTDIRECTION=Shader3D.propertyNameToID("u_SunLight.direction");Scene3D.SUNLIGHTDIRCOLOR=Shader3D.propertyNameToID("u_SunLight.color");Scene3D.AMBIENTSHAR=Shader3D.propertyNameToID("u_AmbientSHAr");Scene3D.AMBIENTSHAG=Shader3D.propertyNameToID("u_AmbientSHAg");Scene3D.AMBIENTSHAB=Shader3D.propertyNameToID("u_AmbientSHAb");Scene3D.AMBIENTSHBR=Shader3D.propertyNameToID("u_AmbientSHBr");Scene3D.AMBIENTSHBG=Shader3D.propertyNameToID("u_AmbientSHBg");Scene3D.AMBIENTSHBB=Shader3D.propertyNameToID("u_AmbientSHBb");Scene3D.AMBIENTSHC=Shader3D.propertyNameToID("u_AmbientSHC");Scene3D.REFLECTIONPROBE=Shader3D.propertyNameToID("u_ReflectionProbe");Scene3D.REFLECTIONCUBE_HDR_PARAMS=Shader3D.propertyNameToID("u_ReflectCubeHDRParams");Scene3D.LIGHTDIRECTION=Shader3D.propertyNameToID("u_DirectionLight.direction");Scene3D.LIGHTDIRCOLOR=Shader3D.propertyNameToID("u_DirectionLight.color");Scene3D.POINTLIGHTPOS=Shader3D.propertyNameToID("u_PointLight.position");Scene3D.POINTLIGHTRANGE=Shader3D.propertyNameToID("u_PointLight.range");Scene3D.POINTLIGHTATTENUATION=Shader3D.propertyNameToID("u_PointLight.attenuation");Scene3D.POINTLIGHTCOLOR=Shader3D.propertyNameToID("u_PointLight.color");Scene3D.SPOTLIGHTPOS=Shader3D.propertyNameToID("u_SpotLight.position");Scene3D.SPOTLIGHTDIRECTION=Shader3D.propertyNameToID("u_SpotLight.direction");Scene3D.SPOTLIGHTSPOTANGLE=Shader3D.propertyNameToID("u_SpotLight.spot");Scene3D.SPOTLIGHTRANGE=Shader3D.propertyNameToID("u_SpotLight.range");Scene3D.SPOTLIGHTCOLOR=Shader3D.propertyNameToID("u_SpotLight.color");Scene3D.AMBIENTCOLOR=Shader3D.propertyNameToID("u_AmbientColor");Scene3D.REFLECTIONTEXTURE=Shader3D.propertyNameToID("u_ReflectTexture");Scene3D.TIME=Shader3D.propertyNameToID("u_Time");Scene3D._configDefineValues=new DefineDatas();var ShaderPass=/*#__PURE__*/function(_Laya$ShaderCompile){_inheritsLoose(ShaderPass,_Laya$ShaderCompile);function ShaderPass(owner,vs,ps,stateMap){var _this52;_this52=_Laya$ShaderCompile.call(this,vs,ps,null)||this;_this52._cacheSharders={};_this52._cacheShaderHierarchy=1;_this52._renderState=new RenderState();_this52._validDefine=new DefineDatas();_this52._tags={};_this52._owner=owner;_this52._stateMap=stateMap;for(var k in _this52.defs){_this52._validDefine.add(Shader3D.getDefineByName(k));}return _this52;}var _proto112=ShaderPass.prototype;_proto112._compileToTree=function _compileToTree(parent,lines,start,includefiles,defs){var node,preNode;var text,name,fname;var ofs,words,noUseNode;var i,n,j;for(i=start;i<lines.length;i++){text=lines[i];if(text.length<1)continue;ofs=text.indexOf("//");if(ofs===0)continue;if(ofs>=0)text=text.substr(0,ofs);node=noUseNode||new Laya.ShaderNode(includefiles);noUseNode=null;node.text=text;if((ofs=text.indexOf("#"))>=0){name="#";for(j=ofs+1,n=text.length;j<n;j++){var c=text.charAt(j);if(c===' '||c==='\t'||c==='?')break;name+=c;}node.name=name;switch(name){case"#ifdef":case"#ifndef":node.setParent(parent);parent=node;if(defs){words=text.substr(j).split(Laya.ShaderCompile._splitToWordExps3);for(j=0;j<words.length;j++){text=words[j];text.length&&(defs[text]=true);}}continue;case"#if":case"#elif":node.setParent(parent);parent=node;if(defs){words=text.substr(j).split(Laya.ShaderCompile._splitToWordExps3);for(j=0;j<words.length;j++){text=words[j];text.length&&text!="defined"&&(defs[text]=true);}}continue;case"#else":parent=parent.parent;preNode=parent.childs[parent.childs.length-1];node.setParent(parent);parent=node;continue;case"#endif":parent=parent.parent;preNode=parent.childs[parent.childs.length-1];node.setParent(parent);continue;case"#include":words=Laya.ShaderCompile.splitToWords(text,null);var inlcudeFile=Laya.ShaderCompile.includes[words[1]];if(!inlcudeFile){throw "ShaderCompile error no this include file:"+words[1];}if((ofs=words[0].indexOf("?"))<0){node.setParent(parent);text=inlcudeFile.getWith(words[2]=='with'?words[3]:null);this._compileToTree(node,text.split('\n'),0,includefiles,defs);node.text="";continue;}node.setCondition(words[0].substr(ofs+1),Laya.ShaderCompile.IFDEF_YES);node.text=inlcudeFile.getWith(words[2]=='with'?words[3]:null);break;case"#import":words=Laya.ShaderCompile.splitToWords(text,null);fname=words[1];includefiles.push({node:node,file:Laya.ShaderCompile.includes[fname],ofs:node.text.length});continue;}}else {preNode=parent.childs[parent.childs.length-1];if(preNode&&!preNode.name){includefiles.length>0&&Laya.ShaderCompile.splitToWords(text,preNode);noUseNode=node;preNode.text+="\n"+text;continue;}includefiles.length>0&&Laya.ShaderCompile.splitToWords(text,node);}node.setParent(parent);}};_proto112._resizeCacheShaderMap=function _resizeCacheShaderMap(cacheMap,hierarchy,resizeLength){var end=this._cacheShaderHierarchy-1;if(hierarchy==end){for(var k in cacheMap){var shader=cacheMap[k];for(var i=0,n=resizeLength-end;i<n;i++){if(i==n-1)cacheMap[0]=shader;else cacheMap=cacheMap[i==0?k:0]={};}}this._cacheShaderHierarchy=resizeLength;}else {for(var k in cacheMap){this._resizeCacheShaderMap(cacheMap[k],++hierarchy,resizeLength);}}};_proto112._addDebugShaderVariantCollection=function _addDebugShaderVariantCollection(compileDefine,outDebugDefines,outDebugDefineMask){var dbugShaderVariantInfo=Shader3D._debugShaderVariantInfo;var debugSubShader=this._owner;var debugShader=debugSubShader._owner;var mask=compileDefine._mask;Shader3D._getNamesByDefineData(compileDefine,outDebugDefines);outDebugDefineMask.length=mask.length;for(var i=0,n=mask.length;i<n;i++){outDebugDefineMask[i]=mask[i];}if(dbugShaderVariantInfo)dbugShaderVariantInfo.setValue(debugShader,debugShader._subShaders.indexOf(debugSubShader),debugSubShader._passes.indexOf(this),outDebugDefines);else Shader3D._debugShaderVariantInfo=dbugShaderVariantInfo=new ShaderVariant(debugShader,debugShader._subShaders.indexOf(debugSubShader),debugSubShader._passes.indexOf(this),outDebugDefines);Shader3D.debugShaderVariantCollection.add(dbugShaderVariantInfo);};_proto112.withCompile=function withCompile(compileDefine){var debugDefineString=ShaderPass._debugDefineString;var debugDefineMask=ShaderPass._debugDefineMask;var debugMaskLength;compileDefine._intersectionDefineDatas(this._validDefine);if(Shader3D.debugMode){debugMaskLength=compileDefine._length;this._addDebugShaderVariantCollection(compileDefine,debugDefineString,debugDefineMask);}compileDefine.addDefineDatas(Scene3D._configDefineValues);var cacheShaders=this._cacheSharders;var maskLength=compileDefine._length;if(maskLength>this._cacheShaderHierarchy){this._resizeCacheShaderMap(cacheShaders,0,maskLength);this._cacheShaderHierarchy=maskLength;}var mask=compileDefine._mask;var endIndex=compileDefine._length-1;var maxEndIndex=this._cacheShaderHierarchy-1;for(var i=0;i<maxEndIndex;i++){var subMask=endIndex<i?0:mask[i];var subCacheShaders=cacheShaders[subMask];subCacheShaders||(cacheShaders[subMask]=subCacheShaders={});cacheShaders=subCacheShaders;}var cacheKey=endIndex<maxEndIndex?0:mask[maxEndIndex];var shader=cacheShaders[cacheKey];if(shader)return shader;var defineString=ShaderPass._defineString;Shader3D._getNamesByDefineData(compileDefine,defineString);var config=Config3D._config;var clusterSlices=config.lightClusterCount;var defMap={};var vertexHead;var fragmentHead;var defineStr="";if(Laya.WebGL._isWebGL2){vertexHead="#version 300 es\n\n\t\t\t\t#define attribute in\n\t\t\t\t#define varying out\n\t\t\t\t#define texture2D texture\n";fragmentHead="#version 300 es\n\n\t\t\t\t#define varying in\n\t\t\t\tout highp vec4 pc_fragColor;\n\t\t\t\t#define gl_FragColor pc_fragColor\n\t\t\t\t#define gl_FragDepthEXT gl_FragDepth\n\t\t\t\t#define texture2D texture\n\t\t\t\t#define textureCube texture\n\t\t\t\t#define texture2DProj textureProj\n\t\t\t\t#define texture2DLodEXT textureLod\n\t\t\t\t#define texture2DProjLodEXT textureProjLod\n\t\t\t\t#define textureCubeLodEXT textureLod\n\t\t\t\t#define texture2DGradEXT textureGrad\n\t\t\t\t#define texture2DProjGradEXT textureProjGrad\n\t\t\t\t#define textureCubeGradEXT textureGrad\n";}else {vertexHead="";fragmentHead="#ifdef GL_EXT_shader_texture_lod\n\t\t\t\t\t#extension GL_EXT_shader_texture_lod : enable\n\t\t\t\t#endif\n\t\t\t\t#if !defined(GL_EXT_shader_texture_lod)\n\t\t\t\t\t#define texture1DLodEXT texture1D\n\t\t\t\t\t#define texture2DLodEXT texture2D\n\t\t\t\t\t#define texture2DProjLodEXT texture2DProj\n\t\t\t\t\t#define texture3DLodEXT texture3D\n\t\t\t\t\t#define textureCubeLodEXT textureCube\n\t\t\t\t#endif\n";}defineStr+="#define MAX_LIGHT_COUNT "+config.maxLightCount+"\n";defineStr+="#define MAX_LIGHT_COUNT_PER_CLUSTER "+config._maxAreaLightCountPerClusterAverage+"\n";defineStr+="#define CLUSTER_X_COUNT "+clusterSlices.x+"\n";defineStr+="#define CLUSTER_Y_COUNT "+clusterSlices.y+"\n";defineStr+="#define CLUSTER_Z_COUNT "+clusterSlices.z+"\n";defineStr+="#define SHADER_CAPAILITY_LEVEL "+Laya.SystemUtils._shaderCapailityLevel+"\n";for(var i=0,n=defineString.length;i<n;i++){var def=defineString[i];defineStr+="#define "+def+"\n";defMap[def]=true;}var vs=this._VS.toscript(defMap,[]);var vsVersion='';if(vs[0].indexOf('#version')==0){vsVersion=vs[0]+'\n';vs.shift();}var ps=this._PS.toscript(defMap,[]);var psVersion='';if(ps[0].indexOf('#version')==0){psVersion=ps[0]+'\n';ps.shift();}var attibuteMap=Shader3D.getAttributeMapByDefine(defineString,this._owner._attributeMap);shader=new ShaderInstance(vsVersion+vertexHead+defineStr+vs.join('\n'),psVersion+fragmentHead+defineStr+ps.join('\n'),attibuteMap,this._owner._uniformMap||this._owner._owner._uniformMap,this);cacheShaders[cacheKey]=shader;if(Shader3D.debugMode){var defStr="";var defMask="";for(var i=0,n=debugMaskLength;i<n;i++){i==n-1?defMask+=debugDefineMask[i]:defMask+=debugDefineMask[i]+",";}for(var i=0,n=debugDefineString.length;i<n;i++){i==n-1?defStr+=debugDefineString[i]:defStr+=debugDefineString[i]+",";}console.log("%cLayaAir: Shader Compile Information---ShaderName:"+this._owner._owner._name+" SubShaderIndex:"+this._owner._owner._subShaders.indexOf(this._owner)+" PassIndex:"+this._owner._passes.indexOf(this)+" DefineMask:["+defMask+"]"+" DefineNames:["+defStr+"]","color:green");}return shader;};_proto112.setTag=function setTag(key,value){if(value)this._tags[key]=value;else delete this._tags[key];};_proto112.getTag=function getTag(key){return this._tags[key];};_createClass(ShaderPass,[{key:"renderState",get:function get(){return this._renderState;}}]);return ShaderPass;}(Laya.ShaderCompile);ShaderPass._defineString=[];ShaderPass._debugDefineString=[];ShaderPass._debugDefineMask=[];var SubShader=/*#__PURE__*/function(){function SubShader(attributeMap,uniformMap){this._flags={};this._passes=[];this._attributeMap=attributeMap;this._uniformMap=uniformMap;}var _proto113=SubShader.prototype;_proto113.setFlag=function setFlag(key,value){if(value)this._flags[key]=value;else delete this._flags[key];};_proto113.getFlag=function getFlag(key){return this._flags[key];};_proto113.addShaderPass=function addShaderPass(vs,ps,stateMap,pipelineMode){if(stateMap===void 0){stateMap=null;}if(pipelineMode===void 0){pipelineMode="Forward";}var shaderPass=new ShaderPass(this,vs,ps,stateMap);shaderPass._pipelineMode=pipelineMode;this._passes.push(shaderPass);return shaderPass;};return SubShader;}();(function(PBRSpecularSmoothnessSource){PBRSpecularSmoothnessSource[PBRSpecularSmoothnessSource["SpecularTextureAlpha"]=0]="SpecularTextureAlpha";PBRSpecularSmoothnessSource[PBRSpecularSmoothnessSource["AlbedoTextureAlpha"]=1]="AlbedoTextureAlpha";})(exports.PBRSpecularSmoothnessSource||(exports.PBRSpecularSmoothnessSource={}));var PBRSpecularMaterial=/*#__PURE__*/function(_PBRMaterial){_inheritsLoose(PBRSpecularMaterial,_PBRMaterial);function PBRSpecularMaterial(){var _this53;_this53=_PBRMaterial.call(this)||this;_this53.setShaderName("PBRSpecular");_this53._shaderValues.setVector(PBRSpecularMaterial.SPECULARCOLOR,new Vector4(0.2,0.2,0.2,1.0));return _this53;}PBRSpecularMaterial.__init__=function __init__(){PBRSpecularMaterial.SHADERDEFINE_SPECULARGLOSSTEXTURE=Shader3D.getDefineByName("SPECULARGLOSSTEXTURE");PBRSpecularMaterial.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA=Shader3D.getDefineByName("SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA");var attributeMap={'a_Position':VertexMesh.MESH_POSITION0,'a_Normal':VertexMesh.MESH_NORMAL0,'a_Tangent0':VertexMesh.MESH_TANGENT0,'a_Texcoord0':VertexMesh.MESH_TEXTURECOORDINATE0,'a_Texcoord1':VertexMesh.MESH_TEXTURECOORDINATE1,'a_BoneWeights':VertexMesh.MESH_BLENDWEIGHT0,'a_BoneIndices':VertexMesh.MESH_BLENDINDICES0,'a_MvpMatrix':VertexMesh.MESH_MVPMATRIX_ROW0,'a_WorldMat':VertexMesh.MESH_WORLDMATRIX_ROW0};var uniformMap={'u_Bones':Shader3D.PERIOD_CUSTOM,'u_MvpMatrix':Shader3D.PERIOD_SPRITE,'u_WorldMat':Shader3D.PERIOD_SPRITE,'u_LightmapScaleOffset':Shader3D.PERIOD_SPRITE,'u_LightMap':Shader3D.PERIOD_SPRITE,'u_LightMapDirection':Shader3D.PERIOD_SPRITE,'u_SimpleAnimatorTexture':Shader3D.PERIOD_SPRITE,'u_SimpleAnimatorParams':Shader3D.PERIOD_SPRITE,'u_SimpleAnimatorTextureSize':Shader3D.PERIOD_SPRITE,'u_CameraPos':Shader3D.PERIOD_CAMERA,'u_View':Shader3D.PERIOD_CAMERA,'u_ProjectionParams':Shader3D.PERIOD_CAMERA,'u_Viewport':Shader3D.PERIOD_CAMERA,'u_ViewProjection':Shader3D.PERIOD_CAMERA,'u_AlphaTestValue':Shader3D.PERIOD_MATERIAL,'u_AlbedoColor':Shader3D.PERIOD_MATERIAL,'u_EmissionColor':Shader3D.PERIOD_MATERIAL,'u_AlbedoTexture':Shader3D.PERIOD_MATERIAL,'u_NormalTexture':Shader3D.PERIOD_MATERIAL,'u_ParallaxTexture':Shader3D.PERIOD_MATERIAL,'u_OcclusionTexture':Shader3D.PERIOD_MATERIAL,'u_EmissionTexture':Shader3D.PERIOD_MATERIAL,'u_Smoothness':Shader3D.PERIOD_MATERIAL,'u_SmoothnessScale':Shader3D.PERIOD_MATERIAL,'u_occlusionStrength':Shader3D.PERIOD_MATERIAL,'u_NormalScale':Shader3D.PERIOD_MATERIAL,'u_ParallaxScale':Shader3D.PERIOD_MATERIAL,'u_TilingOffset':Shader3D.PERIOD_MATERIAL,'u_SpecGlossTexture':Shader3D.PERIOD_MATERIAL,'u_SpecularColor':Shader3D.PERIOD_MATERIAL,'u_ReflectTexture':Shader3D.PERIOD_SCENE,'u_ReflectIntensity':Shader3D.PERIOD_SCENE,'u_AmbientColor':Shader3D.PERIOD_SCENE,'u_FogStart':Shader3D.PERIOD_SCENE,'u_FogRange':Shader3D.PERIOD_SCENE,'u_FogColor':Shader3D.PERIOD_SCENE,'u_DirationLightCount':Shader3D.PERIOD_SCENE,'u_LightBuffer':Shader3D.PERIOD_SCENE,'u_LightClusterBuffer':Shader3D.PERIOD_SCENE,'u_ShadowBias':Shader3D.PERIOD_SCENE,'u_ShadowLightDirection':Shader3D.PERIOD_SCENE,'u_ShadowMap':Shader3D.PERIOD_SCENE,'u_ShadowParams':Shader3D.PERIOD_SCENE,'u_ShadowSplitSpheres':Shader3D.PERIOD_SCENE,'u_ShadowMatrices':Shader3D.PERIOD_SCENE,'u_ShadowMapSize':Shader3D.PERIOD_SCENE,'u_SpotShadowMap':Shader3D.PERIOD_SCENE,'u_SpotViewProjectMatrix':Shader3D.PERIOD_SCENE,'u_ShadowLightPosition':Shader3D.PERIOD_SCENE,'u_AmbientSHAr':Shader3D.PERIOD_SCENE,'u_AmbientSHAg':Shader3D.PERIOD_SCENE,'u_AmbientSHAb':Shader3D.PERIOD_SCENE,'u_AmbientSHBr':Shader3D.PERIOD_SCENE,'u_AmbientSHBg':Shader3D.PERIOD_SCENE,'u_AmbientSHBb':Shader3D.PERIOD_SCENE,'u_AmbientSHC':Shader3D.PERIOD_SCENE,'u_ReflectionProbe':Shader3D.PERIOD_SCENE,'u_ReflectCubeHDRParams':Shader3D.PERIOD_SCENE,'u_DirectionLight.direction':Shader3D.PERIOD_SCENE,'u_DirectionLight.color':Shader3D.PERIOD_SCENE,'u_PointLight.position':Shader3D.PERIOD_SCENE,'u_PointLight.range':Shader3D.PERIOD_SCENE,'u_PointLight.color':Shader3D.PERIOD_SCENE,'u_SpotLight.position':Shader3D.PERIOD_SCENE,'u_SpotLight.direction':Shader3D.PERIOD_SCENE,'u_SpotLight.range':Shader3D.PERIOD_SCENE,'u_SpotLight.spot':Shader3D.PERIOD_SCENE,'u_SpotLight.color':Shader3D.PERIOD_SCENE};var stateMap={'s_Cull':Shader3D.RENDER_STATE_CULL,'s_Blend':Shader3D.RENDER_STATE_BLEND,'s_BlendSrc':Shader3D.RENDER_STATE_BLEND_SRC,'s_BlendDst':Shader3D.RENDER_STATE_BLEND_DST,'s_DepthTest':Shader3D.RENDER_STATE_DEPTH_TEST,'s_DepthWrite':Shader3D.RENDER_STATE_DEPTH_WRITE};var shader=Shader3D.add("PBRSpecular",attributeMap,uniformMap,true);var subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);subShader.addShaderPass(PBRVS,PBRPS,stateMap,"Forward");subShader.addShaderPass(PBRShadowCasterVS,PBRShadowCasterPS,stateMap,"ShadowCaster");};var _proto114=PBRSpecularMaterial.prototype;_proto114.clone=function clone(){var dest=new PBRSpecularMaterial();this.cloneTo(dest);return dest;};_createClass(PBRSpecularMaterial,[{key:"specularTexture",get:function get(){return this._shaderValues.getTexture(PBRSpecularMaterial.SPECULARTEXTURE);},set:function set(value){if(value)this._shaderValues.addDefine(PBRSpecularMaterial.SHADERDEFINE_SPECULARGLOSSTEXTURE);else this._shaderValues.removeDefine(PBRSpecularMaterial.SHADERDEFINE_SPECULARGLOSSTEXTURE);this._shaderValues.setTexture(PBRSpecularMaterial.SPECULARTEXTURE,value);}},{key:"specularColor",get:function get(){return this._shaderValues.getVector(PBRSpecularMaterial.SPECULARCOLOR);},set:function set(value){this._shaderValues.setVector(PBRSpecularMaterial.SPECULARCOLOR,value);}}]);return PBRSpecularMaterial;}(PBRMaterial);PBRSpecularMaterial.SPECULARTEXTURE=Shader3D.propertyNameToID("u_SpecGlossTexture");PBRSpecularMaterial.SPECULARCOLOR=Shader3D.propertyNameToID("u_SpecularColor");var PBRPS$1="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n\tprecision highp int;\n#else\n\tprecision mediump float;\n\tprecision mediump int;\n#endif\n\n#include \"Lighting.glsl\";\n#include \"Shadow.glsl\"\n#include \"PBRFSInput.glsl\";\n#include \"LayaPBRBRDF.glsl\";\n#include \"GlobalIllumination.glsl\";\n#include \"PBRCore.glsl\";\n\nvoid main()\n{\n\tfragmentForward();\n}";var PBRVS$1="#include \"Lighting.glsl\";\n#include \"Shadow.glsl\"\n#include \"PBRVSInput.glsl\";\n#include \"PBRVertex.glsl\";\n\nvoid main()\n{\n\tvertexForward();\n\tgl_Position=remapGLPositionZ(gl_Position);\n}";var PBRShadowCasterPS$1="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n\tprecision highp int;\n#else\n\tprecision mediump float;\n\tprecision mediump int;\n#endif\n\n#include \"ShadowCasterFS.glsl\"\n\nvoid main()\n{\n\tgl_FragColor=shadowCasterFragment();\n}";var PBRShadowCasterVS$1="#include \"ShadowCasterVS.glsl\"\n\nvoid main()\n{\n\tvec4 positionCS =  shadowCasterVertex();\n\tgl_Position=remapGLPositionZ(positionCS);\n}";(function(PBRMetallicSmoothnessSource){PBRMetallicSmoothnessSource[PBRMetallicSmoothnessSource["MetallicGlossTextureAlpha"]=0]="MetallicGlossTextureAlpha";PBRMetallicSmoothnessSource[PBRMetallicSmoothnessSource["AlbedoTextureAlpha"]=1]="AlbedoTextureAlpha";})(exports.PBRMetallicSmoothnessSource||(exports.PBRMetallicSmoothnessSource={}));var PBRStandardMaterial=/*#__PURE__*/function(_PBRMaterial2){_inheritsLoose(PBRStandardMaterial,_PBRMaterial2);function PBRStandardMaterial(){var _this54;_this54=_PBRMaterial2.call(this)||this;_this54._smoothnessSource=0;_this54.setShaderName("PBR");_this54._shaderValues.setNumber(PBRStandardMaterial.METALLIC,0.0);return _this54;}PBRStandardMaterial.__init__=function __init__(){PBRStandardMaterial.SHADERDEFINE_METALLICGLOSSTEXTURE=Shader3D.getDefineByName("METALLICGLOSSTEXTURE");PBRStandardMaterial.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA=Shader3D.getDefineByName("SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA");var attributeMap={'a_Position':VertexMesh.MESH_POSITION0,'a_Normal':VertexMesh.MESH_NORMAL0,'a_Tangent0':VertexMesh.MESH_TANGENT0,'a_Texcoord0':VertexMesh.MESH_TEXTURECOORDINATE0,'a_Texcoord1':VertexMesh.MESH_TEXTURECOORDINATE1,'a_BoneWeights':VertexMesh.MESH_BLENDWEIGHT0,'a_BoneIndices':VertexMesh.MESH_BLENDINDICES0,'a_MvpMatrix':VertexMesh.MESH_MVPMATRIX_ROW0,'a_WorldMat':VertexMesh.MESH_WORLDMATRIX_ROW0};var uniformMap={'u_Bones':Shader3D.PERIOD_CUSTOM,'u_MvpMatrix':Shader3D.PERIOD_SPRITE,'u_WorldMat':Shader3D.PERIOD_SPRITE,'u_LightmapScaleOffset':Shader3D.PERIOD_SPRITE,'u_LightMap':Shader3D.PERIOD_SPRITE,'u_LightMapDirection':Shader3D.PERIOD_SPRITE,'u_SimpleAnimatorTexture':Shader3D.PERIOD_SPRITE,'u_SimpleAnimatorParams':Shader3D.PERIOD_SPRITE,'u_SimpleAnimatorTextureSize':Shader3D.PERIOD_SPRITE,'u_CameraPos':Shader3D.PERIOD_CAMERA,'u_View':Shader3D.PERIOD_CAMERA,'u_ProjectionParams':Shader3D.PERIOD_CAMERA,'u_Viewport':Shader3D.PERIOD_CAMERA,'u_ViewProjection':Shader3D.PERIOD_CAMERA,'u_AlphaTestValue':Shader3D.PERIOD_MATERIAL,'u_AlbedoColor':Shader3D.PERIOD_MATERIAL,'u_EmissionColor':Shader3D.PERIOD_MATERIAL,'u_AlbedoTexture':Shader3D.PERIOD_MATERIAL,'u_NormalTexture':Shader3D.PERIOD_MATERIAL,'u_ParallaxTexture':Shader3D.PERIOD_MATERIAL,'u_OcclusionTexture':Shader3D.PERIOD_MATERIAL,'u_EmissionTexture':Shader3D.PERIOD_MATERIAL,'u_Smoothness':Shader3D.PERIOD_MATERIAL,'u_SmoothnessScale':Shader3D.PERIOD_MATERIAL,'u_occlusionStrength':Shader3D.PERIOD_MATERIAL,'u_NormalScale':Shader3D.PERIOD_MATERIAL,'u_ParallaxScale':Shader3D.PERIOD_MATERIAL,'u_TilingOffset':Shader3D.PERIOD_MATERIAL,'u_MetallicGlossTexture':Shader3D.PERIOD_MATERIAL,'u_Metallic':Shader3D.PERIOD_MATERIAL,'u_ReflectTexture':Shader3D.PERIOD_SCENE,'u_ReflectIntensity':Shader3D.PERIOD_SCENE,'u_AmbientColor':Shader3D.PERIOD_SCENE,'u_FogStart':Shader3D.PERIOD_SCENE,'u_FogRange':Shader3D.PERIOD_SCENE,'u_FogColor':Shader3D.PERIOD_SCENE,'u_DirationLightCount':Shader3D.PERIOD_SCENE,'u_LightBuffer':Shader3D.PERIOD_SCENE,'u_LightClusterBuffer':Shader3D.PERIOD_SCENE,'u_ShadowBias':Shader3D.PERIOD_SCENE,'u_ShadowLightDirection':Shader3D.PERIOD_SCENE,'u_ShadowMap':Shader3D.PERIOD_SCENE,'u_ShadowParams':Shader3D.PERIOD_SCENE,'u_ShadowSplitSpheres':Shader3D.PERIOD_SCENE,'u_ShadowMatrices':Shader3D.PERIOD_SCENE,'u_ShadowMapSize':Shader3D.PERIOD_SCENE,'u_SpotShadowMap':Shader3D.PERIOD_SCENE,'u_SpotViewProjectMatrix':Shader3D.PERIOD_SCENE,'u_ShadowLightPosition':Shader3D.PERIOD_SCENE,'u_AmbientSHAr':Shader3D.PERIOD_SCENE,'u_AmbientSHAg':Shader3D.PERIOD_SCENE,'u_AmbientSHAb':Shader3D.PERIOD_SCENE,'u_AmbientSHBr':Shader3D.PERIOD_SCENE,'u_AmbientSHBg':Shader3D.PERIOD_SCENE,'u_AmbientSHBb':Shader3D.PERIOD_SCENE,'u_AmbientSHC':Shader3D.PERIOD_SCENE,'u_ReflectionProbe':Shader3D.PERIOD_SCENE,'u_ReflectCubeHDRParams':Shader3D.PERIOD_SCENE,'u_DirectionLight.direction':Shader3D.PERIOD_SCENE,'u_DirectionLight.color':Shader3D.PERIOD_SCENE,'u_PointLight.position':Shader3D.PERIOD_SCENE,'u_PointLight.range':Shader3D.PERIOD_SCENE,'u_PointLight.color':Shader3D.PERIOD_SCENE,'u_SpotLight.position':Shader3D.PERIOD_SCENE,'u_SpotLight.direction':Shader3D.PERIOD_SCENE,'u_SpotLight.range':Shader3D.PERIOD_SCENE,'u_SpotLight.spot':Shader3D.PERIOD_SCENE,'u_SpotLight.color':Shader3D.PERIOD_SCENE};var stateMap={'s_Cull':Shader3D.RENDER_STATE_CULL,'s_Blend':Shader3D.RENDER_STATE_BLEND,'s_BlendSrc':Shader3D.RENDER_STATE_BLEND_SRC,'s_BlendDst':Shader3D.RENDER_STATE_BLEND_DST,'s_DepthTest':Shader3D.RENDER_STATE_DEPTH_TEST,'s_DepthWrite':Shader3D.RENDER_STATE_DEPTH_WRITE};var shader=Shader3D.add("PBR",attributeMap,uniformMap,true);var subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);subShader.addShaderPass(PBRVS$1,PBRPS$1,stateMap,"Forward");subShader.addShaderPass(PBRShadowCasterVS$1,PBRShadowCasterPS$1,stateMap,"ShadowCaster");};var _proto115=PBRStandardMaterial.prototype;_proto115.clone=function clone(){var dest=new PBRStandardMaterial();this.cloneTo(dest);return dest;};_createClass(PBRStandardMaterial,[{key:"metallicGlossTexture",get:function get(){return this._shaderValues.getTexture(PBRStandardMaterial.METALLICGLOSSTEXTURE);},set:function set(value){if(value)this._shaderValues.addDefine(PBRStandardMaterial.SHADERDEFINE_METALLICGLOSSTEXTURE);else this._shaderValues.removeDefine(PBRStandardMaterial.SHADERDEFINE_METALLICGLOSSTEXTURE);this._shaderValues.setTexture(PBRStandardMaterial.METALLICGLOSSTEXTURE,value);}},{key:"metallic",get:function get(){return this._shaderValues.getNumber(PBRStandardMaterial.METALLIC);},set:function set(value){this._shaderValues.setNumber(PBRStandardMaterial.METALLIC,Math.max(0.0,Math.min(1.0,value)));}},{key:"smoothnessSource",get:function get(){return this._smoothnessSource;},set:function set(value){if(value)this._shaderValues.addDefine(PBRStandardMaterial.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA);else this._shaderValues.removeDefine(PBRStandardMaterial.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA);this._smoothnessSource=value;}}]);return PBRStandardMaterial;}(PBRMaterial);PBRStandardMaterial.METALLICGLOSSTEXTURE=Shader3D.propertyNameToID("u_MetallicGlossTexture");PBRStandardMaterial.METALLIC=Shader3D.propertyNameToID("u_Metallic");var SkyBoxMaterial=/*#__PURE__*/function(_Material6){_inheritsLoose(SkyBoxMaterial,_Material6);function SkyBoxMaterial(){var _this55;_this55=_Material6.call(this)||this;_this55.setShaderName("SkyBox");_this55.tintColor=new Vector4(0.5,0.5,0.5,0.5);_this55.exposure=1.0;_this55.rotation=0;return _this55;}SkyBoxMaterial.__initDefine__=function __initDefine__(){};var _proto116=SkyBoxMaterial.prototype;_proto116.clone=function clone(){var dest=new SkyBoxMaterial();this.cloneTo(dest);return dest;};_createClass(SkyBoxMaterial,[{key:"tintColor",get:function get(){return this._shaderValues.getVector(SkyBoxMaterial.TINTCOLOR);},set:function set(value){this._shaderValues.setVector(SkyBoxMaterial.TINTCOLOR,value);}},{key:"exposure",get:function get(){return this._shaderValues.getNumber(SkyBoxMaterial.EXPOSURE);},set:function set(value){this._shaderValues.setNumber(SkyBoxMaterial.EXPOSURE,value);}},{key:"rotation",get:function get(){return this._shaderValues.getNumber(SkyBoxMaterial.ROTATION);},set:function set(value){this._shaderValues.setNumber(SkyBoxMaterial.ROTATION,value);}},{key:"textureCube",get:function get(){return this._shaderValues.getTexture(SkyBoxMaterial.TEXTURECUBE);},set:function set(value){this._shaderValues.setTexture(SkyBoxMaterial.TEXTURECUBE,value);}}]);return SkyBoxMaterial;}(Material);SkyBoxMaterial.TINTCOLOR=Shader3D.propertyNameToID("u_TintColor");SkyBoxMaterial.EXPOSURE=Shader3D.propertyNameToID("u_Exposure");SkyBoxMaterial.ROTATION=Shader3D.propertyNameToID("u_Rotation");SkyBoxMaterial.TEXTURECUBE=Shader3D.propertyNameToID("u_CubeTexture");var SkyProceduralMaterial=/*#__PURE__*/function(_Material7){_inheritsLoose(SkyProceduralMaterial,_Material7);function SkyProceduralMaterial(){var _this56;_this56=_Material7.call(this)||this;_this56.setShaderName("SkyBoxProcedural");_this56.sunDisk=SkyProceduralMaterial.SUN_HIGH_QUALITY;_this56.sunSize=0.04;_this56.sunSizeConvergence=5;_this56.atmosphereThickness=1.0;_this56.skyTint=new Vector4(0.5,0.5,0.5,1.0);_this56.groundTint=new Vector4(0.369,0.349,0.341,1.0);_this56.exposure=1.3;return _this56;}SkyProceduralMaterial.__initDefine__=function __initDefine__(){SkyProceduralMaterial.SHADERDEFINE_SUN_HIGH_QUALITY=Shader3D.getDefineByName("SUN_HIGH_QUALITY");SkyProceduralMaterial.SHADERDEFINE_SUN_SIMPLE=Shader3D.getDefineByName("SUN_SIMPLE");};var _proto117=SkyProceduralMaterial.prototype;_proto117.clone=function clone(){var dest=new SkyProceduralMaterial();this.cloneTo(dest);return dest;};_createClass(SkyProceduralMaterial,[{key:"sunDisk",get:function get(){return this._sunDisk;},set:function set(value){switch(value){case SkyProceduralMaterial.SUN_HIGH_QUALITY:this._shaderValues.removeDefine(SkyProceduralMaterial.SHADERDEFINE_SUN_SIMPLE);this._shaderValues.addDefine(SkyProceduralMaterial.SHADERDEFINE_SUN_HIGH_QUALITY);break;case SkyProceduralMaterial.SUN_SIMPLE:this._shaderValues.removeDefine(SkyProceduralMaterial.SHADERDEFINE_SUN_HIGH_QUALITY);this._shaderValues.addDefine(SkyProceduralMaterial.SHADERDEFINE_SUN_SIMPLE);break;case SkyProceduralMaterial.SUN_NODE:this._shaderValues.removeDefine(SkyProceduralMaterial.SHADERDEFINE_SUN_HIGH_QUALITY);this._shaderValues.removeDefine(SkyProceduralMaterial.SHADERDEFINE_SUN_SIMPLE);break;default:throw "SkyBoxProceduralMaterial: unknown sun value.";}this._sunDisk=value;}},{key:"sunSize",get:function get(){return this._shaderValues.getNumber(SkyProceduralMaterial.SUNSIZE);},set:function set(value){value=Math.min(Math.max(0.0,value),1.0);this._shaderValues.setNumber(SkyProceduralMaterial.SUNSIZE,value);}},{key:"sunSizeConvergence",get:function get(){return this._shaderValues.getNumber(SkyProceduralMaterial.SUNSIZECONVERGENCE);},set:function set(value){value=Math.min(Math.max(0.0,value),20.0);this._shaderValues.setNumber(SkyProceduralMaterial.SUNSIZECONVERGENCE,value);}},{key:"atmosphereThickness",get:function get(){return this._shaderValues.getNumber(SkyProceduralMaterial.ATMOSPHERETHICKNESS);},set:function set(value){value=Math.min(Math.max(0.0,value),5.0);this._shaderValues.setNumber(SkyProceduralMaterial.ATMOSPHERETHICKNESS,value);}},{key:"skyTint",get:function get(){return this._shaderValues.getVector(SkyProceduralMaterial.SKYTINT);},set:function set(value){this._shaderValues.setVector(SkyProceduralMaterial.SKYTINT,value);}},{key:"groundTint",get:function get(){return this._shaderValues.getVector(SkyProceduralMaterial.GROUNDTINT);},set:function set(value){this._shaderValues.setVector(SkyProceduralMaterial.GROUNDTINT,value);}},{key:"exposure",get:function get(){return this._shaderValues.getNumber(SkyProceduralMaterial.EXPOSURE);},set:function set(value){value=Math.min(Math.max(0.0,value),8.0);this._shaderValues.setNumber(SkyProceduralMaterial.EXPOSURE,value);}}]);return SkyProceduralMaterial;}(Material);SkyProceduralMaterial.SUN_NODE=0;SkyProceduralMaterial.SUN_SIMPLE=1;SkyProceduralMaterial.SUN_HIGH_QUALITY=2;SkyProceduralMaterial.SUNSIZE=Shader3D.propertyNameToID("u_SunSize");SkyProceduralMaterial.SUNSIZECONVERGENCE=Shader3D.propertyNameToID("u_SunSizeConvergence");SkyProceduralMaterial.ATMOSPHERETHICKNESS=Shader3D.propertyNameToID("u_AtmosphereThickness");SkyProceduralMaterial.SKYTINT=Shader3D.propertyNameToID("u_SkyTint");SkyProceduralMaterial.GROUNDTINT=Shader3D.propertyNameToID("u_GroundTint");SkyProceduralMaterial.EXPOSURE=Shader3D.propertyNameToID("u_Exposure");var UnlitMaterial=/*#__PURE__*/function(_Material8){_inheritsLoose(UnlitMaterial,_Material8);function UnlitMaterial(){var _this57;_this57=_Material8.call(this)||this;_this57._albedoColor=new Vector4(1.0,1.0,1.0,1.0);_this57._albedoIntensity=1.0;_this57._enableVertexColor=false;_this57.setShaderName("Unlit");_this57._shaderValues.setVector(UnlitMaterial.ALBEDOCOLOR,new Vector4(1.0,1.0,1.0,1.0));_this57.renderMode=UnlitMaterial.RENDERMODE_OPAQUE;return _this57;}UnlitMaterial.__initDefine__=function __initDefine__(){UnlitMaterial.SHADERDEFINE_ALBEDOTEXTURE=Shader3D.getDefineByName("ALBEDOTEXTURE");UnlitMaterial.SHADERDEFINE_TILINGOFFSET=Shader3D.getDefineByName("TILINGOFFSET");UnlitMaterial.SHADERDEFINE_ENABLEVERTEXCOLOR=Shader3D.getDefineByName("ENABLEVERTEXCOLOR");};var _proto118=UnlitMaterial.prototype;_proto118.clone=function clone(){var dest=new UnlitMaterial();this.cloneTo(dest);return dest;};_createClass(UnlitMaterial,[{key:"_ColorR",get:function get(){return this._albedoColor.x;},set:function set(value){this._albedoColor.x=value;this.albedoColor=this._albedoColor;}},{key:"_ColorG",get:function get(){return this._albedoColor.y;},set:function set(value){this._albedoColor.y=value;this.albedoColor=this._albedoColor;}},{key:"_ColorB",get:function get(){return this._albedoColor.z;},set:function set(value){this._albedoColor.z=value;this.albedoColor=this._albedoColor;}},{key:"_ColorA",get:function get(){return this._albedoColor.w;},set:function set(value){this._albedoColor.w=value;this.albedoColor=this._albedoColor;}},{key:"_Color",get:function get(){return this._shaderValues.getVector(UnlitMaterial.ALBEDOCOLOR);},set:function set(value){this.albedoColor=value;}},{key:"_AlbedoIntensity",get:function get(){return this._albedoIntensity;},set:function set(value){if(this._albedoIntensity!==value){var finalAlbedo=this._shaderValues.getVector(UnlitMaterial.ALBEDOCOLOR);Vector4.scale(this._albedoColor,value,finalAlbedo);this._albedoIntensity=value;this._shaderValues.setVector(UnlitMaterial.ALBEDOCOLOR,finalAlbedo);}}},{key:"_MainTex_STX",get:function get(){return this._shaderValues.getVector(UnlitMaterial.TILINGOFFSET).x;},set:function set(x){var tilOff=this._shaderValues.getVector(UnlitMaterial.TILINGOFFSET);tilOff.x=x;this.tilingOffset=tilOff;}},{key:"_MainTex_STY",get:function get(){return this._shaderValues.getVector(UnlitMaterial.TILINGOFFSET).y;},set:function set(y){var tilOff=this._shaderValues.getVector(UnlitMaterial.TILINGOFFSET);tilOff.y=y;this.tilingOffset=tilOff;}},{key:"_MainTex_STZ",get:function get(){return this._shaderValues.getVector(UnlitMaterial.TILINGOFFSET).z;},set:function set(z){var tilOff=this._shaderValues.getVector(UnlitMaterial.TILINGOFFSET);tilOff.z=z;this.tilingOffset=tilOff;}},{key:"_MainTex_STW",get:function get(){return this._shaderValues.getVector(UnlitMaterial.TILINGOFFSET).w;},set:function set(w){var tilOff=this._shaderValues.getVector(UnlitMaterial.TILINGOFFSET);tilOff.w=w;this.tilingOffset=tilOff;}},{key:"_MainTex_ST",get:function get(){return this._shaderValues.getVector(UnlitMaterial.TILINGOFFSET);},set:function set(value){this.tilingOffset=value;}},{key:"_Cutoff",get:function get(){return this.alphaTestValue;},set:function set(value){this.alphaTestValue=value;}},{key:"albedoColorR",get:function get(){return this._ColorR;},set:function set(value){this._ColorR=value;}},{key:"albedoColorG",get:function get(){return this._ColorG;},set:function set(value){this._ColorG=value;}},{key:"albedoColorB",get:function get(){return this._ColorB;},set:function set(value){this._ColorB=value;}},{key:"albedoColorA",get:function get(){return this._ColorA;},set:function set(value){this._ColorA=value;}},{key:"albedoColor",get:function get(){return this._albedoColor;},set:function set(value){var finalAlbedo=this._shaderValues.getVector(UnlitMaterial.ALBEDOCOLOR);Vector4.scale(value,this._albedoIntensity,finalAlbedo);this._albedoColor=value;this._shaderValues.setVector(UnlitMaterial.ALBEDOCOLOR,finalAlbedo);}},{key:"albedoIntensity",get:function get(){return this._albedoIntensity;},set:function set(value){this._AlbedoIntensity=value;}},{key:"albedoTexture",get:function get(){return this._shaderValues.getTexture(UnlitMaterial.ALBEDOTEXTURE);},set:function set(value){if(value)this._shaderValues.addDefine(UnlitMaterial.SHADERDEFINE_ALBEDOTEXTURE);else this._shaderValues.removeDefine(UnlitMaterial.SHADERDEFINE_ALBEDOTEXTURE);this._shaderValues.setTexture(UnlitMaterial.ALBEDOTEXTURE,value);}},{key:"tilingOffsetX",get:function get(){return this._MainTex_STX;},set:function set(x){this._MainTex_STX=x;}},{key:"tilingOffsetY",get:function get(){return this._MainTex_STY;},set:function set(y){this._MainTex_STY=y;}},{key:"tilingOffsetZ",get:function get(){return this._MainTex_STZ;},set:function set(z){this._MainTex_STZ=z;}},{key:"tilingOffsetW",get:function get(){return this._MainTex_STW;},set:function set(w){this._MainTex_STW=w;}},{key:"tilingOffset",get:function get(){return this._shaderValues.getVector(UnlitMaterial.TILINGOFFSET);},set:function set(value){if(value){if(value.x!=1||value.y!=1||value.z!=0||value.w!=0)this._shaderValues.addDefine(UnlitMaterial.SHADERDEFINE_TILINGOFFSET);else this._shaderValues.removeDefine(UnlitMaterial.SHADERDEFINE_TILINGOFFSET);}else {this._shaderValues.removeDefine(UnlitMaterial.SHADERDEFINE_TILINGOFFSET);}this._shaderValues.setVector(UnlitMaterial.TILINGOFFSET,value);}},{key:"enableVertexColor",get:function get(){return this._enableVertexColor;},set:function set(value){this._enableVertexColor=value;if(value)this._shaderValues.addDefine(UnlitMaterial.SHADERDEFINE_ENABLEVERTEXCOLOR);else this._shaderValues.removeDefine(UnlitMaterial.SHADERDEFINE_ENABLEVERTEXCOLOR);}},{key:"renderMode",set:function set(value){switch(value){case UnlitMaterial.RENDERMODE_OPAQUE:this.alphaTest=false;this.renderQueue=Material.RENDERQUEUE_OPAQUE;this.depthWrite=true;this.cull=RenderState.CULL_BACK;this.blend=RenderState.BLEND_DISABLE;this.depthTest=RenderState.DEPTHTEST_LESS;break;case UnlitMaterial.RENDERMODE_CUTOUT:this.renderQueue=Material.RENDERQUEUE_ALPHATEST;this.alphaTest=true;this.depthWrite=true;this.cull=RenderState.CULL_BACK;this.blend=RenderState.BLEND_DISABLE;this.depthTest=RenderState.DEPTHTEST_LESS;break;case UnlitMaterial.RENDERMODE_TRANSPARENT:this.renderQueue=Material.RENDERQUEUE_TRANSPARENT;this.alphaTest=false;this.depthWrite=false;this.cull=RenderState.CULL_BACK;this.blend=RenderState.BLEND_ENABLE_ALL;this.blendSrc=RenderState.BLENDPARAM_SRC_ALPHA;this.blendDst=RenderState.BLENDPARAM_ONE_MINUS_SRC_ALPHA;this.depthTest=RenderState.DEPTHTEST_LESS;break;default:throw new Error("UnlitMaterial : renderMode value error.");}}},{key:"depthWrite",get:function get(){return this._shaderValues.getBool(UnlitMaterial.DEPTH_WRITE);},set:function set(value){this._shaderValues.setBool(UnlitMaterial.DEPTH_WRITE,value);}},{key:"cull",get:function get(){return this._shaderValues.getInt(UnlitMaterial.CULL);},set:function set(value){this._shaderValues.setInt(UnlitMaterial.CULL,value);}},{key:"blend",get:function get(){return this._shaderValues.getInt(UnlitMaterial.BLEND);},set:function set(value){this._shaderValues.setInt(UnlitMaterial.BLEND,value);}},{key:"blendSrc",get:function get(){return this._shaderValues.getInt(UnlitMaterial.BLEND_SRC);},set:function set(value){this._shaderValues.setInt(UnlitMaterial.BLEND_SRC,value);}},{key:"blendDst",get:function get(){return this._shaderValues.getInt(UnlitMaterial.BLEND_DST);},set:function set(value){this._shaderValues.setInt(UnlitMaterial.BLEND_DST,value);}},{key:"depthTest",get:function get(){return this._shaderValues.getInt(UnlitMaterial.DEPTH_TEST);},set:function set(value){this._shaderValues.setInt(UnlitMaterial.DEPTH_TEST,value);}}]);return UnlitMaterial;}(Material);UnlitMaterial.RENDERMODE_OPAQUE=0;UnlitMaterial.RENDERMODE_CUTOUT=1;UnlitMaterial.RENDERMODE_TRANSPARENT=2;UnlitMaterial.RENDERMODE_ADDTIVE=3;UnlitMaterial.ALBEDOTEXTURE=Shader3D.propertyNameToID("u_AlbedoTexture");UnlitMaterial.ALBEDOCOLOR=Shader3D.propertyNameToID("u_AlbedoColor");UnlitMaterial.TILINGOFFSET=Shader3D.propertyNameToID("u_TilingOffset");UnlitMaterial.CULL=Shader3D.propertyNameToID("s_Cull");UnlitMaterial.BLEND=Shader3D.propertyNameToID("s_Blend");UnlitMaterial.BLEND_SRC=Shader3D.propertyNameToID("s_BlendSrc");UnlitMaterial.BLEND_DST=Shader3D.propertyNameToID("s_BlendDst");UnlitMaterial.DEPTH_TEST=Shader3D.propertyNameToID("s_DepthTest");UnlitMaterial.DEPTH_WRITE=Shader3D.propertyNameToID("s_DepthWrite");var WaterPrimaryMaterial=/*#__PURE__*/function(_Material9){_inheritsLoose(WaterPrimaryMaterial,_Material9);function WaterPrimaryMaterial(){var _this58;_this58=_Material9.call(this)||this;_this58.setShaderName("WaterPrimary");_this58._shaderValues.setVector(WaterPrimaryMaterial.HORIZONCOLOR,new Vector4(0.172,0.463,0.435,0));_this58._shaderValues.setNumber(WaterPrimaryMaterial.WAVESCALE,0.15);_this58._shaderValues.setVector(WaterPrimaryMaterial.WAVESPEED,new Vector4(19,9,-16,-7));return _this58;}WaterPrimaryMaterial.__initDefine__=function __initDefine__(){WaterPrimaryMaterial.SHADERDEFINE_MAINTEXTURE=Shader3D.getDefineByName("MAINTEXTURE");WaterPrimaryMaterial.SHADERDEFINE_NORMALTEXTURE=Shader3D.getDefineByName("NORMALTEXTURE");};var _proto119=WaterPrimaryMaterial.prototype;_proto119.clone=function clone(){var dest=new WaterPrimaryMaterial();this.cloneTo(dest);return dest;};_createClass(WaterPrimaryMaterial,[{key:"horizonColor",get:function get(){return this._shaderValues.getVector(WaterPrimaryMaterial.HORIZONCOLOR);},set:function set(value){this._shaderValues.setVector(WaterPrimaryMaterial.HORIZONCOLOR,value);}},{key:"mainTexture",get:function get(){return this._shaderValues.getTexture(WaterPrimaryMaterial.MAINTEXTURE);},set:function set(value){if(value)this._shaderValues.addDefine(WaterPrimaryMaterial.SHADERDEFINE_MAINTEXTURE);else this._shaderValues.removeDefine(WaterPrimaryMaterial.SHADERDEFINE_MAINTEXTURE);this._shaderValues.setTexture(WaterPrimaryMaterial.MAINTEXTURE,value);}},{key:"normalTexture",get:function get(){return this._shaderValues.getTexture(WaterPrimaryMaterial.NORMALTEXTURE);},set:function set(value){if(value)this._shaderValues.addDefine(WaterPrimaryMaterial.SHADERDEFINE_NORMALTEXTURE);else this._shaderValues.removeDefine(WaterPrimaryMaterial.SHADERDEFINE_NORMALTEXTURE);this._shaderValues.setTexture(WaterPrimaryMaterial.NORMALTEXTURE,value);}},{key:"waveScale",get:function get(){return this._shaderValues.getNumber(WaterPrimaryMaterial.WAVESCALE);},set:function set(value){this._shaderValues.setNumber(WaterPrimaryMaterial.WAVESCALE,value);}},{key:"waveSpeed",get:function get(){return this._shaderValues.getVector(WaterPrimaryMaterial.WAVESPEED);},set:function set(value){this._shaderValues.setVector(WaterPrimaryMaterial.WAVESPEED,value);}}]);return WaterPrimaryMaterial;}(Material);WaterPrimaryMaterial.HORIZONCOLOR=Shader3D.propertyNameToID("u_HorizonColor");WaterPrimaryMaterial.MAINTEXTURE=Shader3D.propertyNameToID("u_MainTexture");WaterPrimaryMaterial.NORMALTEXTURE=Shader3D.propertyNameToID("u_NormalTexture");WaterPrimaryMaterial.WAVESCALE=Shader3D.propertyNameToID("u_WaveScale");WaterPrimaryMaterial.WAVESPEED=Shader3D.propertyNameToID("u_WaveSpeed");var MeshSprite3DShaderDeclaration=function MeshSprite3DShaderDeclaration(){};var MeshRenderer=/*#__PURE__*/function(_BaseRender2){_inheritsLoose(MeshRenderer,_BaseRender2);function MeshRenderer(owner){var _this59;_this59=_BaseRender2.call(this,owner)||this;_this59._revertStaticBatchDefineUV1=false;_this59._projectionViewWorldMatrix=new Matrix4x4();return _this59;}var _proto120=MeshRenderer.prototype;_proto120._createRenderElement=function _createRenderElement(){return new SubMeshRenderElement();};_proto120._onMeshChange=function _onMeshChange(mesh){if(mesh){var count=mesh.subMeshCount;this._renderElements.length=count;for(var i=0;i<count;i++){var renderElement=this._renderElements[i];if(!renderElement){var material=this.sharedMaterials[i];renderElement=this._renderElements[i]=this._createRenderElement();renderElement.setTransform(this._owner._transform);renderElement.render=this;renderElement.material=material?material:BlinnPhongMaterial.defaultMaterial;}renderElement.setGeometry(mesh.getSubMesh(i));}}else {this._renderElements.length=0;}this._boundsChange=true;};_proto120._calculateBoundingBox=function _calculateBoundingBox(){var sharedMesh=this._owner.meshFilter.sharedMesh;if(sharedMesh){var worldMat=this._owner.transform.worldMatrix;sharedMesh.bounds._tranform(worldMat,this._bounds);}if(Laya.Render.supportWebGLPlusCulling){var min=this._bounds.getMin();var max=this._bounds.getMax();var buffer=FrustumCulling._cullingBuffer;buffer[this._cullingBufferIndex+1]=min.x;buffer[this._cullingBufferIndex+2]=min.y;buffer[this._cullingBufferIndex+3]=min.z;buffer[this._cullingBufferIndex+4]=max.x;buffer[this._cullingBufferIndex+5]=max.y;buffer[this._cullingBufferIndex+6]=max.z;}};_proto120._needRender=function _needRender(boundFrustum,context){if(boundFrustum)return boundFrustum.intersects(this.bounds._getBoundBox());else return true;};_proto120._renderUpdate=function _renderUpdate(context,transform){this._applyLightMapParams();var element=context.renderElement;switch(element.renderType){case RenderElement.RENDERTYPE_NORMAL:this._shaderValues.setMatrix4x4(Sprite3D.WORLDMATRIX,transform.worldMatrix);break;case RenderElement.RENDERTYPE_STATICBATCH:if(transform)this._shaderValues.setMatrix4x4(Sprite3D.WORLDMATRIX,transform.worldMatrix);else this._shaderValues.setMatrix4x4(Sprite3D.WORLDMATRIX,Matrix4x4.DEFAULT);if(!this._shaderValues.hasDefine(MeshSprite3DShaderDeclaration.SHADERDEFINE_UV1)){this._shaderValues.addDefine(MeshSprite3DShaderDeclaration.SHADERDEFINE_UV1);this._revertStaticBatchDefineUV1=true;}else {this._revertStaticBatchDefineUV1=false;}this._shaderValues.setVector(RenderableSprite3D.LIGHTMAPSCALEOFFSET,BaseRender._defaultLightmapScaleOffset);break;case RenderElement.RENDERTYPE_VERTEXBATCH:this._shaderValues.setMatrix4x4(Sprite3D.WORLDMATRIX,Matrix4x4.DEFAULT);break;case RenderElement.RENDERTYPE_INSTANCEBATCH:var worldMatrixData=SubMeshInstanceBatch.instance.instanceWorldMatrixData;var insBatches=element.instanceBatchElementList;var elements=insBatches.elements;var count=insBatches.length;for(var i=0;i<count;i++){worldMatrixData.set(elements[i]._transform.worldMatrix.elements,i*16);}var worldBuffer=SubMeshInstanceBatch.instance.instanceWorldMatrixBuffer;worldBuffer.orphanStorage();worldBuffer.setData(worldMatrixData.buffer,0,0,count*16*4);this._shaderValues.addDefine(MeshSprite3DShaderDeclaration.SHADERDEFINE_GPU_INSTANCE);break;}};_proto120._renderUpdateWithCamera=function _renderUpdateWithCamera(context,transform){var projectionView=context.projectionViewMatrix;if(projectionView){var element=context.renderElement;switch(element.renderType){case RenderElement.RENDERTYPE_NORMAL:case RenderElement.RENDERTYPE_STATICBATCH:case RenderElement.RENDERTYPE_VERTEXBATCH:if(transform){Matrix4x4.multiply(projectionView,transform.worldMatrix,this._projectionViewWorldMatrix);this._shaderValues.setMatrix4x4(Sprite3D.MVPMATRIX,this._projectionViewWorldMatrix);}else {this._shaderValues.setMatrix4x4(Sprite3D.MVPMATRIX,projectionView);}break;case RenderElement.RENDERTYPE_INSTANCEBATCH:var mvpMatrixData=SubMeshInstanceBatch.instance.instanceMVPMatrixData;var insBatches=element.instanceBatchElementList;var elements=insBatches.elements;var count=insBatches.length;for(var i=0;i<count;i++){var worldMat=elements[i]._transform.worldMatrix;Utils3D.mulMatrixByArray(projectionView.elements,0,worldMat.elements,0,mvpMatrixData,i*16);}var mvpBuffer=SubMeshInstanceBatch.instance.instanceMVPMatrixBuffer;mvpBuffer.orphanStorage();mvpBuffer.setData(mvpMatrixData.buffer,0,0,count*16*4);break;}}};_proto120._revertBatchRenderUpdate=function _revertBatchRenderUpdate(context){var element=context.renderElement;switch(element.renderType){case RenderElement.RENDERTYPE_STATICBATCH:if(this._revertStaticBatchDefineUV1)this._shaderValues.removeDefine(MeshSprite3DShaderDeclaration.SHADERDEFINE_UV1);this._shaderValues.setVector(RenderableSprite3D.LIGHTMAPSCALEOFFSET,this.lightmapScaleOffset);break;case RenderElement.RENDERTYPE_INSTANCEBATCH:this._shaderValues.removeDefine(MeshSprite3DShaderDeclaration.SHADERDEFINE_GPU_INSTANCE);break;}};_proto120._destroy=function _destroy(){this._isPartOfStaticBatch&&MeshRenderStaticBatchManager.instance._removeRenderSprite(this._owner);_BaseRender2.prototype._destroy.call(this);};return MeshRenderer;}(BaseRender);var MeshFilter=/*#__PURE__*/function(){function MeshFilter(owner){this._owner=owner;}var _proto121=MeshFilter.prototype;_proto121._getMeshDefine=function _getMeshDefine(mesh,out){out.length=0;var define;for(var i=0,n=mesh._subMeshes.length;i<n;i++){var subMesh=mesh.getSubMesh(i);var vertexElements=subMesh._vertexBuffer._vertexDeclaration._vertexElements;for(var j=0,m=vertexElements.length;j<m;j++){var vertexElement=vertexElements[j];var name=vertexElement._elementUsage;switch(name){case VertexMesh.MESH_COLOR0:out.push(MeshSprite3DShaderDeclaration.SHADERDEFINE_COLOR);break;case VertexMesh.MESH_TEXTURECOORDINATE0:out.push(MeshSprite3DShaderDeclaration.SHADERDEFINE_UV0);break;case VertexMesh.MESH_TEXTURECOORDINATE1:out.push(MeshSprite3DShaderDeclaration.SHADERDEFINE_UV1);break;}}}return define;};_proto121.destroy=function destroy(){this._owner=null;this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null);};_createClass(MeshFilter,[{key:"sharedMesh",get:function get(){return this._sharedMesh;},set:function set(value){if(this._sharedMesh!==value){var defineDatas=this._owner._render._shaderValues;var lastValue=this._sharedMesh;if(lastValue){lastValue._removeReference();this._getMeshDefine(lastValue,MeshFilter._meshVerticeDefine);for(var i=0,n=MeshFilter._meshVerticeDefine.length;i<n;i++){defineDatas.removeDefine(MeshFilter._meshVerticeDefine[i]);}}if(value){value._addReference();this._getMeshDefine(value,MeshFilter._meshVerticeDefine);for(var i=0,n=MeshFilter._meshVerticeDefine.length;i<n;i++){defineDatas.addDefine(MeshFilter._meshVerticeDefine[i]);}}this._owner._render._onMeshChange(value);this._sharedMesh=value;}}}]);return MeshFilter;}();MeshFilter._meshVerticeDefine=[];var SubMeshDynamicBatch=/*#__PURE__*/function(_GeometryElement4){_inheritsLoose(SubMeshDynamicBatch,_GeometryElement4);function SubMeshDynamicBatch(){var _this60;_this60=_GeometryElement4.call(this)||this;_this60._bufferState=new BufferState();var gl=Laya.LayaGL.instance;var maxVerDec=VertexMesh.getVertexDeclaration("POSITION,NORMAL,COLOR,UV,UV1,TANGENT");var maxByteCount=maxVerDec.vertexStride*SubMeshDynamicBatch.maxIndicesCount;_this60._vertices=new Float32Array(maxByteCount/4);_this60._vertexBuffer=new VertexBuffer3D(maxByteCount,gl.DYNAMIC_DRAW);_this60._indices=new Int16Array(SubMeshDynamicBatch.maxIndicesCount);_this60._indexBuffer=new IndexBuffer3D(exports.IndexFormat.UInt16,_this60._indices.length,gl.DYNAMIC_DRAW);var memorySize=_this60._vertexBuffer._byteLength+_this60._indexBuffer._byteLength;Laya.Resource._addMemory(memorySize,memorySize);return _this60;}SubMeshDynamicBatch.__init__=function __init__(){SubMeshDynamicBatch.instance=new SubMeshDynamicBatch();};var _proto122=SubMeshDynamicBatch.prototype;_proto122._getBatchVertices=function _getBatchVertices(vertexDeclaration,batchVertices,batchOffset,transform,element,subMesh){var vertexFloatCount=vertexDeclaration.vertexStride/4;var oriVertexes=subMesh._vertexBuffer.getFloat32Data();var lightmapScaleOffset=element.render.lightmapScaleOffset;var multiSubMesh=element._dynamicMultiSubMesh;var vertexCount=element._dynamicVertexCount;element._computeWorldPositionsAndNormals(this._positionOffset,this._normalOffset,multiSubMesh,vertexCount);var worldPositions=element._dynamicWorldPositions;var worldNormals=element._dynamicWorldNormals;var indices=subMesh._indices;for(var i=0;i<vertexCount;i++){var index=multiSubMesh?indices[i]:i;var oriOffset=index*vertexFloatCount;var bakeOffset=(i+batchOffset)*vertexFloatCount;var oriOff=i*3;var bakOff=bakeOffset+this._positionOffset;batchVertices[bakOff]=worldPositions[oriOff];batchVertices[bakOff+1]=worldPositions[oriOff+1];batchVertices[bakOff+2]=worldPositions[oriOff+2];if(this._normalOffset!==-1){bakOff=bakeOffset+this._normalOffset;batchVertices[bakOff]=worldNormals[oriOff];batchVertices[bakOff+1]=worldNormals[oriOff+1];batchVertices[bakOff+2]=worldNormals[oriOff+2];}if(this._colorOffset!==-1){bakOff=bakeOffset+this._colorOffset;oriOff=oriOffset+this._colorOffset;batchVertices[bakOff]=oriVertexes[oriOff];batchVertices[bakOff+1]=oriVertexes[oriOff+1];batchVertices[bakOff+2]=oriVertexes[oriOff+2];batchVertices[bakOff+3]=oriVertexes[oriOff+3];}if(this._uv0Offset!==-1){bakOff=bakeOffset+this._uv0Offset;oriOff=oriOffset+this._uv0Offset;batchVertices[bakOff]=oriVertexes[oriOff];batchVertices[bakOff+1]=oriVertexes[oriOff+1];}if(this._sTangentOffset!==-1){bakOff=bakeOffset+this._sTangentOffset;oriOff=oriOffset+this._sTangentOffset;batchVertices[bakOff]=oriVertexes[oriOff];batchVertices[bakOff+1]=oriVertexes[oriOff+1];batchVertices[bakOff+2]=oriVertexes[oriOff+2];batchVertices[bakOff+3]=oriVertexes[oriOff+3];bakOff=bakeOffset+this._sTangentOffset;oriOff=oriOffset+this._sTangentOffset;batchVertices[bakOff]=oriVertexes[oriOff];batchVertices[bakOff+1]=oriVertexes[oriOff+1];batchVertices[bakOff+2]=oriVertexes[oriOff+2];batchVertices[bakOff+3]=oriVertexes[oriOff+3];}}};_proto122._getBatchIndices=function _getBatchIndices(batchIndices,batchIndexCount,batchVertexCount,transform,subMesh,multiSubMesh){var subIndices=subMesh._indices;var k,m,batchOffset;var isInvert=transform._isFrontFaceInvert;if(multiSubMesh){if(isInvert){for(k=0,m=subIndices.length;k<m;k+=3){batchOffset=batchIndexCount+k;var index=batchVertexCount+k;batchIndices[batchOffset]=index;batchIndices[batchOffset+1]=index+2;batchIndices[batchOffset+2]=index+1;}}else {for(k=0,m=subIndices.length;k<m;k+=3){batchOffset=batchIndexCount+k;index=batchVertexCount+k;batchIndices[batchOffset]=index;batchIndices[batchOffset+1]=index+1;batchIndices[batchOffset+2]=index+2;}}}else {if(isInvert){for(k=0,m=subIndices.length;k<m;k+=3){batchOffset=batchIndexCount+k;batchIndices[batchOffset]=batchVertexCount+subIndices[k];batchIndices[batchOffset+1]=batchVertexCount+subIndices[k+2];batchIndices[batchOffset+2]=batchVertexCount+subIndices[k+1];}}else {for(k=0,m=subIndices.length;k<m;k+=3){batchOffset=batchIndexCount+k;batchIndices[batchOffset]=batchVertexCount+subIndices[k];batchIndices[batchOffset+1]=batchVertexCount+subIndices[k+1];batchIndices[batchOffset+2]=batchVertexCount+subIndices[k+2];}}}};_proto122._flush=function _flush(vertexCount,indexCount){var gl=Laya.LayaGL.instance;this._vertexBuffer.setData(this._vertices.buffer,0,0,vertexCount*this._bufferState.vertexDeclaration.vertexStride);this._indexBuffer.setData(this._indices,0,0,indexCount);gl.drawElements(gl.TRIANGLES,indexCount,gl.UNSIGNED_SHORT,0);};_proto122._prepareRender=function _prepareRender(state){var element=state.renderElement;var vertexDeclaration=element.vertexBatchVertexDeclaration;this._bufferState=ILaya3D.MeshRenderDynamicBatchManager.instance._getBufferState(vertexDeclaration);this._positionOffset=vertexDeclaration.getVertexElementByUsage(VertexMesh.MESH_POSITION0)._offset/4;var normalElement=vertexDeclaration.getVertexElementByUsage(VertexMesh.MESH_NORMAL0);this._normalOffset=normalElement?normalElement._offset/4:-1;var colorElement=vertexDeclaration.getVertexElementByUsage(VertexMesh.MESH_COLOR0);this._colorOffset=colorElement?colorElement._offset/4:-1;var uv0Element=vertexDeclaration.getVertexElementByUsage(VertexMesh.MESH_TEXTURECOORDINATE0);this._uv0Offset=uv0Element?uv0Element._offset/4:-1;var uv1Element=vertexDeclaration.getVertexElementByUsage(VertexMesh.MESH_TEXTURECOORDINATE1);this._uv1Offset=uv1Element?uv1Element._offset/4:-1;var tangentElement=vertexDeclaration.getVertexElementByUsage(VertexMesh.MESH_TANGENT0);this._sTangentOffset=tangentElement?tangentElement._offset/4:-1;return true;};_proto122._render=function _render(context){this._bufferState.bind();var element=context.renderElement;var vertexDeclaration=element.vertexBatchVertexDeclaration;var batchElements=element.vertexBatchElementList;var batchVertexCount=0;var batchIndexCount=0;var floatStride=vertexDeclaration.vertexStride/4;var renderBatchCount=0;var elementCount=batchElements.length;var elements=batchElements.elements;for(var i=0;i<elementCount;i++){var subElement=elements[i];var subMesh=subElement._geometry;var indexCount=subMesh._indexCount;if(batchIndexCount+indexCount>SubMeshDynamicBatch.maxIndicesCount){this._flush(batchVertexCount,batchIndexCount);renderBatchCount++;Laya.Stat.trianglesFaces+=batchIndexCount/3;batchVertexCount=batchIndexCount=0;}var transform=subElement._transform;this._getBatchVertices(vertexDeclaration,this._vertices,batchVertexCount,transform,subElement,subMesh);this._getBatchIndices(this._indices,batchIndexCount,batchVertexCount,transform,subMesh,subElement._dynamicMultiSubMesh);batchVertexCount+=subElement._dynamicVertexCount;batchIndexCount+=indexCount;}this._flush(batchVertexCount,batchIndexCount);renderBatchCount++;Laya.Stat.renderBatches+=renderBatchCount;Laya.Stat.savedRenderBatches+=elementCount-renderBatchCount;Laya.Stat.trianglesFaces+=batchIndexCount/3;};return SubMeshDynamicBatch;}(GeometryElement);SubMeshDynamicBatch.maxAllowVertexCount=10;SubMeshDynamicBatch.maxAllowAttribueCount=900;SubMeshDynamicBatch.maxIndicesCount=32000;var MeshRenderDynamicBatchManager=/*#__PURE__*/function(_DynamicBatchManager){_inheritsLoose(MeshRenderDynamicBatchManager,_DynamicBatchManager);function MeshRenderDynamicBatchManager(){var _this61;_this61=_DynamicBatchManager.call(this)||this;_this61._instanceBatchOpaqueMarks=[];_this61._vertexBatchOpaqueMarks=[];_this61._cacheBufferStates=[];_this61._updateCountMark=0;return _this61;}var _proto123=MeshRenderDynamicBatchManager.prototype;_proto123.getInstanceBatchOpaquaMark=function getInstanceBatchOpaquaMark(receiveShadow,materialID,subMeshID,invertFace){var instanceReceiveShadowMarks=this._instanceBatchOpaqueMarks[receiveShadow?0:1]||(this._instanceBatchOpaqueMarks[receiveShadow?0:1]=[]);var instanceMaterialMarks=instanceReceiveShadowMarks[materialID]||(instanceReceiveShadowMarks[materialID]=[]);var instancSubMeshMarks=instanceMaterialMarks[subMeshID]||(instanceMaterialMarks[subMeshID]=[]);return instancSubMeshMarks[invertFace?1:0]||(instancSubMeshMarks[invertFace?1:0]=new BatchMark());};_proto123.getVertexBatchOpaquaMark=function getVertexBatchOpaquaMark(lightMapIndex,receiveShadow,materialID,verDecID){var dynLightMapMarks=this._vertexBatchOpaqueMarks[lightMapIndex]||(this._vertexBatchOpaqueMarks[lightMapIndex]=[]);var dynReceiveShadowMarks=dynLightMapMarks[receiveShadow?0:1]||(dynLightMapMarks[receiveShadow?0:1]=[]);var dynMaterialMarks=dynReceiveShadowMarks[materialID]||(dynReceiveShadowMarks[materialID]=[]);return dynMaterialMarks[verDecID]||(dynMaterialMarks[verDecID]=new BatchMark());};_proto123._getBufferState=function _getBufferState(vertexDeclaration){var bufferState=this._cacheBufferStates[vertexDeclaration.id];if(!bufferState){var instance=SubMeshDynamicBatch.instance;bufferState=new BufferState();bufferState.bind();var vertexBuffer=instance._vertexBuffer;vertexBuffer.vertexDeclaration=vertexDeclaration;bufferState.applyVertexBuffer(vertexBuffer);bufferState.applyIndexBuffer(instance._indexBuffer);bufferState.unBind();this._cacheBufferStates[vertexDeclaration.id]=bufferState;}return bufferState;};_proto123._getBatchRenderElementFromPool=function _getBatchRenderElementFromPool(){var renderElement=this._batchRenderElementPool[this._batchRenderElementPoolIndex++];if(!renderElement){renderElement=new SubMeshRenderElement();this._batchRenderElementPool[this._batchRenderElementPoolIndex-1]=renderElement;renderElement.vertexBatchElementList=new SingletonList();renderElement.instanceBatchElementList=new SingletonList();}return renderElement;};_proto123._clear=function _clear(){_DynamicBatchManager.prototype._clear.call(this);this._updateCountMark++;};return MeshRenderDynamicBatchManager;}(DynamicBatchManager);MeshRenderDynamicBatchManager.instance=new MeshRenderDynamicBatchManager();var MeshSprite3D=/*#__PURE__*/function(_RenderableSprite3D2){_inheritsLoose(MeshSprite3D,_RenderableSprite3D2);function MeshSprite3D(mesh,name){var _this62;if(mesh===void 0){mesh=null;}if(name===void 0){name=null;}_this62=_RenderableSprite3D2.call(this,name)||this;_this62._meshFilter=new MeshFilter(_assertThisInitialized(_this62));_this62._render=new MeshRenderer(_assertThisInitialized(_this62));mesh&&(_this62._meshFilter.sharedMesh=mesh);return _this62;}MeshSprite3D.__init__=function __init__(){MeshSprite3DShaderDeclaration.SHADERDEFINE_UV0=Shader3D.getDefineByName("UV");MeshSprite3DShaderDeclaration.SHADERDEFINE_COLOR=Shader3D.getDefineByName("COLOR");MeshSprite3DShaderDeclaration.SHADERDEFINE_UV1=Shader3D.getDefineByName("UV1");MeshSprite3DShaderDeclaration.SHADERDEFINE_GPU_INSTANCE=Shader3D.getDefineByName("GPU_INSTANCE");StaticBatchManager._registerManager(MeshRenderStaticBatchManager.instance);DynamicBatchManager._registerManager(MeshRenderDynamicBatchManager.instance);};var _proto124=MeshSprite3D.prototype;_proto124._parse=function _parse(data,spriteMap){_RenderableSprite3D2.prototype._parse.call(this,data,spriteMap);var render=this.meshRenderer;var lightmapIndex=data.lightmapIndex;lightmapIndex!=null&&(render.lightmapIndex=lightmapIndex);var lightmapScaleOffsetArray=data.lightmapScaleOffset;lightmapScaleOffsetArray&&(render.lightmapScaleOffset=new Vector4(lightmapScaleOffsetArray[0],lightmapScaleOffsetArray[1],lightmapScaleOffsetArray[2],lightmapScaleOffsetArray[3]));data.meshPath!=undefined&&(this.meshFilter.sharedMesh=Laya.Loader.getRes(data.meshPath));data.enableRender!=undefined&&(render.enable=data.enableRender);data.receiveShadows!=undefined&&(render.receiveShadow=data.receiveShadows);data.castShadow!=undefined&&(render.castShadow=data.castShadow);var materials=data.materials;if(materials){var sharedMaterials=render.sharedMaterials;var materialCount=materials.length;sharedMaterials.length=materialCount;for(var i=0;i<materialCount;i++){sharedMaterials[i]=Laya.Loader.getRes(materials[i].path);}render.sharedMaterials=sharedMaterials;}};_proto124._addToInitStaticBatchManager=function _addToInitStaticBatchManager(){if(this.meshFilter.sharedMesh)MeshRenderStaticBatchManager.instance._addBatchSprite(this);};_proto124._cloneTo=function _cloneTo(destObject,rootSprite,dstSprite){var meshSprite3D=destObject;meshSprite3D._meshFilter.sharedMesh=this._meshFilter.sharedMesh;var meshRender=this._render;var destMeshRender=meshSprite3D._render;destMeshRender.enable=meshRender.enable;destMeshRender.sharedMaterials=meshRender.sharedMaterials;destMeshRender.castShadow=meshRender.castShadow;var lightmapScaleOffset=meshRender.lightmapScaleOffset;lightmapScaleOffset&&(destMeshRender.lightmapScaleOffset=lightmapScaleOffset.clone());destMeshRender.lightmapIndex=meshRender.lightmapIndex;destMeshRender.receiveShadow=meshRender.receiveShadow;destMeshRender.sortingFudge=meshRender.sortingFudge;_RenderableSprite3D2.prototype._cloneTo.call(this,destObject,rootSprite,dstSprite);};_proto124.destroy=function destroy(destroyChild){if(destroyChild===void 0){destroyChild=true;}if(this.destroyed)return;_RenderableSprite3D2.prototype.destroy.call(this,destroyChild);this._meshFilter.destroy();};_proto124._create=function _create(){return new MeshSprite3D();};_createClass(MeshSprite3D,[{key:"meshFilter",get:function get(){return this._meshFilter;}},{key:"meshRenderer",get:function get(){return this._render;}}]);return MeshSprite3D;}(RenderableSprite3D);var GradientMode=function GradientMode(){};GradientMode.Blend=0;GradientMode.Fixed=1;var Gradient=/*#__PURE__*/function(){function Gradient(maxColorRGBKeyCount,maxColorAlphaKeyCount){this._mode=0;this._maxColorRGBKeysCount=0;this._maxColorAlphaKeysCount=0;this._colorRGBKeysCount=0;this._colorAlphaKeysCount=0;this._alphaElements=null;this._rgbElements=null;this._maxColorRGBKeysCount=maxColorRGBKeyCount;this._maxColorAlphaKeysCount=maxColorAlphaKeyCount;this._rgbElements=new Float32Array(maxColorRGBKeyCount*4);this._alphaElements=new Float32Array(maxColorAlphaKeyCount*2);}var _proto125=Gradient.prototype;_proto125.addColorRGB=function addColorRGB(key,value){if(this._colorRGBKeysCount<this._maxColorRGBKeysCount){var offset=this._colorRGBKeysCount*4;this._rgbElements[offset]=key;this._rgbElements[offset+1]=value.r;this._rgbElements[offset+2]=value.g;this._rgbElements[offset+3]=value.b;this._colorRGBKeysCount++;}else {console.warn("Gradient:warning:data count must lessEqual than "+this._maxColorRGBKeysCount);}};_proto125.addColorAlpha=function addColorAlpha(key,value){if(this._colorAlphaKeysCount<this._maxColorAlphaKeysCount){var offset=this._colorAlphaKeysCount*2;this._alphaElements[offset]=key;this._alphaElements[offset+1]=value;this._colorAlphaKeysCount++;}else {console.warn("Gradient:warning:data count must lessEqual than "+this._maxColorAlphaKeysCount);}};_proto125.updateColorRGB=function updateColorRGB(index,key,value){if(index<this._colorRGBKeysCount){var offset=index*4;this._rgbElements[offset]=key;this._rgbElements[offset+1]=value.r;this._rgbElements[offset+2]=value.g;this._rgbElements[offset+3]=value.b;}else {console.warn("Gradient:warning:index must lessEqual than colorRGBKeysCount:"+this._colorRGBKeysCount);}};_proto125.updateColorAlpha=function updateColorAlpha(index,key,value){if(index<this._colorAlphaKeysCount){var offset=index*2;this._alphaElements[offset]=key;this._alphaElements[offset+1]=value;}else {console.warn("Gradient:warning:index must lessEqual than colorAlphaKeysCount:"+this._colorAlphaKeysCount);}};_proto125.evaluateColorRGB=function evaluateColorRGB(lerpFactor,out,startSearchIndex,reverseSearch){if(startSearchIndex===void 0){startSearchIndex=0;}if(reverseSearch===void 0){reverseSearch=false;}lerpFactor=Math.min(Math.max(lerpFactor,0.0),1.0);var rgbElements=this._rgbElements;var curIndex=startSearchIndex;if(reverseSearch){for(var i=curIndex;i>=0;i--){var offset=i*4;var left=rgbElements[offset];if(lerpFactor===left){out.r=rgbElements[offset+1];out.g=rgbElements[offset+2];out.b=rgbElements[offset+3];return curIndex;}switch(this._mode){case GradientMode.Blend:if(lerpFactor>left){var right=rgbElements[offset+4];if(lerpFactor>right)throw "Gradient:wrong startSearchIndex.";var diff=right-left;var y1=right-lerpFactor;var y2=lerpFactor-left;out.r=(y1*rgbElements[offset+1]+y2*rgbElements[offset+5])/diff;out.g=(y1*rgbElements[offset+2]+y2*rgbElements[offset+6])/diff;out.b=(y1*rgbElements[offset+3]+y2*rgbElements[offset+7])/diff;return curIndex;}else {curIndex--;continue;}case GradientMode.Fixed:if(lerpFactor>left){if(lerpFactor>rgbElements[offset+4])throw "Gradient:wrong startSearchIndex.";out.r=rgbElements[offset+5];out.g=rgbElements[offset+6];out.b=rgbElements[offset+7];return curIndex;}else {curIndex--;continue;}default:throw "Gradient:unknown mode.";}}}else {for(var i=0,n=this._rgbElements.length;i<n;i++){offset=i*4;var right=rgbElements[offset];if(lerpFactor===right){out.r=rgbElements[offset+1];out.g=rgbElements[offset+2];out.b=rgbElements[offset+3];return curIndex;}switch(this._mode){case GradientMode.Blend:if(lerpFactor<right){var left=rgbElements[offset-4];if(lerpFactor<left)throw "Gradient:wrong startSearchIndex.";var diff=right-left;var y1=right-lerpFactor;var y2=lerpFactor-left;out.r=(y1*rgbElements[offset-3]+y2*rgbElements[offset+1])/diff;out.g=(y1*rgbElements[offset-2]+y2*rgbElements[offset+2])/diff;out.b=(y1*rgbElements[offset-1]+y2*rgbElements[offset+3])/diff;return curIndex;}else {curIndex++;continue;}case GradientMode.Fixed:if(lerpFactor<right){if(lerpFactor<rgbElements[offset-4])throw "Gradient:wrong startSearchIndex.";out.r=rgbElements[offset+1];out.g=rgbElements[offset+2];out.b=rgbElements[offset+3];return curIndex;}else {curIndex++;continue;}default:throw "Gradient:unknown mode.";}}}return curIndex;};_proto125.evaluateColorAlpha=function evaluateColorAlpha(lerpFactor,outColor,startSearchIndex,reverseSearch){if(startSearchIndex===void 0){startSearchIndex=0;}if(reverseSearch===void 0){reverseSearch=false;}lerpFactor=Math.min(Math.max(lerpFactor,0.0),1.0);var alphaElements=this._alphaElements;var curIndex=startSearchIndex;if(reverseSearch){for(var i=curIndex;i>=0;i--){var offset=i*2;var left=alphaElements[offset];if(lerpFactor===left){outColor.a=alphaElements[offset+1];return curIndex;}switch(this._mode){case GradientMode.Blend:if(lerpFactor>left){var right=alphaElements[offset+2];if(lerpFactor>right)throw "Gradient:wrong startSearchIndex.";var diff=right-left;var x1=right-lerpFactor;var x2=lerpFactor-left;outColor.a=(x1*alphaElements[offset+1]+x2*alphaElements[offset+3])/diff;return curIndex;}else {curIndex--;continue;}case GradientMode.Fixed:if(lerpFactor>left){if(lerpFactor>alphaElements[offset+2])throw "Gradient:wrong startSearchIndex.";outColor.a=alphaElements[offset+3];return curIndex;}else {curIndex--;continue;}default:throw "Gradient:unknown mode.";}}}else {for(var i=curIndex,n=this._alphaElements.length;i<n;i++){var offset=i*2;var right=alphaElements[offset];if(lerpFactor===right){outColor.a=alphaElements[offset+1];return curIndex;}switch(this._mode){case GradientMode.Blend:if(lerpFactor<right){var left=alphaElements[offset-2];if(lerpFactor<left)throw "Gradient:wrong startSearchIndex.";var diff=right-left;var x1=right-lerpFactor;var x2=lerpFactor-left;outColor.a=(x1*alphaElements[offset-1]+x2*alphaElements[offset+1])/diff;return curIndex;}else {curIndex++;continue;}case GradientMode.Fixed:if(lerpFactor<right){if(lerpFactor<alphaElements[offset-2])throw "Gradient:wrong startSearchIndex.";outColor.a=alphaElements[offset+1];return curIndex;}else {curIndex++;continue;}default:throw "Gradient:unknown mode.";}}}return curIndex;};_proto125.cloneTo=function cloneTo(destObject){var destGradientDataColor=destObject;var i,n;destGradientDataColor._colorAlphaKeysCount=this._colorAlphaKeysCount;var destAlphaElements=destGradientDataColor._alphaElements;for(i=0,n=this._alphaElements.length;i<n;i++){destAlphaElements[i]=this._alphaElements[i];}destGradientDataColor._colorRGBKeysCount=this._colorRGBKeysCount;var destRGBElements=destGradientDataColor._rgbElements;for(i=0,n=this._rgbElements.length;i<n;i++){destRGBElements[i]=this._rgbElements[i];}};_proto125.clone=function clone(){var destGradientDataColor=new Gradient(this._maxColorRGBKeysCount,this._maxColorAlphaKeysCount);this.cloneTo(destGradientDataColor);return destGradientDataColor;};_createClass(Gradient,[{key:"mode",get:function get(){return this._mode;},set:function set(value){this._mode=value;}},{key:"colorRGBKeysCount",get:function get(){return this._colorRGBKeysCount;}},{key:"colorAlphaKeysCount",get:function get(){return this._colorAlphaKeysCount;}},{key:"maxColorRGBKeysCount",get:function get(){return this._maxColorRGBKeysCount;}},{key:"maxColorAlphaKeysCount",get:function get(){return this._maxColorAlphaKeysCount;}}]);return Gradient;}();var Burst=/*#__PURE__*/function(){function Burst(time,minCount,maxCount){this._time=time;this._minCount=minCount;this._maxCount=maxCount;}var _proto126=Burst.prototype;_proto126.cloneTo=function cloneTo(destObject){var destBurst=destObject;destBurst._time=this._time;destBurst._minCount=this._minCount;destBurst._maxCount=this._maxCount;};_proto126.clone=function clone(){var destBurst=new Burst(this._time,this._minCount,this._maxCount);this.cloneTo(destBurst);return destBurst;};_createClass(Burst,[{key:"time",get:function get(){return this._time;}},{key:"minCount",get:function get(){return this._minCount;}},{key:"maxCount",get:function get(){return this._maxCount;}}]);return Burst;}();var GradientColor=/*#__PURE__*/function(){function GradientColor(){this._type=0;this._constant=null;this._constantMin=null;this._constantMax=null;this._gradient=null;this._gradientMin=null;this._gradientMax=null;}GradientColor.createByConstant=function createByConstant(constant){var gradientColor=new GradientColor();gradientColor._type=0;gradientColor._constant=constant;return gradientColor;};GradientColor.createByGradient=function createByGradient(gradient){var gradientColor=new GradientColor();gradientColor._type=1;gradientColor._gradient=gradient;return gradientColor;};GradientColor.createByRandomTwoConstant=function createByRandomTwoConstant(minConstant,maxConstant){var gradientColor=new GradientColor();gradientColor._type=2;gradientColor._constantMin=minConstant;gradientColor._constantMax=maxConstant;return gradientColor;};GradientColor.createByRandomTwoGradient=function createByRandomTwoGradient(minGradient,maxGradient){var gradientColor=new GradientColor();gradientColor._type=3;gradientColor._gradientMin=minGradient;gradientColor._gradientMax=maxGradient;return gradientColor;};var _proto127=GradientColor.prototype;_proto127.cloneTo=function cloneTo(destObject){var destGradientColor=destObject;destGradientColor._type=this._type;this._constant.cloneTo(destGradientColor._constant);this._constantMin.cloneTo(destGradientColor._constantMin);this._constantMax.cloneTo(destGradientColor._constantMax);this._gradient.cloneTo(destGradientColor._gradient);this._gradientMin.cloneTo(destGradientColor._gradientMin);this._gradientMax.cloneTo(destGradientColor._gradientMax);};_proto127.clone=function clone(){var destGradientColor=new GradientColor();this.cloneTo(destGradientColor);return destGradientColor;};_createClass(GradientColor,[{key:"type",get:function get(){return this._type;}},{key:"constant",get:function get(){return this._constant;}},{key:"constantMin",get:function get(){return this._constantMin;}},{key:"constantMax",get:function get(){return this._constantMax;}},{key:"gradient",get:function get(){return this._gradient;}},{key:"gradientMin",get:function get(){return this._gradientMin;}},{key:"gradientMax",get:function get(){return this._gradientMax;}}]);return GradientColor;}();var ColorOverLifetime=/*#__PURE__*/function(){function ColorOverLifetime(color){this._color=color;}var _proto128=ColorOverLifetime.prototype;_proto128.cloneTo=function cloneTo(destObject){var destColorOverLifetime=destObject;this._color.cloneTo(destColorOverLifetime._color);destColorOverLifetime.enable=this.enable;};_proto128.clone=function clone(){var destColor;switch(this._color.type){case 0:destColor=GradientColor.createByConstant(this._color.constant.clone());break;case 1:destColor=GradientColor.createByGradient(this._color.gradient.clone());break;case 2:destColor=GradientColor.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:destColor=GradientColor.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone());break;}var destColorOverLifetime=new ColorOverLifetime(destColor);destColorOverLifetime.enable=this.enable;return destColorOverLifetime;};_createClass(ColorOverLifetime,[{key:"color",get:function get(){return this._color;}}]);return ColorOverLifetime;}();var FrameOverTime=/*#__PURE__*/function(){function FrameOverTime(){this._type=0;this._constant=0;this._overTime=null;this._constantMin=0;this._constantMax=0;this._overTimeMin=null;this._overTimeMax=null;}FrameOverTime.createByConstant=function createByConstant(constant){if(constant===void 0){constant=0;}var rotationOverLifetime=new FrameOverTime();rotationOverLifetime._type=0;rotationOverLifetime._constant=constant;return rotationOverLifetime;};FrameOverTime.createByOverTime=function createByOverTime(overTime){var rotationOverLifetime=new FrameOverTime();rotationOverLifetime._type=1;rotationOverLifetime._overTime=overTime;return rotationOverLifetime;};FrameOverTime.createByRandomTwoConstant=function createByRandomTwoConstant(constantMin,constantMax){if(constantMin===void 0){constantMin=0;}if(constantMax===void 0){constantMax=0;}var rotationOverLifetime=new FrameOverTime();rotationOverLifetime._type=2;rotationOverLifetime._constantMin=constantMin;rotationOverLifetime._constantMax=constantMax;return rotationOverLifetime;};FrameOverTime.createByRandomTwoOverTime=function createByRandomTwoOverTime(gradientFrameMin,gradientFrameMax){var rotationOverLifetime=new FrameOverTime();rotationOverLifetime._type=3;rotationOverLifetime._overTimeMin=gradientFrameMin;rotationOverLifetime._overTimeMax=gradientFrameMax;return rotationOverLifetime;};var _proto129=FrameOverTime.prototype;_proto129.cloneTo=function cloneTo(destObject){var destFrameOverTime=destObject;destFrameOverTime._type=this._type;destFrameOverTime._constant=this._constant;this._overTime&&this._overTime.cloneTo(destFrameOverTime._overTime);destFrameOverTime._constantMin=this._constantMin;destFrameOverTime._constantMax=this._constantMax;this._overTimeMin&&this._overTimeMin.cloneTo(destFrameOverTime._overTimeMin);this._overTimeMax&&this._overTimeMax.cloneTo(destFrameOverTime._overTimeMax);};_proto129.clone=function clone(){var destFrameOverTime=new FrameOverTime();this.cloneTo(destFrameOverTime);return destFrameOverTime;};_createClass(FrameOverTime,[{key:"type",get:function get(){return this._type;}},{key:"constant",get:function get(){return this._constant;}},{key:"frameOverTimeData",get:function get(){return this._overTime;}},{key:"constantMin",get:function get(){return this._constantMin;}},{key:"constantMax",get:function get(){return this._constantMax;}},{key:"frameOverTimeDataMin",get:function get(){return this._overTimeMin;}},{key:"frameOverTimeDataMax",get:function get(){return this._overTimeMax;}}]);return FrameOverTime;}();var GradientAngularVelocity=/*#__PURE__*/function(){function GradientAngularVelocity(){this._type=0;this._separateAxes=false;this._constant=0;this._constantSeparate=null;this._gradient=null;this._gradientX=null;this._gradientY=null;this._gradientZ=null;this._gradientW=null;this._constantMin=0;this._constantMax=0;this._constantMinSeparate=null;this._constantMaxSeparate=null;this._gradientMin=null;this._gradientMax=null;this._gradientXMin=null;this._gradientXMax=null;this._gradientYMin=null;this._gradientYMax=null;this._gradientZMin=null;this._gradientZMax=null;this._gradientWMin=null;this._gradientWMax=null;}GradientAngularVelocity.createByConstant=function createByConstant(constant){var gradientAngularVelocity=new GradientAngularVelocity();gradientAngularVelocity._type=0;gradientAngularVelocity._separateAxes=false;gradientAngularVelocity._constant=constant;return gradientAngularVelocity;};GradientAngularVelocity.createByConstantSeparate=function createByConstantSeparate(separateConstant){var gradientAngularVelocity=new GradientAngularVelocity();gradientAngularVelocity._type=0;gradientAngularVelocity._separateAxes=true;gradientAngularVelocity._constantSeparate=separateConstant;return gradientAngularVelocity;};GradientAngularVelocity.createByGradient=function createByGradient(gradient){var gradientAngularVelocity=new GradientAngularVelocity();gradientAngularVelocity._type=1;gradientAngularVelocity._separateAxes=false;gradientAngularVelocity._gradient=gradient;return gradientAngularVelocity;};GradientAngularVelocity.createByGradientSeparate=function createByGradientSeparate(gradientX,gradientY,gradientZ){var gradientAngularVelocity=new GradientAngularVelocity();gradientAngularVelocity._type=1;gradientAngularVelocity._separateAxes=true;gradientAngularVelocity._gradientX=gradientX;gradientAngularVelocity._gradientY=gradientY;gradientAngularVelocity._gradientZ=gradientZ;return gradientAngularVelocity;};GradientAngularVelocity.createByRandomTwoConstant=function createByRandomTwoConstant(constantMin,constantMax){var gradientAngularVelocity=new GradientAngularVelocity();gradientAngularVelocity._type=2;gradientAngularVelocity._separateAxes=false;gradientAngularVelocity._constantMin=constantMin;gradientAngularVelocity._constantMax=constantMax;return gradientAngularVelocity;};GradientAngularVelocity.createByRandomTwoConstantSeparate=function createByRandomTwoConstantSeparate(separateConstantMin,separateConstantMax){var gradientAngularVelocity=new GradientAngularVelocity();gradientAngularVelocity._type=2;gradientAngularVelocity._separateAxes=true;gradientAngularVelocity._constantMinSeparate=separateConstantMin;gradientAngularVelocity._constantMaxSeparate=separateConstantMax;return gradientAngularVelocity;};GradientAngularVelocity.createByRandomTwoGradient=function createByRandomTwoGradient(gradientMin,gradientMax){var gradientAngularVelocity=new GradientAngularVelocity();gradientAngularVelocity._type=3;gradientAngularVelocity._separateAxes=false;gradientAngularVelocity._gradientMin=gradientMin;gradientAngularVelocity._gradientMax=gradientMax;return gradientAngularVelocity;};GradientAngularVelocity.createByRandomTwoGradientSeparate=function createByRandomTwoGradientSeparate(gradientXMin,gradientXMax,gradientYMin,gradientYMax,gradientZMin,gradientZMax,gradientWMin,gradientWMax){var gradientAngularVelocity=new GradientAngularVelocity();gradientAngularVelocity._type=3;gradientAngularVelocity._separateAxes=true;gradientAngularVelocity._gradientXMin=gradientXMin;gradientAngularVelocity._gradientXMax=gradientXMax;gradientAngularVelocity._gradientYMin=gradientYMin;gradientAngularVelocity._gradientYMax=gradientYMax;gradientAngularVelocity._gradientZMin=gradientZMin;gradientAngularVelocity._gradientZMax=gradientZMax;gradientAngularVelocity._gradientWMin=gradientWMin;gradientAngularVelocity._gradientWMax=gradientWMax;return gradientAngularVelocity;};var _proto130=GradientAngularVelocity.prototype;_proto130.cloneTo=function cloneTo(destObject){var destGradientAngularVelocity=destObject;destGradientAngularVelocity._type=this._type;destGradientAngularVelocity._separateAxes=this._separateAxes;destGradientAngularVelocity._constant=this._constant;this._constantSeparate.cloneTo(destGradientAngularVelocity._constantSeparate);this._gradient.cloneTo(destGradientAngularVelocity._gradient);this._gradientX.cloneTo(destGradientAngularVelocity._gradientX);this._gradientY.cloneTo(destGradientAngularVelocity._gradientY);this._gradientZ.cloneTo(destGradientAngularVelocity._gradientZ);destGradientAngularVelocity._constantMin=this._constantMin;destGradientAngularVelocity._constantMax=this._constantMax;this._constantMinSeparate.cloneTo(destGradientAngularVelocity._constantMinSeparate);this._constantMaxSeparate.cloneTo(destGradientAngularVelocity._constantMaxSeparate);this._gradientMin.cloneTo(destGradientAngularVelocity._gradientMin);this._gradientMax.cloneTo(destGradientAngularVelocity._gradientMax);this._gradientXMin.cloneTo(destGradientAngularVelocity._gradientXMin);this._gradientXMax.cloneTo(destGradientAngularVelocity._gradientXMax);this._gradientYMin.cloneTo(destGradientAngularVelocity._gradientYMin);this._gradientYMax.cloneTo(destGradientAngularVelocity._gradientYMax);this._gradientZMin.cloneTo(destGradientAngularVelocity._gradientZMin);this._gradientZMax.cloneTo(destGradientAngularVelocity._gradientZMax);};_proto130.clone=function clone(){var destGradientAngularVelocity=new GradientAngularVelocity();this.cloneTo(destGradientAngularVelocity);return destGradientAngularVelocity;};_createClass(GradientAngularVelocity,[{key:"type",get:function get(){return this._type;}},{key:"separateAxes",get:function get(){return this._separateAxes;}},{key:"constant",get:function get(){return this._constant;}},{key:"constantSeparate",get:function get(){return this._constantSeparate;}},{key:"gradient",get:function get(){return this._gradient;}},{key:"gradientX",get:function get(){return this._gradientX;}},{key:"gradientY",get:function get(){return this._gradientY;}},{key:"gradientZ",get:function get(){return this._gradientZ;}},{key:"gradientW",get:function get(){return this._gradientW;}},{key:"constantMin",get:function get(){return this._constantMin;}},{key:"constantMax",get:function get(){return this._constantMax;}},{key:"constantMinSeparate",get:function get(){return this._constantMinSeparate;}},{key:"constantMaxSeparate",get:function get(){return this._constantMaxSeparate;}},{key:"gradientMin",get:function get(){return this._gradientMin;}},{key:"gradientMax",get:function get(){return this._gradientMax;}},{key:"gradientXMin",get:function get(){return this._gradientXMin;}},{key:"gradientXMax",get:function get(){return this._gradientXMax;}},{key:"gradientYMin",get:function get(){return this._gradientYMin;}},{key:"gradientYMax",get:function get(){return this._gradientYMax;}},{key:"gradientZMin",get:function get(){return this._gradientZMin;}},{key:"gradientZMax",get:function get(){return this._gradientZMax;}},{key:"gradientWMin",get:function get(){return this._gradientWMin;}},{key:"gradientWMax",get:function get(){return this._gradientWMax;}}]);return GradientAngularVelocity;}();var GradientDataInt=/*#__PURE__*/function(){function GradientDataInt(){this._currentLength=0;this._elements=new Float32Array(8);}var _proto131=GradientDataInt.prototype;_proto131.add=function add(key,value){if(this._currentLength<8){if(this._currentLength===6&&key!==1){key=1;console.log("Warning:the forth key is  be force set to 1.");}this._elements[this._currentLength++]=key;this._elements[this._currentLength++]=value;}else {console.log("Warning:data count must lessEqual than 4");}};_proto131.cloneTo=function cloneTo(destObject){var destGradientDataInt=destObject;destGradientDataInt._currentLength=this._currentLength;var destElements=destGradientDataInt._elements;for(var i=0,n=this._elements.length;i<n;i++){destElements[i]=this._elements[i];}};_proto131.clone=function clone(){var destGradientDataInt=new GradientDataInt();this.cloneTo(destGradientDataInt);return destGradientDataInt;};_createClass(GradientDataInt,[{key:"gradientCount",get:function get(){return this._currentLength/2;}}]);return GradientDataInt;}();var GradientDataNumber=/*#__PURE__*/function(){function GradientDataNumber(){this._currentLength=0;this._elements=new Float32Array(8);}var _proto132=GradientDataNumber.prototype;_proto132.add=function add(key,value){if(this._currentLength<8){if(this._currentLength===6&&key!==1){key=1;console.log("GradientDataNumber warning:the forth key is  be force set to 1.");}this._elements[this._currentLength++]=key;this._elements[this._currentLength++]=value;}else {console.log("GradientDataNumber warning:data count must lessEqual than 4");}};_proto132.getKeyByIndex=function getKeyByIndex(index){return this._elements[index*2];};_proto132.getValueByIndex=function getValueByIndex(index){return this._elements[index*2+1];};_proto132.getAverageValue=function getAverageValue(){var total=0;var count=0;for(var i=0,n=this._currentLength-2;i<n;i+=2){var subValue=this._elements[i+1];subValue+=this._elements[i+3];subValue=subValue*(this._elements[i+2]-this._elements[i]);total+=subValue;count++;}return total/count;};_proto132.cloneTo=function cloneTo(destObject){var destGradientDataNumber=destObject;destGradientDataNumber._currentLength=this._currentLength;var destElements=destGradientDataNumber._elements;for(var i=0,n=this._elements.length;i<n;i++){destElements[i]=this._elements[i];}};_proto132.clone=function clone(){var destGradientDataNumber=new GradientDataNumber();this.cloneTo(destGradientDataNumber);return destGradientDataNumber;};_createClass(GradientDataNumber,[{key:"gradientCount",get:function get(){return this._currentLength/2;}}]);return GradientDataNumber;}();var GradientSize=/*#__PURE__*/function(){function GradientSize(){this._type=0;this._separateAxes=false;this._gradient=null;this._gradientX=null;this._gradientY=null;this._gradientZ=null;this._constantMin=0;this._constantMax=0;this._constantMinSeparate=null;this._constantMaxSeparate=null;this._gradientMin=null;this._gradientMax=null;this._gradientXMin=null;this._gradientXMax=null;this._gradientYMin=null;this._gradientYMax=null;this._gradientZMin=null;this._gradientZMax=null;}GradientSize.createByGradient=function createByGradient(gradient){var gradientSize=new GradientSize();gradientSize._type=0;gradientSize._separateAxes=false;gradientSize._gradient=gradient;return gradientSize;};GradientSize.createByGradientSeparate=function createByGradientSeparate(gradientX,gradientY,gradientZ){var gradientSize=new GradientSize();gradientSize._type=0;gradientSize._separateAxes=true;gradientSize._gradientX=gradientX;gradientSize._gradientY=gradientY;gradientSize._gradientZ=gradientZ;return gradientSize;};GradientSize.createByRandomTwoConstant=function createByRandomTwoConstant(constantMin,constantMax){var gradientSize=new GradientSize();gradientSize._type=1;gradientSize._separateAxes=false;gradientSize._constantMin=constantMin;gradientSize._constantMax=constantMax;return gradientSize;};GradientSize.createByRandomTwoConstantSeparate=function createByRandomTwoConstantSeparate(constantMinSeparate,constantMaxSeparate){var gradientSize=new GradientSize();gradientSize._type=1;gradientSize._separateAxes=true;gradientSize._constantMinSeparate=constantMinSeparate;gradientSize._constantMaxSeparate=constantMaxSeparate;return gradientSize;};GradientSize.createByRandomTwoGradient=function createByRandomTwoGradient(gradientMin,gradientMax){var gradientSize=new GradientSize();gradientSize._type=2;gradientSize._separateAxes=false;gradientSize._gradientMin=gradientMin;gradientSize._gradientMax=gradientMax;return gradientSize;};GradientSize.createByRandomTwoGradientSeparate=function createByRandomTwoGradientSeparate(gradientXMin,gradientXMax,gradientYMin,gradientYMax,gradientZMin,gradientZMax){var gradientSize=new GradientSize();gradientSize._type=2;gradientSize._separateAxes=true;gradientSize._gradientXMin=gradientXMin;gradientSize._gradientXMax=gradientXMax;gradientSize._gradientYMin=gradientYMin;gradientSize._gradientYMax=gradientYMax;gradientSize._gradientZMin=gradientZMin;gradientSize._gradientZMax=gradientZMax;return gradientSize;};var _proto133=GradientSize.prototype;_proto133.getMaxSizeInGradient=function getMaxSizeInGradient(meshMode){if(meshMode===void 0){meshMode=false;}var i,n;var maxSize=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(i=0,n=this._gradientX.gradientCount;i<n;i++){maxSize=Math.max(maxSize,this._gradientX.getValueByIndex(i));}for(i=0,n=this._gradientY.gradientCount;i<n;i++){maxSize=Math.max(maxSize,this._gradientY.getValueByIndex(i));}if(meshMode){for(i=0,n=this._gradientZ.gradientCount;i<n;i++){maxSize=Math.max(maxSize,this._gradientZ.getValueByIndex(i));}}}else {for(i=0,n=this._gradient.gradientCount;i<n;i++){maxSize=Math.max(maxSize,this._gradient.getValueByIndex(i));}}break;case 1:if(this._separateAxes){maxSize=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x);maxSize=Math.max(maxSize,this._constantMinSeparate.y);if(meshMode){maxSize=maxSize=Math.max(maxSize,this._constantMaxSeparate.z);}}else {maxSize=Math.max(this._constantMin,this._constantMax);}break;case 2:if(this._separateAxes){for(i=0,n=this._gradientXMin.gradientCount;i<n;i++){maxSize=Math.max(maxSize,this._gradientXMin.getValueByIndex(i));}for(i=0,n=this._gradientXMax.gradientCount;i<n;i++){maxSize=Math.max(maxSize,this._gradientXMax.getValueByIndex(i));}for(i=0,n=this._gradientYMin.gradientCount;i<n;i++){maxSize=Math.max(maxSize,this._gradientYMin.getValueByIndex(i));}for(i=0,n=this._gradientZMax.gradientCount;i<n;i++){maxSize=Math.max(maxSize,this._gradientZMax.getValueByIndex(i));}if(meshMode){for(i=0,n=this._gradientZMin.gradientCount;i<n;i++){maxSize=Math.max(maxSize,this._gradientZMin.getValueByIndex(i));}for(i=0,n=this._gradientZMax.gradientCount;i<n;i++){maxSize=Math.max(maxSize,this._gradientZMax.getValueByIndex(i));}}}else {for(i=0,n=this._gradientMin.gradientCount;i<n;i++){maxSize=Math.max(maxSize,this._gradientMin.getValueByIndex(i));}for(i=0,n=this._gradientMax.gradientCount;i<n;i++){maxSize=Math.max(maxSize,this._gradientMax.getValueByIndex(i));}}break;}return maxSize;};_proto133.cloneTo=function cloneTo(destObject){var destGradientSize=destObject;destGradientSize._type=this._type;destGradientSize._separateAxes=this._separateAxes;this._gradient.cloneTo(destGradientSize._gradient);this._gradientX.cloneTo(destGradientSize._gradientX);this._gradientY.cloneTo(destGradientSize._gradientY);this._gradientZ.cloneTo(destGradientSize._gradientZ);destGradientSize._constantMin=this._constantMin;destGradientSize._constantMax=this._constantMax;this._constantMinSeparate.cloneTo(destGradientSize._constantMinSeparate);this._constantMaxSeparate.cloneTo(destGradientSize._constantMaxSeparate);this._gradientMin.cloneTo(destGradientSize._gradientMin);this._gradientMax.cloneTo(destGradientSize._gradientMax);this._gradientXMin.cloneTo(destGradientSize._gradientXMin);this._gradientXMax.cloneTo(destGradientSize._gradientXMax);this._gradientYMin.cloneTo(destGradientSize._gradientYMin);this._gradientYMax.cloneTo(destGradientSize._gradientYMax);this._gradientZMin.cloneTo(destGradientSize._gradientZMin);this._gradientZMax.cloneTo(destGradientSize._gradientZMax);};_proto133.clone=function clone(){var destGradientSize=new GradientSize();this.cloneTo(destGradientSize);return destGradientSize;};_createClass(GradientSize,[{key:"type",get:function get(){return this._type;}},{key:"separateAxes",get:function get(){return this._separateAxes;}},{key:"gradient",get:function get(){return this._gradient;}},{key:"gradientX",get:function get(){return this._gradientX;}},{key:"gradientY",get:function get(){return this._gradientY;}},{key:"gradientZ",get:function get(){return this._gradientZ;}},{key:"constantMin",get:function get(){return this._constantMin;}},{key:"constantMax",get:function get(){return this._constantMax;}},{key:"constantMinSeparate",get:function get(){return this._constantMinSeparate;}},{key:"constantMaxSeparate",get:function get(){return this._constantMaxSeparate;}},{key:"gradientMin",get:function get(){return this._gradientMin;}},{key:"gradientMax",get:function get(){return this._gradientMax;}},{key:"gradientXMin",get:function get(){return this._gradientXMin;}},{key:"gradientXMax",get:function get(){return this._gradientXMax;}},{key:"gradientYMin",get:function get(){return this._gradientYMin;}},{key:"gradientYMax",get:function get(){return this._gradientYMax;}},{key:"gradientZMin",get:function get(){return this._gradientZMin;}},{key:"gradientZMax",get:function get(){return this._gradientZMax;}}]);return GradientSize;}();var GradientVelocity=/*#__PURE__*/function(){function GradientVelocity(){this._type=0;this._constant=null;this._gradientX=null;this._gradientY=null;this._gradientZ=null;this._constantMin=null;this._constantMax=null;this._gradientXMin=null;this._gradientXMax=null;this._gradientYMin=null;this._gradientYMax=null;this._gradientZMin=null;this._gradientZMax=null;}GradientVelocity.createByConstant=function createByConstant(constant){var gradientVelocity=new GradientVelocity();gradientVelocity._type=0;gradientVelocity._constant=constant;return gradientVelocity;};GradientVelocity.createByGradient=function createByGradient(gradientX,gradientY,gradientZ){var gradientVelocity=new GradientVelocity();gradientVelocity._type=1;gradientVelocity._gradientX=gradientX;gradientVelocity._gradientY=gradientY;gradientVelocity._gradientZ=gradientZ;return gradientVelocity;};GradientVelocity.createByRandomTwoConstant=function createByRandomTwoConstant(constantMin,constantMax){var gradientVelocity=new GradientVelocity();gradientVelocity._type=2;gradientVelocity._constantMin=constantMin;gradientVelocity._constantMax=constantMax;return gradientVelocity;};GradientVelocity.createByRandomTwoGradient=function createByRandomTwoGradient(gradientXMin,gradientXMax,gradientYMin,gradientYMax,gradientZMin,gradientZMax){var gradientVelocity=new GradientVelocity();gradientVelocity._type=3;gradientVelocity._gradientXMin=gradientXMin;gradientVelocity._gradientXMax=gradientXMax;gradientVelocity._gradientYMin=gradientYMin;gradientVelocity._gradientYMax=gradientYMax;gradientVelocity._gradientZMin=gradientZMin;gradientVelocity._gradientZMax=gradientZMax;return gradientVelocity;};var _proto134=GradientVelocity.prototype;_proto134.cloneTo=function cloneTo(destObject){var destGradientVelocity=destObject;destGradientVelocity._type=this._type;this._constant.cloneTo(destGradientVelocity._constant);this._gradientX.cloneTo(destGradientVelocity._gradientX);this._gradientY.cloneTo(destGradientVelocity._gradientY);this._gradientZ.cloneTo(destGradientVelocity._gradientZ);this._constantMin.cloneTo(destGradientVelocity._constantMin);this._constantMax.cloneTo(destGradientVelocity._constantMax);this._gradientXMin.cloneTo(destGradientVelocity._gradientXMin);this._gradientXMax.cloneTo(destGradientVelocity._gradientXMax);this._gradientYMin.cloneTo(destGradientVelocity._gradientYMin);this._gradientYMax.cloneTo(destGradientVelocity._gradientYMax);this._gradientZMin.cloneTo(destGradientVelocity._gradientZMin);this._gradientZMax.cloneTo(destGradientVelocity._gradientZMax);};_proto134.clone=function clone(){var destGradientVelocity=new GradientVelocity();this.cloneTo(destGradientVelocity);return destGradientVelocity;};_createClass(GradientVelocity,[{key:"type",get:function get(){return this._type;}},{key:"constant",get:function get(){return this._constant;}},{key:"gradientX",get:function get(){return this._gradientX;}},{key:"gradientY",get:function get(){return this._gradientY;}},{key:"gradientZ",get:function get(){return this._gradientZ;}},{key:"constantMin",get:function get(){return this._constantMin;}},{key:"constantMax",get:function get(){return this._constantMax;}},{key:"gradientXMin",get:function get(){return this._gradientXMin;}},{key:"gradientXMax",get:function get(){return this._gradientXMax;}},{key:"gradientYMin",get:function get(){return this._gradientYMin;}},{key:"gradientYMax",get:function get(){return this._gradientYMax;}},{key:"gradientZMin",get:function get(){return this._gradientZMin;}},{key:"gradientZMax",get:function get(){return this._gradientZMax;}}]);return GradientVelocity;}();var RotationOverLifetime=/*#__PURE__*/function(){function RotationOverLifetime(angularVelocity){this._angularVelocity=angularVelocity;}var _proto135=RotationOverLifetime.prototype;_proto135.cloneTo=function cloneTo(destObject){var destRotationOverLifetime=destObject;this._angularVelocity.cloneTo(destRotationOverLifetime._angularVelocity);destRotationOverLifetime.enable=this.enable;};_proto135.clone=function clone(){var destAngularVelocity;switch(this._angularVelocity.type){case 0:if(this._angularVelocity.separateAxes)destAngularVelocity=GradientAngularVelocity.createByConstantSeparate(this._angularVelocity.constantSeparate.clone());else destAngularVelocity=GradientAngularVelocity.createByConstant(this._angularVelocity.constant);break;case 1:if(this._angularVelocity.separateAxes)destAngularVelocity=GradientAngularVelocity.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone());else destAngularVelocity=GradientAngularVelocity.createByGradient(this._angularVelocity.gradient.clone());break;case 2:if(this._angularVelocity.separateAxes)destAngularVelocity=GradientAngularVelocity.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone());else destAngularVelocity=GradientAngularVelocity.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:if(this._angularVelocity.separateAxes)destAngularVelocity=GradientAngularVelocity.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone());else destAngularVelocity=GradientAngularVelocity.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone());break;}var destRotationOverLifetime=new RotationOverLifetime(destAngularVelocity);destRotationOverLifetime.enable=this.enable;return destRotationOverLifetime;};_createClass(RotationOverLifetime,[{key:"angularVelocity",get:function get(){return this._angularVelocity;}}]);return RotationOverLifetime;}();(function(ParticleSystemShapeType){ParticleSystemShapeType[ParticleSystemShapeType["Box"]=0]="Box";ParticleSystemShapeType[ParticleSystemShapeType["Circle"]=1]="Circle";ParticleSystemShapeType[ParticleSystemShapeType["Cone"]=2]="Cone";ParticleSystemShapeType[ParticleSystemShapeType["Hemisphere"]=3]="Hemisphere";ParticleSystemShapeType[ParticleSystemShapeType["Sphere"]=4]="Sphere";})(exports.ParticleSystemShapeType||(exports.ParticleSystemShapeType={}));var BaseShape=/*#__PURE__*/function(){function BaseShape(){this.enable=true;this.randomDirection=0;}var _proto136=BaseShape.prototype;_proto136._getShapeBoundBox=function _getShapeBoundBox(boundBox){throw new Error("BaseShape: must override it.");};_proto136._getSpeedBoundBox=function _getSpeedBoundBox(boundBox){throw new Error("BaseShape: must override it.");};_proto136.generatePositionAndDirection=function generatePositionAndDirection(position,direction,rand,randomSeeds){throw new Error("BaseShape: must override it.");};_proto136._calculateProceduralBounds=function _calculateProceduralBounds(boundBox,emitterPosScale,minMaxBounds){this._getShapeBoundBox(boundBox);var min=boundBox.min;var max=boundBox.max;Vector3.multiply(min,emitterPosScale,min);Vector3.multiply(max,emitterPosScale,max);var speedBounds=new BoundBox(new Vector3(),new Vector3());if(this.randomDirection){speedBounds.min=new Vector3(-1,-1,-1);speedBounds.max=new Vector3(1,1,1);}else {this._getSpeedBoundBox(speedBounds);}var maxSpeedBound=new BoundBox(new Vector3(),new Vector3());var maxSpeedMin=maxSpeedBound.min;var maxSpeedMax=maxSpeedBound.max;Vector3.scale(speedBounds.min,minMaxBounds.y,maxSpeedMin);Vector3.scale(speedBounds.max,minMaxBounds.y,maxSpeedMax);Vector3.add(boundBox.min,maxSpeedMin,maxSpeedMin);Vector3.add(boundBox.max,maxSpeedMax,maxSpeedMax);Vector3.min(boundBox.min,maxSpeedMin,boundBox.min);Vector3.max(boundBox.max,maxSpeedMin,boundBox.max);var minSpeedBound=new BoundBox(new Vector3(),new Vector3());var minSpeedMin=minSpeedBound.min;var minSpeedMax=minSpeedBound.max;Vector3.scale(speedBounds.min,minMaxBounds.x,minSpeedMin);Vector3.scale(speedBounds.max,minMaxBounds.x,minSpeedMax);Vector3.min(minSpeedBound.min,minSpeedMax,maxSpeedMin);Vector3.max(minSpeedBound.min,minSpeedMax,maxSpeedMax);Vector3.min(boundBox.min,maxSpeedMin,boundBox.min);Vector3.max(boundBox.max,maxSpeedMin,boundBox.max);};_proto136.cloneTo=function cloneTo(destObject){var destShape=destObject;destShape.enable=this.enable;};_proto136.clone=function clone(){var destShape=new BaseShape();this.cloneTo(destShape);return destShape;};return BaseShape;}();var ShapeUtils=/*#__PURE__*/function(){ShapeUtils._randomPointUnitArcCircle=function _randomPointUnitArcCircle(arc,out,rand){if(rand===void 0){rand=null;}var angle;if(rand)angle=rand.getFloat()*arc;else angle=Math.random()*arc;out.x=Math.cos(angle);out.y=Math.sin(angle);};ShapeUtils._randomPointInsideUnitArcCircle=function _randomPointInsideUnitArcCircle(arc,out,rand){if(rand===void 0){rand=null;}ShapeUtils._randomPointUnitArcCircle(arc,out,rand);var range;if(rand)range=Math.pow(rand.getFloat(),1.0/2.0);else range=Math.pow(Math.random(),1.0/2.0);out.x=out.x*range;out.y=out.y*range;};ShapeUtils._randomPointUnitCircle=function _randomPointUnitCircle(out,rand){if(rand===void 0){rand=null;}var angle;if(rand)angle=rand.getFloat()*Math.PI*2;else angle=Math.random()*Math.PI*2;out.x=Math.cos(angle);out.y=Math.sin(angle);};ShapeUtils._randomPointInsideUnitCircle=function _randomPointInsideUnitCircle(out,rand){if(rand===void 0){rand=null;}ShapeUtils._randomPointUnitCircle(out);var range;if(rand)range=Math.pow(rand.getFloat(),1.0/2.0);else range=Math.pow(Math.random(),1.0/2.0);out.x=out.x*range;out.y=out.y*range;};ShapeUtils._randomPointUnitSphere=function _randomPointUnitSphere(out,rand){if(rand===void 0){rand=null;}var z;var a;if(rand){z=out.z=rand.getFloat()*2-1.0;a=rand.getFloat()*Math.PI*2;}else {z=out.z=Math.random()*2-1.0;a=Math.random()*Math.PI*2;}var r=Math.sqrt(1.0-z*z);out.x=r*Math.cos(a);out.y=r*Math.sin(a);};ShapeUtils._randomPointInsideUnitSphere=function _randomPointInsideUnitSphere(out,rand){if(rand===void 0){rand=null;}ShapeUtils._randomPointUnitSphere(out);var range;if(rand)range=Math.pow(rand.getFloat(),1.0/3.0);else range=Math.pow(Math.random(),1.0/3.0);out.x=out.x*range;out.y=out.y*range;out.z=out.z*range;};ShapeUtils._randomPointInsideHalfUnitBox=function _randomPointInsideHalfUnitBox(out,rand){if(rand===void 0){rand=null;}if(rand){out.x=rand.getFloat()-0.5;out.y=rand.getFloat()-0.5;out.z=rand.getFloat()-0.5;}else {out.x=Math.random()-0.5;out.y=Math.random()-0.5;out.z=Math.random()-0.5;}};function ShapeUtils(){}return ShapeUtils;}();var BoxShape=/*#__PURE__*/function(_BaseShape){_inheritsLoose(BoxShape,_BaseShape);function BoxShape(){var _this63;_this63=_BaseShape.call(this)||this;_this63.shapeType=exports.ParticleSystemShapeType.Box;_this63.x=1.0;_this63.y=1.0;_this63.z=1.0;return _this63;}var _proto137=BoxShape.prototype;_proto137._getShapeBoundBox=function _getShapeBoundBox(boundBox){var min=boundBox.min;min.x=-this.x*0.5;min.y=-this.y*0.5;min.z=-this.z*0.5;var max=boundBox.max;max.x=this.x*0.5;max.y=this.y*0.5;max.z=this.z*0.5;};_proto137._getSpeedBoundBox=function _getSpeedBoundBox(boundBox){var min=boundBox.min;min.x=0.0;min.y=0.0;min.z=0.0;var max=boundBox.max;max.x=0.0;max.y=1.0;max.z=0.0;};_proto137.generatePositionAndDirection=function generatePositionAndDirection(position,direction,rand,randomSeeds){if(rand===void 0){rand=null;}if(randomSeeds===void 0){randomSeeds=null;}if(rand){rand.seed=randomSeeds[16];ShapeUtils._randomPointInsideHalfUnitBox(position,rand);randomSeeds[16]=rand.seed;}else {ShapeUtils._randomPointInsideHalfUnitBox(position);}position.x=this.x*position.x;position.y=this.y*position.y;position.z=this.z*position.z;if(this.randomDirection){if(rand){rand.seed=randomSeeds[17];ShapeUtils._randomPointUnitSphere(direction,rand);randomSeeds[17]=rand.seed;}else {ShapeUtils._randomPointUnitSphere(direction);}}else {direction.x=0.0;direction.y=0.0;direction.z=1.0;}};_proto137.cloneTo=function cloneTo(destObject){_BaseShape.prototype.cloneTo.call(this,destObject);var destShape=destObject;destShape.x=this.x;destShape.y=this.y;destShape.z=this.z;destShape.randomDirection=this.randomDirection;};_proto137.clone=function clone(){var destShape=new BoxShape();this.cloneTo(destShape);return destShape;};return BoxShape;}(BaseShape);var CircleShape=/*#__PURE__*/function(_BaseShape2){_inheritsLoose(CircleShape,_BaseShape2);function CircleShape(){var _this64;_this64=_BaseShape2.call(this)||this;_this64.shapeType=exports.ParticleSystemShapeType.Circle;_this64.radius=1.0;_this64.arc=360.0/180.0*Math.PI;_this64.emitFromEdge=false;return _this64;}var _proto138=CircleShape.prototype;_proto138._getShapeBoundBox=function _getShapeBoundBox(boundBox){var min=boundBox.min;min.x=min.z=-this.radius;min.y=0;var max=boundBox.max;max.x=max.z=this.radius;max.y=0;};_proto138._getSpeedBoundBox=function _getSpeedBoundBox(boundBox){var min=boundBox.min;min.x=min.y=-1;min.z=0;var max=boundBox.max;max.x=max.y=1;max.z=0;};_proto138.generatePositionAndDirection=function generatePositionAndDirection(position,direction,rand,randomSeeds){if(rand===void 0){rand=null;}if(randomSeeds===void 0){randomSeeds=null;}var positionPoint=CircleShape._tempPositionPoint;if(rand){rand.seed=randomSeeds[16];if(this.emitFromEdge)ShapeUtils._randomPointUnitArcCircle(this.arc,CircleShape._tempPositionPoint,rand);else ShapeUtils._randomPointInsideUnitArcCircle(this.arc,CircleShape._tempPositionPoint,rand);randomSeeds[16]=rand.seed;}else {if(this.emitFromEdge)ShapeUtils._randomPointUnitArcCircle(this.arc,CircleShape._tempPositionPoint);else ShapeUtils._randomPointInsideUnitArcCircle(this.arc,CircleShape._tempPositionPoint);}position.x=-positionPoint.x;position.y=positionPoint.y;position.z=0;Vector3.scale(position,this.radius,position);if(this.randomDirection){if(rand){rand.seed=randomSeeds[17];ShapeUtils._randomPointUnitSphere(direction,rand);randomSeeds[17]=rand.seed;}else {ShapeUtils._randomPointUnitSphere(direction);}}else {position.cloneTo(direction);}};_proto138.cloneTo=function cloneTo(destObject){_BaseShape2.prototype.cloneTo.call(this,destObject);var destShape=destObject;destShape.radius=this.radius;destShape.arc=this.arc;destShape.emitFromEdge=this.emitFromEdge;destShape.randomDirection=this.randomDirection;};_proto138.clone=function clone(){var destShape=new CircleShape();this.cloneTo(destShape);return destShape;};return CircleShape;}(BaseShape);CircleShape._tempPositionPoint=new Vector2();var ConeShape=/*#__PURE__*/function(_BaseShape3){_inheritsLoose(ConeShape,_BaseShape3);function ConeShape(){var _this65;_this65=_BaseShape3.call(this)||this;_this65.shapeType=exports.ParticleSystemShapeType.Cone;_this65.angle=25.0/180.0*Math.PI;_this65.radius=1.0;_this65.length=5.0;_this65.emitType=0;return _this65;}var _proto139=ConeShape.prototype;_proto139._getShapeBoundBox=function _getShapeBoundBox(boundBox){var coneRadius2=this.radius+this.length*Math.sin(this.angle);var coneLength=this.length*Math.cos(this.angle);var min=boundBox.min;min.x=min.y=-coneRadius2;min.z=0;var max=boundBox.max;max.x=max.y=coneRadius2;max.z=coneLength;};_proto139._getSpeedBoundBox=function _getSpeedBoundBox(boundBox){var sinA=Math.sin(this.angle);var min=boundBox.min;min.x=min.y=-sinA;min.z=0;var max=boundBox.max;max.x=max.y=sinA;max.z=1;};_proto139.generatePositionAndDirection=function generatePositionAndDirection(position,direction,rand,randomSeeds){if(rand===void 0){rand=null;}if(randomSeeds===void 0){randomSeeds=null;}var positionPointE=ConeShape._tempPositionPoint;var positionX;var positionY;var directionPointE;var dirCosA=Math.cos(this.angle);var dirSinA=Math.sin(this.angle);switch(this.emitType){case 0:if(rand){rand.seed=randomSeeds[16];ShapeUtils._randomPointInsideUnitCircle(ConeShape._tempPositionPoint,rand);randomSeeds[16]=rand.seed;}else {ShapeUtils._randomPointInsideUnitCircle(ConeShape._tempPositionPoint);}positionX=positionPointE.x;positionY=positionPointE.y;position.x=positionX*this.radius;position.y=positionY*this.radius;position.z=0;if(this.randomDirection){if(rand){rand.seed=randomSeeds[17];ShapeUtils._randomPointInsideUnitCircle(ConeShape._tempDirectionPoint,rand);randomSeeds[17]=rand.seed;}else {ShapeUtils._randomPointInsideUnitCircle(ConeShape._tempDirectionPoint);}directionPointE=ConeShape._tempDirectionPoint;direction.x=directionPointE.x*dirSinA;direction.y=directionPointE.y*dirSinA;}else {direction.x=positionX*dirSinA;direction.y=positionY*dirSinA;}direction.z=dirCosA;break;case 1:if(rand){rand.seed=randomSeeds[16];ShapeUtils._randomPointUnitCircle(ConeShape._tempPositionPoint,rand);randomSeeds[16]=rand.seed;}else {ShapeUtils._randomPointUnitCircle(ConeShape._tempPositionPoint);}positionX=positionPointE.x;positionY=positionPointE.y;position.x=positionX*this.radius;position.y=positionY*this.radius;position.z=0;if(this.randomDirection){if(rand){rand.seed=randomSeeds[17];ShapeUtils._randomPointInsideUnitCircle(ConeShape._tempDirectionPoint,rand);randomSeeds[17]=rand.seed;}else {ShapeUtils._randomPointInsideUnitCircle(ConeShape._tempDirectionPoint);}directionPointE=ConeShape._tempDirectionPoint;direction.x=directionPointE.x*dirSinA;direction.y=directionPointE.y*dirSinA;}else {direction.x=positionX*dirSinA;direction.y=positionY*dirSinA;}direction.z=dirCosA;break;case 2:if(rand){rand.seed=randomSeeds[16];ShapeUtils._randomPointInsideUnitCircle(ConeShape._tempPositionPoint,rand);}else {ShapeUtils._randomPointInsideUnitCircle(ConeShape._tempPositionPoint);}positionX=positionPointE.x;positionY=positionPointE.y;position.x=positionX*this.radius;position.y=positionY*this.radius;position.z=0;direction.x=positionX*dirSinA;direction.y=positionY*dirSinA;direction.z=dirCosA;Vector3.normalize(direction,direction);if(rand){Vector3.scale(direction,this.length*rand.getFloat(),direction);randomSeeds[16]=rand.seed;}else {Vector3.scale(direction,this.length*Math.random(),direction);}Vector3.add(position,direction,position);if(this.randomDirection){if(rand){rand.seed=randomSeeds[17];ShapeUtils._randomPointUnitSphere(direction,rand);randomSeeds[17]=rand.seed;}else {ShapeUtils._randomPointUnitSphere(direction);}}break;case 3:if(rand){rand.seed=randomSeeds[16];ShapeUtils._randomPointUnitCircle(ConeShape._tempPositionPoint,rand);}else {ShapeUtils._randomPointUnitCircle(ConeShape._tempPositionPoint);}positionX=positionPointE.x;positionY=positionPointE.y;position.x=positionX*this.radius;position.y=positionY*this.radius;position.z=0;direction.x=positionX*dirSinA;direction.y=positionY*dirSinA;direction.z=dirCosA;Vector3.normalize(direction,direction);if(rand){Vector3.scale(direction,this.length*rand.getFloat(),direction);randomSeeds[16]=rand.seed;}else {Vector3.scale(direction,this.length*Math.random(),direction);}Vector3.add(position,direction,position);if(this.randomDirection){if(rand){rand.seed=randomSeeds[17];ShapeUtils._randomPointUnitSphere(direction,rand);randomSeeds[17]=rand.seed;}else {ShapeUtils._randomPointUnitSphere(direction);}}break;default:throw new Error("ConeShape:emitType is invalid.");}};_proto139.cloneTo=function cloneTo(destObject){_BaseShape3.prototype.cloneTo.call(this,destObject);var destShape=destObject;destShape.angle=this.angle;destShape.radius=this.radius;destShape.length=this.length;destShape.emitType=this.emitType;destShape.randomDirection=this.randomDirection;};_proto139.clone=function clone(){var destShape=new ConeShape();this.cloneTo(destShape);return destShape;};return ConeShape;}(BaseShape);ConeShape._tempPositionPoint=new Vector2();ConeShape._tempDirectionPoint=new Vector2();var HemisphereShape=/*#__PURE__*/function(_BaseShape4){_inheritsLoose(HemisphereShape,_BaseShape4);function HemisphereShape(){var _this66;_this66=_BaseShape4.call(this)||this;_this66.shapeType=exports.ParticleSystemShapeType.Hemisphere;_this66.radius=1.0;_this66.emitFromShell=false;return _this66;}var _proto140=HemisphereShape.prototype;_proto140._getShapeBoundBox=function _getShapeBoundBox(boundBox){var min=boundBox.min;min.x=min.y=min.z=-this.radius;var max=boundBox.max;max.x=max.y=this.radius;max.z=0;};_proto140._getSpeedBoundBox=function _getSpeedBoundBox(boundBox){var min=boundBox.min;min.x=min.y=-1;min.z=0;var max=boundBox.max;max.x=max.y=max.z=1;};_proto140.generatePositionAndDirection=function generatePositionAndDirection(position,direction,rand,randomSeeds){if(rand===void 0){rand=null;}if(randomSeeds===void 0){randomSeeds=null;}if(rand){rand.seed=randomSeeds[16];if(this.emitFromShell)ShapeUtils._randomPointUnitSphere(position,rand);else ShapeUtils._randomPointInsideUnitSphere(position,rand);randomSeeds[16]=rand.seed;}else {if(this.emitFromShell)ShapeUtils._randomPointUnitSphere(position);else ShapeUtils._randomPointInsideUnitSphere(position);}Vector3.scale(position,this.radius,position);var z=position.z;z<0.0&&(position.z=z*-1.0);if(this.randomDirection){if(rand){rand.seed=randomSeeds[17];ShapeUtils._randomPointUnitSphere(direction,rand);randomSeeds[17]=rand.seed;}else {ShapeUtils._randomPointUnitSphere(direction);}}else {position.cloneTo(direction);}};_proto140.cloneTo=function cloneTo(destObject){_BaseShape4.prototype.cloneTo.call(this,destObject);var destShape=destObject;destShape.radius=this.radius;destShape.emitFromShell=this.emitFromShell;destShape.randomDirection=this.randomDirection;};_proto140.clone=function clone(){var destShape=new HemisphereShape();this.cloneTo(destShape);return destShape;};return HemisphereShape;}(BaseShape);var SphereShape=/*#__PURE__*/function(_BaseShape5){_inheritsLoose(SphereShape,_BaseShape5);function SphereShape(){var _this67;_this67=_BaseShape5.call(this)||this;_this67.shapeType=exports.ParticleSystemShapeType.Sphere;_this67.radius=1.0;_this67.emitFromShell=false;return _this67;}var _proto141=SphereShape.prototype;_proto141._getShapeBoundBox=function _getShapeBoundBox(boundBox){var min=boundBox.min;min.x=min.y=min.z=-this.radius;var max=boundBox.max;max.x=max.y=max.z=this.radius;};_proto141._getSpeedBoundBox=function _getSpeedBoundBox(boundBox){var min=boundBox.min;min.x=min.y=min.z=-1;var max=boundBox.max;max.x=max.y=max.z=1;};_proto141.generatePositionAndDirection=function generatePositionAndDirection(position,direction,rand,randomSeeds){if(rand===void 0){rand=null;}if(randomSeeds===void 0){randomSeeds=null;}if(rand){rand.seed=randomSeeds[16];if(this.emitFromShell)ShapeUtils._randomPointUnitSphere(position,rand);else ShapeUtils._randomPointInsideUnitSphere(position,rand);randomSeeds[16]=rand.seed;}else {if(this.emitFromShell)ShapeUtils._randomPointUnitSphere(position);else ShapeUtils._randomPointInsideUnitSphere(position);}Vector3.scale(position,this.radius,position);if(this.randomDirection){if(rand){rand.seed=randomSeeds[17];ShapeUtils._randomPointUnitSphere(direction,rand);randomSeeds[17]=rand.seed;}else {ShapeUtils._randomPointUnitSphere(direction);}}else {position.cloneTo(direction);}};_proto141.cloneTo=function cloneTo(destObject){_BaseShape5.prototype.cloneTo.call(this,destObject);var destShape=destObject;destShape.radius=this.radius;destShape.emitFromShell=this.emitFromShell;destShape.randomDirection=this.randomDirection;};_proto141.clone=function clone(){var destShape=new SphereShape();this.cloneTo(destShape);return destShape;};return SphereShape;}(BaseShape);var SizeOverLifetime=/*#__PURE__*/function(){function SizeOverLifetime(size){this._size=size;}var _proto142=SizeOverLifetime.prototype;_proto142.cloneTo=function cloneTo(destObject){var destSizeOverLifetime=destObject;this._size.cloneTo(destSizeOverLifetime._size);destSizeOverLifetime.enable=this.enable;};_proto142.clone=function clone(){var destSize;switch(this._size.type){case 0:if(this._size.separateAxes)destSize=GradientSize.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone());else destSize=GradientSize.createByGradient(this._size.gradient.clone());break;case 1:if(this._size.separateAxes)destSize=GradientSize.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone());else destSize=GradientSize.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:if(this._size.separateAxes)destSize=GradientSize.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone());else destSize=GradientSize.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone());break;}var destSizeOverLifetime=new SizeOverLifetime(destSize);destSizeOverLifetime.enable=this.enable;return destSizeOverLifetime;};_createClass(SizeOverLifetime,[{key:"size",get:function get(){return this._size;}}]);return SizeOverLifetime;}();var StartFrame=/*#__PURE__*/function(){function StartFrame(){this._type=0;this._constant=0;this._constantMin=0;this._constantMax=0;}StartFrame.createByConstant=function createByConstant(constant){if(constant===void 0){constant=0;}var rotationOverLifetime=new StartFrame();rotationOverLifetime._type=0;rotationOverLifetime._constant=constant;return rotationOverLifetime;};StartFrame.createByRandomTwoConstant=function createByRandomTwoConstant(constantMin,constantMax){if(constantMin===void 0){constantMin=0;}if(constantMax===void 0){constantMax=0;}var rotationOverLifetime=new StartFrame();rotationOverLifetime._type=1;rotationOverLifetime._constantMin=constantMin;rotationOverLifetime._constantMax=constantMax;return rotationOverLifetime;};var _proto143=StartFrame.prototype;_proto143.cloneTo=function cloneTo(destObject){var destStartFrame=destObject;destStartFrame._type=this._type;destStartFrame._constant=this._constant;destStartFrame._constantMin=this._constantMin;destStartFrame._constantMax=this._constantMax;};_proto143.clone=function clone(){var destStartFrame=new StartFrame();this.cloneTo(destStartFrame);return destStartFrame;};_createClass(StartFrame,[{key:"type",get:function get(){return this._type;}},{key:"constant",get:function get(){return this._constant;}},{key:"constantMin",get:function get(){return this._constantMin;}},{key:"constantMax",get:function get(){return this._constantMax;}}]);return StartFrame;}();var TextureSheetAnimation=/*#__PURE__*/function(){function TextureSheetAnimation(frame,startFrame){this.type=0;this.randomRow=false;this.rowIndex=0;this.cycles=0;this.enableUVChannels=0;this.enable=false;this.tiles=new Vector2(1,1);this.type=0;this.randomRow=true;this.rowIndex=0;this.cycles=1;this.enableUVChannels=1;this._frame=frame;this._startFrame=startFrame;}var _proto144=TextureSheetAnimation.prototype;_proto144.cloneTo=function cloneTo(destObject){var destTextureSheetAnimation=destObject;this.tiles.cloneTo(destTextureSheetAnimation.tiles);destTextureSheetAnimation.type=this.type;destTextureSheetAnimation.randomRow=this.randomRow;destTextureSheetAnimation.rowIndex=this.rowIndex;destTextureSheetAnimation.cycles=this.cycles;destTextureSheetAnimation.enableUVChannels=this.enableUVChannels;destTextureSheetAnimation.enable=this.enable;this._frame.cloneTo(destTextureSheetAnimation._frame);this._startFrame.cloneTo(destTextureSheetAnimation._startFrame);};_proto144.clone=function clone(){var destFrame;switch(this._frame.type){case 0:destFrame=FrameOverTime.createByConstant(this._frame.constant);break;case 1:destFrame=FrameOverTime.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:destFrame=FrameOverTime.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:destFrame=FrameOverTime.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone());break;}var destStartFrame;switch(this._startFrame.type){case 0:destStartFrame=StartFrame.createByConstant(this._startFrame.constant);break;case 1:destStartFrame=StartFrame.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax);break;}var destTextureSheetAnimation=new TextureSheetAnimation(destFrame,destStartFrame);this.cloneTo(destTextureSheetAnimation);return destTextureSheetAnimation;};_createClass(TextureSheetAnimation,[{key:"frame",get:function get(){return this._frame;}},{key:"startFrame",get:function get(){return this._startFrame;}}]);return TextureSheetAnimation;}();var VelocityOverLifetime=/*#__PURE__*/function(){function VelocityOverLifetime(velocity){this.enable=false;this.space=0;this._velocity=velocity;}var _proto145=VelocityOverLifetime.prototype;_proto145.cloneTo=function cloneTo(destObject){var destVelocityOverLifetime=destObject;this._velocity.cloneTo(destVelocityOverLifetime._velocity);destVelocityOverLifetime.enable=this.enable;destVelocityOverLifetime.space=this.space;};_proto145.clone=function clone(){var destVelocity;switch(this._velocity.type){case 0:destVelocity=GradientVelocity.createByConstant(this._velocity.constant.clone());break;case 1:destVelocity=GradientVelocity.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:destVelocity=GradientVelocity.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:destVelocity=GradientVelocity.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone());break;}var destVelocityOverLifetime=new VelocityOverLifetime(destVelocity);destVelocityOverLifetime.enable=this.enable;destVelocityOverLifetime.space=this.space;return destVelocityOverLifetime;};_createClass(VelocityOverLifetime,[{key:"velocity",get:function get(){return this._velocity;}}]);return VelocityOverLifetime;}();var ShuriKenParticle3DShaderDeclaration=function ShuriKenParticle3DShaderDeclaration(){};ShuriKenParticle3DShaderDeclaration.WORLDPOSITION=Shader3D.propertyNameToID("u_WorldPosition");ShuriKenParticle3DShaderDeclaration.WORLDROTATION=Shader3D.propertyNameToID("u_WorldRotation");ShuriKenParticle3DShaderDeclaration.POSITIONSCALE=Shader3D.propertyNameToID("u_PositionScale");ShuriKenParticle3DShaderDeclaration.SIZESCALE=Shader3D.propertyNameToID("u_SizeScale");ShuriKenParticle3DShaderDeclaration.SCALINGMODE=Shader3D.propertyNameToID("u_ScalingMode");ShuriKenParticle3DShaderDeclaration.GRAVITY=Shader3D.propertyNameToID("u_Gravity");ShuriKenParticle3DShaderDeclaration.THREEDSTARTROTATION=Shader3D.propertyNameToID("u_ThreeDStartRotation");ShuriKenParticle3DShaderDeclaration.STRETCHEDBILLBOARDLENGTHSCALE=Shader3D.propertyNameToID("u_StretchedBillboardLengthScale");ShuriKenParticle3DShaderDeclaration.STRETCHEDBILLBOARDSPEEDSCALE=Shader3D.propertyNameToID("u_StretchedBillboardSpeedScale");ShuriKenParticle3DShaderDeclaration.SIMULATIONSPACE=Shader3D.propertyNameToID("u_SimulationSpace");ShuriKenParticle3DShaderDeclaration.CURRENTTIME=Shader3D.propertyNameToID("u_CurrentTime");ShuriKenParticle3DShaderDeclaration.VOLVELOCITYCONST=Shader3D.propertyNameToID("u_VOLVelocityConst");ShuriKenParticle3DShaderDeclaration.VOLVELOCITYGRADIENTX=Shader3D.propertyNameToID("u_VOLVelocityGradientX");ShuriKenParticle3DShaderDeclaration.VOLVELOCITYGRADIENTY=Shader3D.propertyNameToID("u_VOLVelocityGradientY");ShuriKenParticle3DShaderDeclaration.VOLVELOCITYGRADIENTZ=Shader3D.propertyNameToID("u_VOLVelocityGradientZ");ShuriKenParticle3DShaderDeclaration.VOLVELOCITYCONSTMAX=Shader3D.propertyNameToID("u_VOLVelocityConstMax");ShuriKenParticle3DShaderDeclaration.VOLVELOCITYGRADIENTXMAX=Shader3D.propertyNameToID("u_VOLVelocityGradientMaxX");ShuriKenParticle3DShaderDeclaration.VOLVELOCITYGRADIENTYMAX=Shader3D.propertyNameToID("u_VOLVelocityGradientMaxY");ShuriKenParticle3DShaderDeclaration.VOLVELOCITYGRADIENTZMAX=Shader3D.propertyNameToID("u_VOLVelocityGradientMaxZ");ShuriKenParticle3DShaderDeclaration.VOLSPACETYPE=Shader3D.propertyNameToID("u_VOLSpaceType");ShuriKenParticle3DShaderDeclaration.COLOROVERLIFEGRADIENTALPHAS=Shader3D.propertyNameToID("u_ColorOverLifeGradientAlphas");ShuriKenParticle3DShaderDeclaration.COLOROVERLIFEGRADIENTCOLORS=Shader3D.propertyNameToID("u_ColorOverLifeGradientColors");ShuriKenParticle3DShaderDeclaration.MAXCOLOROVERLIFEGRADIENTALPHAS=Shader3D.propertyNameToID("u_MaxColorOverLifeGradientAlphas");ShuriKenParticle3DShaderDeclaration.MAXCOLOROVERLIFEGRADIENTCOLORS=Shader3D.propertyNameToID("u_MaxColorOverLifeGradientColors");ShuriKenParticle3DShaderDeclaration.SOLSIZEGRADIENT=Shader3D.propertyNameToID("u_SOLSizeGradient");ShuriKenParticle3DShaderDeclaration.SOLSIZEGRADIENTX=Shader3D.propertyNameToID("u_SOLSizeGradientX");ShuriKenParticle3DShaderDeclaration.SOLSIZEGRADIENTY=Shader3D.propertyNameToID("u_SOLSizeGradientY");ShuriKenParticle3DShaderDeclaration.SOLSizeGradientZ=Shader3D.propertyNameToID("u_SOLSizeGradientZ");ShuriKenParticle3DShaderDeclaration.SOLSizeGradientMax=Shader3D.propertyNameToID("u_SOLSizeGradientMax");ShuriKenParticle3DShaderDeclaration.SOLSIZEGRADIENTXMAX=Shader3D.propertyNameToID("u_SOLSizeGradientMaxX");ShuriKenParticle3DShaderDeclaration.SOLSIZEGRADIENTYMAX=Shader3D.propertyNameToID("u_SOLSizeGradientMaxY");ShuriKenParticle3DShaderDeclaration.SOLSizeGradientZMAX=Shader3D.propertyNameToID("u_SOLSizeGradientMaxZ");ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYCONST=Shader3D.propertyNameToID("u_ROLAngularVelocityConst");ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYCONSTSEPRARATE=Shader3D.propertyNameToID("u_ROLAngularVelocityConstSeprarate");ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENT=Shader3D.propertyNameToID("u_ROLAngularVelocityGradient");ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTX=Shader3D.propertyNameToID("u_ROLAngularVelocityGradientX");ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTY=Shader3D.propertyNameToID("u_ROLAngularVelocityGradientY");ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTZ=Shader3D.propertyNameToID("u_ROLAngularVelocityGradientZ");ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYCONSTMAX=Shader3D.propertyNameToID("u_ROLAngularVelocityConstMax");ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYCONSTMAXSEPRARATE=Shader3D.propertyNameToID("u_ROLAngularVelocityConstMaxSeprarate");ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTMAX=Shader3D.propertyNameToID("u_ROLAngularVelocityGradientMax");ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTXMAX=Shader3D.propertyNameToID("u_ROLAngularVelocityGradientMaxX");ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTYMAX=Shader3D.propertyNameToID("u_ROLAngularVelocityGradientMaxY");ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTZMAX=Shader3D.propertyNameToID("u_ROLAngularVelocityGradientMaxZ");ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTWMAX=Shader3D.propertyNameToID("u_ROLAngularVelocityGradientMaxW");ShuriKenParticle3DShaderDeclaration.TEXTURESHEETANIMATIONCYCLES=Shader3D.propertyNameToID("u_TSACycles");ShuriKenParticle3DShaderDeclaration.TEXTURESHEETANIMATIONSUBUVLENGTH=Shader3D.propertyNameToID("u_TSASubUVLength");ShuriKenParticle3DShaderDeclaration.TEXTURESHEETANIMATIONGRADIENTUVS=Shader3D.propertyNameToID("u_TSAGradientUVs");ShuriKenParticle3DShaderDeclaration.TEXTURESHEETANIMATIONGRADIENTMAXUVS=Shader3D.propertyNameToID("u_TSAMaxGradientUVs");var ShurikenParticleMaterial=/*#__PURE__*/function(_Material10){_inheritsLoose(ShurikenParticleMaterial,_Material10);function ShurikenParticleMaterial(){var _this68;_this68=_Material10.call(this)||this;_this68.setShaderName("PARTICLESHURIKEN");_this68._color=new Vector4(1.0,1.0,1.0,1.0);_this68.renderMode=ShurikenParticleMaterial.RENDERMODE_ALPHABLENDED;return _this68;}ShurikenParticleMaterial.__initDefine__=function __initDefine__(){ShurikenParticleMaterial.SHADERDEFINE_DIFFUSEMAP=Shader3D.getDefineByName("DIFFUSEMAP");ShurikenParticleMaterial.SHADERDEFINE_TINTCOLOR=Shader3D.getDefineByName("TINTCOLOR");ShurikenParticleMaterial.SHADERDEFINE_ADDTIVEFOG=Shader3D.getDefineByName("ADDTIVEFOG");ShurikenParticleMaterial.SHADERDEFINE_TILINGOFFSET=Shader3D.getDefineByName("TILINGOFFSET");};var _proto146=ShurikenParticleMaterial.prototype;_proto146.clone=function clone(){var dest=new ShurikenParticleMaterial();this.cloneTo(dest);return dest;};_createClass(ShurikenParticleMaterial,[{key:"_TintColor",get:function get(){return this.color;},set:function set(value){this.color=value;}},{key:"_TintColorR",get:function get(){return this._color.x;},set:function set(value){this._color.x=value;this.color=this._color;}},{key:"_TintColorG",get:function get(){return this._color.y;},set:function set(value){this._color.y=value;this.color=this._color;}},{key:"_TintColorB",get:function get(){return this._color.z;},set:function set(value){this._color.z=value;this.color=this._color;}},{key:"_TintColorA",get:function get(){return this._color.w;},set:function set(value){this._color.w=value;this.color=this._color;}},{key:"_MainTex_ST",get:function get(){return this._shaderValues.getVector(ShurikenParticleMaterial.TILINGOFFSET);},set:function set(value){var tilOff=this._shaderValues.getVector(ShurikenParticleMaterial.TILINGOFFSET);tilOff.setValue(value.x,value.y,value.z,value.w);this.tilingOffset=tilOff;}},{key:"_MainTex_STX",get:function get(){return this._shaderValues.getVector(ShurikenParticleMaterial.TILINGOFFSET).x;},set:function set(x){var tilOff=this._shaderValues.getVector(ShurikenParticleMaterial.TILINGOFFSET);tilOff.x=x;this.tilingOffset=tilOff;}},{key:"_MainTex_STY",get:function get(){return this._shaderValues.getVector(ShurikenParticleMaterial.TILINGOFFSET).y;},set:function set(y){var tilOff=this._shaderValues.getVector(ShurikenParticleMaterial.TILINGOFFSET);tilOff.y=y;this.tilingOffset=tilOff;}},{key:"_MainTex_STZ",get:function get(){return this._shaderValues.getVector(ShurikenParticleMaterial.TILINGOFFSET).z;},set:function set(z){var tilOff=this._shaderValues.getVector(ShurikenParticleMaterial.TILINGOFFSET);tilOff.z=z;this.tilingOffset=tilOff;}},{key:"_MainTex_STW",get:function get(){return this._shaderValues.getVector(ShurikenParticleMaterial.TILINGOFFSET).w;},set:function set(w){var tilOff=this._shaderValues.getVector(ShurikenParticleMaterial.TILINGOFFSET);tilOff.w=w;this.tilingOffset=tilOff;}},{key:"renderMode",set:function set(value){switch(value){case ShurikenParticleMaterial.RENDERMODE_ADDTIVE:this.renderQueue=Material.RENDERQUEUE_TRANSPARENT;this.depthWrite=false;this.cull=RenderState.CULL_NONE;this.blend=RenderState.BLEND_ENABLE_ALL;this.blendSrc=RenderState.BLENDPARAM_SRC_ALPHA;this.blendDst=RenderState.BLENDPARAM_ONE;this.alphaTest=false;this._shaderValues.addDefine(ShurikenParticleMaterial.SHADERDEFINE_ADDTIVEFOG);break;case ShurikenParticleMaterial.RENDERMODE_ALPHABLENDED:this.renderQueue=Material.RENDERQUEUE_TRANSPARENT;this.depthWrite=false;this.cull=RenderState.CULL_NONE;this.blend=RenderState.BLEND_ENABLE_ALL;this.blendSrc=RenderState.BLENDPARAM_SRC_ALPHA;this.blendDst=RenderState.BLENDPARAM_ONE_MINUS_SRC_ALPHA;this.alphaTest=false;this._shaderValues.removeDefine(ShurikenParticleMaterial.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("ShurikenParticleMaterial : renderMode value error.");}}},{key:"colorR",get:function get(){return this._TintColorR;},set:function set(value){this._TintColorR=value;}},{key:"colorG",get:function get(){return this._TintColorG;},set:function set(value){this._TintColorG=value;}},{key:"colorB",get:function get(){return this._TintColorB;},set:function set(value){this._TintColorB=value;}},{key:"colorA",get:function get(){return this._TintColorA;},set:function set(value){this._TintColorA=value;}},{key:"color",get:function get(){return this._shaderValues.getVector(ShurikenParticleMaterial.TINTCOLOR);},set:function set(value){if(value)this._shaderValues.addDefine(ShurikenParticleMaterial.SHADERDEFINE_TINTCOLOR);else this._shaderValues.removeDefine(ShurikenParticleMaterial.SHADERDEFINE_TINTCOLOR);this._shaderValues.setVector(ShurikenParticleMaterial.TINTCOLOR,value);}},{key:"tilingOffsetX",get:function get(){return this._MainTex_STX;},set:function set(x){this._MainTex_STX=x;}},{key:"tilingOffsetY",get:function get(){return this._MainTex_STY;},set:function set(y){this._MainTex_STY=y;}},{key:"tilingOffsetZ",get:function get(){return this._MainTex_STZ;},set:function set(z){this._MainTex_STZ=z;}},{key:"tilingOffsetW",get:function get(){return this._MainTex_STW;},set:function set(w){this._MainTex_STW=w;}},{key:"tilingOffset",get:function get(){return this._shaderValues.getVector(ShurikenParticleMaterial.TILINGOFFSET);},set:function set(value){if(value){if(value.x!=1||value.y!=1||value.z!=0||value.w!=0)this._shaderValues.addDefine(ShurikenParticleMaterial.SHADERDEFINE_TILINGOFFSET);else this._shaderValues.removeDefine(ShurikenParticleMaterial.SHADERDEFINE_TILINGOFFSET);}else {this._shaderValues.removeDefine(ShurikenParticleMaterial.SHADERDEFINE_TILINGOFFSET);}this._shaderValues.setVector(ShurikenParticleMaterial.TILINGOFFSET,value);}},{key:"texture",get:function get(){return this._shaderValues.getTexture(ShurikenParticleMaterial.DIFFUSETEXTURE);},set:function set(value){if(value)this._shaderValues.addDefine(ShurikenParticleMaterial.SHADERDEFINE_DIFFUSEMAP);else this._shaderValues.removeDefine(ShurikenParticleMaterial.SHADERDEFINE_DIFFUSEMAP);this._shaderValues.setTexture(ShurikenParticleMaterial.DIFFUSETEXTURE,value);}},{key:"depthWrite",get:function get(){return this._shaderValues.getBool(ShurikenParticleMaterial.DEPTH_WRITE);},set:function set(value){this._shaderValues.setBool(ShurikenParticleMaterial.DEPTH_WRITE,value);}},{key:"cull",get:function get(){return this._shaderValues.getInt(ShurikenParticleMaterial.CULL);},set:function set(value){this._shaderValues.setInt(ShurikenParticleMaterial.CULL,value);}},{key:"blend",get:function get(){return this._shaderValues.getInt(ShurikenParticleMaterial.BLEND);},set:function set(value){this._shaderValues.setInt(ShurikenParticleMaterial.BLEND,value);}},{key:"blendSrc",get:function get(){return this._shaderValues.getInt(ShurikenParticleMaterial.BLEND_SRC);},set:function set(value){this._shaderValues.setInt(ShurikenParticleMaterial.BLEND_SRC,value);}},{key:"blendDst",get:function get(){return this._shaderValues.getInt(ShurikenParticleMaterial.BLEND_DST);},set:function set(value){this._shaderValues.setInt(ShurikenParticleMaterial.BLEND_DST,value);}},{key:"depthTest",get:function get(){return this._shaderValues.getInt(ShurikenParticleMaterial.DEPTH_TEST);},set:function set(value){this._shaderValues.setInt(ShurikenParticleMaterial.DEPTH_TEST,value);}}]);return ShurikenParticleMaterial;}(Material);ShurikenParticleMaterial.RENDERMODE_ALPHABLENDED=0;ShurikenParticleMaterial.RENDERMODE_ADDTIVE=1;ShurikenParticleMaterial.DIFFUSETEXTURE=Shader3D.propertyNameToID("u_texture");ShurikenParticleMaterial.TINTCOLOR=Shader3D.propertyNameToID("u_Tintcolor");ShurikenParticleMaterial.TILINGOFFSET=Shader3D.propertyNameToID("u_TilingOffset");ShurikenParticleMaterial.CULL=Shader3D.propertyNameToID("s_Cull");ShurikenParticleMaterial.BLEND=Shader3D.propertyNameToID("s_Blend");ShurikenParticleMaterial.BLEND_SRC=Shader3D.propertyNameToID("s_BlendSrc");ShurikenParticleMaterial.BLEND_DST=Shader3D.propertyNameToID("s_BlendDst");ShurikenParticleMaterial.DEPTH_TEST=Shader3D.propertyNameToID("s_DepthTest");ShurikenParticleMaterial.DEPTH_WRITE=Shader3D.propertyNameToID("s_DepthWrite");var ShurikenParticleRenderer=/*#__PURE__*/function(_BaseRender3){_inheritsLoose(ShurikenParticleRenderer,_BaseRender3);function ShurikenParticleRenderer(owner){var _this69;_this69=_BaseRender3.call(this,owner)||this;_this69._finalGravity=new Vector3();_this69._tempRotationMatrix=new Matrix4x4();_this69._mesh=null;_this69.stretchedBillboardCameraSpeedScale=0;_this69.stretchedBillboardSpeedScale=0;_this69.stretchedBillboardLengthScale=2;_this69._defaultBoundBox=new BoundBox(new Vector3(),new Vector3());_this69.renderMode=0;_this69._supportOctree=false;return _this69;}var _proto147=ShurikenParticleRenderer.prototype;_proto147._calculateBoundingBox=function _calculateBoundingBox(){var particleSystem=this._owner.particleSystem;var bounds;if(particleSystem._useCustomBounds){bounds=particleSystem.customBounds;bounds._tranform(this._owner.transform.worldMatrix,this._bounds);}else if(particleSystem._simulationSupported()){particleSystem._generateBounds();bounds=particleSystem._bounds;bounds._tranform(this._owner.transform.worldMatrix,this._bounds);}else {var min=this._bounds.getMin();min.setValue(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);this._bounds.setMin(min);var max=this._bounds.getMax();max.setValue(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);this._bounds.setMax(max);}if(Laya.Render.supportWebGLPlusCulling){var min=this._bounds.getMin();var max=this._bounds.getMax();var buffer=FrustumCulling._cullingBuffer;buffer[this._cullingBufferIndex+1]=min.x;buffer[this._cullingBufferIndex+2]=min.y;buffer[this._cullingBufferIndex+3]=min.z;buffer[this._cullingBufferIndex+4]=max.x;buffer[this._cullingBufferIndex+5]=max.y;buffer[this._cullingBufferIndex+6]=max.z;}};_proto147._needRender=function _needRender(boundFrustum,context){if(boundFrustum){if(boundFrustum.intersects(this.bounds._getBoundBox())){if(this._owner.particleSystem.isAlive)return true;else return false;}else {return false;}}else {return true;}};_proto147._renderUpdate=function _renderUpdate(context,transfrom){var particleSystem=this._owner.particleSystem;var sv=this._shaderValues;var transform=this._owner.transform;switch(particleSystem.simulationSpace){case 0:break;case 1:sv.setVector3(ShuriKenParticle3DShaderDeclaration.WORLDPOSITION,transform.position);sv.setQuaternion(ShuriKenParticle3DShaderDeclaration.WORLDROTATION,transform.rotation);break;default:throw new Error("ShurikenParticleMaterial: SimulationSpace value is invalid.");}switch(particleSystem.scaleMode){case 0:var scale=transform.getWorldLossyScale();sv.setVector3(ShuriKenParticle3DShaderDeclaration.POSITIONSCALE,scale);sv.setVector3(ShuriKenParticle3DShaderDeclaration.SIZESCALE,scale);break;case 1:var localScale=transform.localScale;sv.setVector3(ShuriKenParticle3DShaderDeclaration.POSITIONSCALE,localScale);sv.setVector3(ShuriKenParticle3DShaderDeclaration.SIZESCALE,localScale);break;case 2:sv.setVector3(ShuriKenParticle3DShaderDeclaration.POSITIONSCALE,transform.getWorldLossyScale());sv.setVector3(ShuriKenParticle3DShaderDeclaration.SIZESCALE,Vector3._ONE);break;}Vector3.scale(Physics3DUtils.gravity,particleSystem.gravityModifier,this._finalGravity);sv.setVector3(ShuriKenParticle3DShaderDeclaration.GRAVITY,this._finalGravity);sv.setInt(ShuriKenParticle3DShaderDeclaration.SIMULATIONSPACE,particleSystem.simulationSpace);sv.setBool(ShuriKenParticle3DShaderDeclaration.THREEDSTARTROTATION,particleSystem.threeDStartRotation);sv.setInt(ShuriKenParticle3DShaderDeclaration.SCALINGMODE,particleSystem.scaleMode);sv.setNumber(ShuriKenParticle3DShaderDeclaration.STRETCHEDBILLBOARDLENGTHSCALE,this.stretchedBillboardLengthScale);sv.setNumber(ShuriKenParticle3DShaderDeclaration.STRETCHEDBILLBOARDSPEEDSCALE,this.stretchedBillboardSpeedScale);sv.setNumber(ShuriKenParticle3DShaderDeclaration.CURRENTTIME,particleSystem._currentTime);};_proto147._destroy=function _destroy(){_BaseRender3.prototype._destroy.call(this);this._mesh&&(this._mesh._removeReference(),this._mesh=null);};_createClass(ShurikenParticleRenderer,[{key:"renderMode",get:function get(){return this._renderMode;},set:function set(value){if(this._renderMode!==value){var defineDatas=this._shaderValues;switch(this._renderMode){case 0:defineDatas.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RENDERMODE_BILLBOARD);break;case 1:defineDatas.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RENDERMODE_STRETCHEDBILLBOARD);break;case 2:defineDatas.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RENDERMODE_HORIZONTALBILLBOARD);break;case 3:defineDatas.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RENDERMODE_VERTICALBILLBOARD);break;case 4:defineDatas.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RENDERMODE_MESH);break;}this._renderMode=value;switch(value){case 0:defineDatas.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RENDERMODE_BILLBOARD);break;case 1:defineDatas.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RENDERMODE_STRETCHEDBILLBOARD);break;case 2:defineDatas.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RENDERMODE_HORIZONTALBILLBOARD);break;case 3:defineDatas.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RENDERMODE_VERTICALBILLBOARD);break;case 4:defineDatas.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RENDERMODE_MESH);break;default:throw new Error("ShurikenParticleRender: unknown renderMode Value.");}var parSys=this._owner.particleSystem;parSys&&parSys._initBufferDatas();}}},{key:"mesh",get:function get(){return this._mesh;},set:function set(value){if(this._mesh!==value){this._mesh&&this._mesh._removeReference();this._mesh=value;value&&value._addReference();this._owner.particleSystem._initBufferDatas();}}},{key:"bounds",get:function get(){if(this._boundsChange){this._calculateBoundingBox();this._boundsChange=false;}return this._bounds;}}]);return ShurikenParticleRenderer;}(BaseRender);var VertexShuriKenParticle=function VertexShuriKenParticle(){};VertexShuriKenParticle.PARTICLE_CORNERTEXTURECOORDINATE0=5;VertexShuriKenParticle.PARTICLE_POSITION0=1;VertexShuriKenParticle.PARTICLE_COLOR0=2;VertexShuriKenParticle.PARTICLE_TEXTURECOORDINATE0=3;VertexShuriKenParticle.PARTICLE_SHAPEPOSITIONSTARTLIFETIME=4;VertexShuriKenParticle.PARTICLE_DIRECTIONTIME=0;VertexShuriKenParticle.PARTICLE_STARTCOLOR0=6;VertexShuriKenParticle.PARTICLE_ENDCOLOR0=7;VertexShuriKenParticle.PARTICLE_STARTSIZE=8;VertexShuriKenParticle.PARTICLE_STARTROTATION=9;VertexShuriKenParticle.PARTICLE_STARTSPEED=10;VertexShuriKenParticle.PARTICLE_RANDOM0=11;VertexShuriKenParticle.PARTICLE_RANDOM1=12;VertexShuriKenParticle.PARTICLE_SIMULATIONWORLDPOSTION=13;VertexShuriKenParticle.PARTICLE_SIMULATIONWORLDROTATION=14;var VertexShurikenParticleBillboard=/*#__PURE__*/function(_VertexShuriKenPartic){_inheritsLoose(VertexShurikenParticleBillboard,_VertexShuriKenPartic);function VertexShurikenParticleBillboard(cornerTextureCoordinate,positionStartLifeTime,velocity,startColor,startSize,startRotation0,startRotation1,startRotation2,ageAddScale,time,startSpeed,randoms0,randoms1,simulationWorldPostion){var _this70;_this70=_VertexShuriKenPartic.call(this)||this;_this70._cornerTextureCoordinate=cornerTextureCoordinate;_this70._positionStartLifeTime=positionStartLifeTime;_this70._velocity=velocity;_this70._startColor=startColor;_this70._startSize=startSize;_this70._startRotation0=startRotation0;_this70._startRotation1=startRotation1;_this70._startRotation2=startRotation2;_this70._startLifeTime=ageAddScale;_this70._time=time;_this70._startSpeed=startSpeed;_this70._randoms0=_this70.random0;_this70._randoms1=_this70.random1;_this70._simulationWorldPostion=simulationWorldPostion;return _this70;}VertexShurikenParticleBillboard.__init__=function __init__(){VertexShurikenParticleBillboard._vertexDeclaration=new VertexDeclaration(152,[new VertexElement(0,VertexElementFormat.Vector4,VertexShuriKenParticle.PARTICLE_CORNERTEXTURECOORDINATE0),new VertexElement(16,VertexElementFormat.Vector4,VertexShuriKenParticle.PARTICLE_SHAPEPOSITIONSTARTLIFETIME),new VertexElement(32,VertexElementFormat.Vector4,VertexShuriKenParticle.PARTICLE_DIRECTIONTIME),new VertexElement(48,VertexElementFormat.Vector4,VertexShuriKenParticle.PARTICLE_STARTCOLOR0),new VertexElement(64,VertexElementFormat.Vector3,VertexShuriKenParticle.PARTICLE_STARTSIZE),new VertexElement(76,VertexElementFormat.Vector3,VertexShuriKenParticle.PARTICLE_STARTROTATION),new VertexElement(88,VertexElementFormat.Single,VertexShuriKenParticle.PARTICLE_STARTSPEED),new VertexElement(92,VertexElementFormat.Vector4,VertexShuriKenParticle.PARTICLE_RANDOM0),new VertexElement(108,VertexElementFormat.Vector4,VertexShuriKenParticle.PARTICLE_RANDOM1),new VertexElement(124,VertexElementFormat.Vector3,VertexShuriKenParticle.PARTICLE_SIMULATIONWORLDPOSTION),new VertexElement(136,VertexElementFormat.Vector4,VertexShuriKenParticle.PARTICLE_SIMULATIONWORLDROTATION)]);};_createClass(VertexShurikenParticleBillboard,[{key:"cornerTextureCoordinate",get:function get(){return this._cornerTextureCoordinate;}},{key:"positionStartLifeTime",get:function get(){return this._positionStartLifeTime;}},{key:"velocity",get:function get(){return this._velocity;}},{key:"startColor",get:function get(){return this._startColor;}},{key:"startSize",get:function get(){return this._startSize;}},{key:"startRotation0",get:function get(){return this._startRotation0;}},{key:"startRotation1",get:function get(){return this._startRotation1;}},{key:"startRotation2",get:function get(){return this._startRotation2;}},{key:"startLifeTime",get:function get(){return this._startLifeTime;}},{key:"time",get:function get(){return this._time;}},{key:"startSpeed",get:function get(){return this._startSpeed;}},{key:"random0",get:function get(){return this._randoms0;}},{key:"random1",get:function get(){return this._randoms1;}},{key:"simulationWorldPostion",get:function get(){return this._simulationWorldPostion;}}],[{key:"vertexDeclaration",get:function get(){return VertexShurikenParticleBillboard._vertexDeclaration;}}]);return VertexShurikenParticleBillboard;}(VertexShuriKenParticle);var VertexShurikenParticleMesh=/*#__PURE__*/function(_VertexShuriKenPartic2){_inheritsLoose(VertexShurikenParticleMesh,_VertexShuriKenPartic2);function VertexShurikenParticleMesh(cornerTextureCoordinate,positionStartLifeTime,velocity,startColor,startSize,startRotation0,startRotation1,startRotation2,ageAddScale,time,startSpeed,randoms0,randoms1,simulationWorldPostion){var _this71;_this71=_VertexShuriKenPartic2.call(this)||this;_this71._cornerTextureCoordinate=cornerTextureCoordinate;_this71._positionStartLifeTime=positionStartLifeTime;_this71._velocity=velocity;_this71._startColor=startColor;_this71._startSize=startSize;_this71._startRotation0=startRotation0;_this71._startRotation1=startRotation1;_this71._startRotation2=startRotation2;_this71._startLifeTime=ageAddScale;_this71._time=time;_this71._startSpeed=startSpeed;_this71._randoms0=_this71.random0;_this71._randoms1=_this71.random1;_this71._simulationWorldPostion=simulationWorldPostion;return _this71;}VertexShurikenParticleMesh.__init__=function __init__(){VertexShurikenParticleMesh._vertexDeclaration=new VertexDeclaration(172,[new VertexElement(0,VertexElementFormat.Vector3,VertexShuriKenParticle.PARTICLE_POSITION0),new VertexElement(12,VertexElementFormat.Vector4,VertexShuriKenParticle.PARTICLE_COLOR0),new VertexElement(28,VertexElementFormat.Vector2,VertexShuriKenParticle.PARTICLE_TEXTURECOORDINATE0),new VertexElement(36,VertexElementFormat.Vector4,VertexShuriKenParticle.PARTICLE_SHAPEPOSITIONSTARTLIFETIME),new VertexElement(52,VertexElementFormat.Vector4,VertexShuriKenParticle.PARTICLE_DIRECTIONTIME),new VertexElement(68,VertexElementFormat.Vector4,VertexShuriKenParticle.PARTICLE_STARTCOLOR0),new VertexElement(84,VertexElementFormat.Vector3,VertexShuriKenParticle.PARTICLE_STARTSIZE),new VertexElement(96,VertexElementFormat.Vector3,VertexShuriKenParticle.PARTICLE_STARTROTATION),new VertexElement(108,VertexElementFormat.Single,VertexShuriKenParticle.PARTICLE_STARTSPEED),new VertexElement(112,VertexElementFormat.Vector4,VertexShuriKenParticle.PARTICLE_RANDOM0),new VertexElement(128,VertexElementFormat.Vector4,VertexShuriKenParticle.PARTICLE_RANDOM1),new VertexElement(144,VertexElementFormat.Vector3,VertexShuriKenParticle.PARTICLE_SIMULATIONWORLDPOSTION),new VertexElement(156,VertexElementFormat.Vector4,VertexShuriKenParticle.PARTICLE_SIMULATIONWORLDROTATION)]);};_createClass(VertexShurikenParticleMesh,[{key:"cornerTextureCoordinate",get:function get(){return this._cornerTextureCoordinate;}},{key:"position",get:function get(){return this._positionStartLifeTime;}},{key:"velocity",get:function get(){return this._velocity;}},{key:"startColor",get:function get(){return this._startColor;}},{key:"startSize",get:function get(){return this._startSize;}},{key:"startRotation0",get:function get(){return this._startRotation0;}},{key:"startRotation1",get:function get(){return this._startRotation1;}},{key:"startRotation2",get:function get(){return this._startRotation2;}},{key:"startLifeTime",get:function get(){return this._startLifeTime;}},{key:"time",get:function get(){return this._time;}},{key:"startSpeed",get:function get(){return this._startSpeed;}},{key:"random0",get:function get(){return this._randoms0;}},{key:"random1",get:function get(){return this._randoms1;}},{key:"simulationWorldPostion",get:function get(){return this._simulationWorldPostion;}}],[{key:"vertexDeclaration",get:function get(){return VertexShurikenParticleMesh._vertexDeclaration;}}]);return VertexShurikenParticleMesh;}(VertexShuriKenParticle);var Rand=/*#__PURE__*/function(){function Rand(seed){this._temp=new Uint32Array(1);this.seeds=new Uint32Array(4);this.seeds[0]=seed;this.seeds[1]=this.seeds[0]*0x6C078965+1;this.seeds[2]=this.seeds[1]*0x6C078965+1;this.seeds[3]=this.seeds[2]*0x6C078965+1;}Rand.getFloatFromInt=function getFloatFromInt(v){return (v&0x007FFFFF)*(1.0/8388607.0);};Rand.getByteFromInt=function getByteFromInt(v){return (v&0x007FFFFF)>>>15;};var _proto148=Rand.prototype;_proto148.getUint=function getUint(){this._temp[0]=this.seeds[0]^this.seeds[0]<<11;this.seeds[0]=this.seeds[1];this.seeds[1]=this.seeds[2];this.seeds[2]=this.seeds[3];this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^(this._temp[0]^this._temp[0]>>>8);return this.seeds[3];};_proto148.getFloat=function getFloat(){this.getUint();return (this.seeds[3]&0x007FFFFF)*(1.0/8388607.0);};_proto148.getSignedFloat=function getSignedFloat(){return this.getFloat()*2.0-1.0;};_createClass(Rand,[{key:"seed",get:function get(){return this.seeds[0];},set:function set(seed){this.seeds[0]=seed;this.seeds[1]=this.seeds[0]*0x6C078965+1;this.seeds[2]=this.seeds[1]*0x6C078965+1;this.seeds[3]=this.seeds[2]*0x6C078965+1;}}]);return Rand;}();var Emission=/*#__PURE__*/function(){function Emission(){this._emissionRate=10;this._destroyed=false;this._bursts=[];}var _proto149=Emission.prototype;_proto149.destroy=function destroy(){this._bursts=null;this._destroyed=true;};_proto149.getBurstsCount=function getBurstsCount(){return this._bursts.length;};_proto149.getBurstByIndex=function getBurstByIndex(index){return this._bursts[index];};_proto149.addBurst=function addBurst(burst){var burstsCount=this._bursts.length;if(burstsCount>0)for(var i=0;i<burstsCount;i++){if(this._bursts[i].time>burst.time)this._bursts.splice(i,0,burst);}this._bursts.push(burst);};_proto149.removeBurst=function removeBurst(burst){var index=this._bursts.indexOf(burst);if(index!==-1){this._bursts.splice(index,1);}};_proto149.removeBurstByIndex=function removeBurstByIndex(index){this._bursts.splice(index,1);};_proto149.clearBurst=function clearBurst(){this._bursts.length=0;};_proto149.cloneTo=function cloneTo(destObject){var destEmission=destObject;var destBursts=destEmission._bursts;destBursts.length=this._bursts.length;for(var i=0,n=this._bursts.length;i<n;i++){var destBurst=destBursts[i];if(destBurst)this._bursts[i].cloneTo(destBurst);else destBursts[i]=this._bursts[i].clone();}destEmission._emissionRate=this._emissionRate;destEmission.enable=this.enable;};_proto149.clone=function clone(){var destEmission=new Emission();this.cloneTo(destEmission);return destEmission;};_createClass(Emission,[{key:"emissionRate",set:function set(value){if(value<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=value;},get:function get(){return this._emissionRate;}},{key:"destroyed",get:function get(){return this._destroyed;}}]);return Emission;}();var ShurikenParticleData=/*#__PURE__*/function(){function ShurikenParticleData(){}ShurikenParticleData._getStartLifetimeFromGradient=function _getStartLifetimeFromGradient(startLifeTimeGradient,emissionTime){for(var i=1,n=startLifeTimeGradient.gradientCount;i<n;i++){var key=startLifeTimeGradient.getKeyByIndex(i);if(key>=emissionTime){var lastKey=startLifeTimeGradient.getKeyByIndex(i-1);var age=(emissionTime-lastKey)/(key-lastKey);return Laya.MathUtil.lerp(startLifeTimeGradient.getValueByIndex(i-1),startLifeTimeGradient.getValueByIndex(i),age);}}throw new Error("ShurikenParticleData: can't get value foam startLifeTimeGradient.");};ShurikenParticleData._randomInvertRoationArray=function _randomInvertRoationArray(rotatonE,outE,randomizeRotationDirection,rand,randomSeeds){var randDic;if(rand){rand.seed=randomSeeds[6];randDic=rand.getFloat();randomSeeds[6]=rand.seed;}else {randDic=Math.random();}if(randDic<randomizeRotationDirection){outE.x=-rotatonE.x;outE.y=-rotatonE.y;outE.z=-rotatonE.z;}else {outE.x=rotatonE.x;outE.y=rotatonE.y;outE.z=rotatonE.z;}};ShurikenParticleData._randomInvertRoation=function _randomInvertRoation(rotaton,randomizeRotationDirection,rand,randomSeeds){var randDic;if(rand){rand.seed=randomSeeds[6];randDic=rand.getFloat();randomSeeds[6]=rand.seed;}else {randDic=Math.random();}if(randDic<randomizeRotationDirection)rotaton=-rotaton;return rotaton;};ShurikenParticleData.create=function create(particleSystem,particleRender,transform){var autoRandomSeed=particleSystem.autoRandomSeed;var rand=particleSystem._rand;var randomSeeds=particleSystem._randomSeeds;switch(particleSystem.startColorType){case 0:var constantStartColor=particleSystem.startColorConstant;ShurikenParticleData.startColor.x=constantStartColor.x;ShurikenParticleData.startColor.y=constantStartColor.y;ShurikenParticleData.startColor.z=constantStartColor.z;ShurikenParticleData.startColor.w=constantStartColor.w;break;case 2:if(autoRandomSeed){Vector4.lerp(particleSystem.startColorConstantMin,particleSystem.startColorConstantMax,Math.random(),ShurikenParticleData.startColor);}else {rand.seed=randomSeeds[3];Vector4.lerp(particleSystem.startColorConstantMin,particleSystem.startColorConstantMax,rand.getFloat(),ShurikenParticleData.startColor);randomSeeds[3]=rand.seed;}break;}var colorOverLifetime=particleSystem.colorOverLifetime;if(colorOverLifetime&&colorOverLifetime.enable){var color=colorOverLifetime.color;switch(color.type){case 0:ShurikenParticleData.startColor.x=ShurikenParticleData.startColor.x*color.constant.x;ShurikenParticleData.startColor.y=ShurikenParticleData.startColor.y*color.constant.y;ShurikenParticleData.startColor.z=ShurikenParticleData.startColor.z*color.constant.z;ShurikenParticleData.startColor.w=ShurikenParticleData.startColor.w*color.constant.w;break;case 2:var colorRandom;if(autoRandomSeed){colorRandom=Math.random();}else {rand.seed=randomSeeds[10];colorRandom=rand.getFloat();randomSeeds[10]=rand.seed;}var minConstantColor=color.constantMin;var maxConstantColor=color.constantMax;ShurikenParticleData.startColor.x=ShurikenParticleData.startColor.x*Laya.MathUtil.lerp(minConstantColor.x,maxConstantColor.x,colorRandom);ShurikenParticleData.startColor.y=ShurikenParticleData.startColor.y*Laya.MathUtil.lerp(minConstantColor.y,maxConstantColor.y,colorRandom);ShurikenParticleData.startColor.z=ShurikenParticleData.startColor.z*Laya.MathUtil.lerp(minConstantColor.z,maxConstantColor.z,colorRandom);ShurikenParticleData.startColor.w=ShurikenParticleData.startColor.w*Laya.MathUtil.lerp(minConstantColor.w,maxConstantColor.w,colorRandom);break;}}var particleSize=ShurikenParticleData.startSize;switch(particleSystem.startSizeType){case 0:if(particleSystem.threeDStartSize){var startSizeConstantSeparate=particleSystem.startSizeConstantSeparate;particleSize[0]=startSizeConstantSeparate.x;particleSize[1]=startSizeConstantSeparate.y;particleSize[2]=startSizeConstantSeparate.z;}else {particleSize[0]=particleSize[1]=particleSize[2]=particleSystem.startSizeConstant;}break;case 2:if(particleSystem.threeDStartSize){var startSizeConstantMinSeparate=particleSystem.startSizeConstantMinSeparate;var startSizeConstantMaxSeparate=particleSystem.startSizeConstantMaxSeparate;if(autoRandomSeed){particleSize[0]=Laya.MathUtil.lerp(startSizeConstantMinSeparate.x,startSizeConstantMaxSeparate.x,Math.random());particleSize[1]=Laya.MathUtil.lerp(startSizeConstantMinSeparate.y,startSizeConstantMaxSeparate.y,Math.random());particleSize[2]=Laya.MathUtil.lerp(startSizeConstantMinSeparate.z,startSizeConstantMaxSeparate.z,Math.random());}else {rand.seed=randomSeeds[4];particleSize[0]=Laya.MathUtil.lerp(startSizeConstantMinSeparate.x,startSizeConstantMaxSeparate.x,rand.getFloat());particleSize[1]=Laya.MathUtil.lerp(startSizeConstantMinSeparate.y,startSizeConstantMaxSeparate.y,rand.getFloat());particleSize[2]=Laya.MathUtil.lerp(startSizeConstantMinSeparate.z,startSizeConstantMaxSeparate.z,rand.getFloat());randomSeeds[4]=rand.seed;}}else {if(autoRandomSeed){particleSize[0]=particleSize[1]=particleSize[2]=Laya.MathUtil.lerp(particleSystem.startSizeConstantMin,particleSystem.startSizeConstantMax,Math.random());}else {rand.seed=randomSeeds[4];particleSize[0]=particleSize[1]=particleSize[2]=Laya.MathUtil.lerp(particleSystem.startSizeConstantMin,particleSystem.startSizeConstantMax,rand.getFloat());randomSeeds[4]=rand.seed;}}break;}var sizeOverLifetime=particleSystem.sizeOverLifetime;if(sizeOverLifetime&&sizeOverLifetime.enable&&sizeOverLifetime.size.type===1){var size=sizeOverLifetime.size;if(size.separateAxes){if(autoRandomSeed){particleSize[0]=particleSize[0]*Laya.MathUtil.lerp(size.constantMinSeparate.x,size.constantMaxSeparate.x,Math.random());particleSize[1]=particleSize[1]*Laya.MathUtil.lerp(size.constantMinSeparate.y,size.constantMaxSeparate.y,Math.random());particleSize[2]=particleSize[2]*Laya.MathUtil.lerp(size.constantMinSeparate.z,size.constantMaxSeparate.z,Math.random());}else {rand.seed=randomSeeds[11];particleSize[0]=particleSize[0]*Laya.MathUtil.lerp(size.constantMinSeparate.x,size.constantMaxSeparate.x,rand.getFloat());particleSize[1]=particleSize[1]*Laya.MathUtil.lerp(size.constantMinSeparate.y,size.constantMaxSeparate.y,rand.getFloat());particleSize[2]=particleSize[2]*Laya.MathUtil.lerp(size.constantMinSeparate.z,size.constantMaxSeparate.z,rand.getFloat());randomSeeds[11]=rand.seed;}}else {var randomSize;if(autoRandomSeed){randomSize=Laya.MathUtil.lerp(size.constantMin,size.constantMax,Math.random());}else {rand.seed=randomSeeds[11];randomSize=Laya.MathUtil.lerp(size.constantMin,size.constantMax,rand.getFloat());randomSeeds[11]=rand.seed;}particleSize[0]=particleSize[0]*randomSize;particleSize[1]=particleSize[1]*randomSize;particleSize[2]=particleSize[2]*randomSize;}}var renderMode=particleRender.renderMode;if(renderMode!==1){switch(particleSystem.startRotationType){case 0:if(particleSystem.threeDStartRotation){var startRotationConstantSeparate=particleSystem.startRotationConstantSeparate;var randomRotationE=ShurikenParticleData._tempVector30;ShurikenParticleData._randomInvertRoationArray(startRotationConstantSeparate,randomRotationE,particleSystem.randomizeRotationDirection,autoRandomSeed?null:rand,randomSeeds);ShurikenParticleData.startRotation[0]=randomRotationE.x;ShurikenParticleData.startRotation[1]=randomRotationE.y;if(renderMode!==4)ShurikenParticleData.startRotation[2]=-randomRotationE.z;else ShurikenParticleData.startRotation[2]=randomRotationE.z;}else {ShurikenParticleData.startRotation[0]=ShurikenParticleData._randomInvertRoation(particleSystem.startRotationConstant,particleSystem.randomizeRotationDirection,autoRandomSeed?null:rand,randomSeeds);ShurikenParticleData.startRotation[1]=0;ShurikenParticleData.startRotation[2]=0;}break;case 2:if(particleSystem.threeDStartRotation){var startRotationConstantMinSeparate=particleSystem.startRotationConstantMinSeparate;var startRotationConstantMaxSeparate=particleSystem.startRotationConstantMaxSeparate;var lerpRoationE=ShurikenParticleData._tempVector30;if(autoRandomSeed){lerpRoationE.x=Laya.MathUtil.lerp(startRotationConstantMinSeparate.x,startRotationConstantMaxSeparate.x,Math.random());lerpRoationE.y=Laya.MathUtil.lerp(startRotationConstantMinSeparate.y,startRotationConstantMaxSeparate.y,Math.random());lerpRoationE.z=Laya.MathUtil.lerp(startRotationConstantMinSeparate.z,startRotationConstantMaxSeparate.z,Math.random());}else {rand.seed=randomSeeds[5];lerpRoationE.x=Laya.MathUtil.lerp(startRotationConstantMinSeparate.x,startRotationConstantMaxSeparate.x,rand.getFloat());lerpRoationE.y=Laya.MathUtil.lerp(startRotationConstantMinSeparate.y,startRotationConstantMaxSeparate.y,rand.getFloat());lerpRoationE.z=Laya.MathUtil.lerp(startRotationConstantMinSeparate.z,startRotationConstantMaxSeparate.z,rand.getFloat());randomSeeds[5]=rand.seed;}ShurikenParticleData._randomInvertRoationArray(lerpRoationE,lerpRoationE,particleSystem.randomizeRotationDirection,autoRandomSeed?null:rand,randomSeeds);ShurikenParticleData.startRotation[0]=lerpRoationE.x;ShurikenParticleData.startRotation[1]=lerpRoationE.y;if(renderMode!==4)ShurikenParticleData.startRotation[2]=-lerpRoationE.z;else ShurikenParticleData.startRotation[2]=lerpRoationE.z;}else {if(autoRandomSeed){ShurikenParticleData.startRotation[0]=ShurikenParticleData._randomInvertRoation(Laya.MathUtil.lerp(particleSystem.startRotationConstantMin,particleSystem.startRotationConstantMax,Math.random()),particleSystem.randomizeRotationDirection,autoRandomSeed?null:rand,randomSeeds);}else {rand.seed=randomSeeds[5];ShurikenParticleData.startRotation[0]=ShurikenParticleData._randomInvertRoation(Laya.MathUtil.lerp(particleSystem.startRotationConstantMin,particleSystem.startRotationConstantMax,rand.getFloat()),particleSystem.randomizeRotationDirection,autoRandomSeed?null:rand,randomSeeds);randomSeeds[5]=rand.seed;}}break;}}switch(particleSystem.startLifetimeType){case 0:ShurikenParticleData.startLifeTime=particleSystem.startLifetimeConstant;break;case 1:ShurikenParticleData.startLifeTime=ShurikenParticleData._getStartLifetimeFromGradient(particleSystem.startLifeTimeGradient,particleSystem.emissionTime);break;case 2:if(autoRandomSeed){ShurikenParticleData.startLifeTime=Laya.MathUtil.lerp(particleSystem.startLifetimeConstantMin,particleSystem.startLifetimeConstantMax,Math.random());}else {rand.seed=randomSeeds[7];ShurikenParticleData.startLifeTime=Laya.MathUtil.lerp(particleSystem.startLifetimeConstantMin,particleSystem.startLifetimeConstantMax,rand.getFloat());randomSeeds[7]=rand.seed;}break;case 3:var emissionTime=particleSystem.emissionTime;if(autoRandomSeed){ShurikenParticleData.startLifeTime=Laya.MathUtil.lerp(ShurikenParticleData._getStartLifetimeFromGradient(particleSystem.startLifeTimeGradientMin,emissionTime),ShurikenParticleData._getStartLifetimeFromGradient(particleSystem.startLifeTimeGradientMax,emissionTime),Math.random());}else {rand.seed=randomSeeds[7];ShurikenParticleData.startLifeTime=Laya.MathUtil.lerp(ShurikenParticleData._getStartLifetimeFromGradient(particleSystem.startLifeTimeGradientMin,emissionTime),ShurikenParticleData._getStartLifetimeFromGradient(particleSystem.startLifeTimeGradientMax,emissionTime),rand.getFloat());randomSeeds[7]=rand.seed;}break;}var textureSheetAnimation=particleSystem.textureSheetAnimation;var enableSheetAnimation=textureSheetAnimation&&textureSheetAnimation.enable;if(enableSheetAnimation){var title=textureSheetAnimation.tiles;var titleX=title.x,titleY=title.y;var subU=1.0/titleX,subV=1.0/titleY;var startFrameCount;var startFrame=textureSheetAnimation.startFrame;switch(startFrame.type){case 0:startFrameCount=startFrame.constant;break;case 1:if(autoRandomSeed){startFrameCount=Laya.MathUtil.lerp(startFrame.constantMin,startFrame.constantMax,Math.random());}else {rand.seed=randomSeeds[14];startFrameCount=Laya.MathUtil.lerp(startFrame.constantMin,startFrame.constantMax,rand.getFloat());randomSeeds[14]=rand.seed;}break;}var frame=textureSheetAnimation.frame;var cycles=textureSheetAnimation.cycles;switch(frame.type){case 0:startFrameCount+=frame.constant*cycles;break;case 2:if(autoRandomSeed){startFrameCount+=Laya.MathUtil.lerp(frame.constantMin,frame.constantMax,Math.random())*cycles;}else {rand.seed=randomSeeds[15];startFrameCount+=Laya.MathUtil.lerp(frame.constantMin,frame.constantMax,rand.getFloat())*cycles;randomSeeds[15]=rand.seed;}break;}var startRow=0;switch(textureSheetAnimation.type){case 0:startRow=Math.floor(startFrameCount/titleX);break;case 1:if(textureSheetAnimation.randomRow){if(autoRandomSeed){startRow=Math.floor(Math.random()*titleY);}else {rand.seed=randomSeeds[13];startRow=Math.floor(rand.getFloat()*titleY);randomSeeds[13]=rand.seed;}}else {startRow=textureSheetAnimation.rowIndex;}break;}var startCol=Math.floor(startFrameCount%titleX);ShurikenParticleData.startUVInfo=ShurikenParticleData.startUVInfo;ShurikenParticleData.startUVInfo[0]=subU;ShurikenParticleData.startUVInfo[1]=subV;ShurikenParticleData.startUVInfo[2]=startCol*subU;ShurikenParticleData.startUVInfo[3]=startRow*subV;}else {ShurikenParticleData.startUVInfo=ShurikenParticleData.startUVInfo;ShurikenParticleData.startUVInfo[0]=1.0;ShurikenParticleData.startUVInfo[1]=1.0;ShurikenParticleData.startUVInfo[2]=0.0;ShurikenParticleData.startUVInfo[3]=0.0;}};return ShurikenParticleData;}();ShurikenParticleData._tempVector30=new Vector3();ShurikenParticleData.startColor=new Vector4();ShurikenParticleData.startSize=new Float32Array(3);ShurikenParticleData.startRotation=new Float32Array(3);ShurikenParticleData.startUVInfo=new Float32Array(4);var ShurikenParticleSystem=/*#__PURE__*/function(_GeometryElement5){_inheritsLoose(ShurikenParticleSystem,_GeometryElement5);function ShurikenParticleSystem(owner){var _this72;_this72=_GeometryElement5.call(this)||this;_this72._boundingSphere=null;_this72._boundingBox=null;_this72._boundingBoxCorners=null;_this72._bounds=null;_this72._customBounds=null;_this72._useCustomBounds=false;_this72._owner=null;_this72._ownerRender=null;_this72._vertices=null;_this72._floatCountPerVertex=0;_this72._startLifeTimeIndex=0;_this72._timeIndex=0;_this72._simulateUpdate=false;_this72._firstActiveElement=0;_this72._firstNewElement=0;_this72._firstFreeElement=0;_this72._firstRetiredElement=0;_this72._drawCounter=0;_this72._bufferMaxParticles=0;_this72._emission=null;_this72._shape=null;_this72._isEmitting=false;_this72._isPlaying=false;_this72._isPaused=false;_this72._playStartDelay=0;_this72._frameRateTime=0;_this72._emissionTime=0;_this72._totalDelayTime=0;_this72._burstsIndex=0;_this72._velocityOverLifetime=null;_this72._colorOverLifetime=null;_this72._sizeOverLifetime=null;_this72._rotationOverLifetime=null;_this72._textureSheetAnimation=null;_this72._startLifetimeType=0;_this72._startLifetimeConstant=0;_this72._startLifeTimeGradient=null;_this72._startLifetimeConstantMin=0;_this72._startLifetimeConstantMax=0;_this72._startLifeTimeGradientMin=null;_this72._startLifeTimeGradientMax=null;_this72._maxStartLifetime=0;_this72._uvLength=new Vector2();_this72._vertexStride=0;_this72._indexStride=0;_this72._vertexBuffer=null;_this72._indexBuffer=null;_this72._bufferState=new BufferState();_this72._currentTime=0;_this72._startUpdateLoopCount=0;_this72._rand=null;_this72._randomSeeds=null;_this72.duration=0;_this72.looping=false;_this72.prewarm=false;_this72.startDelayType=0;_this72.startDelay=0;_this72.startDelayMin=0;_this72.startDelayMax=0;_this72.startSpeedType=0;_this72.startSpeedConstant=0;_this72.startSpeedConstantMin=0;_this72.startSpeedConstantMax=0;_this72.threeDStartSize=false;_this72.startSizeType=0;_this72.startSizeConstant=0;_this72.startSizeConstantSeparate=null;_this72.startSizeConstantMin=0;_this72.startSizeConstantMax=0;_this72.startSizeConstantMinSeparate=null;_this72.startSizeConstantMaxSeparate=null;_this72.threeDStartRotation=false;_this72.startRotationType=0;_this72.startRotationConstant=0;_this72.startRotationConstantSeparate=null;_this72.startRotationConstantMin=0;_this72.startRotationConstantMax=0;_this72.startRotationConstantMinSeparate=null;_this72.startRotationConstantMaxSeparate=null;_this72.randomizeRotationDirection=0;_this72.startColorType=0;_this72.startColorConstant=new Vector4(1,1,1,1);_this72.startColorConstantMin=new Vector4(0,0,0,0);_this72.startColorConstantMax=new Vector4(1,1,1,1);_this72.gravityModifier=0;_this72.simulationSpace=0;_this72.simulationSpeed=1.0;_this72.scaleMode=1;_this72.playOnAwake=false;_this72.randomSeed=null;_this72.autoRandomSeed=false;_this72.isPerformanceMode=false;_this72._firstActiveElement=0;_this72._firstNewElement=0;_this72._firstFreeElement=0;_this72._firstRetiredElement=0;_this72._owner=owner;_this72._ownerRender=owner.particleRenderer;_this72._boundingBoxCorners=[];_this72._boundingSphere=new BoundSphere(new Vector3(),Number.MAX_VALUE);_this72._boundingBox=new BoundBox(new Vector3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),new Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE));_this72._bounds=new Bounds(_this72._boundingBox.min,_this72._boundingBox.max);_this72._useCustomBounds=false;_this72._currentTime=0;_this72._isEmitting=false;_this72._isPlaying=false;_this72._isPaused=false;_this72._burstsIndex=0;_this72._frameRateTime=0;_this72._emissionTime=0;_this72._totalDelayTime=0;_this72._simulateUpdate=false;_this72._bufferMaxParticles=1;_this72.duration=5.0;_this72.looping=true;_this72.prewarm=false;_this72.startDelayType=0;_this72.startDelay=0.0;_this72.startDelayMin=0.0;_this72.startDelayMax=0.0;_this72._startLifetimeType=0;_this72._startLifetimeConstant=5.0;_this72._startLifeTimeGradient=new GradientDataNumber();_this72._startLifetimeConstantMin=0.0;_this72._startLifetimeConstantMax=5.0;_this72._startLifeTimeGradientMin=new GradientDataNumber();_this72._startLifeTimeGradientMax=new GradientDataNumber();_this72._maxStartLifetime=5.0;_this72.startSpeedType=0;_this72.startSpeedConstant=5.0;_this72.startSpeedConstantMin=0.0;_this72.startSpeedConstantMax=5.0;_this72.threeDStartSize=false;_this72.startSizeType=0;_this72.startSizeConstant=1;_this72.startSizeConstantSeparate=new Vector3(1,1,1);_this72.startSizeConstantMin=0;_this72.startSizeConstantMax=1;_this72.startSizeConstantMinSeparate=new Vector3(0,0,0);_this72.startSizeConstantMaxSeparate=new Vector3(1,1,1);_this72.threeDStartRotation=false;_this72.startRotationType=0;_this72.startRotationConstant=0;_this72.startRotationConstantSeparate=new Vector3(0,0,0);_this72.startRotationConstantMin=0.0;_this72.startRotationConstantMax=0.0;_this72.startRotationConstantMinSeparate=new Vector3(0,0,0);_this72.startRotationConstantMaxSeparate=new Vector3(0,0,0);_this72.gravityModifier=0.0;_this72.simulationSpace=1;_this72.scaleMode=1;_this72.playOnAwake=true;_this72._rand=new Rand(0);_this72.autoRandomSeed=true;_this72.randomSeed=new Uint32Array(1);_this72._randomSeeds=new Uint32Array(ShurikenParticleSystem._RANDOMOFFSET.length);_this72.isPerformanceMode=true;_this72._emission=new Emission();_this72._emission.enable=true;return _this72;}var _proto150=ShurikenParticleSystem.prototype;_proto150._getVertexBuffer=function _getVertexBuffer(index){if(index===void 0){index=0;}if(index===0)return this._vertexBuffer;else return null;};_proto150._getIndexBuffer=function _getIndexBuffer(){return this._indexBuffer;};_proto150._generateBoundingSphere=function _generateBoundingSphere(){var centerE=this._boundingSphere.center;centerE.x=0;centerE.y=0;centerE.z=0;this._boundingSphere.radius=Number.MAX_VALUE;};_proto150._generateBoundingBox=function _generateBoundingBox(){var particle=this._owner;var particleRender=particle.particleRenderer;var boundMin=this._boundingBox.min;var boundMax=this._boundingBox.max;var i,n;var maxStartLifeTime;switch(this.startLifetimeType){case 0:maxStartLifeTime=this.startLifetimeConstant;break;case 1:maxStartLifeTime=-Number.MAX_VALUE;var startLifeTimeGradient=startLifeTimeGradient;for(i=0,n=startLifeTimeGradient.gradientCount;i<n;i++){maxStartLifeTime=Math.max(maxStartLifeTime,startLifeTimeGradient.getValueByIndex(i));}break;case 2:maxStartLifeTime=Math.max(this.startLifetimeConstantMin,this.startLifetimeConstantMax);break;case 3:maxStartLifeTime=-Number.MAX_VALUE;var startLifeTimeGradientMin=startLifeTimeGradientMin;for(i=0,n=startLifeTimeGradientMin.gradientCount;i<n;i++){maxStartLifeTime=Math.max(maxStartLifeTime,startLifeTimeGradientMin.getValueByIndex(i));}var startLifeTimeGradientMax=startLifeTimeGradientMax;for(i=0,n=startLifeTimeGradientMax.gradientCount;i<n;i++){maxStartLifeTime=Math.max(maxStartLifeTime,startLifeTimeGradientMax.getValueByIndex(i));}break;}var minStartSpeed,maxStartSpeed;switch(this.startSpeedType){case 0:minStartSpeed=maxStartSpeed=this.startSpeedConstant;break;case 1:break;case 2:minStartSpeed=this.startLifetimeConstantMin;maxStartSpeed=this.startLifetimeConstantMax;break;}var minPosition,maxPosition,minDirection,maxDirection;if(this._shape&&this._shape.enable);else {minPosition=maxPosition=Vector3._ZERO;minDirection=Vector3._ZERO;maxDirection=Vector3._UnitZ;}var startMinVelocity=new Vector3(minDirection.x*minStartSpeed,minDirection.y*minStartSpeed,minDirection.z*minStartSpeed);var startMaxVelocity=new Vector3(maxDirection.x*maxStartSpeed,maxDirection.y*maxStartSpeed,maxDirection.z*maxStartSpeed);if(this._velocityOverLifetime&&this._velocityOverLifetime.enable){var lifeMinVelocity;var lifeMaxVelocity;var velocity=this._velocityOverLifetime.velocity;switch(velocity.type){case 0:lifeMinVelocity=lifeMaxVelocity=velocity.constant;break;case 1:lifeMinVelocity=lifeMaxVelocity=new Vector3(velocity.gradientX.getAverageValue(),velocity.gradientY.getAverageValue(),velocity.gradientZ.getAverageValue());break;case 2:lifeMinVelocity=velocity.constantMin;lifeMaxVelocity=velocity.constantMax;break;case 3:lifeMinVelocity=new Vector3(velocity.gradientXMin.getAverageValue(),velocity.gradientYMin.getAverageValue(),velocity.gradientZMin.getAverageValue());lifeMaxVelocity=new Vector3(velocity.gradientXMax.getAverageValue(),velocity.gradientYMax.getAverageValue(),velocity.gradientZMax.getAverageValue());break;}}var positionScale,velocityScale;var transform=this._owner.transform;var worldPosition=transform.position;var sizeScale=ShurikenParticleSystem._tempVector39;var renderMode=particleRender.renderMode;switch(this.scaleMode){case 0:var scale=transform.getWorldLossyScale();positionScale=scale;sizeScale.x=scale.x;sizeScale.y=scale.z;sizeScale.z=scale.y;renderMode===1&&(velocityScale=scale);break;case 1:var localScale=transform.localScale;positionScale=localScale;sizeScale.x=localScale.x;sizeScale.y=localScale.z;sizeScale.z=localScale.y;renderMode===1&&(velocityScale=localScale);break;case 2:positionScale=transform.getWorldLossyScale();sizeScale.x=sizeScale.y=sizeScale.z=1;renderMode===1&&(velocityScale=Vector3._ONE);break;}var minStratPosition,maxStratPosition;if(this._velocityOverLifetime&&this._velocityOverLifetime.enable);else {minStratPosition=new Vector3(startMinVelocity.x*maxStartLifeTime,startMinVelocity.y*maxStartLifeTime,startMinVelocity.z*maxStartLifeTime);maxStratPosition=new Vector3(startMaxVelocity.x*maxStartLifeTime,startMaxVelocity.y*maxStartLifeTime,startMaxVelocity.z*maxStartLifeTime);if(this.scaleMode!=2){Vector3.add(minPosition,minStratPosition,boundMin);Vector3.multiply(positionScale,boundMin,boundMin);Vector3.add(maxPosition,maxStratPosition,boundMax);Vector3.multiply(positionScale,boundMax,boundMax);}else {Vector3.multiply(positionScale,minPosition,boundMin);Vector3.add(boundMin,minStratPosition,boundMin);Vector3.multiply(positionScale,maxPosition,boundMax);Vector3.add(boundMax,maxStratPosition,boundMax);}}switch(this.simulationSpace){case 0:break;case 1:Vector3.add(boundMin,worldPosition,boundMin);Vector3.add(boundMax,worldPosition,boundMax);break;}var maxSize,maxSizeY;switch(this.startSizeType){case 0:if(this.threeDStartSize){var startSizeConstantSeparate=startSizeConstantSeparate;maxSize=Math.max(startSizeConstantSeparate.x,startSizeConstantSeparate.y);if(renderMode===1)maxSizeY=startSizeConstantSeparate.y;}else {maxSize=this.startSizeConstant;if(renderMode===1)maxSizeY=this.startSizeConstant;}break;case 1:break;case 2:if(this.threeDStartSize){var startSizeConstantMaxSeparate=startSizeConstantMaxSeparate;maxSize=Math.max(startSizeConstantMaxSeparate.x,startSizeConstantMaxSeparate.y);if(renderMode===1)maxSizeY=startSizeConstantMaxSeparate.y;}else {maxSize=this.startSizeConstantMax;if(renderMode===1)maxSizeY=this.startSizeConstantMax;}break;}if(this._sizeOverLifetime&&this._sizeOverLifetime.enable){var size=this._sizeOverLifetime.size;maxSize*=this._sizeOverLifetime.size.getMaxSizeInGradient();}var threeDMaxSize=ShurikenParticleSystem._tempVector30;var rotSize,nonRotSize;switch(renderMode){case 0:rotSize=maxSize*ShurikenParticleSystem.halfKSqrtOf2;Vector3.scale(sizeScale,maxSize,threeDMaxSize);Vector3.subtract(boundMin,threeDMaxSize,boundMin);Vector3.add(boundMax,threeDMaxSize,boundMax);break;case 1:var maxStretchPosition=ShurikenParticleSystem._tempVector31;var maxStretchVelocity=ShurikenParticleSystem._tempVector32;var minStretchVelocity=ShurikenParticleSystem._tempVector33;var minStretchPosition=ShurikenParticleSystem._tempVector34;if(this._velocityOverLifetime&&this._velocityOverLifetime.enable);else {Vector3.multiply(velocityScale,startMaxVelocity,maxStretchVelocity);Vector3.multiply(velocityScale,startMinVelocity,minStretchVelocity);}var sizeStretch=maxSizeY*particleRender.stretchedBillboardLengthScale;var maxStretchLength=Vector3.scalarLength(maxStretchVelocity)*particleRender.stretchedBillboardSpeedScale+sizeStretch;var minStretchLength=Vector3.scalarLength(minStretchVelocity)*particleRender.stretchedBillboardSpeedScale+sizeStretch;var norMaxStretchVelocity=ShurikenParticleSystem._tempVector35;var norMinStretchVelocity=ShurikenParticleSystem._tempVector36;Vector3.normalize(maxStretchVelocity,norMaxStretchVelocity);Vector3.scale(norMaxStretchVelocity,maxStretchLength,minStretchPosition);Vector3.subtract(maxStratPosition,minStretchPosition,minStretchPosition);Vector3.normalize(minStretchVelocity,norMinStretchVelocity);Vector3.scale(norMinStretchVelocity,minStretchLength,maxStretchPosition);Vector3.add(minStratPosition,maxStretchPosition,maxStretchPosition);rotSize=maxSize*ShurikenParticleSystem.halfKSqrtOf2;Vector3.scale(sizeScale,rotSize,threeDMaxSize);var halfNorMaxStretchVelocity=ShurikenParticleSystem._tempVector37;var halfNorMinStretchVelocity=ShurikenParticleSystem._tempVector38;Vector3.scale(norMaxStretchVelocity,0.5,halfNorMaxStretchVelocity);Vector3.scale(norMinStretchVelocity,0.5,halfNorMinStretchVelocity);Vector3.multiply(halfNorMaxStretchVelocity,sizeScale,halfNorMaxStretchVelocity);Vector3.multiply(halfNorMinStretchVelocity,sizeScale,halfNorMinStretchVelocity);Vector3.add(boundMin,halfNorMinStretchVelocity,boundMin);Vector3.min(boundMin,minStretchPosition,boundMin);Vector3.subtract(boundMin,threeDMaxSize,boundMin);Vector3.subtract(boundMax,halfNorMaxStretchVelocity,boundMax);Vector3.max(boundMax,maxStretchPosition,boundMax);Vector3.add(boundMax,threeDMaxSize,boundMax);break;case 2:maxSize*=Math.cos(0.78539816339744830961566084581988);nonRotSize=maxSize*0.5;threeDMaxSize.x=sizeScale.x*nonRotSize;threeDMaxSize.y=sizeScale.z*nonRotSize;Vector3.subtract(boundMin,threeDMaxSize,boundMin);Vector3.add(boundMax,threeDMaxSize,boundMax);break;case 3:maxSize*=Math.cos(0.78539816339744830961566084581988);nonRotSize=maxSize*0.5;Vector3.scale(sizeScale,nonRotSize,threeDMaxSize);Vector3.subtract(boundMin,threeDMaxSize,boundMin);Vector3.add(boundMax,threeDMaxSize,boundMax);break;}this._boundingBox.getCorners(this._boundingBoxCorners);};_proto150._generateBounds=function _generateBounds(){var particle=this._owner;var particleRender=particle.particleRenderer;var boundsMin=this._bounds.getMin();var boundsMax=this._bounds.getMax();var time=0;switch(this.startLifetimeType){case 0:time=this._startLifetimeConstant;break;case 2:time=this._startLifetimeConstantMax;break;}var speedOrigan=0;switch(this.startSpeedType){case 0:speedOrigan=this.startSpeedConstant;break;case 2:speedOrigan=this.startSpeedConstantMax;break;}var maxSizeScale=0;if(this.threeDStartSize){switch(this.startSizeType){case 0:maxSizeScale=Math.max(this.startSizeConstantSeparate.x,this.startSizeConstantSeparate.y,this.startSizeConstantSeparate.z);break;case 2:maxSizeScale=Math.max(this.startSizeConstantMaxSeparate.x,this.startSizeConstantMaxSeparate.y,this.startSizeConstantMaxSeparate.z);break;}}else {switch(this.startSizeType){case 0:maxSizeScale=this.startSizeConstant;break;case 2:maxSizeScale=this.startSizeConstantMax;break;}}var zDirectionSpeed=ShurikenParticleSystem._tempVector30;var fDirectionSpeed=ShurikenParticleSystem._tempVector31;var zEmisionOffsetXYZ=ShurikenParticleSystem._tempVector32;var fEmisionOffsetXYZ=ShurikenParticleSystem._tempVector33;zDirectionSpeed.setValue(0,0,1);fDirectionSpeed.setValue(0,0,0);zEmisionOffsetXYZ.setValue(0,0,0);fEmisionOffsetXYZ.setValue(0,0,0);if(this.shape&&this.shape.enable){switch(this.shape.shapeType){case exports.ParticleSystemShapeType.Sphere:var sphere=this.shape;zDirectionSpeed.setValue(1,1,1);fDirectionSpeed.setValue(1,1,1);zEmisionOffsetXYZ.setValue(sphere.radius,sphere.radius,sphere.radius);fEmisionOffsetXYZ.setValue(sphere.radius,sphere.radius,sphere.radius);break;case exports.ParticleSystemShapeType.Hemisphere:var hemiShpere=this.shape;zDirectionSpeed.setValue(1,1,1);fDirectionSpeed.setValue(1,1,1);zEmisionOffsetXYZ.setValue(hemiShpere.radius,hemiShpere.radius,hemiShpere.radius);fEmisionOffsetXYZ.setValue(hemiShpere.radius,hemiShpere.radius,0.0);break;case exports.ParticleSystemShapeType.Cone:var cone=this.shape;if(cone.emitType==0||cone.emitType==1){var angle=cone.angle;var sinAngle=Math.sin(angle);zDirectionSpeed.setValue(sinAngle,sinAngle,1.0);fDirectionSpeed.setValue(sinAngle,sinAngle,0.0);zEmisionOffsetXYZ.setValue(cone.radius,cone.radius,0.0);fEmisionOffsetXYZ.setValue(cone.radius,cone.radius,0.0);break;}else if(cone.emitType==2||cone.emitType==3){var angle=cone.angle;var sinAngle=Math.sin(angle);var coneLength=cone.length;zDirectionSpeed.setValue(sinAngle,sinAngle,1.0);fDirectionSpeed.setValue(sinAngle,sinAngle,0.0);var tanAngle=Math.tan(angle);var rPLCT=cone.radius+coneLength*tanAngle;zEmisionOffsetXYZ.setValue(rPLCT,rPLCT,coneLength);fEmisionOffsetXYZ.setValue(rPLCT,rPLCT,0.0);}break;case exports.ParticleSystemShapeType.Box:var box=this.shape;if(this.shape.randomDirection!=0){zDirectionSpeed.setValue(1,1,1);fDirectionSpeed.setValue(1,1,1);}else {zDirectionSpeed.setValue(0,0,0);fDirectionSpeed.setValue(0,0,0);}zEmisionOffsetXYZ.setValue(box.x/2,box.y/2,box.z/2);fEmisionOffsetXYZ.setValue(box.x/2,box.y/2,box.z/2);break;case exports.ParticleSystemShapeType.Circle:var circle=this.shape;zDirectionSpeed.setValue(1,1,1);fDirectionSpeed.setValue(1,1,1);zEmisionOffsetXYZ.setValue(circle.radius,circle.radius,0);fEmisionOffsetXYZ.setValue(circle.radius,circle.radius,0);break;}}var meshSize=0;var meshMode=particleRender.renderMode==4;switch(particleRender.renderMode){case 0:meshSize=ShurikenParticleSystem.halfKSqrtOf2;break;case 4:var meshBounds=particleRender.mesh.bounds;meshSize=Math.sqrt(Math.pow(meshBounds.getExtent().x,2.0)+Math.pow(meshBounds.getExtent().y,2.0)+Math.pow(meshBounds.getExtent().z,2.0));break;}var endSizeOffset=ShurikenParticleSystem._tempVector36;if(this.sizeOverLifetime&&this.sizeOverLifetime.enable){var gradientSize=this.sizeOverLifetime.size;var maxSize=gradientSize.getMaxSizeInGradient(meshMode);endSizeOffset.setValue(maxSize,maxSize,maxSize);}Vector3.scale(endSizeOffset,meshSize*maxSizeScale,endSizeOffset);var speedZOffset=ShurikenParticleSystem._tempVector34;var speedFOffset=ShurikenParticleSystem._tempVector35;if(speedOrigan>0){Vector3.scale(zDirectionSpeed,speedOrigan,speedZOffset);Vector3.scale(fDirectionSpeed,speedOrigan,speedFOffset);}else {Vector3.scale(zDirectionSpeed,-speedOrigan,speedFOffset);Vector3.scale(fDirectionSpeed,-speedOrigan,speedZOffset);}if(this.velocityOverLifetime&&this.velocityOverLifetime.enable){var gradientVelocity=this.velocityOverLifetime.velocity;var velocitySpeedOffset=ShurikenParticleSystem._tempVector37;switch(gradientVelocity.type){case 0:gradientVelocity.constant.cloneTo(velocitySpeedOffset);break;case 2:gradientVelocity.constantMax.cloneTo(velocitySpeedOffset);break;case 1:var curveX=gradientVelocity.gradientX.getAverageValue();var curveY=gradientVelocity.gradientY.getAverageValue();var curveZ=gradientVelocity.gradientZ.getAverageValue();velocitySpeedOffset.setValue(curveX,curveY,curveZ);break;case 3:var xMax=gradientVelocity.gradientXMax.getAverageValue();var yMax=gradientVelocity.gradientYMax.getAverageValue();var zMax=gradientVelocity.gradientZMax.getAverageValue();velocitySpeedOffset.setValue(xMax,yMax,zMax);break;}if(this.velocityOverLifetime.space==1){Vector3.transformV3ToV3(velocitySpeedOffset,this._owner.transform.worldMatrix,velocitySpeedOffset);}Vector3.add(speedZOffset,velocitySpeedOffset,speedZOffset);Vector3.subtract(speedFOffset,velocitySpeedOffset,speedFOffset);Vector3.max(speedZOffset,Vector3._ZERO,speedZOffset);Vector3.max(speedFOffset,Vector3._ZERO,speedFOffset);}Vector3.scale(speedZOffset,time,speedZOffset);Vector3.scale(speedFOffset,time,speedFOffset);var gravity=this.gravityModifier;var gravityOffset=0.5*ShurikenParticleSystem.g*gravity*time*time;speedZOffset.y-=gravityOffset;speedFOffset.y+=gravityOffset;speedZOffset.y=speedZOffset.y>0?speedZOffset.y:0;speedFOffset.y=speedFOffset.y>0?speedFOffset.y:0;Vector3.add(speedZOffset,endSizeOffset,boundsMax);Vector3.add(boundsMax,zEmisionOffsetXYZ,boundsMax);Vector3.add(speedFOffset,endSizeOffset,boundsMin);Vector3.add(boundsMin,fEmisionOffsetXYZ,boundsMin);Vector3.scale(boundsMin,-1,boundsMin);this._bounds.setMin(boundsMin);this._bounds.setMax(boundsMax);};_proto150._simulationSupported=function _simulationSupported(){if(this.simulationSpace==0){return false;}return true;};_proto150._updateEmission=function _updateEmission(){if(!this.isAlive)return;if(this._simulateUpdate){this._simulateUpdate=false;}else {var elapsedTime=this._startUpdateLoopCount!==Laya.Stat.loopCount&&!this._isPaused?this._owner._scene.timer._delta/1000.0:0;elapsedTime=Math.min(ShurikenParticleSystem._maxElapsedTime,elapsedTime*this.simulationSpeed);this._updateParticles(elapsedTime);}};_proto150._updateParticles=function _updateParticles(elapsedTime){if(this._ownerRender.renderMode===4&&!this._ownerRender.mesh)return;this._currentTime+=elapsedTime;this._retireActiveParticles();this._freeRetiredParticles();this._totalDelayTime+=elapsedTime;if(this._totalDelayTime<this._playStartDelay){return;}if(this._emission.enable&&this._isEmitting&&!this._isPaused)this._advanceTime(elapsedTime,this._currentTime);};_proto150._updateParticlesSimulationRestart=function _updateParticlesSimulationRestart(time){this._firstActiveElement=0;this._firstNewElement=0;this._firstFreeElement=0;this._firstRetiredElement=0;this._burstsIndex=0;this._frameRateTime=time;this._emissionTime=0;this._totalDelayTime=0;this._currentTime=time;var delayTime=time;if(delayTime<this._playStartDelay){this._totalDelayTime=delayTime;return;}if(this._emission.enable)this._advanceTime(time,time);};_proto150._retireActiveParticles=function _retireActiveParticles(){var epsilon=0.0001;while(this._firstActiveElement!=this._firstNewElement){var index=this._firstActiveElement*this._floatCountPerVertex*this._vertexStride;var timeIndex=index+this._timeIndex;var particleAge=this._currentTime-this._vertices[timeIndex];if(particleAge+epsilon<this._vertices[index+this._startLifeTimeIndex])break;this._vertices[timeIndex]=this._drawCounter;this._firstActiveElement++;if(this._firstActiveElement>=this._bufferMaxParticles)this._firstActiveElement=0;}};_proto150._freeRetiredParticles=function _freeRetiredParticles(){while(this._firstRetiredElement!=this._firstActiveElement){var age=this._drawCounter-this._vertices[this._firstRetiredElement*this._floatCountPerVertex*this._vertexStride+this._timeIndex];if(this.isPerformanceMode)if(age<3)break;this._firstRetiredElement++;if(this._firstRetiredElement>=this._bufferMaxParticles)this._firstRetiredElement=0;}};_proto150._burst=function _burst(fromTime,toTime){var totalEmitCount=0;var bursts=this._emission._bursts;for(var n=bursts.length;this._burstsIndex<n;this._burstsIndex++){var burst=bursts[this._burstsIndex];var burstTime=burst.time;if(fromTime<=burstTime&&burstTime<toTime){var emitCount;if(this.autoRandomSeed){emitCount=Laya.MathUtil.lerp(burst.minCount,burst.maxCount,Math.random());}else {this._rand.seed=this._randomSeeds[0];emitCount=Laya.MathUtil.lerp(burst.minCount,burst.maxCount,this._rand.getFloat());this._randomSeeds[0]=this._rand.seed;}totalEmitCount+=emitCount;}else {break;}}return totalEmitCount;};_proto150._advanceTime=function _advanceTime(elapsedTime,emitTime){var i;var lastEmissionTime=this._emissionTime;this._emissionTime+=elapsedTime;var totalEmitCount=0;if(this._emissionTime>this.duration){if(this.looping){totalEmitCount+=this._burst(lastEmissionTime,this._emissionTime);this._emissionTime-=this.duration;this._burstsIndex=0;totalEmitCount+=this._burst(0,this._emissionTime);}else {totalEmitCount=Math.min(this.maxParticles-this.aliveParticleCount,totalEmitCount);for(i=0;i<totalEmitCount;i++){this.emit(emitTime);}this._isPlaying=false;this.stop();return;}}else {totalEmitCount+=this._burst(lastEmissionTime,this._emissionTime);}totalEmitCount=Math.min(this.maxParticles-this.aliveParticleCount,totalEmitCount);for(i=0;i<totalEmitCount;i++){this.emit(emitTime);}var emissionRate=this.emission.emissionRate;if(emissionRate>0){var minEmissionTime=1/emissionRate;this._frameRateTime+=minEmissionTime;this._frameRateTime=this._currentTime-(this._currentTime-this._frameRateTime)%this._maxStartLifetime;while(this._frameRateTime<=emitTime){if(this.emit(this._frameRateTime))this._frameRateTime+=minEmissionTime;else break;}this._frameRateTime=Math.floor(emitTime/minEmissionTime)*minEmissionTime;}};_proto150._initBufferDatas=function _initBufferDatas(){if(this._vertexBuffer){this._vertexBuffer.destroy();this._indexBuffer.destroy();var memorySize=this._vertexBuffer._byteLength+this._indexBuffer.indexCount*2;Laya.Resource._addMemory(-memorySize,-memorySize);}var gl=Laya.LayaGL.instance;var render=this._ownerRender;var renderMode=render.renderMode;if(renderMode!==-1&&this.maxParticles>0){var indices,i,j,m,indexOffset,perPartOffset,vertexDeclaration;var vbMemorySize=0,memorySize=0;var mesh=render.mesh;if(renderMode===4){if(mesh){vertexDeclaration=VertexShurikenParticleMesh.vertexDeclaration;this._floatCountPerVertex=vertexDeclaration.vertexStride/4;this._startLifeTimeIndex=12;this._timeIndex=16;this._vertexStride=mesh._vertexCount;var totalVertexCount=this._bufferMaxParticles*this._vertexStride;var vbCount=Math.floor(totalVertexCount/65535)+1;var lastVBVertexCount=totalVertexCount%65535;if(vbCount>1){throw new Error("ShurikenParticleSystem:the maxParticleCount multiply mesh vertexCount is large than 65535.");}vbMemorySize=vertexDeclaration.vertexStride*lastVBVertexCount;this._vertexBuffer=new VertexBuffer3D(vbMemorySize,gl.DYNAMIC_DRAW);this._vertexBuffer.vertexDeclaration=vertexDeclaration;this._vertices=new Float32Array(this._floatCountPerVertex*lastVBVertexCount);this._indexStride=mesh._indexBuffer.indexCount;var indexDatas=mesh._indexBuffer.getData();var indexCount=this._bufferMaxParticles*this._indexStride;this._indexBuffer=new IndexBuffer3D(exports.IndexFormat.UInt16,indexCount,gl.STATIC_DRAW);indices=new Uint16Array(indexCount);memorySize=vbMemorySize+indexCount*2;indexOffset=0;for(i=0;i<this._bufferMaxParticles;i++){var indexValueOffset=i*this._vertexStride;for(j=0,m=indexDatas.length;j<m;j++){indices[indexOffset++]=indexValueOffset+indexDatas[j];}}this._indexBuffer.setData(indices);this._bufferState.bind();this._bufferState.applyVertexBuffer(this._vertexBuffer);this._bufferState.applyIndexBuffer(this._indexBuffer);this._bufferState.unBind();}}else {vertexDeclaration=VertexShurikenParticleBillboard.vertexDeclaration;this._floatCountPerVertex=vertexDeclaration.vertexStride/4;this._startLifeTimeIndex=7;this._timeIndex=11;this._vertexStride=4;vbMemorySize=vertexDeclaration.vertexStride*this._bufferMaxParticles*this._vertexStride;this._vertexBuffer=new VertexBuffer3D(vbMemorySize,gl.DYNAMIC_DRAW);this._vertexBuffer.vertexDeclaration=vertexDeclaration;this._vertices=new Float32Array(this._floatCountPerVertex*this._bufferMaxParticles*this._vertexStride);for(i=0;i<this._bufferMaxParticles;i++){perPartOffset=i*this._floatCountPerVertex*this._vertexStride;this._vertices[perPartOffset]=-0.5;this._vertices[perPartOffset+1]=-0.5;this._vertices[perPartOffset+2]=0;this._vertices[perPartOffset+3]=1;perPartOffset+=this._floatCountPerVertex;this._vertices[perPartOffset]=0.5;this._vertices[perPartOffset+1]=-0.5;this._vertices[perPartOffset+2]=1;this._vertices[perPartOffset+3]=1;perPartOffset+=this._floatCountPerVertex;this._vertices[perPartOffset]=0.5;this._vertices[perPartOffset+1]=0.5;this._vertices[perPartOffset+2]=1;this._vertices[perPartOffset+3]=0;perPartOffset+=this._floatCountPerVertex;this._vertices[perPartOffset]=-0.5;this._vertices[perPartOffset+1]=0.5;this._vertices[perPartOffset+2]=0;this._vertices[perPartOffset+3]=0;}this._indexStride=6;this._indexBuffer=new IndexBuffer3D(exports.IndexFormat.UInt16,this._bufferMaxParticles*6,gl.STATIC_DRAW);indices=new Uint16Array(this._bufferMaxParticles*6);for(i=0;i<this._bufferMaxParticles;i++){indexOffset=i*6;var firstVertex=i*this._vertexStride,secondVertex=firstVertex+2;indices[indexOffset++]=firstVertex;indices[indexOffset++]=secondVertex;indices[indexOffset++]=firstVertex+1;indices[indexOffset++]=firstVertex;indices[indexOffset++]=firstVertex+3;indices[indexOffset++]=secondVertex;}this._indexBuffer.setData(indices);memorySize=vbMemorySize+this._bufferMaxParticles*6*2;this._bufferState.bind();this._bufferState.applyVertexBuffer(this._vertexBuffer);this._bufferState.applyIndexBuffer(this._indexBuffer);this._bufferState.unBind();}Laya.Resource._addMemory(memorySize,memorySize);}};_proto150.destroy=function destroy(){_GeometryElement5.prototype.destroy.call(this);var memorySize=this._vertexBuffer._byteLength+this._indexBuffer.indexCount*2;Laya.Resource._addMemory(-memorySize,-memorySize);this._bufferState.destroy();this._vertexBuffer.destroy();this._indexBuffer.destroy();this._emission.destroy();this._boundingBox=null;this._boundingSphere=null;this._boundingBoxCorners=null;this._bounds=null;this._customBounds=null;this._bufferState=null;this._vertexBuffer=null;this._indexBuffer=null;this._owner=null;this._vertices=null;this._indexBuffer=null;this._emission=null;this._shape=null;this.startLifeTimeGradient=null;this.startLifeTimeGradientMin=null;this.startLifeTimeGradientMax=null;this.startSizeConstantSeparate=null;this.startSizeConstantMinSeparate=null;this.startSizeConstantMaxSeparate=null;this.startRotationConstantSeparate=null;this.startRotationConstantMinSeparate=null;this.startRotationConstantMaxSeparate=null;this.startColorConstant=null;this.startColorConstantMin=null;this.startColorConstantMax=null;this._velocityOverLifetime=null;this._colorOverLifetime=null;this._sizeOverLifetime=null;this._rotationOverLifetime=null;this._textureSheetAnimation=null;};_proto150.emit=function emit(time){var position=ShurikenParticleSystem._tempPosition;var direction=ShurikenParticleSystem._tempDirection;if(this._shape&&this._shape.enable){if(this.autoRandomSeed)this._shape.generatePositionAndDirection(position,direction);else this._shape.generatePositionAndDirection(position,direction,this._rand,this._randomSeeds);}else {position.x=position.y=position.z=0;direction.x=direction.y=0;direction.z=1;}return this.addParticle(position,direction,time);};_proto150.addParticle=function addParticle(position,direction,time){Vector3.normalize(direction,direction);var nextFreeParticle=this._firstFreeElement+1;if(nextFreeParticle>=this._bufferMaxParticles)nextFreeParticle=0;if(nextFreeParticle===this._firstRetiredElement)return false;var transform=this._owner.transform;ShurikenParticleData.create(this,this._ownerRender,transform);var particleAge=this._currentTime-time;if(particleAge>=ShurikenParticleData.startLifeTime)return true;var pos,rot;if(this.simulationSpace==0){pos=transform.position;rot=transform.rotation;}var startSpeed;switch(this.startSpeedType){case 0:startSpeed=this.startSpeedConstant;break;case 2:if(this.autoRandomSeed){startSpeed=Laya.MathUtil.lerp(this.startSpeedConstantMin,this.startSpeedConstantMax,Math.random());}else {this._rand.seed=this._randomSeeds[8];startSpeed=Laya.MathUtil.lerp(this.startSpeedConstantMin,this.startSpeedConstantMax,this._rand.getFloat());this._randomSeeds[8]=this._rand.seed;}break;}var randomVelocityX,randomVelocityY,randomVelocityZ,randomColor,randomSize,randomRotation,randomTextureAnimation;var needRandomVelocity=this._velocityOverLifetime&&this._velocityOverLifetime.enable;if(needRandomVelocity){var velocityType=this._velocityOverLifetime.velocity.type;if(velocityType===2||velocityType===3){if(this.autoRandomSeed){randomVelocityX=Math.random();randomVelocityY=Math.random();randomVelocityZ=Math.random();}else {this._rand.seed=this._randomSeeds[9];randomVelocityX=this._rand.getFloat();randomVelocityY=this._rand.getFloat();randomVelocityZ=this._rand.getFloat();this._randomSeeds[9]=this._rand.seed;}}else {needRandomVelocity=false;}}else {needRandomVelocity=false;}var needRandomColor=this._colorOverLifetime&&this._colorOverLifetime.enable;if(needRandomColor){var colorType=this._colorOverLifetime.color.type;if(colorType===3){if(this.autoRandomSeed){randomColor=Math.random();}else {this._rand.seed=this._randomSeeds[10];randomColor=this._rand.getFloat();this._randomSeeds[10]=this._rand.seed;}}else {needRandomColor=false;}}else {needRandomColor=false;}var needRandomSize=this._sizeOverLifetime&&this._sizeOverLifetime.enable;if(needRandomSize){var sizeType=this._sizeOverLifetime.size.type;if(sizeType===3){if(this.autoRandomSeed){randomSize=Math.random();}else {this._rand.seed=this._randomSeeds[11];randomSize=this._rand.getFloat();this._randomSeeds[11]=this._rand.seed;}}else {needRandomSize=false;}}else {needRandomSize=false;}var needRandomRotation=this._rotationOverLifetime&&this._rotationOverLifetime.enable;if(needRandomRotation){var rotationType=this._rotationOverLifetime.angularVelocity.type;if(rotationType===2||rotationType===3){if(this.autoRandomSeed){randomRotation=Math.random();}else {this._rand.seed=this._randomSeeds[12];randomRotation=this._rand.getFloat();this._randomSeeds[12]=this._rand.seed;}}else {needRandomRotation=false;}}else {needRandomRotation=false;}var needRandomTextureAnimation=this._textureSheetAnimation&&this._textureSheetAnimation.enable;if(needRandomTextureAnimation){var textureAnimationType=this._textureSheetAnimation.frame.type;if(textureAnimationType===3){if(this.autoRandomSeed){randomTextureAnimation=Math.random();}else {this._rand.seed=this._randomSeeds[15];randomTextureAnimation=this._rand.getFloat();this._randomSeeds[15]=this._rand.seed;}}else {needRandomTextureAnimation=false;}}else {needRandomTextureAnimation=false;}var startIndex=this._firstFreeElement*this._floatCountPerVertex*this._vertexStride;var subU=ShurikenParticleData.startUVInfo[0];var subV=ShurikenParticleData.startUVInfo[1];var startU=ShurikenParticleData.startUVInfo[2];var startV=ShurikenParticleData.startUVInfo[3];var meshVertices,meshVertexStride,meshPosOffset,meshCorOffset,meshUVOffset,meshVertexIndex;var render=this._ownerRender;if(render.renderMode===4){var meshVB=render.mesh._vertexBuffer;meshVertices=meshVB.getFloat32Data();var meshVertexDeclaration=meshVB.vertexDeclaration;meshPosOffset=meshVertexDeclaration.getVertexElementByUsage(VertexMesh.MESH_POSITION0)._offset/4;var colorElement=meshVertexDeclaration.getVertexElementByUsage(VertexMesh.MESH_COLOR0);meshCorOffset=colorElement?colorElement._offset/4:-1;var uvElement=meshVertexDeclaration.getVertexElementByUsage(VertexMesh.MESH_TEXTURECOORDINATE0);meshUVOffset=uvElement?uvElement._offset/4:-1;meshVertexStride=meshVertexDeclaration.vertexStride/4;meshVertexIndex=0;}else {this._vertices[startIndex+2]=startU;this._vertices[startIndex+3]=startV+subV;var secondOffset=startIndex+this._floatCountPerVertex;this._vertices[secondOffset+2]=startU+subU;this._vertices[secondOffset+3]=startV+subV;var thirdOffset=secondOffset+this._floatCountPerVertex;this._vertices[thirdOffset+2]=startU+subU;this._vertices[thirdOffset+3]=startV;var fourthOffset=thirdOffset+this._floatCountPerVertex;this._vertices[fourthOffset+2]=startU;this._vertices[fourthOffset+3]=startV;}for(var i=startIndex,n=startIndex+this._floatCountPerVertex*this._vertexStride;i<n;i+=this._floatCountPerVertex){var offset;if(render.renderMode===4){offset=i;var vertexOffset=meshVertexStride*meshVertexIndex++;var meshOffset=vertexOffset+meshPosOffset;this._vertices[offset++]=meshVertices[meshOffset++];this._vertices[offset++]=meshVertices[meshOffset++];this._vertices[offset++]=meshVertices[meshOffset];if(meshCorOffset===-1){this._vertices[offset++]=1.0;this._vertices[offset++]=1.0;this._vertices[offset++]=1.0;this._vertices[offset++]=1.0;}else {meshOffset=vertexOffset+meshCorOffset;this._vertices[offset++]=meshVertices[meshOffset++];this._vertices[offset++]=meshVertices[meshOffset++];this._vertices[offset++]=meshVertices[meshOffset++];this._vertices[offset++]=meshVertices[meshOffset];}if(meshUVOffset===-1){this._vertices[offset++]=0.0;this._vertices[offset++]=0.0;}else {meshOffset=vertexOffset+meshUVOffset;this._vertices[offset++]=startU+meshVertices[meshOffset++]*subU;this._vertices[offset++]=startV+meshVertices[meshOffset]*subV;}}else {offset=i+4;}this._vertices[offset++]=position.x;this._vertices[offset++]=position.y;this._vertices[offset++]=position.z;this._vertices[offset++]=ShurikenParticleData.startLifeTime;this._vertices[offset++]=direction.x;this._vertices[offset++]=direction.y;this._vertices[offset++]=direction.z;this._vertices[offset++]=time;this._vertices[offset++]=ShurikenParticleData.startColor.x;this._vertices[offset++]=ShurikenParticleData.startColor.y;this._vertices[offset++]=ShurikenParticleData.startColor.z;this._vertices[offset++]=ShurikenParticleData.startColor.w;this._vertices[offset++]=ShurikenParticleData.startSize[0];this._vertices[offset++]=ShurikenParticleData.startSize[1];this._vertices[offset++]=ShurikenParticleData.startSize[2];this._vertices[offset++]=ShurikenParticleData.startRotation[0];this._vertices[offset++]=ShurikenParticleData.startRotation[1];this._vertices[offset++]=ShurikenParticleData.startRotation[2];this._vertices[offset++]=startSpeed;needRandomColor&&(this._vertices[offset+1]=randomColor);needRandomSize&&(this._vertices[offset+2]=randomSize);needRandomRotation&&(this._vertices[offset+3]=randomRotation);needRandomTextureAnimation&&(this._vertices[offset+4]=randomTextureAnimation);if(needRandomVelocity){this._vertices[offset+5]=randomVelocityX;this._vertices[offset+6]=randomVelocityY;this._vertices[offset+7]=randomVelocityZ;}switch(this.simulationSpace){case 0:offset+=8;this._vertices[offset++]=pos.x;this._vertices[offset++]=pos.y;this._vertices[offset++]=pos.z;this._vertices[offset++]=rot.x;this._vertices[offset++]=rot.y;this._vertices[offset++]=rot.z;this._vertices[offset++]=rot.w;break;case 1:break;default:throw new Error("ShurikenParticleMaterial: SimulationSpace value is invalid.");}}this._firstFreeElement=nextFreeParticle;return true;};_proto150.addNewParticlesToVertexBuffer=function addNewParticlesToVertexBuffer(){var start;var byteStride=this._vertexStride*this._floatCountPerVertex*4;if(this._firstNewElement<this._firstFreeElement){start=this._firstNewElement*byteStride;this._vertexBuffer.setData(this._vertices.buffer,start,start,(this._firstFreeElement-this._firstNewElement)*byteStride);}else {start=this._firstNewElement*byteStride;this._vertexBuffer.setData(this._vertices.buffer,start,start,(this._bufferMaxParticles-this._firstNewElement)*byteStride);if(this._firstFreeElement>0){this._vertexBuffer.setData(this._vertices.buffer,0,0,this._firstFreeElement*byteStride);}}this._firstNewElement=this._firstFreeElement;};_proto150._getType=function _getType(){return ShurikenParticleSystem._type;};_proto150._prepareRender=function _prepareRender(state){this._updateEmission();if(this._firstNewElement!=this._firstFreeElement)this.addNewParticlesToVertexBuffer();this._drawCounter++;if(this._firstActiveElement!=this._firstFreeElement)return true;else return false;};_proto150._render=function _render(state){this._bufferState.bind();var indexCount;var gl=Laya.LayaGL.instance;if(this._firstActiveElement<this._firstFreeElement){indexCount=(this._firstFreeElement-this._firstActiveElement)*this._indexStride;gl.drawElements(gl.TRIANGLES,indexCount,gl.UNSIGNED_SHORT,2*this._firstActiveElement*this._indexStride);Laya.Stat.trianglesFaces+=indexCount/3;Laya.Stat.renderBatches++;}else {indexCount=(this._bufferMaxParticles-this._firstActiveElement)*this._indexStride;gl.drawElements(gl.TRIANGLES,indexCount,gl.UNSIGNED_SHORT,2*this._firstActiveElement*this._indexStride);Laya.Stat.trianglesFaces+=indexCount/3;Laya.Stat.renderBatches++;if(this._firstFreeElement>0){indexCount=this._firstFreeElement*this._indexStride;gl.drawElements(gl.TRIANGLES,indexCount,gl.UNSIGNED_SHORT,0);Laya.Stat.trianglesFaces+=indexCount/3;Laya.Stat.renderBatches++;}}};_proto150.play=function play(){this._burstsIndex=0;this._isEmitting=true;this._isPlaying=true;this._isPaused=false;this._emissionTime=0;this._totalDelayTime=0;if(!this.autoRandomSeed){for(var i=0,n=this._randomSeeds.length;i<n;i++){this._randomSeeds[i]=this.randomSeed[0]+ShurikenParticleSystem._RANDOMOFFSET[i];}}switch(this.startDelayType){case 0:this._playStartDelay=this.startDelay;break;case 1:if(this.autoRandomSeed){this._playStartDelay=Laya.MathUtil.lerp(this.startDelayMin,this.startDelayMax,Math.random());}else {this._rand.seed=this._randomSeeds[2];this._playStartDelay=Laya.MathUtil.lerp(this.startDelayMin,this.startDelayMax,this._rand.getFloat());this._randomSeeds[2]=this._rand.seed;}break;default:throw new Error("Utils3D: startDelayType is invalid.");}this._frameRateTime=this._currentTime+this._playStartDelay;this._startUpdateLoopCount=Laya.Stat.loopCount;};_proto150.pause=function pause(){this._isPaused=true;};_proto150.simulate=function simulate(time,restart){if(restart===void 0){restart=true;}this._simulateUpdate=true;if(restart){this._updateParticlesSimulationRestart(time);}else {this._isPaused=false;this._updateParticles(time);}this.pause();};_proto150.stop=function stop(){this._burstsIndex=0;this._isEmitting=false;this._emissionTime=0;};_proto150.cloneTo=function cloneTo(destObject){var dest=destObject;dest._useCustomBounds=this._useCustomBounds;this._customBounds&&this._customBounds.cloneTo(dest._customBounds);dest.duration=this.duration;dest.looping=this.looping;dest.prewarm=this.prewarm;dest.startDelayType=this.startDelayType;dest.startDelay=this.startDelay;dest.startDelayMin=this.startDelayMin;dest.startDelayMax=this.startDelayMax;dest._maxStartLifetime=this._maxStartLifetime;dest.startLifetimeType=this.startLifetimeType;dest.startLifetimeConstant=this.startLifetimeConstant;this.startLifeTimeGradient.cloneTo(dest.startLifeTimeGradient);dest.startLifetimeConstantMin=this.startLifetimeConstantMin;dest.startLifetimeConstantMax=this.startLifetimeConstantMax;this.startLifeTimeGradientMin.cloneTo(dest.startLifeTimeGradientMin);this.startLifeTimeGradientMax.cloneTo(dest.startLifeTimeGradientMax);dest.startSpeedType=this.startSpeedType;dest.startSpeedConstant=this.startSpeedConstant;dest.startSpeedConstantMin=this.startSpeedConstantMin;dest.startSpeedConstantMax=this.startSpeedConstantMax;dest.threeDStartSize=this.threeDStartSize;dest.startSizeType=this.startSizeType;dest.startSizeConstant=this.startSizeConstant;this.startSizeConstantSeparate.cloneTo(dest.startSizeConstantSeparate);dest.startSizeConstantMin=this.startSizeConstantMin;dest.startSizeConstantMax=this.startSizeConstantMax;this.startSizeConstantMinSeparate.cloneTo(dest.startSizeConstantMinSeparate);this.startSizeConstantMaxSeparate.cloneTo(dest.startSizeConstantMaxSeparate);dest.threeDStartRotation=this.threeDStartRotation;dest.startRotationType=this.startRotationType;dest.startRotationConstant=this.startRotationConstant;this.startRotationConstantSeparate.cloneTo(dest.startRotationConstantSeparate);dest.startRotationConstantMin=this.startRotationConstantMin;dest.startRotationConstantMax=this.startRotationConstantMax;this.startRotationConstantMinSeparate.cloneTo(dest.startRotationConstantMinSeparate);this.startRotationConstantMaxSeparate.cloneTo(dest.startRotationConstantMaxSeparate);dest.randomizeRotationDirection=this.randomizeRotationDirection;dest.startColorType=this.startColorType;this.startColorConstant.cloneTo(dest.startColorConstant);this.startColorConstantMin.cloneTo(dest.startColorConstantMin);this.startColorConstantMax.cloneTo(dest.startColorConstantMax);dest.gravityModifier=this.gravityModifier;dest.simulationSpace=this.simulationSpace;dest.scaleMode=this.scaleMode;dest.playOnAwake=this.playOnAwake;dest.autoRandomSeed=this.autoRandomSeed;dest.randomSeed[0]=this.randomSeed[0];dest.maxParticles=this.maxParticles;this._emission&&(dest._emission=this._emission.clone());this.shape&&(dest.shape=this.shape.clone());this.velocityOverLifetime&&(dest.velocityOverLifetime=this.velocityOverLifetime.clone());this.colorOverLifetime&&(dest.colorOverLifetime=this.colorOverLifetime.clone());this.sizeOverLifetime&&(dest.sizeOverLifetime=this.sizeOverLifetime.clone());this.rotationOverLifetime&&(dest.rotationOverLifetime=this.rotationOverLifetime.clone());this.textureSheetAnimation&&(dest.textureSheetAnimation=this.textureSheetAnimation.clone());dest.isPerformanceMode=this.isPerformanceMode;dest._isEmitting=this._isEmitting;dest._isPlaying=this._isPlaying;dest._isPaused=this._isPaused;dest._playStartDelay=this._playStartDelay;dest._frameRateTime=this._frameRateTime;dest._emissionTime=this._emissionTime;dest._totalDelayTime=this._totalDelayTime;dest._burstsIndex=this._burstsIndex;};_proto150.clone=function clone(){var dest=new ShurikenParticleSystem(null);this.cloneTo(dest);return dest;};_createClass(ShurikenParticleSystem,[{key:"maxParticles",get:function get(){return this._bufferMaxParticles-1;},set:function set(value){var newMaxParticles=value+1;if(newMaxParticles!==this._bufferMaxParticles){this._bufferMaxParticles=newMaxParticles;this._initBufferDatas();}}},{key:"emission",get:function get(){return this._emission;}},{key:"aliveParticleCount",get:function get(){if(this._firstNewElement>=this._firstRetiredElement)return this._firstNewElement-this._firstRetiredElement;else return this._bufferMaxParticles-this._firstRetiredElement+this._firstNewElement;}},{key:"emissionTime",get:function get(){return this._emissionTime>this.duration?this.duration:this._emissionTime;}},{key:"shape",get:function get(){return this._shape;},set:function set(value){if(this._shape!==value){if(value&&value.enable)this._owner._render._shaderValues.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SHAPE);else this._owner._render._shaderValues.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SHAPE);this._shape=value;}}},{key:"isAlive",get:function get(){if(this._isPlaying||this.aliveParticleCount>0)return true;return false;}},{key:"isEmitting",get:function get(){return this._isEmitting;}},{key:"isPlaying",get:function get(){return this._isPlaying;}},{key:"isPaused",get:function get(){return this._isPaused;}},{key:"startLifetimeType",get:function get(){return this._startLifetimeType;},set:function set(value){var i,n;switch(this.startLifetimeType){case 0:this._maxStartLifetime=this.startLifetimeConstant;break;case 1:this._maxStartLifetime=-Number.MAX_VALUE;var startLifeTimeGradient=startLifeTimeGradient;for(i=0,n=startLifeTimeGradient.gradientCount;i<n;i++){this._maxStartLifetime=Math.max(this._maxStartLifetime,startLifeTimeGradient.getValueByIndex(i));}break;case 2:this._maxStartLifetime=Math.max(this.startLifetimeConstantMin,this.startLifetimeConstantMax);break;case 3:this._maxStartLifetime=-Number.MAX_VALUE;var startLifeTimeGradientMin=startLifeTimeGradientMin;for(i=0,n=startLifeTimeGradientMin.gradientCount;i<n;i++){this._maxStartLifetime=Math.max(this._maxStartLifetime,startLifeTimeGradientMin.getValueByIndex(i));}var startLifeTimeGradientMax=startLifeTimeGradientMax;for(i=0,n=startLifeTimeGradientMax.gradientCount;i<n;i++){this._maxStartLifetime=Math.max(this._maxStartLifetime,startLifeTimeGradientMax.getValueByIndex(i));}break;}this._startLifetimeType=value;}},{key:"startLifetimeConstant",get:function get(){return this._startLifetimeConstant;},set:function set(value){if(this._startLifetimeType===0)this._maxStartLifetime=value;this._startLifetimeConstant=value;}},{key:"startLifeTimeGradient",get:function get(){return this._startLifeTimeGradient;},set:function set(value){if(this._startLifetimeType===1){this._maxStartLifetime=-Number.MAX_VALUE;for(var i=0,n=value.gradientCount;i<n;i++){this._maxStartLifetime=Math.max(this._maxStartLifetime,value.getValueByIndex(i));}}this._startLifeTimeGradient=value;}},{key:"startLifetimeConstantMin",get:function get(){return this._startLifetimeConstantMin;},set:function set(value){if(this._startLifetimeType===2)this._maxStartLifetime=Math.max(value,this._startLifetimeConstantMax);this._startLifetimeConstantMin=value;}},{key:"startLifetimeConstantMax",get:function get(){return this._startLifetimeConstantMax;},set:function set(value){if(this._startLifetimeType===2)this._maxStartLifetime=Math.max(this._startLifetimeConstantMin,value);this._startLifetimeConstantMax=value;}},{key:"startLifeTimeGradientMin",get:function get(){return this._startLifeTimeGradientMin;},set:function set(value){if(this._startLifetimeType===3){var i,n;this._maxStartLifetime=-Number.MAX_VALUE;for(i=0,n=value.gradientCount;i<n;i++){this._maxStartLifetime=Math.max(this._maxStartLifetime,value.getValueByIndex(i));}for(i=0,n=this._startLifeTimeGradientMax.gradientCount;i<n;i++){this._maxStartLifetime=Math.max(this._maxStartLifetime,this._startLifeTimeGradientMax.getValueByIndex(i));}}this._startLifeTimeGradientMin=value;}},{key:"startLifeTimeGradientMax",get:function get(){return this._startLifeTimeGradientMax;},set:function set(value){if(this._startLifetimeType===3){var i,n;this._maxStartLifetime=-Number.MAX_VALUE;for(i=0,n=this._startLifeTimeGradientMin.gradientCount;i<n;i++){this._maxStartLifetime=Math.max(this._maxStartLifetime,this._startLifeTimeGradientMin.getValueByIndex(i));}for(i=0,n=value.gradientCount;i<n;i++){this._maxStartLifetime=Math.max(this._maxStartLifetime,value.getValueByIndex(i));}}this._startLifeTimeGradientMax=value;}},{key:"velocityOverLifetime",get:function get(){return this._velocityOverLifetime;},set:function set(value){var shaDat=this._owner._render._shaderValues;if(value){var velocity=value.velocity;var velocityType=velocity.type;if(value.enable){switch(velocityType){case 0:shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT);break;case 1:shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE);break;case 2:shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT);break;case 3:shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE);break;}}else {shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE);}switch(velocityType){case 0:shaDat.setVector3(ShuriKenParticle3DShaderDeclaration.VOLVELOCITYCONST,velocity.constant);break;case 1:shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.VOLVELOCITYGRADIENTX,velocity.gradientX._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.VOLVELOCITYGRADIENTY,velocity.gradientY._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.VOLVELOCITYGRADIENTZ,velocity.gradientZ._elements);break;case 2:shaDat.setVector3(ShuriKenParticle3DShaderDeclaration.VOLVELOCITYCONST,velocity.constantMin);shaDat.setVector3(ShuriKenParticle3DShaderDeclaration.VOLVELOCITYCONSTMAX,velocity.constantMax);break;case 3:shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.VOLVELOCITYGRADIENTX,velocity.gradientXMin._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.VOLVELOCITYGRADIENTXMAX,velocity.gradientXMax._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.VOLVELOCITYGRADIENTY,velocity.gradientYMin._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.VOLVELOCITYGRADIENTYMAX,velocity.gradientYMax._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.VOLVELOCITYGRADIENTZ,velocity.gradientZMin._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.VOLVELOCITYGRADIENTZMAX,velocity.gradientZMax._elements);break;}shaDat.setInt(ShuriKenParticle3DShaderDeclaration.VOLSPACETYPE,value.space);}else {shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE);}this._velocityOverLifetime=value;}},{key:"colorOverLifetime",get:function get(){return this._colorOverLifetime;},set:function set(value){var shaDat=this._owner._render._shaderValues;if(value){var color=value.color;if(value.enable){switch(color.type){case 1:shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_COLOROVERLIFETIME);break;case 3:shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RANDOMCOLOROVERLIFETIME);break;}}else {shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_COLOROVERLIFETIME);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RANDOMCOLOROVERLIFETIME);}switch(color.type){case 1:var gradientColor=color.gradient;shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.COLOROVERLIFEGRADIENTALPHAS,gradientColor._alphaElements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.COLOROVERLIFEGRADIENTCOLORS,gradientColor._rgbElements);break;case 3:var minGradientColor=color.gradientMin;var maxGradientColor=color.gradientMax;shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.COLOROVERLIFEGRADIENTALPHAS,minGradientColor._alphaElements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.COLOROVERLIFEGRADIENTCOLORS,minGradientColor._rgbElements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.MAXCOLOROVERLIFEGRADIENTALPHAS,maxGradientColor._alphaElements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.MAXCOLOROVERLIFEGRADIENTCOLORS,maxGradientColor._rgbElements);break;}}else {shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_COLOROVERLIFETIME);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RANDOMCOLOROVERLIFETIME);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.COLOROVERLIFEGRADIENTALPHAS,gradientColor._alphaElements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.COLOROVERLIFEGRADIENTCOLORS,gradientColor._rgbElements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.COLOROVERLIFEGRADIENTALPHAS,minGradientColor._alphaElements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.COLOROVERLIFEGRADIENTCOLORS,minGradientColor._rgbElements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.MAXCOLOROVERLIFEGRADIENTALPHAS,maxGradientColor._alphaElements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.MAXCOLOROVERLIFEGRADIENTCOLORS,maxGradientColor._rgbElements);}this._colorOverLifetime=value;}},{key:"sizeOverLifetime",get:function get(){return this._sizeOverLifetime;},set:function set(value){var shaDat=this._owner._render._shaderValues;if(value){var size=value.size;var sizeSeparate=size.separateAxes;var sizeType=size.type;if(value.enable){switch(sizeType){case 0:if(sizeSeparate)shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE);else shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SIZEOVERLIFETIMECURVE);break;case 2:if(sizeSeparate)shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE);else shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES);break;}}else {shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SIZEOVERLIFETIMECURVE);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE);}switch(sizeType){case 0:if(sizeSeparate){shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.SOLSIZEGRADIENTX,size.gradientX._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.SOLSIZEGRADIENTY,size.gradientY._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.SOLSizeGradientZ,size.gradientZ._elements);}else {shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.SOLSIZEGRADIENT,size.gradient._elements);}break;case 2:if(sizeSeparate){shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.SOLSIZEGRADIENTX,size.gradientXMin._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.SOLSIZEGRADIENTXMAX,size.gradientXMax._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.SOLSIZEGRADIENTY,size.gradientYMin._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.SOLSIZEGRADIENTYMAX,size.gradientYMax._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.SOLSizeGradientZ,size.gradientZMin._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.SOLSizeGradientZMAX,size.gradientZMax._elements);}else {shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.SOLSIZEGRADIENT,size.gradientMin._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.SOLSizeGradientMax,size.gradientMax._elements);}break;}}else {shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SIZEOVERLIFETIMECURVE);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE);}this._sizeOverLifetime=value;}},{key:"rotationOverLifetime",get:function get(){return this._rotationOverLifetime;},set:function set(value){var shaDat=this._owner._render._shaderValues;if(value){var rotation=value.angularVelocity;if(!rotation)return;var rotationSeparate=rotation.separateAxes;var rotationType=rotation.type;if(value.enable){if(rotationSeparate)shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE);else shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIME);switch(rotationType){case 0:shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT);break;case 1:shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE);break;case 2:shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS);break;case 3:shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES);break;}}else {shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIME);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES);}switch(rotationType){case 0:if(rotationSeparate){shaDat.setVector3(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYCONSTSEPRARATE,rotation.constantSeparate);}else {shaDat.setNumber(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYCONST,rotation.constant);}break;case 1:if(rotationSeparate){shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTX,rotation.gradientX._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTY,rotation.gradientY._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTZ,rotation.gradientZ._elements);}else {shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENT,rotation.gradient._elements);}break;case 2:if(rotationSeparate){shaDat.setVector3(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYCONSTSEPRARATE,rotation.constantMinSeparate);shaDat.setVector3(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYCONSTMAXSEPRARATE,rotation.constantMaxSeparate);}else {shaDat.setNumber(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYCONST,rotation.constantMin);shaDat.setNumber(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYCONSTMAX,rotation.constantMax);}break;case 3:if(rotationSeparate){shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTX,rotation.gradientXMin._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTXMAX,rotation.gradientXMax._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTY,rotation.gradientYMin._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTYMAX,rotation.gradientYMax._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTZ,rotation.gradientZMin._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTZMAX,rotation.gradientZMax._elements);}else {shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENT,rotation.gradientMin._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.ROLANGULARVELOCITYGRADIENTMAX,rotation.gradientMax._elements);}break;}}else {shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIME);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES);}this._rotationOverLifetime=value;}},{key:"textureSheetAnimation",get:function get(){return this._textureSheetAnimation;},set:function set(value){var shaDat=this._owner._render._shaderValues;if(value){var frameOverTime=value.frame;var textureAniType=frameOverTime.type;if(value.enable){switch(textureAniType){case 1:shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE);break;case 3:shaDat.addDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE);break;}}else {shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE);}if(textureAniType===1||textureAniType===3){shaDat.setNumber(ShuriKenParticle3DShaderDeclaration.TEXTURESHEETANIMATIONCYCLES,value.cycles);var title=value.tiles;var _uvLengthE=this._uvLength;_uvLengthE.x=1.0/title.x;_uvLengthE.y=1.0/title.y;shaDat.setVector2(ShuriKenParticle3DShaderDeclaration.TEXTURESHEETANIMATIONSUBUVLENGTH,this._uvLength);}switch(textureAniType){case 1:shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.TEXTURESHEETANIMATIONGRADIENTUVS,frameOverTime.frameOverTimeData._elements);break;case 3:shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.TEXTURESHEETANIMATIONGRADIENTUVS,frameOverTime.frameOverTimeDataMin._elements);shaDat.setBuffer(ShuriKenParticle3DShaderDeclaration.TEXTURESHEETANIMATIONGRADIENTMAXUVS,frameOverTime.frameOverTimeDataMax._elements);break;}}else {shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE);shaDat.removeDefine(ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE);}this._textureSheetAnimation=value;}},{key:"customBounds",get:function get(){return this._customBounds;},set:function set(value){if(value){this._useCustomBounds=true;}else {this._useCustomBounds=false;}this._customBounds=value;}}]);return ShurikenParticleSystem;}(GeometryElement);ShurikenParticleSystem._RANDOMOFFSET=new Uint32Array([0x23571a3e,0xc34f56fe,0x13371337,0x12460f3b,0x6aed452e,0xdec4aea1,0x96aa4de3,0x8d2c8431,0xf3857f6f,0xe0fbd834,0x13740583,0x591bc05c,0x40eb95e4,0xbc524e5f,0xaf502044,0xa614b381,0x1034e524,0xfc524e5f]);ShurikenParticleSystem.halfKSqrtOf2=1.42*0.5;ShurikenParticleSystem.g=9.8;ShurikenParticleSystem._maxElapsedTime=1.0/3.0;ShurikenParticleSystem._tempVector30=new Vector3();ShurikenParticleSystem._tempVector31=new Vector3();ShurikenParticleSystem._tempVector32=new Vector3();ShurikenParticleSystem._tempVector33=new Vector3();ShurikenParticleSystem._tempVector34=new Vector3();ShurikenParticleSystem._tempVector35=new Vector3();ShurikenParticleSystem._tempVector36=new Vector3();ShurikenParticleSystem._tempVector37=new Vector3();ShurikenParticleSystem._tempVector38=new Vector3();ShurikenParticleSystem._tempVector39=new Vector3();ShurikenParticleSystem._tempPosition=new Vector3();ShurikenParticleSystem._tempDirection=new Vector3();ShurikenParticleSystem._type=GeometryElement._typeCounter++;var ShuriKenParticle3D=/*#__PURE__*/function(_RenderableSprite3D3){_inheritsLoose(ShuriKenParticle3D,_RenderableSprite3D3);function ShuriKenParticle3D(){var _this73;_this73=_RenderableSprite3D3.call(this,null)||this;_this73._render=new ShurikenParticleRenderer(_assertThisInitialized(_this73));_this73._particleSystem=new ShurikenParticleSystem(_assertThisInitialized(_this73));var elements=_this73._render._renderElements;var element=elements[0]=new RenderElement();element.setTransform(_this73._transform);element.render=_this73._render;element.setGeometry(_this73._particleSystem);element.material=ShurikenParticleMaterial.defaultMaterial;return _this73;}ShuriKenParticle3D.__init__=function __init__(){ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RENDERMODE_BILLBOARD=Shader3D.getDefineByName("SPHERHBILLBOARD");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RENDERMODE_STRETCHEDBILLBOARD=Shader3D.getDefineByName("STRETCHEDBILLBOARD");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RENDERMODE_HORIZONTALBILLBOARD=Shader3D.getDefineByName("HORIZONTALBILLBOARD");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RENDERMODE_VERTICALBILLBOARD=Shader3D.getDefineByName("VERTICALBILLBOARD");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_COLOROVERLIFETIME=Shader3D.getDefineByName("COLOROVERLIFETIME");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RANDOMCOLOROVERLIFETIME=Shader3D.getDefineByName("RANDOMCOLOROVERLIFETIME");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT=Shader3D.getDefineByName("VELOCITYOVERLIFETIMECONSTANT");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE=Shader3D.getDefineByName("VELOCITYOVERLIFETIMECURVE");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT=Shader3D.getDefineByName("VELOCITYOVERLIFETIMERANDOMCONSTANT");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE=Shader3D.getDefineByName("VELOCITYOVERLIFETIMERANDOMCURVE");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE=Shader3D.getDefineByName("TEXTURESHEETANIMATIONCURVE");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE=Shader3D.getDefineByName("TEXTURESHEETANIMATIONRANDOMCURVE");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIME=Shader3D.getDefineByName("ROTATIONOVERLIFETIME");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE=Shader3D.getDefineByName("ROTATIONOVERLIFETIMESEPERATE");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT=Shader3D.getDefineByName("ROTATIONOVERLIFETIMECONSTANT");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE=Shader3D.getDefineByName("ROTATIONOVERLIFETIMECURVE");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS=Shader3D.getDefineByName("ROTATIONOVERLIFETIMERANDOMCONSTANTS");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES=Shader3D.getDefineByName("ROTATIONOVERLIFETIMERANDOMCURVES");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SIZEOVERLIFETIMECURVE=Shader3D.getDefineByName("SIZEOVERLIFETIMECURVE");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE=Shader3D.getDefineByName("SIZEOVERLIFETIMECURVESEPERATE");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES=Shader3D.getDefineByName("SIZEOVERLIFETIMERANDOMCURVES");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE=Shader3D.getDefineByName("SIZEOVERLIFETIMERANDOMCURVESSEPERATE");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_RENDERMODE_MESH=Shader3D.getDefineByName("RENDERMODE_MESH");ShuriKenParticle3DShaderDeclaration.SHADERDEFINE_SHAPE=Shader3D.getDefineByName("SHAPE");};var _proto151=ShuriKenParticle3D.prototype;_proto151._parseModule=function _parseModule(module,moduleData){for(var t in moduleData){switch(t){case"bases":var bases=moduleData.bases;for(var k in bases){module[k]=bases[k];}break;case"vector2s":var vector2s=moduleData.vector2s;for(var k in vector2s){var vec2=module[k];var vec2Data=vector2s[k];vec2.setValue(vec2Data[0],vec2Data[1]);module[k]=vec2;}break;case"vector3s":var vector3s=moduleData.vector3s;for(var k in vector3s){var vec3=module[k];var vec3Data=vector3s[k];vec3.setValue(vec3Data[0],vec3Data[1],vec3Data[2]);module[k]=vec3;}break;case"vector4s":var vector4s=moduleData.vector4s;for(var k in vector4s){var vec4=module[k];var vec4Data=vector4s[k];vec4.setValue(vec4Data[0],vec4Data[1],vec4Data[2],vec4Data[3]);module[k]=vec4;}break;case"gradientDataNumbers":var gradientDataNumbers=moduleData.gradientDataNumbers;for(var k in gradientDataNumbers){var gradientNumber=module[k];var gradientNumberData=moduleData[k];for(var i=0,n=gradientNumberData.length;i<n;i++){var valueData=gradientNumberData[i];gradientNumber.add(valueData.key,valueData.value);}module[k]=gradientNumber;}break;case"resources":var resources=moduleData.resources;for(var k in resources){module[k]=Laya.Loader.getRes(resources[k]);}break;case"bursts":var burstsData=moduleData.bursts;for(var i=0,n=burstsData.length;i<n;i++){var brust=burstsData[i];module.addBurst(new Burst(brust.time,brust.min,brust.max));}break;case"randomSeed":module.randomSeed[0]=moduleData.randomSeed;break;case"shapeType":case"type":case"color":case"size":case"frame":case"startFrame":case"angularVelocity":case"velocity":break;default:throw "ShurikenParticle3D:unknown type.";}}};_proto151._parse=function _parse(data,spriteMap){_RenderableSprite3D3.prototype._parse.call(this,data,spriteMap);if(data.main){var particleSystem=this.particleSystem;var particleRender=this.particleRenderer;this._parseModule(particleRender,data.renderer);this._parseModule(particleSystem,data.main);this._parseModule(particleSystem.emission,data.emission);var shapeData=data.shape;if(shapeData){var shape;switch(shapeData.shapeType){case 0:shape=new SphereShape();break;case 1:shape=new HemisphereShape();break;case 2:shape=new ConeShape();break;case 3:shape=new BoxShape();break;case 7:shape=new CircleShape();break;default:throw "ShuriKenParticle3D:unknown shape type.";}this._parseModule(shape,shapeData);particleSystem.shape=shape;}var velocityOverLifetimeData=data.velocityOverLifetime;if(velocityOverLifetimeData){var velocityData=velocityOverLifetimeData.velocity;var velocity;switch(velocityData.type){case 0:var constantData=velocityData.constant;velocity=GradientVelocity.createByConstant(constantData?new Vector3(constantData[0],constantData[1],constantData[2]):new Vector3(0,0,0));break;case 1:velocity=GradientVelocity.createByGradient(this._initParticleVelocity(velocityData.gradientX),this._initParticleVelocity(velocityData.gradientY),this._initParticleVelocity(velocityData.gradientZ));break;case 2:var constantMinData=velocityData.constantMin;var constantMaxData=velocityData.constantMax;velocity=GradientVelocity.createByRandomTwoConstant(constantMinData?new Vector3(constantMinData[0],constantMinData[1],constantMinData[2]):new Vector3(0,0,0),constantMaxData?new Vector3(constantMaxData[0],constantMaxData[1],constantMaxData[2]):new Vector3(0,0,0));break;case 3:velocity=GradientVelocity.createByRandomTwoGradient(this._initParticleVelocity(velocityData.gradientXMin),this._initParticleVelocity(velocityData.gradientXMax),this._initParticleVelocity(velocityData.gradientYMin),this._initParticleVelocity(velocityData.gradientYMax),this._initParticleVelocity(velocityData.gradientZMin),this._initParticleVelocity(velocityData.gradientZMax));break;}var velocityOverLifetime=new VelocityOverLifetime(velocity);this._parseModule(velocityOverLifetime,velocityOverLifetimeData);particleSystem.velocityOverLifetime=velocityOverLifetime;}var colorOverLifetimeData=data.colorOverLifetime;if(colorOverLifetimeData){var colorData=colorOverLifetimeData.color;var color;switch(colorData.type){case 0:var constColorData=colorData.constant;color=GradientColor.createByConstant(constColorData?new Vector4(constColorData[0],constColorData[1],constColorData[2],constColorData[3]):new Vector4(0,0,0,0));break;case 1:color=GradientColor.createByGradient(this._initParticleColor(colorData.gradient));break;case 2:var minConstColorData=colorData.constantMin;var maxConstColorData=colorData.constantMax;color=GradientColor.createByRandomTwoConstant(minConstColorData?new Vector4(minConstColorData[0],minConstColorData[1],minConstColorData[2],minConstColorData[3]):new Vector4(0,0,0,0),minConstColorData?new Vector4(maxConstColorData[0],maxConstColorData[1],maxConstColorData[2],maxConstColorData[3]):new Vector4(0,0,0,0));break;case 3:color=GradientColor.createByRandomTwoGradient(this._initParticleColor(colorData.gradientMin),this._initParticleColor(colorData.gradientMax));break;}var colorOverLifetime=new ColorOverLifetime(color);this._parseModule(colorOverLifetime,colorOverLifetimeData);particleSystem.colorOverLifetime=colorOverLifetime;}var sizeOverLifetimeData=data.sizeOverLifetime;if(sizeOverLifetimeData){var sizeData=sizeOverLifetimeData.size;var size;switch(sizeData.type){case 0:if(sizeData.separateAxes){size=GradientSize.createByGradientSeparate(this._initParticleSize(sizeData.gradientX),this._initParticleSize(sizeData.gradientY),this._initParticleSize(sizeData.gradientZ));}else {size=GradientSize.createByGradient(this._initParticleSize(sizeData.gradient));}break;case 1:if(sizeData.separateAxes){var constantMinSeparateData=sizeData.constantMinSeparate;var constantMaxSeparateData=sizeData.constantMaxSeparate;size=GradientSize.createByRandomTwoConstantSeparate(constantMinSeparateData?new Vector3(constantMinSeparateData[0],constantMinSeparateData[1],constantMinSeparateData[2]):new Vector3(0,0,0),constantMaxSeparateData?new Vector3(constantMaxSeparateData[0],constantMaxSeparateData[1],constantMaxSeparateData[2]):new Vector3(0,0,0));}else {size=GradientSize.createByRandomTwoConstant(sizeData.constantMin||0,sizeData.constantMax||0);}break;case 2:if(sizeData.separateAxes){size=GradientSize.createByRandomTwoGradientSeparate(this._initParticleSize(sizeData.gradientXMin),this._initParticleSize(sizeData.gradientYMin),this._initParticleSize(sizeData.gradientZMin),this._initParticleSize(sizeData.gradientXMax),this._initParticleSize(sizeData.gradientYMax),this._initParticleSize(sizeData.gradientZMax));}else {size=GradientSize.createByRandomTwoGradient(this._initParticleSize(sizeData.gradientMin),this._initParticleSize(sizeData.gradientMax));}break;}var sizeOverLifetime=new SizeOverLifetime(size);this._parseModule(sizeOverLifetime,sizeOverLifetimeData);particleSystem.sizeOverLifetime=sizeOverLifetime;}var rotationOverLifetimeData=data.rotationOverLifetime;if(rotationOverLifetimeData){var angularVelocityData=rotationOverLifetimeData.angularVelocity;var angularVelocity;switch(angularVelocityData.type){case 0:if(angularVelocityData.separateAxes){var conSep=angularVelocityData.constantSeparate;angularVelocity=GradientAngularVelocity.createByConstantSeparate(conSep?new Vector3(conSep[0],conSep[1],conSep[2]):new Vector3(0,0,Math.PI/4));}else {angularVelocity=GradientAngularVelocity.createByConstant(angularVelocityData.constant||Math.PI/4);}break;case 1:if(angularVelocityData.separateAxes){angularVelocity=GradientAngularVelocity.createByGradientSeparate(this._initParticleRotation(angularVelocityData.gradientX),this._initParticleRotation(angularVelocityData.gradientY),this._initParticleRotation(angularVelocityData.gradientZ));}else {angularVelocity=GradientAngularVelocity.createByGradient(this._initParticleRotation(angularVelocityData.gradient));}break;case 2:if(angularVelocityData.separateAxes){var minSep=angularVelocityData.constantMinSeparate;var maxSep=angularVelocityData.constantMaxSeparate;angularVelocity=GradientAngularVelocity.createByRandomTwoConstantSeparate(minSep?new Vector3(minSep[0],minSep[1],minSep[2]):new Vector3(0,0,0),maxSep?new Vector3(maxSep[0],maxSep[1],maxSep[2]):new Vector3(0,0,Math.PI/4));}else {angularVelocity=GradientAngularVelocity.createByRandomTwoConstant(angularVelocityData.constantMin||0,angularVelocityData.constantMax||Math.PI/4);}break;case 3:if(angularVelocityData.separateAxes);else {angularVelocity=GradientAngularVelocity.createByRandomTwoGradient(this._initParticleRotation(angularVelocityData.gradientMin),this._initParticleRotation(angularVelocityData.gradientMax));}break;}var rotationOverLifetime=new RotationOverLifetime(angularVelocity);this._parseModule(rotationOverLifetime,rotationOverLifetimeData);particleSystem.rotationOverLifetime=rotationOverLifetime;}var textureSheetAnimationData=data.textureSheetAnimation;if(textureSheetAnimationData){var frameData=textureSheetAnimationData.frame;var frameOverTime;switch(frameData.type){case 0:frameOverTime=FrameOverTime.createByConstant(frameData.constant);break;case 1:frameOverTime=FrameOverTime.createByOverTime(this._initParticleFrame(frameData.overTime));break;case 2:frameOverTime=FrameOverTime.createByRandomTwoConstant(frameData.constantMin,frameData.constantMax);break;case 3:frameOverTime=FrameOverTime.createByRandomTwoOverTime(this._initParticleFrame(frameData.overTimeMin),this._initParticleFrame(frameData.overTimeMax));break;}var startFrameData=textureSheetAnimationData.startFrame;var startFrame;switch(startFrameData.type){case 0:startFrame=StartFrame.createByConstant(startFrameData.constant);break;case 1:startFrame=StartFrame.createByRandomTwoConstant(startFrameData.constantMin,startFrameData.constantMax);break;}var textureSheetAnimation=new TextureSheetAnimation(frameOverTime,startFrame);this._parseModule(textureSheetAnimation,textureSheetAnimationData);particleSystem.textureSheetAnimation=textureSheetAnimation;}}else {this._parseOld(data);}};_proto151._activeHierarchy=function _activeHierarchy(activeChangeComponents){_RenderableSprite3D3.prototype._activeHierarchy.call(this,activeChangeComponents);this.particleSystem.playOnAwake&&this.particleSystem.play();};_proto151._inActiveHierarchy=function _inActiveHierarchy(activeChangeComponents){_RenderableSprite3D3.prototype._inActiveHierarchy.call(this,activeChangeComponents);this.particleSystem.isAlive&&this.particleSystem.simulate(0,true);};_proto151._cloneTo=function _cloneTo(destObject,srcSprite,dstSprite){var destShuriKenParticle3D=destObject;var destParticleSystem=destShuriKenParticle3D._particleSystem;this._particleSystem.cloneTo(destParticleSystem);var destParticleRender=destShuriKenParticle3D._render;var particleRender=this._render;destParticleRender.sharedMaterials=particleRender.sharedMaterials;destParticleRender.enable=particleRender.enable;destParticleRender.renderMode=particleRender.renderMode;destParticleRender.mesh=particleRender.mesh;destParticleRender.stretchedBillboardCameraSpeedScale=particleRender.stretchedBillboardCameraSpeedScale;destParticleRender.stretchedBillboardSpeedScale=particleRender.stretchedBillboardSpeedScale;destParticleRender.stretchedBillboardLengthScale=particleRender.stretchedBillboardLengthScale;destParticleRender.sortingFudge=particleRender.sortingFudge;_RenderableSprite3D3.prototype._cloneTo.call(this,destObject,srcSprite,dstSprite);};_proto151.destroy=function destroy(destroyChild){if(destroyChild===void 0){destroyChild=true;}if(this.destroyed)return;_RenderableSprite3D3.prototype.destroy.call(this,destroyChild);this._particleSystem.destroy();this._particleSystem=null;};_proto151._create=function _create(){return new ShuriKenParticle3D();};_proto151._parseOld=function _parseOld(data){var anglelToRad=Math.PI/180.0;var i,n;var particleRender=this.particleRenderer;var material;var materialData=data.material;materialData&&(material=Laya.Loader.getRes(materialData.path));particleRender.sharedMaterial=material;var meshPath=data.meshPath;meshPath&&(particleRender.mesh=Laya.Loader.getRes(meshPath));particleRender.renderMode=data.renderMode;particleRender.stretchedBillboardCameraSpeedScale=data.stretchedBillboardCameraSpeedScale;particleRender.stretchedBillboardSpeedScale=data.stretchedBillboardSpeedScale;particleRender.stretchedBillboardLengthScale=data.stretchedBillboardLengthScale;particleRender.sortingFudge=data.sortingFudge?data.sortingFudge:0.0;var particleSystem=this.particleSystem;particleSystem.isPerformanceMode=data.isPerformanceMode;particleSystem.duration=data.duration;particleSystem.looping=data.looping;particleSystem.prewarm=data.prewarm;particleSystem.startDelayType=data.startDelayType;particleSystem.startDelay=data.startDelay;particleSystem.startDelayMin=data.startDelayMin;particleSystem.startDelayMax=data.startDelayMax;particleSystem.startLifetimeType=data.startLifetimeType;particleSystem.startLifetimeConstant=data.startLifetimeConstant;particleSystem.startLifeTimeGradient=ShuriKenParticle3D._initStartLife(data.startLifetimeGradient);particleSystem.startLifetimeConstantMin=data.startLifetimeConstantMin;particleSystem.startLifetimeConstantMax=data.startLifetimeConstantMax;particleSystem.startLifeTimeGradientMin=ShuriKenParticle3D._initStartLife(data.startLifetimeGradientMin);particleSystem.startLifeTimeGradientMax=ShuriKenParticle3D._initStartLife(data.startLifetimeGradientMax);particleSystem.startSpeedType=data.startSpeedType;particleSystem.startSpeedConstant=data.startSpeedConstant;particleSystem.startSpeedConstantMin=data.startSpeedConstantMin;particleSystem.startSpeedConstantMax=data.startSpeedConstantMax;particleSystem.threeDStartSize=data.threeDStartSize;particleSystem.startSizeType=data.startSizeType;particleSystem.startSizeConstant=data.startSizeConstant;var startSizeConstantSeparateArray=data.startSizeConstantSeparate;var startSizeConstantSeparateElement=particleSystem.startSizeConstantSeparate;startSizeConstantSeparateElement.x=startSizeConstantSeparateArray[0];startSizeConstantSeparateElement.y=startSizeConstantSeparateArray[1];startSizeConstantSeparateElement.z=startSizeConstantSeparateArray[2];particleSystem.startSizeConstantMin=data.startSizeConstantMin;particleSystem.startSizeConstantMax=data.startSizeConstantMax;var startSizeConstantMinSeparateArray=data.startSizeConstantMinSeparate;var startSizeConstantMinSeparateElement=particleSystem.startSizeConstantMinSeparate;startSizeConstantMinSeparateElement.x=startSizeConstantMinSeparateArray[0];startSizeConstantMinSeparateElement.y=startSizeConstantMinSeparateArray[1];startSizeConstantMinSeparateElement.z=startSizeConstantMinSeparateArray[2];var startSizeConstantMaxSeparateArray=data.startSizeConstantMaxSeparate;var startSizeConstantMaxSeparateElement=particleSystem.startSizeConstantMaxSeparate;startSizeConstantMaxSeparateElement.x=startSizeConstantMaxSeparateArray[0];startSizeConstantMaxSeparateElement.y=startSizeConstantMaxSeparateArray[1];startSizeConstantMaxSeparateElement.z=startSizeConstantMaxSeparateArray[2];particleSystem.threeDStartRotation=data.threeDStartRotation;particleSystem.startRotationType=data.startRotationType;particleSystem.startRotationConstant=data.startRotationConstant*anglelToRad;var startRotationConstantSeparateArray=data.startRotationConstantSeparate;var startRotationConstantSeparateElement=particleSystem.startRotationConstantSeparate;startRotationConstantSeparateElement.x=startRotationConstantSeparateArray[0]*anglelToRad;startRotationConstantSeparateElement.y=startRotationConstantSeparateArray[1]*anglelToRad;startRotationConstantSeparateElement.z=startRotationConstantSeparateArray[2]*anglelToRad;particleSystem.startRotationConstantMin=data.startRotationConstantMin*anglelToRad;particleSystem.startRotationConstantMax=data.startRotationConstantMax*anglelToRad;var startRotationConstantMinSeparateArray=data.startRotationConstantMinSeparate;var startRotationConstantMinSeparateElement=particleSystem.startRotationConstantMinSeparate;startRotationConstantMinSeparateElement.x=startRotationConstantMinSeparateArray[0]*anglelToRad;startRotationConstantMinSeparateElement.y=startRotationConstantMinSeparateArray[1]*anglelToRad;startRotationConstantMinSeparateElement.z=startRotationConstantMinSeparateArray[2]*anglelToRad;var startRotationConstantMaxSeparateArray=data.startRotationConstantMaxSeparate;var startRotationConstantMaxSeparateElement=particleSystem.startRotationConstantMaxSeparate;startRotationConstantMaxSeparateElement.x=startRotationConstantMaxSeparateArray[0]*anglelToRad;startRotationConstantMaxSeparateElement.y=startRotationConstantMaxSeparateArray[1]*anglelToRad;startRotationConstantMaxSeparateElement.z=startRotationConstantMaxSeparateArray[2]*anglelToRad;particleSystem.randomizeRotationDirection=data.randomizeRotationDirection;particleSystem.startColorType=data.startColorType;var startColorConstantArray=data.startColorConstant;var startColorConstantElement=particleSystem.startColorConstant;startColorConstantElement.x=startColorConstantArray[0];startColorConstantElement.y=startColorConstantArray[1];startColorConstantElement.z=startColorConstantArray[2];startColorConstantElement.w=startColorConstantArray[3];var startColorConstantMinArray=data.startColorConstantMin;var startColorConstantMinElement=particleSystem.startColorConstantMin;startColorConstantMinElement.x=startColorConstantMinArray[0];startColorConstantMinElement.y=startColorConstantMinArray[1];startColorConstantMinElement.z=startColorConstantMinArray[2];startColorConstantMinElement.w=startColorConstantMinArray[3];var startColorConstantMaxArray=data.startColorConstantMax;var startColorConstantMaxElement=particleSystem.startColorConstantMax;startColorConstantMaxElement.x=startColorConstantMaxArray[0];startColorConstantMaxElement.y=startColorConstantMaxArray[1];startColorConstantMaxElement.z=startColorConstantMaxArray[2];startColorConstantMaxElement.w=startColorConstantMaxArray[3];particleSystem.gravityModifier=data.gravityModifier;particleSystem.simulationSpace=data.simulationSpace;data.simulationSpeed!==undefined&&(particleSystem.simulationSpeed=data.simulationSpeed);particleSystem.scaleMode=data.scaleMode;particleSystem.playOnAwake=data.playOnAwake;particleSystem.maxParticles=data.maxParticles;var autoRandomSeed=data.autoRandomSeed;autoRandomSeed!=null&&(particleSystem.autoRandomSeed=autoRandomSeed);var randomSeed=data.randomSeed;randomSeed!=null&&(particleSystem.randomSeed[0]=randomSeed);var emissionData=data.emission;var emission=particleSystem.emission;if(emissionData){emission.emissionRate=emissionData.emissionRate;var burstsData=emissionData.bursts;if(burstsData)for(i=0,n=burstsData.length;i<n;i++){var brust=burstsData[i];emission.addBurst(new Burst(brust.time,brust.min,brust.max));}emission.enable=emissionData.enable;}else {emission.enable=false;}var shapeData=data.shape;if(shapeData){var shape;switch(shapeData.shapeType){case 0:var sphereShape;shape=sphereShape=new SphereShape();sphereShape.radius=shapeData.sphereRadius;sphereShape.emitFromShell=shapeData.sphereEmitFromShell;sphereShape.randomDirection=shapeData.sphereRandomDirection;break;case 1:var hemiSphereShape;shape=hemiSphereShape=new HemisphereShape();hemiSphereShape.radius=shapeData.hemiSphereRadius;hemiSphereShape.emitFromShell=shapeData.hemiSphereEmitFromShell;hemiSphereShape.randomDirection=shapeData.hemiSphereRandomDirection;break;case 2:var coneShape;shape=coneShape=new ConeShape();coneShape.angle=shapeData.coneAngle*anglelToRad;coneShape.radius=shapeData.coneRadius;coneShape.length=shapeData.coneLength;coneShape.emitType=shapeData.coneEmitType;coneShape.randomDirection=shapeData.coneRandomDirection;break;case 3:var boxShape;shape=boxShape=new BoxShape();boxShape.x=shapeData.boxX;boxShape.y=shapeData.boxY;boxShape.z=shapeData.boxZ;boxShape.randomDirection=shapeData.boxRandomDirection;break;case 7:var circleShape;shape=circleShape=new CircleShape();circleShape.radius=shapeData.circleRadius;circleShape.arc=shapeData.circleArc*anglelToRad;circleShape.emitFromEdge=shapeData.circleEmitFromEdge;circleShape.randomDirection=shapeData.circleRandomDirection;break;default:var tempShape;shape=tempShape=new CircleShape();tempShape.radius=shapeData.circleRadius;tempShape.arc=shapeData.circleArc*anglelToRad;tempShape.emitFromEdge=shapeData.circleEmitFromEdge;tempShape.randomDirection=shapeData.circleRandomDirection;break;}shape.enable=shapeData.enable;particleSystem.shape=shape;}var velocityOverLifetimeData=data.velocityOverLifetime;if(velocityOverLifetimeData){var velocityData=velocityOverLifetimeData.velocity;var velocity;switch(velocityData.type){case 0:var constantData=velocityData.constant;velocity=GradientVelocity.createByConstant(new Vector3(constantData[0],constantData[1],constantData[2]));break;case 1:velocity=GradientVelocity.createByGradient(this._initParticleVelocity(velocityData.gradientX),this._initParticleVelocity(velocityData.gradientY),this._initParticleVelocity(velocityData.gradientZ));break;case 2:var constantMinData=velocityData.constantMin;var constantMaxData=velocityData.constantMax;velocity=GradientVelocity.createByRandomTwoConstant(new Vector3(constantMinData[0],constantMinData[1],constantMinData[2]),new Vector3(constantMaxData[0],constantMaxData[1],constantMaxData[2]));break;case 3:velocity=GradientVelocity.createByRandomTwoGradient(this._initParticleVelocity(velocityData.gradientXMin),this._initParticleVelocity(velocityData.gradientXMax),this._initParticleVelocity(velocityData.gradientYMin),this._initParticleVelocity(velocityData.gradientYMax),this._initParticleVelocity(velocityData.gradientZMin),this._initParticleVelocity(velocityData.gradientZMax));break;}var velocityOverLifetime=new VelocityOverLifetime(velocity);velocityOverLifetime.space=velocityOverLifetimeData.space;velocityOverLifetime.enable=velocityOverLifetimeData.enable;particleSystem.velocityOverLifetime=velocityOverLifetime;}var colorOverLifetimeData=data.colorOverLifetime;if(colorOverLifetimeData){var colorData=colorOverLifetimeData.color;var color;switch(colorData.type){case 0:var constColorData=colorData.constant;color=GradientColor.createByConstant(new Vector4(constColorData[0],constColorData[1],constColorData[2],constColorData[3]));break;case 1:color=GradientColor.createByGradient(this._initParticleColor(colorData.gradient));break;case 2:var minConstColorData=colorData.constantMin;var maxConstColorData=colorData.constantMax;color=GradientColor.createByRandomTwoConstant(new Vector4(minConstColorData[0],minConstColorData[1],minConstColorData[2],minConstColorData[3]),new Vector4(maxConstColorData[0],maxConstColorData[1],maxConstColorData[2],maxConstColorData[3]));break;case 3:color=GradientColor.createByRandomTwoGradient(this._initParticleColor(colorData.gradientMin),this._initParticleColor(colorData.gradientMax));break;}var colorOverLifetime=new ColorOverLifetime(color);colorOverLifetime.enable=colorOverLifetimeData.enable;particleSystem.colorOverLifetime=colorOverLifetime;}var sizeOverLifetimeData=data.sizeOverLifetime;if(sizeOverLifetimeData){var sizeData=sizeOverLifetimeData.size;var size;switch(sizeData.type){case 0:if(sizeData.separateAxes){size=GradientSize.createByGradientSeparate(this._initParticleSize(sizeData.gradientX),this._initParticleSize(sizeData.gradientY),this._initParticleSize(sizeData.gradientZ));}else {size=GradientSize.createByGradient(this._initParticleSize(sizeData.gradient));}break;case 1:if(sizeData.separateAxes){var constantMinSeparateData=sizeData.constantMinSeparate;var constantMaxSeparateData=sizeData.constantMaxSeparate;size=GradientSize.createByRandomTwoConstantSeparate(new Vector3(constantMinSeparateData[0],constantMinSeparateData[1],constantMinSeparateData[2]),new Vector3(constantMaxSeparateData[0],constantMaxSeparateData[1],constantMaxSeparateData[2]));}else {size=GradientSize.createByRandomTwoConstant(sizeData.constantMin,sizeData.constantMax);}break;case 2:if(sizeData.separateAxes){size=GradientSize.createByRandomTwoGradientSeparate(this._initParticleSize(sizeData.gradientXMin),this._initParticleSize(sizeData.gradientYMin),this._initParticleSize(sizeData.gradientZMin),this._initParticleSize(sizeData.gradientXMax),this._initParticleSize(sizeData.gradientYMax),this._initParticleSize(sizeData.gradientZMax));}else {size=GradientSize.createByRandomTwoGradient(this._initParticleSize(sizeData.gradientMin),this._initParticleSize(sizeData.gradientMax));}break;}var sizeOverLifetime=new SizeOverLifetime(size);sizeOverLifetime.enable=sizeOverLifetimeData.enable;particleSystem.sizeOverLifetime=sizeOverLifetime;}var rotationOverLifetimeData=data.rotationOverLifetime;if(rotationOverLifetimeData){var angularVelocityData=rotationOverLifetimeData.angularVelocity;var angularVelocity;switch(angularVelocityData.type){case 0:if(angularVelocityData.separateAxes){var conSep=angularVelocityData.constantSeparate;angularVelocity=GradientAngularVelocity.createByConstantSeparate(new Vector3(conSep[0]*anglelToRad,conSep[1]*anglelToRad,conSep[2]*anglelToRad));}else {angularVelocity=GradientAngularVelocity.createByConstant(angularVelocityData.constant*anglelToRad);}break;case 1:if(angularVelocityData.separateAxes){angularVelocity=GradientAngularVelocity.createByGradientSeparate(this._initParticleRotation(angularVelocityData.gradientX),this._initParticleRotation(angularVelocityData.gradientY),this._initParticleRotation(angularVelocityData.gradientZ));}else {angularVelocity=GradientAngularVelocity.createByGradient(this._initParticleRotation(angularVelocityData.gradient));}break;case 2:if(angularVelocityData.separateAxes){var minSep=angularVelocityData.constantMinSeparate;var maxSep=angularVelocityData.constantMaxSeparate;angularVelocity=GradientAngularVelocity.createByRandomTwoConstantSeparate(new Vector3(minSep[0]*anglelToRad,minSep[1]*anglelToRad,minSep[2]*anglelToRad),new Vector3(maxSep[0]*anglelToRad,maxSep[1]*anglelToRad,maxSep[2]*anglelToRad));}else {angularVelocity=GradientAngularVelocity.createByRandomTwoConstant(angularVelocityData.constantMin*anglelToRad,angularVelocityData.constantMax*anglelToRad);}break;case 3:if(angularVelocityData.separateAxes);else {angularVelocity=GradientAngularVelocity.createByRandomTwoGradient(this._initParticleRotation(angularVelocityData.gradientMin),this._initParticleRotation(angularVelocityData.gradientMax));}break;}var rotationOverLifetime=new RotationOverLifetime(angularVelocity);rotationOverLifetime.enable=rotationOverLifetimeData.enable;particleSystem.rotationOverLifetime=rotationOverLifetime;}var textureSheetAnimationData=data.textureSheetAnimation;if(textureSheetAnimationData){var frameData=textureSheetAnimationData.frame;var frameOverTime;switch(frameData.type){case 0:frameOverTime=FrameOverTime.createByConstant(frameData.constant);break;case 1:frameOverTime=FrameOverTime.createByOverTime(this._initParticleFrame(frameData.overTime));break;case 2:frameOverTime=FrameOverTime.createByRandomTwoConstant(frameData.constantMin,frameData.constantMax);break;case 3:frameOverTime=FrameOverTime.createByRandomTwoOverTime(this._initParticleFrame(frameData.overTimeMin),this._initParticleFrame(frameData.overTimeMax));break;}var startFrameData=textureSheetAnimationData.startFrame;var startFrame;switch(startFrameData.type){case 0:startFrame=StartFrame.createByConstant(startFrameData.constant);break;case 1:startFrame=StartFrame.createByRandomTwoConstant(startFrameData.constantMin,startFrameData.constantMax);break;}var textureSheetAnimation=new TextureSheetAnimation(frameOverTime,startFrame);textureSheetAnimation.enable=textureSheetAnimationData.enable;var tilesData=textureSheetAnimationData.tiles;textureSheetAnimation.tiles=new Vector2(tilesData[0],tilesData[1]);textureSheetAnimation.type=textureSheetAnimationData.type;textureSheetAnimation.randomRow=textureSheetAnimationData.randomRow;var rowIndex=textureSheetAnimationData.rowIndex;rowIndex!==undefined&&(textureSheetAnimation.rowIndex=rowIndex);textureSheetAnimation.cycles=textureSheetAnimationData.cycles;particleSystem.textureSheetAnimation=textureSheetAnimation;}};_proto151._initParticleColor=function _initParticleColor(gradientColorData){var gradientColor=new Gradient(4,4);if(!gradientColorData){gradientColor.addColorAlpha(0,1);gradientColor.addColorAlpha(1,1);gradientColor.addColorRGB(0,new Color(1.0,1.0,1.0,1.0));gradientColor.addColorRGB(1,new Color(1.0,1.0,1.0,1.0));}else {var alphasData=gradientColorData.alphas;var i,n;if(!alphasData){gradientColor.addColorAlpha(0,1);gradientColor.addColorAlpha(1,1);}else {for(i=0,n=alphasData.length;i<n;i++){if(i==3&&n>4){i=n-1;console.warn("GradientDataColor warning:alpha data length is large than 4, will ignore the middle data.");}var alphaData=alphasData[i];gradientColor.addColorAlpha(alphaData.key,alphaData.value);}}var rgbsData=gradientColorData.rgbs;if(!rgbsData){gradientColor.addColorRGB(0,new Color(1.0,1.0,1.0,1.0));gradientColor.addColorRGB(1,new Color(1.0,1.0,1.0,1.0));}else {for(i=0,n=rgbsData.length;i<n;i++){if(i==3&&n>4){i=n-1;console.warn("GradientDataColor warning:rgb data length is large than 4, will ignore the middle data.");}var rgbData=rgbsData[i];var rgbValue=rgbData.value;gradientColor.addColorRGB(rgbData.key,new Color(rgbValue[0],rgbValue[1],rgbValue[2],1.0));}}}return gradientColor;};_proto151._initParticleFrame=function _initParticleFrame(overTimeFramesData){var overTimeFrame=new GradientDataInt();if(overTimeFramesData){var framesData=overTimeFramesData.frames;for(var i=0,n=framesData.length;i<n;i++){var frameData=framesData[i];overTimeFrame.add(frameData.key,frameData.value);}}else {overTimeFrame.add(0,0);overTimeFrame.add(1,1);}return overTimeFrame;};ShuriKenParticle3D._initStartLife=function _initStartLife(gradientData){var gradient=new GradientDataNumber();var startLifetimesData=gradientData.startLifetimes;for(var i=0,n=startLifetimesData.length;i<n;i++){var valueData=startLifetimesData[i];gradient.add(valueData.key,valueData.value);}return gradient;};_proto151._initParticleVelocity=function _initParticleVelocity(gradientData){var gradient=new GradientDataNumber();var velocitysData=gradientData.velocitys;for(var i=0,n=velocitysData.length;i<n;i++){var valueData=velocitysData[i];gradient.add(valueData.key,valueData.value);}return gradient;};_proto151._initParticleSize=function _initParticleSize(gradientSizeData){var gradientSize=new GradientDataNumber();if(gradientSizeData){var sizesData=gradientSizeData.sizes;for(var i=0,n=sizesData.length;i<n;i++){var valueData=sizesData[i];gradientSize.add(valueData.key,valueData.value);}}else {gradientSize.add(0,0);gradientSize.add(1,1);}return gradientSize;};_proto151._initParticleRotation=function _initParticleRotation(gradientData){var gradient=new GradientDataNumber();var angularVelocitysData=gradientData.angularVelocitys;for(var i=0,n=angularVelocitysData.length;i<n;i++){var valueData=angularVelocitysData[i];gradient.add(valueData.key,valueData.value/180.0*Math.PI);}return gradient;};_createClass(ShuriKenParticle3D,[{key:"particleSystem",get:function get(){return this._particleSystem;}},{key:"particleRenderer",get:function get(){return this._render;}}]);return ShuriKenParticle3D;}(RenderableSprite3D);var SkinnedMeshSprite3DShaderDeclaration=function SkinnedMeshSprite3DShaderDeclaration(){};var SkinnedMeshRenderer=/*#__PURE__*/function(_MeshRenderer){_inheritsLoose(SkinnedMeshRenderer,_MeshRenderer);function SkinnedMeshRenderer(owner){var _this74;_this74=_MeshRenderer.call(this,owner)||this;_this74._bones=[];_this74._skinnedDataLoopMarks=[];_this74._localBounds=new Bounds(Vector3._ZERO,Vector3._ZERO);_this74._cacheAnimationNode=[];return _this74;}var _proto152=SkinnedMeshRenderer.prototype;_proto152._computeSkinnedData=function _computeSkinnedData(){if(this._cacheMesh&&this._cacheAvatar||this._cacheMesh&&!this._cacheAvatar){var bindPoses=this._cacheMesh._inverseBindPoses;var pathMarks=this._cacheMesh._skinnedMatrixCaches;for(var i=0,n=this._cacheMesh.subMeshCount;i<n;i++){var subMeshBoneIndices=this._cacheMesh.getSubMesh(i)._boneIndicesList;var subData=this._skinnedData[i];for(var j=0,m=subMeshBoneIndices.length;j<m;j++){var boneIndices=subMeshBoneIndices[j];this._computeSubSkinnedData(bindPoses,boneIndices,subData[j],pathMarks);}}}};_proto152._computeSubSkinnedData=function _computeSubSkinnedData(bindPoses,boneIndices,data,matrixCaches){for(var k=0,q=boneIndices.length;k<q;k++){var index=boneIndices[k];if(this._skinnedDataLoopMarks[index]===Laya.Stat.loopCount){var c=matrixCaches[index];var preData=this._skinnedData[c.subMeshIndex][c.batchIndex];var srcIndex=c.batchBoneIndex*16;var dstIndex=k*16;for(var d=0;d<16;d++){data[dstIndex+d]=preData[srcIndex+d];}}else {if(!this._cacheAvatar){Utils3D._mulMatrixArray(this._bones[index].transform.worldMatrix.elements,bindPoses[index].elements,0,data,k*16);}else {Utils3D._mulMatrixArray(this._cacheAnimationNode[index].transform.getWorldMatrix(),bindPoses[index].elements,0,data,k*16);}this._skinnedDataLoopMarks[index]=Laya.Stat.loopCount;}}};_proto152._onWorldMatNeedChange=function _onWorldMatNeedChange(flag){this._boundsChange=true;if(this._octreeNode){if(this._cacheAvatar){if(this._indexInOctreeMotionList===-1)this._octreeNode._octree.addMotionObject(this);}else {flag&=Transform3D.TRANSFORM_WORLDPOSITION|Transform3D.TRANSFORM_WORLDQUATERNION|Transform3D.TRANSFORM_WORLDSCALE;if(flag){if(this._indexInOctreeMotionList===-1)this._octreeNode._octree.addMotionObject(this);}}}};_proto152._createRenderElement=function _createRenderElement(){return new RenderElement();};_proto152._onMeshChange=function _onMeshChange(value){_MeshRenderer.prototype._onMeshChange.call(this,value);this._cacheMesh=value;var subMeshCount=value.subMeshCount;this._skinnedData=[];this._skinnedDataLoopMarks.length=value._inverseBindPoses.length;for(var i=0;i<subMeshCount;i++){var subBoneIndices=value.getSubMesh(i)._boneIndicesList;var subCount=subBoneIndices.length;var subData=this._skinnedData[i]=[];for(var j=0;j<subCount;j++){subData[j]=new Float32Array(subBoneIndices[j].length*16);}}this._cacheAvatar&&value&&this._getCacheAnimationNodes();};_proto152._setCacheAnimator=function _setCacheAnimator(animator){this._cacheAnimator=animator;this._shaderValues.addDefine(SkinnedMeshSprite3DShaderDeclaration.SHADERDEFINE_BONE);this._setRootNode();};_proto152._calculateBoundingBox=function _calculateBoundingBox(){if(!this._cacheAvatar){if(this._cacheRootBone)this._localBounds._tranform(this._cacheRootBone.transform.worldMatrix,this._bounds);else this._localBounds._tranform(this._owner.transform.worldMatrix,this._bounds);}else {if(this._cacheAnimator&&this._rootBone){var worldMat=SkinnedMeshRenderer._tempMatrix4x4;Utils3D.matrix4x4MultiplyMFM(this._cacheAnimator.owner.transform.worldMatrix,this._cacheRootAnimationNode.transform.getWorldMatrix(),worldMat);this._localBounds._tranform(worldMat,this._bounds);}else {_MeshRenderer.prototype._calculateBoundingBox.call(this);}}if(Laya.Render.supportWebGLPlusCulling){var min=this._bounds.getMin();var max=this._bounds.getMax();var buffer=FrustumCulling._cullingBuffer;buffer[this._cullingBufferIndex+1]=min.x;buffer[this._cullingBufferIndex+2]=min.y;buffer[this._cullingBufferIndex+3]=min.z;buffer[this._cullingBufferIndex+4]=max.x;buffer[this._cullingBufferIndex+5]=max.y;buffer[this._cullingBufferIndex+6]=max.z;}};_proto152._renderUpdate=function _renderUpdate(context,transform){if(this._cacheAnimator){this._computeSkinnedData();if(!this._cacheAvatar){this._shaderValues.setMatrix4x4(Sprite3D.WORLDMATRIX,Matrix4x4.DEFAULT);}else {var aniOwnerTrans=this._cacheAnimator.owner._transform;this._shaderValues.setMatrix4x4(Sprite3D.WORLDMATRIX,aniOwnerTrans.worldMatrix);}}else {this._shaderValues.setMatrix4x4(Sprite3D.WORLDMATRIX,transform.worldMatrix);}};_proto152._renderUpdateWithCamera=function _renderUpdateWithCamera(context,transform){var projectionView=context.projectionViewMatrix;if(this._cacheAnimator){if(!this._cacheAvatar){this._shaderValues.setMatrix4x4(Sprite3D.MVPMATRIX,projectionView);}else {var aniOwnerTrans=this._cacheAnimator.owner._transform;Matrix4x4.multiply(projectionView,aniOwnerTrans.worldMatrix,this._projectionViewWorldMatrix);this._shaderValues.setMatrix4x4(Sprite3D.MVPMATRIX,this._projectionViewWorldMatrix);}}else {Matrix4x4.multiply(projectionView,transform.worldMatrix,this._projectionViewWorldMatrix);this._shaderValues.setMatrix4x4(Sprite3D.MVPMATRIX,this._projectionViewWorldMatrix);}};_proto152._destroy=function _destroy(){_MeshRenderer.prototype._destroy.call(this);if(!this._cacheAvatar){if(this._cacheRootBone)!this._cacheRootBone.destroyed&&this._cacheRootBone.transform.off(Laya.Event.TRANSFORM_CHANGED,this,this._onWorldMatNeedChange);else this._owner&&!this._owner.destroyed&&this._owner.transform.off(Laya.Event.TRANSFORM_CHANGED,this,this._onWorldMatNeedChange);}else {if(this._cacheRootAnimationNode)this._cacheRootAnimationNode.transform.off(Laya.Event.TRANSFORM_CHANGED,this,this._onWorldMatNeedChange);}};_proto152._setRootBone=function _setRootBone(name){this._rootBone=name;this._setRootNode();};_proto152._setRootNode=function _setRootNode(){var rootNode;if(this._cacheAnimator&&this._rootBone&&this._cacheAvatar)rootNode=this._cacheAnimator._avatarNodeMap[this._rootBone];else rootNode=null;if(this._cacheRootAnimationNode!=rootNode){this._onWorldMatNeedChange(Transform3D.TRANSFORM_WORLDPOSITION|Transform3D.TRANSFORM_WORLDQUATERNION|Transform3D.TRANSFORM_WORLDSCALE);this._owner.transform.off(Laya.Event.TRANSFORM_CHANGED,this,this._onWorldMatNeedChange);if(this._cacheRootAnimationNode)this._cacheRootAnimationNode.transform.off(Laya.Event.TRANSFORM_CHANGED,this,this._onWorldMatNeedChange);rootNode&&rootNode.transform.on(Laya.Event.TRANSFORM_CHANGED,this,this._onWorldMatNeedChange);this._cacheRootAnimationNode=rootNode;}};_proto152._getCacheAnimationNodes=function _getCacheAnimationNodes(){var meshBoneNames=this._cacheMesh._boneNames;var innerBindPoseCount=this._cacheMesh._inverseBindPoses.length;if(!Laya.Render.supportWebGLPlusAnimation){this._cacheAnimationNode.length=innerBindPoseCount;var nodeMap=this._cacheAnimator._avatarNodeMap;for(var i=0;i<innerBindPoseCount;i++){var node=nodeMap[meshBoneNames[i]];this._cacheAnimationNode[i]=node;}}else {this._cacheAnimationNodeIndices=new Uint16Array(innerBindPoseCount);var nodeMapC=this._cacheAnimator._avatarNodeMap;for(i=0;i<innerBindPoseCount;i++){var nodeC=nodeMapC[meshBoneNames[i]];this._cacheAnimationNodeIndices[i]=nodeC?nodeC._worldMatrixIndex:0;}}};_proto152._setCacheAvatar=function _setCacheAvatar(value){if(this._cacheAvatar!==value){if(this._cacheMesh){this._cacheAvatar=value;if(value){this._shaderValues.addDefine(SkinnedMeshSprite3DShaderDeclaration.SHADERDEFINE_BONE);this._getCacheAnimationNodes();}}else {this._cacheAvatar=value;}this._setRootNode();}};_proto152._computeSubSkinnedDataNative=function _computeSubSkinnedDataNative(worldMatrixs,cacheAnimationNodeIndices,inverseBindPosesBuffer,boneIndices,data){Laya.LayaGL.instance.computeSubSkinnedData(worldMatrixs,cacheAnimationNodeIndices,inverseBindPosesBuffer,boneIndices,data);};_proto152._computeSkinnedDataForNative=function _computeSkinnedDataForNative(){if(this._cacheMesh&&this._cacheAvatar||this._cacheMesh&&!this._cacheAvatar){var bindPoses=this._cacheMesh._inverseBindPoses;var pathMarks=this._cacheMesh._skinnedMatrixCaches;for(var i=0,n=this._cacheMesh.subMeshCount;i<n;i++){var subMeshBoneIndices=this._cacheMesh.getSubMesh(i)._boneIndicesList;var subData=this._skinnedData[i];for(var j=0,m=subMeshBoneIndices.length;j<m;j++){var boneIndices=subMeshBoneIndices[j];if(this._cacheAvatar&&Laya.Render.supportWebGLPlusAnimation)this._computeSubSkinnedDataNative(this._cacheAnimator._animationNodeWorldMatrixs,this._cacheAnimationNodeIndices,this._cacheMesh._inverseBindPosesBuffer,boneIndices,subData[j]);else this._computeSubSkinnedData(bindPoses,boneIndices,subData[j],pathMarks);}}}};_createClass(SkinnedMeshRenderer,[{key:"localBounds",get:function get(){return this._localBounds;},set:function set(value){this._localBounds=value;}},{key:"rootBone",get:function get(){return this._cacheRootBone;},set:function set(value){if(this._cacheRootBone!=value){if(this._cacheRootBone)this._cacheRootBone.transform.off(Laya.Event.TRANSFORM_CHANGED,this,this._onWorldMatNeedChange);else this._owner.transform.off(Laya.Event.TRANSFORM_CHANGED,this,this._onWorldMatNeedChange);if(value)value.transform.on(Laya.Event.TRANSFORM_CHANGED,this,this._onWorldMatNeedChange);else this._owner.transform.on(Laya.Event.TRANSFORM_CHANGED,this,this._onWorldMatNeedChange);this._cacheRootBone=value;this._onWorldMatNeedChange(Transform3D.TRANSFORM_WORLDPOSITION|Transform3D.TRANSFORM_WORLDQUATERNION|Transform3D.TRANSFORM_WORLDSCALE);}}},{key:"bones",get:function get(){return this._bones;}},{key:"bounds",get:function get(){if(this._boundsChange||this._cacheAvatar){this._calculateBoundingBox();this._boundsChange=false;}return this._bounds;}}]);return SkinnedMeshRenderer;}(MeshRenderer);SkinnedMeshRenderer._tempMatrix4x4=new Matrix4x4();var SkinnedMeshSprite3D=/*#__PURE__*/function(_RenderableSprite3D4){_inheritsLoose(SkinnedMeshSprite3D,_RenderableSprite3D4);function SkinnedMeshSprite3D(mesh,name){var _this75;if(mesh===void 0){mesh=null;}if(name===void 0){name=null;}_this75=_RenderableSprite3D4.call(this,name)||this;_this75._meshFilter=new MeshFilter(_assertThisInitialized(_this75));_this75._render=new SkinnedMeshRenderer(_assertThisInitialized(_this75));mesh&&(_this75._meshFilter.sharedMesh=mesh);return _this75;}SkinnedMeshSprite3D.__init__=function __init__(){SkinnedMeshSprite3DShaderDeclaration.SHADERDEFINE_BONE=Shader3D.getDefineByName("BONE");SkinnedMeshSprite3DShaderDeclaration.SHADERDEFINE_SIMPLEBONE=Shader3D.getDefineByName("SIMPLEBONE");};var _proto153=SkinnedMeshSprite3D.prototype;_proto153._parse=function _parse(data,spriteMap){_RenderableSprite3D4.prototype._parse.call(this,data,spriteMap);var render=this.skinnedMeshRenderer;var lightmapIndex=data.lightmapIndex;lightmapIndex!=null&&(render.lightmapIndex=lightmapIndex);var lightmapScaleOffsetArray=data.lightmapScaleOffset;lightmapScaleOffsetArray&&(render.lightmapScaleOffset=new Vector4(lightmapScaleOffsetArray[0],lightmapScaleOffsetArray[1],lightmapScaleOffsetArray[2],lightmapScaleOffsetArray[3]));data.enableRender!=undefined&&(render.enable=data.enableRender);data.receiveShadows!=undefined&&(render.receiveShadow=data.receiveShadows);data.castShadow!=undefined&&(render.castShadow=data.castShadow);var meshPath;meshPath=data.meshPath;if(meshPath){var mesh=Laya.Loader.getRes(meshPath);mesh&&(this.meshFilter.sharedMesh=mesh);}var materials=data.materials;if(materials){var sharedMaterials=render.sharedMaterials;var materialCount=materials.length;sharedMaterials.length=materialCount;for(var i=0;i<materialCount;i++){sharedMaterials[i]=Laya.Loader.getRes(materials[i].path);}render.sharedMaterials=sharedMaterials;}var boundBox=data.boundBox;var min=boundBox.min;var max=boundBox.max;render.localBounds.setMin(new Vector3(min[0],min[1],min[2]));render.localBounds.setMax(new Vector3(max[0],max[1],max[2]));if(spriteMap){var rootBoneData=data.rootBone;render.rootBone=spriteMap[rootBoneData];var bonesData=data.bones;var n;for(i=0,n=bonesData.length;i<n;i++){render.bones.push(spriteMap[bonesData[i]]);}}else {data.rootBone&&render._setRootBone(data.rootBone);}};_proto153._changeHierarchyAnimator=function _changeHierarchyAnimator(animator){_RenderableSprite3D4.prototype._changeHierarchyAnimator.call(this,animator);this.skinnedMeshRenderer._setCacheAnimator(animator);};_proto153._changeAnimatorAvatar=function _changeAnimatorAvatar(avatar){this.skinnedMeshRenderer._setCacheAvatar(avatar);};_proto153._cloneTo=function _cloneTo(destObject,srcRoot,dstRoot){var meshSprite3D=destObject;meshSprite3D.meshFilter.sharedMesh=this.meshFilter.sharedMesh;var meshRender=this._render;var destMeshRender=meshSprite3D._render;destMeshRender.enable=meshRender.enable;destMeshRender.sharedMaterials=meshRender.sharedMaterials;destMeshRender.castShadow=meshRender.castShadow;var lightmapScaleOffset=meshRender.lightmapScaleOffset;lightmapScaleOffset&&(destMeshRender.lightmapScaleOffset=lightmapScaleOffset.clone());destMeshRender.receiveShadow=meshRender.receiveShadow;destMeshRender.sortingFudge=meshRender.sortingFudge;destMeshRender._rootBone=meshRender._rootBone;var bones=meshRender.bones;var destBones=destMeshRender.bones;var bonesCount=bones.length;destBones.length=bonesCount;var rootBone=meshRender.rootBone;if(rootBone){var pathes=Utils3D._getHierarchyPath(srcRoot,rootBone,SkinnedMeshSprite3D._tempArray0);if(pathes)destMeshRender.rootBone=Utils3D._getNodeByHierarchyPath(dstRoot,pathes);else destMeshRender.rootBone=rootBone;}for(var i=0;i<bones.length;i++){pathes=Utils3D._getHierarchyPath(srcRoot,bones[i],SkinnedMeshSprite3D._tempArray0);if(pathes)destBones[i]=Utils3D._getNodeByHierarchyPath(dstRoot,pathes);else destBones[i]=bones[i];}var lbb=meshRender.localBounds;lbb&&lbb.cloneTo(destMeshRender.localBounds);_RenderableSprite3D4.prototype._cloneTo.call(this,destObject,srcRoot,dstRoot);};_proto153.destroy=function destroy(destroyChild){if(destroyChild===void 0){destroyChild=true;}if(this.destroyed)return;_RenderableSprite3D4.prototype.destroy.call(this,destroyChild);this._meshFilter.destroy();};_proto153._create=function _create(){return new SkinnedMeshSprite3D();};_createClass(SkinnedMeshSprite3D,[{key:"meshFilter",get:function get(){return this._meshFilter;}},{key:"skinnedMeshRenderer",get:function get(){return this._render;}}]);return SkinnedMeshSprite3D;}(RenderableSprite3D);SkinnedMeshSprite3D._tempArray0=[];SkinnedMeshSprite3D.BONES=Shader3D.propertyNameToID("u_Bones");SkinnedMeshSprite3D.SIMPLE_SIMPLEANIMATORTEXTURE=Shader3D.propertyNameToID("u_SimpleAnimatorTexture");SkinnedMeshSprite3D.SIMPLE_SIMPLEANIMATORPARAMS=Shader3D.propertyNameToID("u_SimpleAnimatorParams");SkinnedMeshSprite3D.SIMPLE_SIMPLEANIMATORTEXTURESIZE=Shader3D.propertyNameToID("u_SimpleAnimatorTextureSize");var TrailMaterial=/*#__PURE__*/function(_Material11){_inheritsLoose(TrailMaterial,_Material11);function TrailMaterial(){var _this76;_this76=_Material11.call(this)||this;_this76.setShaderName("Trail");_this76._color=new Vector4(1.0,1.0,1.0,1.0);_this76._shaderValues.setVector(TrailMaterial.TINTCOLOR,new Vector4(1.0,1.0,1.0,1.0));_this76.renderMode=TrailMaterial.RENDERMODE_ALPHABLENDED;return _this76;}TrailMaterial.__initDefine__=function __initDefine__(){TrailMaterial.SHADERDEFINE_MAINTEXTURE=Shader3D.getDefineByName("MAINTEXTURE");TrailMaterial.SHADERDEFINE_TILINGOFFSET=Shader3D.getDefineByName("TILINGOFFSET");TrailMaterial.SHADERDEFINE_ADDTIVEFOG=Shader3D.getDefineByName("ADDTIVEFOG");};var _proto154=TrailMaterial.prototype;_proto154.clone=function clone(){var dest=new TrailMaterial();this.cloneTo(dest);return dest;};_createClass(TrailMaterial,[{key:"_TintColorR",get:function get(){return this._color.x;},set:function set(value){this._color.x=value;this.color=this._color;}},{key:"_TintColorG",get:function get(){return this._color.y;},set:function set(value){this._color.y=value;this.color=this._color;}},{key:"_TintColorB",get:function get(){return this._color.z;},set:function set(value){this._color.z=value;this.color=this._color;}},{key:"_TintColorA",get:function get(){return this._color.w;},set:function set(value){this._color.w=value;this.color=this._color;}},{key:"_MainTex_STX",get:function get(){return this._shaderValues.getVector(TrailMaterial.TILINGOFFSET).x;},set:function set(x){var tilOff=this._shaderValues.getVector(TrailMaterial.TILINGOFFSET);tilOff.x=x;this.tilingOffset=tilOff;}},{key:"_MainTex_STY",get:function get(){return this._shaderValues.getVector(TrailMaterial.TILINGOFFSET).y;},set:function set(y){var tilOff=this._shaderValues.getVector(TrailMaterial.TILINGOFFSET);tilOff.y=y;this.tilingOffset=tilOff;}},{key:"_MainTex_STZ",get:function get(){return this._shaderValues.getVector(TrailMaterial.TILINGOFFSET).z;},set:function set(z){var tilOff=this._shaderValues.getVector(TrailMaterial.TILINGOFFSET);tilOff.z=z;this.tilingOffset=tilOff;}},{key:"_MainTex_STW",get:function get(){return this._shaderValues.getVector(TrailMaterial.TILINGOFFSET).w;},set:function set(w){var tilOff=this._shaderValues.getVector(TrailMaterial.TILINGOFFSET);tilOff.w=w;this.tilingOffset=tilOff;}},{key:"renderMode",set:function set(value){switch(value){case TrailMaterial.RENDERMODE_ADDTIVE:this.renderQueue=Material.RENDERQUEUE_TRANSPARENT;this.alphaTest=false;this.depthWrite=false;this.cull=RenderState.CULL_NONE;this.blend=RenderState.BLEND_ENABLE_ALL;this.blendSrc=RenderState.BLENDPARAM_SRC_ALPHA;this.blendDst=RenderState.BLENDPARAM_ONE;this.depthTest=RenderState.DEPTHTEST_LESS;this._shaderValues.addDefine(TrailMaterial.SHADERDEFINE_ADDTIVEFOG);break;case TrailMaterial.RENDERMODE_ALPHABLENDED:this.renderQueue=Material.RENDERQUEUE_TRANSPARENT;this.alphaTest=false;this.depthWrite=false;this.cull=RenderState.CULL_NONE;this.blend=RenderState.BLEND_ENABLE_ALL;this.blendSrc=RenderState.BLENDPARAM_SRC_ALPHA;this.blendDst=RenderState.BLENDPARAM_ONE_MINUS_SRC_ALPHA;this.depthTest=RenderState.DEPTHTEST_LESS;this._shaderValues.removeDefine(TrailMaterial.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("TrailMaterial : renderMode value error.");}}},{key:"colorR",get:function get(){return this._TintColorR;},set:function set(value){this._TintColorR=value;}},{key:"colorG",get:function get(){return this._TintColorG;},set:function set(value){this._TintColorG=value;}},{key:"colorB",get:function get(){return this._TintColorB;},set:function set(value){this._TintColorB=value;}},{key:"colorA",get:function get(){return this._TintColorA;},set:function set(value){this._TintColorA=value;}},{key:"color",get:function get(){return this._shaderValues.getVector(TrailMaterial.TINTCOLOR);},set:function set(value){this._shaderValues.setVector(TrailMaterial.TINTCOLOR,value);}},{key:"texture",get:function get(){return this._shaderValues.getTexture(TrailMaterial.MAINTEXTURE);},set:function set(value){if(value)this._shaderValues.addDefine(TrailMaterial.SHADERDEFINE_MAINTEXTURE);else this._shaderValues.removeDefine(TrailMaterial.SHADERDEFINE_MAINTEXTURE);this._shaderValues.setTexture(TrailMaterial.MAINTEXTURE,value);}},{key:"tilingOffsetX",get:function get(){return this._MainTex_STX;},set:function set(x){this._MainTex_STX=x;}},{key:"tilingOffsetY",get:function get(){return this._MainTex_STY;},set:function set(y){this._MainTex_STY=y;}},{key:"tilingOffsetZ",get:function get(){return this._MainTex_STZ;},set:function set(z){this._MainTex_STZ=z;}},{key:"tilingOffsetW",get:function get(){return this._MainTex_STW;},set:function set(w){this._MainTex_STW=w;}},{key:"tilingOffset",get:function get(){return this._shaderValues.getVector(TrailMaterial.TILINGOFFSET);},set:function set(value){if(value){if(value.x!=1||value.y!=1||value.z!=0||value.w!=0)this._shaderValues.addDefine(TrailMaterial.SHADERDEFINE_TILINGOFFSET);else this._shaderValues.removeDefine(TrailMaterial.SHADERDEFINE_TILINGOFFSET);}else {this._shaderValues.removeDefine(TrailMaterial.SHADERDEFINE_TILINGOFFSET);}this._shaderValues.setVector(TrailMaterial.TILINGOFFSET,value);}},{key:"depthWrite",set:function set(value){this._shaderValues.setBool(TrailMaterial.DEPTH_WRITE,value);},get:function get(){return this._shaderValues.getBool(TrailMaterial.DEPTH_WRITE);}},{key:"cull",set:function set(value){this._shaderValues.setInt(TrailMaterial.CULL,value);},get:function get(){return this._shaderValues.getInt(TrailMaterial.CULL);}},{key:"blend",set:function set(value){this._shaderValues.setInt(TrailMaterial.BLEND,value);},get:function get(){return this._shaderValues.getInt(TrailMaterial.BLEND);}},{key:"blendSrc",set:function set(value){this._shaderValues.setInt(TrailMaterial.BLEND_SRC,value);},get:function get(){return this._shaderValues.getInt(TrailMaterial.BLEND_SRC);}},{key:"blendDst",set:function set(value){this._shaderValues.setInt(TrailMaterial.BLEND_DST,value);},get:function get(){return this._shaderValues.getInt(TrailMaterial.BLEND_DST);}},{key:"depthTest",set:function set(value){this._shaderValues.setInt(TrailMaterial.DEPTH_TEST,value);},get:function get(){return this._shaderValues.getInt(TrailMaterial.DEPTH_TEST);}}]);return TrailMaterial;}(Material);TrailMaterial.RENDERMODE_ALPHABLENDED=0;TrailMaterial.RENDERMODE_ADDTIVE=1;TrailMaterial.MAINTEXTURE=Shader3D.propertyNameToID("u_MainTexture");TrailMaterial.TINTCOLOR=Shader3D.propertyNameToID("u_MainColor");TrailMaterial.TILINGOFFSET=Shader3D.propertyNameToID("u_TilingOffset");TrailMaterial.CULL=Shader3D.propertyNameToID("s_Cull");TrailMaterial.BLEND=Shader3D.propertyNameToID("s_Blend");TrailMaterial.BLEND_SRC=Shader3D.propertyNameToID("s_BlendSrc");TrailMaterial.BLEND_DST=Shader3D.propertyNameToID("s_BlendDst");TrailMaterial.DEPTH_TEST=Shader3D.propertyNameToID("s_DepthTest");TrailMaterial.DEPTH_WRITE=Shader3D.propertyNameToID("s_DepthWrite");var TextureMode=function TextureMode(){};TextureMode.Stretch=0;TextureMode.Tile=1;(function(TrailAlignment){TrailAlignment[TrailAlignment["View"]=0]="View";TrailAlignment[TrailAlignment["TransformZ"]=1]="TransformZ";})(exports.TrailAlignment||(exports.TrailAlignment={}));var VertexTrail=/*#__PURE__*/function(){function VertexTrail(){}VertexTrail.__init__=function __init__(){VertexTrail._vertexDeclaration1=new VertexDeclaration(32,[new VertexElement(0,VertexElementFormat.Vector3,VertexTrail.TRAIL_POSITION0),new VertexElement(12,VertexElementFormat.Vector3,VertexTrail.TRAIL_OFFSETVECTOR),new VertexElement(24,VertexElementFormat.Single,VertexTrail.TRAIL_TIME0),new VertexElement(28,VertexElementFormat.Single,VertexTrail.TRAIL_TEXTURECOORDINATE0Y)]);VertexTrail._vertexDeclaration2=new VertexDeclaration(20,[new VertexElement(0,VertexElementFormat.Single,VertexTrail.TRAIL_TEXTURECOORDINATE0X),new VertexElement(4,VertexElementFormat.Color,VertexTrail.TRAIL_COLOR)]);};_createClass(VertexTrail,[{key:"vertexDeclaration",get:function get(){return VertexTrail._vertexDeclaration1;}}],[{key:"vertexDeclaration1",get:function get(){return VertexTrail._vertexDeclaration1;}},{key:"vertexDeclaration2",get:function get(){return VertexTrail._vertexDeclaration2;}}]);return VertexTrail;}();VertexTrail.TRAIL_POSITION0=0;VertexTrail.TRAIL_OFFSETVECTOR=1;VertexTrail.TRAIL_TIME0=2;VertexTrail.TRAIL_TEXTURECOORDINATE0Y=3;VertexTrail.TRAIL_TEXTURECOORDINATE0X=4;VertexTrail.TRAIL_COLOR=5;var TrailGeometry=/*#__PURE__*/function(_GeometryElement6){_inheritsLoose(TrailGeometry,_GeometryElement6);function TrailGeometry(owner){var _this77;_this77=_GeometryElement6.call(this)||this;_this77._floatCountPerVertices1=8;_this77._floatCountPerVertices2=5;_this77._increaseSegementCount=16;_this77._activeIndex=0;_this77._endIndex=0;_this77._needAddFirstVertex=false;_this77._isTempEndVertex=false;_this77._vertices1=null;_this77._vertices2=null;_this77._lastFixedVertexPosition=new Vector3();_this77._bufferState=new BufferState();_this77.tmpColor=new Color();_this77._disappearBoundsMode=false;_this77._owner=owner;_this77._segementCount=_this77._increaseSegementCount;_this77._resizeData(_this77._segementCount,_this77._bufferState);var bounds=_this77._owner._owner.trailRenderer.bounds;var sprite3dPosition=_this77._owner._owner.transform.position;bounds.setMin(sprite3dPosition);bounds.setMax(sprite3dPosition);Laya.Render.supportWebGLPlusCulling&&_this77._calculateBoundingBoxForNative();return _this77;}var _proto155=TrailGeometry.prototype;_proto155._resizeData=function _resizeData(segementCount,bufferState){this._subBirthTime=new Float32Array(segementCount);this._subDistance=new Float64Array(segementCount);var gl=Laya.LayaGL.instance;var vertexCount=segementCount*2;var vertexDeclaration1=VertexTrail.vertexDeclaration1;var vertexDeclaration2=VertexTrail.vertexDeclaration2;var vertexBuffers=[];var vertexbuffer1Size=vertexCount*vertexDeclaration1.vertexStride;var vertexbuffer2Size=vertexCount*vertexDeclaration2.vertexStride;var memorySize=vertexbuffer1Size+vertexbuffer2Size;this._vertices1=new Float32Array(vertexCount*this._floatCountPerVertices1);this._vertices2=new Float32Array(vertexCount*this._floatCountPerVertices2);this._vertexBuffer1=new VertexBuffer3D(vertexbuffer1Size,gl.STATIC_DRAW,false);this._vertexBuffer1.vertexDeclaration=vertexDeclaration1;this._vertexBuffer2=new VertexBuffer3D(vertexbuffer2Size,gl.DYNAMIC_DRAW,false);this._vertexBuffer2.vertexDeclaration=vertexDeclaration2;vertexBuffers.push(this._vertexBuffer1);vertexBuffers.push(this._vertexBuffer2);bufferState.bind();bufferState.applyVertexBuffers(vertexBuffers);bufferState.unBind();Laya.Resource._addMemory(memorySize,memorySize);};_proto155._resetData=function _resetData(){var count=this._endIndex-this._activeIndex;var oldVertices1=new Float32Array(this._vertices1.buffer,this._floatCountPerVertices1*2*this._activeIndex*4,this._floatCountPerVertices1*2*count);var oldVertices2=new Float32Array(this._vertices2.buffer,this._floatCountPerVertices2*2*this._activeIndex*4,this._floatCountPerVertices2*2*count);var oldSubDistance=new Float64Array(this._subDistance.buffer,this._activeIndex*8,count);var oldSubBirthTime=new Float32Array(this._subBirthTime.buffer,this._activeIndex*4,count);if(count===this._segementCount){this._vertexBuffer1.destroy();this._vertexBuffer2.destroy();var memorySize=this._vertexBuffer1._byteLength+this._vertexBuffer2._byteLength;Laya.Resource._addMemory(-memorySize,-memorySize);this._segementCount+=this._increaseSegementCount;this._resizeData(this._segementCount,this._bufferState);}this._vertices1.set(oldVertices1,0);this._vertices2.set(oldVertices2,0);this._subDistance.set(oldSubDistance,0);this._subBirthTime.set(oldSubBirthTime,0);this._endIndex=count;this._activeIndex=0;this._vertexBuffer1.setData(this._vertices1.buffer,0,this._floatCountPerVertices1*2*this._activeIndex*4,this._floatCountPerVertices1*2*count*4);this._vertexBuffer2.setData(this._vertices2.buffer,0,this._floatCountPerVertices2*2*this._activeIndex*4,this._floatCountPerVertices2*2*count*4);};_proto155._updateTrail=function _updateTrail(camera,lastPosition,position){if(!Vector3.equals(lastPosition,position)){if(this._endIndex-this._activeIndex===0)this._addTrailByFirstPosition(camera,position);else this._addTrailByNextPosition(camera,position);}};_proto155._addTrailByFirstPosition=function _addTrailByFirstPosition(camera,position){this._endIndex===this._segementCount&&this._resetData();this._subDistance[this._endIndex]=0;this._subBirthTime[this._endIndex]=this._owner._curtime;this._endIndex++;position.cloneTo(this._lastFixedVertexPosition);this._needAddFirstVertex=true;};_proto155._addTrailByNextPosition=function _addTrailByNextPosition(camera,position){var delVector3=TrailGeometry._tempVector30;var pointAtoBVector3=TrailGeometry._tempVector31;switch(this._owner.alignment){case exports.TrailAlignment.View:var cameraMatrix=camera.viewMatrix;Vector3.transformCoordinate(position,cameraMatrix,TrailGeometry._tempVector33);Vector3.transformCoordinate(this._lastFixedVertexPosition,cameraMatrix,TrailGeometry._tempVector34);Vector3.subtract(TrailGeometry._tempVector33,TrailGeometry._tempVector34,delVector3);Vector3.cross(TrailGeometry._tempVector33,delVector3,pointAtoBVector3);break;case exports.TrailAlignment.TransformZ:Vector3.subtract(position,this._lastFixedVertexPosition,delVector3);var forward=TrailGeometry._tempVector32;this._owner._owner.transform.getForward(forward);Vector3.cross(delVector3,forward,pointAtoBVector3);break;}Vector3.normalize(pointAtoBVector3,pointAtoBVector3);Vector3.scale(pointAtoBVector3,this._owner.widthMultiplier/2,pointAtoBVector3);var delLength=Vector3.scalarLength(delVector3);var tempEndIndex;var offset;if(this._needAddFirstVertex){this._updateVerticesByPositionData(position,pointAtoBVector3,this._endIndex-1);this._needAddFirstVertex=false;}if(delLength-this._owner.minVertexDistance>=MathUtils3D.zeroTolerance){if(this._isTempEndVertex){tempEndIndex=this._endIndex-1;offset=delLength-this._subDistance[tempEndIndex];this._updateVerticesByPosition(position,pointAtoBVector3,delLength,tempEndIndex);this._owner._totalLength+=offset;}else {this._endIndex===this._segementCount&&this._resetData();this._updateVerticesByPosition(position,pointAtoBVector3,delLength,this._endIndex);this._owner._totalLength+=delLength;this._endIndex++;}position.cloneTo(this._lastFixedVertexPosition);this._isTempEndVertex=false;}else {if(this._isTempEndVertex){tempEndIndex=this._endIndex-1;offset=delLength-this._subDistance[tempEndIndex];this._updateVerticesByPosition(position,pointAtoBVector3,delLength,tempEndIndex);this._owner._totalLength+=offset;}else {this._endIndex===this._segementCount&&this._resetData();this._updateVerticesByPosition(position,pointAtoBVector3,delLength,this._endIndex);this._owner._totalLength+=delLength;this._endIndex++;}this._isTempEndVertex=true;}};_proto155._updateVerticesByPositionData=function _updateVerticesByPositionData(position,pointAtoBVector3,index){var vertexOffset=this._floatCountPerVertices1*2*index;var curtime=this._owner._curtime;this._vertices1[vertexOffset]=position.x;this._vertices1[vertexOffset+1]=position.y;this._vertices1[vertexOffset+2]=position.z;this._vertices1[vertexOffset+3]=-pointAtoBVector3.x;this._vertices1[vertexOffset+4]=-pointAtoBVector3.y;this._vertices1[vertexOffset+5]=-pointAtoBVector3.z;this._vertices1[vertexOffset+6]=curtime;this._vertices1[vertexOffset+7]=1.0;this._vertices1[vertexOffset+8]=position.x;this._vertices1[vertexOffset+9]=position.y;this._vertices1[vertexOffset+10]=position.z;this._vertices1[vertexOffset+11]=pointAtoBVector3.x;this._vertices1[vertexOffset+12]=pointAtoBVector3.y;this._vertices1[vertexOffset+13]=pointAtoBVector3.z;this._vertices1[vertexOffset+14]=curtime;this._vertices1[vertexOffset+15]=0.0;var bounds=this._owner._owner.trailRenderer.bounds;var min=bounds.getMin();var max=bounds.getMax();var up=TrailGeometry._tempVector35;var down=TrailGeometry._tempVector36;var out=TrailGeometry._tempVector32;Vector3.add(position,pointAtoBVector3,up);Vector3.subtract(position,pointAtoBVector3,down);Vector3.min(down,up,out);Vector3.min(min,out,min);bounds.setMin(min);Vector3.max(up,down,out);Vector3.max(max,out,max);bounds.setMax(max);Laya.Render.supportWebGLPlusCulling&&this._calculateBoundingBoxForNative();var floatCount=this._floatCountPerVertices1*2;this._vertexBuffer1.setData(this._vertices1.buffer,vertexOffset*4,vertexOffset*4,floatCount*4);};_proto155._updateVerticesByPosition=function _updateVerticesByPosition(position,pointAtoBVector3,delDistance,index){this._updateVerticesByPositionData(position,pointAtoBVector3,index);this._subDistance[index]=delDistance;this._subBirthTime[index]=this._owner._curtime;};_proto155._updateVertexBufferUV=function _updateVertexBufferUV(){var bounds;var min,max;if(this._disappearBoundsMode){bounds=this._owner._owner.trailRenderer.bounds;var sprite3dPosition=this._owner._owner.transform.position;bounds.setMin(sprite3dPosition);bounds.setMax(sprite3dPosition);min=bounds.getMin();max=bounds.getMax();Laya.Render.supportWebGLPlusCulling&&this._calculateBoundingBoxForNative();}var vertexCount=this._endIndex;var curLength=0;var gradient=this._owner.colorGradient;var startAlphaIndex=gradient.colorAlphaKeysCount-1;var startColorIndex=gradient.colorRGBKeysCount-1;var totalLength=this._owner._totalLength;var stride=this._floatCountPerVertices2*2;for(var i=this._activeIndex;i<vertexCount;i++){i!==this._activeIndex&&(curLength+=this._subDistance[i]);var uvX;var lerpFactor;if(this._owner.textureMode==TextureMode.Stretch){uvX=1.0-curLength/totalLength;lerpFactor=uvX;}else {lerpFactor=1.0-curLength/totalLength;uvX=1.0-(totalLength-curLength);}startColorIndex=gradient.evaluateColorRGB(lerpFactor,this.tmpColor,startColorIndex,true);startAlphaIndex=gradient.evaluateColorAlpha(lerpFactor,this.tmpColor,startAlphaIndex,true);var index=i*stride;this._vertices2[index+0]=uvX;this._vertices2[index+1]=this.tmpColor.r;this._vertices2[index+2]=this.tmpColor.g;this._vertices2[index+3]=this.tmpColor.b;this._vertices2[index+4]=this.tmpColor.a;this._vertices2[index+5]=uvX;this._vertices2[index+6]=this.tmpColor.r;this._vertices2[index+7]=this.tmpColor.g;this._vertices2[index+8]=this.tmpColor.b;this._vertices2[index+9]=this.tmpColor.a;if(this._disappearBoundsMode){var posOffset=this._floatCountPerVertices1*2*i;var pos=TrailGeometry._tempVector32;var up=TrailGeometry._tempVector33;var side=TrailGeometry._tempVector34;pos.setValue(this._vertices1[posOffset+0],this._vertices1[posOffset+1],this._vertices1[posOffset+2]);up.setValue(this._vertices1[posOffset+3],this._vertices1[posOffset+4],this._vertices1[posOffset+5]);Vector3.add(pos,up,side);Vector3.min(side,min,min);Vector3.max(side,max,max);Vector3.subtract(pos,up,side);Vector3.min(side,min,min);Vector3.max(side,max,max);}}if(this._disappearBoundsMode){bounds.setMin(min);bounds.setMax(max);this._disappearBoundsMode=false;Laya.Render.supportWebGLPlusCulling&&this._calculateBoundingBoxForNative();}var offset=this._activeIndex*stride;this._vertexBuffer2.setData(this._vertices2.buffer,offset*4,offset*4,(vertexCount*stride-offset)*4);};_proto155._updateDisappear=function _updateDisappear(){var count=this._endIndex;for(var i=this._activeIndex;i<count;i++){if(this._owner._curtime-this._subBirthTime[i]>=this._owner.time+MathUtils3D.zeroTolerance){var nextIndex=i+1;if(nextIndex!==count)this._owner._totalLength-=this._subDistance[nextIndex];if(this._isTempEndVertex&&nextIndex===count-1){var offset=this._floatCountPerVertices1*i*2;var fixedPos=this._lastFixedVertexPosition;fixedPos.x=this._vertices1[0];fixedPos.y=this._vertices1[1];fixedPos.z=this._vertices1[2];this._isTempEndVertex=false;}this._activeIndex++;this._disappearBoundsMode=true;}else {break;}}};_proto155._getType=function _getType(){return TrailGeometry._type;};_proto155._prepareRender=function _prepareRender(state){return this._endIndex-this._activeIndex>1;};_proto155._render=function _render(state){this._bufferState.bind();var gl=Laya.LayaGL.instance;var start=this._activeIndex*2;var count=this._endIndex*2-start;gl.drawArrays(gl.TRIANGLE_STRIP,start,count);Laya.Stat.renderBatches++;Laya.Stat.trianglesFaces+=count-2;};_proto155.destroy=function destroy(){_GeometryElement6.prototype.destroy.call(this);var memorySize=this._vertexBuffer1._byteLength+this._vertexBuffer2._byteLength;Laya.Resource._addMemory(-memorySize,-memorySize);this._bufferState.destroy();this._vertexBuffer1.destroy();this._vertexBuffer2.destroy();this._bufferState=null;this._vertices1=null;this._vertexBuffer1=null;this._vertices2=null;this._vertexBuffer2=null;this._subBirthTime=null;this._subDistance=null;this._lastFixedVertexPosition=null;this._disappearBoundsMode=false;};_proto155._calculateBoundingBoxForNative=function _calculateBoundingBoxForNative(){var trail=this._owner._owner.trailRenderer;var bounds=trail.bounds;var min=bounds.getMin();var max=bounds.getMax();var buffer=FrustumCulling._cullingBuffer;buffer[trail._cullingBufferIndex+1]=min.x;buffer[trail._cullingBufferIndex+2]=min.y;buffer[trail._cullingBufferIndex+3]=min.z;buffer[trail._cullingBufferIndex+4]=max.x;buffer[trail._cullingBufferIndex+5]=max.y;buffer[trail._cullingBufferIndex+6]=max.z;};_proto155.clear=function clear(){this._activeIndex=0;this._endIndex=0;this._disappearBoundsMode=false;this._subBirthTime.fill(0);this._subDistance.fill(0);this._segementCount=0;this._isTempEndVertex=false;this._needAddFirstVertex=false;this._lastFixedVertexPosition.setValue(0,0,0);};return TrailGeometry;}(GeometryElement);TrailGeometry.ALIGNMENT_VIEW=0;TrailGeometry.ALIGNMENT_TRANSFORM_Z=1;TrailGeometry._tempVector30=new Vector3();TrailGeometry._tempVector31=new Vector3();TrailGeometry._tempVector32=new Vector3();TrailGeometry._tempVector33=new Vector3();TrailGeometry._tempVector34=new Vector3();TrailGeometry._tempVector35=new Vector3();TrailGeometry._tempVector36=new Vector3();TrailGeometry._type=GeometryElement._typeCounter++;var TrailFilter=/*#__PURE__*/function(){function TrailFilter(owner){this._totalLength=0;this._lastPosition=new Vector3();this._curtime=0;this.alignment=TrailFilter.ALIGNMENT_VIEW;this._owner=owner;this._initDefaultData();this.addRenderElement();}var _proto156=TrailFilter.prototype;_proto156.addRenderElement=function addRenderElement(){var render=this._owner._render;var elements=render._renderElements;var material=render.sharedMaterials[0];material||(material=TrailMaterial.defaultMaterial);var element=new RenderElement();element.setTransform(this._owner._transform);element.render=render;element.material=material;this._trialGeometry=new TrailGeometry(this);element.setGeometry(this._trialGeometry);elements.push(element);};_proto156._update=function _update(state){var render=this._owner._render;this._curtime+=state.scene.timer._delta/1000;render._shaderValues.setNumber(TrailFilter.CURTIME,this._curtime);var curPos=this._owner.transform.position;var element=render._renderElements[0]._geometry;element._updateDisappear();element._updateTrail(state.camera,this._lastPosition,curPos);element._updateVertexBufferUV();curPos.cloneTo(this._lastPosition);};_proto156._initDefaultData=function _initDefaultData(){this.time=5.0;this.minVertexDistance=0.1;this.widthMultiplier=1;this.textureMode=TextureMode.Stretch;var widthKeyFrames=[];var widthKeyFrame1=new FloatKeyframe();widthKeyFrame1.time=0;widthKeyFrame1.inTangent=0;widthKeyFrame1.outTangent=0;widthKeyFrame1.value=1;widthKeyFrames.push(widthKeyFrame1);var widthKeyFrame2=new FloatKeyframe();widthKeyFrame2.time=1;widthKeyFrame2.inTangent=0;widthKeyFrame2.outTangent=0;widthKeyFrame2.value=1;widthKeyFrames.push(widthKeyFrame2);this.widthCurve=widthKeyFrames;var gradient=new Gradient(2,2);gradient.mode=GradientMode.Blend;gradient.addColorRGB(0,Color.WHITE);gradient.addColorRGB(1,Color.WHITE);gradient.addColorAlpha(0,1);gradient.addColorAlpha(1,1);this.colorGradient=gradient;};_proto156.destroy=function destroy(){this._trialGeometry.destroy();this._trialGeometry=null;this._widthCurve=null;this._colorGradient=null;};_proto156.clear=function clear(){this._trialGeometry.clear();this._lastPosition.setValue(0,0,0);this._curtime=0;this._totalLength=0;};_createClass(TrailFilter,[{key:"time",get:function get(){return this._time;},set:function set(value){this._time=value;this._owner._render._shaderValues.setNumber(TrailFilter.LIFETIME,value);}},{key:"minVertexDistance",get:function get(){return this._minVertexDistance;},set:function set(value){this._minVertexDistance=value;}},{key:"widthMultiplier",get:function get(){return this._widthMultiplier;},set:function set(value){this._widthMultiplier=value;}},{key:"widthCurve",get:function get(){return this._widthCurve;},set:function set(value){this._widthCurve=value;var widthCurveFloatArray=new Float32Array(value.length*4);var i,j,index=0;for(i=0,j=value.length;i<j;i++){widthCurveFloatArray[index++]=value[i].time;widthCurveFloatArray[index++]=value[i].inTangent;widthCurveFloatArray[index++]=value[i].outTangent;widthCurveFloatArray[index++]=value[i].value;}this._owner._render._shaderValues.setBuffer(TrailFilter.WIDTHCURVE,widthCurveFloatArray);this._owner._render._shaderValues.setInt(TrailFilter.WIDTHCURVEKEYLENGTH,value.length);}},{key:"colorGradient",get:function get(){return this._colorGradient;},set:function set(value){this._colorGradient=value;}},{key:"textureMode",get:function get(){return this._textureMode;},set:function set(value){this._textureMode=value;}}]);return TrailFilter;}();TrailFilter.CURTIME=Shader3D.propertyNameToID("u_CurTime");TrailFilter.LIFETIME=Shader3D.propertyNameToID("u_LifeTime");TrailFilter.WIDTHCURVE=Shader3D.propertyNameToID("u_WidthCurve");TrailFilter.WIDTHCURVEKEYLENGTH=Shader3D.propertyNameToID("u_WidthCurveKeyLength");TrailFilter.ALIGNMENT_VIEW=0;TrailFilter.ALIGNMENT_TRANSFORM_Z=1;var TrailRenderer=/*#__PURE__*/function(_BaseRender4){_inheritsLoose(TrailRenderer,_BaseRender4);function TrailRenderer(owner){var _this78;_this78=_BaseRender4.call(this,owner)||this;_this78._projectionViewWorldMatrix=new Matrix4x4();return _this78;}var _proto157=TrailRenderer.prototype;_proto157._calculateBoundingBox=function _calculateBoundingBox(){};_proto157._needRender=function _needRender(boundFrustum,context){this._owner.trailFilter._update(context);if(boundFrustum)return boundFrustum.intersects(this.bounds._getBoundBox());else return true;};_proto157._updateForNative=function _updateForNative(context){this._owner.trailFilter._update(context);};_proto157._renderUpdate=function _renderUpdate(state,transform){_BaseRender4.prototype._renderUpdate.call(this,state,transform);};_proto157._renderUpdateWithCamera=function _renderUpdateWithCamera(context,transform){var projectionView=context.projectionViewMatrix;if(transform){Matrix4x4.multiply(projectionView,transform.worldMatrix,this._projectionViewWorldMatrix);this._shaderValues.setMatrix4x4(Sprite3D.MVPMATRIX,this._projectionViewWorldMatrix);}else {this._shaderValues.setMatrix4x4(Sprite3D.MVPMATRIX,projectionView);}};return TrailRenderer;}(BaseRender);var TrailSprite3D=/*#__PURE__*/function(_RenderableSprite3D5){_inheritsLoose(TrailSprite3D,_RenderableSprite3D5);function TrailSprite3D(name){var _this79;if(name===void 0){name=null;}_this79=_RenderableSprite3D5.call(this,name)||this;_this79._render=new TrailRenderer(_assertThisInitialized(_this79));_this79._geometryFilter=new TrailFilter(_assertThisInitialized(_this79));return _this79;}TrailSprite3D.__init__=function __init__(){};var _proto158=TrailSprite3D.prototype;_proto158._parse=function _parse(data,spriteMap){_RenderableSprite3D5.prototype._parse.call(this,data,spriteMap);var render=this._render;var filter=this._geometryFilter;var i,j;var materials=data.materials;if(materials){var sharedMaterials=render.sharedMaterials;var materialCount=materials.length;sharedMaterials.length=materialCount;for(i=0;i<materialCount;i++){sharedMaterials[i]=Laya.Loader.getRes(materials[i].path);}render.sharedMaterials=sharedMaterials;}filter.time=data.time;filter.minVertexDistance=data.minVertexDistance;filter.widthMultiplier=data.widthMultiplier;filter.textureMode=data.textureMode;data.alignment!=null&&(filter.alignment=data.alignment);var widthCurve=[];var widthCurveData=data.widthCurve;for(i=0,j=widthCurveData.length;i<j;i++){var trailkeyframe=new FloatKeyframe();trailkeyframe.time=widthCurveData[i].time;trailkeyframe.inTangent=widthCurveData[i].inTangent;trailkeyframe.outTangent=widthCurveData[i].outTangent;trailkeyframe.value=widthCurveData[i].value;widthCurve.push(trailkeyframe);}filter.widthCurve=widthCurve;var colorGradientData=data.colorGradient;var colorKeys=colorGradientData.colorKeys;var alphaKeys=colorGradientData.alphaKeys;var colorGradient=new Gradient(colorKeys.length,alphaKeys.length);colorGradient.mode=colorGradientData.mode;for(i=0,j=colorKeys.length;i<j;i++){var colorKey=colorKeys[i];colorGradient.addColorRGB(colorKey.time,new Color(colorKey.value[0],colorKey.value[1],colorKey.value[2],1.0));}for(i=0,j=alphaKeys.length;i<j;i++){var alphaKey=alphaKeys[i];colorGradient.addColorAlpha(alphaKey.time,alphaKey.value);}filter.colorGradient=colorGradient;};_proto158._onActive=function _onActive(){_RenderableSprite3D5.prototype._onActive.call(this);this._transform.position.cloneTo(this._geometryFilter._lastPosition);};_proto158._cloneTo=function _cloneTo(destObject,srcSprite,dstSprite){_RenderableSprite3D5.prototype._cloneTo.call(this,destObject,srcSprite,dstSprite);var i,j;var destTrailSprite3D=destObject;var destTrailFilter=destTrailSprite3D.trailFilter;destTrailFilter.time=this.trailFilter.time;destTrailFilter.minVertexDistance=this.trailFilter.minVertexDistance;destTrailFilter.widthMultiplier=this.trailFilter.widthMultiplier;destTrailFilter.textureMode=this.trailFilter.textureMode;destTrailFilter.alignment=this.trailFilter.alignment;var widthCurveData=this.trailFilter.widthCurve;var widthCurve=[];for(i=0,j=widthCurveData.length;i<j;i++){var keyFrame=new FloatKeyframe();widthCurveData[i].cloneTo(keyFrame);widthCurve.push(keyFrame);}destTrailFilter.widthCurve=widthCurve;var destColorGradient=new Gradient(this.trailFilter.colorGradient.maxColorRGBKeysCount,this.trailFilter.colorGradient.maxColorAlphaKeysCount);this.trailFilter.colorGradient.cloneTo(destColorGradient);destTrailFilter.colorGradient=destColorGradient;var destTrailRender=destTrailSprite3D.trailRenderer;destTrailRender.sharedMaterial=this.trailRenderer.sharedMaterial;};_proto158.destroy=function destroy(destroyChild){if(destroyChild===void 0){destroyChild=true;}if(this.destroyed)return;_RenderableSprite3D5.prototype.destroy.call(this,destroyChild);this._geometryFilter.destroy();this._geometryFilter=null;};_proto158.clear=function clear(){this._geometryFilter.clear();};_proto158._create=function _create(){return new TrailSprite3D();};_createClass(TrailSprite3D,[{key:"trailFilter",get:function get(){return this._geometryFilter;}},{key:"trailRenderer",get:function get(){return this._render;}}]);return TrailSprite3D;}(RenderableSprite3D);var VertexPositionTerrain=/*#__PURE__*/function(){function VertexPositionTerrain(position,normal,textureCoord0,textureCoord1){this._position=position;this._normal=normal;this._textureCoord0=textureCoord0;this._textureCoord1=textureCoord1;}VertexPositionTerrain.__init__=function __init__(){VertexPositionTerrain._vertexDeclaration=new VertexDeclaration(40,[new VertexElement(0,VertexElementFormat.Vector3,VertexPositionTerrain.TERRAIN_POSITION0),new VertexElement(12,VertexElementFormat.Vector3,VertexPositionTerrain.TERRAIN_NORMAL0),new VertexElement(24,VertexElementFormat.Vector2,VertexPositionTerrain.TERRAIN_TEXTURECOORDINATE0),new VertexElement(32,VertexElementFormat.Vector2,VertexPositionTerrain.TERRAIN_TEXTURECOORDINATE1)]);};_createClass(VertexPositionTerrain,[{key:"position",get:function get(){return this._position;}},{key:"normal",get:function get(){return this._normal;}},{key:"textureCoord0",get:function get(){return this._textureCoord0;}},{key:"textureCoord1",get:function get(){return this._textureCoord1;}},{key:"vertexDeclaration",get:function get(){return VertexPositionTerrain._vertexDeclaration;}}],[{key:"vertexDeclaration",get:function get(){return VertexPositionTerrain._vertexDeclaration;}}]);return VertexPositionTerrain;}();VertexPositionTerrain.TERRAIN_POSITION0=0;VertexPositionTerrain.TERRAIN_NORMAL0=1;VertexPositionTerrain.TERRAIN_TEXTURECOORDINATE0=2;VertexPositionTerrain.TERRAIN_TEXTURECOORDINATE1=3;var BulletInteractive=function BulletInteractive(){};BulletInteractive._interactive={"getWorldTransform":function getWorldTransform(rigidBodyID,worldTransPointer){},"setWorldTransform":function setWorldTransform(rigidBodyID,worldTransPointer){var rigidBody=PhysicsComponent._physicObjectsMap[rigidBodyID];rigidBody._simulation._updatedRigidbodies++;rigidBody._updateTransformComponent(worldTransPointer);}};var PhysicsCollider=/*#__PURE__*/function(_PhysicsTriggerCompon2){_inheritsLoose(PhysicsCollider,_PhysicsTriggerCompon2);function PhysicsCollider(collisionGroup,canCollideWith){var _this80;if(collisionGroup===void 0){collisionGroup=Physics3DUtils.COLLISIONFILTERGROUP_DEFAULTFILTER;}if(canCollideWith===void 0){canCollideWith=Physics3DUtils.COLLISIONFILTERGROUP_ALLFILTER;}_this80=_PhysicsTriggerCompon2.call(this,collisionGroup,canCollideWith)||this;_this80._enableProcessCollisions=false;return _this80;}var _proto159=PhysicsCollider.prototype;_proto159._addToSimulation=function _addToSimulation(){this._simulation._addPhysicsCollider(this,this._collisionGroup,this._canCollideWith);};_proto159._removeFromSimulation=function _removeFromSimulation(){this._simulation._removePhysicsCollider(this);};_proto159._parse=function _parse(data){data.friction!=null&&(this.friction=data.friction);data.rollingFriction!=null&&(this.rollingFriction=data.rollingFriction);data.restitution!=null&&(this.restitution=data.restitution);data.isTrigger!=null&&(this.isTrigger=data.isTrigger);_PhysicsTriggerCompon2.prototype._parse.call(this,data);this._parseShape(data.shapes);};_proto159._onAdded=function _onAdded(){var bt=Physics3D._bullet;var btColObj=bt.btCollisionObject_create();bt.btCollisionObject_setUserIndex(btColObj,this.id);bt.btCollisionObject_forceActivationState(btColObj,PhysicsComponent.ACTIVATIONSTATE_DISABLE_SIMULATION);var flags=bt.btCollisionObject_getCollisionFlags(btColObj);if(this.owner.isStatic){if((flags&PhysicsComponent.COLLISIONFLAGS_KINEMATIC_OBJECT)>0)flags=flags^PhysicsComponent.COLLISIONFLAGS_KINEMATIC_OBJECT;flags=flags|PhysicsComponent.COLLISIONFLAGS_STATIC_OBJECT;}else {if((flags&PhysicsComponent.COLLISIONFLAGS_STATIC_OBJECT)>0)flags=flags^PhysicsComponent.COLLISIONFLAGS_STATIC_OBJECT;flags=flags|PhysicsComponent.COLLISIONFLAGS_KINEMATIC_OBJECT;}bt.btCollisionObject_setCollisionFlags(btColObj,flags);this._btColliderObject=btColObj;_PhysicsTriggerCompon2.prototype._onAdded.call(this);};return PhysicsCollider;}(PhysicsTriggerComponent);var SubMesh=/*#__PURE__*/function(_GeometryElement7){_inheritsLoose(SubMesh,_GeometryElement7);function SubMesh(mesh){var _this81;_this81=_GeometryElement7.call(this)||this;_this81._id=++SubMesh._uniqueIDCounter;_this81._mesh=mesh;_this81._boneIndicesList=[];_this81._subIndexBufferStart=[];_this81._subIndexBufferCount=[];return _this81;}var _proto160=SubMesh.prototype;_proto160._setIndexRange=function _setIndexRange(indexStart,indexCount){this._indexStart=indexStart;this._indexCount=indexCount;this._indices=new Uint16Array(this._indexBuffer.getData().buffer,indexStart*2,indexCount);};_proto160._getType=function _getType(){return SubMesh._type;};_proto160._prepareRender=function _prepareRender(state){this._mesh._uploadVerticesData();return true;};_proto160._render=function _render(state){var mesh=this._mesh;if(mesh.indexFormat===exports.IndexFormat.UInt32&&!Laya.LayaGL.layaGPUInstance.supportElementIndexUint32()){console.warn("SubMesh:this device do not support IndexFormat.UInt32.");return;}var gl=Laya.LayaGL.instance;var skinnedDatas=state.renderElement.render._skinnedData;var glIndexFormat;var byteCount;switch(mesh.indexFormat){case exports.IndexFormat.UInt32:glIndexFormat=gl.UNSIGNED_INT;byteCount=4;break;case exports.IndexFormat.UInt16:glIndexFormat=gl.UNSIGNED_SHORT;byteCount=2;break;case exports.IndexFormat.UInt8:glIndexFormat=gl.UNSIGNED_BYTE;byteCount=1;break;}mesh._bufferState.bind();if(skinnedDatas){var subSkinnedDatas=skinnedDatas[this._indexInMesh];for(var i=0,n=this._boneIndicesList.length;i<n;i++){state.shader.uploadCustomUniform(SkinnedMeshSprite3D.BONES,subSkinnedDatas[i]);gl.drawElements(gl.TRIANGLES,this._subIndexBufferCount[i],glIndexFormat,this._subIndexBufferStart[i]*byteCount);}}else {gl.drawElements(gl.TRIANGLES,this._indexCount,glIndexFormat,this._indexStart*byteCount);}Laya.Stat.trianglesFaces+=this._indexCount/3;Laya.Stat.renderBatches++;};_proto160.getIndices=function getIndices(){if(this._mesh._isReadable)return this._indices.slice();else throw "SubMesh:can't get indices on subMesh,mesh's isReadable must be true.";};_proto160.setIndices=function setIndices(indices){this._indexBuffer.setData(indices,this._indexStart,0,this._indexCount);};_proto160.destroy=function destroy(){if(this._destroyed)return;_GeometryElement7.prototype.destroy.call(this);this._indexBuffer.destroy();this._indexBuffer=null;this._mesh=null;this._boneIndicesList=null;this._subIndexBufferStart=null;this._subIndexBufferCount=null;this._skinAnimationDatas=null;};_createClass(SubMesh,[{key:"indexCount",get:function get(){return this._indexCount;}}]);return SubMesh;}(GeometryElement);SubMesh._uniqueIDCounter=0;SubMesh._type=GeometryElement._typeCounter++;var skinnedMatrixCache=function skinnedMatrixCache(subMeshIndex,batchIndex,batchBoneIndex){this.subMeshIndex=subMeshIndex;this.batchIndex=batchIndex;this.batchBoneIndex=batchBoneIndex;};var Mesh=/*#__PURE__*/function(_Laya$Resource7){_inheritsLoose(Mesh,_Laya$Resource7);function Mesh(isReadable){var _this82;if(isReadable===void 0){isReadable=true;}_this82=_Laya$Resource7.call(this)||this;_this82._tempVector30=new Vector3();_this82._tempVector31=new Vector3();_this82._tempVector32=new Vector3();_this82._minVerticesUpdate=-1;_this82._maxVerticesUpdate=-1;_this82._needUpdateBounds=true;_this82._bounds=new Bounds(new Vector3(),new Vector3());_this82._bufferState=new BufferState();_this82._instanceBufferState=new BufferState();_this82._instanceBufferStateType=0;_this82._vertexBuffer=null;_this82._indexBuffer=null;_this82._skinnedMatrixCaches=[];_this82._vertexCount=0;_this82._indexFormat=exports.IndexFormat.UInt16;_this82._isReadable=isReadable;_this82._subMeshes=[];return _this82;}Mesh.__init__=function __init__(){var physics3D=Physics3D._bullet;if(physics3D){Mesh._nativeTempVector30=physics3D.btVector3_create(0,0,0);Mesh._nativeTempVector31=physics3D.btVector3_create(0,0,0);Mesh._nativeTempVector32=physics3D.btVector3_create(0,0,0);}};Mesh.load=function load(url,complete){Laya.ILaya.loader.create(url,complete,null,Mesh.MESH);};var _proto161=Mesh.prototype;_proto161._getPositionElement=function _getPositionElement(vertexBuffer){var vertexElements=vertexBuffer.vertexDeclaration._vertexElements;for(var i=0,n=vertexElements.length;i<n;i++){var vertexElement=vertexElements[i];if(vertexElement._elementFormat===VertexElementFormat.Vector3&&vertexElement._elementUsage===VertexMesh.MESH_POSITION0)return vertexElement;}return null;};_proto161._getVerticeElementData=function _getVerticeElementData(data,elementUsage){data.length=this._vertexCount;var verDec=this._vertexBuffer.vertexDeclaration;var element=verDec.getVertexElementByUsage(elementUsage);if(element){var uint8Vertices=this._vertexBuffer.getUint8Data();var floatVertices=this._vertexBuffer.getFloat32Data();var uint8VerStr=verDec.vertexStride;var floatVerStr=uint8VerStr/4;var uint8EleOffset=element._offset;var floatEleOffset=uint8EleOffset/4;switch(elementUsage){case VertexMesh.MESH_TEXTURECOORDINATE0:case VertexMesh.MESH_TEXTURECOORDINATE1:for(var i=0;i<this._vertexCount;i++){var offset=floatVerStr*i+floatEleOffset;data[i]=new Vector2(floatVertices[offset],floatVertices[offset+1]);}break;case VertexMesh.MESH_POSITION0:case VertexMesh.MESH_NORMAL0:for(var i=0;i<this._vertexCount;i++){var offset=floatVerStr*i+floatEleOffset;data[i]=new Vector3(floatVertices[offset],floatVertices[offset+1],floatVertices[offset+2]);}break;case VertexMesh.MESH_TANGENT0:case VertexMesh.MESH_BLENDWEIGHT0:for(var i=0;i<this._vertexCount;i++){var offset=floatVerStr*i+floatEleOffset;data[i]=new Vector4(floatVertices[offset],floatVertices[offset+1],floatVertices[offset+2],floatVertices[offset+3]);}break;case VertexMesh.MESH_COLOR0:for(var i=0;i<this._vertexCount;i++){var offset=floatVerStr*i+floatEleOffset;data[i]=new Color(floatVertices[offset],floatVertices[offset+1],floatVertices[offset+2],floatVertices[offset+3]);}break;case VertexMesh.MESH_BLENDINDICES0:for(var i=0;i<this._vertexCount;i++){var offset=uint8VerStr*i+uint8EleOffset;data[i]=new Vector4(uint8Vertices[offset],uint8Vertices[offset+1],uint8Vertices[offset+2],uint8Vertices[offset+3]);}break;default:throw "Mesh:Unknown elementUsage.";}}};_proto161._setVerticeElementData=function _setVerticeElementData(data,elementUsage){var verDec=this._vertexBuffer.vertexDeclaration;var element=verDec.getVertexElementByUsage(elementUsage);if(element){var uint8Vertices=this._vertexBuffer.getUint8Data();var floatVertices=this._vertexBuffer.getFloat32Data();var uint8VerStr=verDec.vertexStride;var float8VerStr=uint8VerStr/4;var uint8EleOffset=element._offset;var floatEleOffset=uint8EleOffset/4;switch(elementUsage){case VertexMesh.MESH_TEXTURECOORDINATE0:case VertexMesh.MESH_TEXTURECOORDINATE1:for(var i=0,n=data.length;i<n;i++){var offset=float8VerStr*i+floatEleOffset;var vec2=data[i];floatVertices[offset]=vec2.x;floatVertices[offset+1]=vec2.y;}break;case VertexMesh.MESH_POSITION0:case VertexMesh.MESH_NORMAL0:for(var i=0,n=data.length;i<n;i++){var offset=float8VerStr*i+floatEleOffset;var vec3=data[i];floatVertices[offset]=vec3.x;floatVertices[offset+1]=vec3.y;floatVertices[offset+2]=vec3.z;}break;case VertexMesh.MESH_TANGENT0:case VertexMesh.MESH_BLENDWEIGHT0:for(var i=0,n=data.length;i<n;i++){var offset=float8VerStr*i+floatEleOffset;var vec4=data[i];floatVertices[offset]=vec4.x;floatVertices[offset+1]=vec4.y;floatVertices[offset+2]=vec4.z;floatVertices[offset+3]=vec4.w;}break;case VertexMesh.MESH_COLOR0:for(var i=0,n=data.length;i<n;i++){var offset=float8VerStr*i+floatEleOffset;var cor=data[i];floatVertices[offset]=cor.r;floatVertices[offset+1]=cor.g;floatVertices[offset+2]=cor.b;floatVertices[offset+3]=cor.a;}break;case VertexMesh.MESH_BLENDINDICES0:for(var i=0,n=data.length;i<n;i++){var offset=uint8VerStr*i+uint8EleOffset;var vec4=data[i];uint8Vertices[offset]=vec4.x;uint8Vertices[offset+1]=vec4.y;uint8Vertices[offset+2]=vec4.z;uint8Vertices[offset+3]=vec4.w;}break;default:throw "Mesh:Unknown elementUsage.";}this._minVerticesUpdate=0;this._maxVerticesUpdate=Number.MAX_SAFE_INTEGER;}else {console.warn("Mesh: the mesh don't have  this VertexElement.");}};_proto161._disposeResource=function _disposeResource(){for(var i=0,n=this._subMeshes.length;i<n;i++){this._subMeshes[i].destroy();}this._btTriangleMesh&&Physics3D._bullet.btStridingMeshInterface_destroy(this._btTriangleMesh);this._vertexBuffer.destroy();this._indexBuffer.destroy();this._bufferState.destroy();this._instanceBufferState.destroy();this._setCPUMemory(0);this._setGPUMemory(0);this._bufferState=null;this._instanceBufferState=null;this._vertexBuffer=null;this._indexBuffer=null;this._subMeshes=null;this._btTriangleMesh=null;this._indexBuffer=null;this._boneNames=null;this._inverseBindPoses=null;};_proto161._setSubMeshes=function _setSubMeshes(subMeshes){this._subMeshes=subMeshes;for(var i=0,n=subMeshes.length;i<n;i++){subMeshes[i]._indexInMesh=i;}};_proto161._setBuffer=function _setBuffer(vertexBuffer,indexBuffer){var bufferState=this._bufferState;bufferState.bind();bufferState.applyVertexBuffer(vertexBuffer);bufferState.applyIndexBuffer(indexBuffer);bufferState.unBind();};_proto161._setInstanceBuffer=function _setInstanceBuffer(instanceBufferStateType){var instanceBufferState=this._instanceBufferState;instanceBufferState.bind();instanceBufferState.applyVertexBuffer(this._vertexBuffer);instanceBufferState.applyInstanceVertexBuffer(SubMeshInstanceBatch.instance.instanceWorldMatrixBuffer);instanceBufferState.applyInstanceVertexBuffer(SubMeshInstanceBatch.instance.instanceMVPMatrixBuffer);switch(instanceBufferStateType){case Mesh.MESH_INSTANCEBUFFER_TYPE_SIMPLEANIMATOR:instanceBufferState.applyInstanceVertexBuffer(SubMeshInstanceBatch.instance.instanceSimpleAnimatorBuffer);break;}instanceBufferState.applyIndexBuffer(this._indexBuffer);instanceBufferState.unBind();};_proto161._getPhysicMesh=function _getPhysicMesh(){if(!this._btTriangleMesh){var bt=Physics3D._bullet;var triangleMesh=bt.btTriangleMesh_create();var nativePositio0=Mesh._nativeTempVector30;var nativePositio1=Mesh._nativeTempVector31;var nativePositio2=Mesh._nativeTempVector32;var position0=this._tempVector30;var position1=this._tempVector31;var position2=this._tempVector32;var vertexBuffer=this._vertexBuffer;var positionElement=this._getPositionElement(vertexBuffer);var verticesData=vertexBuffer.getFloat32Data();var floatCount=vertexBuffer.vertexDeclaration.vertexStride/4;var posOffset=positionElement._offset/4;var indices=this._indexBuffer.getData();for(var i=0,n=indices.length;i<n;i+=3){var p0Index=indices[i]*floatCount+posOffset;var p1Index=indices[i+1]*floatCount+posOffset;var p2Index=indices[i+2]*floatCount+posOffset;position0.setValue(verticesData[p0Index],verticesData[p0Index+1],verticesData[p0Index+2]);position1.setValue(verticesData[p1Index],verticesData[p1Index+1],verticesData[p1Index+2]);position2.setValue(verticesData[p2Index],verticesData[p2Index+1],verticesData[p2Index+2]);Utils3D._convertToBulletVec3(position0,nativePositio0,true);Utils3D._convertToBulletVec3(position1,nativePositio1,true);Utils3D._convertToBulletVec3(position2,nativePositio2,true);bt.btTriangleMesh_addTriangle(triangleMesh,nativePositio0,nativePositio1,nativePositio2,true);}this._btTriangleMesh=triangleMesh;}return this._btTriangleMesh;};_proto161._uploadVerticesData=function _uploadVerticesData(){var min=this._minVerticesUpdate;var max=this._maxVerticesUpdate;if(min!==-1&&max!==-1){var offset=min;this._vertexBuffer.setData(this._vertexBuffer.getUint8Data().buffer,offset,offset,max-min);this._minVerticesUpdate=-1;this._maxVerticesUpdate=-1;}};_proto161.getSubMesh=function getSubMesh(index){return this._subMeshes[index];};_proto161.getPositions=function getPositions(positions){if(this._isReadable)this._getVerticeElementData(positions,VertexMesh.MESH_POSITION0);else throw "Mesh:can't get positions on mesh,isReadable must be true.";};_proto161.setPositions=function setPositions(positions){if(this._isReadable){this._setVerticeElementData(positions,VertexMesh.MESH_POSITION0);this._needUpdateBounds=true;}else {throw "Mesh:setPosition() need isReadable must be true or use setVertices().";}};_proto161.getColors=function getColors(colors){if(this._isReadable)this._getVerticeElementData(colors,VertexMesh.MESH_COLOR0);else throw "Mesh:can't get colors on mesh,isReadable must be true.";};_proto161.setColors=function setColors(colors){if(this._isReadable)this._setVerticeElementData(colors,VertexMesh.MESH_COLOR0);else throw "Mesh:setColors() need isReadable must be true or use setVertices().";};_proto161.getUVs=function getUVs(uvs,channel){if(channel===void 0){channel=0;}if(this._isReadable){switch(channel){case 0:this._getVerticeElementData(uvs,VertexMesh.MESH_TEXTURECOORDINATE0);break;case 1:this._getVerticeElementData(uvs,VertexMesh.MESH_TEXTURECOORDINATE1);break;default:throw "Mesh:Invalid channel.";}}else {throw "Mesh:can't get uvs on mesh,isReadable must be true.";}};_proto161.setUVs=function setUVs(uvs,channel){if(channel===void 0){channel=0;}if(this._isReadable){switch(channel){case 0:this._setVerticeElementData(uvs,VertexMesh.MESH_TEXTURECOORDINATE0);break;case 1:this._setVerticeElementData(uvs,VertexMesh.MESH_TEXTURECOORDINATE1);break;default:throw "Mesh:Invalid channel.";}}else {throw "Mesh:setUVs() need isReadable must be true or use setVertices().";}};_proto161.getNormals=function getNormals(normals){if(this._isReadable)this._getVerticeElementData(normals,VertexMesh.MESH_NORMAL0);else throw "Mesh:can't get colors on mesh,isReadable must be true.";};_proto161.setNormals=function setNormals(normals){if(this._isReadable)this._setVerticeElementData(normals,VertexMesh.MESH_NORMAL0);else throw "Mesh:setNormals() need must be true or use setVertices().";};_proto161.getTangents=function getTangents(tangents){if(this._isReadable)this._getVerticeElementData(tangents,VertexMesh.MESH_TANGENT0);else throw "Mesh:can't get colors on mesh,isReadable must be true.";};_proto161.setTangents=function setTangents(tangents){if(this._isReadable)this._setVerticeElementData(tangents,VertexMesh.MESH_TANGENT0);else throw "Mesh:setTangents() need isReadable must be true or use setVertices().";};_proto161.getBoneWeights=function getBoneWeights(boneWeights){if(this._isReadable)this._getVerticeElementData(boneWeights,VertexMesh.MESH_BLENDWEIGHT0);else throw "Mesh:can't get boneWeights on mesh,isReadable must be true.";};_proto161.setBoneWeights=function setBoneWeights(boneWeights){if(this._isReadable)this._setVerticeElementData(boneWeights,VertexMesh.MESH_BLENDWEIGHT0);else throw "Mesh:setBoneWeights() need isReadable must be true or use setVertices().";};_proto161.getBoneIndices=function getBoneIndices(boneIndices){if(this._isReadable)this._getVerticeElementData(boneIndices,VertexMesh.MESH_BLENDINDICES0);else throw "Mesh:can't get boneIndices on mesh,isReadable must be true.";};_proto161.setBoneIndices=function setBoneIndices(boneIndices){if(this._isReadable)this._setVerticeElementData(boneIndices,VertexMesh.MESH_BLENDINDICES0);else throw "Mesh:setBoneIndices() need isReadable must be true or use setVertices().";};_proto161.markAsUnreadbale=function markAsUnreadbale(){this._uploadVerticesData();this._vertexBuffer.markAsUnreadbale();this._isReadable=false;};_proto161.getVertexDeclaration=function getVertexDeclaration(){return this._vertexBuffer._vertexDeclaration;};_proto161.getVertices=function getVertices(){if(this._isReadable)return this._vertexBuffer.getUint8Data().buffer.slice(0);else throw "Mesh:can't get vertices on mesh,isReadable must be true.";};_proto161.setVertices=function setVertices(vertices){this._vertexBuffer.setData(vertices);this._needUpdateBounds=true;};_proto161.getIndices=function getIndices(){if(this._isReadable)return this._indexBuffer.getData().slice();else throw "Mesh:can't get indices on subMesh,mesh's isReadable must be true.";};_proto161.setIndices=function setIndices(indices){var format;if(indices instanceof Uint32Array)format=exports.IndexFormat.UInt32;else if(indices instanceof Uint16Array)format=exports.IndexFormat.UInt16;else if(indices instanceof Uint8Array)format=exports.IndexFormat.UInt8;var indexBuffer=this._indexBuffer;if(this._indexFormat!==format||indexBuffer.indexCount!==indices.length){indexBuffer.destroy();this._indexBuffer=indexBuffer=new IndexBuffer3D(format,indices.length,Laya.LayaGL.instance.STATIC_DRAW,this._isReadable);}indexBuffer.setData(indices);this._indexFormat=format;};_proto161.calculateBounds=function calculateBounds(){if(this._isReadable){if(this._needUpdateBounds){var min=this._tempVector30;var max=this._tempVector31;min.x=min.y=min.z=Number.MAX_VALUE;max.x=max.y=max.z=-Number.MAX_VALUE;var vertexBuffer=this._vertexBuffer;var positionElement=this._getPositionElement(vertexBuffer);var verticesData=vertexBuffer.getFloat32Data();var floatCount=vertexBuffer.vertexDeclaration.vertexStride/4;var posOffset=positionElement._offset/4;for(var j=0,m=verticesData.length;j<m;j+=floatCount){var ofset=j+posOffset;var pX=verticesData[ofset];var pY=verticesData[ofset+1];var pZ=verticesData[ofset+2];min.x=Math.min(min.x,pX);min.y=Math.min(min.y,pY);min.z=Math.min(min.z,pZ);max.x=Math.max(max.x,pX);max.y=Math.max(max.y,pY);max.z=Math.max(max.z,pZ);}this._bounds.setMin(min);this._bounds.setMax(max);this._needUpdateBounds=false;}}else {throw "Mesh:can't calculate bounds on subMesh,mesh's isReadable must be true.";}};_proto161.cloneTo=function cloneTo(destObject){var destMesh=destObject;var vb=this._vertexBuffer;var destVB=new VertexBuffer3D(vb._byteLength,vb.bufferUsage,vb.canRead);destVB.vertexDeclaration=vb.vertexDeclaration;destVB.setData(vb.getUint8Data().slice().buffer);destMesh._vertexBuffer=destVB;destMesh._vertexCount=this._vertexCount;var ib=this._indexBuffer;var destIB=new IndexBuffer3D(exports.IndexFormat.UInt16,ib.indexCount,ib.bufferUsage,ib.canRead);destIB.setData(ib.getData().slice());destMesh._indexBuffer=destIB;destMesh._setBuffer(destMesh._vertexBuffer,destIB);destMesh._setInstanceBuffer(this._instanceBufferStateType);destMesh._setCPUMemory(this.cpuMemory);destMesh._setGPUMemory(this.gpuMemory);var i;var boneNames=this._boneNames;if(boneNames){var destBoneNames=destMesh._boneNames=[];for(i=0;i<boneNames.length;i++){destBoneNames[i]=boneNames[i];}}var inverseBindPoses=this._inverseBindPoses;if(inverseBindPoses){var destInverseBindPoses=destMesh._inverseBindPoses=[];for(i=0;i<inverseBindPoses.length;i++){destInverseBindPoses[i]=inverseBindPoses[i];}}var cacheLength=this._skinnedMatrixCaches.length;destMesh._skinnedMatrixCaches.length=cacheLength;for(i=0;i<cacheLength;i++){var skinnedCache=this._skinnedMatrixCaches[i];destMesh._skinnedMatrixCaches[i]=new skinnedMatrixCache(skinnedCache.subMeshIndex,skinnedCache.batchIndex,skinnedCache.batchBoneIndex);}for(i=0;i<this.subMeshCount;i++){var subMesh=this._subMeshes[i];var subIndexBufferStart=subMesh._subIndexBufferStart;var subIndexBufferCount=subMesh._subIndexBufferCount;var boneIndicesList=subMesh._boneIndicesList;var destSubmesh=new SubMesh(destMesh);destSubmesh._subIndexBufferStart.length=subIndexBufferStart.length;destSubmesh._subIndexBufferCount.length=subIndexBufferCount.length;destSubmesh._boneIndicesList.length=boneIndicesList.length;for(var j=0;j<subIndexBufferStart.length;j++){destSubmesh._subIndexBufferStart[j]=subIndexBufferStart[j];}for(j=0;j<subIndexBufferCount.length;j++){destSubmesh._subIndexBufferCount[j]=subIndexBufferCount[j];}for(j=0;j<boneIndicesList.length;j++){destSubmesh._boneIndicesList[j]=new Uint16Array(boneIndicesList[j]);}destSubmesh._indexBuffer=destIB;destSubmesh._indexStart=subMesh._indexStart;destSubmesh._indexCount=subMesh._indexCount;destSubmesh._indices=new Uint16Array(destIB.getData().buffer,subMesh._indexStart*2,subMesh._indexCount);var vertexBuffer=destMesh._vertexBuffer;destSubmesh._vertexBuffer=vertexBuffer;destMesh._subMeshes.push(destSubmesh);}destMesh._setSubMeshes(destMesh._subMeshes);};_proto161.clone=function clone(){var dest=new Mesh();this.cloneTo(dest);return dest;};_createClass(Mesh,[{key:"inverseAbsoluteBindPoses",get:function get(){return this._inverseBindPoses;}},{key:"vertexCount",get:function get(){return this._vertexCount;}},{key:"indexCount",get:function get(){return this._indexBuffer.indexCount;}},{key:"subMeshCount",get:function get(){return this._subMeshes.length;}},{key:"bounds",get:function get(){return this._bounds;},set:function set(value){if(this._bounds!==value)value.cloneTo(this._bounds);}},{key:"indexFormat",get:function get(){return this._indexFormat;}}]);return Mesh;}(Laya.Resource);Mesh.MESH="MESH";Mesh.MESH_INSTANCEBUFFER_TYPE_NORMAL=0;Mesh.MESH_INSTANCEBUFFER_TYPE_SIMPLEANIMATOR=1;var PrimitiveMesh=/*#__PURE__*/function(){function PrimitiveMesh(){}PrimitiveMesh.__init__=function __init__(){};PrimitiveMesh._createMesh=function _createMesh(vertexDeclaration,vertices,indices){var gl=Laya.LayaGL.instance;var mesh=new Mesh();var subMesh=new SubMesh(mesh);var vertexBuffer=new VertexBuffer3D(vertices.length*4,gl.STATIC_DRAW,true);vertexBuffer.vertexDeclaration=vertexDeclaration;vertexBuffer.setData(vertices.buffer);mesh._vertexBuffer=vertexBuffer;mesh._vertexCount=vertexBuffer._byteLength/vertexDeclaration.vertexStride;var indexBuffer=new IndexBuffer3D(exports.IndexFormat.UInt16,indices.length,gl.STATIC_DRAW,true);indexBuffer.setData(indices);mesh._indexBuffer=indexBuffer;mesh._setBuffer(vertexBuffer,indexBuffer);mesh._setInstanceBuffer(mesh._instanceBufferStateType);subMesh._vertexBuffer=vertexBuffer;subMesh._indexBuffer=indexBuffer;subMesh._setIndexRange(0,indexBuffer.indexCount);var subIndexBufferStart=subMesh._subIndexBufferStart;var subIndexBufferCount=subMesh._subIndexBufferCount;var boneIndicesList=subMesh._boneIndicesList;subIndexBufferStart.length=1;subIndexBufferCount.length=1;boneIndicesList.length=1;subIndexBufferStart[0]=0;subIndexBufferCount[0]=indexBuffer.indexCount;var subMeshes=[];subMeshes.push(subMesh);mesh._setSubMeshes(subMeshes);mesh.calculateBounds();var memorySize=vertexBuffer._byteLength+indexBuffer._byteLength;mesh._setCPUMemory(memorySize);mesh._setGPUMemory(memorySize);return mesh;};PrimitiveMesh.createBox=function createBox(_long,height,width){if(_long===void 0){_long=1;}if(height===void 0){height=1;}if(width===void 0){width=1;}var vertexDeclaration=VertexMesh.getVertexDeclaration("POSITION,NORMAL,UV");var halfLong=_long/2;var halfHeight=height/2;var halfWidth=width/2;var vertices=new Float32Array([-halfLong,halfHeight,-halfWidth,0,1,0,0,0,halfLong,halfHeight,-halfWidth,0,1,0,1,0,halfLong,halfHeight,halfWidth,0,1,0,1,1,-halfLong,halfHeight,halfWidth,0,1,0,0,1,-halfLong,-halfHeight,-halfWidth,0,-1,0,0,1,halfLong,-halfHeight,-halfWidth,0,-1,0,1,1,halfLong,-halfHeight,halfWidth,0,-1,0,1,0,-halfLong,-halfHeight,halfWidth,0,-1,0,0,0,-halfLong,halfHeight,-halfWidth,-1,0,0,0,0,-halfLong,halfHeight,halfWidth,-1,0,0,1,0,-halfLong,-halfHeight,halfWidth,-1,0,0,1,1,-halfLong,-halfHeight,-halfWidth,-1,0,0,0,1,halfLong,halfHeight,-halfWidth,1,0,0,1,0,halfLong,halfHeight,halfWidth,1,0,0,0,0,halfLong,-halfHeight,halfWidth,1,0,0,0,1,halfLong,-halfHeight,-halfWidth,1,0,0,1,1,-halfLong,halfHeight,halfWidth,0,0,1,0,0,halfLong,halfHeight,halfWidth,0,0,1,1,0,halfLong,-halfHeight,halfWidth,0,0,1,1,1,-halfLong,-halfHeight,halfWidth,0,0,1,0,1,-halfLong,halfHeight,-halfWidth,0,0,-1,1,0,halfLong,halfHeight,-halfWidth,0,0,-1,0,0,halfLong,-halfHeight,-halfWidth,0,0,-1,0,1,-halfLong,-halfHeight,-halfWidth,0,0,-1,1,1]);var indices=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);return PrimitiveMesh._createMesh(vertexDeclaration,vertices,indices);};PrimitiveMesh.createCapsule=function createCapsule(radius,height,stacks,slices){if(radius===void 0){radius=0.5;}if(height===void 0){height=2;}if(stacks===void 0){stacks=16;}if(slices===void 0){slices=32;}var vertexCount=(stacks+1)*(slices+1)*2+(slices+1)*2;var indexCount=3*stacks*(slices+1)*2*2+2*slices*3;var vertexDeclaration=VertexMesh.getVertexDeclaration("POSITION,NORMAL,UV");var vertexFloatStride=vertexDeclaration.vertexStride/4;var vertices=new Float32Array(vertexCount*vertexFloatStride);var indices=new Uint16Array(indexCount);var stackAngle=Math.PI/2.0/stacks;var sliceAngle=Math.PI*2.0/slices;var hcHeight=height/2-radius;var posX=0;var posY=0;var posZ=0;var vc=0;var ic=0;var verticeCount=0;var stack,slice;for(stack=0;stack<=stacks;stack++){for(slice=0;slice<=slices;slice++){posX=radius*Math.cos(stack*stackAngle)*Math.cos(slice*sliceAngle+Math.PI);posY=radius*Math.sin(stack*stackAngle);posZ=radius*Math.cos(stack*stackAngle)*Math.sin(slice*sliceAngle+Math.PI);vertices[vc++]=posX;vertices[vc++]=posY+hcHeight;vertices[vc++]=posZ;vertices[vc++]=posX;vertices[vc++]=posY;vertices[vc++]=posZ;vertices[vc++]=1-slice/slices;vertices[vc++]=(1-stack/stacks)*(Math.PI*radius/2/(height+Math.PI*radius));if(stack<stacks){indices[ic++]=stack*(slices+1)+slice+(slices+1);indices[ic++]=stack*(slices+1)+slice;indices[ic++]=stack*(slices+1)+slice+1;indices[ic++]=stack*(slices+1)+slice+slices;indices[ic++]=stack*(slices+1)+slice;indices[ic++]=stack*(slices+1)+slice+(slices+1);}}}verticeCount+=(stacks+1)*(slices+1);for(stack=0;stack<=stacks;stack++){for(slice=0;slice<=slices;slice++){posX=radius*Math.cos(stack*stackAngle)*Math.cos(slice*sliceAngle+Math.PI);posY=radius*Math.sin(-stack*stackAngle);posZ=radius*Math.cos(stack*stackAngle)*Math.sin(slice*sliceAngle+Math.PI);vertices[vc++]=posX;vertices[vc++]=posY-hcHeight;vertices[vc++]=posZ;vertices[vc++]=posX;vertices[vc++]=posY;vertices[vc++]=posZ;vertices[vc++]=1-slice/slices;vertices[vc++]=(stack/stacks*(Math.PI*radius/2)+(height+Math.PI*radius/2))/(height+Math.PI*radius);if(stack<stacks){indices[ic++]=verticeCount+stack*(slices+1)+slice;indices[ic++]=verticeCount+stack*(slices+1)+slice+(slices+1);indices[ic++]=verticeCount+stack*(slices+1)+slice+1;indices[ic++]=verticeCount+stack*(slices+1)+slice;indices[ic++]=verticeCount+stack*(slices+1)+slice+slices;indices[ic++]=verticeCount+stack*(slices+1)+slice+(slices+1);}}}verticeCount+=(stacks+1)*(slices+1);for(slice=0;slice<=slices;slice++){posX=radius*Math.cos(slice*sliceAngle+Math.PI);posY=hcHeight;posZ=radius*Math.sin(slice*sliceAngle+Math.PI);vertices[vc++]=posX;vertices[vc+(slices+1)*8-1]=posX;vertices[vc++]=posY;vertices[vc+(slices+1)*8-1]=-posY;vertices[vc++]=posZ;vertices[vc+(slices+1)*8-1]=posZ;vertices[vc++]=posX;vertices[vc+(slices+1)*8-1]=posX;vertices[vc++]=0;vertices[vc+(slices+1)*8-1]=0;vertices[vc++]=posZ;vertices[vc+(slices+1)*8-1]=posZ;vertices[vc++]=1-slice*1/slices;vertices[vc+(slices+1)*8-1]=1-slice*1/slices;vertices[vc++]=Math.PI*radius/2/(height+Math.PI*radius);vertices[vc+(slices+1)*8-1]=(Math.PI*radius/2+height)/(height+Math.PI*radius);}for(slice=0;slice<slices;slice++){indices[ic++]=slice+verticeCount+(slices+1);indices[ic++]=slice+verticeCount+1;indices[ic++]=slice+verticeCount;indices[ic++]=slice+verticeCount+(slices+1);indices[ic++]=slice+verticeCount+(slices+1)+1;indices[ic++]=slice+verticeCount+1;}verticeCount+=2*(slices+1);return PrimitiveMesh._createMesh(vertexDeclaration,vertices,indices);};PrimitiveMesh.createCone=function createCone(radius,height,slices){if(radius===void 0){radius=0.5;}if(height===void 0){height=1;}if(slices===void 0){slices=32;}var vertexCount=slices+1+1+(slices+1)*2;var indexCount=6*slices+3*slices;var vertexDeclaration=VertexMesh.getVertexDeclaration("POSITION,NORMAL,UV");var vertexFloatStride=vertexDeclaration.vertexStride/4;var vertices=new Float32Array(vertexCount*vertexFloatStride);var indices=new Uint16Array(indexCount);var sliceAngle=Math.PI*2.0/slices;var halfHeight=height/2;var curAngle=0;var verticeCount=0;var posX=0;var posY=0;var posZ=0;var normal=new Vector3();var downV3=new Vector3(0,-1,0);var upPoint=new Vector3(0,halfHeight,0);var downPoint=new Vector3();var v3=new Vector3();var q4=new Quaternion();var rotateAxis=new Vector3();var rotateRadius;var vc=0;var ic=0;for(var rv=0;rv<=slices;rv++){curAngle=rv*sliceAngle;posX=Math.cos(curAngle+Math.PI)*radius;posY=halfHeight;posZ=Math.sin(curAngle+Math.PI)*radius;vertices[vc++]=0;vertices[vc+(slices+1)*8-1]=posX;vertices[vc++]=posY;vertices[vc+(slices+1)*8-1]=-posY;vertices[vc++]=0;vertices[vc+(slices+1)*8-1]=posZ;normal.x=posX;normal.y=0;normal.z=posZ;downPoint.x=posX;downPoint.y=-posY;downPoint.z=posZ;Vector3.subtract(downPoint,upPoint,v3);Vector3.normalize(v3,v3);rotateRadius=Math.acos(Vector3.dot(downV3,v3));Vector3.cross(downV3,v3,rotateAxis);Vector3.normalize(rotateAxis,rotateAxis);Quaternion.createFromAxisAngle(rotateAxis,rotateRadius,q4);Vector3.normalize(normal,normal);Vector3.transformQuat(normal,q4,normal);Vector3.normalize(normal,normal);vertices[vc++]=normal.x;vertices[vc+(slices+1)*8-1]=normal.x;vertices[vc++]=normal.y;vertices[vc+(slices+1)*8-1]=normal.y;vertices[vc++]=normal.z;vertices[vc+(slices+1)*8-1]=normal.z;vertices[vc++]=1-rv*1/slices;vertices[vc+(slices+1)*8-1]=1-rv*1/slices;vertices[vc++]=0;vertices[vc+(slices+1)*8-1]=1;}vc+=(slices+1)*8;for(var ri=0;ri<slices;ri++){indices[ic++]=ri+verticeCount+(slices+1);indices[ic++]=ri+verticeCount+1;indices[ic++]=ri+verticeCount;indices[ic++]=ri+verticeCount+(slices+1);indices[ic++]=ri+verticeCount+(slices+1)+1;indices[ic++]=ri+verticeCount+1;}verticeCount+=2*(slices+1);for(var bv=0;bv<=slices;bv++){if(bv===0){vertices[vc++]=0;vertices[vc++]=-halfHeight;vertices[vc++]=0;vertices[vc++]=0;vertices[vc++]=-1;vertices[vc++]=0;vertices[vc++]=0.5;vertices[vc++]=0.5;}curAngle=bv*sliceAngle;posX=Math.cos(curAngle+Math.PI)*radius;posY=-halfHeight;posZ=Math.sin(curAngle+Math.PI)*radius;vertices[vc++]=posX;vertices[vc++]=posY;vertices[vc++]=posZ;vertices[vc++]=0;vertices[vc++]=-1;vertices[vc++]=0;vertices[vc++]=0.5+Math.cos(curAngle)*0.5;vertices[vc++]=0.5+Math.sin(curAngle)*0.5;}for(var bi=0;bi<slices;bi++){indices[ic++]=0+verticeCount;indices[ic++]=bi+2+verticeCount;indices[ic++]=bi+1+verticeCount;}verticeCount+=slices+1+1;return PrimitiveMesh._createMesh(vertexDeclaration,vertices,indices);};PrimitiveMesh.createCylinder=function createCylinder(radius,height,slices){if(radius===void 0){radius=0.5;}if(height===void 0){height=2;}if(slices===void 0){slices=32;}var vertexCount=slices+1+1+(slices+1)*2+(slices+1+1);var indexCount=3*slices+6*slices+3*slices;var vertexDeclaration=VertexMesh.getVertexDeclaration("POSITION,NORMAL,UV");var vertexFloatStride=vertexDeclaration.vertexStride/4;var vertices=new Float32Array(vertexCount*vertexFloatStride);var indices=new Uint16Array(indexCount);var sliceAngle=Math.PI*2.0/slices;var halfHeight=height/2;var curAngle=0;var verticeCount=0;var posX=0;var posY=0;var posZ=0;var vc=0;var ic=0;for(var tv=0;tv<=slices;tv++){if(tv===0){vertices[vc++]=0;vertices[vc++]=halfHeight;vertices[vc++]=0;vertices[vc++]=0;vertices[vc++]=1;vertices[vc++]=0;vertices[vc++]=0.5;vertices[vc++]=0.5;}curAngle=tv*sliceAngle;posX=Math.cos(curAngle)*radius;posY=halfHeight;posZ=Math.sin(curAngle)*radius;vertices[vc++]=posX;vertices[vc++]=posY;vertices[vc++]=posZ;vertices[vc++]=0;vertices[vc++]=1;vertices[vc++]=0;vertices[vc++]=0.5+Math.cos(curAngle)*0.5;vertices[vc++]=0.5+Math.sin(curAngle)*0.5;}for(var ti=0;ti<slices;ti++){indices[ic++]=0;indices[ic++]=ti+1;indices[ic++]=ti+2;}verticeCount+=slices+1+1;for(var rv=0;rv<=slices;rv++){curAngle=rv*sliceAngle;posX=Math.cos(curAngle+Math.PI)*radius;posY=halfHeight;posZ=Math.sin(curAngle+Math.PI)*radius;vertices[vc++]=posX;vertices[vc+(slices+1)*8-1]=posX;vertices[vc++]=posY;vertices[vc+(slices+1)*8-1]=-posY;vertices[vc++]=posZ;vertices[vc+(slices+1)*8-1]=posZ;vertices[vc++]=posX;vertices[vc+(slices+1)*8-1]=posX;vertices[vc++]=0;vertices[vc+(slices+1)*8-1]=0;vertices[vc++]=posZ;vertices[vc+(slices+1)*8-1]=posZ;vertices[vc++]=1-rv*1/slices;vertices[vc+(slices+1)*8-1]=1-rv*1/slices;vertices[vc++]=0;vertices[vc+(slices+1)*8-1]=1;}vc+=(slices+1)*8;for(var ri=0;ri<slices;ri++){indices[ic++]=ri+verticeCount+(slices+1);indices[ic++]=ri+verticeCount+1;indices[ic++]=ri+verticeCount;indices[ic++]=ri+verticeCount+(slices+1);indices[ic++]=ri+verticeCount+(slices+1)+1;indices[ic++]=ri+verticeCount+1;}verticeCount+=2*(slices+1);for(var bv=0;bv<=slices;bv++){if(bv===0){vertices[vc++]=0;vertices[vc++]=-halfHeight;vertices[vc++]=0;vertices[vc++]=0;vertices[vc++]=-1;vertices[vc++]=0;vertices[vc++]=0.5;vertices[vc++]=0.5;}curAngle=bv*sliceAngle;posX=Math.cos(curAngle+Math.PI)*radius;posY=-halfHeight;posZ=Math.sin(curAngle+Math.PI)*radius;vertices[vc++]=posX;vertices[vc++]=posY;vertices[vc++]=posZ;vertices[vc++]=0;vertices[vc++]=-1;vertices[vc++]=0;vertices[vc++]=0.5+Math.cos(curAngle)*0.5;vertices[vc++]=0.5+Math.sin(curAngle)*0.5;}for(var bi=0;bi<slices;bi++){indices[ic++]=0+verticeCount;indices[ic++]=bi+2+verticeCount;indices[ic++]=bi+1+verticeCount;}verticeCount+=slices+1+1;return PrimitiveMesh._createMesh(vertexDeclaration,vertices,indices);};PrimitiveMesh.createPlane=function createPlane(_long2,width,stacks,slices){if(_long2===void 0){_long2=10;}if(width===void 0){width=10;}if(stacks===void 0){stacks=10;}if(slices===void 0){slices=10;}var vertexCount=(stacks+1)*(slices+1);var indexCount=stacks*slices*2*3;var indices=new Uint16Array(indexCount);var vertexDeclaration=VertexMesh.getVertexDeclaration("POSITION,NORMAL,UV");var vertexFloatStride=vertexDeclaration.vertexStride/4;var vertices=new Float32Array(vertexCount*vertexFloatStride);var halfLong=_long2/2;var halfWidth=width/2;var stacksLong=_long2/stacks;var slicesWidth=width/slices;var verticeCount=0;for(var i=0;i<=slices;i++){for(var j=0;j<=stacks;j++){vertices[verticeCount++]=j*stacksLong-halfLong;vertices[verticeCount++]=0;vertices[verticeCount++]=i*slicesWidth-halfWidth;vertices[verticeCount++]=0;vertices[verticeCount++]=1;vertices[verticeCount++]=0;vertices[verticeCount++]=j*1/stacks;vertices[verticeCount++]=i*1/slices;}}var indiceIndex=0;for(i=0;i<slices;i++){for(j=0;j<stacks;j++){indices[indiceIndex++]=(i+1)*(stacks+1)+j;indices[indiceIndex++]=i*(stacks+1)+j;indices[indiceIndex++]=(i+1)*(stacks+1)+j+1;indices[indiceIndex++]=i*(stacks+1)+j;indices[indiceIndex++]=i*(stacks+1)+j+1;indices[indiceIndex++]=(i+1)*(stacks+1)+j+1;}}return PrimitiveMesh._createMesh(vertexDeclaration,vertices,indices);};PrimitiveMesh.createQuad=function createQuad(_long3,width){if(_long3===void 0){_long3=1;}if(width===void 0){width=1;}var vertexDeclaration=VertexMesh.getVertexDeclaration("POSITION,NORMAL,UV");var halfLong=_long3/2;var halfWidth=width/2;var vertices=new Float32Array([-halfLong,halfWidth,0,0,0,1,0,0,halfLong,halfWidth,0,0,0,1,1,0,-halfLong,-halfWidth,0,0,0,1,0,1,halfLong,-halfWidth,0,0,0,1,1,1]);var indices=new Uint16Array([0,1,2,3,2,1]);return PrimitiveMesh._createMesh(vertexDeclaration,vertices,indices);};PrimitiveMesh.createSphere=function createSphere(radius,stacks,slices){if(radius===void 0){radius=0.5;}if(stacks===void 0){stacks=32;}if(slices===void 0){slices=32;}var vertexCount=(stacks+1)*(slices+1);var indexCount=3*stacks*(slices+1)*2;var indices=new Uint16Array(indexCount);var vertexDeclaration=VertexMesh.getVertexDeclaration("POSITION,NORMAL,UV");var vertexFloatStride=vertexDeclaration.vertexStride/4;var vertices=new Float32Array(vertexCount*vertexFloatStride);var stackAngle=Math.PI/stacks;var sliceAngle=Math.PI*2.0/slices;var vertexIndex=0;vertexCount=0;indexCount=0;for(var stack=0;stack<stacks+1;stack++){var r=Math.sin(stack*stackAngle);var y=Math.cos(stack*stackAngle);for(var slice=0;slice<slices+1;slice++){var x=r*Math.sin(slice*sliceAngle+Math.PI*1/2);var z=r*Math.cos(slice*sliceAngle+Math.PI*1/2);vertices[vertexCount+0]=x*radius;vertices[vertexCount+1]=y*radius;vertices[vertexCount+2]=z*radius;vertices[vertexCount+3]=x;vertices[vertexCount+4]=y;vertices[vertexCount+5]=z;vertices[vertexCount+6]=slice/slices;vertices[vertexCount+7]=stack/stacks;vertexCount+=vertexFloatStride;if(stack!=stacks-1){indices[indexCount++]=vertexIndex+(slices+1);indices[indexCount++]=vertexIndex;indices[indexCount++]=vertexIndex+1;indices[indexCount++]=vertexIndex+slices;indices[indexCount++]=vertexIndex;indices[indexCount++]=vertexIndex+(slices+1);vertexIndex++;}}}return PrimitiveMesh._createMesh(vertexDeclaration,vertices,indices);};return PrimitiveMesh;}();var BlitScreenPS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\nuniform sampler2D u_MainTex;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_FragColor = texture2D(u_MainTex, v_Texcoord0);\n}\n\n";var BlitScreenVS="#include \"Lighting.glsl\";\n\nattribute vec4 a_PositionTexcoord;\nuniform vec4 u_OffsetScale;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\t\n\tgl_Position = vec4(u_OffsetScale.x*2.0-1.0+(a_PositionTexcoord.x+1.0)*u_OffsetScale.z,(1.0-((u_OffsetScale.y*2.0-1.0+(-a_PositionTexcoord.y+1.0)*u_OffsetScale.w)+1.0)/2.0)*2.0-1.0, 0.0, 1.0);\t\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}";var EffectPS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#ifdef COLOR\n\tvarying vec4 v_Color;\n#endif\nvarying vec2 v_Texcoord0;\n\n#ifdef MAINTEXTURE\n\tuniform sampler2D u_AlbedoTexture;\n#endif\n\nuniform vec4 u_AlbedoColor;\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\nvoid main()\n{\n\tvec4 color =  2.0 * u_AlbedoColor;\n\t#ifdef COLOR\n\t\tcolor *= v_Color;\n\t#endif\n\t#ifdef MAINTEXTURE\n\t\tcolor *= texture2D(u_AlbedoTexture, v_Texcoord0);\n\t#endif\n\t\n\tgl_FragColor = color;\n\t\n\t#ifdef FOG\n\t\tfloat lerpFact = clamp((1.0 / gl_FragCoord.w - u_FogStart) / u_FogRange, 0.0, 1.0);\n\t\t#ifdef ADDTIVEFOG\n\t\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.0), lerpFact);\n\t\t#else\n\t\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, u_FogColor, lerpFact);\n\t\t#endif\n\t#endif\n}\n\n";var EffectVS="#include \"Lighting.glsl\";\n\nattribute vec4 a_Position;\nattribute vec4 a_Color;\nattribute vec2 a_Texcoord0;\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_MvpMatrix;\n#else\n\tuniform mat4 u_MvpMatrix;\n#endif\n\n#ifdef COLOR\n\tvarying vec4 v_Color;\n#endif\nvarying vec2 v_Texcoord0;\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\nvoid main()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform;\n\t \t#ifdef SIMPLEBONE\n\t\t\tfloat currentPixelPos;\n\t\t\t#ifdef GPU_INSTANCE\n\t\t\t\tcurrentPixelPos = a_SimpleTextureParams.x+a_SimpleTextureParams.y;\n\t\t\t#else\n\t\t\t\tcurrentPixelPos = u_SimpleAnimatorParams.x+u_SimpleAnimatorParams.y;\n\t\t\t#endif\n\t\t\tfloat offset = 1.0/u_SimpleAnimatorTextureSize;\n\t\t\tskinTransform =  loadMatFromTexture(currentPixelPos,int(a_BoneIndices.x),offset) * a_BoneWeights.x;\n\t\t\tskinTransform += loadMatFromTexture(currentPixelPos,int(a_BoneIndices.y),offset) * a_BoneWeights.y;\n\t\t\tskinTransform += loadMatFromTexture(currentPixelPos,int(a_BoneIndices.z),offset) * a_BoneWeights.z;\n\t\t\tskinTransform += loadMatFromTexture(currentPixelPos,int(a_BoneIndices.w),offset) * a_BoneWeights.w;\n\t\t#else\n\t\t\tskinTransform =  u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\t#endif\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\t\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=TransformUV(a_Texcoord0,u_TilingOffset);\n\t#else\n\t\tv_Texcoord0=a_Texcoord0;\n\t#endif\n\t\t\n\t#ifdef COLOR\n\t\tv_Color = a_Color;\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n}";var extendTerrainPS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include \"Lighting.glsl\";\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)\n\tuniform vec3 u_CameraPos;\n\tvarying vec3 v_Normal;\n\tvarying vec3 v_PositionWorld;\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\tuniform vec3 u_FogColor;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#ifdef LEGACYSINGLELIGHTING\n\t\t#ifdef DIRECTIONLIGHT\n\t\t\tuniform DirectionLight u_DirectionLight;\n\t\t#endif\n\t\t#ifdef POINTLIGHT\n\t\t\tuniform PointLight u_PointLight;\n\t\t#endif\n\t\t#ifdef SPOTLIGHT\n\t\t\tuniform SpotLight u_SpotLight;\n\t\t#endif\n\t#else\n\t\tuniform mat4 u_View;\n\t\tuniform vec4 u_ProjectionParams;\n\t\tuniform vec4 u_Viewport;\n\t\tuniform int u_DirationLightCount;\n\t\tuniform sampler2D u_LightBuffer;\n\t\tuniform sampler2D u_LightClusterBuffer;\n\t#endif\n#endif\n\n#include \"Shadow.glsl\"\n#ifdef CALCULATE_SHADOWS\n\tvarying vec4 v_ShadowCoord;\n#endif\nvarying float v_posViewZ;\n\nuniform vec3 u_AmbientColor;\n\nuniform sampler2D u_SplatAlphaTexture;\n\nuniform sampler2D u_DiffuseTexture1;\nuniform sampler2D u_DiffuseTexture2;\nuniform sampler2D u_DiffuseTexture3;\nuniform sampler2D u_DiffuseTexture4;\nuniform sampler2D u_DiffuseTexture5;\n\nuniform vec4 u_DiffuseScaleOffset1;\nuniform vec4 u_DiffuseScaleOffset2;\nuniform vec4 u_DiffuseScaleOffset3;\nuniform vec4 u_DiffuseScaleOffset4;\nuniform vec4 u_DiffuseScaleOffset5;\n\nvarying vec2 v_Texcoord0;\n\n#ifdef LIGHTMAP\n\tuniform sampler2D u_LightMap;\n\tvarying vec2 v_LightMapUV;\n#endif\n\nvoid main()\n{\n\tvec4 splatAlpha = vec4(1.0);\n\t#ifdef ExtendTerrain_DETAIL_NUM1\n\t\tsplatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r;\n\t#endif\n\t#ifdef ExtendTerrain_DETAIL_NUM2\n\t\tsplatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScaleOffset2.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r + color2.xyz * (1.0 - splatAlpha.r);\n\t#endif\n\t#ifdef ExtendTerrain_DETAIL_NUM3\n\t\tsplatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScaleOffset2.xy);\n\t\tvec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord0 * u_DiffuseScaleOffset3.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r  + color2.xyz * splatAlpha.g + color3.xyz * (1.0 - splatAlpha.r - splatAlpha.g);\n\t#endif\n\t#ifdef ExtendTerrain_DETAIL_NUM4\n\t\tsplatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScaleOffset2.xy);\n\t\tvec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord0 * u_DiffuseScaleOffset3.xy);\n\t\tvec4 color4 = texture2D(u_DiffuseTexture4, v_Texcoord0 * u_DiffuseScaleOffset4.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r  + color2.xyz * splatAlpha.g + color3.xyz * splatAlpha.b + color4.xyz * (1.0 - splatAlpha.r - splatAlpha.g - splatAlpha.b);\n\t#endif\n\t#ifdef ExtendTerrain_DETAIL_NUM5\n\t\tsplatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScaleOffset2.xy);\n\t\tvec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord0 * u_DiffuseScaleOffset3.xy);\n\t\tvec4 color4 = texture2D(u_DiffuseTexture4, v_Texcoord0 * u_DiffuseScaleOffset4.xy);\n\t\tvec4 color5 = texture2D(u_DiffuseTexture5, v_Texcoord0 * u_DiffuseScaleOffset5.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r  + color2.xyz * splatAlpha.g + color3.xyz * splatAlpha.b + color4.xyz * splatAlpha.a + color5.xyz * (1.0 - splatAlpha.r - splatAlpha.g - splatAlpha.b - splatAlpha.a);\n\t#endif\n\t\tgl_FragColor.w = splatAlpha.a;\n\t\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tvec3 normal = v_Normal;\n\t\tvec3 dif, spe;\n\t#endif\n\n\tvec3 diffuse = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)\n\t\tvec3 toEye;\n\t\t#ifdef FOG\n\t\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\t\tfloat toEyeLength=length(toEye);\n\t\t\ttoEye/=toEyeLength;\n\t\t#else\n\t\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t\t#endif\n\t#endif\n\n\t#ifdef LEGACYSINGLELIGHTING\n\t\t#ifdef DIRECTIONLIGHT\n\t\t\tLayaAirBlinnPhongDiectionLight(vec3(0.0),1.0,normal,vec3(1.0),toEye,u_DirectionLight,dif,spe);\n\t\t\tdiffuse+=dif;\n\t\t\tspecular+=spe;\n\t\t#endif\n\t\n\t\t#ifdef POINTLIGHT\n\t\t\tLayaAirBlinnPhongPointLight(v_PositionWorld,vec3(0.0),1.0,normal,vec3(1.0),toEye,u_PointLight,dif,spe);\n\t\t\tdiffuse+=dif;\n\t\t\tspecular+=spe;\n\t\t#endif\n\n\t\t#ifdef SPOTLIGHT\n\t\t\tLayaAirBlinnPhongSpotLight(v_PositionWorld,vec3(0.0),1.0,normal,vec3(1.0),toEye,u_SpotLight,dif,spe);\n\t\t\tdiffuse+=dif;\n\t\t\tspecular+=spe;\n\t\t#endif\n\t#else\n\t\t#ifdef DIRECTIONLIGHT\n\t\t\tfor (int i = 0; i < MAX_LIGHT_COUNT; i++) \n\t\t\t{\n\t\t\t\tif(i >= u_DirationLightCount)\n\t\t\t\t\tbreak;\n\t\t\t\tDirectionLight directionLight = getDirectionLight(u_LightBuffer,i);\n\t\t\t\tLayaAirBlinnPhongDiectionLight(vec3(0.0),1.0,normal,vec3(1.0),toEye,directionLight,dif,spe);\n\t\t\t\tdiffuse+=dif;\n\t\t\t\tspecular+=spe;\n\t\t\t}\n\t\t#endif\n\t\t#if defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\t\tivec4 clusterInfo =getClusterInfo(u_LightClusterBuffer,u_View,u_Viewport, v_PositionWorld,gl_FragCoord,u_ProjectionParams);\n\t\t\t#ifdef POINTLIGHT\n\t\t\t\tfor (int i = 0; i < MAX_LIGHT_COUNT; i++) \n\t\t\t\t{\n\t\t\t\t\tif(i >= clusterInfo.x)//PointLightCount\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tPointLight pointLight = getPointLight(u_LightBuffer,u_LightClusterBuffer,clusterInfo,i);\n\t\t\t\t\tLayaAirBlinnPhongPointLight(v_PositionWorld,vec3(0.0),1.0,normal,vec3(1.0),toEye,pointLight,dif,spe);\n\t\t\t\t\tdiffuse+=dif;\n\t\t\t\t\tspecular+=spe;\n\t\t\t\t}\n\t\t\t#endif\n\t\t\t#ifdef SPOTLIGHT\n\t\t\t\tfor (int i = 0; i < MAX_LIGHT_COUNT; i++) \n\t\t\t\t{\n\t\t\t\t\tif(i >= clusterInfo.y)//SpotLightCount\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tSpotLight spotLight = getSpotLight(u_LightBuffer,u_LightClusterBuffer,clusterInfo,i);\n\t\t\t\t\tLayaAirBlinnPhongSpotLight(v_PositionWorld,vec3(0.0),1.0,normal,vec3(1.0),toEye\t,spotLight,dif,spe);\n\t\t\t\t\tdiffuse+=dif;\n\t\t\t\t\tspecular+=spe;\n\t\t\t\t}\n\t\t\t#endif\n\t\t#endif\n\t#endif\n\nvec3 globalDiffuse = u_AmbientColor;\n#ifdef LIGHTMAP\n\tglobalDiffuse += decodeHDR(texture2D(u_LightMap, v_LightMapUV),5.0);\n#endif\n\n#ifdef CALCULATE_SHADOWS\n\tfloat shadowValue = shadowValue = sampleShadowmap(v_ShadowCoord);\n\tgl_FragColor = vec4(gl_FragColor.rgb * (globalDiffuse + diffuse) * shadowValue, gl_FragColor.a);\n#else\n\tgl_FragColor = vec4(gl_FragColor.rgb * (globalDiffuse + diffuse), gl_FragColor.a);\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#ifdef CALCULATE_SHADOWS\n\t\tgl_FragColor.rgb += specular * shadowValue;\n\t#else\n\t\tgl_FragColor.rgb += specular;\n\t#endif\n#endif\n\n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\n\n\n\n\n";var extendTerrainVS="#include \"Lighting.glsl\";\n\nattribute vec4 a_Position;\nattribute vec2 a_Texcoord0;\n\nuniform mat4 u_MvpMatrix;\n\nvarying vec2 v_Texcoord0;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(LIGHTMAP)\n\tattribute vec3 a_Normal;\n\tvarying vec3 v_Normal;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||(defined(CALCULATE_SHADOWS)&&defined(SHADOWMAP_PSSM1))\n\tuniform mat4 u_WorldMat;\n\tvarying vec3 v_PositionWorld;\n#endif\n\n#ifdef LIGHTMAP\n\tvarying vec2 v_LightMapUV;\n\tuniform vec4 u_LightmapScaleOffset;\n#endif\n\n#ifdef CALCULATE_SHADOWS\n\tvarying vec4 v_ShadowCoord;\n#endif\n\nvoid main()\n{\n\tgl_Position = u_MvpMatrix * a_Position;\n  \n\tv_Texcoord0 = a_Texcoord0;\n  \n\t#ifdef LIGHTMAP\n\t\tv_LightMapUV = vec2(a_Texcoord0.x, 1.0 - a_Texcoord0.y) * u_LightmapScaleOffset.xy + u_LightmapScaleOffset.zw;\n\t\tv_LightMapUV.y = 1.0 - v_LightMapUV.y;\n\t#endif\n  \n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tv_Normal = a_Normal;\n\t#endif\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||(defined(CALCULATE_SHADOWS)&&defined(SHADOWMAP_PSSM1))\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n\n\t#ifdef CALCULATE_SHADOWS\n\t\tv_ShadowCoord = getShadowCoord(vec4(v_PositionWorld));\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n}";var GlobalIllumination="struct LayaGIInput\n{\n\tvec2 lightmapUV;\n};\n\n#define LAYA_SPECCUBE_LOD_STEPS 6.0\n\nuniform vec3 u_AmbientColor;\n\n#if defined(GI_AMBIENT_SH)\n\tuniform vec4 u_AmbientSHAr;\n\tuniform vec4 u_AmbientSHAg;\n\tuniform vec4 u_AmbientSHAb;\n\tuniform vec4 u_AmbientSHBr;\n\tuniform vec4 u_AmbientSHBg;\n\tuniform vec4 u_AmbientSHBb;\n\tuniform vec4 u_AmbientSHC;\n#endif\n\nuniform samplerCube u_ReflectTexture;\nuniform vec4 u_ReflectCubeHDRParams;\n\n\n#ifdef GI_AMBIENT_SH\n\tmediump vec3 shEvalLinearL0L1(mediump vec4 normal)\n\t{\n\t\tmediump vec3 x;\n\t\t// Linear (L1) + constant (L0) polynomial terms\n\t\tx.r = dot(u_AmbientSHAr, normal);\n\t\tx.g = dot(u_AmbientSHAg, normal);\n\t\tx.b = dot(u_AmbientSHAb, normal);\n\t\treturn x;\n\t}\n\n\tmediump vec3 shEvalLinearL2(mediump vec4 normal)\n\t{\n\t\tmediump vec3 x1,x2;\n\t\t// 4 of the quadratic (L2) polynomials\n\t\tmediump vec4 vB = normal.xyzz * normal.yzzx;\n\t\tx1.r = dot(u_AmbientSHBr, vB);\n\t\tx1.g = dot(u_AmbientSHBg, vB);\n\t\tx1.b = dot(u_AmbientSHBb, vB);\n\n\t\t// Final (5th) quadratic (L2) polynomial\n\t\tmediump float vC = normal.x*normal.x - normal.y*normal.y;\n\t\tx2 = u_AmbientSHC.rgb * vC;\n\n\t\treturn x1 + x2;\n\t}\n\t\n\tmediump vec3 shadeSHPerPixel(mediump vec3 normal)\n\t{\n\t\tmediump vec3 ambientContrib;\n\t\tmediump vec4 normalV4=vec4(-normal.x,normal.yz, 1.0);//Note:SH Data is left-hand,so x need inverse\n\t\tambientContrib = shEvalLinearL0L1(normalV4);\n\t\tambientContrib += shEvalLinearL2(normalV4);\n\t\tmediump vec3 ambient = max(vec3(0.0), ambientContrib);\n\t\tambient = layaLinearToGammaSpace(ambient);\n\t\treturn ambient;\n\t}\n#endif\n\nmediump vec3 layaDecodeDirectionalLightmap (mediump vec3 color, lowp vec4 dirTex, mediump vec3 normalWorld)\n{\n    // In directional (non-specular) mode Enlighten bakes dominant light direction\n    // in a way, that using it for half Lambert and then dividing by a \"rebalancing coefficient\"\n    // gives a result close to plain diffuse response lightmaps, but normalmapped.\n\n    // Note that dir is not unit length on purpose. Its length is \"directionality\", like\n    // for the directional specular lightmaps.\n\tlowp vec3 directional=dirTex.xyz - 0.5;\n\tdirectional.x=-directional.x;//NOTE:because coord System\n    mediump float halfLambert = dot(normalWorld,directional) + 0.5;\n\n    return color * halfLambert / max(1e-4, dirTex.w);\n}\n\nvec3 layaGIBase(LayaGIInput giInput,mediump float occlusion, mediump vec3 normalWorld)\n{\n\tvec3 indirectDiffuse;\n\t#ifdef LIGHTMAP\t\n\t\tmediump vec3 bakedColor =decodeHDR(texture2D(u_LightMap, giInput.lightmapUV),5.0);\n\t\t#ifdef LIGHTMAP_DIRECTIONAL\n\t\t\tlowp vec4 bakedDirTex = texture2D (u_LightMapDirection, giInput.lightmapUV);\n            indirectDiffuse = layaDecodeDirectionalLightmap (bakedColor, bakedDirTex, normalWorld);\n\t\t#else //unDirectional lightmap\n\t\t\tindirectDiffuse = bakedColor;\n\t\t#endif\n\t#else\n\t\t#ifdef GI_AMBIENT_SH\n\t\t\tindirectDiffuse = shadeSHPerPixel(normalWorld);\n\t\t#else\n\t\t\tindirectDiffuse = u_AmbientColor; //already in gamma space\n\t\t#endif\n\t#endif\n\n\tindirectDiffuse*=occlusion;\n\treturn indirectDiffuse;\n}\n\nmediump vec3 layaGlossyEnvironment(mediump vec4 glossIn)\n{\n\tmediump float perceptualRoughness = glossIn.a;\n\n\t// use approximation to solve,below is more reasonable,but maybe slow. \n\t// float m = perceptualRoughnessToRoughness(perceptualRoughness); // m is the real roughness parameter\n    // const float fEps = 1.192092896e-07F;        // smallest such that 1.0+FLT_EPSILON != 1.0  (+1e-4h is NOT good here. is visibly very wrong)\n    // float n =  (2.0/max(fEps, m*m))-2.0;        // remap to spec power. See eq. 21 in --> https://dl.dropboxusercontent.com/u/55891920/papers/mm_brdf.pdf\n    // n /= 4;                                     // remap from n_dot_h formulatino to n_dot_r. See section \"Pre-convolved Cube Maps vs Path Tracers\" --> https://s3.amazonaws.com/docs.knaldtech.com/knald/1.0.0/lys_power_drops.html\n    // perceptualRoughness = pow( 2/(n+2), 0.25);  // remap back to square root of real roughness (0.25 include both the sqrt root of the conversion and sqrt for going from roughness to perceptualRoughness)\n\tperceptualRoughness = perceptualRoughness * (1.7 - 0.7*perceptualRoughness);//just a approximation,but fast.\n \n\tmediump float mip = perceptualRoughness * LAYA_SPECCUBE_LOD_STEPS;\n\tmediump vec3 uvw = glossIn.rgb;\n\tuvw.x=-uvw.x;//Note:reflectCube is left-hand,so x need inverse\n\tmediump vec4 rgbm=textureCubeLodEXT(u_ReflectTexture,uvw,mip);\n\treturn decodeHDR(rgbm,u_ReflectCubeHDRParams.x);\n}\n\nmediump vec3 layaGIIndirectSpecular(LayaGIInput giInput,mediump float occlusion, vec4 glossIn)\n{\n\tmediump vec3 specular = layaGlossyEnvironment(glossIn);\n\treturn specular * occlusion;\n}\n\n\nLayaGI layaGlobalIllumination(LayaGIInput giInput,mediump float occlusion, mediump vec3 normalWorld,mediump vec4 uvwRoughness)\n{\n\tLayaGI gi;\n\tgi.diffuse = layaGIBase(giInput,occlusion, normalWorld);\n\tgi.specular = layaGIIndirectSpecular(giInput,occlusion, uvwRoughness);\n\treturn gi;\n}\n\n\n";var LightingGLSL="#ifdef GRAPHICS_API_GLES3\n\t#define INVERSE_MAT(mat) inverse(mat)\n#else\n\t#define INVERSE_MAT(mat) inverseMat(mat)\n#endif\n\nstruct DirectionLight {\n\tvec3 color;\n\tvec3 direction;\n};\n\nstruct PointLight {\n\tvec3 color;\n\tvec3 position;\n\tfloat range;\n};\n\nstruct SpotLight {\n\tvec3 color;\n\tvec3 position;\n\tfloat range;\n\tvec3 direction;\n\tfloat spot;\n};\n\nstruct LayaGI{\n\tvec3 diffuse;\n\tvec3 specular;\n};\n\nstruct LayaLight{\n\tvec3 color;\n\tvec3 dir;\n};\n\nconst int c_ClusterBufferWidth = CLUSTER_X_COUNT*CLUSTER_Y_COUNT;\nconst int c_ClusterBufferHeight = CLUSTER_Z_COUNT*(1+int(ceil(float(MAX_LIGHT_COUNT_PER_CLUSTER)/4.0)));\nconst int c_ClusterBufferFloatWidth = c_ClusterBufferWidth*4;\n\n#ifndef GRAPHICS_API_GLES3\n\tmat3 inverseMat(mat3 m) {\n\t\tfloat a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n\t\tfloat a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n\t\tfloat a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n\t\tfloat b01 = a22 * a11 - a12 * a21;\n\t\tfloat b11 = -a22 * a10 + a12 * a20;\n\t\tfloat b21 = a21 * a10 - a11 * a20;\n\n\t\tfloat det = a00 * b01 + a01 * b11 + a02 * b21;\n\n\t\treturn mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n\t\t\t\t\tb11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n\t\t\t\t\tb21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n\t}\n#endif\n\nivec4 getClusterInfo(sampler2D clusterBuffer,mat4 viewMatrix,vec4 viewport,vec3 position,vec4 fragCoord,vec4 projectParams)\n{\n\tvec3 viewPos = vec3(viewMatrix*vec4(position, 1.0)); //position in viewspace\n\n\tint clusterXIndex = int(floor(fragCoord.x/ (float(viewport.z)/float(CLUSTER_X_COUNT))));\n    int clusterYIndex = int(floor((viewport.w * (projectParams.z <0.0? 0.0 : 1.0) - fragCoord.y * projectParams.z)/ (float(viewport.w)/float(CLUSTER_Y_COUNT))));//Maybe Flipped ProjectMatrix\n\tfloat zSliceParam =float(CLUSTER_Z_COUNT)/log2(projectParams.y / projectParams.x);\n \tint clusterZIndex = int(floor(log2(-viewPos.z) * zSliceParam- log2(projectParams.x) * zSliceParam));//projectParams x:cameraNear y:cameraFar\n\n\tvec2 uv= vec2((float(clusterXIndex + clusterYIndex * CLUSTER_X_COUNT)+0.5)/float(c_ClusterBufferWidth),\n\t\t\t\t(float(clusterZIndex)+0.5)/float(c_ClusterBufferHeight));\n\tvec4 clusterPixel=texture2D(clusterBuffer, uv);\n\treturn ivec4(clusterPixel);//X:Point Count Y:Spot Count Z、W:Light Offset\n}\n\n\nint getLightIndex(sampler2D clusterBuffer,int offset,int index) \n{\n\tint totalOffset=offset+index;\n\tint row=totalOffset/c_ClusterBufferFloatWidth;\n\tint lastRowFloat=totalOffset-row*c_ClusterBufferFloatWidth;\n\tint col=lastRowFloat/4;\n\tvec2 uv=vec2((float(col)+0.5)/float(c_ClusterBufferWidth),\n\t\t\t\t(float(row)+0.5)/float(c_ClusterBufferHeight));\n\tvec4 texel = texture2D(clusterBuffer, uv);\n    int pixelComponent = lastRowFloat-col*4;\n    if (pixelComponent == 0) \n      return int(texel.x);\n    else if (pixelComponent == 1) \n      return int(texel.y);\n    else if (pixelComponent == 2) \n      return int(texel.z);\n    else //pixelComponent==3\n      return int(texel.w);\n}\n\nDirectionLight getDirectionLight(sampler2D lightBuffer,int index) \n{\n    DirectionLight light;\n    float v = (float(index)+0.5)/ float(MAX_LIGHT_COUNT);\n    vec4 p1 = texture2D(lightBuffer, vec2(0.125,v));\n    vec4 p2 = texture2D(lightBuffer, vec2(0.375,v));\n\tlight.color=p1.rgb;\n    light.direction = p2.rgb;\n    return light;\n}\n\nPointLight getPointLight(sampler2D lightBuffer,sampler2D clusterBuffer,ivec4 clusterInfo,int index) \n{\n    PointLight light;\n\tint pointIndex=getLightIndex(clusterBuffer,clusterInfo.z*c_ClusterBufferFloatWidth+clusterInfo.w,index);\n    float v = (float(pointIndex)+0.5)/ float(MAX_LIGHT_COUNT);\n    vec4 p1 = texture2D(lightBuffer, vec2(0.125,v));\n    vec4 p2 = texture2D(lightBuffer, vec2(0.375,v));\n\tlight.color=p1.rgb;\n\tlight.range = p1.a;\n    light.position = p2.rgb;\n    return light;\n}\n\nSpotLight getSpotLight(sampler2D lightBuffer,sampler2D clusterBuffer,ivec4 clusterInfo,int index) \n{\n    SpotLight light;\n\tint spoIndex=getLightIndex(clusterBuffer,clusterInfo.z*c_ClusterBufferFloatWidth+clusterInfo.w,clusterInfo.x+index);\n    float v = (float(spoIndex)+0.5)/ float(MAX_LIGHT_COUNT);\n    vec4 p1 = texture2D(lightBuffer, vec2(0.125,v));\n    vec4 p2 = texture2D(lightBuffer, vec2(0.375,v));\n\tvec4 p3 = texture2D(lightBuffer, vec2(0.625,v));\n    light.color = p1.rgb;\n\tlight.range=p1.a;\n    light.position = p2.rgb;\n\tlight.spot = p2.a;\n\tlight.direction = p3.rgb;\n    return light;\n}\n\n// Laya中使用衰减纹理\nfloat LayaAttenuation(in vec3 L,in float invLightRadius) {\n\tfloat fRatio = clamp(length(L) * invLightRadius,0.0,1.0);\n\tfRatio *= fRatio;\n\treturn 1.0 / (1.0 + 25.0 * fRatio)* clamp(4.0*(1.0 - fRatio),0.0,1.0); //fade to black as if 4 pixel texture\n}\n\n// Same as Just Cause 2 and Crysis 2 (you can read GPU Pro 1 book for more information)\nfloat BasicAttenuation(in vec3 L,in float invLightRadius) {\n\tvec3 distance = L * invLightRadius;\n\tfloat attenuation = clamp(1.0 - dot(distance, distance),0.0,1.0); // Equals float attenuation = saturate(1.0f - dot(L, L) / (lightRadius *  lightRadius));\n\treturn attenuation * attenuation;\n}\n\n// Inspired on http://fools.slindev.com/viewtopic.php?f=11&t=21&view=unread#unread\nfloat NaturalAttenuation(in vec3 L,in float invLightRadius) {\n\tfloat attenuationFactor = 30.0;\n\tvec3 distance = L * invLightRadius;\n\tfloat attenuation = dot(distance, distance); // Equals float attenuation = dot(L, L) / (lightRadius *  lightRadius);\n\tattenuation = 1.0 / (attenuation * attenuationFactor + 1.0);\n\t// Second we move down the function therewith it reaches zero at abscissa 1:\n\tattenuationFactor = 1.0 / (attenuationFactor + 1.0); //attenuationFactor contains now the value we have to subtract\n\tattenuation = max(attenuation - attenuationFactor, 0.0); // The max fixes a bug.\n\t// Finally we expand the equation along the y-axis so that it starts with a function value of 1 again.\n\tattenuation /= 1.0 - attenuationFactor;\n\treturn attenuation;\n}\n\nvoid LayaAirBlinnPhongLight (in vec3 specColor,in float specColorIntensity,in vec3 normal,in vec3 gloss, in vec3 viewDir,in vec3 lightColor, in vec3 lightVec,out vec3 diffuseColor,out vec3 specularColor) {\n\tmediump vec3 h = normalize(viewDir-lightVec);\n\tlowp float ln = max (0.0, dot (-lightVec,normal));\n\tfloat nh = max (0.0, dot (h,normal));\n\tdiffuseColor=lightColor * ln;\n\tspecularColor=lightColor *specColor*pow (nh, specColorIntensity*128.0) * gloss;\n}\n\nvoid LayaAirBlinnPhongDiectionLight (in vec3 specColor,in float specColorIntensity,in vec3 normal,in vec3 gloss, in vec3 viewDir, in DirectionLight light,out vec3 diffuseColor,out vec3 specularColor) {\n\tvec3 lightVec=normalize(light.direction);\n\tLayaAirBlinnPhongLight(specColor,specColorIntensity,normal,gloss,viewDir,light.color,lightVec,diffuseColor,specularColor);\n}\n\nvoid LayaAirBlinnPhongPointLight (in vec3 pos,in vec3 specColor,in float specColorIntensity,in vec3 normal,in vec3 gloss, in vec3 viewDir, in PointLight light,out vec3 diffuseColor,out vec3 specularColor) {\n\tvec3 lightVec =  pos-light.position;\n\tLayaAirBlinnPhongLight(specColor,specColorIntensity,normal,gloss,viewDir,light.color,lightVec/length(lightVec),diffuseColor,specularColor);\n\tfloat attenuate = LayaAttenuation(lightVec, 1.0/light.range);\n\tdiffuseColor *= attenuate;\n\tspecularColor*= attenuate;\n}\n\nvoid LayaAirBlinnPhongSpotLight (in vec3 pos,in vec3 specColor,in float specColorIntensity,in vec3 normal,in vec3 gloss, in vec3 viewDir, in SpotLight light,out vec3 diffuseColor,out vec3 specularColor) {\n\tvec3 lightVec =  pos-light.position;\n\tvec3 normalLightVec=lightVec/length(lightVec);\n\tLayaAirBlinnPhongLight(specColor,specColorIntensity,normal,gloss,viewDir,light.color,normalLightVec,diffuseColor,specularColor);\n\tvec2 cosAngles=cos(vec2(light.spot,light.spot*0.5)*0.5);//ConeAttenuation\n\tfloat dl=dot(normalize(light.direction),normalLightVec);\n\tdl*=smoothstep(cosAngles[0],cosAngles[1],dl);\n\tfloat attenuate = LayaAttenuation(lightVec, 1.0/light.range)*dl;\n\tdiffuseColor *=attenuate;\n\tspecularColor *=attenuate;\n}\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent,vec3 binormal) {\n\tvec3 normalT =vec3(2.0*normalMapSample.x - 1.0,1.0-2.0*normalMapSample.y,2.0*normalMapSample.z - 1.0);\n\tmediump vec3 N = unitNormal;\n\tmediump vec3 T = tangent;\n\tmediump vec3 B = binormal;\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal =normalize(TBN*normalT);\n\treturn bumpedNormal;\n}\n\nvec3 NormalSampleToWorldSpace1(vec4 normalMapSample, vec3 tangent, vec3 binormal, vec3 unitNormal) {\n\tvec3 normalT;\n\tnormalT.x = 2.0 * normalMapSample.x - 1.0;\n\tnormalT.y = 1.0 - 2.0 * normalMapSample.y;\n\tnormalT.z = sqrt(1.0 - clamp(dot(normalT.xy, normalT.xy), 0.0, 1.0));\n\n\tvec3 T = normalize(tangent);\n\tvec3 B = normalize(binormal);\n\tvec3 N = normalize(unitNormal);\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN * normalize(normalT);\n\n\treturn bumpedNormal;\n}\n\nvec3 DecodeLightmap(vec4 color) {\n\treturn color.rgb*color.a*5.0;\n}\n\nvec3 decodeHDR(vec4 color,float range) {\n\treturn color.rgb*color.a*range;\n}\n\nvec2 TransformUV(vec2 texcoord,vec4 tilingOffset) {\n\tvec2 transTexcoord=vec2(texcoord.x,texcoord.y-1.0)*tilingOffset.xy+vec2(tilingOffset.z,-tilingOffset.w);\n\ttransTexcoord.y+=1.0;\n\treturn transTexcoord;\n}\n\nvec4 remapGLPositionZ(vec4 position) {\n\tposition.z=position.z * 2.0 - position.w;\n\treturn position;\n}\n\nmediump vec3 layaLinearToGammaSpace (mediump vec3 linRGB)\n{\n    linRGB = max(linRGB, vec3(0.0));\n    // An almost-perfect approximation from http://chilliant.blogspot.com.au/2012/08/srgb-approximations-for-hlsl.html?m=1\n    return max(1.055 * pow(linRGB,vec3(0.416666667)) - 0.055, 0.0);   \n}\n\nLayaLight layaDirectionLightToLight(in DirectionLight light,in float attenuate)\n{\n\tLayaLight relight;\n\trelight.color = light.color*attenuate;\n\trelight.dir = light.direction;\n\treturn relight;\n}\n\nLayaLight layaPointLightToLight(in vec3 pos,in vec3 normal, in PointLight light,in float attenuate)\n{\n\tLayaLight relight;\n\tvec3 lightVec =  pos-light.position;\n\tattenuate *= LayaAttenuation(lightVec, 1.0/light.range);\n\trelight.color = light.color*attenuate;\n\trelight.dir = normalize(lightVec);\n\treturn relight;\n}\n\nLayaLight layaSpotLightToLight(in vec3 pos,in vec3 normal, in SpotLight light,in float attenuate)\n{\n\tLayaLight relight;\n\tvec3 lightVec =  pos-light.position;\n\tvec3 normalLightVec=lightVec/length(lightVec);\n\tvec2 cosAngles=cos(vec2(light.spot,light.spot*0.5)*0.5);//ConeAttenuation\n\tfloat dl=dot(normalize(light.direction),normalLightVec);\n\tdl*=smoothstep(cosAngles[0],cosAngles[1],dl);\n\tattenuate *= LayaAttenuation(lightVec, 1.0/light.range)*dl;\n\trelight.dir = lightVec;\n\trelight.color = light.color*attenuate;\n\treturn relight;\n}\n\n\n\n\n";var ShadowSampleTentGLSL="// ------------------------------------------------------------------\n//  PCF Filtering Tent Functions\n// ------------------------------------------------------------------\n\n// Assuming a isoceles right angled triangle of height \"triangleHeight\" (as drawn below).\n// This function return the area of the triangle above the first texel(in Y the first texel).\n//\n// |\\      <-- 45 degree slop isosceles right angled triangle\n// | \\\n// ----    <-- length of this side is \"triangleHeight\"\n// _ _ _ _ <-- texels\nfloat sampleShadowGetIRTriangleTexelArea(float triangleHeight)\n{\n    return triangleHeight - 0.5;\n}\n\n// Assuming a isoceles triangle of 1.5 texels height and 3 texels wide lying on 4 texels.\n// This function return the area of the triangle above each of those texels.\n//    |    <-- offset from -0.5 to 0.5, 0 meaning triangle is exactly in the center\n//   / \\   <-- 45 degree slop isosceles triangle (ie tent projected in 2D)\n//  /   \\\n// _ _ _ _ <-- texels\n// X Y Z W <-- result indices (in computedArea.xyzw and computedAreaUncut.xyzw)\n// Top point at (right,top) in a texel,left bottom point at (middle,middle) in a texel,right bottom point at (middle,middle) in a texel.\nvoid sampleShadowGetTexelAreasTent3x3(float offset, out vec4 computedArea, out vec4 computedAreaUncut)\n{\n    // Compute the exterior areas,a and h is same.\n    float a = offset + 0.5;\n    float offsetSquaredHalved = a * a * 0.5;\n    computedAreaUncut.x = computedArea.x = offsetSquaredHalved - offset;\n    computedAreaUncut.w = computedArea.w = offsetSquaredHalved;\n\n    // Compute the middle areas\n    // For Y : We find the area in Y of as if the left section of the isoceles triangle would\n    // intersect the axis between Y and Z (ie where offset = 0).\n    computedAreaUncut.y = sampleShadowGetIRTriangleTexelArea(1.5 - offset);\n    // This area is superior to the one we are looking for if (offset < 0) thus we need to\n    // subtract the area of the triangle defined by (0,1.5-offset), (0,1.5+offset), (-offset,1.5).\n    float clampedOffsetLeft = min(offset,0.0);\n    float areaOfSmallLeftTriangle = clampedOffsetLeft * clampedOffsetLeft;\n    computedArea.y = computedAreaUncut.y - areaOfSmallLeftTriangle;\n\n    // We do the same for the Z but with the right part of the isoceles triangle\n    computedAreaUncut.z = sampleShadowGetIRTriangleTexelArea(1.5 + offset);\n    float clampedOffsetRight = max(offset,0.0);\n    float areaOfSmallRightTriangle = clampedOffsetRight * clampedOffsetRight;\n    computedArea.z = computedAreaUncut.z - areaOfSmallRightTriangle;\n}\n\n// Assuming a isoceles triangle of 2.5 texel height and 5 texels wide lying on 6 texels.\n// This function return the weight of each texels area relative to the full triangle area.\n//  /       \\\n// _ _ _ _ _ _ <-- texels\n// 0 1 2 3 4 5 <-- computed area indices (in texelsWeights[])\n// Top point at (right,top) in a texel,left bottom point at (middle,middle) in a texel,right bottom point at (middle,middle) in a texel.\nvoid sampleShadowGetTexelWeightsTent5x5(float offset, out vec3 texelsWeightsA, out vec3 texelsWeightsB)\n{\n    vec4 areaFrom3texelTriangle;\n    vec4 areaUncutFrom3texelTriangle;\n    sampleShadowGetTexelAreasTent3x3(offset, areaFrom3texelTriangle, areaUncutFrom3texelTriangle);\n\n    // Triangle slope is 45 degree thus we can almost reuse the result of the 3 texel wide computation.\n    // the 5 texel wide triangle can be seen as the 3 texel wide one but shifted up by one unit/texel.\n    // 0.16 is 1/(the triangle area)\n    texelsWeightsA.x = 0.16 * (areaFrom3texelTriangle.x);\n    texelsWeightsA.y = 0.16 * (areaUncutFrom3texelTriangle.y);\n    texelsWeightsA.z = 0.16 * (areaFrom3texelTriangle.y + 1.0);\n    texelsWeightsB.x = 0.16 * (areaFrom3texelTriangle.z + 1.0);\n    texelsWeightsB.y = 0.16 * (areaUncutFrom3texelTriangle.z);\n    texelsWeightsB.z = 0.16 * (areaFrom3texelTriangle.w);\n}\n\n// 5x5 Tent filter (45 degree sloped triangles in U and V)\nvoid sampleShadowComputeSamplesTent5x5(vec4 shadowMapTextureTexelSize, vec2 coord, out float fetchesWeights[9], out vec2 fetchesUV[9])\n{\n    // tent base is 5x5 base thus covering from 25 to 36 texels, thus we need 9 bilinear PCF fetches\n    vec2 tentCenterInTexelSpace = coord.xy * shadowMapTextureTexelSize.zw;\n    vec2 centerOfFetchesInTexelSpace = floor(tentCenterInTexelSpace + 0.5);\n    vec2 offsetFromTentCenterToCenterOfFetches = tentCenterInTexelSpace - centerOfFetchesInTexelSpace;\n\n    // find the weight of each texel based on the area of a 45 degree slop tent above each of them.\n    vec3 texelsWeightsUA, texelsWeightsUB;\n    vec3 texelsWeightsVA, texelsWeightsVB;\n    sampleShadowGetTexelWeightsTent5x5(offsetFromTentCenterToCenterOfFetches.x, texelsWeightsUA, texelsWeightsUB);\n    sampleShadowGetTexelWeightsTent5x5(offsetFromTentCenterToCenterOfFetches.y, texelsWeightsVA, texelsWeightsVB);\n\n    // each fetch will cover a group of 2x2 texels, the weight of each group is the sum of the weights of the texels\n    vec3 fetchesWeightsU = vec3(texelsWeightsUA.xz, texelsWeightsUB.y) + vec3(texelsWeightsUA.y, texelsWeightsUB.xz);\n    vec3 fetchesWeightsV = vec3(texelsWeightsVA.xz, texelsWeightsVB.y) + vec3(texelsWeightsVA.y, texelsWeightsVB.xz);\n\n    // move the PCF bilinear fetches to respect texels weights\n    vec3 fetchesOffsetsU = vec3(texelsWeightsUA.y, texelsWeightsUB.xz) / fetchesWeightsU.xyz + vec3(-2.5,-0.5,1.5);\n    vec3 fetchesOffsetsV = vec3(texelsWeightsVA.y, texelsWeightsVB.xz) / fetchesWeightsV.xyz + vec3(-2.5,-0.5,1.5);\n    fetchesOffsetsU *= shadowMapTextureTexelSize.xxx;\n    fetchesOffsetsV *= shadowMapTextureTexelSize.yyy;\n\n    vec2 bilinearFetchOrigin = centerOfFetchesInTexelSpace * shadowMapTextureTexelSize.xy;\n    fetchesUV[0] = bilinearFetchOrigin + vec2(fetchesOffsetsU.x, fetchesOffsetsV.x);\n    fetchesUV[1] = bilinearFetchOrigin + vec2(fetchesOffsetsU.y, fetchesOffsetsV.x);\n    fetchesUV[2] = bilinearFetchOrigin + vec2(fetchesOffsetsU.z, fetchesOffsetsV.x);\n    fetchesUV[3] = bilinearFetchOrigin + vec2(fetchesOffsetsU.x, fetchesOffsetsV.y);\n    fetchesUV[4] = bilinearFetchOrigin + vec2(fetchesOffsetsU.y, fetchesOffsetsV.y);\n    fetchesUV[5] = bilinearFetchOrigin + vec2(fetchesOffsetsU.z, fetchesOffsetsV.y);\n    fetchesUV[6] = bilinearFetchOrigin + vec2(fetchesOffsetsU.x, fetchesOffsetsV.z);\n    fetchesUV[7] = bilinearFetchOrigin + vec2(fetchesOffsetsU.y, fetchesOffsetsV.z);\n    fetchesUV[8] = bilinearFetchOrigin + vec2(fetchesOffsetsU.z, fetchesOffsetsV.z);\n\n    fetchesWeights[0] = fetchesWeightsU.x * fetchesWeightsV.x;\n    fetchesWeights[1] = fetchesWeightsU.y * fetchesWeightsV.x;\n    fetchesWeights[2] = fetchesWeightsU.z * fetchesWeightsV.x;\n    fetchesWeights[3] = fetchesWeightsU.x * fetchesWeightsV.y;\n    fetchesWeights[4] = fetchesWeightsU.y * fetchesWeightsV.y;\n    fetchesWeights[5] = fetchesWeightsU.z * fetchesWeightsV.y;\n    fetchesWeights[6] = fetchesWeightsU.x * fetchesWeightsV.z;\n    fetchesWeights[7] = fetchesWeightsU.y * fetchesWeightsV.z;\n    fetchesWeights[8] = fetchesWeightsU.z * fetchesWeightsV.z;\n}";var linePS="#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nvarying vec4 v_Color;\nuniform vec4 u_Color;\n\nvoid main()\n{\n  gl_FragColor = v_Color * u_Color; \n}\n\n";var lineVS="#include \"Lighting.glsl\";\n\nattribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\nuniform vec4 u_Color;\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n\n\nvoid main()\n{\n\tgl_Position = u_MvpMatrix * a_Position;\n\tv_Color=a_Color*u_Color;\n\tgl_Position=remapGLPositionZ(gl_Position);\n}";var MeshBlinnPhongPS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n\tprecision highp int;\n#else\n\tprecision mediump float;\n\tprecision mediump int;\n#endif\n\n#include \"Lighting.glsl\";\n#include \"Shadow.glsl\"\n\nuniform vec4 u_DiffuseColor;\n\n#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\tvarying vec4 v_Color;\n#endif\n\n#ifdef ALPHATEST\n\tuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\n\tuniform sampler2D u_DiffuseTexture;\n#endif\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(SPECULARMAP)||defined(NORMALMAP)))\n\tvarying vec2 v_Texcoord0;\n#endif\n\n#ifdef LIGHTMAP\n\tvarying vec2 v_LightMapUV;\n\tuniform sampler2D u_LightMap;\n#endif\n\nvarying vec3 v_Normal;\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvarying vec3 v_ViewDir; \n\n\tuniform vec3 u_MaterialSpecular;\n\tuniform float u_Shininess;\n\n\t#ifdef LEGACYSINGLELIGHTING\n\t\t#ifdef DIRECTIONLIGHT\n\t\t\tuniform DirectionLight u_DirectionLight;\n\t\t#endif\n\t\t#ifdef POINTLIGHT\n\t\t\tuniform PointLight u_PointLight;\n\t\t#endif\n\t\t#ifdef SPOTLIGHT\n\t\t\tuniform SpotLight u_SpotLight;\n\t\t#endif\n\t#else\n\t\tuniform mat4 u_View;\n\t\tuniform vec4 u_ProjectionParams;\n\t\tuniform vec4 u_Viewport;\n\t\tuniform int u_DirationLightCount;\n\t\tuniform sampler2D u_LightBuffer;\n\t\tuniform sampler2D u_LightClusterBuffer;\n\t#endif\n\n\t#ifdef SPECULARMAP \n\t\tuniform sampler2D u_SpecularTexture;\n\t#endif\n#endif\n\n#ifdef NORMALMAP \n\tuniform sampler2D u_NormalTexture;\n\tvarying vec3 v_Tangent;\n\tvarying vec3 v_Binormal;\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\tuniform vec3 u_FogColor;\n#endif\n\n#if defined(POINTLIGHT)||defined(SPOTLIGHT)||(defined(CALCULATE_SHADOWS)&&defined(SHADOW_CASCADE))||defined(CALCULATE_SPOTSHADOWS)\n\tvarying vec3 v_PositionWorld;\n#endif\n\n\n#include \"GlobalIllumination.glsl\";//\"GlobalIllumination.glsl use uniform should at front of this\n\n#if defined(CALCULATE_SHADOWS)&&!defined(SHADOW_CASCADE)\n\tvarying vec4 v_ShadowCoord;\n#endif\n\n#ifdef CALCULATE_SPOTSHADOWS\n\tvarying vec4 v_SpotShadowCoord;\n#endif\n\n\nvoid main()\n{\n\tvec3 normal;//light and SH maybe use normal\n\t#if defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent,v_Binormal));\n\t#else\n\t\tnormal = normalize(v_Normal);\n\t#endif\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tvec3 viewDir= normalize(v_ViewDir);\n\t#endif\n\n\tLayaGIInput giInput;\n\t#ifdef LIGHTMAP\t\n\t\tgiInput.lightmapUV=v_LightMapUV;\n\t#endif\n\tvec3 globalDiffuse=layaGIBase(giInput,1.0,normal);\n\t\n\tvec4 mainColor=u_DiffuseColor;\n\t#ifdef DIFFUSEMAP\n\t\tvec4 difTexColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\t\tmainColor=mainColor*difTexColor;\n\t#endif \n\t#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\t\tmainColor=mainColor*v_Color;\n\t#endif \n    \n\t#ifdef ALPHATEST\n\t\tif(mainColor.a<u_AlphaTestValue)\n\t\t\tdiscard;\n\t#endif\n  \n\t\n\tvec3 diffuse = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tvec3 dif,spe;\n\t\t#ifdef SPECULARMAP\n\t\t\tvec3 gloss=texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n\t\t#else\n\t\t\t#ifdef DIFFUSEMAP\n\t\t\t\tvec3 gloss=vec3(difTexColor.a);\n\t\t\t#else\n\t\t\t\tvec3 gloss=vec3(1.0);\n\t\t\t#endif\n\t\t#endif\n\t#endif\n\n\t\n\t\n\t#ifdef LEGACYSINGLELIGHTING\n\t\t#ifdef DIRECTIONLIGHT\n\t\t\tLayaAirBlinnPhongDiectionLight(u_MaterialSpecular,u_Shininess,normal,gloss,viewDir,u_DirectionLight,dif,spe);\n\t\t\t#ifdef CALCULATE_SHADOWS\n\t\t\t\t#ifdef SHADOW_CASCADE\n\t\t\t\t\tvec4 shadowCoord = getShadowCoord(vec4(v_PositionWorld,1.0));\n\t\t\t\t#else\n\t\t\t\t\tvec4 shadowCoord = v_ShadowCoord;\n\t\t\t\t#endif\n\t\t\t\tfloat shadowAttenuation=sampleShadowmap(shadowCoord);\n\t\t\t\tdif *= shadowAttenuation;\n\t\t\t\tspe *= shadowAttenuation;\n\t\t\t#endif\n\t\t\tdiffuse+=dif;\n\t\t\tspecular+=spe;\n\t\t#endif\n\t\n\t\t#ifdef POINTLIGHT\n\t\t\tLayaAirBlinnPhongPointLight(v_PositionWorld,u_MaterialSpecular,u_Shininess,normal,gloss,viewDir,u_PointLight,dif,spe);\n\t\t\tdiffuse+=dif;\n\t\t\tspecular+=spe;\n\t\t#endif\n\n\t\t#ifdef SPOTLIGHT\n\t\t\tLayaAirBlinnPhongSpotLight(v_PositionWorld,u_MaterialSpecular,u_Shininess,normal,gloss,viewDir,u_SpotLight,dif,spe);\n\t\t\t#ifdef CALCULATE_SPOTSHADOWS\n\t\t\t\tvec4 spotShadowcoord = v_SpotShadowCoord;\n\t\t\t\tfloat spotShadowAttenuation = sampleSpotShadowmap(spotShadowcoord);\n\t\t\t\tdif *= shadowAttenuation;\n\t\t\t\tspe *= shadowAttenuation;\n\t\t\t#endif\n\t\t\tdiffuse+=dif;\n\t\t\tspecular+=spe;\n\t\t#endif\n\t#else\n\t\t#ifdef DIRECTIONLIGHT\n\t\t\tfor (int i = 0; i < MAX_LIGHT_COUNT; i++) \n\t\t\t{\n\t\t\t\tif(i >= u_DirationLightCount)\n\t\t\t\t\tbreak;\n\t\t\t\tDirectionLight directionLight = getDirectionLight(u_LightBuffer,i);\n\t\t\t\t#ifdef CALCULATE_SHADOWS\n\t\t\t\t\tif(i == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t#ifdef SHADOW_CASCADE\n\t\t\t\t\t\t\tvec4 shadowCoord = getShadowCoord(vec4(v_PositionWorld,1.0));\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tvec4 shadowCoord = v_ShadowCoord;\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\tdirectionLight.color *= sampleShadowmap(shadowCoord);\n\t\t\t\t\t}\n\t\t\t\t#endif\n\t\t\t\tLayaAirBlinnPhongDiectionLight(u_MaterialSpecular,u_Shininess,normal,gloss,viewDir,directionLight,dif,spe);\n\t\t\t\tdiffuse+=dif;\n\t\t\t\tspecular+=spe;\n\t\t\t}\n\t\t#endif\n\t\t#if defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\t\tivec4 clusterInfo =getClusterInfo(u_LightClusterBuffer,u_View,u_Viewport, v_PositionWorld,gl_FragCoord,u_ProjectionParams);\n\t\t\t#ifdef POINTLIGHT\n\t\t\t\tfor (int i = 0; i < MAX_LIGHT_COUNT; i++) \n\t\t\t\t{\n\t\t\t\t\tif(i >= clusterInfo.x)//PointLightCount\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tPointLight pointLight = getPointLight(u_LightBuffer,u_LightClusterBuffer,clusterInfo,i);\n\t\t\t\t\tLayaAirBlinnPhongPointLight(v_PositionWorld,u_MaterialSpecular,u_Shininess,normal,gloss,viewDir,pointLight,dif,spe);\n\t\t\t\t\tdiffuse+=dif;\n\t\t\t\t\tspecular+=spe;\n\t\t\t\t}\n\t\t\t#endif\n\t\t\t#ifdef SPOTLIGHT\n\t\t\t\tfor (int i = 0; i < MAX_LIGHT_COUNT; i++) \n\t\t\t\t{\n\t\t\t\t\tif(i >= clusterInfo.y)//SpotLightCount\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tSpotLight spotLight = getSpotLight(u_LightBuffer,u_LightClusterBuffer,clusterInfo,i);\n\t\t\t\t\t#ifdef CALCULATE_SPOTSHADOWS\n\t\t\t\t\t\tif(i == 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvec4 spotShadowcoord = v_SpotShadowCoord;\n\t\t\t\t\t\t\tspotLight.color *= sampleSpotShadowmap(spotShadowcoord);\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\t\t\t\t\tLayaAirBlinnPhongSpotLight(v_PositionWorld,u_MaterialSpecular,u_Shininess,normal,gloss,viewDir,spotLight,dif,spe);\n\t\t\t\t\tdiffuse+=dif;\n\t\t\t\t\tspecular+=spe;\n\t\t\t\t}\n\t\t\t#endif\n\t\t#endif\n\t#endif\n\n\tgl_FragColor =vec4(mainColor.rgb*(globalDiffuse + diffuse),mainColor.a);\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb+=specular;\n\t#endif\n\t  \n\t#ifdef FOG\n\t\tfloat lerpFact=clamp((1.0/gl_FragCoord.w-u_FogStart)/u_FogRange,0.0,1.0);\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n}\n\n";var MeshBlinnPhongVS="#include \"Lighting.glsl\";\n#include \"Shadow.glsl\";\n\nattribute vec4 a_Position;\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_MvpMatrix;\n#else\n\tuniform mat4 u_MvpMatrix;\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\n\tattribute vec2 a_Texcoord0;\n\tvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(LIGHTMAP)&&defined(UV1)\n\tattribute vec2 a_Texcoord1;\n#endif\n\n#ifdef LIGHTMAP\n\tuniform vec4 u_LightmapScaleOffset;\n\tvarying vec2 v_LightMapUV;\n#endif\n\n#ifdef COLOR\n\tattribute vec4 a_Color;\n\tvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\nattribute vec3 a_Normal;\nvarying vec3 v_Normal; \n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tuniform vec3 u_CameraPos;\n\tvarying vec3 v_ViewDir; \n#endif\n\n#if defined(NORMALMAP)\n\tattribute vec4 a_Tangent0;\n\tvarying vec3 v_Tangent;\n\tvarying vec3 v_Binormal;\n#endif\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_WorldMat;\n#else\n\tuniform mat4 u_WorldMat;\n#endif\n\n#if defined(POINTLIGHT)||defined(SPOTLIGHT)||(defined(CALCULATE_SHADOWS)&&defined(SHADOW_CASCADE))||defined(CALCULATE_SPOTSHADOWS)\n\tvarying vec3 v_PositionWorld;\n#endif\n\n#if defined(CALCULATE_SHADOWS)&&!defined(SHADOW_CASCADE)\n\tvarying vec4 v_ShadowCoord;\n#endif\n\n#ifdef CALCULATE_SPOTSHADOWS\n\tvarying vec4 v_SpotShadowCoord;\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\n#ifdef SIMPLEBONE\n\t#ifdef GPU_INSTANCE\n\t\tattribute vec4 a_SimpleTextureParams;\n\t#else\n\t\tuniform vec4 u_SimpleAnimatorParams;\n\t#endif\n\tuniform sampler2D u_SimpleAnimatorTexture;\n\n\tuniform float u_SimpleAnimatorTextureSize; \n#endif\n\n\n#ifdef SIMPLEBONE\nmat4 loadMatFromTexture(float FramePos,int boneIndices,float offset)\n{\n\tvec2 uv;\n\tfloat PixelPos = FramePos+float(boneIndices)*4.0;\n\tfloat halfOffset = offset * 0.5;\n\tfloat uvoffset = PixelPos/u_SimpleAnimatorTextureSize;\n\tuv.y = floor(uvoffset)*offset+halfOffset;\n\tuv.x = mod(float(PixelPos),u_SimpleAnimatorTextureSize)*offset+halfOffset;\n\tvec4 mat0row = texture2D(u_SimpleAnimatorTexture,uv);\n\tuv.x+=offset;\n\tvec4 mat1row = texture2D(u_SimpleAnimatorTexture,uv);\n\tuv.x+=offset;\n\tvec4 mat2row = texture2D(u_SimpleAnimatorTexture,uv);\n\tuv.x+=offset;\n\tvec4 mat3row = texture2D(u_SimpleAnimatorTexture,uv);\n\tmat4 m =mat4(mat0row.x,mat0row.y,mat0row.z,mat0row.w,\n\t\t\t  mat1row.x,mat1row.y,mat1row.z,mat1row.w,\n\t\t\t  mat2row.x,mat2row.y,mat2row.z,mat2row.w,\n\t\t\t  mat3row.x,mat3row.y,mat3row.z,mat3row.w);\n\treturn m;\n}\n#endif\n\nvoid main()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform;\n\t \t#ifdef SIMPLEBONE\n\t\t\tfloat currentPixelPos;\n\t\t\t#ifdef GPU_INSTANCE\n\t\t\t\tcurrentPixelPos = a_SimpleTextureParams.x+a_SimpleTextureParams.y;\n\t\t\t#else\n\t\t\t\tcurrentPixelPos = u_SimpleAnimatorParams.x+u_SimpleAnimatorParams.y;\n\t\t\t#endif\n\t\t\tfloat offset = 1.0/u_SimpleAnimatorTextureSize;\n\t\t\tskinTransform =  loadMatFromTexture(currentPixelPos,int(a_BoneIndices.x),offset) * a_BoneWeights.x;\n\t\t\tskinTransform += loadMatFromTexture(currentPixelPos,int(a_BoneIndices.y),offset) * a_BoneWeights.y;\n\t\t\tskinTransform += loadMatFromTexture(currentPixelPos,int(a_BoneIndices.z),offset) * a_BoneWeights.z;\n\t\t\tskinTransform += loadMatFromTexture(currentPixelPos,int(a_BoneIndices.w),offset) * a_BoneWeights.w;\n\t\t#else\n\t\t\tskinTransform =  u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\t#endif\n\t\tposition=skinTransform*a_Position;\n\t #else\n\t\tposition=a_Position;\n\t#endif\n\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\t\n\tmat4 worldMat;\n\t#ifdef GPU_INSTANCE\n\t\tworldMat = a_WorldMat;\n\t#else\n\t\tworldMat = u_WorldMat;\n\t#endif\n\n\tmat3 worldInvMat;\n\t#ifdef BONE\n\t\tworldInvMat=INVERSE_MAT(mat3(worldMat*skinTransform));\n\t#else\n\t\tworldInvMat=INVERSE_MAT(mat3(worldMat));\n\t#endif  \n\tv_Normal=normalize(a_Normal*worldInvMat);\n\t#if defined(NORMALMAP)\n\t\tv_Tangent=normalize(a_Tangent0.xyz*worldInvMat);\n\t\tv_Binormal=cross(v_Normal,v_Tangent)*a_Tangent0.w;\n\t#endif\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||(defined(CALCULATE_SHADOWS)&&defined(SHADOW_CASCADE))||defined(CALCULATE_SPOTSHADOWS)\n\t\tvec3 positionWS=(worldMat*position).xyz;\n\t\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\t\tv_ViewDir = u_CameraPos-positionWS;\n\t\t#endif\n\t\t#if defined(POINTLIGHT)||defined(SPOTLIGHT)||(defined(CALCULATE_SHADOWS)&&defined(SHADOW_CASCADE))||defined(CALCULATE_SPOTSHADOWS)\n\t\t\tv_PositionWorld = positionWS;\n\t\t#endif\n\t#endif\n\n\t#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(SPECULARMAP)||defined(NORMALMAP)))\n\t\t#ifdef TILINGOFFSET\n\t\t\tv_Texcoord0=TransformUV(a_Texcoord0,u_TilingOffset);\n\t\t#else\n\t\t\tv_Texcoord0=a_Texcoord0;\n\t\t#endif\n\t#endif\n\n\t#ifdef LIGHTMAP\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x,1.0-a_Texcoord1.y)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,1.0-a_Texcoord0.y)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t\tv_LightMapUV.y=1.0-v_LightMapUV.y;\n\t#endif\n\n\t#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\t\tv_Color=a_Color;\n\t#endif\n\n\t#if defined(CALCULATE_SHADOWS)&&!defined(SHADOW_CASCADE)\n\t\tv_ShadowCoord =getShadowCoord(vec4(positionWS,1.0));\n\t#endif\n\n\t#ifdef CALCULATE_SPOTSHADOWS\n\t\tv_SpotShadowCoord = u_SpotViewProjectMatrix*vec4(positionWS,1.0);\n\t#endif\n\n\tgl_Position=remapGLPositionZ(gl_Position);\n}";var MeshBlinnPhongShadowCasterPS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n\tprecision highp int;\n#else\n\tprecision mediump float;\n\tprecision mediump int;\n#endif\n\n#include \"ShadowCasterFS.glsl\"\n\nvoid main()\n{\n\tgl_FragColor=shadowCasterFragment();\n}";var MeshBlinnPhongShadowCasterVS="#include \"ShadowCasterVS.glsl\"\n\nvoid main()\n{\n\tvec4 positionCS =  shadowCasterVertex();\n\tgl_Position=remapGLPositionZ(positionCS);\n}";var ParticleShuriKenPS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\nvarying vec4 v_Color;\nvarying vec2 v_TextureCoordinate;\nuniform sampler2D u_texture;\nuniform vec4 u_Tintcolor;\n\n#ifdef RENDERMODE_MESH\n\tvarying vec4 v_MeshColor;\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\nvoid main()\n{\t\n\t#ifdef RENDERMODE_MESH\n\t\tgl_FragColor=v_MeshColor;\n\t#else\n\t\tgl_FragColor=vec4(1.0);\t\n\t#endif\n\t\t\n\t#ifdef DIFFUSEMAP\n\t\t#ifdef TINTCOLOR\n\t\t\tgl_FragColor*=texture2D(u_texture,v_TextureCoordinate)*u_Tintcolor*2.0*v_Color;\n\t\t#else\n\t\t\tgl_FragColor*=texture2D(u_texture,v_TextureCoordinate)*v_Color;\n\t\t#endif\n\t#else\n\t\t#ifdef TINTCOLOR\n\t\t\tgl_FragColor*=u_Tintcolor*2.0*v_Color;\n\t\t#else\n\t\t\tgl_FragColor*=v_Color;\n\t\t#endif\n\t#endif\n\t\n\t#ifdef FOG\n\t\tfloat lerpFact=clamp((1.0/gl_FragCoord.w-u_FogStart)/u_FogRange,0.0,1.0);\n\t\t#ifdef ADDTIVEFOG\n\t\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t\t#else\n\t\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t\t#endif\n\t#endif\n}";var ParticleShuriKenVS="#include \"Lighting.glsl\";\n\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\n#if defined(SPHERHBILLBOARD)||defined(STRETCHEDBILLBOARD)||defined(HORIZONTALBILLBOARD)||defined(VERTICALBILLBOARD)\n\tattribute vec4 a_CornerTextureCoordinate;\n#endif\n#ifdef RENDERMODE_MESH\n\tattribute vec3 a_MeshPosition;\n\tattribute vec4 a_MeshColor;\n\tattribute vec2 a_MeshTextureCoordinate;\n\tvarying vec4 v_MeshColor;\n#endif\n\nattribute vec4 a_ShapePositionStartLifeTime;\nattribute vec4 a_DirectionTime;\nattribute vec4 a_StartColor;\nattribute vec3 a_StartSize;\nattribute vec3 a_StartRotation0;\nattribute float a_StartSpeed;\n#if defined(COLOROVERLIFETIME)||defined(RANDOMCOLOROVERLIFETIME)||defined(SIZEOVERLIFETIMERANDOMCURVES)||defined(SIZEOVERLIFETIMERANDOMCURVESSEPERATE)||defined(ROTATIONOVERLIFETIMERANDOMCONSTANTS)||defined(ROTATIONOVERLIFETIMERANDOMCURVES)\n  attribute vec4 a_Random0;\n#endif\n#if defined(TEXTURESHEETANIMATIONRANDOMCURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n  attribute vec4 a_Random1;\n#endif\nattribute vec3 a_SimulationWorldPostion;\nattribute vec4 a_SimulationWorldRotation;\n\nvarying vec4 v_Color;\n#ifdef DIFFUSEMAP\n\tvarying vec2 v_TextureCoordinate;\n#endif\n\nuniform float u_CurrentTime;\nuniform vec3 u_Gravity;\n\nuniform vec3 u_WorldPosition;\nuniform vec4 u_WorldRotation;\nuniform bool u_ThreeDStartRotation;\nuniform int u_ScalingMode;\nuniform vec3 u_PositionScale;\nuniform vec3 u_SizeScale;\nuniform mat4 u_View;\nuniform mat4 u_Projection;\n\n#ifdef STRETCHEDBILLBOARD\n\tuniform vec3 u_CameraPos;\n#endif\nuniform vec3 u_CameraDirection;//TODO:只有几种广告牌模式需要用\nuniform vec3 u_CameraUp;\n\nuniform  float u_StretchedBillboardLengthScale;\nuniform  float u_StretchedBillboardSpeedScale;\nuniform int u_SimulationSpace;\n\n#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n  uniform  int  u_VOLSpaceType;\n#endif\n#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)\n  uniform  vec3 u_VOLVelocityConst;\n#endif\n#if defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n  uniform  vec2 u_VOLVelocityGradientX[4];//x为key,y为速度\n  uniform  vec2 u_VOLVelocityGradientY[4];//x为key,y为速度\n  uniform  vec2 u_VOLVelocityGradientZ[4];//x为key,y为速度\n#endif\n#ifdef VELOCITYOVERLIFETIMERANDOMCONSTANT\n  uniform  vec3 u_VOLVelocityConstMax;\n#endif\n#ifdef VELOCITYOVERLIFETIMERANDOMCURVE\n  uniform  vec2 u_VOLVelocityGradientMaxX[4];//x为key,y为速度\n  uniform  vec2 u_VOLVelocityGradientMaxY[4];//x为key,y为速度\n  uniform  vec2 u_VOLVelocityGradientMaxZ[4];//x为key,y为速度\n#endif\n\n#ifdef COLOROVERLIFETIME\n  uniform  vec4 u_ColorOverLifeGradientColors[4];//x为key,yzw为Color\n  uniform  vec2 u_ColorOverLifeGradientAlphas[4];//x为key,y为Alpha\n#endif\n#ifdef RANDOMCOLOROVERLIFETIME\n  uniform  vec4 u_ColorOverLifeGradientColors[4];//x为key,yzw为Color\n  uniform  vec2 u_ColorOverLifeGradientAlphas[4];//x为key,y为Alpha\n  uniform  vec4 u_MaxColorOverLifeGradientColors[4];//x为key,yzw为Color\n  uniform  vec2 u_MaxColorOverLifeGradientAlphas[4];//x为key,y为Alpha\n#endif\n\n\n#if defined(SIZEOVERLIFETIMECURVE)||defined(SIZEOVERLIFETIMERANDOMCURVES)\n  uniform  vec2 u_SOLSizeGradient[4];//x为key,y为尺寸\n#endif\n#ifdef SIZEOVERLIFETIMERANDOMCURVES\n  uniform  vec2 u_SOLSizeGradientMax[4];//x为key,y为尺寸\n#endif\n#if defined(SIZEOVERLIFETIMECURVESEPERATE)||defined(SIZEOVERLIFETIMERANDOMCURVESSEPERATE)\n  uniform  vec2 u_SOLSizeGradientX[4];//x为key,y为尺寸\n  uniform  vec2 u_SOLSizeGradientY[4];//x为key,y为尺寸\n  uniform  vec2 u_SOLSizeGradientZ[4];//x为key,y为尺寸\n#endif\n#ifdef SIZEOVERLIFETIMERANDOMCURVESSEPERATE\n  uniform  vec2 u_SOLSizeGradientMaxX[4];//x为key,y为尺寸\n  uniform  vec2 u_SOLSizeGradientMaxY[4];//x为key,y为尺寸\n  uniform  vec2 u_SOLSizeGradientMaxZ[4];//x为key,y为尺寸\n#endif\n\n\n#ifdef ROTATIONOVERLIFETIME\n  #if defined(ROTATIONOVERLIFETIMECONSTANT)||defined(ROTATIONOVERLIFETIMERANDOMCONSTANTS)\n    uniform  float u_ROLAngularVelocityConst;\n  #endif\n  #ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n    uniform  float u_ROLAngularVelocityConstMax;\n  #endif\n  #if defined(ROTATIONOVERLIFETIMECURVE)||defined(ROTATIONOVERLIFETIMERANDOMCURVES)\n    uniform  vec2 u_ROLAngularVelocityGradient[4];//x为key,y为旋转\n  #endif\n  #ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n    uniform  vec2 u_ROLAngularVelocityGradientMax[4];//x为key,y为旋转\n  #endif\n#endif\n#ifdef ROTATIONOVERLIFETIMESEPERATE\n  #if defined(ROTATIONOVERLIFETIMECONSTANT)||defined(ROTATIONOVERLIFETIMERANDOMCONSTANTS)\n    uniform  vec3 u_ROLAngularVelocityConstSeprarate;\n  #endif\n  #ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n    uniform  vec3 u_ROLAngularVelocityConstMaxSeprarate;\n  #endif\n  #if defined(ROTATIONOVERLIFETIMECURVE)||defined(ROTATIONOVERLIFETIMERANDOMCURVES)\n    uniform  vec2 u_ROLAngularVelocityGradientX[4];\n    uniform  vec2 u_ROLAngularVelocityGradientY[4];\n    uniform  vec2 u_ROLAngularVelocityGradientZ[4];\n  #endif\n  #ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n    uniform  vec2 u_ROLAngularVelocityGradientMaxX[4];\n    uniform  vec2 u_ROLAngularVelocityGradientMaxY[4];\n    uniform  vec2 u_ROLAngularVelocityGradientMaxZ[4];\n\tuniform  vec2 u_ROLAngularVelocityGradientMaxW[4];\n  #endif\n#endif\n\n#if defined(TEXTURESHEETANIMATIONCURVE)||defined(TEXTURESHEETANIMATIONRANDOMCURVE)\n  uniform  float u_TSACycles;\n  uniform  vec2 u_TSASubUVLength;\n  uniform  vec2 u_TSAGradientUVs[4];//x为key,y为frame\n#endif\n#ifdef TEXTURESHEETANIMATIONRANDOMCURVE\n  uniform  vec2 u_TSAMaxGradientUVs[4];//x为key,y为frame\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvec3 rotationByEuler(in vec3 vector,in vec3 rot)\n{\n\tfloat halfRoll = rot.z * 0.5;\n    float halfPitch = rot.x * 0.5;\n\tfloat halfYaw = rot.y * 0.5;\n\n\tfloat sinRoll = sin(halfRoll);\n\tfloat cosRoll = cos(halfRoll);\n\tfloat sinPitch = sin(halfPitch);\n\tfloat cosPitch = cos(halfPitch);\n\tfloat sinYaw = sin(halfYaw);\n\tfloat cosYaw = cos(halfYaw);\n\n\tfloat quaX = (cosYaw * sinPitch * cosRoll) + (sinYaw * cosPitch * sinRoll);\n\tfloat quaY = (sinYaw * cosPitch * cosRoll) - (cosYaw * sinPitch * sinRoll);\n\tfloat quaZ = (cosYaw * cosPitch * sinRoll) - (sinYaw * sinPitch * cosRoll);\n\tfloat quaW = (cosYaw * cosPitch * cosRoll) + (sinYaw * sinPitch * sinRoll);\n\t\n\t//vec4 q=vec4(quaX,quaY,quaZ,quaW);\n\t//vec3 temp = cross(q.xyz, vector) + q.w * vector;\n\t//return (cross(temp, -q.xyz) + dot(q.xyz,vector) * q.xyz + q.w * temp);\n\t\n\tfloat x = quaX + quaX;\n    float y = quaY + quaY;\n    float z = quaZ + quaZ;\n    float wx = quaW * x;\n    float wy = quaW * y;\n    float wz = quaW * z;\n\tfloat xx = quaX * x;\n    float xy = quaX * y;\n\tfloat xz = quaX * z;\n    float yy = quaY * y;\n    float yz = quaY * z;\n    float zz = quaZ * z;\n\n    return vec3(((vector.x * ((1.0 - yy) - zz)) + (vector.y * (xy - wz))) + (vector.z * (xz + wy)),\n                ((vector.x * (xy + wz)) + (vector.y * ((1.0 - xx) - zz))) + (vector.z * (yz - wx)),\n                ((vector.x * (xz - wy)) + (vector.y * (yz + wx))) + (vector.z * ((1.0 - xx) - yy)));\n\t\n}\n\n//假定axis已经归一化\nvec3 rotationByAxis(in vec3 vector,in vec3 axis, in float angle)\n{\n\tfloat halfAngle = angle * 0.5;\n\tfloat sin = sin(halfAngle);\n\t\n\tfloat quaX = axis.x * sin;\n\tfloat quaY = axis.y * sin;\n\tfloat quaZ = axis.z * sin;\n\tfloat quaW = cos(halfAngle);\n\t\n\t//vec4 q=vec4(quaX,quaY,quaZ,quaW);\n\t//vec3 temp = cross(q.xyz, vector) + q.w * vector;\n\t//return (cross(temp, -q.xyz) + dot(q.xyz,vector) * q.xyz + q.w * temp);\n\t\n\tfloat x = quaX + quaX;\n    float y = quaY + quaY;\n    float z = quaZ + quaZ;\n    float wx = quaW * x;\n    float wy = quaW * y;\n    float wz = quaW * z;\n\tfloat xx = quaX * x;\n    float xy = quaX * y;\n\tfloat xz = quaX * z;\n    float yy = quaY * y;\n    float yz = quaY * z;\n    float zz = quaZ * z;\n\n    return vec3(((vector.x * ((1.0 - yy) - zz)) + (vector.y * (xy - wz))) + (vector.z * (xz + wy)),\n                ((vector.x * (xy + wz)) + (vector.y * ((1.0 - xx) - zz))) + (vector.z * (yz - wx)),\n                ((vector.x * (xz - wy)) + (vector.y * (yz + wx))) + (vector.z * ((1.0 - xx) - yy)));\n\t\n}\n\nvec3 rotationByQuaternions(in vec3 v,in vec4 q) \n{\n\treturn v + 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n}\n\n \n#if defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)||defined(SIZEOVERLIFETIMECURVE)||defined(SIZEOVERLIFETIMECURVESEPERATE)||defined(SIZEOVERLIFETIMERANDOMCURVES)||defined(SIZEOVERLIFETIMERANDOMCURVESSEPERATE)\nfloat getCurValueFromGradientFloat(in vec2 gradientNumbers[4],in float normalizedAge)\n{\n\tfloat curValue;\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec2 gradientNumber=gradientNumbers[i];\n\t\tfloat key=gradientNumber.x;\n\t\tif(key>=normalizedAge)\n\t\t{\n\t\t\tvec2 lastGradientNumber=gradientNumbers[i-1];\n\t\t\tfloat lastKey=lastGradientNumber.x;\n\t\t\tfloat age=(normalizedAge-lastKey)/(key-lastKey);\n\t\t\tcurValue=mix(lastGradientNumber.y,gradientNumber.y,age);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn curValue;\n}\n#endif\n\n#if defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)||defined(ROTATIONOVERLIFETIMECURVE)||defined(ROTATIONOVERLIFETIMERANDOMCURVES)\nfloat getTotalValueFromGradientFloat(in vec2 gradientNumbers[4],in float normalizedAge)\n{\n\tfloat totalValue=0.0;\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec2 gradientNumber=gradientNumbers[i];\n\t\tfloat key=gradientNumber.x;\n\t\tvec2 lastGradientNumber=gradientNumbers[i-1];\n\t\tfloat lastValue=lastGradientNumber.y;\n\t\t\n\t\tif(key>=normalizedAge){\n\t\t\tfloat lastKey=lastGradientNumber.x;\n\t\t\tfloat age=(normalizedAge-lastKey)/(key-lastKey);\n\t\t\ttotalValue+=(lastValue+mix(lastValue,gradientNumber.y,age))/2.0*a_ShapePositionStartLifeTime.w*(normalizedAge-lastKey);\n\t\t\tbreak;\n\t\t}\n\t\telse{\n\t\t\ttotalValue+=(lastValue+gradientNumber.y)/2.0*a_ShapePositionStartLifeTime.w*(key-lastGradientNumber.x);\n\t\t}\n\t}\n\treturn totalValue;\n}\n#endif\n\n#if defined(COLOROVERLIFETIME)||defined(RANDOMCOLOROVERLIFETIME)\nvec4 getColorFromGradient(in vec2 gradientAlphas[4],in vec4 gradientColors[4],in float normalizedAge)\n{\n\tvec4 overTimeColor;\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec2 gradientAlpha=gradientAlphas[i];\n\t\tfloat alphaKey=gradientAlpha.x;\n\t\tif(alphaKey>=normalizedAge)\n\t\t{\n\t\t\tvec2 lastGradientAlpha=gradientAlphas[i-1];\n\t\t\tfloat lastAlphaKey=lastGradientAlpha.x;\n\t\t\tfloat age=(normalizedAge-lastAlphaKey)/(alphaKey-lastAlphaKey);\n\t\t\toverTimeColor.a=mix(lastGradientAlpha.y,gradientAlpha.y,age);\n\t\t\tbreak;\n\t\t}\n\t}\n\t\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec4 gradientColor=gradientColors[i];\n\t\tfloat colorKey=gradientColor.x;\n\t\tif(colorKey>=normalizedAge)\n\t\t{\n\t\t\tvec4 lastGradientColor=gradientColors[i-1];\n\t\t\tfloat lastColorKey=lastGradientColor.x;\n\t\t\tfloat age=(normalizedAge-lastColorKey)/(colorKey-lastColorKey);\n\t\t\toverTimeColor.rgb=mix(gradientColors[i-1].yzw,gradientColor.yzw,age);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn overTimeColor;\n}\n#endif\n\n\n#if defined(TEXTURESHEETANIMATIONCURVE)||defined(TEXTURESHEETANIMATIONRANDOMCURVE)\nfloat getFrameFromGradient(in vec2 gradientFrames[4],in float normalizedAge)\n{\n\tfloat overTimeFrame;\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec2 gradientFrame=gradientFrames[i];\n\t\tfloat key=gradientFrame.x;\n\t\tif(key>=normalizedAge)\n\t\t{\n\t\t\tvec2 lastGradientFrame=gradientFrames[i-1];\n\t\t\tfloat lastKey=lastGradientFrame.x;\n\t\t\tfloat age=(normalizedAge-lastKey)/(key-lastKey);\n\t\t\toverTimeFrame=mix(lastGradientFrame.y,gradientFrame.y,age);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn floor(overTimeFrame);\n}\n#endif\n\n#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\nvec3 computeParticleLifeVelocity(in float normalizedAge)\n{\n  vec3 outLifeVelocity;\n  #ifdef VELOCITYOVERLIFETIMECONSTANT\n\t outLifeVelocity=u_VOLVelocityConst; \n  #endif\n  #ifdef VELOCITYOVERLIFETIMECURVE\n     outLifeVelocity= vec3(getCurValueFromGradientFloat(u_VOLVelocityGradientX,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientY,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientZ,normalizedAge));\n  #endif\n  #ifdef VELOCITYOVERLIFETIMERANDOMCONSTANT\n\t outLifeVelocity=mix(u_VOLVelocityConst,u_VOLVelocityConstMax,vec3(a_Random1.y,a_Random1.z,a_Random1.w)); \n  #endif\n  #ifdef VELOCITYOVERLIFETIMERANDOMCURVE\n     outLifeVelocity=vec3(mix(getCurValueFromGradientFloat(u_VOLVelocityGradientX,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientMaxX,normalizedAge),a_Random1.y),\n\t                 mix(getCurValueFromGradientFloat(u_VOLVelocityGradientY,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientMaxY,normalizedAge),a_Random1.z),\n\t\t\t\t\t mix(getCurValueFromGradientFloat(u_VOLVelocityGradientZ,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientMaxZ,normalizedAge),a_Random1.w));\n  #endif\n\t\t\t\t\t\n  return outLifeVelocity;\n} \n#endif\n\nvec3 computeParticlePosition(in vec3 startVelocity, in vec3 lifeVelocity,in float age,in float normalizedAge,vec3 gravityVelocity,vec4 worldRotation)\n{\n   vec3 startPosition;\n   vec3 lifePosition;\n   #if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n\t#ifdef VELOCITYOVERLIFETIMECONSTANT\n\t\t  startPosition=startVelocity*age;\n\t\t  lifePosition=lifeVelocity*age;\n\t#endif\n\t#ifdef VELOCITYOVERLIFETIMECURVE\n\t\t  startPosition=startVelocity*age;\n\t\t  lifePosition=vec3(getTotalValueFromGradientFloat(u_VOLVelocityGradientX,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientY,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientZ,normalizedAge));\n\t#endif\n\t#ifdef VELOCITYOVERLIFETIMERANDOMCONSTANT\n\t\t  startPosition=startVelocity*age;\n\t\t  lifePosition=lifeVelocity*age;\n\t#endif\n\t#ifdef VELOCITYOVERLIFETIMERANDOMCURVE\n\t\t  startPosition=startVelocity*age;\n\t\t  lifePosition=vec3(mix(getTotalValueFromGradientFloat(u_VOLVelocityGradientX,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientMaxX,normalizedAge),a_Random1.y)\n\t      ,mix(getTotalValueFromGradientFloat(u_VOLVelocityGradientY,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientMaxY,normalizedAge),a_Random1.z)\n\t      ,mix(getTotalValueFromGradientFloat(u_VOLVelocityGradientZ,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientMaxZ,normalizedAge),a_Random1.w));\n\t#endif\n\t\n\tvec3 finalPosition;\n\tif(u_VOLSpaceType==0){\n\t  if(u_ScalingMode!=2)\n\t   finalPosition =rotationByQuaternions(u_PositionScale*(a_ShapePositionStartLifeTime.xyz+startPosition+lifePosition),worldRotation);\n\t  else\n\t   finalPosition =rotationByQuaternions(u_PositionScale*a_ShapePositionStartLifeTime.xyz+startPosition+lifePosition,worldRotation);\n\t}\n\telse{\n\t  if(u_ScalingMode!=2)\n\t    finalPosition = rotationByQuaternions(u_PositionScale*(a_ShapePositionStartLifeTime.xyz+startPosition),worldRotation)+lifePosition;\n\t  else\n\t    finalPosition = rotationByQuaternions(u_PositionScale*a_ShapePositionStartLifeTime.xyz+startPosition,worldRotation)+lifePosition;\n\t}\n  #else\n\t startPosition=startVelocity*age;\n\t vec3 finalPosition;\n\t if(u_ScalingMode!=2)\n\t\t\tfinalPosition = rotationByQuaternions(u_PositionScale*(a_ShapePositionStartLifeTime.xyz+startPosition),worldRotation);\n\t else\n\t   \tfinalPosition = rotationByQuaternions(u_PositionScale*a_ShapePositionStartLifeTime.xyz+startPosition,worldRotation);\n  #endif\n  \n  if(u_SimulationSpace==0)\n    finalPosition=finalPosition+a_SimulationWorldPostion;\n  else if(u_SimulationSpace==1) \n    finalPosition=finalPosition+u_WorldPosition;\n  \n  finalPosition+=0.5*gravityVelocity*age;\n \n  return  finalPosition;\n}\n\n\nvec4 computeParticleColor(in vec4 color,in float normalizedAge)\n{\n\t#ifdef COLOROVERLIFETIME\n\t  color*=getColorFromGradient(u_ColorOverLifeGradientAlphas,u_ColorOverLifeGradientColors,normalizedAge);\n\t#endif\n\t\n\t#ifdef RANDOMCOLOROVERLIFETIME\n\t  color*=mix(getColorFromGradient(u_ColorOverLifeGradientAlphas,u_ColorOverLifeGradientColors,normalizedAge),getColorFromGradient(u_MaxColorOverLifeGradientAlphas,u_MaxColorOverLifeGradientColors,normalizedAge),a_Random0.y);\n\t#endif\n\n    return color;\n}\n\nvec2 computeParticleSizeBillbard(in vec2 size,in float normalizedAge)\n{\n\t#ifdef SIZEOVERLIFETIMECURVE\n\t\tsize*=getCurValueFromGradientFloat(u_SOLSizeGradient,normalizedAge);\n\t#endif\n\t#ifdef SIZEOVERLIFETIMERANDOMCURVES\n\t    size*=mix(getCurValueFromGradientFloat(u_SOLSizeGradient,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMax,normalizedAge),a_Random0.z); \n\t#endif\n\t#ifdef SIZEOVERLIFETIMECURVESEPERATE\n\t\tsize*=vec2(getCurValueFromGradientFloat(u_SOLSizeGradientX,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientY,normalizedAge));\n\t#endif\n\t#ifdef SIZEOVERLIFETIMERANDOMCURVESSEPERATE\n\t    size*=vec2(mix(getCurValueFromGradientFloat(u_SOLSizeGradientX,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxX,normalizedAge),a_Random0.z)\n\t    ,mix(getCurValueFromGradientFloat(u_SOLSizeGradientY,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxY,normalizedAge),a_Random0.z));\n\t#endif\n\treturn size;\n}\n\n#ifdef RENDERMODE_MESH\nvec3 computeParticleSizeMesh(in vec3 size,in float normalizedAge)\n{\n\t#ifdef SIZEOVERLIFETIMECURVE\n\t\tsize*=getCurValueFromGradientFloat(u_SOLSizeGradient,normalizedAge);\n\t#endif\n\t#ifdef SIZEOVERLIFETIMERANDOMCURVES\n\t    size*=mix(getCurValueFromGradientFloat(u_SOLSizeGradient,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMax,normalizedAge),a_Random0.z); \n\t#endif\n\t#ifdef SIZEOVERLIFETIMECURVESEPERATE\n\t\tsize*=vec3(getCurValueFromGradientFloat(u_SOLSizeGradientX,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientY,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientZ,normalizedAge));\n\t#endif\n\t#ifdef SIZEOVERLIFETIMERANDOMCURVESSEPERATE\n\t    size*=vec3(mix(getCurValueFromGradientFloat(u_SOLSizeGradientX,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxX,normalizedAge),a_Random0.z)\n\t    ,mix(getCurValueFromGradientFloat(u_SOLSizeGradientY,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxY,normalizedAge),a_Random0.z)\n\t\t,mix(getCurValueFromGradientFloat(u_SOLSizeGradientZ,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxZ,normalizedAge),a_Random0.z));\n\t#endif\n\treturn size;\n}\n#endif\n\nfloat computeParticleRotationFloat(in float rotation,in float age,in float normalizedAge)\n{ \n\t#ifdef ROTATIONOVERLIFETIME\n\t\t#ifdef ROTATIONOVERLIFETIMECONSTANT\n\t\t\tfloat ageRot=u_ROLAngularVelocityConst*age;\n\t        rotation+=ageRot;\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMECURVE\n\t\t\trotation+=getTotalValueFromGradientFloat(u_ROLAngularVelocityGradient,normalizedAge);\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n\t\t\tfloat ageRot=mix(u_ROLAngularVelocityConst,u_ROLAngularVelocityConstMax,a_Random0.w)*age;\n\t        rotation+=ageRot;\n\t    #endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n\t\t\trotation+=mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradient,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMax,normalizedAge),a_Random0.w);\n\t\t#endif\n\t#endif\n\t#ifdef ROTATIONOVERLIFETIMESEPERATE\n\t\t#ifdef ROTATIONOVERLIFETIMECONSTANT\n\t\t\tfloat ageRot=u_ROLAngularVelocityConstSeprarate.z*age;\n\t        rotation+=ageRot;\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMECURVE\n\t\t\trotation+=getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientZ,normalizedAge);\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n\t\t\tfloat ageRot=mix(u_ROLAngularVelocityConstSeprarate.z,u_ROLAngularVelocityConstMaxSeprarate.z,a_Random0.w)*age;\n\t        rotation+=ageRot;\n\t    #endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n\t\t\trotation+=mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientZ,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMaxZ,normalizedAge),a_Random0.w));\n\t\t#endif\n\t#endif\n\treturn rotation;\n}\n\n#if defined(RENDERMODE_MESH)&&(defined(ROTATIONOVERLIFETIME)||defined(ROTATIONOVERLIFETIMESEPERATE))\nvec3 computeParticleRotationVec3(in vec3 rotation,in float age,in float normalizedAge)\n{ \n\t#ifdef ROTATIONOVERLIFETIME\n\t#ifdef ROTATIONOVERLIFETIMECONSTANT\n\t\t\tfloat ageRot=u_ROLAngularVelocityConst*age;\n\t        rotation+=ageRot;\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMECURVE\n\t\t\trotation+=getTotalValueFromGradientFloat(u_ROLAngularVelocityGradient,normalizedAge);\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n\t\t\tfloat ageRot=mix(u_ROLAngularVelocityConst,u_ROLAngularVelocityConstMax,a_Random0.w)*age;\n\t        rotation+=ageRot;\n\t    #endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n\t\t\trotation+=mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradient,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMax,normalizedAge),a_Random0.w);\n\t\t#endif\n\t#endif\n\t#ifdef ROTATIONOVERLIFETIMESEPERATE\n\t\t#ifdef ROTATIONOVERLIFETIMECONSTANT\n\t\t\tvec3 ageRot=u_ROLAngularVelocityConstSeprarate*age;\n\t        rotation+=ageRot;\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMECURVE\n\t\t\trotation+=vec3(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientX,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientY,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientZ,normalizedAge));\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n\t\t\tvec3 ageRot=mix(u_ROLAngularVelocityConstSeprarate,u_ROLAngularVelocityConstMaxSeprarate,a_Random0.w)*age;\n\t        rotation+=ageRot;\n\t    #endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n\t\t\trotation+=vec3(mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientX,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMaxX,normalizedAge),a_Random0.w)\n\t        ,mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientY,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMaxY,normalizedAge),a_Random0.w)\n\t        ,mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientZ,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMaxZ,normalizedAge),a_Random0.w));\n\t\t#endif\n\t#endif\n\treturn rotation;\n}\n#endif\n\nvec2 computeParticleUV(in vec2 uv,in float normalizedAge)\n{ \n\t#ifdef TEXTURESHEETANIMATIONCURVE\n\t\tfloat cycleNormalizedAge=normalizedAge*u_TSACycles;\n\t\tfloat frame=getFrameFromGradient(u_TSAGradientUVs,cycleNormalizedAge-floor(cycleNormalizedAge));\n\t\tfloat totalULength=frame*u_TSASubUVLength.x;\n\t\tfloat floorTotalULength=floor(totalULength);\n\t    uv.x+=totalULength-floorTotalULength;\n\t\tuv.y+=floorTotalULength*u_TSASubUVLength.y;\n    #endif\n\t#ifdef TEXTURESHEETANIMATIONRANDOMCURVE\n\t\tfloat cycleNormalizedAge=normalizedAge*u_TSACycles;\n\t\tfloat uvNormalizedAge=cycleNormalizedAge-floor(cycleNormalizedAge);\n\t    float frame=floor(mix(getFrameFromGradient(u_TSAGradientUVs,uvNormalizedAge),getFrameFromGradient(u_TSAMaxGradientUVs,uvNormalizedAge),a_Random1.x));\n\t\tfloat totalULength=frame*u_TSASubUVLength.x;\n\t\tfloat floorTotalULength=floor(totalULength);\n\t    uv.x+=totalULength-floorTotalULength;\n\t\tuv.y+=floorTotalULength*u_TSASubUVLength.y;\n    #endif\n\treturn uv;\n}\n\nvoid main()\n{\n\tfloat age = u_CurrentTime - a_DirectionTime.w;\n\tfloat normalizedAge = age/a_ShapePositionStartLifeTime.w;\n\tvec3 lifeVelocity;\n\tif(normalizedAge<1.0)\n\t{ \n\t\tvec3 startVelocity=a_DirectionTime.xyz*a_StartSpeed;\n\t\t#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n\t\t\tlifeVelocity= computeParticleLifeVelocity(normalizedAge);//计算粒子生命周期速度\n\t\t#endif \n\t\tvec3 gravityVelocity=u_Gravity*age;\n\t\t\n\t\tvec4 worldRotation;\n\t\tif(u_SimulationSpace==0)\n\t\t\tworldRotation=a_SimulationWorldRotation;\n\t\telse\n\t\t\tworldRotation=u_WorldRotation;\n\t\t\n\t\tvec3 center=computeParticlePosition(startVelocity, lifeVelocity, age, normalizedAge,gravityVelocity,worldRotation);//计算粒子位置\n\t\n\t\n\t\t#ifdef SPHERHBILLBOARD\n\t\t\tvec2 corner=a_CornerTextureCoordinate.xy;//Billboard模式z轴无效\n\t\t\tvec3 cameraUpVector =normalize(u_CameraUp);//TODO:是否外面归一化\n\t\t\tvec3 sideVector = normalize(cross(u_CameraDirection,cameraUpVector));\n\t\t\tvec3 upVector = normalize(cross(sideVector,u_CameraDirection));\n\t\t\tcorner*=computeParticleSizeBillbard(a_StartSize.xy,normalizedAge);\n\t\t\t#if defined(ROTATIONOVERLIFETIME)||defined(ROTATIONOVERLIFETIMESEPERATE)\n\t\t\t\tif(u_ThreeDStartRotation){\n\t\t\t\t\tvec3 rotation=vec3(a_StartRotation0.xy,computeParticleRotationFloat(a_StartRotation0.z,age,normalizedAge));\n\t\t\t\t\tcenter += u_SizeScale.xzy*rotationByEuler(corner.x*sideVector+corner.y*upVector,rotation);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tfloat rot = computeParticleRotationFloat(a_StartRotation0.x, age,normalizedAge);\n\t\t\t\t\tfloat c = cos(rot);\n\t\t\t\t\tfloat s = sin(rot);\n\t\t\t\t\tmat2 rotation= mat2(c, -s, s, c);\n\t\t\t\t\tcorner=rotation*corner;\n\t\t\t\t\tcenter += u_SizeScale.xzy*(corner.x*sideVector+corner.y*upVector);\n\t\t\t\t}\n\t\t\t#else\n\t\t\t\tif(u_ThreeDStartRotation){\n\t\t\t\t\tcenter += u_SizeScale.xzy*rotationByEuler(corner.x*sideVector+corner.y*upVector,a_StartRotation0);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tfloat c = cos(a_StartRotation0.x);\n\t\t\t\t\tfloat s = sin(a_StartRotation0.x);\n\t\t\t\t\tmat2 rotation= mat2(c, -s, s, c);\n\t\t\t\t\tcorner=rotation*corner;\n\t\t\t\t\tcenter += u_SizeScale.xzy*(corner.x*sideVector+corner.y*upVector);\n\t\t\t\t}\n\t\t\t#endif\n\t\t#endif\n\t\n\t\t#ifdef STRETCHEDBILLBOARD\n\t\t\tvec2 corner=a_CornerTextureCoordinate.xy;//Billboard模式z轴无效\n\t\t\tvec3 velocity;\n\t\t\t#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n\t\t\t\tif(u_VOLSpaceType==0)\n\t\t\t\tvelocity=rotationByQuaternions(u_SizeScale*(startVelocity+lifeVelocity),worldRotation)+gravityVelocity;\n\t\t\t\telse\n\t\t\t\tvelocity=rotationByQuaternions(u_SizeScale*startVelocity,worldRotation)+lifeVelocity+gravityVelocity;\n\t\t\t#else\n\t\t\t\tvelocity= rotationByQuaternions(u_SizeScale*startVelocity,worldRotation)+gravityVelocity;\n\t\t\t#endif\t\n\t\t\tvec3 cameraUpVector = normalize(velocity);\n\t\t\tvec3 direction = normalize(center-u_CameraPos);\n\t\t\tvec3 sideVector = normalize(cross(direction,normalize(velocity)));\n\t\t\t\n\t\t\tsideVector=u_SizeScale.xzy*sideVector;\n\t\t\tcameraUpVector=length(vec3(u_SizeScale.x,0.0,0.0))*cameraUpVector;\n\t\t\t\n\t\t\tvec2 size=computeParticleSizeBillbard(a_StartSize.xy,normalizedAge);\n\t\t\t\n\t\t\tconst mat2 rotaionZHalfPI=mat2(0.0, -1.0, 1.0, 0.0);\n\t\t\tcorner=rotaionZHalfPI*corner;\n\t\t\tcorner.y=corner.y-abs(corner.y);\n\t\t\t\n\t\t\tfloat speed=length(velocity);//TODO:\n\t\t\tcenter +=sign(u_SizeScale.x)*(sign(u_StretchedBillboardLengthScale)*size.x*corner.x*sideVector+(speed*u_StretchedBillboardSpeedScale+size.y*u_StretchedBillboardLengthScale)*corner.y*cameraUpVector);\n\t\t#endif\n\t\n\t\t#ifdef HORIZONTALBILLBOARD\n\t\t\tvec2 corner=a_CornerTextureCoordinate.xy;//Billboard模式z轴无效\n\t\t\tconst vec3 cameraUpVector=vec3(0.0,0.0,1.0);\n\t\t\tconst vec3 sideVector = vec3(-1.0,0.0,0.0);\n\t\t\t\n\t\t\tfloat rot = computeParticleRotationFloat(a_StartRotation0.x, age,normalizedAge);\n\t\t\tfloat c = cos(rot);\n\t\t\tfloat s = sin(rot);\n\t\t\tmat2 rotation= mat2(c, -s, s, c);\n\t\t\tcorner=rotation*corner*cos(0.78539816339744830961566084581988);//TODO:临时缩小cos45,不确定U3D原因\n\t\t\tcorner*=computeParticleSizeBillbard(a_StartSize.xy,normalizedAge);\n\t\t\tcenter +=u_SizeScale.xzy*(corner.x*sideVector+ corner.y*cameraUpVector);\n\t\t#endif\n\t\n\t\t#ifdef VERTICALBILLBOARD\n\t\t\tvec2 corner=a_CornerTextureCoordinate.xy;//Billboard模式z轴无效\n\t\t\tconst vec3 cameraUpVector =vec3(0.0,1.0,0.0);\n\t\t\tvec3 sideVector = normalize(cross(u_CameraDirection,cameraUpVector));\n\t\t\t\n\t\t\tfloat rot = computeParticleRotationFloat(a_StartRotation0.x, age,normalizedAge);\n\t\t\tfloat c = cos(rot);\n\t\t\tfloat s = sin(rot);\n\t\t\tmat2 rotation= mat2(c, -s, s, c);\n\t\t\tcorner=rotation*corner*cos(0.78539816339744830961566084581988);//TODO:临时缩小cos45,不确定U3D原因\n\t\t\tcorner*=computeParticleSizeBillbard(a_StartSize.xy,normalizedAge);\n\t\t\tcenter +=u_SizeScale.xzy*(corner.x*sideVector+ corner.y*cameraUpVector);\n\t\t#endif\n\t\n\t\t#ifdef RENDERMODE_MESH\n\t\t\tvec3 size=computeParticleSizeMesh(a_StartSize,normalizedAge);\n\t\t\t#if defined(ROTATIONOVERLIFETIME)||defined(ROTATIONOVERLIFETIMESEPERATE)\n\t\t\t\tif(u_ThreeDStartRotation){\n\t\t\t\t\tvec3 rotation=vec3(a_StartRotation0.xy,computeParticleRotationFloat(a_StartRotation0.z, age,normalizedAge));\n\t\t\t\t\tcenter+= rotationByQuaternions(u_SizeScale*rotationByEuler(a_MeshPosition*size,rotation),worldRotation);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t#ifdef ROTATIONOVERLIFETIME\n\t\t\t\t\t\tfloat angle=computeParticleRotationFloat(a_StartRotation0.x, age,normalizedAge);\n\t\t\t\t\t\tif(a_ShapePositionStartLifeTime.x!=0.0||a_ShapePositionStartLifeTime.y!=0.0){\n\t\t\t\t\t\t\tcenter+= (rotationByQuaternions(rotationByAxis(u_SizeScale*a_MeshPosition*size,normalize(cross(vec3(0.0,0.0,1.0),vec3(a_ShapePositionStartLifeTime.xy,0.0))),angle),worldRotation));//已验证\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t#ifdef SHAPE\n\t\t\t\t\t\t\t\tcenter+= u_SizeScale.xzy*(rotationByQuaternions(rotationByAxis(a_MeshPosition*size,vec3(0.0,-1.0,0.0),angle),worldRotation));\n\t\t\t\t\t\t\t#else\n\t\t\t\t\t\t\t\tif(u_SimulationSpace==0)\n\t\t\t\t\t\t\t\t\tcenter+=rotationByAxis(u_SizeScale*a_MeshPosition*size,vec3(0.0,0.0,-1.0),angle);//已验证\n\t\t\t\t\t\t\t\telse if(u_SimulationSpace==1)\n\t\t\t\t\t\t\t\t\tcenter+=rotationByQuaternions(u_SizeScale*rotationByAxis(a_MeshPosition*size,vec3(0.0,0.0,-1.0),angle),worldRotation);//已验证\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\t\t\t\t\t#ifdef ROTATIONOVERLIFETIMESEPERATE\n\t\t\t\t\t\t//TODO:是否应合并if(u_ThreeDStartRotation)分支代码,待测试\n\t\t\t\t\t\tvec3 angle=computeParticleRotationVec3(vec3(0.0,0.0,-a_StartRotation0.x), age,normalizedAge);\n\t\t\t\t\t\tcenter+= (rotationByQuaternions(rotationByEuler(u_SizeScale*a_MeshPosition*size,vec3(angle.x,angle.y,angle.z)),worldRotation));//已验证\n\t\t\t\t\t#endif\t\t\n\t\t\t\t}\n\t\t\t#else\n\t\t\t\tif(u_ThreeDStartRotation){\n\t\t\t\t\tcenter+= rotationByQuaternions(u_SizeScale*rotationByEuler(a_MeshPosition*size,a_StartRotation0),worldRotation);//已验证\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tif(a_ShapePositionStartLifeTime.x!=0.0||a_ShapePositionStartLifeTime.y!=0.0){\n\t\t\t\t\t\tif(u_SimulationSpace==0)\n\t\t\t\t\t\t\tcenter+= rotationByAxis(u_SizeScale*a_MeshPosition*size,normalize(cross(vec3(0.0,0.0,1.0),vec3(a_ShapePositionStartLifeTime.xy,0.0))),a_StartRotation0.x);\n\t\t\t\t\t\telse if(u_SimulationSpace==1)\n\t\t\t\t\t\t\tcenter+= (rotationByQuaternions(u_SizeScale*rotationByAxis(a_MeshPosition*size,normalize(cross(vec3(0.0,0.0,1.0),vec3(a_ShapePositionStartLifeTime.xy,0.0))),a_StartRotation0.x),worldRotation));//已验证\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\t#ifdef SHAPE\n\t\t\t\t\t\t\tif(u_SimulationSpace==0)\n\t\t\t\t\t\t\t\tcenter+= u_SizeScale*rotationByAxis(a_MeshPosition*size,vec3(0.0,-1.0,0.0),a_StartRotation0.x);\n\t\t\t\t\t\t\telse if(u_SimulationSpace==1)\n\t\t\t\t\t\t\t\tcenter+= rotationByQuaternions(u_SizeScale*rotationByAxis(a_MeshPosition*size,vec3(0.0,-1.0,0.0),a_StartRotation0.x),worldRotation);\t\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tif(u_SimulationSpace==0)\n\t\t\t\t\t\t\t\tcenter+= rotationByAxis(u_SizeScale*a_MeshPosition*size,vec3(0.0,0.0,-1.0),a_StartRotation0.x);\n\t\t\t\t\t\t\telse if(u_SimulationSpace==1)\n\t\t\t\t\t\t\t\tcenter+= rotationByQuaternions(u_SizeScale*rotationByAxis(a_MeshPosition*size,vec3(0.0,0.0,-1.0),a_StartRotation0.x),worldRotation);//已验证\n\t\t\t\t\t\t#endif\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t#endif\n\t\t\tv_MeshColor=a_MeshColor;\n\t\t#endif\n\t\n\t\tgl_Position=u_Projection*u_View*vec4(center,1.0);\n\t\tv_Color = computeParticleColor(a_StartColor, normalizedAge);\n\t\t#ifdef DIFFUSEMAP\n\t\t\t#if defined(SPHERHBILLBOARD)||defined(STRETCHEDBILLBOARD)||defined(HORIZONTALBILLBOARD)||defined(VERTICALBILLBOARD)\n\t\t\t\tv_TextureCoordinate =computeParticleUV(a_CornerTextureCoordinate.zw, normalizedAge);\n\t\t\t#endif\n\t\t\t#ifdef RENDERMODE_MESH\n\t\t\t\tv_TextureCoordinate =computeParticleUV(a_MeshTextureCoordinate, normalizedAge);\n\t\t\t#endif\n\t\t\t\n\t\t\t#ifdef TILINGOFFSET\n\t\t\t\tv_TextureCoordinate=TransformUV(v_TextureCoordinate,u_TilingOffset);\n\t\t\t#endif\n\t\t#endif\n   \t}\n   \telse\n\t{\n\t\tgl_Position=vec4(2.0,2.0,2.0,1.0);//Discard use out of X(-1,1),Y(-1,1),Z(0,1)\n\t}\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n\n";var LayaPBRBRDF="// allow to explicitly override LAYA_BRDF_GI and LAYA_BRDF_LIGHT in custom shader,default is layaBRDFHighGI and layaBRDFHighLight\n#if !defined (LAYA_BRDF_GI) \n\t#if defined(LAYA_PBR_BRDF_LOW)\n\t\t#define LAYA_BRDF_GI layaBRDFLowGI\n\t#elif defined(LAYA_PBR_BRDF_HIGH)\n\t\t#define LAYA_BRDF_GI layaBRDFHighGI\n\t#endif\n#endif\n#if !defined (LAYA_BRDF_LIGHT)\n\t#if defined(LAYA_PBR_BRDF_LOW)\n\t\t#define LAYA_BRDF_LIGHT layaBRDFLowLight\n\t#elif defined(LAYA_PBR_BRDF_HIGH)\n\t\t#define LAYA_BRDF_LIGHT layaBRDFHighLight\n\t#endif\n#endif\n\n#define PI 3.14159265359\n#define INV_PI 0.31830988618\n\nmediump float pow4(mediump float x)\n{\n\treturn x * x * x * x;\n}\n\nmediump float pow5(mediump float x)\n{\n\treturn x * x * x * x * x;\n}\n\nmediump vec3 fresnelLerp(mediump vec3 F0,mediump vec3 F90,mediump float cosA)\n{\n\tfloat t = pow5(1.0 - cosA);   // ala Schlick interpoliation\n\treturn mix(F0, F90, t);\n}\n\nmediump vec3 fresnelTerm(mediump vec3 F0,mediump float cosA)\n{\n\tfloat t = pow5(1.0 - cosA);   // ala Schlick interpoliation\n\treturn F0 + (vec3(1.0) - F0) * t;\n}\n\n// approximage Schlick with ^4 instead of ^5\nmediump vec3 fresnelLerpFast (mediump vec3 F0, mediump vec3 F90,mediump float cosA)\n{\n    mediump float t = pow4 (1.0 - cosA);\n    return mix (F0, F90, t);\n}\n\nfloat smoothnessToPerceptualRoughness(float smoothness)\n{\n    return 1.0 - smoothness;\n}\n\nfloat perceptualRoughnessToRoughness(float perceptualRoughness)\n{\n    return perceptualRoughness * perceptualRoughness;\n}\n\nvec3 safeNormalize(vec3 inVec)\n{\n\tfloat dp3 = max(0.001,dot(inVec,inVec));\n\treturn inVec * inversesqrt(dp3);\n}\n\n// Note: Disney diffuse must be multiply by diffuseAlbedo / PI. This is done outside of this function.\nmediump float disneyDiffuse(mediump float NdotV,mediump float NdotL,mediump float LdotH,mediump float perceptualRoughness)\n{\n\t//https://www.cnblogs.com/herenzhiming/articles/5790389.html\n\tmediump float fd90 = 0.5 + 2.0 * LdotH * LdotH * perceptualRoughness;\n\t// Two schlick fresnel term\n\tmediump float lightScatter = (1.0 + (fd90 - 1.0) * pow5(1.0 - NdotL));\n\tmediump float viewScatter = (1.0 + (fd90 - 1.0) * pow5(1.0 - NdotV));\n\n\treturn lightScatter * viewScatter;\n}\n\n// Ref: http://jcgt.org/published/0003/02/03/paper.pdf\nfloat smithJointGGXVisibilityTerm(float NdotL, float NdotV, float roughness)\n{\n\t// Original formulation:\n    // lambda_v    = (-1 + sqrt(a2 * (1 - NdotL2) / NdotL2 + 1)) * 0.5f;\n    // lambda_l    = (-1 + sqrt(a2 * (1 - NdotV2) / NdotV2 + 1)) * 0.5f;\n    // G           = 1 / (1 + lambda_v + lambda_l);\n\n\t// scientific code implement:\n\t// Reorder code to be more optimal\n    // half a          = roughness;\n    // half a2         = a * a;\n\n    // half lambdaV    = NdotL * sqrt((-NdotV * a2 + NdotV) * NdotV + a2);\n    // half lambdaL    = NdotV * sqrt((-NdotL * a2 + NdotL) * NdotL + a2);\n\n    // Simplify visibility term: (2.0f * NdotL * NdotV) /  ((4.0f * NdotL * NdotV) * (lambda_v + lambda_l + 1e-5f));\n    // return 0.5f / (lambdaV + lambdaL + 1e-5f);  \n\t// This function is not intended to be running on Mobile,therefore epsilon is smaller than can be represented by half\n\n\t// Approximation of the above formulation (simplify the sqrt, not mathematically correct but close enough)\n\tfloat a = roughness;\n\tfloat lambdaV = NdotL * (NdotV * (1.0 - a) + a);\n\tfloat lambdaL = NdotV * (NdotL * (1.0 - a) + a);\n\treturn 0.5 / (lambdaV + lambdaL + 1e-5);\n}\n\nfloat ggxTerm(float NdotH, float roughness)\n{\n\tfloat a2 = roughness * roughness;\n\tfloat d = (NdotH * a2 - NdotH) * NdotH + 1.0; // 2 mad\n\treturn INV_PI * a2 / (d * d + 1e-7); // This function is not intended to be running on Mobile,therefore epsilon is smaller than what can be represented by half//返回值小用half来返回\n}\n\n// BRDF1-------------------------------------------------------------------------------------\n\n// Note: BRDF entry points use smoothness and oneMinusReflectivity for optimization purposes,\n// mostly for DX9 SM2.0 level. Most of the math is being done on these (1-x) values, and that saves a few precious ALU slots.\n\n// Main Physically Based BRDF\n// Derived from Disney work and based on Torrance-Sparrow micro-facet model\n//\n// BRDF = kD / pi + kS * (D * V * F) / 4\n// I = BRDF * NdotL\n//\n// *NDF GGX:\n// *Smith for Visiblity term\n// *Schlick approximation for Fresnel\nmediump vec4 layaBRDFHighLight(mediump vec3 diffColor, mediump vec3 specColor, mediump float oneMinusReflectivity, float perceptualRoughness,float roughness,mediump float nv,vec3 normal, vec3 viewDir,LayaLight light)\n{\n\tvec3 halfDir = safeNormalize(viewDir-light.dir);\n\n\tfloat nl = clamp(dot(normal, -light.dir),0.0,1.0);\n\tfloat nh = clamp(dot(normal, halfDir),0.0,1.0);\n\tmediump float lv = clamp(dot(light.dir, viewDir),0.0,1.0);\n\tmediump float lh = clamp(dot(light.dir, -halfDir),0.0,1.0);\n\n\t// Diffuse term\n\tmediump float diffuseTerm = disneyDiffuse(nv, nl, lh, perceptualRoughness) * nl;\n\n\t// Specular term\n    // HACK: theoretically we should divide diffuseTerm by Pi and not multiply specularTerm!\n    // BUT that will make shader look significantly darker than Legacy ones\n\n\t// GGX with roughtness to 0 would mean no specular at all, using max(roughness, 0.002) here to match HDrenderloop roughtness remapping.\n\troughness = max(roughness, 0.002);\n\tfloat V = smithJointGGXVisibilityTerm(nl, nv, roughness);\n\tfloat D = ggxTerm(nh, roughness);\n\n\tfloat specularTerm = V * D * PI; // Torrance-Sparrow model, Fresnel is applied later\n\n\t//#ifdef LAYA_COLORSPACE_GAMMA\n\tspecularTerm = sqrt(max(1e-4, specularTerm));\n\t//#endif\n\tspecularTerm = max(0.0, specularTerm * nl);\n\t\t\n\tmediump vec3 color = diffColor * light.color * diffuseTerm + specularTerm * light.color * fresnelTerm(specColor, lh);\n\treturn vec4(color, 1.0);\n}\n\nvec4 layaBRDFHighGI(mediump vec3 diffColor,mediump vec3 specColor,mediump float oneMinusReflectivity,float smoothness ,float perceptualRoughness,float roughness,mediump float nv,vec3 normal, vec3 viewDir,LayaGI gi)\n{\n\t// surfaceReduction = Int D(NdotH) * NdotH * Id(NdotL>0) dH = 1/(roughness^2+1)\n\tfloat surfaceReduction;\n\tsurfaceReduction = 1.0 - 0.28*roughness*perceptualRoughness;// 1-0.28*x^3 as approximation for (1/(x^4+1))^(1/2.2) on the domain [0;1]\n\tfloat grazingTerm = clamp(smoothness + (1.0 - oneMinusReflectivity),0.0,1.0);\n\tmediump vec3 color =diffColor * gi.diffuse + surfaceReduction * gi.specular * fresnelLerp(specColor,vec3(grazingTerm), nv);\n\treturn vec4(color,1.0);\n}\n// BRDF1-------------------------------------------------------------------------------------\n\n\n// BRDF2-------------------------------------------------------------------------------------\n// Based on Minimalist CookTorrance BRDF\n// Implementation is slightly different from original derivation: http://www.thetenthplanet.de/archives/255\n//\n// *NDF [Modified] GGX:\n// *Modified Kelemen and Szirmay-​Kalos for Visibility term\n// *Fresnel approximated with 1/LdotH\nmediump vec4 layaBRDFLowLight (mediump vec3 diffColor, mediump vec3 specColor,mediump float oneMinusReflectivity,float perceptualRoughness,float roughness,mediump float nv,vec3 normal,vec3 viewDir,LayaLight light)\n{\n    vec3 halfDir = safeNormalize (viewDir-light.dir);\n    mediump float nl = clamp(dot(normal, -light.dir),0.0,1.0);\n    float nh = clamp(dot(normal, halfDir),0.0,1.0);\n    float lh = clamp(dot(-light.dir, halfDir),0.0,1.0);\n\n    // GGX Distribution multiplied by combined approximation of Visibility and Fresnel\n    // See \"Optimizing PBR for Mobile\" from Siggraph 2015 moving mobile graphics course\n    // https://community.arm.com/events/1155\n    mediump float a = roughness;\n    float a2 = a*a;\n\n    float d = nh * nh * (a2 - 1.0) + 1.00001;\n\t// #ifdef LAYA_COLORSPACE_GAMMA\n\t\t// Tighter approximation for Gamma only rendering mode!\n\t\t// DVF = sqrt(DVF);\n\t\t// DVF = (a * sqrt(.25)) / (max(sqrt(0.1), lh)*sqrt(roughness + .5) * d);\n\t\tfloat specularTerm = a / (max(0.32, lh) * (1.5 + roughness) * d);\n\t// #else\n\t// \tfloat specularTerm = a2 / (max(0.1f, lh*lh) * (roughness + 0.5f) * (d * d) * 4);\n\t// #endif\n\n    // on mobiles (where half actually means something) denominator have risk of overflow\n    // clamp below was added specifically to \"fix\" that, but dx compiler (we convert bytecode to metal/gles)\n    // sees that specularTerm have only non-negative terms, so it skips max(0,..) in clamp (leaving only min(100,...))\n\n\t//#if defined (SHADER_API_MOBILE)\n    specularTerm = specularTerm - 1e-4;\n\t//#endif\n\n\t// #else\n\t\t// // Legacy\n\t\t// half specularPower = PerceptualRoughnessToSpecPower(perceptualRoughness);\n\t\t// // Modified with approximate Visibility function that takes roughness into account\n\t\t// // Original ((n+1)*N.H^n) / (8*Pi * L.H^3) didn't take into account roughness\n\t\t// // and produced extremely bright specular at grazing angles\n\n\t\t// half invV = lh * lh * smoothness + perceptualRoughness * perceptualRoughness; // approx ModifiedKelemenVisibilityTerm(lh, perceptualRoughness);\n\t\t// half invF = lh;\n\n\t\t// half specularTerm = ((specularPower + 1) * pow (nh, specularPower)) / (8 * invV * invF + 1e-4h);\n\n\t\t// #ifdef LAYA_COLORSPACE_GAMMA\n\t\t// \tspecularTerm = sqrt(max(1e-4f, specularTerm));\n\t\t// #endif\n\t// #endif\n\n\t// #if defined (SHADER_API_MOBILE)\n\t\tspecularTerm = clamp(specularTerm, 0.0, 100.0); // Prevent FP16 overflow on mobiles\n\t// #endif\n    \n    mediump vec3 color = (diffColor + specularTerm * specColor) * light.color * nl;\n\n    return vec4(color, 1.0);\n}\n\nmediump vec4 layaBRDFLowGI (mediump vec3 diffColor, mediump vec3 specColor,mediump float oneMinusReflectivity,mediump float smoothness,float perceptualRoughness,float roughness,mediump float nv,vec3 normal,vec3 viewDir,LayaGI gi)\n{\n\t// surfaceReduction = Int D(NdotH) * NdotH * Id(NdotL>0) dH = 1/(realRoughness^2+1)\n\n    // 1-0.28*x^3 as approximation for (1/(x^4+1))^(1/2.2) on the domain [0;1]\n    // 1-x^3*(0.6-0.08*x)   approximation for 1/(x^4+1)\n\t// #ifdef LAYA_COLORSPACE_GAMMA\n\t\tmediump float surfaceReduction = 0.28;\n\t// #else\n\t\t// mediump float surfaceReduction = (0.6-0.08*perceptualRoughness);\n\t// #endif\n\n    surfaceReduction = 1.0 - roughness*perceptualRoughness*surfaceReduction;\n\n\tmediump float grazingTerm = clamp(smoothness + (1.0-oneMinusReflectivity),0.0,1.0);\n\tmediump vec3 color =gi.diffuse * diffColor+ surfaceReduction * gi.specular * fresnelLerpFast (specColor, vec3(grazingTerm), nv);\n\n    return vec4(color, 1.0);\n}\n// BRDF2-------------------------------------------------------------------------------------";var PBRCore="struct FragmentCommonData{\n\tvec3 diffColor;\n\tvec3 specColor;\n\tfloat oneMinusReflectivity;\n\tfloat smoothness;\n\t//vec3 eyeVec;TODO:maybe can remove\n\t//float alpha;\n\t//vec3 reflUVW;\n};\n\n#ifndef SETUP_BRDF_INPUT\n    #define SETUP_BRDF_INPUT metallicSetup//default is metallicSetup,also can be other. \n#endif\n\nconst mediump vec4 dielectricSpecularColor = vec4(0.220916301, 0.220916301, 0.220916301, 1.0 - 0.220916301);\n\nmediump vec3 diffuseAndSpecularFromMetallic(mediump vec3 albedo,mediump float metallic, out mediump vec3 specColor, out mediump float oneMinusReflectivity)\n{\n\tspecColor = mix(dielectricSpecularColor.rgb, albedo, metallic);\n\toneMinusReflectivity= dielectricSpecularColor.a*(1.0-metallic);//diffuse proportion\n\treturn albedo * oneMinusReflectivity;\n}\n\nmediump float specularStrength(mediump vec3 specular)\n{\n    return max (max (specular.r, specular.g), specular.b);\n}\n\n// Diffuse/Spec Energy conservation\nmediump vec3 energyConservationBetweenDiffuseAndSpecular (mediump vec3 albedo, mediump vec3 specColor, out mediump float oneMinusReflectivity)\n{\n\toneMinusReflectivity = 1.0 - specularStrength(specColor);\n    return albedo * (vec3(1.0) - specColor);\n}\n\n#ifdef TRANSPARENTBLEND\n\tmediump vec3 preMultiplyAlpha (mediump vec3 diffColor, mediump float alpha, mediump float oneMinusReflectivity,out mediump float modifiedAlpha)\n\t{\n\t\t// Transparency 'removes' from Diffuse component\n\t\tdiffColor *= alpha;\n\t\t// Reflectivity 'removes' from the rest of components, including Transparency\n\t\t// modifiedAlpha = 1.0-(1.0-alpha)*(1.0-reflectivity) = 1.0-(oneMinusReflectivity - alpha*oneMinusReflectivity) = 1.0-oneMinusReflectivity + alpha*oneMinusReflectivity\n\t\tmodifiedAlpha = 1.0 - oneMinusReflectivity + alpha*oneMinusReflectivity;\n\t\treturn diffColor;\n\t}\n#endif\n\nFragmentCommonData metallicSetup(vec2 uv)\n{\n\tmediump vec2 metallicGloss = getMetallicGloss(uv);\n\tmediump float metallic = metallicGloss.x;\n\tmediump float smoothness = metallicGloss.y; // this is 1 minus the square root of real roughness m.\n\tmediump float oneMinusReflectivity;\n\tmediump vec3 specColor;\n\tmediump vec3 diffColor = diffuseAndSpecularFromMetallic(albedo(uv), metallic,/*out*/specColor,/*out*/oneMinusReflectivity);\n\n\tFragmentCommonData o;\n\to.diffColor = diffColor;\n\to.specColor = specColor;\n\to.oneMinusReflectivity = oneMinusReflectivity;\n\to.smoothness = smoothness;\n\treturn o;\n}\n\nFragmentCommonData specularSetup(vec2 uv)\n{\n    mediump vec4 specGloss = specularGloss(uv);\n    mediump vec3 specColor = specGloss.rgb;\n    mediump float smoothness = specGloss.a;\n\n    mediump float oneMinusReflectivity;\n    mediump vec3 diffColor = energyConservationBetweenDiffuseAndSpecular (albedo(uv), specColor, /*out*/ oneMinusReflectivity);\n\n    FragmentCommonData o;\n    o.diffColor = diffColor;\n    o.specColor = specColor;\n    o.oneMinusReflectivity = oneMinusReflectivity;\n    o.smoothness = smoothness;\n    return o;\n}\n\nLayaGI fragmentGI(float smoothness,vec3 eyeVec,mediump float occlusion,mediump vec2 lightmapUV,vec3 worldnormal)\n{\n\tLayaGIInput giInput;\n\t#ifdef LIGHTMAP\n\t\tgiInput.lightmapUV=lightmapUV;\n\t#endif\n\n\tvec3 worldViewDir = -eyeVec;\n\tmediump vec4 uvwRoughness;\n\tuvwRoughness.rgb = reflect(worldViewDir, worldnormal);//reflectUVW\n\tuvwRoughness.a= smoothnessToPerceptualRoughness(smoothness);//perceptualRoughness\n\n\treturn layaGlobalIllumination(giInput,occlusion, worldnormal, uvwRoughness);\n}\n\n\nvec3 perPixelWorldNormal(vec2 uv,vec3 normal,vec3 binormal,vec3 tangent)\n{\n\t#ifdef NORMALTEXTURE\n\t\tmediump vec3 normalTangent=normalInTangentSpace(uv);\n\t\tvec3 normalWorld = normalize(tangent * normalTangent.x + binormal * normalTangent.y + normal * normalTangent.z);\n\t#else\n\t\tvec3 normalWorld = normalize(normal);\n\t#endif\n\t\treturn normalWorld;\n}\n\nvoid fragmentForward()\n{\n\tvec2 uv;\n\t#if defined(ALBEDOTEXTURE)||defined(METALLICGLOSSTEXTURE)||defined(NORMALTEXTURE)||defined(EMISSIONTEXTURE)||defined(OCCLUSIONTEXTURE)||defined(PARALLAXTEXTURE)\n\t\t#ifdef PARALLAXTEXTURE\n\t\t\tuv = parallax(v_Texcoord0,normalize(v_ViewDirForParallax));\n\t\t#else\n\t\t\tuv = v_Texcoord0;\n\t\t#endif\n\t#endif\n\n\tmediump float alpha = getAlpha(uv);\n\t#ifdef ALPHATEST\n\t\tif(alpha<u_AlphaTestValue)\n\t\t\tdiscard;\n\t#endif\n\n\tFragmentCommonData o = SETUP_BRDF_INPUT(uv);\n\t\n\tvec3 binormal;\n\tvec3 tangent;\n\t#ifdef NORMALTEXTURE\n\t\ttangent = v_Tangent;\n\t\tbinormal = v_Binormal;\n\t#endif\n\n\tvec3 normal = v_Normal;\n\tvec3 normalWorld = perPixelWorldNormal(uv,normal,binormal,tangent);//In FS if the normal use mediump before normalize will cause precision prolem in mobile device.\n\tvec3 eyeVec = normalize(v_EyeVec);\n\tvec3 posworld = v_PositionWorld;\n\n\t#ifdef TRANSPARENTBLEND\n\t\to.diffColor=preMultiplyAlpha(o.diffColor,alpha,o.oneMinusReflectivity,/*out*/alpha);// shader relies on pre-multiply alpha-blend (srcBlend = One, dstBlend = OneMinusSrcAlpha)\n\t#endif\n\n\tmediump float occlusion = getOcclusion(uv);\n\tmediump vec2 lightMapUV;\n\t#ifdef LIGHTMAP\n\t\tlightMapUV=v_LightMapUV;\n\t#endif\n\tfloat perceptualRoughness = smoothnessToPerceptualRoughness(o.smoothness);\n\tfloat roughness = perceptualRoughnessToRoughness(perceptualRoughness);\n\tfloat nv = abs(dot(normalWorld, eyeVec));\n\tLayaGI gi =fragmentGI(o.smoothness,eyeVec,occlusion,lightMapUV,normalWorld);\n\tvec4 color = LAYA_BRDF_GI(o.diffColor,o.specColor,o.oneMinusReflectivity,o.smoothness,perceptualRoughness,roughness,nv,normalWorld,eyeVec,gi);\n\t\n\tfloat shadowAttenuation = 1.0;\n\t#ifdef LEGACYSINGLELIGHTING\n\t\t#ifdef DIRECTIONLIGHT\n\t\t\t#ifdef CALCULATE_SHADOWS\n\t\t\t\t#ifdef SHADOW_CASCADE\n\t\t\t\t\tvec4 shadowCoord = getShadowCoord(vec4(v_PositionWorld,1.0));\n\t\t\t\t#else\n\t\t\t\t\tvec4 shadowCoord = v_ShadowCoord;\n\t\t\t\t#endif\n\t\t\t\tshadowAttenuation=sampleShadowmap(shadowCoord);\n\t\t\t#endif\n\t\t\tLayaLight dirLight = layaDirectionLightToLight(u_DirectionLight,shadowAttenuation);\n\t\t\tcolor+= LAYA_BRDF_LIGHT(o.diffColor,o.specColor,o.oneMinusReflectivity,perceptualRoughness,roughness,nv,normalWorld,eyeVec,dirLight);\n\t\t#endif\n\t\n\t\t#ifdef POINTLIGHT\n\t\t\tshadowAttenuation = 1.0;\n\t\t\tLayaLight poiLight = layaPointLightToLight(posworld,normalWorld,u_PointLight,shadowAttenuation);\n\t\t\tcolor+= LAYA_BRDF_LIGHT(o.diffColor,o.specColor,o.oneMinusReflectivity,perceptualRoughness,roughness,nv,normalWorld,eyeVec,poiLight);\n\t\t#endif\n\t\t\n\t\t#ifdef SPOTLIGHT\n\t\t\tshadowAttenuation = 1.0;\n\t\t\t#ifdef CALCULATE_SPOTSHADOWS\n\t\t\t\tvec4 spotShadowcoord = v_SpotShadowCoord;\n\t\t\t\tshadowAttenuation = sampleSpotShadowmap(spotShadowcoord);\n\t\t\t#endif\n\t\t    LayaLight spoLight = layaSpotLightToLight(posworld,normalWorld,u_SpotLight,shadowAttenuation);\n\t\t\tcolor+= LAYA_BRDF_LIGHT(o.diffColor,o.specColor,o.oneMinusReflectivity,perceptualRoughness,roughness,nv,normalWorld,eyeVec,spoLight);\n\t\t#endif\n\t#else\n\t \t#ifdef DIRECTIONLIGHT\n\t\t\tfor (int i = 0; i < MAX_LIGHT_COUNT; i++) \n\t\t\t{\n\t\t\t\tshadowAttenuation = 1.0;\n\t\t\t\tif(i >= u_DirationLightCount)\n\t\t\t\t\tbreak;\n\t\t\t\t#ifdef CALCULATE_SHADOWS\n\t\t\t\t\tif(i == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t#ifdef SHADOW_CASCADE\n\t\t\t\t\t\t\tvec4 shadowCoord = getShadowCoord(vec4(v_PositionWorld,1.0));\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tvec4 shadowCoord = v_ShadowCoord;\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\tshadowAttenuation *= sampleShadowmap(shadowCoord);\n\t\t\t\t\t}\n\t\t\t\t#endif\n\t\t\t\tDirectionLight directionLight = getDirectionLight(u_LightBuffer,i);\n\t\t\t\tLayaLight dirLight = layaDirectionLightToLight(directionLight,shadowAttenuation);\n\t\t\t \tcolor+=LAYA_BRDF_LIGHT(o.diffColor,o.specColor,o.oneMinusReflectivity,perceptualRoughness,roughness,nv,normalWorld,eyeVec,dirLight);\n\t\t\t}\n\t \t#endif\n\t\t#if defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\t\tivec4 clusterInfo =getClusterInfo(u_LightClusterBuffer,u_View,u_Viewport, v_PositionWorld,gl_FragCoord,u_ProjectionParams);\n\t\t\t#ifdef POINTLIGHT\n\t\t\t\tfor (int i = 0; i < MAX_LIGHT_COUNT; i++) \n\t\t\t\t{\n\t\t\t\t\tshadowAttenuation = 1.0;\n\t\t\t\t\tif(i >= clusterInfo.x)//PointLightCount\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tPointLight pointLight = getPointLight(u_LightBuffer,u_LightClusterBuffer,clusterInfo,i);\n\t\t\t\t\tLayaLight poiLight = layaPointLightToLight(posworld,normalWorld,pointLight,shadowAttenuation);\n\t\t\t\t\tcolor+= LAYA_BRDF_LIGHT(o.diffColor,o.specColor,o.oneMinusReflectivity,perceptualRoughness,roughness,nv,normalWorld,eyeVec,poiLight);\n\t\t\t\t}\n\t\t\t#endif\n\t\t\t#ifdef SPOTLIGHT\n\t\t\t\tfor (int i = 0; i < MAX_LIGHT_COUNT; i++) \n\t\t\t\t{\n\t\t\t\t\tshadowAttenuation = 1.0;\n\t\t\t\t\tif(i >= clusterInfo.y)//SpotLightCount\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t#ifdef CALCULATE_SPOTSHADOWS\n\t\t\t\t\t\tif(i == 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvec4 spotShadowcoord = v_SpotShadowCoord;\n\t\t\t\t\t\t\tshadowAttenuation= sampleSpotShadowmap(spotShadowcoord);\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\t\t\t\t\tSpotLight spotLight = getSpotLight(u_LightBuffer,u_LightClusterBuffer,clusterInfo,i);\n\t\t\t\t\tLayaLight spoLight = layaSpotLightToLight(posworld,normalWorld,spotLight,shadowAttenuation);\n\t\t\t\t\tcolor+= LAYA_BRDF_LIGHT(o.diffColor,o.specColor,o.oneMinusReflectivity,perceptualRoughness,roughness,nv,normalWorld,eyeVec,spoLight);\n\t\t\t\t}\n\t\t\t#endif\n\t\t#endif\n\t #endif\n\n\t#ifdef EMISSION\n\t\tcolor.rgb += emission(uv);\n\t#endif\n\n\t#ifdef FOG\n\t\tfloat lerpFact=clamp((1.0/gl_FragCoord.w-u_FogStart)/u_FogRange,0.0,1.0);\n\t\tcolor.rgb=mix(color.rgb,u_FogColor,lerpFact);\n\t#endif\n\t\n\tgl_FragColor=vec4(color.rgb,alpha);\n}\n\n\n";var PBRVSInput="attribute vec4 a_Position;\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_MvpMatrix;\n\tattribute mat4 a_WorldMat;\n#else\n\tuniform mat4 u_MvpMatrix;\n\tuniform mat4 u_WorldMat;\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\nattribute vec3 a_Normal;\nvarying vec3 v_Normal; \n\n#if defined(NORMALTEXTURE)||defined(PARALLAXTEXTURE)\n\tattribute vec4 a_Tangent0;\n\tvarying vec3 v_Tangent;\n\tvarying vec3 v_Binormal;\n    #ifdef PARALLAXTEXTURE\n\t    varying vec3 v_ViewDirForParallax;\n    #endif\n#endif\n\n#if defined(ALBEDOTEXTURE)||defined(METALLICGLOSSTEXTURE)||defined(NORMALTEXTURE)||defined(EMISSIONTEXTURE)||defined(OCCLUSIONTEXTURE)||defined(PARALLAXTEXTURE)||(defined(LIGHTMAP)&&defined(UV))\n\tattribute vec2 a_Texcoord0;\n\tvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(LIGHTMAP)&&defined(UV1)\n\tattribute vec2 a_Texcoord1;\n#endif\n\n#ifdef LIGHTMAP\n\tuniform vec4 u_LightmapScaleOffset;\n\tvarying vec2 v_LightMapUV;\n#endif\n\nuniform vec3 u_CameraPos;\nvarying vec3 v_EyeVec;\nvarying vec3 v_PositionWorld;\nvarying float v_posViewZ;\n\n#if defined(CALCULATE_SHADOWS)&&!defined(SHADOW_CASCADE)\n\tvarying vec4 v_ShadowCoord;\n#endif\n\n#ifdef CALCULATE_SPOTSHADOWS\n\tvarying vec4 v_SpotShadowCoord;\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\n\n#ifdef SIMPLEBONE\n\t#ifdef GPU_INSTANCE\n\t\tattribute vec4 a_SimpleTextureParams;\n\t#else\n\t\tuniform vec4 u_SimpleAnimatorParams;\n\t#endif\n\tuniform sampler2D u_SimpleAnimatorTexture;\n\n\tuniform float u_SimpleAnimatorTextureSize; \n#endif\n\n\n#ifdef SIMPLEBONE\nmat4 loadMatFromTexture(float FramePos,int boneIndices,float offset)\n{\n\tvec2 uv;\n\tfloat PixelPos = FramePos+float(boneIndices)*4.0;\n\tfloat halfOffset = offset * 0.5;\n\tfloat uvoffset = PixelPos/u_SimpleAnimatorTextureSize;\n\tuv.y = floor(uvoffset)*offset+halfOffset;\n\tuv.x = mod(float(PixelPos),u_SimpleAnimatorTextureSize)*offset+halfOffset;\n\tvec4 mat0row = texture2D(u_SimpleAnimatorTexture,uv);\n\tuv.x+=offset;\n\tvec4 mat1row = texture2D(u_SimpleAnimatorTexture,uv);\n\tuv.x+=offset;\n\tvec4 mat2row = texture2D(u_SimpleAnimatorTexture,uv);\n\tuv.x+=offset;\n\tvec4 mat3row = texture2D(u_SimpleAnimatorTexture,uv);\n\tmat4 m =mat4(mat0row.x,mat0row.y,mat0row.z,mat0row.w,\n\t\t\t  mat1row.x,mat1row.y,mat1row.z,mat1row.w,\n\t\t\t  mat2row.x,mat2row.y,mat2row.z,mat2row.w,\n\t\t\t  mat3row.x,mat3row.y,mat3row.z,mat3row.w);\n\treturn m;\n}\n#endif";var PBRFSInput="#ifdef ALPHATEST\n\tuniform float u_AlphaTestValue;\n#endif\n\nuniform vec4 u_AlbedoColor;\n\n#ifdef NORMALTEXTURE\n\tuniform sampler2D u_NormalTexture;\n\tuniform float u_NormalScale;\n#endif\n\n#ifdef ALBEDOTEXTURE\n\tuniform sampler2D u_AlbedoTexture;\n#endif\n\n#ifdef METALLICGLOSSTEXTURE\n\tuniform sampler2D u_MetallicGlossTexture;\n#endif\nuniform float u_Metallic;\n\n#ifdef SPECULARGLOSSTEXTURE\n\tuniform sampler2D u_SpecGlossTexture;\n#endif\nuniform vec3 u_SpecularColor;\n\nuniform float u_Smoothness;\nuniform float u_SmoothnessScale;\n\n#ifdef PARALLAXTEXTURE\n\tuniform sampler2D u_ParallaxTexture;\n\tuniform float u_ParallaxScale;\n\tvarying vec3 v_ViewDirForParallax;\n#endif\n\n#ifdef OCCLUSIONTEXTURE\n\tuniform sampler2D u_OcclusionTexture;\n\tuniform float u_occlusionStrength;\n#endif\n\n#ifdef EMISSION \n\t#ifdef EMISSIONTEXTURE\n\t\tuniform sampler2D u_EmissionTexture;\n\t#endif\n\tuniform vec4 u_EmissionColor;\n#endif\n\n#if defined(ALBEDOTEXTURE)||defined(METALLICGLOSSTEXTURE)||defined(NORMALTEXTURE)||defined(EMISSIONTEXTURE)||defined(OCCLUSIONTEXTURE)||defined(PARALLAXTEXTURE)\n\tvarying vec2 v_Texcoord0;\n#endif\n\n#ifdef LIGHTMAP\n\tvarying vec2 v_LightMapUV;\n\tuniform sampler2D u_LightMap;\n\t#ifdef LIGHTMAP_DIRECTIONAL\n\t\tuniform sampler2D u_LightMapDirection;\n\t#endif\n#endif\n\nvarying vec3 v_Normal; \n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#ifdef LEGACYSINGLELIGHTING\n\t\t#ifdef DIRECTIONLIGHT\n\t\t\tuniform DirectionLight u_DirectionLight;\n\t\t#endif\n\t\t#ifdef POINTLIGHT\n\t\t\tuniform PointLight u_PointLight;\n\t\t#endif\n\t\t#ifdef SPOTLIGHT\n\t\t\tuniform SpotLight u_SpotLight;\n\t\t#endif\n\t#else\n\t\tuniform mat4 u_View;\n\t\tuniform vec4 u_ProjectionParams;\n\t\tuniform vec4 u_Viewport;\n\t\tuniform int u_DirationLightCount;\n\t\tuniform sampler2D u_LightBuffer;\n\t\tuniform sampler2D u_LightClusterBuffer;\n\t#endif\n#endif\n\nvarying vec3 v_EyeVec;\n\n#ifdef NORMALTEXTURE\n\tvarying vec3 v_Tangent;\n\tvarying vec3 v_Binormal;\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\tuniform vec3 u_FogColor;\n#endif\n\n\n//后面考虑宏TODO\nvarying vec3 v_PositionWorld;\n\n#if defined(CALCULATE_SHADOWS)&&!defined(SHADOW_CASCADE)\n\tvarying vec4 v_ShadowCoord;\n#endif\n\n#ifdef CALCULATE_SPOTSHADOWS\n\tvarying vec4 v_SpotShadowCoord;\n#endif\n\nmediump float lerpOneTo(mediump float b, mediump float t)\n{\n    mediump float oneMinusT = 1.0 - t;\n    return oneMinusT + b * t;\n}\n\n#ifdef EMISSION \n\tvec3 emission(vec2 uv)\n\t{\n\t\t#ifdef EMISSIONTEXTURE\n\t\t\treturn texture2D(u_EmissionTexture, uv).rgb * u_EmissionColor.rgb;\n\t\t#else\n\t\t\treturn u_EmissionColor.rgb;\n\t\t#endif\n\t}\n#endif\n\nmediump float getAlpha(vec2 uv)\n{\n\t#ifdef SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA\n\t\treturn u_AlbedoColor.a;\n\t#else\n\t\t#ifdef ALBEDOTEXTURE\n\t\t\treturn texture2D(u_AlbedoTexture, uv).a * u_AlbedoColor.a;\n\t\t#else\n\t\t\treturn u_AlbedoColor.a;\n\t\t#endif\n\t#endif\n}\n\nmediump float getOcclusion(vec2 uv)\n{\n\t#ifdef OCCLUSIONTEXTURE\n\t\tmediump float occ = texture2D(u_OcclusionTexture, uv).g;\n\t\treturn lerpOneTo(occ, u_occlusionStrength);\n\t#else\n\t\treturn 1.0;\n\t#endif\n}\n\nmediump vec3 albedo(vec2 uv)\n{\n\t#ifdef ALBEDOTEXTURE\n\t\treturn u_AlbedoColor.rgb * texture2D(u_AlbedoTexture, uv).rgb;\n\t#else\n\t\treturn u_AlbedoColor.rgb;\n\t#endif\n\t//TODO:Detail Texture\n}\n\nmediump vec2 getMetallicGloss(vec2 uv)\n{\n\tmediump vec2 ms;//x is metallic,y is smoothness\n\t#ifdef METALLICGLOSSTEXTURE\n\t\t#ifdef SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA\n\t\t\tms.x = texture2D(u_MetallicGlossTexture, uv).r;\n\t\t\t#ifdef ALBEDOTEXTURE\n\t\t\t\tms.y = texture2D(u_AlbedoTexture, uv).a*u_SmoothnessScale;\n\t\t\t#else\n\t\t\t\tms.y = u_SmoothnessScale;\n\t\t\t#endif\n\t\t#else\n\t\t\tms = texture2D(u_MetallicGlossTexture, uv).ra;\n\t\t\tms.y *= u_SmoothnessScale;\n\t\t#endif\n\t#else\n\t\tms.x = u_Metallic;\n\t\t#ifdef SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA\n\t\t\t#ifdef ALBEDOTEXTURE\n\t\t\t\tms.y = texture2D(u_AlbedoTexture, uv).a * u_SmoothnessScale;\n\t\t\t#else\n\t\t\t\tms.y = u_SmoothnessScale;\n\t\t\t#endif\n\t\t#else\n\t\t\tms.y = u_Smoothness;\n\t\t#endif\n\t#endif\n\treturn ms;\n}\n\nmediump vec4 specularGloss(vec2 uv)\n{\n\tmediump vec4 sg;\n\t#ifdef SPECULARGLOSSTEXTURE\n\t\t#ifdef SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA\n\t\t\tsg.rgb = texture2D(u_SpecGlossTexture, uv).rgb;\n\t\t\t#ifdef ALBEDOTEXTURE\n\t\t\t\tsg.a = texture2D(u_AlbedoTexture, uv).a*u_SmoothnessScale;\n\t\t\t#else\n\t\t\t\tsg.a = u_SmoothnessScale;\n\t\t\t#endif\n\t\t#else\n\t\t\tsg = texture2D(u_SpecGlossTexture, uv);\n\t\t\tsg.a *= u_SmoothnessScale;\n\t\t#endif\n\t#else\n\t\tsg.rgb = u_SpecularColor.rgb;\n\t\t#ifdef SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA\n\t\t\t#ifdef ALBEDOTEXTURE\n\t\t\t\tsg.a = texture2D(u_AlbedoTexture, uv).a * u_SmoothnessScale;\n\t\t\t#else\n\t\t\t\tsg.a = u_SmoothnessScale;\n\t\t\t#endif\n\t\t#else\n\t\t\tsg.a = u_Smoothness;\n\t\t#endif\n\t#endif\n\t\treturn sg;\n}\n\n\n#ifdef NORMALTEXTURE\n\tmediump vec3 unpackScaleNormal(mediump vec3 packednormal, mediump float bumpScale)\n\t{\n\t\tmediump vec3 normal = packednormal.xyz * 2.0 - 1.0;\n\t\tnormal.y=-normal.y;//NOTE:because unity to LayaAir coordSystem.\n\t\tnormal.xy *= bumpScale;\n\t\treturn normal;\n\t}\n\t\n\tmediump vec3 normalInTangentSpace(vec2 texcoords)\n\t{\n\t\tmediump vec3 normalTangent = unpackScaleNormal(texture2D(u_NormalTexture, texcoords).rgb,u_NormalScale);\n\t\treturn normalTangent;\n\t}\n#endif\n\n#ifdef PARALLAXTEXTURE\n\tmediump vec2 parallaxOffset1Step(mediump float h, mediump float height, mediump vec3 viewDir)\n\t{\n\t\th = h * height - height / 2.0;\n\t\tviewDir.z += 0.42;\n\t\treturn h * (viewDir.xy / viewDir.z);\n\t}\n\n\tvec2 parallax(vec2 texcoords, mediump vec3 viewDir)\n\t{\n\t\tmediump float h = texture2D(u_ParallaxTexture, texcoords.xy).g;\n\t\tvec2 offset = parallaxOffset1Step(h, u_ParallaxScale, viewDir);\n\t\treturn texcoords+offset;\n\t}\n#endif\n\n\n\n\n\n\n\n\n";var PBRVertex="vec2 transformLightMapUV(in vec2 texcoord,in vec4 lightmapScaleOffset)\n{\n\tvec2 lightMapUV=vec2(texcoord.x,1.0-texcoord.y)*lightmapScaleOffset.xy+lightmapScaleOffset.zw;\n\tlightMapUV.y=1.0-lightMapUV.y;\n\treturn lightMapUV; \n}\n\nvoid vertexForward()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform;\n\t \t#ifdef SIMPLEBONE\n\t\t\tfloat currentPixelPos;\n\t\t\t#ifdef GPU_INSTANCE\n\t\t\t\tcurrentPixelPos = a_SimpleTextureParams.x+a_SimpleTextureParams.y;\n\t\t\t#else\n\t\t\t\tcurrentPixelPos = u_SimpleAnimatorParams.x+u_SimpleAnimatorParams.y;\n\t\t\t#endif\n\t\t\tfloat offset = 1.0/u_SimpleAnimatorTextureSize;\n\t\t\tskinTransform =  loadMatFromTexture(currentPixelPos,int(a_BoneIndices.x),offset) * a_BoneWeights.x;\n\t\t\tskinTransform += loadMatFromTexture(currentPixelPos,int(a_BoneIndices.y),offset) * a_BoneWeights.y;\n\t\t\tskinTransform += loadMatFromTexture(currentPixelPos,int(a_BoneIndices.z),offset) * a_BoneWeights.z;\n\t\t\tskinTransform += loadMatFromTexture(currentPixelPos,int(a_BoneIndices.w),offset) * a_BoneWeights.w;\n\t\t#else\n\t\t\tskinTransform =  u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\t#endif\n\t\tposition=skinTransform*a_Position;\n\t #else\n\t\tposition=a_Position;\n\t#endif\n\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\n\tmat4 worldMat;\n\t#ifdef GPU_INSTANCE\n\t\tworldMat = a_WorldMat;\n\t#else\n\t\tworldMat = u_WorldMat;\n\t#endif\n\n\tv_PositionWorld=(worldMat*position).xyz;\n\n\t#if defined(ALBEDOTEXTURE)||defined(METALLICGLOSSTEXTURE)||defined(NORMALTEXTURE)||defined(EMISSIONTEXTURE)||defined(OCCLUSIONTEXTURE)||defined(PARALLAXTEXTURE)\n\t\t#ifdef TILINGOFFSET\n\t\t\tv_Texcoord0=TransformUV(a_Texcoord0,u_TilingOffset);\n\t\t#else\n\t\t\tv_Texcoord0=a_Texcoord0;\n\t\t#endif\n\t#endif\n\n\tv_EyeVec =u_CameraPos-v_PositionWorld;//will normalize per-pixel\n\n\t#ifdef LIGHTMAP\n\t\tvec2 texcoord;\n\t\t#ifdef UV1\n\t\t\ttexcoord=a_Texcoord1;\n\t\t#else\n\t\t\ttexcoord=a_Texcoord0;\n\t\t#endif\n\t\tv_LightMapUV=transformLightMapUV(texcoord,u_LightmapScaleOffset);\n\t#endif\n\n\tmat3 worldInvMat;\n\t#ifdef BONE\n\t\tworldInvMat=INVERSE_MAT(mat3(worldMat*skinTransform));\n\t#else\n\t\tworldInvMat=INVERSE_MAT(mat3(worldMat));\n\t#endif\n\n\tv_Normal=normalize(a_Normal*worldInvMat);//if no normalize will cause precision problem.\n\n\t#ifdef NORMALTEXTURE\n\t\tv_Tangent=normalize(a_Tangent0.xyz*worldInvMat);\n\t\tv_Binormal=cross(v_Normal,v_Tangent)*a_Tangent0.w;\n\t#endif\n\n\t#ifdef PARALLAXTEXTURE\n\t\tvec3 binormal = cross(a_Normal, a_Tangent0.xyz)*a_Tangent0.w;\n\t\tmat3 objectTBN = mat3(a_Tangent0.xyz, binormal, a_Normal);\n\t\tv_ViewDirForParallax=(worldInvMat*u_CameraPos-position.xyz)*objectTBN;\n\t#endif\n\n\t#if defined(CALCULATE_SHADOWS)&&!defined(SHADOW_CASCADE)\n\t\tv_ShadowCoord = getShadowCoord(vec4(v_PositionWorld,1.0));\n\t#endif\n\n\t#ifdef CALCULATE_SPOTSHADOWS\n\t\tv_SpotShadowCoord = u_SpotViewProjectMatrix*vec4(v_PositionWorld,1.0);\n\t#endif\n}";var BloomVS="#include \"Lighting.glsl\";\n\nattribute vec4 a_PositionTexcoord;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_Position = vec4(a_PositionTexcoord.xy, 0.0, 1.0);\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}";var BloomDownsample13PS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include \"Colors.glsl\";\n#include \"Sampling.glsl\";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform vec4 u_MainTex_TexelSize;\n\nvoid fragDownsample13() {\n\tmediump vec4 color = downsampleBox13Tap(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy);\n\tgl_FragColor = color;\n}\n\nvoid main() {\n\tfragDownsample13();\n}";var BloomDownsample4PS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include \"Colors.glsl\";\n#include \"Sampling.glsl\";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform vec4 u_MainTex_TexelSize;\n\nvoid fragDownsample4() {\n\tmediump vec4 color = downsampleBox4Tap(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy);\n\tgl_FragColor = color;\n}\n\nvoid main() {\n\tfragDownsample4();\n}";var BloomPrefilter13PS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include \"Colors.glsl\";\n#include \"Sampling.glsl\";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_AutoExposureTex;\nuniform vec4 u_MainTex_TexelSize;\nuniform vec4 u_Threshold; // x: threshold value (linear), y: threshold - knee, z: knee * 2, w: 0.25 / knee\nuniform vec4 u_Params; // x: clamp, yzw: unused\n\nmediump vec4 prefilter(mediump vec4 color, vec2 uv) {\n\tmediump float autoExposure = texture2D(u_AutoExposureTex, uv).r;\n\tcolor *= autoExposure;\n\tcolor = min(vec4(u_Params.x), color); // clamp to max\n\tcolor = quadraticThreshold(color, u_Threshold.x, u_Threshold.yzw);\n\treturn color;\n}\n\nvoid fragPrefilter13() {\n\tmediump vec4 color = downsampleBox13Tap(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy);\n\tgl_FragColor = prefilter(safeHDR(color), v_Texcoord0);\n}\n\nvoid main() {\n\tfragPrefilter13();\n}";var BloomPrefilter4PS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include \"Colors.glsl\";\n#include \"Sampling.glsl\";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_AutoExposureTex;\nuniform vec4 u_MainTex_TexelSize;\nuniform vec4 u_Threshold; // x: threshold value (linear), y: threshold - knee, z: knee * 2, w: 0.25 / knee\nuniform vec4 u_Params; // x: clamp, yzw: unused\n\nmediump vec4 prefilter(mediump vec4 color, vec2 uv) {\n\tmediump float autoExposure = texture2D(u_AutoExposureTex, uv).r;\n\tcolor *= autoExposure;\n\tcolor = min(vec4(u_Params.x), color); // clamp to max\n\tcolor = quadraticThreshold(color, u_Threshold.x, u_Threshold.yzw);\n\treturn color;\n}\n\nvoid fragPrefilter4() {\n\tmediump vec4 color = downsampleBox4Tap(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy);\n\tgl_FragColor = prefilter(safeHDR(color), v_Texcoord0);\n}\n\nvoid main() {\n\tfragPrefilter4();\n}";var BloomUpsampleBoxPS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include \"Colors.glsl\";\n#include \"Sampling.glsl\";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_BloomTex;\n\nuniform vec4 u_MainTex_TexelSize;\nuniform float u_SampleScale;\n\nmediump vec4 combine(mediump vec4 bloom, vec2 uv) {\n\tmediump vec4 color = texture2D(u_BloomTex, uv);\n\treturn bloom + color;\n}\n\nvoid fragUpsampleBox() {\n\tmediump vec4 bloom = upsampleBox(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy, vec4(u_SampleScale));\n\tgl_FragColor = combine(bloom, v_Texcoord0);\n}\n\nvoid main() {\n\tfragUpsampleBox();\n}";var BloomUpsampleTentPS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include \"Colors.glsl\";\n#include \"Sampling.glsl\";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_BloomTex;\n\nuniform vec4 u_MainTex_TexelSize;\nuniform float u_SampleScale;\n\nmediump vec4 combine(mediump vec4 bloom, vec2 uv) {\n\tmediump vec4 color = texture2D(u_BloomTex, uv);\n\treturn bloom + color;\n}\n\nvoid fragUpsampleTent() {\n\tmediump vec4 bloom = upsampleTent(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy, vec4(u_SampleScale));\n\tgl_FragColor = combine(bloom, v_Texcoord0);\n}\n\nvoid main() {\n\tfragUpsampleTent();\n}";var ColorsGLSL="#include \"StdLib.glsl\";\n\n#define EPSILON 1.0e-4\n\n// Quadratic color thresholding\n// curve = (threshold - knee, knee * 2, 0.25 / knee)\nmediump vec4 quadraticThreshold(mediump vec4 color, mediump float threshold, mediump vec3 curve) {\n\t// Pixel brightness\n\tmediump float br = max3(color.r, color.g, color.b);\n\n\t// Under-threshold part: quadratic curve\n\tmediump float rq = clamp(br - curve.x, 0.0, curve.y);\n\trq = curve.z * rq * rq;\n\n\t// Combine and apply the brightness response curve.\n\tcolor *= max(rq, br - threshold) / max(br, EPSILON);\n\n\treturn color;\n}\n\n\n\n//\n// sRGB transfer functions\n// Fast path ref: http://chilliant.blogspot.com.au/2012/08/srgb-approximations-for-hlsl.html?m=1\n//\nmediump vec3 sRGBToLinear(mediump vec3 c) {\n\t#ifdef USE_VERY_FAST_SRGB\n\t\treturn c * c;\n\t#elif defined(USE_FAST_SRGB)\n\t\treturn c * (c * (c * 0.305306011 + 0.682171111) + 0.012522878);\n\t#else\n\t\tmediump vec3 linearRGBLo = c / 12.92;\n\t\tmediump vec3 power=vec3(2.4, 2.4, 2.4);\n\t\tmediump vec3 linearRGBHi = positivePow((c + 0.055) / 1.055, power);\n\t\tmediump vec3 linearRGB =vec3((c.r<=0.04045) ? linearRGBLo.r : linearRGBHi.r,(c.g<=0.04045) ? linearRGBLo.g : linearRGBHi.g,(c.b<=0.04045) ? linearRGBLo.b : linearRGBHi.b);\n\t\treturn linearRGB;\n\t#endif\n}\n\nmediump vec4 sRGBToLinear(mediump vec4 c){\n    return vec4(sRGBToLinear(c.rgb), c.a);\n}\n\n\n\nmediump vec3 linearToSRGB(mediump vec3 c) {\n\t#ifdef USE_VERY_FAST_SRGB\n\t\treturn sqrt(c);\n\t#elif defined(USE_FAST_SRGB)\n\t\treturn max(1.055 * PositivePow(c, 0.416666667) - 0.055, 0.0);\n\t#else\n\t\tmediump vec3 sRGBLo = c * 12.92;\n\t\tmediump vec3 power=vec3(1.0 / 2.4, 1.0 / 2.4, 1.0 / 2.4);\n\t\tmediump vec3 sRGBHi = (positivePow(c, power) * 1.055) - 0.055;\n\t\tmediump vec3 sRGB =vec3((c.r<=0.0031308) ? sRGBLo.r : sRGBHi.r,(c.g<=0.0031308) ? sRGBLo.g : sRGBHi.g,(c.b<=0.0031308) ? sRGBLo.b : sRGBHi.b);\n\t\treturn sRGB;\n\t#endif\n}\n\nmediump vec4 linearToSRGB(mediump vec4 c){\n    return vec4(linearToSRGB(c.rgb), c.a);\n}";var CompositePS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include \"Colors.glsl\";\n#include \"Sampling.glsl\";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_BloomTex;\n\nuniform sampler2D u_AutoExposureTex;\nuniform sampler2D u_Bloom_DirtTex;\nuniform vec4 u_BloomTex_TexelSize;\nuniform vec4 u_Bloom_DirtTileOffset; // xy: tiling, zw: offset\nuniform mediump vec3 u_Bloom_Settings;// x: sampleScale, y: intensity, z: dirt intensity\nuniform mediump vec3 u_Bloom_Color;\n\nvoid main() {\n\tmediump float autoExposure = texture2D(u_AutoExposureTex, v_Texcoord0).r;\n\tmediump vec4 color=vec4(0.0);\n\tcolor = texture2D(u_MainTex, v_Texcoord0);\n\t\n\tcolor = sRGBToLinear(color);\n\tcolor.rgb *= autoExposure;\n\t\n\t#if defined(BLOOM)||defined(BLOOM_LOW)\n\t\t#ifdef BLOOM\n\t\t\tmediump vec4 bloom = upsampleTent(u_BloomTex, v_Texcoord0, u_BloomTex_TexelSize.xy, vec4(u_Bloom_Settings.x));\n\t\t#else\n\t\t\tmediump vec4 bloom = upsampleBox(u_BloomTex, v_Texcoord0, u_BloomTex_TexelSize.xy, vec4(u_Bloom_Settings.x));\n\t\t#endif\n\n\t\t// UVs should be Distort(uv * u_Bloom_DirtTileOffset.xy + u_Bloom_DirtTileOffset.zw)\n\t\t// but considering we use a cover-style scale on the dirt texture the difference\n\t\t// isn't massive so we chose to save a few ALUs here instead in case lens distortion\n\t\t// is active\n\t\tmediump vec4 dirt =vec4(texture2D(u_Bloom_DirtTex, v_Texcoord0 * u_Bloom_DirtTileOffset.xy + u_Bloom_DirtTileOffset.zw).rgb, 0.0);\n\n\t\t// Additive bloom (artist friendly)\n\t\tbloom *= u_Bloom_Settings.y;\n\t\tdirt *= u_Bloom_Settings.z;\n\t\tmediump vec4 bloomColor=vec4(u_Bloom_Color, 1.0);\n\t\tcolor += bloom * bloomColor;\n\t\tcolor += dirt * bloom;\n\t#endif\n\t\n\tmediump vec4 finalColor = color;\n\tfinalColor = linearToSRGB(finalColor);\n\t//finalColor.rgb = Dither(finalColor.rgb, v_Texcoord0);//TODO:抖动\n\tgl_FragColor = finalColor;\n}";var CompositeVS="#include \"Lighting.glsl\";\n\nattribute vec4 a_PositionTexcoord;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_Position = vec4(a_PositionTexcoord.xy, 0.0, 1.0);\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}";var SamplingGLSL="// Better, temporally stable box filtering\n// [Jimenez14] http://goo.gl/eomGso\n// . . . . . . .\n// . A . B . C .\n// . . D . E . .\n// . F . G . H .\n// . . I . J . .\n// . K . L . M .\n// . . . . . . .\nmediump vec4 downsampleBox13Tap(sampler2D tex, vec2 uv, vec2 texelSize)\n{\n    mediump vec4 A = texture2D(tex, uv + texelSize * vec2(-1.0, -1.0));\n    mediump vec4 B = texture2D(tex, uv + texelSize * vec2( 0.0, -1.0));\n    mediump vec4 C = texture2D(tex, uv + texelSize * vec2( 1.0, -1.0));\n    mediump vec4 D = texture2D(tex, uv + texelSize * vec2(-0.5, -0.5));\n    mediump vec4 E = texture2D(tex, uv + texelSize * vec2( 0.5, -0.5));\n    mediump vec4 F = texture2D(tex, uv + texelSize * vec2(-1.0,  0.0));\n    mediump vec4 G = texture2D(tex, uv);\n    mediump vec4 H = texture2D(tex, uv + texelSize * vec2( 1.0,  0.0));\n    mediump vec4 I = texture2D(tex, uv + texelSize * vec2(-0.5,  0.5));\n    mediump vec4 J = texture2D(tex, uv + texelSize * vec2( 0.5,  0.5));\n    mediump vec4 K = texture2D(tex, uv + texelSize * vec2(-1.0,  1.0));\n    mediump vec4 L = texture2D(tex, uv + texelSize * vec2( 0.0,  1.0));\n    mediump vec4 M = texture2D(tex, uv + texelSize * vec2( 1.0,  1.0));\n\n\tmediump vec2 scale= vec2(0.5, 0.125);\n    mediump vec2 div = (1.0 / 4.0) * scale;\n\n    mediump vec4 o = (D + E + I + J) * div.x;\n    o += (A + B + G + F) * div.y;\n    o += (B + C + H + G) * div.y;\n    o += (F + G + L + K) * div.y;\n    o += (G + H + M + L) * div.y;\n\n    return o;\n}\n\n// Standard box filtering\nmediump vec4 downsampleBox4Tap(sampler2D tex, vec2 uv, vec2 texelSize)\n{\n    vec4 d = texelSize.xyxy * vec4(-1.0, -1.0, 1.0, 1.0);\n\n    mediump vec4 s =  texture2D(tex, uv + d.xy);\n    s += texture2D(tex, uv + d.zy);\n    s += texture2D(tex, uv + d.xw);\n    s += texture2D(tex, uv + d.zw);\n\n    return s * (1.0 / 4.0);\n}\n\n// 9-tap bilinear upsampler (tent filter)\n// . . . . . . .\n// . 1 . 2 . 1 .\n// . . . . . . .\n// . 2 . 4 . 2 .\n// . . . . . . .\n// . 1 . 2 . 1 .\n// . . . . . . .\nmediump vec4 upsampleTent(sampler2D tex, vec2 uv, vec2 texelSize, vec4 sampleScale)\n{\n    vec4 d = texelSize.xyxy * vec4(1.0, 1.0, -1.0, 0.0) * sampleScale;\n\n    mediump vec4 s =  texture2D(tex, uv - d.xy);\n    s += texture2D(tex, uv - d.wy) * 2.0;\n    s += texture2D(tex, uv - d.zy);\n\n    s += texture2D(tex, uv + d.zw) * 2.0;\n    s += texture2D(tex, uv) * 4.0;\n    s += texture2D(tex,\tuv + d.xw) * 2.0;\n\n    s += texture2D(tex, uv + d.zy);\n    s += texture2D(tex, uv + d.wy) * 2.0;\n    s += texture2D(tex, uv + d.xy);\n\n    return s * (1.0 / 16.0);\n}\n\n// Standard box filtering\nmediump vec4 upsampleBox(sampler2D tex, vec2 uv, vec2 texelSize, vec4 sampleScale)\n{\n    vec4 d = texelSize.xyxy * vec4(-1.0, -1.0, 1.0, 1.0) * 0.5 * sampleScale;\n\n    mediump vec4 s =  texture2D(tex, uv + d.xy);\n    s += texture2D(tex, uv + d.zy);\n    s += texture2D(tex, uv + d.xw);\n    s += texture2D(tex, uv + d.zw);\n\n    return s * (1.0 / 4.0);\n}";var StdLibGLSL="#define HALF_MAX       65504.0 // (2 - 2^-10) * 2^15\n\n#define FLT_EPSILON    1.192092896e-07 // Smallest positive number, such that 1.0 + FLT_EPSILON != 1.0\n\nmediump vec4 safeHDR(mediump vec4 c)\n{\n    return min(c, HALF_MAX);\n}\n\nfloat max3(float a, float b, float c)\n{\n    return max(max(a, b), c);\n}\n\nvec3 positivePow(vec3 base, vec3 power)\n{\n    return pow(max(abs(base), vec3(FLT_EPSILON, FLT_EPSILON, FLT_EPSILON)), power);\n}";var ShadowGLSL="#ifndef GRAPHICS_API_GLES3\n\t#define NO_NATIVE_SHADOWMAP\n#endif\n\n#ifdef NO_NATIVE_SHADOWMAP\n\t#define TEXTURE2D_SHADOW(textureName) uniform mediump sampler2D textureName\n\t#define SAMPLE_TEXTURE2D_SHADOW(textureName, coord3) (texture2D(textureName,coord3.xy).r<coord3.z?0.0:1.0)\n\t#define TEXTURE2D_SHADOW_PARAM(shadowMap) mediump sampler2D shadowMap\n#else\n\t#define TEXTURE2D_SHADOW(textureName) uniform mediump sampler2DShadow textureName\n\t#define SAMPLE_TEXTURE2D_SHADOW(textureName, coord3) textureLod(textureName,coord3,0.0)\n\t#define TEXTURE2D_SHADOW_PARAM(shadowMap) mediump sampler2DShadow shadowMap\n#endif\n\n#if defined(RECEIVESHADOW)&&defined(SHADOW)\n    #define CALCULATE_SHADOWS\n#endif\n\n#if defined(RECEIVESHADOW)&&defined(SHADOW_SPOT)\n\t#define CALCULATE_SPOTSHADOWS\n#endif\n\nuniform vec4 u_ShadowBias; // x: depth bias, y: normal bias\n\n#if defined(CALCULATE_SHADOWS)||defined(CALCULATE_SPOTSHADOWS)\n\t#include \"ShadowSampleTent.glsl\"\n\tuniform vec4 u_ShadowMapSize;\n\tuniform vec4 u_ShadowParams; // x: shadowStrength y: ShadowSpotLightStrength\n\n\t\n\tfloat sampleShdowMapFiltered4(TEXTURE2D_SHADOW_PARAM(shadowMap),vec3 shadowCoord,vec4 shadowMapSize)\n\t{\n\t\tfloat attenuation;\n\t\tvec4 attenuation4;\n\t\tvec2 offset=shadowMapSize.xy/2.0;\n\t\tvec3 shadowCoord0=shadowCoord + vec3(-offset,0.0);\n\t\tvec3 shadowCoord1=shadowCoord + vec3(offset.x,-offset.y,0.0);\n\t\tvec3 shadowCoord2=shadowCoord + vec3(-offset.x,offset.y,0.0);\n\t\tvec3 shadowCoord3=shadowCoord + vec3(offset,0.0);\n\t\tattenuation4.x = SAMPLE_TEXTURE2D_SHADOW(shadowMap, shadowCoord0);\n\t\tattenuation4.y = SAMPLE_TEXTURE2D_SHADOW(shadowMap, shadowCoord1);\n\t\tattenuation4.z = SAMPLE_TEXTURE2D_SHADOW(shadowMap, shadowCoord2);\n\t\tattenuation4.w = SAMPLE_TEXTURE2D_SHADOW(shadowMap, shadowCoord3);\n\t\tattenuation = dot(attenuation4, vec4(0.25));\n\t\treturn attenuation;\n\t}\n\n\tfloat sampleShdowMapFiltered9(TEXTURE2D_SHADOW_PARAM(shadowMap),vec3 shadowCoord,vec4 shadowmapSize)\n\t{\n\t\tfloat attenuation;\n\t\tfloat fetchesWeights[9];\n\t\tvec2 fetchesUV[9];\n\t\tsampleShadowComputeSamplesTent5x5(shadowmapSize, shadowCoord.xy, fetchesWeights, fetchesUV);\n\t\tattenuation = fetchesWeights[0] * SAMPLE_TEXTURE2D_SHADOW(shadowMap, vec3(fetchesUV[0].xy, shadowCoord.z));\n\t\tattenuation += fetchesWeights[1] * SAMPLE_TEXTURE2D_SHADOW(shadowMap, vec3(fetchesUV[1].xy, shadowCoord.z));\n\t\tattenuation += fetchesWeights[2] * SAMPLE_TEXTURE2D_SHADOW(shadowMap, vec3(fetchesUV[2].xy, shadowCoord.z));\n\t\tattenuation += fetchesWeights[3] * SAMPLE_TEXTURE2D_SHADOW(shadowMap, vec3(fetchesUV[3].xy, shadowCoord.z));\n\t\tattenuation += fetchesWeights[4] * SAMPLE_TEXTURE2D_SHADOW(shadowMap, vec3(fetchesUV[4].xy, shadowCoord.z));\n\t\tattenuation += fetchesWeights[5] * SAMPLE_TEXTURE2D_SHADOW(shadowMap, vec3(fetchesUV[5].xy, shadowCoord.z));\n\t\tattenuation += fetchesWeights[6] * SAMPLE_TEXTURE2D_SHADOW(shadowMap, vec3(fetchesUV[6].xy, shadowCoord.z));\n\t\tattenuation += fetchesWeights[7] * SAMPLE_TEXTURE2D_SHADOW(shadowMap, vec3(fetchesUV[7].xy, shadowCoord.z));\n\t\tattenuation += fetchesWeights[8] * SAMPLE_TEXTURE2D_SHADOW(shadowMap, vec3(fetchesUV[8].xy, shadowCoord.z));\n\t\treturn attenuation;\n\t}\n\n#endif\n\n\n\n\n#ifdef CALCULATE_SHADOWS\n\n\tTEXTURE2D_SHADOW(u_ShadowMap);\n\n\tuniform mat4 u_ShadowMatrices[4];\n\tuniform vec4 u_ShadowSplitSpheres[4];// max cascade is 4\n\n\tmediump int computeCascadeIndex(vec3 positionWS)\n\t{\n\t\tvec3 fromCenter0 = positionWS - u_ShadowSplitSpheres[0].xyz;\n\t\tvec3 fromCenter1 = positionWS - u_ShadowSplitSpheres[1].xyz;\n\t\tvec3 fromCenter2 = positionWS - u_ShadowSplitSpheres[2].xyz;\n\t\tvec3 fromCenter3 = positionWS - u_ShadowSplitSpheres[3].xyz;\n\n\t\tmediump vec4 comparison = vec4(\n\t\t\tdot(fromCenter0, fromCenter0)<u_ShadowSplitSpheres[0].w,\n\t\t\tdot(fromCenter1, fromCenter1)<u_ShadowSplitSpheres[1].w,\n\t\t\tdot(fromCenter2, fromCenter2)<u_ShadowSplitSpheres[2].w,\n\t\t\tdot(fromCenter3, fromCenter3)<u_ShadowSplitSpheres[3].w);\n\t\tcomparison.yzw = clamp(comparison.yzw - comparison.xyz,0.0,1.0);//keep the nearest\n\t\tmediump vec4 indexCoefficient = vec4(4.0,3.0,2.0,1.0);\n\t\tmediump int index = 4 - int(dot(comparison, indexCoefficient));\n\t\treturn index;\n\t}\n\n\tvec4 getShadowCoord(vec4 positionWS)\n\t{\n\t\t#ifdef SHADOW_CASCADE\n\t\t\tmediump int cascadeIndex = computeCascadeIndex(positionWS.xyz);\n\t\t\tif(cascadeIndex > 3)// out of shadow range cascadeIndex is 4.\n\t\t\t\treturn vec4(0.0);\n\t\t\t\n\t\t\t#ifdef GRAPHICS_API_GLES3\n\t\t\t\treturn u_ShadowMatrices[cascadeIndex] * positionWS;\n\t\t\t#else\n\t\t\t\tmat4 shadowMat;\n\t\t\t\tif(cascadeIndex == 0)\n\t\t\t\t\tshadowMat = u_ShadowMatrices[0];\n\t\t\t\telse if(cascadeIndex == 1)\n\t\t\t\t\tshadowMat = u_ShadowMatrices[1];\n\t\t\t\telse if(cascadeIndex == 2)\n\t\t\t\t\tshadowMat = u_ShadowMatrices[2];\n\t\t\t\telse\n\t\t\t\t\tshadowMat = u_ShadowMatrices[3];\n\t\t\t\treturn shadowMat * positionWS;\n\t\t\t#endif\n\t\t#else\n\t\t\treturn u_ShadowMatrices[0] * positionWS;\n\t\t#endif\n\t}\n\n\tfloat sampleShadowmap(vec4 shadowCoord)\n\t{\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tfloat attenuation = 1.0;\n\t\tif(shadowCoord.z > 0.0 && shadowCoord.z < 1.0)\n\t\t{\n\t\t\t#if defined(SHADOW_SOFT_SHADOW_HIGH)\n\t\t\t\tattenuation = sampleShdowMapFiltered9(u_ShadowMap,shadowCoord.xyz,u_ShadowMapSize);\n\t\t\t#elif defined(SHADOW_SOFT_SHADOW_LOW)\n\t\t\t\tattenuation = sampleShdowMapFiltered4(u_ShadowMap,shadowCoord.xyz,u_ShadowMapSize);\n\t\t\t#else\n\t\t\t\tattenuation = SAMPLE_TEXTURE2D_SHADOW(u_ShadowMap,shadowCoord.xyz);\n\t\t\t#endif\n\t\t\tattenuation = mix(1.0,attenuation,u_ShadowParams.x);//shadowParams.x:shadow strength\n\t\t}\n\t\treturn attenuation;\n\t}\n#endif\n\n#ifdef CALCULATE_SPOTSHADOWS\n\tTEXTURE2D_SHADOW(u_SpotShadowMap);\n\tuniform mat4 u_SpotViewProjectMatrix;\n\tfloat sampleSpotShadowmap(vec4 shadowCoord)\n\t{\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tfloat attenuation = 1.0;\n\t\tshadowCoord.xy +=1.0;\n\t\tshadowCoord.xy/=2.0; \n\t\tif(shadowCoord.z > 0.0 && shadowCoord.z < 1.0)\n\t\t{\n\t\t\t#if defined(SHADOW_SPOT_SOFT_SHADOW_HIGH)\n\t\t\t\tattenuation = sampleShdowMapFiltered9(u_SpotShadowMap,shadowCoord.xyz,u_ShadowMapSize);\n\t\t\t#elif defined(SHADOW_SPOT_SOFT_SHADOW_LOW)\n\t\t\t\tattenuation = sampleShdowMapFiltered4(u_SpotShadowMap,shadowCoord.xyz,u_ShadowMapSize);\n\t\t\t#else\n\t\t\t\tattenuation = SAMPLE_TEXTURE2D_SHADOW(u_SpotShadowMap,shadowCoord.xyz);\n\t\t\t#endif\n\t\t\tattenuation = mix(1.0,attenuation,u_ShadowParams.y);//shadowParams.y:shadow strength\n\t\t}\n\t\treturn attenuation;\n\t}\n#endif\n\nvec3 applyShadowBias(vec3 positionWS, vec3 normalWS, vec3 lightDirection)\n{\n    float invNdotL = 1.0 - clamp(dot(-lightDirection, normalWS),0.0,1.0);\n    float scale = invNdotL * u_ShadowBias.y;\n\n    // normal bias is negative since we want to apply an inset normal offset\n    positionWS += -lightDirection * u_ShadowBias.xxx;\n    positionWS += normalWS * vec3(scale);\n    return positionWS;\n}\n";var ShadowCasterVSGLSL="#include \"Lighting.glsl\";\n#include \"Shadow.glsl\"\n\nattribute vec4 a_Position;\nattribute vec3 a_Normal;\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_WorldMat;\n#else\n\tuniform mat4 u_WorldMat;\n#endif\n\nuniform mat4 u_ViewProjection;\n\n#ifdef SHADOW\n\tuniform vec3 u_ShadowLightDirection;\n#endif\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\n\tattribute vec2 a_Texcoord0;\n\tvarying vec2 v_Texcoord0;\n#endif\n\nvec4 shadowCasterVertex()\n{\n\tmat4 worldMat;\n\t#ifdef GPU_INSTANCE\n\t\tworldMat = a_WorldMat;\n\t#else\n\t\tworldMat = u_WorldMat;\n\t#endif\n\t\n\t#ifdef BONE\n\t\tmat4 skinTransform;\n\t \t#ifdef SIMPLEBONE\n\t\t\tfloat currentPixelPos;\n\t\t\t#ifdef GPU_INSTANCE\n\t\t\t\tcurrentPixelPos = a_SimpleTextureParams.x+a_SimpleTextureParams.y;\n\t\t\t#else\n\t\t\t\tcurrentPixelPos = u_SimpleAnimatorParams.x+u_SimpleAnimatorParams.y;\n\t\t\t#endif\n\t\t\tfloat offset = 1.0/u_SimpleAnimatorTextureSize;\n\t\t\tskinTransform =  loadMatFromTexture(currentPixelPos,int(a_BoneIndices.x),offset) * a_BoneWeights.x;\n\t\t\tskinTransform += loadMatFromTexture(currentPixelPos,int(a_BoneIndices.y),offset) * a_BoneWeights.y;\n\t\t\tskinTransform += loadMatFromTexture(currentPixelPos,int(a_BoneIndices.z),offset) * a_BoneWeights.z;\n\t\t\tskinTransform += loadMatFromTexture(currentPixelPos,int(a_BoneIndices.w),offset) * a_BoneWeights.w;\n\t\t#else\n\t\t\tskinTransform =  u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\t#endif\n\t\tworldMat = worldMat * skinTransform;\n\t#endif\n\n\tvec4 positionWS = worldMat * a_Position;\n\tvec3 normalWS = normalize(a_Normal*INVERSE_MAT(mat3(worldMat)));//if no normalize will cause precision problem\n\n\t#ifdef SHADOW\n\t\tpositionWS.xyz = applyShadowBias(positionWS.xyz,normalWS,u_ShadowLightDirection);\n\t#endif\n\n\tvec4 positionCS = u_ViewProjection * positionWS;\n\t#ifdef SHADOW_SPOT\n\t\tpositionCS.z = positionCS.z-u_ShadowBias.x/positionCS.w;\n\t#endif\n\tpositionCS.z = max(positionCS.z, 0.0);//min ndc z is 0.0\n\t\n\t// //TODO没考虑UV动画呢\n\t// #if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t// \tv_Texcoord0=a_Texcoord0;\n\t// #endif\n    return positionCS;\n}\n";var ShadowCasterFSGLSL="// #ifdef ALPHATEST\n// \tuniform float u_AlphaTestValue;\n// #endif\n\n// #ifdef DIFFUSEMAP\n// \tuniform sampler2D u_DiffuseTexture;\n// #endif\n\n// #if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(SPECULARMAP)||defined(NORMALMAP)))\n// \tvarying vec2 v_Texcoord0;\n// #endif\n\nvec4 shadowCasterFragment()\n{\n    return vec4(0.0);\n    // #if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t// \tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t// \tif( alpha < u_AlphaTestValue )\n\t// \t{\n\t// \t\tdiscard;\n\t// \t}\n\t// #endif\n}\n";var SkyBoxPS="#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nvarying vec3 v_Texcoord;\n\nuniform samplerCube u_CubeTexture;\nuniform float u_Exposure;\nuniform vec4 u_TintColor;\n\n\nvoid main()\n{\t\n\tvec3 color=textureCube(u_CubeTexture, v_Texcoord).rgb*u_TintColor.rgb*u_Exposure*2.0;\n\tgl_FragColor=vec4(color,1.0);\n}\n\n";var SkyBoxVS="#include \"Lighting.glsl\";\n\nattribute vec4 a_Position;\nuniform mat4 u_ViewProjection;\nuniform float u_Rotation;\nvarying vec3 v_Texcoord;\n\n\nvec4 rotateAroundYInDegrees (vec4 vertex, float degrees)\n{\n\tfloat angle = degrees * 3.141593 / 180.0;\n\tfloat sina=sin(angle);\n\tfloat cosa=cos(angle);\n\tmat2 m = mat2(cosa, -sina, sina, cosa);\n\treturn vec4(m*vertex.xz, vertex.yw).xzyw;\n}\n\t\t\nvoid main()\n{\n\tvec4 position=rotateAroundYInDegrees(a_Position,u_Rotation);\n\tgl_Position = u_ViewProjection*position;\n\tv_Texcoord=vec3(-a_Position.x,a_Position.yz);//转换坐标系\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n";var SkyBoxProceduralPS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include \"Lighting.glsl\";\n\nconst float MIE_G = -0.990;\nconst float MIE_G2 = 0.9801;\nconst float SKY_GROUND_THRESHOLD = 0.02;\n\nuniform float u_SunSize;\nuniform float u_SunSizeConvergence;\nuniform DirectionLight u_SunLight;\n\n\nvarying vec3 v_GroundColor;\nvarying vec3 v_SkyColor;\n\n\n#ifdef SUN_HIGH_QUALITY\n\tvarying vec3 v_Vertex;\n#elif defined(SUN_SIMPLE)\n\tvarying vec3 v_RayDir;\n#else\n\tvarying float v_SkyGroundFactor;\n#endif\n\n#if defined(SUN_HIGH_QUALITY)||defined(SUN_SIMPLE)\n\tvarying vec3 v_SunColor;\n#endif\n\n// Calculates the Mie phase function\nfloat getMiePhase(float eyeCos, float eyeCos2) {\n\tfloat temp = 1.0 + MIE_G2 - 2.0 * MIE_G * eyeCos;\n\ttemp = pow(temp, pow(u_SunSize,0.65) * 10.0);\n\ttemp = max(temp,1.0e-4); // prevent division by zero, esp. in half precision\n\ttemp = 1.5 * ((1.0 - MIE_G2) / (2.0 + MIE_G2)) * (1.0 + eyeCos2) / temp;\n\treturn temp;\n}\n\n// Calculates the sun shape\nfloat calcSunAttenuation(vec3 lightPos, vec3 ray) {\n\t#ifdef SUN_HIGH_QUALITY\n\t\tfloat focusedEyeCos = pow(clamp(dot(lightPos, ray),0.0,1.0), u_SunSizeConvergence);\n\t\treturn getMiePhase(-focusedEyeCos, focusedEyeCos * focusedEyeCos);\n\t#else //SUN_SIMPLE\n\t\tvec3 delta = lightPos - ray;\n\t\tfloat dist = length(delta);\n\t\tfloat spot = 1.0 - smoothstep(0.0, u_SunSize, dist);\n\t\treturn spot * spot;\n\t#endif\n}\n\nvoid main() {\n\t// if y > 1 [eyeRay.y < -SKY_GROUND_THRESHOLD] - ground\n\t// if y >= 0 and < 1 [eyeRay.y <= 0 and > -SKY_GROUND_THRESHOLD] - horizon\n\t// if y < 0 [eyeRay.y > 0] - sky\n\tvec3 col = vec3(0.0, 0.0, 0.0);\n\n\t#ifdef SUN_HIGH_QUALITY\n\t\tvec3 ray = normalize(v_Vertex);\n\t\tfloat y = ray.y / SKY_GROUND_THRESHOLD;\n\t#elif defined(SUN_SIMPLE) \n\t\tvec3 ray = v_RayDir;\n\t\tfloat y = ray.y / SKY_GROUND_THRESHOLD;\t\n\t#else\n\t\tfloat y = v_SkyGroundFactor;\n\t#endif\n\n\t// if we did precalculate color in vprog: just do lerp between them\n\tcol = mix(v_SkyColor, v_GroundColor, clamp(y,0.0,1.0));\n\n\t#if defined(SUN_HIGH_QUALITY)||defined(SUN_SIMPLE)\n\t\tif (y < 0.0)\n\t\t\tcol += v_SunColor * calcSunAttenuation(-u_SunLight.direction, -ray);\n\t#endif\n\n\tcol = sqrt(col);//linear space convert to gamma space\n\tgl_FragColor=vec4(col,1.0);\n}\n\n";var SkyBoxProceduralVS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include \"Lighting.glsl\";\n\n#define OUTER_RADIUS 1.025\n#define RAYLEIGH (mix(0.0, 0.0025, pow(u_AtmosphereThickness,2.5)))// Rayleigh constant Rayleigh为夜空光和极光亮度单位\n#define MIE 0.0010             // Mie constant 米氏散射\n#define SUN_BRIGHTNESS 20.0    // Sun brightness\n#define MAX_SCATTER 50.0 // Maximum scattering value, to prevent math overflows on Adrenos\n\nconst float SKY_GROUND_THRESHOLD = 0.02;\nconst float outerRadius = OUTER_RADIUS;\nconst float outerRadius2 = OUTER_RADIUS*OUTER_RADIUS;\nconst float innerRadius = 1.0;\nconst float innerRadius2 = 1.0;\nconst float cameraHeight = 0.0001;\n\nconst float HDSundiskIntensityFactor = 15.0;\nconst float simpleSundiskIntensityFactor = 27.0;\n\nconst float sunScale = 400.0 * SUN_BRIGHTNESS;\nconst float kmESun = MIE * SUN_BRIGHTNESS;\nconst float km4PI = MIE * 4.0 * 3.14159265;\nconst float scale = 1.0 / (OUTER_RADIUS - 1.0);\nconst float scaleDepth = 0.25;\nconst float scaleOverScaleDepth = (1.0 / (OUTER_RADIUS - 1.0)) / 0.25;\nconst float samples = 2.0; // THIS IS UNROLLED MANUALLY, DON'T TOUCH\n\n// RGB wavelengths        .35 (.62=158), .43 (.68=174), .525 (.75=190)\nconst vec3 c_DefaultScatteringWavelength = vec3(0.65, 0.57, 0.475);//默认散射波长\nconst vec3 c_VariableRangeForScatteringWavelength = vec3(0.15, 0.15, 0.15);//散射播放的可变范围\n\nattribute vec4 a_Position;\n\nuniform mat4 u_ViewProjection;\nuniform vec3 u_SkyTint;\nuniform vec3 u_GroundTint;\nuniform float u_Exposure;\nuniform float u_AtmosphereThickness;\nuniform DirectionLight u_SunLight;\n\nvarying vec3 v_GroundColor;\nvarying vec3 v_SkyColor;\n\n#ifdef SUN_HIGH_QUALITY\n\tvarying vec3 v_Vertex;\n#elif defined(SUN_SIMPLE)\n\tvarying vec3 v_RayDir;\n#else\n\tvarying float v_SkyGroundFactor;\n#endif\n\n#if defined(SUN_HIGH_QUALITY)||defined(SUN_SIMPLE)\n\tvarying vec3 v_SunColor;\n#endif\n\n// Calculates the Rayleigh phase function\nfloat getRayleighPhase(vec3 light, vec3 ray) \n{\n\tfloat eyeCos = dot(light, ray);\n\treturn 0.75 + 0.75*eyeCos*eyeCos;\n}\n\nfloat scaleAngle(float inCos)\n{\n\tfloat x = 1.0 - inCos;\n\treturn 0.25 * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\n\n\nvoid main () {\n\tgl_Position = u_ViewProjection*a_Position;\n\n\tvec3 skyTintInGammaSpace = u_SkyTint;//支持非GAMMA空间后要调整\n\tvec3 scatteringWavelength = mix(c_DefaultScatteringWavelength-c_VariableRangeForScatteringWavelength,c_DefaultScatteringWavelength+c_VariableRangeForScatteringWavelength,vec3(1.0) - skyTintInGammaSpace); // using Tint in sRGB+ gamma allows for more visually linear interpolation and to keep (0.5) at (128, gray in sRGB) point\n\tvec3 invWavelength = 1.0 / pow(scatteringWavelength, vec3(4.0));\n\n\tfloat krESun = RAYLEIGH * SUN_BRIGHTNESS;\n\tfloat kr4PI = RAYLEIGH * 4.0 * 3.14159265;\n\n\tvec3 cameraPos = vec3(0.0,innerRadius + cameraHeight,0.0); // The camera's current position\n\n\t// Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)\n\tvec3 eyeRay = normalize(a_Position.xyz);\n\n\tfloat far = 0.0;\n\tvec3 cIn, cOut;\n\tif (eyeRay.y >= 0.0) {// Sky\n\t\t// Calculate the length of the \"atmosphere\"\n\t\tfar = sqrt(outerRadius2 + innerRadius2 * eyeRay.y * eyeRay.y - innerRadius2) - innerRadius * eyeRay.y;\n\n\t\t// Calculate the ray's starting position, then calculate its scattering offset\n\t\tfloat height = innerRadius + cameraHeight;\n\t\tfloat depth = exp(scaleOverScaleDepth * -cameraHeight);\n\t\tfloat startAngle = dot(eyeRay, cameraPos) / height;\n\t\tfloat startOffset = depth*scaleAngle(startAngle);\n\n\t\t// Initialize the scattering loop variables\n\t\tfloat sampleLength = far / samples;\n\t\tfloat scaledLength = sampleLength * scale;\n\t\tvec3 sampleRay = eyeRay * sampleLength;\n\t\tvec3 samplePoint = cameraPos + sampleRay * 0.5;\n\n\t\tvec3 frontColor = vec3(0.0);\n\t\t//unrolling this manually to avoid some platform for loop slow\n\t\t{\n\t\t\tfloat height = length(samplePoint);\n\t\t\tfloat depth = exp(scaleOverScaleDepth * (innerRadius - height));\n\t\t\tfloat lightAngle = dot(-u_SunLight.direction, samplePoint) / height;\n\t\t\tfloat cameraAngle = dot(eyeRay, samplePoint) / height;\n\t\t\tfloat scatter = (startOffset + depth*(scaleAngle(lightAngle) - scaleAngle(cameraAngle)));\n\t\t\tvec3 attenuate = exp(-clamp(scatter, 0.0, MAX_SCATTER) * (invWavelength * kr4PI + km4PI));\n\n\t\t\tfrontColor += attenuate * (depth * scaledLength);\n\t\t\tsamplePoint += sampleRay;\n\t\t}\n\t\t{\n\t\t\tfloat height = length(samplePoint);\n\t\t\tfloat depth = exp(scaleOverScaleDepth * (innerRadius - height));\n\t\t\tfloat lightAngle = dot(-u_SunLight.direction, samplePoint) / height;\n\t\t\tfloat cameraAngle = dot(eyeRay, samplePoint) / height;\n\t\t\tfloat scatter = (startOffset + depth*(scaleAngle(lightAngle) - scaleAngle(cameraAngle)));\n\t\t\tvec3 attenuate = exp(-clamp(scatter, 0.0, MAX_SCATTER) * (invWavelength * kr4PI + km4PI));\n\n\t\t\tfrontColor += attenuate * (depth * scaledLength);\n\t\t\tsamplePoint += sampleRay;\n\t\t}\n\n\t\t// Finally, scale the Mie and Rayleigh colors and set up the varying variables for the pixel shader\n\t\tcIn = frontColor * (invWavelength * krESun);\n\t\tcOut = frontColor * kmESun;\n\t} else {// Ground\n\t\tfar = (-cameraHeight) / (min(-0.001, eyeRay.y));\n\t\tvec3 pos = cameraPos + far * eyeRay;\n\n\t\t// Calculate the ray's starting position, then calculate its scattering offset\n\t\tfloat depth = exp((-cameraHeight) * (1.0/scaleDepth));\n\t\tfloat cameraAngle = dot(-eyeRay, pos);\n\t\tfloat lightAngle = dot(-u_SunLight.direction, pos);\n\t\tfloat cameraScale = scaleAngle(cameraAngle);\n\t\tfloat lightScale = scaleAngle(lightAngle);\n\t\tfloat cameraOffset = depth*cameraScale;\n\t\tfloat temp = lightScale + cameraScale;\n\n\t\t// Initialize the scattering loop variables\n\t\tfloat sampleLength = far / samples;\n\t\tfloat scaledLength = sampleLength * scale;\n\t\tvec3 sampleRay = eyeRay * sampleLength;\n\t\tvec3 samplePoint = cameraPos + sampleRay * 0.5;\n\n\t\t// Now loop through the sample rays\n\t\tvec3 frontColor = vec3(0.0, 0.0, 0.0);\n\t\tvec3 attenuate;\n\n\t\t// Loop removed because we kept hitting SM2.0 temp variable limits. Doesn't affect the image too much.\n\t\t{\n\t\t\tfloat height = length(samplePoint);\n\t\t\tfloat depth = exp(scaleOverScaleDepth * (innerRadius - height));\n\t\t\tfloat scatter = depth*temp - cameraOffset;\n\t\t\tattenuate = exp(-clamp(scatter, 0.0, MAX_SCATTER) * (invWavelength * kr4PI + km4PI));\n\t\t\tfrontColor += attenuate * (depth * scaledLength);\n\t\t\tsamplePoint += sampleRay;\n\t\t}\n\n\t\tcIn = frontColor * (invWavelength * krESun + kmESun);\n\t\tcOut = clamp(attenuate, 0.0, 1.0);\n\t}\n\n\t#ifdef SUN_HIGH_QUALITY\n\t\tv_Vertex = -a_Position.xyz;\n\t#elif defined(SUN_SIMPLE) \n\t\tv_RayDir = -eyeRay;\n\t#else\n\t\tv_SkyGroundFactor = -eyeRay.y / SKY_GROUND_THRESHOLD;\n\t#endif\n\n\t// if we want to calculate color in vprog:\n\t// in case of linear: multiply by _Exposure in here (even in case of lerp it will be common multiplier, so we can skip mul in fshader)\n\tv_GroundColor = u_Exposure * (cIn + u_GroundTint*u_GroundTint * cOut);//u_GroundColor*u_GroundColor is gamma space convert to linear space\n\tv_SkyColor    = u_Exposure * (cIn * getRayleighPhase(-u_SunLight.direction, -eyeRay));\n\n\t\n\t// The sun should have a stable intensity in its course in the sky. Moreover it should match the highlight of a purely specular material.\n\t// This matching was done using the Unity3D standard shader BRDF1 on the 5/31/2017\n\t// Finally we want the sun to be always bright even in LDR thus the normalization of the lightColor for low intensity.\n\tfloat lightColorIntensity = clamp(length(u_SunLight.color), 0.25, 1.0);\n\n\t#ifdef SUN_HIGH_QUALITY \n\t\tv_SunColor = HDSundiskIntensityFactor * clamp(cOut,0.0,1.0) * u_SunLight.color / lightColorIntensity;\n\t#elif defined(SUN_SIMPLE) \n\t\tv_SunColor = simpleSundiskIntensityFactor * clamp(cOut * sunScale,0.0,1.0) * u_SunLight.color / lightColorIntensity;\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n";var TrailPS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\nuniform sampler2D u_MainTexture;\nuniform vec4 u_MainColor;\n\nvarying vec2 v_Texcoord0;\nvarying vec4 v_Color;\n\nvoid main()\n{\n\tvec4 color = 2.0 * u_MainColor * v_Color;\n\t#ifdef MAINTEXTURE\n\t\tvec4 mainTextureColor = texture2D(u_MainTexture, v_Texcoord0);\n\t\tcolor *= mainTextureColor;\n\t#endif\n\tgl_FragColor = color;\n}\n\n     ";var TrailVS="#include \"Lighting.glsl\";\n\nattribute vec3 a_Position;\nattribute vec3 a_OffsetVector;\nattribute vec4 a_Color;\nattribute float a_Texcoord0X;\nattribute float a_Texcoord0Y;\nattribute float a_BirthTime;\n\nuniform mat4 u_View;\nuniform mat4 u_Projection;\n\nuniform vec4 u_TilingOffset;\n\nuniform float u_CurTime;\nuniform float u_LifeTime;\nuniform vec4 u_WidthCurve[10];\nuniform int u_WidthCurveKeyLength;\n\nvarying vec2 v_Texcoord0;\nvarying vec4 v_Color;\n\nfloat hermiteInterpolate(float t, float outTangent, float inTangent, float duration, float value1, float value2)\n{\n\tfloat t2 = t * t;\n\tfloat t3 = t2 * t;\n\tfloat a = 2.0 * t3 - 3.0 * t2 + 1.0;\n\tfloat b = t3 - 2.0 * t2 + t;\n\tfloat c = t3 - t2;\n\tfloat d = -2.0 * t3 + 3.0 * t2;\n\treturn a * value1 + b * outTangent * duration + c * inTangent * duration + d * value2;\n}\n\nfloat getCurWidth(in float normalizeTime)\n{\n\tfloat width;\n\tif(normalizeTime == 0.0){\n\t\twidth=u_WidthCurve[0].w;\n\t}\n\telse if(normalizeTime >= 1.0){\n\t\twidth=u_WidthCurve[u_WidthCurveKeyLength - 1].w;\n\t}\n\telse{\n\t\tfor(int i = 0; i < 10; i ++ )\n\t\t{\n\t\t\tif(normalizeTime == u_WidthCurve[i].x){\n\t\t\t\twidth=u_WidthCurve[i].w;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tvec4 lastFrame = u_WidthCurve[i];\n\t\t\tvec4 nextFrame = u_WidthCurve[i + 1];\n\t\t\tif(normalizeTime > lastFrame.x && normalizeTime < nextFrame.x)\n\t\t\t{\n\t\t\t\tfloat duration = nextFrame.x - lastFrame.x;\n\t\t\t\tfloat t = (normalizeTime - lastFrame.x) / duration;\n\t\t\t\tfloat outTangent = lastFrame.z;\n\t\t\t\tfloat inTangent = nextFrame.y;\n\t\t\t\tfloat value1 = lastFrame.w;\n\t\t\t\tfloat value2 = nextFrame.w;\n\t\t\t\twidth=hermiteInterpolate(t, outTangent, inTangent, duration, value1, value2);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn width;\n}\t\n\nvoid main()\n{\n\tfloat normalizeTime = (u_CurTime - a_BirthTime) / u_LifeTime;\n\t\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0 = vec2(a_Texcoord0X, 1.0 - a_Texcoord0Y) * u_TilingOffset.xy + u_TilingOffset.zw;\n\t#else\n\t\tv_Texcoord0 = vec2(a_Texcoord0X, a_Texcoord0Y);\n\t#endif\n\t\n\tv_Color = a_Color;\n\t\n\tgl_Position = u_Projection * u_View * vec4(a_Position + a_OffsetVector * getCurWidth(normalizeTime),1.0);\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n";var UnlitPS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\tvarying vec4 v_Color;\n#endif\n\n#ifdef ALBEDOTEXTURE\n\tuniform sampler2D u_AlbedoTexture;\n\tvarying vec2 v_Texcoord0;\n#endif\n\nuniform vec4 u_AlbedoColor;\n\n#ifdef ALPHATEST\n\tuniform float u_AlphaTestValue;\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\nvoid main()\n{\n\tvec4 color =  u_AlbedoColor;\n\t#ifdef ALBEDOTEXTURE\n\t\tcolor *= texture2D(u_AlbedoTexture, v_Texcoord0);\n\t#endif\n\t#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\t\tcolor *= v_Color;\n\t#endif\n\t\n\t#ifdef ALPHATEST\n\t\tif(color.a < u_AlphaTestValue)\n\t\t\tdiscard;\n\t#endif\n\t\n\tgl_FragColor = color;\n\t\n\t#ifdef FOG\n\t\tfloat lerpFact = clamp((1.0 / gl_FragCoord.w - u_FogStart) / u_FogRange, 0.0, 1.0);\n\t\t#ifdef ADDTIVEFOG\n\t\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.0), lerpFact);\n\t\t#else\n\t\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, u_FogColor, lerpFact);\n\t\t#endif\n\t#endif\n\t\n}\n\n";var UnlitVS="#include \"Lighting.glsl\";\n\nattribute vec4 a_Position;\n\nattribute vec2 a_Texcoord0;\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_MvpMatrix;\n#else\n\tuniform mat4 u_MvpMatrix;\n#endif\n\nattribute vec4 a_Color;\nvarying vec4 v_Color;\nvarying vec2 v_Texcoord0;\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#ifdef SIMPLEBONE\n\t#ifdef GPU_INSTANCE\n\t\tattribute vec4 a_SimpleTextureParams;\n\t#else\n\t\tuniform vec4 u_SimpleAnimatorParams;\n\t#endif\n\tuniform sampler2D u_SimpleAnimatorTexture;\n\n\tuniform float u_SimpleAnimatorTextureSize; \n#endif\n\n\n#ifdef SIMPLEBONE\nmat4 loadMatFromTexture(float FramePos,int boneIndices,float offset)\n{\n\tvec2 uv;\n\tfloat PixelPos = FramePos+float(boneIndices)*4.0;\n\tfloat halfOffset = offset * 0.5;\n\tfloat uvoffset = PixelPos/u_SimpleAnimatorTextureSize;\n\tuv.y = floor(uvoffset)*offset+halfOffset;\n\tuv.x = mod(float(PixelPos),u_SimpleAnimatorTextureSize)*offset+halfOffset;\n\tvec4 mat0row = texture2D(u_SimpleAnimatorTexture,uv);\n\tuv.x+=offset;\n\tvec4 mat1row = texture2D(u_SimpleAnimatorTexture,uv);\n\tuv.x+=offset;\n\tvec4 mat2row = texture2D(u_SimpleAnimatorTexture,uv);\n\tuv.x+=offset;\n\tvec4 mat3row = texture2D(u_SimpleAnimatorTexture,uv);\n\tmat4 m =mat4(mat0row.x,mat0row.y,mat0row.z,mat0row.w,\n\t\t\t  mat1row.x,mat1row.y,mat1row.z,mat1row.w,\n\t\t\t  mat2row.x,mat2row.y,mat2row.z,mat2row.w,\n\t\t\t  mat3row.x,mat3row.y,mat3row.z,mat3row.w);\n\treturn m;\n}\n#endif\nvoid main() {\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform;\n\t \t#ifdef SIMPLEBONE\n\t\t\tfloat currentPixelPos;\n\t\t\t#ifdef GPU_INSTANCE\n\t\t\t\tcurrentPixelPos = a_SimpleTextureParams.x+a_SimpleTextureParams.y;\n\t\t\t#else\n\t\t\t\tcurrentPixelPos = u_SimpleAnimatorParams.x+u_SimpleAnimatorParams.y;\n\t\t\t#endif\n\t\t\tfloat offset = 1.0/u_SimpleAnimatorTextureSize;\n\t\t\tskinTransform =  loadMatFromTexture(currentPixelPos,int(a_BoneIndices.x),offset) * a_BoneWeights.x;\n\t\t\tskinTransform += loadMatFromTexture(currentPixelPos,int(a_BoneIndices.y),offset) * a_BoneWeights.y;\n\t\t\tskinTransform += loadMatFromTexture(currentPixelPos,int(a_BoneIndices.z),offset) * a_BoneWeights.z;\n\t\t\tskinTransform += loadMatFromTexture(currentPixelPos,int(a_BoneIndices.w),offset) * a_BoneWeights.w;\n\t\t#else\n\t\t\tskinTransform =  u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\t#endif\n\t\tposition=skinTransform*a_Position;\n\t #else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=TransformUV(a_Texcoord0,u_TilingOffset);\n\t#else\n\t\tv_Texcoord0=a_Texcoord0;\n\t#endif\n\n\t#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\t\tv_Color = a_Color;\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n}";var WaterPrimaryPS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#ifdef MAINTEXTURE\n\tuniform sampler2D u_MainTexture;\n#endif\n\n#ifdef NORMALTEXTURE\n\tuniform sampler2D u_NormalTexture;\n#endif\n\nuniform vec4 u_HorizonColor;\n\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\nvarying vec2 v_Texcoord0;\nvarying vec2 v_Texcoord1;\n\n\n#include \"Lighting.glsl\"\n\n\n\nvec3 NormalSampleToWorldSpace(vec4 normalMapSample) {\n\tvec3 normalT;\n\tnormalT.x = 2.0 * normalMapSample.x - 1.0;\n\tnormalT.y = 1.0 - 2.0 * normalMapSample.y;\n\tnormalT.z = sqrt(1.0 - clamp(dot(normalT.xy, normalT.xy), 0.0, 1.0));\n\n\tvec3 bumpedNormal = normalize(normalT);\n\n\treturn bumpedNormal;\n}\n\n\nvoid main()\n{\n\tvec4 bumpColor1 = texture2D(u_NormalTexture, v_Texcoord0);\n\tvec4 bumpColor2 = texture2D(u_NormalTexture, v_Texcoord1);\n\n\tvec3 normal1 = NormalSampleToWorldSpace(bumpColor1);\n\tvec3 normal2 = NormalSampleToWorldSpace(bumpColor2);\n\t\n\tvec3 normal = normalize((normal1 + normal2) * 0.5);\n\tvec3 viewDir = normalize(v_ViewDir);\n\tfloat fresnel = dot(viewDir, normal);\n\t\n\tvec4 waterColor = texture2D(u_MainTexture, vec2(fresnel, fresnel));\n\t\n\tvec4 color;\n\tcolor.rgb = mix(waterColor.rgb, u_HorizonColor.rgb, vec3(waterColor.a));\n\tcolor.a = u_HorizonColor.a;\n\t\n\tgl_FragColor = color;\n}\n\n\n";var WaterPrimaryVS="#include \"Lighting.glsl\";\n\nattribute vec4 a_Position;\nattribute vec3 a_Normal;\nattribute vec4 a_Tangent0;\n\nuniform mat4 u_MvpMatrix;\nuniform mat4 u_WorldMat;\nuniform vec3 u_CameraPos;\nuniform float u_WaveScale;\nuniform vec4 u_WaveSpeed;\nuniform float u_Time;\n\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\nvarying vec2 v_Texcoord0;\nvarying vec2 v_Texcoord1;\n\nvoid main()\n{\n\tvec4 positionWorld = u_WorldMat * a_Position;\n\tvec4 position = u_MvpMatrix * a_Position;\n\t\n\tvec4 temp = vec4(positionWorld.x, positionWorld.z, positionWorld.x, positionWorld.z) * u_WaveScale + u_WaveSpeed * u_WaveScale * u_Time;\n\t\n\tv_Texcoord0 = temp.xy * vec2(0.4, 0.45);\n\tv_Texcoord1 = temp.wz;\n\t\n\tmat3 worldMat = mat3(u_WorldMat);\n\tv_Normal = worldMat * a_Normal;\n\tv_Tangent = worldMat * a_Tangent0.xyz;\n\tv_Binormal = cross(v_Normal, v_Tangent) * a_Tangent0.w;\n\t\n\tv_ViewDir = u_CameraPos - positionWorld.xyz;\n\tgl_Position = position;\n\tgl_Position=remapGLPositionZ(gl_Position);\n}";var ShaderInit3D=/*#__PURE__*/function(){function ShaderInit3D(){}ShaderInit3D.__init__=function __init__(){Shader3D.SHADERDEFINE_LEGACYSINGALLIGHTING=Shader3D.getDefineByName("LEGACYSINGLELIGHTING");Shader3D.SHADERDEFINE_GRAPHICS_API_GLES2=Shader3D.getDefineByName("GRAPHICS_API_GLES2");Shader3D.SHADERDEFINE_GRAPHICS_API_GLES3=Shader3D.getDefineByName("GRAPHICS_API_GLES3");Shader3D.addInclude("Lighting.glsl",LightingGLSL);Shader3D.addInclude("ShadowSampleTent.glsl",ShadowSampleTentGLSL);Shader3D.addInclude("GlobalIllumination.glsl",GlobalIllumination);Shader3D.addInclude("Shadow.glsl",ShadowGLSL);Shader3D.addInclude("ShadowCasterVS.glsl",ShadowCasterVSGLSL);Shader3D.addInclude("ShadowCasterFS.glsl",ShadowCasterFSGLSL);Shader3D.addInclude("Colors.glsl",ColorsGLSL);Shader3D.addInclude("Sampling.glsl",SamplingGLSL);Shader3D.addInclude("StdLib.glsl",StdLibGLSL);Shader3D.addInclude("PBRVSInput.glsl",PBRVSInput);Shader3D.addInclude("PBRFSInput.glsl",PBRFSInput);Shader3D.addInclude("LayaPBRBRDF.glsl",LayaPBRBRDF);Shader3D.addInclude("PBRCore.glsl",PBRCore);Shader3D.addInclude("PBRVertex.glsl",PBRVertex);var attributeMap={'a_Position':VertexMesh.MESH_POSITION0,'a_Color':VertexMesh.MESH_COLOR0,'a_Normal':VertexMesh.MESH_NORMAL0,'a_Texcoord0':VertexMesh.MESH_TEXTURECOORDINATE0,'a_Texcoord1':VertexMesh.MESH_TEXTURECOORDINATE1,'a_BoneWeights':VertexMesh.MESH_BLENDWEIGHT0,'a_BoneIndices':VertexMesh.MESH_BLENDINDICES0,'a_Tangent0':VertexMesh.MESH_TANGENT0,'a_MvpMatrix':VertexMesh.MESH_MVPMATRIX_ROW0,'a_WorldMat':VertexMesh.MESH_WORLDMATRIX_ROW0};var uniformMap={'u_Bones':Shader3D.PERIOD_CUSTOM,'u_DiffuseTexture':Shader3D.PERIOD_MATERIAL,'u_SpecularTexture':Shader3D.PERIOD_MATERIAL,'u_NormalTexture':Shader3D.PERIOD_MATERIAL,'u_AlphaTestValue':Shader3D.PERIOD_MATERIAL,'u_DiffuseColor':Shader3D.PERIOD_MATERIAL,'u_MaterialSpecular':Shader3D.PERIOD_MATERIAL,'u_Shininess':Shader3D.PERIOD_MATERIAL,'u_TilingOffset':Shader3D.PERIOD_MATERIAL,'u_WorldMat':Shader3D.PERIOD_SPRITE,'u_MvpMatrix':Shader3D.PERIOD_SPRITE,'u_LightmapScaleOffset':Shader3D.PERIOD_SPRITE,'u_LightMap':Shader3D.PERIOD_SPRITE,'u_LightMapDirection':Shader3D.PERIOD_SPRITE,'u_SimpleAnimatorTexture':Shader3D.PERIOD_SPRITE,'u_SimpleAnimatorParams':Shader3D.PERIOD_SPRITE,'u_SimpleAnimatorTextureSize':Shader3D.PERIOD_SPRITE,'u_CameraPos':Shader3D.PERIOD_CAMERA,'u_Viewport':Shader3D.PERIOD_CAMERA,'u_ProjectionParams':Shader3D.PERIOD_CAMERA,'u_View':Shader3D.PERIOD_CAMERA,'u_ViewProjection':Shader3D.PERIOD_CAMERA,'u_ReflectTexture':Shader3D.PERIOD_SCENE,'u_ReflectIntensity':Shader3D.PERIOD_SCENE,'u_FogStart':Shader3D.PERIOD_SCENE,'u_FogRange':Shader3D.PERIOD_SCENE,'u_FogColor':Shader3D.PERIOD_SCENE,'u_DirationLightCount':Shader3D.PERIOD_SCENE,'u_LightBuffer':Shader3D.PERIOD_SCENE,'u_LightClusterBuffer':Shader3D.PERIOD_SCENE,'u_AmbientColor':Shader3D.PERIOD_SCENE,'u_ShadowBias':Shader3D.PERIOD_SCENE,'u_ShadowLightDirection':Shader3D.PERIOD_SCENE,'u_ShadowMap':Shader3D.PERIOD_SCENE,'u_ShadowParams':Shader3D.PERIOD_SCENE,'u_ShadowSplitSpheres':Shader3D.PERIOD_SCENE,'u_ShadowMatrices':Shader3D.PERIOD_SCENE,'u_ShadowMapSize':Shader3D.PERIOD_SCENE,'u_SpotShadowMap':Shader3D.PERIOD_SCENE,'u_SpotViewProjectMatrix':Shader3D.PERIOD_SCENE,'u_ShadowLightPosition':Shader3D.PERIOD_SCENE,'u_AmbientSHAr':Shader3D.PERIOD_SCENE,'u_AmbientSHAg':Shader3D.PERIOD_SCENE,'u_AmbientSHAb':Shader3D.PERIOD_SCENE,'u_AmbientSHBr':Shader3D.PERIOD_SCENE,'u_AmbientSHBg':Shader3D.PERIOD_SCENE,'u_AmbientSHBb':Shader3D.PERIOD_SCENE,'u_AmbientSHC':Shader3D.PERIOD_SCENE,'u_DirectionLight.color':Shader3D.PERIOD_SCENE,'u_DirectionLight.direction':Shader3D.PERIOD_SCENE,'u_PointLight.position':Shader3D.PERIOD_SCENE,'u_PointLight.range':Shader3D.PERIOD_SCENE,'u_PointLight.color':Shader3D.PERIOD_SCENE,'u_SpotLight.position':Shader3D.PERIOD_SCENE,'u_SpotLight.direction':Shader3D.PERIOD_SCENE,'u_SpotLight.range':Shader3D.PERIOD_SCENE,'u_SpotLight.spot':Shader3D.PERIOD_SCENE,'u_SpotLight.color':Shader3D.PERIOD_SCENE};var stateMap={'s_Cull':Shader3D.RENDER_STATE_CULL,'s_Blend':Shader3D.RENDER_STATE_BLEND,'s_BlendSrc':Shader3D.RENDER_STATE_BLEND_SRC,'s_BlendDst':Shader3D.RENDER_STATE_BLEND_DST,'s_DepthTest':Shader3D.RENDER_STATE_DEPTH_TEST,'s_DepthWrite':Shader3D.RENDER_STATE_DEPTH_WRITE};var shader=Shader3D.add("BLINNPHONG",null,null,true);var subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);subShader.addShaderPass(MeshBlinnPhongVS,MeshBlinnPhongPS,stateMap,"Forward");var shaderPass=subShader.addShaderPass(MeshBlinnPhongShadowCasterVS,MeshBlinnPhongShadowCasterPS,stateMap,"ShadowCaster");attributeMap={'a_Position':VertexMesh.MESH_POSITION0,'a_Color':VertexMesh.MESH_COLOR0};uniformMap={'u_MvpMatrix':Shader3D.PERIOD_SPRITE,'u_Color':Shader3D.PERIOD_MATERIAL};stateMap={'s_Cull':Shader3D.RENDER_STATE_CULL,'s_Blend':Shader3D.RENDER_STATE_BLEND,'s_BlendSrc':Shader3D.RENDER_STATE_BLEND_SRC,'s_BlendDst':Shader3D.RENDER_STATE_BLEND_DST,'s_DepthTest':Shader3D.RENDER_STATE_DEPTH_TEST,'s_DepthWrite':Shader3D.RENDER_STATE_DEPTH_WRITE};shader=Shader3D.add("LineShader");subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);subShader.addShaderPass(lineVS,linePS,stateMap);attributeMap={'a_Position':VertexMesh.MESH_POSITION0,'a_Color':VertexMesh.MESH_COLOR0,'a_Texcoord0':VertexMesh.MESH_TEXTURECOORDINATE0,'a_BoneWeights':VertexMesh.MESH_BLENDWEIGHT0,'a_BoneIndices':VertexMesh.MESH_BLENDINDICES0,'a_MvpMatrix':VertexMesh.MESH_MVPMATRIX_ROW0};uniformMap={'u_Bones':Shader3D.PERIOD_CUSTOM,'u_AlbedoTexture':Shader3D.PERIOD_MATERIAL,'u_AlbedoColor':Shader3D.PERIOD_MATERIAL,'u_TilingOffset':Shader3D.PERIOD_MATERIAL,'u_AlphaTestValue':Shader3D.PERIOD_MATERIAL,'u_MvpMatrix':Shader3D.PERIOD_SPRITE,'u_SimpleAnimatorTexture':Shader3D.PERIOD_SPRITE,'u_SimpleAnimatorParams':Shader3D.PERIOD_SPRITE,'u_SimpleAnimatorTextureSize':Shader3D.PERIOD_SPRITE,'u_FogStart':Shader3D.PERIOD_SCENE,'u_FogRange':Shader3D.PERIOD_SCENE,'u_FogColor':Shader3D.PERIOD_SCENE};stateMap={'s_Cull':Shader3D.RENDER_STATE_CULL,'s_Blend':Shader3D.RENDER_STATE_BLEND,'s_BlendSrc':Shader3D.RENDER_STATE_BLEND_SRC,'s_BlendDst':Shader3D.RENDER_STATE_BLEND_DST,'s_DepthTest':Shader3D.RENDER_STATE_DEPTH_TEST,'s_DepthWrite':Shader3D.RENDER_STATE_DEPTH_WRITE};shader=Shader3D.add("Unlit",null,null,true);subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);subShader.addShaderPass(UnlitVS,UnlitPS,stateMap);attributeMap={'a_Position':VertexMesh.MESH_POSITION0,'a_Texcoord0':VertexMesh.MESH_TEXTURECOORDINATE0,'a_BoneWeights':VertexMesh.MESH_BLENDWEIGHT0,'a_BoneIndices':VertexMesh.MESH_BLENDINDICES0,'a_MvpMatrix':VertexMesh.MESH_MVPMATRIX_ROW0};uniformMap={'u_Bones':Shader3D.PERIOD_CUSTOM,'u_AlbedoTexture':Shader3D.PERIOD_MATERIAL,'u_AlbedoColor':Shader3D.PERIOD_MATERIAL,'u_TilingOffset':Shader3D.PERIOD_MATERIAL,'u_AlphaTestValue':Shader3D.PERIOD_MATERIAL,'u_MvpMatrix':Shader3D.PERIOD_SPRITE,'u_SimpleAnimatorTexture':Shader3D.PERIOD_SPRITE,'u_SimpleAnimatorParams':Shader3D.PERIOD_SPRITE,'u_SimpleAnimatorTextureSize':Shader3D.PERIOD_SPRITE,'u_FogStart':Shader3D.PERIOD_SCENE,'u_FogRange':Shader3D.PERIOD_SCENE,'u_FogColor':Shader3D.PERIOD_SCENE};stateMap={'s_Cull':Shader3D.RENDER_STATE_CULL,'s_Blend':Shader3D.RENDER_STATE_BLEND,'s_BlendSrc':Shader3D.RENDER_STATE_BLEND_SRC,'s_BlendDst':Shader3D.RENDER_STATE_BLEND_DST,'s_DepthTest':Shader3D.RENDER_STATE_DEPTH_TEST,'s_DepthWrite':Shader3D.RENDER_STATE_DEPTH_WRITE};shader=Shader3D.add("Effect",null,null,true);subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);subShader.addShaderPass(EffectVS,EffectPS,stateMap);attributeMap={'a_CornerTextureCoordinate':VertexShuriKenParticle.PARTICLE_CORNERTEXTURECOORDINATE0,'a_MeshPosition':VertexShuriKenParticle.PARTICLE_POSITION0,'a_MeshColor':VertexShuriKenParticle.PARTICLE_COLOR0,'a_MeshTextureCoordinate':VertexShuriKenParticle.PARTICLE_TEXTURECOORDINATE0,'a_ShapePositionStartLifeTime':VertexShuriKenParticle.PARTICLE_SHAPEPOSITIONSTARTLIFETIME,'a_DirectionTime':VertexShuriKenParticle.PARTICLE_DIRECTIONTIME,'a_StartColor':VertexShuriKenParticle.PARTICLE_STARTCOLOR0,'a_EndColor':VertexShuriKenParticle.PARTICLE_ENDCOLOR0,'a_StartSize':VertexShuriKenParticle.PARTICLE_STARTSIZE,'a_StartRotation0':VertexShuriKenParticle.PARTICLE_STARTROTATION,'a_StartSpeed':VertexShuriKenParticle.PARTICLE_STARTSPEED,'a_Random0':VertexShuriKenParticle.PARTICLE_RANDOM0,'a_Random1':VertexShuriKenParticle.PARTICLE_RANDOM1,'a_SimulationWorldPostion':VertexShuriKenParticle.PARTICLE_SIMULATIONWORLDPOSTION,'a_SimulationWorldRotation':VertexShuriKenParticle.PARTICLE_SIMULATIONWORLDROTATION};uniformMap={'u_Tintcolor':Shader3D.PERIOD_MATERIAL,'u_TilingOffset':Shader3D.PERIOD_MATERIAL,'u_texture':Shader3D.PERIOD_MATERIAL,'u_WorldPosition':Shader3D.PERIOD_SPRITE,'u_WorldRotation':Shader3D.PERIOD_SPRITE,'u_PositionScale':Shader3D.PERIOD_SPRITE,'u_SizeScale':Shader3D.PERIOD_SPRITE,'u_ScalingMode':Shader3D.PERIOD_SPRITE,'u_Gravity':Shader3D.PERIOD_SPRITE,'u_ThreeDStartRotation':Shader3D.PERIOD_SPRITE,'u_StretchedBillboardLengthScale':Shader3D.PERIOD_SPRITE,'u_StretchedBillboardSpeedScale':Shader3D.PERIOD_SPRITE,'u_SimulationSpace':Shader3D.PERIOD_SPRITE,'u_CurrentTime':Shader3D.PERIOD_SPRITE,'u_ColorOverLifeGradientAlphas':Shader3D.PERIOD_SPRITE,'u_ColorOverLifeGradientColors':Shader3D.PERIOD_SPRITE,'u_MaxColorOverLifeGradientAlphas':Shader3D.PERIOD_SPRITE,'u_MaxColorOverLifeGradientColors':Shader3D.PERIOD_SPRITE,'u_VOLVelocityConst':Shader3D.PERIOD_SPRITE,'u_VOLVelocityGradientX':Shader3D.PERIOD_SPRITE,'u_VOLVelocityGradientY':Shader3D.PERIOD_SPRITE,'u_VOLVelocityGradientZ':Shader3D.PERIOD_SPRITE,'u_VOLVelocityConstMax':Shader3D.PERIOD_SPRITE,'u_VOLVelocityGradientMaxX':Shader3D.PERIOD_SPRITE,'u_VOLVelocityGradientMaxY':Shader3D.PERIOD_SPRITE,'u_VOLVelocityGradientMaxZ':Shader3D.PERIOD_SPRITE,'u_VOLSpaceType':Shader3D.PERIOD_SPRITE,'u_SOLSizeGradient':Shader3D.PERIOD_SPRITE,'u_SOLSizeGradientX':Shader3D.PERIOD_SPRITE,'u_SOLSizeGradientY':Shader3D.PERIOD_SPRITE,'u_SOLSizeGradientZ':Shader3D.PERIOD_SPRITE,'u_SOLSizeGradientMax':Shader3D.PERIOD_SPRITE,'u_SOLSizeGradientMaxX':Shader3D.PERIOD_SPRITE,'u_SOLSizeGradientMaxY':Shader3D.PERIOD_SPRITE,'u_SOLSizeGradientMaxZ':Shader3D.PERIOD_SPRITE,'u_ROLAngularVelocityConst':Shader3D.PERIOD_SPRITE,'u_ROLAngularVelocityConstSeprarate':Shader3D.PERIOD_SPRITE,'u_ROLAngularVelocityGradient':Shader3D.PERIOD_SPRITE,'u_ROLAngularVelocityGradientX':Shader3D.PERIOD_SPRITE,'u_ROLAngularVelocityGradientY':Shader3D.PERIOD_SPRITE,'u_ROLAngularVelocityGradientZ':Shader3D.PERIOD_SPRITE,'u_ROLAngularVelocityConstMax':Shader3D.PERIOD_SPRITE,'u_ROLAngularVelocityConstMaxSeprarate':Shader3D.PERIOD_SPRITE,'u_ROLAngularVelocityGradientMax':Shader3D.PERIOD_SPRITE,'u_ROLAngularVelocityGradientMaxX':Shader3D.PERIOD_SPRITE,'u_ROLAngularVelocityGradientMaxY':Shader3D.PERIOD_SPRITE,'u_ROLAngularVelocityGradientMaxZ':Shader3D.PERIOD_SPRITE,'u_ROLAngularVelocityGradientMaxW':Shader3D.PERIOD_SPRITE,'u_TSACycles':Shader3D.PERIOD_SPRITE,'u_TSASubUVLength':Shader3D.PERIOD_SPRITE,'u_TSAGradientUVs':Shader3D.PERIOD_SPRITE,'u_TSAMaxGradientUVs':Shader3D.PERIOD_SPRITE,'u_CameraPos':Shader3D.PERIOD_CAMERA,'u_CameraDirection':Shader3D.PERIOD_CAMERA,'u_CameraUp':Shader3D.PERIOD_CAMERA,'u_View':Shader3D.PERIOD_CAMERA,'u_Projection':Shader3D.PERIOD_CAMERA,'u_FogStart':Shader3D.PERIOD_SCENE,'u_FogRange':Shader3D.PERIOD_SCENE,'u_FogColor':Shader3D.PERIOD_SCENE};stateMap={'s_Cull':Shader3D.RENDER_STATE_CULL,'s_Blend':Shader3D.RENDER_STATE_BLEND,'s_BlendSrc':Shader3D.RENDER_STATE_BLEND_SRC,'s_BlendDst':Shader3D.RENDER_STATE_BLEND_DST,'s_DepthTest':Shader3D.RENDER_STATE_DEPTH_TEST,'s_DepthWrite':Shader3D.RENDER_STATE_DEPTH_WRITE};shader=Shader3D.add("PARTICLESHURIKEN");subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);subShader.addShaderPass(ParticleShuriKenVS,ParticleShuriKenPS,stateMap);attributeMap={'a_Position':VertexMesh.MESH_POSITION0};uniformMap={'u_TintColor':Shader3D.PERIOD_MATERIAL,'u_Exposure':Shader3D.PERIOD_MATERIAL,'u_Rotation':Shader3D.PERIOD_MATERIAL,'u_CubeTexture':Shader3D.PERIOD_MATERIAL,'u_ViewProjection':Shader3D.PERIOD_CAMERA};shader=Shader3D.add("SkyBox");subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);subShader.addShaderPass(SkyBoxVS,SkyBoxPS);attributeMap={'a_Position':VertexMesh.MESH_POSITION0};uniformMap={'u_SunSize':Shader3D.PERIOD_MATERIAL,'u_SunSizeConvergence':Shader3D.PERIOD_MATERIAL,'u_AtmosphereThickness':Shader3D.PERIOD_MATERIAL,'u_SkyTint':Shader3D.PERIOD_MATERIAL,'u_GroundTint':Shader3D.PERIOD_MATERIAL,'u_Exposure':Shader3D.PERIOD_MATERIAL,'u_ViewProjection':Shader3D.PERIOD_CAMERA,'u_SunLight.direction':Shader3D.PERIOD_SCENE,'u_SunLight.color':Shader3D.PERIOD_SCENE};shader=Shader3D.add("SkyBoxProcedural");subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);subShader.addShaderPass(SkyBoxProceduralVS,SkyBoxProceduralPS);attributeMap={'a_Position':VertexMesh.MESH_POSITION0,'a_Normal':VertexMesh.MESH_NORMAL0,'a_Texcoord0':VertexMesh.MESH_TEXTURECOORDINATE0};uniformMap={'u_MvpMatrix':Shader3D.PERIOD_SPRITE,'u_WorldMat':Shader3D.PERIOD_SPRITE,'u_CameraPos':Shader3D.PERIOD_CAMERA,'u_Viewport':Shader3D.PERIOD_CAMERA,'u_ProjectionParams':Shader3D.PERIOD_CAMERA,'u_View':Shader3D.PERIOD_CAMERA,'u_LightmapScaleOffset':Shader3D.PERIOD_SPRITE,'u_LightMap':Shader3D.PERIOD_SPRITE,'u_SplatAlphaTexture':Shader3D.PERIOD_MATERIAL,'u_DiffuseTexture1':Shader3D.PERIOD_MATERIAL,'u_DiffuseTexture2':Shader3D.PERIOD_MATERIAL,'u_DiffuseTexture3':Shader3D.PERIOD_MATERIAL,'u_DiffuseTexture4':Shader3D.PERIOD_MATERIAL,'u_DiffuseTexture5':Shader3D.PERIOD_MATERIAL,'u_DiffuseScaleOffset1':Shader3D.PERIOD_MATERIAL,'u_DiffuseScaleOffset2':Shader3D.PERIOD_MATERIAL,'u_DiffuseScaleOffset3':Shader3D.PERIOD_MATERIAL,'u_DiffuseScaleOffset4':Shader3D.PERIOD_MATERIAL,'u_DiffuseScaleOffset5':Shader3D.PERIOD_MATERIAL,'u_FogStart':Shader3D.PERIOD_SCENE,'u_FogRange':Shader3D.PERIOD_SCENE,'u_FogColor':Shader3D.PERIOD_SCENE,'u_DirationLightCount':Shader3D.PERIOD_SCENE,'u_LightBuffer':Shader3D.PERIOD_SCENE,'u_LightClusterBuffer':Shader3D.PERIOD_SCENE,'u_AmbientColor':Shader3D.PERIOD_SCENE,'u_ShadowMap':Shader3D.PERIOD_SCENE,'u_shadowMap2':Shader3D.PERIOD_SCENE,'u_shadowMap3':Shader3D.PERIOD_SCENE,'u_ShadowSplitSpheres':Shader3D.PERIOD_SCENE,'u_ShadowMatrices':Shader3D.PERIOD_SCENE,'u_ShadowMapSize':Shader3D.PERIOD_SCENE,'u_DirectionLight.color':Shader3D.PERIOD_SCENE,'u_DirectionLight.direction':Shader3D.PERIOD_SCENE,'u_PointLight.position':Shader3D.PERIOD_SCENE,'u_PointLight.range':Shader3D.PERIOD_SCENE,'u_PointLight.color':Shader3D.PERIOD_SCENE,'u_SpotLight.position':Shader3D.PERIOD_SCENE,'u_SpotLight.direction':Shader3D.PERIOD_SCENE,'u_SpotLight.range':Shader3D.PERIOD_SCENE,'u_SpotLight.spot':Shader3D.PERIOD_SCENE,'u_SpotLight.color':Shader3D.PERIOD_SCENE};stateMap={'s_Cull':Shader3D.RENDER_STATE_CULL,'s_Blend':Shader3D.RENDER_STATE_BLEND,'s_BlendSrc':Shader3D.RENDER_STATE_BLEND_SRC,'s_BlendDst':Shader3D.RENDER_STATE_BLEND_DST,'s_DepthTest':Shader3D.RENDER_STATE_DEPTH_TEST,'s_DepthWrite':Shader3D.RENDER_STATE_DEPTH_WRITE};shader=Shader3D.add("ExtendTerrain");subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);subShader.addShaderPass(extendTerrainVS,extendTerrainPS,stateMap);attributeMap={'a_Position':VertexTrail.TRAIL_POSITION0,'a_OffsetVector':VertexTrail.TRAIL_OFFSETVECTOR,'a_Texcoord0X':VertexTrail.TRAIL_TEXTURECOORDINATE0X,'a_Texcoord0Y':VertexTrail.TRAIL_TEXTURECOORDINATE0Y,'a_BirthTime':VertexTrail.TRAIL_TIME0,'a_Color':VertexTrail.TRAIL_COLOR};uniformMap={'u_MvpMatrix':Shader3D.PERIOD_SPRITE,'u_View':Shader3D.PERIOD_CAMERA,'u_Projection':Shader3D.PERIOD_CAMERA,'u_TilingOffset':Shader3D.PERIOD_MATERIAL,'u_MainTexture':Shader3D.PERIOD_MATERIAL,'u_MainColor':Shader3D.PERIOD_MATERIAL,'u_CurTime':Shader3D.PERIOD_SPRITE,'u_LifeTime':Shader3D.PERIOD_SPRITE,'u_WidthCurve':Shader3D.PERIOD_SPRITE,'u_WidthCurveKeyLength':Shader3D.PERIOD_SPRITE,'u_GradientColorkey':Shader3D.PERIOD_SPRITE,'u_GradientAlphakey':Shader3D.PERIOD_SPRITE};stateMap={'s_Cull':Shader3D.RENDER_STATE_CULL,'s_Blend':Shader3D.RENDER_STATE_BLEND,'s_BlendSrc':Shader3D.RENDER_STATE_BLEND_SRC,'s_BlendDst':Shader3D.RENDER_STATE_BLEND_DST,'s_DepthTest':Shader3D.RENDER_STATE_DEPTH_TEST,'s_DepthWrite':Shader3D.RENDER_STATE_DEPTH_WRITE};shader=Shader3D.add("Trail");subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);subShader.addShaderPass(TrailVS,TrailPS,stateMap);attributeMap={'a_Position':VertexMesh.MESH_POSITION0,'a_Normal':VertexMesh.MESH_NORMAL0,'a_Tangent0':VertexMesh.MESH_TANGENT0};uniformMap={'u_MvpMatrix':Shader3D.PERIOD_SPRITE,'u_WorldMat':Shader3D.PERIOD_SPRITE,'u_CameraPos':Shader3D.PERIOD_CAMERA,'u_Time':Shader3D.PERIOD_SCENE,'u_MainTexture':Shader3D.PERIOD_MATERIAL,'u_NormalTexture':Shader3D.PERIOD_MATERIAL,'u_HorizonColor':Shader3D.PERIOD_MATERIAL,'u_WaveScale':Shader3D.PERIOD_MATERIAL,'u_WaveSpeed':Shader3D.PERIOD_MATERIAL};shader=Shader3D.add("WaterPrimary");subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);subShader.addShaderPass(WaterPrimaryVS,WaterPrimaryPS);attributeMap={'a_PositionTexcoord':VertexMesh.MESH_POSITION0};uniformMap={'u_MainTex':Shader3D.PERIOD_MATERIAL,'u_OffsetScale':Shader3D.PERIOD_MATERIAL};shader=Shader3D.add("BlitScreen");subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);var shaderPass=subShader.addShaderPass(BlitScreenVS,BlitScreenPS);var renderState=shaderPass.renderState;renderState.depthTest=RenderState.DEPTHTEST_ALWAYS;renderState.depthWrite=false;renderState.cull=RenderState.CULL_NONE;renderState.blend=RenderState.BLEND_DISABLE;attributeMap={'a_PositionTexcoord':VertexMesh.MESH_POSITION0};uniformMap={'u_MainTex':Shader3D.PERIOD_MATERIAL,'u_BloomTex':Shader3D.PERIOD_MATERIAL,'u_AutoExposureTex':Shader3D.PERIOD_MATERIAL,'u_MainTex_TexelSize':Shader3D.PERIOD_MATERIAL,'u_SampleScale':Shader3D.PERIOD_MATERIAL,'u_Threshold':Shader3D.PERIOD_MATERIAL,'u_Params':Shader3D.PERIOD_MATERIAL};shader=Shader3D.add("PostProcessBloom");subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);shaderPass=subShader.addShaderPass(BloomVS,BloomPrefilter13PS);renderState=shaderPass.renderState;renderState.depthTest=RenderState.DEPTHTEST_ALWAYS;renderState.depthWrite=false;renderState.cull=RenderState.CULL_NONE;renderState.blend=RenderState.BLEND_DISABLE;subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);shaderPass=subShader.addShaderPass(BloomVS,BloomPrefilter4PS);renderState=shaderPass.renderState;renderState.depthTest=RenderState.DEPTHTEST_ALWAYS;renderState.depthWrite=false;renderState.cull=RenderState.CULL_NONE;renderState.blend=RenderState.BLEND_DISABLE;subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);shaderPass=subShader.addShaderPass(BloomVS,BloomDownsample13PS);renderState=shaderPass.renderState;renderState.depthTest=RenderState.DEPTHTEST_ALWAYS;renderState.depthWrite=false;renderState.cull=RenderState.CULL_NONE;renderState.blend=RenderState.BLEND_DISABLE;subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);shaderPass=subShader.addShaderPass(BloomVS,BloomDownsample4PS);renderState=shaderPass.renderState;renderState.depthTest=RenderState.DEPTHTEST_ALWAYS;renderState.depthWrite=false;renderState.cull=RenderState.CULL_NONE;renderState.blend=RenderState.BLEND_DISABLE;subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);shaderPass=subShader.addShaderPass(BloomVS,BloomUpsampleTentPS);renderState=shaderPass.renderState;renderState.depthTest=RenderState.DEPTHTEST_ALWAYS;renderState.depthWrite=false;renderState.cull=RenderState.CULL_NONE;renderState.blend=RenderState.BLEND_DISABLE;subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);shaderPass=subShader.addShaderPass(BloomVS,BloomUpsampleBoxPS);renderState=shaderPass.renderState;renderState.depthTest=RenderState.DEPTHTEST_ALWAYS;renderState.depthWrite=false;renderState.cull=RenderState.CULL_NONE;renderState.blend=RenderState.BLEND_DISABLE;attributeMap={'a_PositionTexcoord':VertexMesh.MESH_POSITION0};uniformMap={'u_MainTex':Shader3D.PERIOD_MATERIAL,'u_BloomTex':Shader3D.PERIOD_MATERIAL,'u_AutoExposureTex':Shader3D.PERIOD_MATERIAL,'u_Bloom_DirtTileOffset':Shader3D.PERIOD_MATERIAL,'u_Bloom_DirtTex':Shader3D.PERIOD_MATERIAL,'u_BloomTex_TexelSize':Shader3D.PERIOD_MATERIAL,'u_Bloom_Settings':Shader3D.PERIOD_MATERIAL,'u_Bloom_Color':Shader3D.PERIOD_MATERIAL};shader=Shader3D.add("PostProcessComposite");subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);shaderPass=subShader.addShaderPass(CompositeVS,CompositePS);renderState=shaderPass.renderState;renderState.depthTest=RenderState.DEPTHTEST_ALWAYS;renderState.depthWrite=false;renderState.cull=RenderState.CULL_NONE;renderState.blend=RenderState.BLEND_DISABLE;};return ShaderInit3D;}();var DirectionLight=/*#__PURE__*/function(_LightSprite){_inheritsLoose(DirectionLight,_LightSprite);function DirectionLight(){var _this83;_this83=_LightSprite.call(this)||this;_this83._direction=new Vector3();_this83._shadowCascadesMode=exports.ShadowCascadesMode.NoCascades;_this83._shadowTwoCascadeSplits=1.0/3.0;_this83._shadowFourCascadeSplits=new Vector3(1.0/15,3.0/15.0,7.0/15.0);_this83._lightType=exports.LightType.Directional;return _this83;}var _proto162=DirectionLight.prototype;_proto162._addToLightQueue=function _addToLightQueue(){this._scene._directionLights.add(this);};_proto162._removeFromLightQueue=function _removeFromLightQueue(){this._scene._directionLights.remove(this);};_createClass(DirectionLight,[{key:"shadowCascadesMode",get:function get(){return this._shadowCascadesMode;},set:function set(value){this._shadowCascadesMode=value;}},{key:"shadowTwoCascadeSplits",get:function get(){return this._shadowTwoCascadeSplits;},set:function set(value){this._shadowTwoCascadeSplits=value;}},{key:"shadowFourCascadeSplits",get:function get(){return this._shadowFourCascadeSplits;},set:function set(value){if(value.x>value.y||value.y>value.z||value.z>1.0)throw "DiretionLight:Invalid value.";value.cloneTo(this._shadowFourCascadeSplits);}}]);return DirectionLight;}(LightSprite);var PointLight=/*#__PURE__*/function(_LightSprite2){_inheritsLoose(PointLight,_LightSprite2);function PointLight(){var _this84;_this84=_LightSprite2.call(this)||this;_this84._range=6.0;_this84._lightType=exports.LightType.Point;return _this84;}var _proto163=PointLight.prototype;_proto163._addToLightQueue=function _addToLightQueue(){this._scene._pointLights.add(this);};_proto163._removeFromLightQueue=function _removeFromLightQueue(){this._scene._pointLights.remove(this);};_proto163._parse=function _parse(data,spriteMap){_LightSprite2.prototype._parse.call(this,data,spriteMap);this.range=data.range;};_createClass(PointLight,[{key:"range",get:function get(){return this._range;},set:function set(value){this._range=value;}}]);return PointLight;}(LightSprite);var SpotLight=/*#__PURE__*/function(_LightSprite3){_inheritsLoose(SpotLight,_LightSprite3);function SpotLight(){var _this85;_this85=_LightSprite3.call(this)||this;_this85._spotAngle=30.0;_this85._range=10.0;_this85._direction=new Vector3();_this85._lightType=exports.LightType.Spot;return _this85;}var _proto164=SpotLight.prototype;_proto164._addToLightQueue=function _addToLightQueue(){this._scene._spotLights.add(this);};_proto164._removeFromLightQueue=function _removeFromLightQueue(){this._scene._spotLights.remove(this);};_proto164._parse=function _parse(data,spriteMap){_LightSprite3.prototype._parse.call(this,data,spriteMap);this.range=data.range;this.spotAngle=data.spotAngle;};_createClass(SpotLight,[{key:"spotAngle",get:function get(){return this._spotAngle;},set:function set(value){this._spotAngle=Math.max(Math.min(value,179),0);}},{key:"range",get:function get(){return this._range;},set:function set(value){this._range=value;}}]);return SpotLight;}(LightSprite);var SimpleSkinnedMeshRenderer=/*#__PURE__*/function(_SkinnedMeshRenderer){_inheritsLoose(SimpleSkinnedMeshRenderer,_SkinnedMeshRenderer);function SimpleSkinnedMeshRenderer(owner){var _this86;_this86=_SkinnedMeshRenderer.call(this,owner)||this;_this86._simpleAnimatorParams=new Vector4();_this86._simpleAnimatorOffset=new Vector2();_this86._shaderValues.addDefine(SkinnedMeshSprite3DShaderDeclaration.SHADERDEFINE_SIMPLEBONE);_this86._shaderValues.addDefine(SkinnedMeshSprite3DShaderDeclaration.SHADERDEFINE_BONE);return _this86;}var _proto165=SimpleSkinnedMeshRenderer.prototype;_proto165._computeAnimatorParamsData=function _computeAnimatorParamsData(){if(this._cacheMesh){this._bonesNums=this.bones.length;this._simpleAnimatorParams.x=this._simpleAnimatorOffset.x;this._simpleAnimatorParams.y=Math.round(this._simpleAnimatorOffset.y)*this._bonesNums*4;}};_proto165._createRenderElement=function _createRenderElement(){return new SubMeshRenderElement();};_proto165._setCacheAnimator=function _setCacheAnimator(animator){this._cacheAnimator=animator;this._shaderValues.addDefine(SkinnedMeshSprite3DShaderDeclaration.SHADERDEFINE_SIMPLEBONE);};_proto165._onMeshChange=function _onMeshChange(value){_SkinnedMeshRenderer.prototype._onMeshChange.call(this,value);this._cacheMesh=value;};_proto165._renderUpdate=function _renderUpdate(context,transform){var element=context.renderElement;switch(element.renderType){case RenderElement.RENDERTYPE_NORMAL:if(this._cacheAnimator){var worldMat=this._cacheAnimator.owner.transform.worldMatrix;this._shaderValues.setMatrix4x4(Sprite3D.WORLDMATRIX,worldMat);}else {this._shaderValues.setMatrix4x4(Sprite3D.WORLDMATRIX,transform.worldMatrix);}this._computeAnimatorParamsData();this._shaderValues.setVector(SimpleSkinnedMeshRenderer.SIMPLE_SIMPLEANIMATORPARAMS,this._simpleAnimatorParams);break;case RenderElement.RENDERTYPE_INSTANCEBATCH:var worldMatrixData=SubMeshInstanceBatch.instance.instanceWorldMatrixData;var insBatches=element.instanceBatchElementList;var elements=insBatches.elements;var count=insBatches.length;if(this._cacheAnimator){for(var i=0;i<count;i++){var mat=elements[i].render._cacheAnimator.owner._transform.worldMatrix;worldMatrixData.set(mat.elements,i*16);}}else {for(var i=0;i<count;i++){worldMatrixData.set(elements[i]._transform.worldMatrix.elements,i*16);}}var worldBuffer=SubMeshInstanceBatch.instance.instanceWorldMatrixBuffer;worldBuffer.orphanStorage();worldBuffer.setData(worldMatrixData.buffer,0,0,count*16*4);this._shaderValues.addDefine(MeshSprite3DShaderDeclaration.SHADERDEFINE_GPU_INSTANCE);var simpleAnimatorData=SubMeshInstanceBatch.instance.instanceSimpleAnimatorData;if(this._cacheAnimator){for(var i=0;i<count;i++){var render=elements[i].render;render._computeAnimatorParamsData();var simpleAnimatorParams=render._simpleAnimatorParams;var offset=i*4;simpleAnimatorData[offset]=simpleAnimatorParams.x;simpleAnimatorData[offset+1]=simpleAnimatorParams.y;}}else {for(var i=0;i<count;i++){simpleAnimatorData[offset]=0;simpleAnimatorData[offset+1]=0;}}var simpleAnimatorBuffer=SubMeshInstanceBatch.instance.instanceSimpleAnimatorBuffer;simpleAnimatorBuffer.orphanStorage();simpleAnimatorBuffer.setData(simpleAnimatorData.buffer,0,0,count*4*4);break;}};_proto165._renderUpdateWithCamera=function _renderUpdateWithCamera(context,transform){var projectionView=context.projectionViewMatrix;if(projectionView){var element=context.renderElement;switch(element.renderType){case RenderElement.RENDERTYPE_NORMAL:if(this._cacheAnimator){var mat=this._cacheAnimator.owner._transform.worldMatrix;Matrix4x4.multiply(projectionView,mat,this._projectionViewWorldMatrix);this._shaderValues.setMatrix4x4(Sprite3D.MVPMATRIX,this._projectionViewWorldMatrix);}else {Matrix4x4.multiply(projectionView,transform.worldMatrix,this._projectionViewWorldMatrix);this._shaderValues.setMatrix4x4(Sprite3D.MVPMATRIX,this._projectionViewWorldMatrix);}break;case RenderElement.RENDERTYPE_INSTANCEBATCH:var mvpMatrixData=SubMeshInstanceBatch.instance.instanceMVPMatrixData;var insBatches=element.instanceBatchElementList;var elements=insBatches.elements;var count=insBatches.length;if(this._cacheAnimator){for(var i=0;i<count;i++){var worldMat=elements[i].render._cacheAnimator.owner._transform.worldMatrix;Utils3D.mulMatrixByArray(projectionView.elements,0,worldMat.elements,0,mvpMatrixData,i*16);}}else {for(var i=0;i<count;i++){var worldMat=elements[i]._transform.worldMatrix;Utils3D.mulMatrixByArray(projectionView.elements,0,worldMat.elements,0,mvpMatrixData,i*16);}}var mvpBuffer=SubMeshInstanceBatch.instance.instanceMVPMatrixBuffer;mvpBuffer.orphanStorage();mvpBuffer.setData(mvpMatrixData.buffer,0,0,count*16*4);break;}}};_proto165._destroy=function _destroy(){if(this._cacheRootBone)!this._cacheRootBone.destroyed&&this._cacheRootBone.transform.off(Laya.Event.TRANSFORM_CHANGED,this,this._onWorldMatNeedChange);this._simpleAnimatorTexture&&this._simpleAnimatorTexture._removeReference();this._simpleAnimatorTexture=null;};_createClass(SimpleSkinnedMeshRenderer,[{key:"simpleAnimatorTexture",get:function get(){return this._simpleAnimatorTexture;},set:function set(value){this._simpleAnimatorTexture=value;this._simpleAnimatorTextureSize=value.width;this._shaderValues.setTexture(SimpleSkinnedMeshRenderer.SIMPLE_SIMPLEANIMATORTEXTURE,value);value._addReference();this._shaderValues.setNumber(SimpleSkinnedMeshRenderer.SIMPLE_SIMPLEANIMATORTEXTURESIZE,this._simpleAnimatorTextureSize);}},{key:"simpleAnimatorOffset",get:function get(){return this._simpleAnimatorOffset;},set:function set(value){value.cloneTo(this._simpleAnimatorOffset);}}]);return SimpleSkinnedMeshRenderer;}(SkinnedMeshRenderer);var SimpleSkinnedMeshSprite3D=/*#__PURE__*/function(_RenderableSprite3D6){_inheritsLoose(SimpleSkinnedMeshSprite3D,_RenderableSprite3D6);function SimpleSkinnedMeshSprite3D(mesh,name){var _this87;if(mesh===void 0){mesh=null;}if(name===void 0){name=null;}_this87=_RenderableSprite3D6.call(this,name)||this;_this87._meshFilter=new MeshFilter(_assertThisInitialized(_this87));_this87._render=new SimpleSkinnedMeshRenderer(_assertThisInitialized(_this87));mesh&&(_this87._meshFilter.sharedMesh=mesh);return _this87;}SimpleSkinnedMeshSprite3D.__init__=function __init__(){SimpleSkinnedMeshRenderer.SIMPLE_SIMPLEANIMATORPARAMS=SimpleSkinnedMeshSprite3D.SIMPLE_SIMPLEANIMATORPARAMS;SimpleSkinnedMeshRenderer.SIMPLE_SIMPLEANIMATORTEXTURE=SimpleSkinnedMeshSprite3D.SIMPLE_SIMPLEANIMATORTEXTURE;SimpleSkinnedMeshRenderer.SIMPLE_SIMPLEANIMATORTEXTURESIZE=SimpleSkinnedMeshSprite3D.SIMPLE_SIMPLEANIMATORTEXTURESIZE;};var _proto166=SimpleSkinnedMeshSprite3D.prototype;_proto166._parse=function _parse(data,spriteMap){_RenderableSprite3D6.prototype._parse.call(this,data,spriteMap);var render=this.simpleSkinnedMeshRenderer;var lightmapIndex=data.lightmapIndex;lightmapIndex!=null&&(render.lightmapIndex=lightmapIndex);var lightmapScaleOffsetArray=data.lightmapScaleOffset;lightmapScaleOffsetArray&&(render.lightmapScaleOffset=new Vector4(lightmapScaleOffsetArray[0],lightmapScaleOffsetArray[1],lightmapScaleOffsetArray[2],lightmapScaleOffsetArray[3]));data.enableRender!=undefined&&(render.enable=data.enableRender);data.receiveShadows!=undefined&&(render.receiveShadow=data.receiveShadows);data.castShadow!=undefined&&(render.castShadow=data.castShadow);var meshPath;meshPath=data.meshPath;if(meshPath){var mesh=Laya.Loader.getRes(meshPath);mesh&&(this.meshFilter.sharedMesh=mesh);}var materials=data.materials;if(materials){var sharedMaterials=render.sharedMaterials;var materialCount=materials.length;sharedMaterials.length=materialCount;for(var i=0;i<materialCount;i++){sharedMaterials[i]=Laya.Loader.getRes(materials[i].path);}render.sharedMaterials=sharedMaterials;}var boundBox=data.boundBox;var min=boundBox.min;var max=boundBox.max;render.localBounds.setMin(new Vector3(min[0],min[1],min[2]));render.localBounds.setMax(new Vector3(max[0],max[1],max[2]));if(spriteMap){var rootBoneData=data.rootBone;render.rootBone=spriteMap[rootBoneData];var bonesData=data.bones;var n;for(i=0,n=bonesData.length;i<n;i++){render.bones.push(spriteMap[bonesData[i]]);}}else {data.rootBone&&render._setRootBone(data.rootBone);}var animatorTexture=data.animatorTexture;if(animatorTexture){var animatortexture=Laya.Loader.getRes(animatorTexture);render.simpleAnimatorTexture=animatortexture;}};_proto166._changeHierarchyAnimator=function _changeHierarchyAnimator(animator){_RenderableSprite3D6.prototype._changeHierarchyAnimator.call(this,animator);this.simpleSkinnedMeshRenderer._setCacheAnimator(animator);};_proto166._cloneTo=function _cloneTo(destObject,srcRoot,dstRoot){var meshSprite3D=destObject;meshSprite3D.meshFilter.sharedMesh=this.meshFilter.sharedMesh;var meshRender=this._render;var destMeshRender=meshSprite3D._render;destMeshRender.enable=meshRender.enable;destMeshRender.sharedMaterials=meshRender.sharedMaterials;destMeshRender.castShadow=meshRender.castShadow;var lightmapScaleOffset=meshRender.lightmapScaleOffset;lightmapScaleOffset&&(destMeshRender.lightmapScaleOffset=lightmapScaleOffset.clone());destMeshRender.receiveShadow=meshRender.receiveShadow;destMeshRender.sortingFudge=meshRender.sortingFudge;destMeshRender._rootBone=meshRender._rootBone;var bones=meshRender.bones;var destBones=destMeshRender.bones;var bonesCount=bones.length;destBones.length=bonesCount;var rootBone=meshRender.rootBone;if(rootBone){var pathes=Utils3D._getHierarchyPath(srcRoot,rootBone,SimpleSkinnedMeshSprite3D._tempArray0);if(pathes)destMeshRender.rootBone=Utils3D._getNodeByHierarchyPath(dstRoot,pathes);else destMeshRender.rootBone=rootBone;}for(var i=0;i<bones.length;i++){pathes=Utils3D._getHierarchyPath(srcRoot,bones[i],SimpleSkinnedMeshSprite3D._tempArray0);if(pathes)destBones[i]=Utils3D._getNodeByHierarchyPath(dstRoot,pathes);else destBones[i]=bones[i];}var lbb=meshRender.localBounds;lbb&&lbb.cloneTo(destMeshRender.localBounds);destMeshRender.simpleAnimatorTexture=meshRender.simpleAnimatorTexture;_RenderableSprite3D6.prototype._cloneTo.call(this,destObject,srcRoot,dstRoot);};_proto166.destroy=function destroy(destroyChild){if(destroyChild===void 0){destroyChild=true;}if(this.destroyed)return;_RenderableSprite3D6.prototype.destroy.call(this,destroyChild);this._meshFilter.destroy();};_proto166._create=function _create(){return new SimpleSkinnedMeshSprite3D();};_createClass(SimpleSkinnedMeshSprite3D,[{key:"meshFilter",get:function get(){return this._meshFilter;}},{key:"simpleSkinnedMeshRenderer",get:function get(){return this._render;}}]);return SimpleSkinnedMeshSprite3D;}(RenderableSprite3D);SimpleSkinnedMeshSprite3D._tempArray0=[];SimpleSkinnedMeshSprite3D.SIMPLE_SIMPLEANIMATORTEXTURE=Shader3D.propertyNameToID("u_SimpleAnimatorTexture");SimpleSkinnedMeshSprite3D.SIMPLE_SIMPLEANIMATORPARAMS=Shader3D.propertyNameToID("u_SimpleAnimatorParams");SimpleSkinnedMeshSprite3D.SIMPLE_SIMPLEANIMATORTEXTURESIZE=Shader3D.propertyNameToID("u_SimpleAnimatorTextureSize");var Scene3DUtils=/*#__PURE__*/function(){function Scene3DUtils(){}Scene3DUtils._createSprite3DInstance=function _createSprite3DInstance(nodeData,spriteMap,outBatchSprites){var node;switch(nodeData.type){case"Scene3D":node=new Scene3D();break;case"Sprite3D":node=new Sprite3D();break;case"MeshSprite3D":node=new MeshSprite3D();outBatchSprites&&nodeData.props.isStatic&&outBatchSprites.push(node);break;case"SkinnedMeshSprite3D":node=new SkinnedMeshSprite3D();break;case"SimpleSkinnedMeshSprite3D":node=new SimpleSkinnedMeshSprite3D();break;case"ShuriKenParticle3D":node=new ShuriKenParticle3D();break;case"Camera":node=new Camera();break;case"DirectionLight":node=new DirectionLight();break;case"PointLight":node=new PointLight();break;case"SpotLight":node=new SpotLight();break;case"TrailSprite3D":node=new TrailSprite3D();break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.");}var childData=nodeData.child;if(childData){for(var i=0,n=childData.length;i<n;i++){var child=Scene3DUtils._createSprite3DInstance(childData[i],spriteMap,outBatchSprites);node.addChild(child);}}spriteMap[nodeData.instanceID]=node;return node;};Scene3DUtils._createComponentInstance=function _createComponentInstance(nodeData,spriteMap,interactMap){var node=spriteMap[nodeData.instanceID];node._parse(nodeData.props,spriteMap);var childData=nodeData.child;if(childData){for(var i=0,n=childData.length;i<n;i++){Scene3DUtils._createComponentInstance(childData[i],spriteMap,interactMap);}}var componentsData=nodeData.components;if(componentsData){for(var j=0,m=componentsData.length;j<m;j++){var data=componentsData[j];var clas=Laya.ClassUtils.getRegClass(data.type);if(clas){var component=node.addComponent(clas);component._parse(data,interactMap);}else {console.warn("Unkown component type.");}}}};Scene3DUtils._createNodeByJson02=function _createNodeByJson02(nodeData,outBatchSprites){var spriteMap={};var interactMap={component:[],data:[]};var node=Scene3DUtils._createSprite3DInstance(nodeData,spriteMap,outBatchSprites);Scene3DUtils._createComponentInstance(nodeData,spriteMap,interactMap);Scene3DUtils._createInteractInstance(interactMap,spriteMap);return node;};Scene3DUtils._createInteractInstance=function _createInteractInstance(interatMap,spriteMap){var components=interatMap.component;var data=interatMap.data;for(var i=0,n=components.length;i<n;i++){components[i]._parseInteractive(data[i],spriteMap);}};Scene3DUtils._parse=function _parse(data,propertyParams,constructParams){var json=data.data;var outBatchSprits=[];var sprite;switch(data.version){case"LAYAHIERARCHY:02":sprite=Scene3DUtils._createNodeByJson02(json,outBatchSprits);break;default:sprite=Scene3DUtils._createNodeByJson(json,outBatchSprits);}StaticBatchManager.combine(sprite,outBatchSprits);return sprite;};Scene3DUtils._parseScene=function _parseScene(data,propertyParams,constructParams){var json=data.data;var outBatchSprits=[];var scene;switch(data.version){case"LAYASCENE3D:02":scene=Scene3DUtils._createNodeByJson02(json,outBatchSprits);break;default:scene=Scene3DUtils._createNodeByJson(json,outBatchSprits);}StaticBatchManager.combine(null,outBatchSprits);return scene;};Scene3DUtils._createNodeByJson=function _createNodeByJson(nodeData,outBatchSprites){var node;switch(nodeData.type){case"Scene3D":node=new Scene3D();break;case"Sprite3D":node=new Sprite3D();break;case"MeshSprite3D":node=new MeshSprite3D();outBatchSprites&&nodeData.props.isStatic&&outBatchSprites.push(node);break;case"SkinnedMeshSprite3D":node=new SkinnedMeshSprite3D();break;case"ShuriKenParticle3D":node=new ShuriKenParticle3D();break;case"Camera":node=new Camera();break;case"DirectionLight":node=new DirectionLight();break;case"PointLight":node=new PointLight();break;case"SpotLight":node=new SpotLight();break;case"TrailSprite3D":node=new TrailSprite3D();break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.");}var childData=nodeData.child;if(childData){for(var i=0,n=childData.length;i<n;i++){var child=Scene3DUtils._createNodeByJson(childData[i],outBatchSprites);node.addChild(child);}}var componentsData=nodeData.components;if(componentsData){for(var j=0,m=componentsData.length;j<m;j++){var data=componentsData[j];var clas=Laya.ClassUtils.getRegClass(data.type);if(clas){var component=node.addComponent(clas);component._parse(data);}else {console.warn("Unkown component type.");}}}node._parse(nodeData.props,null);return node;};return Scene3DUtils;}();var LoadModelV04=/*#__PURE__*/function(){function LoadModelV04(){}LoadModelV04.parse=function parse(readData,version,mesh,subMeshes){LoadModelV04._mesh=mesh;LoadModelV04._subMeshes=subMeshes;LoadModelV04._version=version;LoadModelV04._readData=readData;LoadModelV04.READ_DATA();LoadModelV04.READ_BLOCK();LoadModelV04.READ_STRINGS();for(var i=0,n=LoadModelV04._BLOCK.count;i<n;i++){LoadModelV04._readData.pos=LoadModelV04._BLOCK.blockStarts[i];var index=LoadModelV04._readData.getUint16();var blockName=LoadModelV04._strings[index];var fn=LoadModelV04["READ_"+blockName];if(fn==null)throw new Error("model file err,no this function:"+index+" "+blockName);else fn.call(null);}LoadModelV04._strings.length=0;LoadModelV04._readData=null;LoadModelV04._version=null;LoadModelV04._mesh=null;LoadModelV04._subMeshes=null;};LoadModelV04._readString=function _readString(){return LoadModelV04._strings[LoadModelV04._readData.getUint16()];};LoadModelV04.READ_DATA=function READ_DATA(){LoadModelV04._DATA.offset=LoadModelV04._readData.getUint32();LoadModelV04._DATA.size=LoadModelV04._readData.getUint32();};LoadModelV04.READ_BLOCK=function READ_BLOCK(){var count=LoadModelV04._BLOCK.count=LoadModelV04._readData.getUint16();var blockStarts=LoadModelV04._BLOCK.blockStarts=[];var blockLengths=LoadModelV04._BLOCK.blockLengths=[];for(var i=0;i<count;i++){blockStarts.push(LoadModelV04._readData.getUint32());blockLengths.push(LoadModelV04._readData.getUint32());}};LoadModelV04.READ_STRINGS=function READ_STRINGS(){var offset=LoadModelV04._readData.getUint32();var count=LoadModelV04._readData.getUint16();var prePos=LoadModelV04._readData.pos;LoadModelV04._readData.pos=offset+LoadModelV04._DATA.offset;for(var i=0;i<count;i++){LoadModelV04._strings[i]=LoadModelV04._readData.readUTFString();}LoadModelV04._readData.pos=prePos;};LoadModelV04.READ_MESH=function READ_MESH(){var gl=Laya.LayaGL.instance;var name=LoadModelV04._readString();var arrayBuffer=LoadModelV04._readData.__getBuffer();var i;var memorySize=0;var vertexBufferCount=LoadModelV04._readData.getInt16();var offset=LoadModelV04._DATA.offset;for(i=0;i<vertexBufferCount;i++){var vbStart=offset+LoadModelV04._readData.getUint32();var vbLength=LoadModelV04._readData.getUint32();var vbArrayBuffer=arrayBuffer.slice(vbStart,vbStart+vbLength);var vbDatas=new Float32Array(vbArrayBuffer);var bufferAttribute=LoadModelV04._readString();var vertexDeclaration;switch(LoadModelV04._version){case"LAYAMODEL:0301":case"LAYAMODEL:0400":vertexDeclaration=VertexMesh.getVertexDeclaration(bufferAttribute);break;case"LAYAMODEL:0401":vertexDeclaration=VertexMesh.getVertexDeclaration(bufferAttribute,false);break;default:throw new Error("LoadModelV03: unknown version.");}if(!vertexDeclaration)throw new Error("LoadModelV03: unknown vertexDeclaration.");var vertexBuffer=new VertexBuffer3D(vbDatas.length*4,gl.STATIC_DRAW,true);vertexBuffer.vertexDeclaration=vertexDeclaration;vertexBuffer.setData(vbDatas.buffer);LoadModelV04._mesh._vertexBuffer=vertexBuffer;LoadModelV04._mesh._vertexCount+=vertexBuffer._byteLength/vertexDeclaration.vertexStride;memorySize+=vbDatas.length*4;}var ibStart=offset+LoadModelV04._readData.getUint32();var ibLength=LoadModelV04._readData.getUint32();var ibDatas=new Uint16Array(arrayBuffer.slice(ibStart,ibStart+ibLength));var indexBuffer=new IndexBuffer3D(exports.IndexFormat.UInt16,ibLength/2,gl.STATIC_DRAW,true);indexBuffer.setData(ibDatas);LoadModelV04._mesh._indexBuffer=indexBuffer;memorySize+=indexBuffer.indexCount*2;LoadModelV04._mesh._setBuffer(LoadModelV04._mesh._vertexBuffer,indexBuffer);LoadModelV04._mesh._setCPUMemory(memorySize);LoadModelV04._mesh._setGPUMemory(memorySize);var boneNames=LoadModelV04._mesh._boneNames=[];var boneCount=LoadModelV04._readData.getUint16();boneNames.length=boneCount;for(i=0;i<boneCount;i++){boneNames[i]=LoadModelV04._strings[LoadModelV04._readData.getUint16()];}LoadModelV04._readData.pos+=8;var bindPoseDataStart=LoadModelV04._readData.getUint32();var bindPoseDataLength=LoadModelV04._readData.getUint32();var bindPoseDatas=new Float32Array(arrayBuffer.slice(offset+bindPoseDataStart,offset+bindPoseDataStart+bindPoseDataLength));var bindPoseFloatCount=bindPoseDatas.length;var bindPoseBuffer=LoadModelV04._mesh._inverseBindPosesBuffer=new ArrayBuffer(bindPoseFloatCount*4);LoadModelV04._mesh._inverseBindPoses=[];if(bindPoseFloatCount!=0)LoadModelV04._mesh._instanceBufferStateType=Mesh.MESH_INSTANCEBUFFER_TYPE_SIMPLEANIMATOR;else LoadModelV04._mesh._instanceBufferStateType=Mesh.MESH_INSTANCEBUFFER_TYPE_NORMAL;LoadModelV04._mesh._setInstanceBuffer(LoadModelV04._mesh._instanceBufferStateType);for(i=0;i<bindPoseFloatCount;i+=16){var inverseGlobalBindPose=new Matrix4x4(bindPoseDatas[i+0],bindPoseDatas[i+1],bindPoseDatas[i+2],bindPoseDatas[i+3],bindPoseDatas[i+4],bindPoseDatas[i+5],bindPoseDatas[i+6],bindPoseDatas[i+7],bindPoseDatas[i+8],bindPoseDatas[i+9],bindPoseDatas[i+10],bindPoseDatas[i+11],bindPoseDatas[i+12],bindPoseDatas[i+13],bindPoseDatas[i+14],bindPoseDatas[i+15],new Float32Array(bindPoseBuffer,i*4,16));LoadModelV04._mesh._inverseBindPoses[i/16]=inverseGlobalBindPose;}return true;};LoadModelV04.READ_SUBMESH=function READ_SUBMESH(){var arrayBuffer=LoadModelV04._readData.__getBuffer();var subMesh=new SubMesh(LoadModelV04._mesh);LoadModelV04._readData.getInt16();LoadModelV04._readData.getUint32();LoadModelV04._readData.getUint32();var ibStart=LoadModelV04._readData.getUint32();var ibCount=LoadModelV04._readData.getUint32();var indexBuffer=LoadModelV04._mesh._indexBuffer;subMesh._indexBuffer=indexBuffer;subMesh._setIndexRange(ibStart,ibCount);var vertexBuffer=LoadModelV04._mesh._vertexBuffer;subMesh._vertexBuffer=vertexBuffer;var offset=LoadModelV04._DATA.offset;var subIndexBufferStart=subMesh._subIndexBufferStart;var subIndexBufferCount=subMesh._subIndexBufferCount;var boneIndicesList=subMesh._boneIndicesList;var drawCount=LoadModelV04._readData.getUint16();subIndexBufferStart.length=drawCount;subIndexBufferCount.length=drawCount;boneIndicesList.length=drawCount;var skinnedCache=LoadModelV04._mesh._skinnedMatrixCaches;var subMeshIndex=LoadModelV04._subMeshes.length;skinnedCache.length=LoadModelV04._mesh._inverseBindPoses.length;for(var i=0;i<drawCount;i++){subIndexBufferStart[i]=LoadModelV04._readData.getUint32();subIndexBufferCount[i]=LoadModelV04._readData.getUint32();var boneDicofs=LoadModelV04._readData.getUint32();var boneDicCount=LoadModelV04._readData.getUint32();var boneIndices=boneIndicesList[i]=new Uint16Array(arrayBuffer.slice(offset+boneDicofs,offset+boneDicofs+boneDicCount));var boneIndexCount=boneIndices.length;for(var j=0;j<boneIndexCount;j++){var index=boneIndices[j];skinnedCache[index]||(skinnedCache[index]=new skinnedMatrixCache(subMeshIndex,i,j));}}LoadModelV04._subMeshes.push(subMesh);return true;};return LoadModelV04;}();LoadModelV04._BLOCK={count:0};LoadModelV04._DATA={offset:0,size:0};LoadModelV04._strings=[];var LoadModelV05=/*#__PURE__*/function(){function LoadModelV05(){}LoadModelV05.parse=function parse(readData,version,mesh,subMeshes){LoadModelV05._mesh=mesh;LoadModelV05._subMeshes=subMeshes;LoadModelV05._version=version;LoadModelV05._readData=readData;LoadModelV05.READ_DATA();LoadModelV05.READ_BLOCK();LoadModelV05.READ_STRINGS();for(var i=0,n=LoadModelV05._BLOCK.count;i<n;i++){LoadModelV05._readData.pos=LoadModelV05._BLOCK.blockStarts[i];var index=LoadModelV05._readData.getUint16();var blockName=LoadModelV05._strings[index];var fn=LoadModelV05["READ_"+blockName];if(fn==null)throw new Error("model file err,no this function:"+index+" "+blockName);else fn.call(null);}LoadModelV05._strings.length=0;LoadModelV05._readData=null;LoadModelV05._version=null;LoadModelV05._mesh=null;LoadModelV05._subMeshes=null;};LoadModelV05._readString=function _readString(){return LoadModelV05._strings[LoadModelV05._readData.getUint16()];};LoadModelV05.READ_DATA=function READ_DATA(){LoadModelV05._DATA.offset=LoadModelV05._readData.getUint32();LoadModelV05._DATA.size=LoadModelV05._readData.getUint32();};LoadModelV05.READ_BLOCK=function READ_BLOCK(){var count=LoadModelV05._BLOCK.count=LoadModelV05._readData.getUint16();var blockStarts=LoadModelV05._BLOCK.blockStarts=[];var blockLengths=LoadModelV05._BLOCK.blockLengths=[];for(var i=0;i<count;i++){blockStarts.push(LoadModelV05._readData.getUint32());blockLengths.push(LoadModelV05._readData.getUint32());}};LoadModelV05.READ_STRINGS=function READ_STRINGS(){var offset=LoadModelV05._readData.getUint32();var count=LoadModelV05._readData.getUint16();var prePos=LoadModelV05._readData.pos;LoadModelV05._readData.pos=offset+LoadModelV05._DATA.offset;for(var i=0;i<count;i++){LoadModelV05._strings[i]=LoadModelV05._readData.readUTFString();}LoadModelV05._readData.pos=prePos;};LoadModelV05.READ_MESH=function READ_MESH(){var gl=Laya.LayaGL.instance;var i;var memorySize=0;var name=LoadModelV05._readString();var reader=LoadModelV05._readData;var arrayBuffer=reader.__getBuffer();var vertexBufferCount=reader.getInt16();var offset=LoadModelV05._DATA.offset;for(i=0;i<vertexBufferCount;i++){var vbStart=offset+reader.getUint32();var vertexCount=reader.getUint32();var vertexFlag=LoadModelV05._readString();var vertexDeclaration=VertexMesh.getVertexDeclaration(vertexFlag,false);var vertexStride=vertexDeclaration.vertexStride;var vertexData;var floatData;var uint8Data;var subVertexFlags=vertexFlag.split(",");var subVertexCount=subVertexFlags.length;var mesh=LoadModelV05._mesh;switch(LoadModelV05._version){case"LAYAMODEL:05":case"LAYAMODEL:0501":vertexData=arrayBuffer.slice(vbStart,vbStart+vertexCount*vertexStride);floatData=new Float32Array(vertexData);uint8Data=new Uint8Array(vertexData);break;case"LAYAMODEL:COMPRESSION_05":case"LAYAMODEL:COMPRESSION_0501":vertexData=new ArrayBuffer(vertexStride*vertexCount);floatData=new Float32Array(vertexData);uint8Data=new Uint8Array(vertexData);var lastPosition=reader.pos;reader.pos=vbStart;for(var j=0;j<vertexCount;j++){var subOffset;var verOffset=j*vertexStride;for(var k=0;k<subVertexCount;k++){switch(subVertexFlags[k]){case"POSITION":subOffset=verOffset/4;floatData[subOffset]=HalfFloatUtils.convertToNumber(reader.getUint16());floatData[subOffset+1]=HalfFloatUtils.convertToNumber(reader.getUint16());floatData[subOffset+2]=HalfFloatUtils.convertToNumber(reader.getUint16());verOffset+=12;break;case"NORMAL":subOffset=verOffset/4;floatData[subOffset]=reader.getUint8()/127.5-1;floatData[subOffset+1]=reader.getUint8()/127.5-1;floatData[subOffset+2]=reader.getUint8()/127.5-1;verOffset+=12;break;case"COLOR":subOffset=verOffset/4;floatData[subOffset]=reader.getUint8()/255;floatData[subOffset+1]=reader.getUint8()/255;floatData[subOffset+2]=reader.getUint8()/255;floatData[subOffset+3]=reader.getUint8()/255;verOffset+=16;break;case"UV":subOffset=verOffset/4;floatData[subOffset]=HalfFloatUtils.convertToNumber(reader.getUint16());floatData[subOffset+1]=HalfFloatUtils.convertToNumber(reader.getUint16());verOffset+=8;break;case"UV1":subOffset=verOffset/4;floatData[subOffset]=HalfFloatUtils.convertToNumber(reader.getUint16());floatData[subOffset+1]=HalfFloatUtils.convertToNumber(reader.getUint16());verOffset+=8;break;case"BLENDWEIGHT":subOffset=verOffset/4;floatData[subOffset]=reader.getUint8()/255;floatData[subOffset+1]=reader.getUint8()/255;floatData[subOffset+2]=reader.getUint8()/255;floatData[subOffset+3]=reader.getUint8()/255;verOffset+=16;break;case"BLENDINDICES":uint8Data[verOffset]=reader.getUint8();uint8Data[verOffset+1]=reader.getUint8();uint8Data[verOffset+2]=reader.getUint8();uint8Data[verOffset+3]=reader.getUint8();verOffset+=4;break;case"TANGENT":subOffset=verOffset/4;floatData[subOffset]=reader.getUint8()/127.5-1;floatData[subOffset+1]=reader.getUint8()/127.5-1;floatData[subOffset+2]=reader.getUint8()/127.5-1;floatData[subOffset+3]=reader.getUint8()/127.5-1;verOffset+=16;break;}}}reader.pos=lastPosition;break;}var vertexBuffer=new VertexBuffer3D(vertexData.byteLength,gl.STATIC_DRAW,true);vertexBuffer.vertexDeclaration=vertexDeclaration;vertexBuffer.setData(vertexData);var vertexCount=vertexBuffer._byteLength/vertexDeclaration.vertexStride;if(vertexCount>65535)mesh._indexFormat=exports.IndexFormat.UInt32;else mesh._indexFormat=exports.IndexFormat.UInt16;mesh._vertexBuffer=vertexBuffer;mesh._vertexCount+=vertexCount;memorySize+=floatData.length*4;}var ibStart=offset+reader.getUint32();var ibLength=reader.getUint32();var ibDatas;if(mesh.indexFormat==exports.IndexFormat.UInt32)ibDatas=new Uint32Array(arrayBuffer.slice(ibStart,ibStart+ibLength));else ibDatas=new Uint16Array(arrayBuffer.slice(ibStart,ibStart+ibLength));var indexBuffer=new IndexBuffer3D(mesh.indexFormat,ibDatas.length,gl.STATIC_DRAW,true);indexBuffer.setData(ibDatas);mesh._indexBuffer=indexBuffer;mesh._setBuffer(mesh._vertexBuffer,indexBuffer);memorySize+=indexBuffer.indexCount*2;mesh._setCPUMemory(memorySize);mesh._setGPUMemory(memorySize);if(LoadModelV05._version=="LAYAMODEL:0501"||LoadModelV05._version=="LAYAMODEL:COMPRESSION_0501"){var bounds=mesh.bounds;var min=bounds.getMin();var max=bounds.getMax();min.setValue(reader.getFloat32(),reader.getFloat32(),reader.getFloat32());max.setValue(reader.getFloat32(),reader.getFloat32(),reader.getFloat32());bounds.setMin(min);bounds.setMax(max);mesh.bounds=bounds;}var boneNames=mesh._boneNames=[];var boneCount=reader.getUint16();boneNames.length=boneCount;for(i=0;i<boneCount;i++){boneNames[i]=LoadModelV05._strings[reader.getUint16()];}var bindPoseDataStart=reader.getUint32();var bindPoseDataLength=reader.getUint32();var bindPoseDatas=new Float32Array(arrayBuffer.slice(offset+bindPoseDataStart,offset+bindPoseDataStart+bindPoseDataLength));var bindPoseFloatCount=bindPoseDatas.length;var bindPoseBuffer=mesh._inverseBindPosesBuffer=new ArrayBuffer(bindPoseFloatCount*4);mesh._inverseBindPoses=[];if(bindPoseFloatCount!=0)mesh._instanceBufferStateType=Mesh.MESH_INSTANCEBUFFER_TYPE_SIMPLEANIMATOR;else mesh._instanceBufferStateType=Mesh.MESH_INSTANCEBUFFER_TYPE_NORMAL;mesh._setInstanceBuffer(mesh._instanceBufferStateType);for(i=0;i<bindPoseFloatCount;i+=16){var inverseGlobalBindPose=new Matrix4x4(bindPoseDatas[i+0],bindPoseDatas[i+1],bindPoseDatas[i+2],bindPoseDatas[i+3],bindPoseDatas[i+4],bindPoseDatas[i+5],bindPoseDatas[i+6],bindPoseDatas[i+7],bindPoseDatas[i+8],bindPoseDatas[i+9],bindPoseDatas[i+10],bindPoseDatas[i+11],bindPoseDatas[i+12],bindPoseDatas[i+13],bindPoseDatas[i+14],bindPoseDatas[i+15],new Float32Array(bindPoseBuffer,i*4,16));mesh._inverseBindPoses[i/16]=inverseGlobalBindPose;}return true;};LoadModelV05.READ_SUBMESH=function READ_SUBMESH(){var reader=LoadModelV05._readData;var arrayBuffer=reader.__getBuffer();var subMesh=new SubMesh(LoadModelV05._mesh);reader.getInt16();var ibStart=reader.getUint32();var ibCount=reader.getUint32();var indexBuffer=LoadModelV05._mesh._indexBuffer;subMesh._indexBuffer=indexBuffer;subMesh._setIndexRange(ibStart,ibCount);var vertexBuffer=LoadModelV05._mesh._vertexBuffer;subMesh._vertexBuffer=vertexBuffer;var offset=LoadModelV05._DATA.offset;var subIndexBufferStart=subMesh._subIndexBufferStart;var subIndexBufferCount=subMesh._subIndexBufferCount;var boneIndicesList=subMesh._boneIndicesList;var drawCount=reader.getUint16();subIndexBufferStart.length=drawCount;subIndexBufferCount.length=drawCount;boneIndicesList.length=drawCount;var skinnedCache=LoadModelV05._mesh._skinnedMatrixCaches;var subMeshIndex=LoadModelV05._subMeshes.length;skinnedCache.length=LoadModelV05._mesh._inverseBindPoses.length;for(var i=0;i<drawCount;i++){subIndexBufferStart[i]=reader.getUint32();subIndexBufferCount[i]=reader.getUint32();var boneDicofs=reader.getUint32();var boneDicCount=reader.getUint32();var boneIndices=boneIndicesList[i]=new Uint16Array(arrayBuffer.slice(offset+boneDicofs,offset+boneDicofs+boneDicCount));for(var j=0,m=boneIndices.length;j<m;j++){var index=boneIndices[j];skinnedCache[index]||(skinnedCache[index]=new skinnedMatrixCache(subMeshIndex,i,j));}}LoadModelV05._subMeshes.push(subMesh);return true;};return LoadModelV05;}();LoadModelV05._BLOCK={count:0};LoadModelV05._DATA={offset:0,size:0};LoadModelV05._strings=[];var MeshReader=/*#__PURE__*/function(){function MeshReader(){}MeshReader._parse=function _parse(data,propertyParams,constructParams){var mesh=new Mesh();MeshReader.read(data,mesh,mesh._subMeshes);return mesh;};MeshReader.read=function read(data,mesh,subMeshes){var readData=new Laya.Byte(data);readData.pos=0;var version=readData.readUTFString();switch(version){case"LAYAMODEL:0301":case"LAYAMODEL:0400":case"LAYAMODEL:0401":LoadModelV04.parse(readData,version,mesh,subMeshes);break;case"LAYAMODEL:05":case"LAYAMODEL:COMPRESSION_05":case"LAYAMODEL:0501":case"LAYAMODEL:COMPRESSION_0501":LoadModelV05.parse(readData,version,mesh,subMeshes);break;default:throw new Error("MeshReader: unknown mesh version.");}mesh._setSubMeshes(subMeshes);if(version!="LAYAMODEL:0501"&&version!="LAYAMODEL:COMPRESSION_0501")mesh.calculateBounds();};return MeshReader;}();var SkyPanoramicFS="#ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#define PI 3.14159265359\n#include \"Lighting.glsl\";\n\nuniform sampler2D u_Texture;\nuniform vec4 u_TextureHDRParams;\nuniform vec4 u_TintColor;\n\nvarying vec3 v_Texcoord;\nvarying vec2 v_Image180ScaleAndCutoff;\nvarying vec4 v_Layout3DScaleAndOffset;\n\nvec2 ToRadialCoords(vec3 coords)\n{\n\tvec3 normalizedCoords = normalize(coords);\n\tfloat latitude = acos(normalizedCoords.y);\n\tfloat longitude = atan(normalizedCoords.z,normalizedCoords.x);\n\tvec2 sphereCoords = vec2(longitude, latitude) * vec2(0.5/PI, 1.0/PI);\n\treturn vec2(0.5,1.0) - sphereCoords;\n}\n\n\nvoid main()\n{\t\n\tvec2 tc = ToRadialCoords(v_Texcoord);\n\tif (tc.x > v_Image180ScaleAndCutoff.y)\n\t\tgl_FragColor=vec4(0,0,0,1);\n\ttc.x = mod(tc.x*v_Image180ScaleAndCutoff.x, 1.0);\n\ttc = (tc + v_Layout3DScaleAndOffset.xy) * v_Layout3DScaleAndOffset.zw;\n\n\tmediump vec4 tex = texture2D (u_Texture, tc);\n\tmediump vec3 c = decodeHDR (tex, u_TextureHDRParams.x);\n\tc = c * u_TintColor.rgb * 2.0;//Gamma Space is 2.0,linear space is 4.59479380\n\tgl_FragColor=vec4(c, 1.0);\n}\n\n";var SkyPanoramicVS="#include \"Lighting.glsl\";\n\n#define PI 3.14159265359\n\nattribute vec4 a_Position;\n\nuniform mat4 u_ViewProjection;\nuniform float u_Rotation;\n\nvarying vec3 v_Texcoord;\nvarying vec2 v_Image180ScaleAndCutoff;\nvarying vec4 v_Layout3DScaleAndOffset;\n\nvec4 rotateAroundYInDegrees (vec4 vertex, float degrees)\n{\n\tfloat angle = degrees * PI / 180.0;\n\tfloat sina=sin(angle);\n\tfloat cosa=cos(angle);\n\tmat2 m = mat2(cosa, -sina, sina, cosa);\n\treturn vec4(m*vertex.xz, vertex.yw).xzyw;\n}\n\n\t\t\nvoid main()\n{\n\tvec4 position = rotateAroundYInDegrees(a_Position, u_Rotation);\n\tgl_Position = u_ViewProjection*position;\n\n\tv_Texcoord=vec3(-a_Position.x,-a_Position.y,a_Position.z);// NOTE: -a_Position.x convert coords system\n\n\t// Calculate constant horizontal scale and cutoff for 180 (vs 360) image type\n\tv_Image180ScaleAndCutoff = vec2(1.0, 1.0);// 360 degree mode\n\n\t// Calculate constant scale and offset for 3D layouts\n\tv_Layout3DScaleAndOffset = vec4(0,0,1,1);\n}\n";var SkyPanoramicMaterial=/*#__PURE__*/function(_Material12){_inheritsLoose(SkyPanoramicMaterial,_Material12);function SkyPanoramicMaterial(){var _this88;_this88=_Material12.call(this)||this;_this88._exposure=1.0;_this88._textureDecodeFormat=Laya.TextureDecodeFormat.Normal;_this88._textureHDRParams=new Vector4(1.0,0.0,0.0,1.0);_this88.setShaderName("SkyPanoramic");var shaderValues=_this88._shaderValues;shaderValues.setVector(SkyPanoramicMaterial.TINTCOLOR,new Vector4(0.5,0.5,0.5,0.5));shaderValues.setNumber(SkyPanoramicMaterial.ROTATION,0.0);shaderValues.setVector(SkyPanoramicMaterial.TEXTURE_HDR_PARAMS,_this88._textureHDRParams);return _this88;}SkyPanoramicMaterial.__init__=function __init__(){var attributeMap={'a_Position':VertexMesh.MESH_POSITION0};var uniformMap={'u_TintColor':Shader3D.PERIOD_MATERIAL,'u_TextureHDRParams':Shader3D.PERIOD_MATERIAL,'u_Rotation':Shader3D.PERIOD_MATERIAL,'u_Texture':Shader3D.PERIOD_MATERIAL,'u_ViewProjection':Shader3D.PERIOD_CAMERA};var shader=Shader3D.add("SkyPanoramic");var subShader=new SubShader(attributeMap,uniformMap);shader.addSubShader(subShader);subShader.addShaderPass(SkyPanoramicVS,SkyPanoramicFS);};_createClass(SkyPanoramicMaterial,[{key:"tintColor",get:function get(){return this._shaderValues.getVector(SkyPanoramicMaterial.TINTCOLOR);},set:function set(value){this._shaderValues.setVector(SkyPanoramicMaterial.TINTCOLOR,value);}},{key:"exposure",get:function get(){return this._exposure;},set:function set(value){if(this._exposure!==value){this._exposure=value;if(this._textureDecodeFormat==Laya.TextureDecodeFormat.RGBM)this._textureHDRParams.x=value*Laya.BaseTexture._rgbmRange;else this._textureHDRParams.x=value;}}},{key:"rotation",get:function get(){return this._shaderValues.getNumber(SkyPanoramicMaterial.ROTATION);},set:function set(value){this._shaderValues.setNumber(SkyPanoramicMaterial.ROTATION,value);}},{key:"panoramicTexture",get:function get(){return this._shaderValues.getTexture(SkyPanoramicMaterial.TEXTURE);},set:function set(value){this._shaderValues.setTexture(SkyPanoramicMaterial.TEXTURE,value);}},{key:"panoramicTextureDecodeFormat",get:function get(){return this._textureDecodeFormat;},set:function set(value){if(this._textureDecodeFormat!==value){this._textureDecodeFormat=value;if(value==Laya.TextureDecodeFormat.RGBM)this._textureHDRParams.x=this._exposure*Laya.BaseTexture._rgbmRange;else this._textureHDRParams.x=this._exposure;}}}]);return SkyPanoramicMaterial;}(Material);SkyPanoramicMaterial.TINTCOLOR=Shader3D.propertyNameToID("u_TintColor");SkyPanoramicMaterial.EXPOSURE=Shader3D.propertyNameToID("u_Exposure");SkyPanoramicMaterial.ROTATION=Shader3D.propertyNameToID("u_Rotation");SkyPanoramicMaterial.TEXTURE=Shader3D.propertyNameToID("u_Texture");SkyPanoramicMaterial.TEXTURE_HDR_PARAMS=Shader3D.propertyNameToID("u_TextureHDRParams");var ConstraintComponent=/*#__PURE__*/function(_Laya$Component3){_inheritsLoose(ConstraintComponent,_Laya$Component3);function ConstraintComponent(constraintType){var _this89;_this89=_Laya$Component3.call(this)||this;_this89._anchor=new Vector3();_this89._connectAnchor=new Vector3();_this89._feedbackEnabled=false;_this89._getJointFeedBack=false;_this89._currentForce=new Vector3();_this89._currentTorque=new Vector3();_this89._constraintType=constraintType;var bt=Physics3D._bullet;_this89._btframATrans=bt.btTransform_create();_this89._btframBTrans=bt.btTransform_create();bt.btTransform_setIdentity(_this89._btframATrans);bt.btTransform_setIdentity(_this89._btframBTrans);_this89._btframAPos=bt.btVector3_create(0,0,0);_this89._btframBPos=bt.btVector3_create(0,0,0);bt.btTransform_setOrigin(_this89._btframATrans,_this89._btframAPos);bt.btTransform_setOrigin(_this89._btframBTrans,_this89._btframBPos);_this89._breakForce=-1;_this89._breakTorque=-1;return _this89;}var _proto167=ConstraintComponent.prototype;_proto167.setOverrideNumSolverIterations=function setOverrideNumSolverIterations(overideNumIterations){var bt=Physics3D._bullet;bt.btTypedConstraint_setOverrideNumSolverIterations(this._btConstraint,overideNumIterations);};_proto167.setConstraintEnabled=function setConstraintEnabled(enable){var bt=Physics3D._bullet;bt.btTypedConstraint_setEnabled(this._btConstraint,enable);};_proto167._onEnable=function _onEnable(){_Laya$Component3.prototype._onEnable.call(this);this.enabled=true;};_proto167._onDisable=function _onDisable(){_Laya$Component3.prototype._onDisable.call(this);this.enabled=false;};_proto167.setFrames=function setFrames(){var bt=Physics3D._bullet;bt.btVector3_setValue(this._btframAPos,-this._anchor.x,this.anchor.y,this.anchor.z);bt.btVector3_setValue(this._btframBPos,-this._connectAnchor.x,this._connectAnchor.y,this._connectAnchor.z);bt.btTransform_setOrigin(this._btframATrans,this._btframAPos);bt.btTransform_setOrigin(this._btframBTrans,this._btframBPos);};_proto167._addToSimulation=function _addToSimulation(){};_proto167._removeFromSimulation=function _removeFromSimulation(){};_proto167._createConstraint=function _createConstraint(){};_proto167.setConnectRigidBody=function setConnectRigidBody(ownerRigid,connectRigidBody){var ownerCanInSimulation=ownerRigid&&!!(ownerRigid._simulation&&ownerRigid._enabled&&ownerRigid.colliderShape);var connectCanInSimulation=connectRigidBody&&!!(connectRigidBody._simulation&&connectRigidBody._enabled&&connectRigidBody.colliderShape);if(!(ownerCanInSimulation&&connectCanInSimulation))throw "ownerRigid or connectRigidBody is not in Simulation";if(ownerRigid!=this._ownBody||connectRigidBody!=this._connectedBody){var canInSimulation=!!(this.enabled&&this._simulation);canInSimulation&&this._removeFromSimulation();this._ownBody=ownerRigid;this._connectedBody=connectRigidBody;this._ownBody.constaintRigidbodyA=this;this._connectedBody.constaintRigidbodyB=this;this._createConstraint();}};_proto167.getcurrentForce=function getcurrentForce(out){if(!this._btJointFeedBackObj)throw "this Constraint is not simulation";var bt=Physics3D._bullet;var applyForce=bt.btJointFeedback_getAppliedForceBodyA(this._btJointFeedBackObj);out.setValue(bt.btVector3_x(applyForce),bt.btVector3_y(applyForce),bt.btVector3_z(applyForce));return;};_proto167.getcurrentTorque=function getcurrentTorque(out){if(!this._btJointFeedBackObj)throw "this Constraint is not simulation";var bt=Physics3D._bullet;var applyTorque=bt.btJointFeedback_getAppliedTorqueBodyA(this._btJointFeedBackObj);out.setValue(bt.btVector3_x(applyTorque),bt.btVector3_y(applyTorque),bt.btVector3_z(applyTorque));return;};_proto167._onDestroy=function _onDestroy(){var physics3D=Physics3D._bullet;this._removeFromSimulation();if(this._btConstraint&&this._btJointFeedBackObj&&this._simulation){physics3D.btTypedConstraint_destroy(this._btConstraint);physics3D.btJointFeedback_destroy(this._btJointFeedBackObj);this._btJointFeedBackObj=null;this._btConstraint=null;}_Laya$Component3.prototype._onDisable.call(this);};_proto167._isBreakConstrained=function _isBreakConstrained(){this._getJointFeedBack=false;if(this.breakForce==-1&&this.breakTorque==-1)return false;this._getFeedBackInfo();var isBreakForce=this._breakForce!=-1&&Vector3.scalarLength(this._currentForce)>this._breakForce;var isBreakTorque=this._breakTorque!=-1&&Vector3.scalarLength(this._currentTorque)>this._breakTorque;if(isBreakForce||isBreakTorque){this._breakConstrained();return true;}return false;};_proto167._parse=function _parse(data){this._anchor.fromArray(data.anchor);this._connectAnchor.fromArray(data.connectAnchor);this.setFrames();};_proto167._getFeedBackInfo=function _getFeedBackInfo(){var bt=Physics3D._bullet;var applyForce=bt.btJointFeedback_getAppliedForceBodyA(this._btJointFeedBackObj);var applyTorque=bt.btJointFeedback_getAppliedTorqueBodyA(this._btJointFeedBackObj);this._currentTorque.setValue(bt.btVector3_x(applyTorque),bt.btVector3_y(applyTorque),bt.btVector3_z(applyTorque));this._currentForce.setValue(bt.btVector3_x(applyForce),bt.btVector3_y(applyForce),bt.btVector3_z(applyForce));this._getJointFeedBack=true;};_proto167._breakConstrained=function _breakConstrained(){this.ownBody.constaintRigidbodyA=null;this.connectedBody.constaintRigidbodyB=null;this.destroy();};_createClass(ConstraintComponent,[{key:"enabled",get:function get(){return _Laya$Component3.prototype.enabled;},set:function set(value){this.enabled=value;}},{key:"appliedImpulse",get:function get(){if(!this._feedbackEnabled){this._btConstraint.EnableFeedback(true);this._feedbackEnabled=true;}return this._btConstraint.AppliedImpulse;}},{key:"connectedBody",set:function set(value){this._connectedBody=value;value.constaintRigidbodyB=this;},get:function get(){return this._connectedBody;}},{key:"ownBody",get:function get(){return this._ownBody;},set:function set(value){this._ownBody=value;value.constaintRigidbodyA=this;}},{key:"currentForce",get:function get(){if(!this._getJointFeedBack)this._getFeedBackInfo();return this._currentForce;}},{key:"currentTorque",get:function get(){if(!this._getJointFeedBack)this._getFeedBackInfo();return this._currentTorque;}},{key:"breakForce",get:function get(){return this._breakForce;},set:function set(value){this._breakForce=value;}},{key:"breakTorque",get:function get(){return this._breakTorque;},set:function set(value){this._breakTorque=value;}},{key:"anchor",set:function set(value){value.cloneTo(this._anchor);this.setFrames();},get:function get(){return this._anchor;}},{key:"connectAnchor",set:function set(value){value.cloneTo(this._connectAnchor);this.setFrames();},get:function get(){return this._connectAnchor;}}]);return ConstraintComponent;}(Laya.Component);ConstraintComponent.CONSTRAINT_POINT2POINT_CONSTRAINT_TYPE=3;ConstraintComponent.CONSTRAINT_HINGE_CONSTRAINT_TYPE=4;ConstraintComponent.CONSTRAINT_CONETWIST_CONSTRAINT_TYPE=5;ConstraintComponent.CONSTRAINT_D6_CONSTRAINT_TYPE=6;ConstraintComponent.CONSTRAINT_SLIDER_CONSTRAINT_TYPE=7;ConstraintComponent.CONSTRAINT_CONTACT_CONSTRAINT_TYPE=8;ConstraintComponent.CONSTRAINT_D6_SPRING_CONSTRAINT_TYPE=9;ConstraintComponent.CONSTRAINT_GEAR_CONSTRAINT_TYPE=10;ConstraintComponent.CONSTRAINT_FIXED_CONSTRAINT_TYPE=11;ConstraintComponent.CONSTRAINT_MAX_CONSTRAINT_TYPE=12;ConstraintComponent.CONSTRAINT_CONSTRAINT_ERP=1;ConstraintComponent.CONSTRAINT_CONSTRAINT_STOP_ERP=2;ConstraintComponent.CONSTRAINT_CONSTRAINT_CFM=3;ConstraintComponent.CONSTRAINT_CONSTRAINT_STOP_CFM=4;ConstraintComponent.tempForceV3=new Vector3();var FixedConstraint=/*#__PURE__*/function(_ConstraintComponent){_inheritsLoose(FixedConstraint,_ConstraintComponent);function FixedConstraint(){var _this90;_this90=_ConstraintComponent.call(this,ConstraintComponent.CONSTRAINT_FIXED_CONSTRAINT_TYPE)||this;_this90.breakForce=-1;_this90.breakTorque=-1;return _this90;}var _proto168=FixedConstraint.prototype;_proto168._addToSimulation=function _addToSimulation(){this._simulation&&this._simulation.addConstraint(this,this.enabled);};_proto168._removeFromSimulation=function _removeFromSimulation(){this._simulation.removeConstraint(this);this._simulation=null;};_proto168._createConstraint=function _createConstraint(){if(this.ownBody&&this.ownBody._simulation&&this.connectedBody&&this.connectedBody._simulation){var bt=Physics3D._bullet;this._btConstraint=bt.btFixedConstraint_create(this.ownBody.btColliderObject,this._btframATrans,this.connectedBody.btColliderObject,this._btframBTrans);this._btJointFeedBackObj=bt.btJointFeedback_create(this._btConstraint);bt.btTypedConstraint_setJointFeedback(this._btConstraint,this._btJointFeedBackObj);this._simulation=this.owner._scene.physicsSimulation;this._addToSimulation();Physics3D._bullet.btTypedConstraint_setEnabled(this._btConstraint,true);}};_proto168._onAdded=function _onAdded(){_ConstraintComponent.prototype._onAdded.call(this);};_proto168._onEnable=function _onEnable(){if(!this._btConstraint)return;_ConstraintComponent.prototype._onEnable.call(this);if(this._btConstraint)Physics3D._bullet.btTypedConstraint_setEnabled(this._btConstraint,true);};_proto168._onDisable=function _onDisable(){_ConstraintComponent.prototype._onDisable.call(this);if(!this.connectedBody)this._removeFromSimulation();if(this._btConstraint)Physics3D._bullet.btTypedConstraint_setEnabled(this._btConstraint,false);};_proto168._onDestroy=function _onDestroy(){_ConstraintComponent.prototype._onDestroy.call(this);};_proto168._parse=function _parse(data,interactMap){if(interactMap===void 0){interactMap=null;}_ConstraintComponent.prototype._parse.call(this,data);if(data.rigidbodyID!=-1&&data.connectRigidbodyID!=-1){interactMap.component.push(this);interactMap.data.push(data);}data.breakForce!=undefined&&(this.breakForce=data.breakForce);data.breakTorque!=undefined&&(this.breakTorque=data.breakTorque);};_proto168._parseInteractive=function _parseInteractive(data,spriteMap){if(data===void 0){data=null;}if(spriteMap===void 0){spriteMap=null;}var rigidBodySprite=spriteMap[data.rigidbodyID];var rigidBody=rigidBodySprite.getComponent(Rigidbody3D);var connectSprite=spriteMap[data.connectRigidbodyID];var connectRigidbody=connectSprite.getComponent(Rigidbody3D);this.ownBody=rigidBody;this.connectedBody=connectRigidbody;};_proto168._cloneTo=function _cloneTo(dest){};return FixedConstraint;}(ConstraintComponent);var ConfigurableConstraint=/*#__PURE__*/function(_ConstraintComponent2){_inheritsLoose(ConfigurableConstraint,_ConstraintComponent2);function ConfigurableConstraint(){var _this91;_this91=_ConstraintComponent2.call(this,ConstraintComponent.CONSTRAINT_D6_SPRING_CONSTRAINT_TYPE)||this;_this91._axis=new Vector3();_this91._secondaryAxis=new Vector3();_this91._minLinearLimit=new Vector3();_this91._maxLinearLimit=new Vector3();_this91._minAngularLimit=new Vector3();_this91._maxAngularLimit=new Vector3();_this91._linearLimitSpring=new Vector3();_this91._angularLimitSpring=new Vector3();_this91._linearBounce=new Vector3();_this91._angularBounce=new Vector3();_this91._linearDamp=new Vector3();_this91._angularDamp=new Vector3();_this91._xMotion=0;_this91._yMotion=0;_this91._zMotion=0;_this91._angularXMotion=0;_this91._angularYMotion=0;_this91._angularZMotion=0;var bt=Physics3D._bullet;_this91._btAxis=bt.btVector3_create(-1.0,0.0,0.0);_this91._btSecondaryAxis=bt.btVector3_create(0.0,1.0,0.0);return _this91;}var _proto169=ConfigurableConstraint.prototype;_proto169.setAxis=function setAxis(axis,secondaryAxis){if(!this._btConstraint)return;var bt=Physics3D._bullet;this._axis.setValue(axis.x,axis.y,axis.y);this._secondaryAxis.setValue(secondaryAxis.x,secondaryAxis.y,secondaryAxis.z);this._btAxis=bt.btVector3_setValue(-axis.x,axis.y,axis.z);this._btSecondaryAxis=bt.btVector3_setValue(-secondaryAxis.x,secondaryAxis.y,secondaryAxis.z);bt.btGeneric6DofSpring2Constraint_setAxis(this._btConstraint,this._btAxis,this._btSecondaryAxis);};_proto169.setLimit=function setLimit(axis,motionType,low,high){if(!this._btConstraint)return;var bt=Physics3D._bullet;switch(motionType){case ConfigurableConstraint.CONFIG_MOTION_TYPE_LOCKED:bt.btGeneric6DofSpring2Constraint_setLimit(this._btConstraint,axis,0,0);break;case ConfigurableConstraint.CONFIG_MOTION_TYPE_LIMITED:if(low<high)bt.btGeneric6DofSpring2Constraint_setLimit(this._btConstraint,axis,low,high);break;case ConfigurableConstraint.CONFIG_MOTION_TYPE_FREE:bt.btGeneric6DofSpring2Constraint_setLimit(this._btConstraint,axis,1,0);break;default:throw "No Type of Axis Motion";}};_proto169.setSpring=function setSpring(axis,springValue,limitIfNeeded){if(limitIfNeeded===void 0){limitIfNeeded=true;}if(!this._btConstraint)return;var bt=Physics3D._bullet;var enableSpring=springValue>0;bt.btGeneric6DofSpring2Constraint_enableSpring(this._btConstraint,axis,enableSpring);if(enableSpring)bt.btGeneric6DofSpring2Constraint_setStiffness(this._btConstraint,axis,springValue,limitIfNeeded);};_proto169.setBounce=function setBounce(axis,bounce){if(!this._btConstraint)return;var bt=Physics3D._bullet;bounce=bounce<=0?0:bounce;bt.btGeneric6DofSpring2Constraint_setBounce(this._btConstraint,axis,bounce);};_proto169.setDamping=function setDamping(axis,damp,limitIfNeeded){if(limitIfNeeded===void 0){limitIfNeeded=true;}if(!this._btConstraint)return;var bt=Physics3D._bullet;damp=damp<=0?0:damp;bt.btGeneric6DofSpring2Constraint_setDamping(this._btConstraint,axis,damp,limitIfNeeded);};_proto169.setEquilibriumPoint=function setEquilibriumPoint(axis,equilibriumPoint){var bt=Physics3D._bullet;bt.btGeneric6DofSpring2Constraint_setEquilibriumPoint(this._btConstraint,axis,equilibriumPoint);};_proto169.enableMotor=function enableMotor(axis,isEnableMotor){var bt=Physics3D._bullet;bt.btGeneric6DofSpring2Constraint_enableMotor(this._btConstraint,axis,isEnableMotor);};_proto169.setServo=function setServo(axis,onOff){var bt=Physics3D._bullet;bt.btGeneric6DofSpring2Constraint_setServo(this._btConstraint,axis,onOff);};_proto169.setTargetVelocity=function setTargetVelocity(axis,velocity){var bt=Physics3D._bullet;bt.btGeneric6DofSpring2Constraint_setTargetVelocity(this._btConstraint,axis,velocity);};_proto169.setTargetPosition=function setTargetPosition(axis,target){var bt=Physics3D._bullet;bt.btGeneric6DofSpring2Constraint_setServoTarget(this._btConstraint,axis,target);};_proto169.setMaxMotorForce=function setMaxMotorForce(axis,force){var bt=Physics3D._bullet;bt.btGeneric6DofSpring2Constraint_setMaxMotorForce(this._btConstraint,axis,force);};_proto169.setParam=function setParam(axis,constraintParams,value){var bt=Physics3D._bullet;bt.btTypedConstraint_setParam(this._btConstraint,axis,constraintParams,value);};_proto169.setFrames=function setFrames(){_ConstraintComponent2.prototype.setFrames.call(this);var bt=Physics3D._bullet;if(!this._btConstraint)return;bt.btGeneric6DofSpring2Constraint_setFrames(this._btConstraint,this._btframATrans,this._btframBTrans);};_proto169._addToSimulation=function _addToSimulation(){this._simulation&&this._simulation.addConstraint(this,this.enabled);};_proto169._removeFromSimulation=function _removeFromSimulation(){this._simulation.removeConstraint(this);this._simulation=null;};_proto169._createConstraint=function _createConstraint(){var bt=Physics3D._bullet;this._btConstraint=bt.btGeneric6DofSpring2Constraint_create(this.ownBody.btColliderObject,this._btframAPos,this.connectedBody.btColliderObject,this._btframBPos,ConfigurableConstraint.RO_XYZ);this._btJointFeedBackObj=bt.btJointFeedback_create(this._btConstraint);bt.btTypedConstraint_setJointFeedback(this._btConstraint,this._btJointFeedBackObj);this._simulation=this.owner._scene.physicsSimulation;this._initAllConstraintInfo();this._addToSimulation();Physics3D._bullet.btTypedConstraint_setEnabled(this._btConstraint,true);};_proto169._initAllConstraintInfo=function _initAllConstraintInfo(){this.setLimit(ConfigurableConstraint.MOTION_LINEAR_INDEX_X,this._xMotion,-this._maxLinearLimit.x,-this._minLinearLimit.x);this.setLimit(ConfigurableConstraint.MOTION_LINEAR_INDEX_Y,this._yMotion,this._minLinearLimit.y,this._maxLinearLimit.y);this.setLimit(ConfigurableConstraint.MOTION_LINEAR_INDEX_Z,this._zMotion,this._minLinearLimit.z,this._maxLinearLimit.z);this.setLimit(ConfigurableConstraint.MOTION_ANGULAR_INDEX_X,this._angularXMotion,-this._maxAngularLimit.x,-this._minAngularLimit.x);this.setLimit(ConfigurableConstraint.MOTION_ANGULAR_INDEX_Y,this._angularYMotion,this._minAngularLimit.y,this._maxAngularLimit.y);this.setLimit(ConfigurableConstraint.MOTION_ANGULAR_INDEX_Z,this._angularZMotion,this._minAngularLimit.z,this._maxAngularLimit.z);this.setSpring(ConfigurableConstraint.MOTION_LINEAR_INDEX_X,this._linearLimitSpring.x);this.setSpring(ConfigurableConstraint.MOTION_LINEAR_INDEX_Y,this._linearLimitSpring.y);this.setSpring(ConfigurableConstraint.MOTION_LINEAR_INDEX_Z,this._linearLimitSpring.z);this.setSpring(ConfigurableConstraint.MOTION_ANGULAR_INDEX_X,this._angularLimitSpring.x);this.setSpring(ConfigurableConstraint.MOTION_ANGULAR_INDEX_Y,this._angularLimitSpring.y);this.setSpring(ConfigurableConstraint.MOTION_ANGULAR_INDEX_Z,this._angularLimitSpring.z);this.setBounce(ConfigurableConstraint.MOTION_LINEAR_INDEX_X,this._linearBounce.x);this.setBounce(ConfigurableConstraint.MOTION_LINEAR_INDEX_Y,this._linearBounce.y);this.setBounce(ConfigurableConstraint.MOTION_LINEAR_INDEX_Z,this._linearBounce.z);this.setBounce(ConfigurableConstraint.MOTION_ANGULAR_INDEX_X,this._angularBounce.x);this.setBounce(ConfigurableConstraint.MOTION_ANGULAR_INDEX_Y,this._angularBounce.y);this.setBounce(ConfigurableConstraint.MOTION_ANGULAR_INDEX_Z,this._angularBounce.z);this.setDamping(ConfigurableConstraint.MOTION_LINEAR_INDEX_X,this._linearDamp.x);this.setDamping(ConfigurableConstraint.MOTION_LINEAR_INDEX_Y,this._linearDamp.y);this.setDamping(ConfigurableConstraint.MOTION_LINEAR_INDEX_Z,this._linearDamp.z);this.setDamping(ConfigurableConstraint.MOTION_ANGULAR_INDEX_X,this._angularDamp.x);this.setDamping(ConfigurableConstraint.MOTION_ANGULAR_INDEX_Y,this._angularDamp.y);this.setDamping(ConfigurableConstraint.MOTION_ANGULAR_INDEX_Z,this._angularDamp.z);this.setFrames();this.setEquilibriumPoint(0,0);};_proto169._onAdded=function _onAdded(){_ConstraintComponent2.prototype._onAdded.call(this);};_proto169._onEnable=function _onEnable(){if(!this._btConstraint)return;_ConstraintComponent2.prototype._onEnable.call(this);if(this._btConstraint)Physics3D._bullet.btTypedConstraint_setEnabled(this._btConstraint,true);};_proto169._onDisable=function _onDisable(){_ConstraintComponent2.prototype._onDisable.call(this);if(!this.connectedBody)this._removeFromSimulation();if(this._btConstraint)Physics3D._bullet.btTypedConstraint_setEnabled(this._btConstraint,false);};_proto169._parse=function _parse(data,interactMap){if(interactMap===void 0){interactMap=null;}_ConstraintComponent2.prototype._parse.call(this,data);this._axis.fromArray(data.axis);this._secondaryAxis.fromArray(data.secondaryAxis);var limitlimit=data.linearLimit;this._minLinearLimit.setValue(-limitlimit,-limitlimit,-limitlimit);this._maxLinearLimit.setValue(limitlimit,limitlimit,limitlimit);var limitSpring=data.linearLimitSpring;this._linearLimitSpring.setValue(limitSpring,limitSpring,limitSpring);var limitDamp=data.linearLimitDamper;this._linearDamp.setValue(limitDamp,limitDamp,limitDamp);var limitBounciness=data.linearLimitBounciness;this._linearBounce.setValue(limitBounciness,limitBounciness,limitBounciness);var xlowAngularLimit=data.lowAngularXLimit;var xhighAngularLimit=data.highAngularXLimit;var yAngularLimit=data.angularYLimit;var zAngularLimit=data.angularZLimit;this._minAngularLimit.setValue(xlowAngularLimit,-yAngularLimit,-zAngularLimit);this._maxAngularLimit.setValue(xhighAngularLimit,yAngularLimit,zAngularLimit);var xhighAngularBounciness=data.highAngularXLimitBounciness;var ybounciness=data.angularYLimitBounciness;var zbounciness=data.angularZLimitBounciness;this._angularBounce.setValue(xhighAngularBounciness,ybounciness,zbounciness);var xAngularSpring=data.angularXLimitSpring;var yzAngularSpriny=data.angularYZLimitSpring;this._angularLimitSpring.setValue(xAngularSpring,yzAngularSpriny,yzAngularSpriny);var xAngularDamper=data.angularXLimitDamper;var yzAngularDamper=data.angularYZLimitDamper;this._angularDamp.setValue(xAngularDamper,yzAngularDamper,yzAngularDamper);this.XMotion=data.xMotion;this.YMotion=data.yMotion;this.ZMotion=data.zMotion;this.angularXMotion=data.angularXMotion;this.angularYMotion=data.angularYMotion;this.angularZMotion=data.angularZMotion;if(data.rigidbodyID!=-1&&data.connectRigidbodyID!=-1){interactMap.component.push(this);interactMap.data.push(data);}data.breakForce!=undefined&&(this.breakForce=data.breakForce);data.breakTorque!=undefined&&(this.breakTorque=data.breakTorque);};_proto169._parseInteractive=function _parseInteractive(data,spriteMap){if(data===void 0){data=null;}if(spriteMap===void 0){spriteMap=null;}var rigidBodySprite=spriteMap[data.rigidbodyID];var rigidBody=rigidBodySprite.getComponent(Rigidbody3D);var connectSprite=spriteMap[data.connectRigidbodyID];var connectRigidbody=connectSprite.getComponent(Rigidbody3D);this.ownBody=rigidBody;this.connectedBody=connectRigidbody;};_proto169._onDestroy=function _onDestroy(){_ConstraintComponent2.prototype._onDestroy.call(this);};_proto169._cloneTo=function _cloneTo(dest){};_createClass(ConfigurableConstraint,[{key:"axis",get:function get(){return this._axis;}},{key:"secondaryAxis",get:function get(){return this._secondaryAxis;}},{key:"maxAngularLimit",set:function set(value){value.cloneTo(this._maxAngularLimit);},get:function get(){return this._maxAngularLimit;}},{key:"minAngularLimit",set:function set(value){value.cloneTo(this._minAngularLimit);},get:function get(){return this._minAngularLimit;}},{key:"maxLinearLimit",set:function set(value){value.cloneTo(this._maxLinearLimit);},get:function get(){return this._maxLinearLimit;}},{key:"minLinearLimit",set:function set(value){value.cloneTo(this._minLinearLimit);},get:function get(){return this._minLinearLimit;}},{key:"XMotion",set:function set(value){if(this._xMotion!=value){this._xMotion=value;this.setLimit(ConfigurableConstraint.MOTION_LINEAR_INDEX_X,value,-this._maxLinearLimit.x,-this._minLinearLimit.x);}},get:function get(){return this._xMotion;}},{key:"YMotion",set:function set(value){if(this._yMotion!=value){this._yMotion=value;this.setLimit(ConfigurableConstraint.MOTION_LINEAR_INDEX_Y,value,this._minLinearLimit.y,this._maxLinearLimit.y);}},get:function get(){return this._yMotion;}},{key:"ZMotion",set:function set(value){if(this._zMotion!=value){this._zMotion=value;this.setLimit(ConfigurableConstraint.MOTION_LINEAR_INDEX_Z,value,this._minLinearLimit.z,this._maxLinearLimit.z);}},get:function get(){return this._zMotion;}},{key:"angularXMotion",set:function set(value){if(this._angularXMotion!=value){this._angularXMotion=value;this.setLimit(ConfigurableConstraint.MOTION_ANGULAR_INDEX_X,value,-this._maxAngularLimit.x,-this._minAngularLimit.x);}},get:function get(){return this._angularXMotion;}},{key:"angularYMotion",set:function set(value){if(this._angularYMotion!=value){this._angularYMotion=value;this.setLimit(ConfigurableConstraint.MOTION_ANGULAR_INDEX_Y,value,this._minAngularLimit.y,this._maxAngularLimit.y);}},get:function get(){return this._angularYMotion;}},{key:"angularZMotion",set:function set(value){if(this._angularZMotion!=value){this._angularZMotion=value;this.setLimit(ConfigurableConstraint.MOTION_ANGULAR_INDEX_Z,value,this._minAngularLimit.z,this._maxAngularLimit.z);}},get:function get(){return this._angularZMotion;}},{key:"linearLimitSpring",set:function set(value){if(!Vector3.equals(this._linearLimitSpring,value)){value.cloneTo(this._linearLimitSpring);this.setSpring(ConfigurableConstraint.MOTION_LINEAR_INDEX_X,value.x);this.setSpring(ConfigurableConstraint.MOTION_LINEAR_INDEX_Y,value.y);this.setSpring(ConfigurableConstraint.MOTION_LINEAR_INDEX_Z,value.z);}},get:function get(){return this._linearLimitSpring;}},{key:"angularLimitSpring",set:function set(value){if(!Vector3.equals(this._angularLimitSpring,value)){value.cloneTo(this._angularLimitSpring);this.setSpring(ConfigurableConstraint.MOTION_ANGULAR_INDEX_X,value.x);this.setSpring(ConfigurableConstraint.MOTION_ANGULAR_INDEX_Y,value.y);this.setSpring(ConfigurableConstraint.MOTION_ANGULAR_INDEX_Z,value.z);}},get:function get(){return this._angularLimitSpring;}},{key:"linearBounce",set:function set(value){if(!Vector3.equals(this._linearBounce,value)){value.cloneTo(this._linearBounce);this.setBounce(ConfigurableConstraint.MOTION_LINEAR_INDEX_X,value.x);this.setBounce(ConfigurableConstraint.MOTION_LINEAR_INDEX_Y,value.y);this.setBounce(ConfigurableConstraint.MOTION_LINEAR_INDEX_Z,value.z);}},get:function get(){return this._linearBounce;}},{key:"angularBounce",set:function set(value){if(!Vector3.equals(this._angularBounce,value)){value.cloneTo(this._angularBounce);this.setBounce(ConfigurableConstraint.MOTION_ANGULAR_INDEX_X,value.x);this.setBounce(ConfigurableConstraint.MOTION_ANGULAR_INDEX_Y,value.y);this.setBounce(ConfigurableConstraint.MOTION_ANGULAR_INDEX_Z,value.z);}},get:function get(){return this._angularBounce;}},{key:"linearDamp",set:function set(value){if(!Vector3.equals(this._linearDamp,value)){value.cloneTo(this._linearDamp);this.setDamping(ConfigurableConstraint.MOTION_LINEAR_INDEX_X,value.x);this.setDamping(ConfigurableConstraint.MOTION_LINEAR_INDEX_Y,value.y);this.setDamping(ConfigurableConstraint.MOTION_LINEAR_INDEX_Z,value.z);}},get:function get(){return this._linearDamp;}},{key:"angularDamp",set:function set(value){if(!Vector3.equals(this._angularDamp,value)){value.cloneTo(this._angularDamp);this.setDamping(ConfigurableConstraint.MOTION_ANGULAR_INDEX_X,value.x);this.setDamping(ConfigurableConstraint.MOTION_ANGULAR_INDEX_Y,value.y);this.setDamping(ConfigurableConstraint.MOTION_ANGULAR_INDEX_Z,value.z);}},get:function get(){return this._angularDamp;}},{key:"anchor",set:function set(value){value.cloneTo(this._anchor);this.setFrames();},get:function get(){return this._anchor;}},{key:"connectAnchor",set:function set(value){value.cloneTo(this._connectAnchor);this.setFrames();},get:function get(){return this._connectAnchor;}}]);return ConfigurableConstraint;}(ConstraintComponent);ConfigurableConstraint.CONFIG_MOTION_TYPE_LOCKED=0;ConfigurableConstraint.CONFIG_MOTION_TYPE_LIMITED=1;ConfigurableConstraint.CONFIG_MOTION_TYPE_FREE=2;ConfigurableConstraint.MOTION_LINEAR_INDEX_X=0;ConfigurableConstraint.MOTION_LINEAR_INDEX_Y=1;ConfigurableConstraint.MOTION_LINEAR_INDEX_Z=2;ConfigurableConstraint.MOTION_ANGULAR_INDEX_X=3;ConfigurableConstraint.MOTION_ANGULAR_INDEX_Y=4;ConfigurableConstraint.MOTION_ANGULAR_INDEX_Z=5;ConfigurableConstraint.RO_XYZ=0;ConfigurableConstraint.RO_XZY=1;ConfigurableConstraint.RO_YXZ=2;ConfigurableConstraint.RO_YZX=3;ConfigurableConstraint.RO_ZXY=4;ConfigurableConstraint.RO_ZYX=5;var Laya3D=/*#__PURE__*/function(){function Laya3D(){}Laya3D._cancelLoadByUrl=function _cancelLoadByUrl(url){Laya.Laya.loader.cancelLoadByUrl(url);Laya3D._innerFirstLevelLoaderManager.cancelLoadByUrl(url);Laya3D._innerSecondLevelLoaderManager.cancelLoadByUrl(url);Laya3D._innerThirdLevelLoaderManager.cancelLoadByUrl(url);Laya3D._innerFourthLevelLoaderManager.cancelLoadByUrl(url);};Laya3D._changeWebGLSize=function _changeWebGLSize(width,height){Laya.WebGL.onStageResize(width,height);RenderContext3D.clientWidth=width;RenderContext3D.clientHeight=height;};Laya3D.__init__=function __init__(width,height,config){Laya.Config.isAntialias=config.isAntialias;Laya.Config.isAlpha=config.isAlpha;Laya.Config.premultipliedAlpha=config.premultipliedAlpha;Laya.Config.isStencil=config.isStencil;if(!Laya.WebGL.enable()){alert("Laya3D init error,must support webGL!");return;}Laya.RunDriver.changeWebGLSize=Laya3D._changeWebGLSize;Laya.Render.is3DMode=true;Laya.Laya.init(width,height);if(!Laya.Render.supportWebGLPlusRendering){Laya.LayaGL.instance=Laya.WebGLContext.mainContext;Laya.LayaGL.instance.createCommandEncoder=function(reserveSize,adjustSize,isSyncToRenderThread){if(reserveSize===void 0){reserveSize=128;}if(adjustSize===void 0){adjustSize=64;}if(isSyncToRenderThread===void 0){isSyncToRenderThread=false;}return new Laya.CommandEncoder(this,reserveSize,adjustSize,isSyncToRenderThread);};}config._multiLighting=config.enableMultiLight&&Laya.SystemUtils.supportTextureFormat(Laya.TextureFormat.R32G32B32A32);ILaya3D.Shader3D=Shader3D;ILaya3D.Scene3D=Scene3D;ILaya3D.MeshRenderStaticBatchManager=MeshRenderStaticBatchManager;ILaya3D.MeshRenderDynamicBatchManager=MeshRenderDynamicBatchManager;ILaya3D.SubMeshDynamicBatch=SubMeshDynamicBatch;ILaya3D.Laya3D=Laya3D;ILaya3D.Matrix4x4=Matrix4x4;ILaya3D.Physics3D=Physics3D;ILaya3D.ShadowLightType=exports.ShadowLightType;Laya3D.enableNative3D();if(config.isUseCannonPhysicsEngine)Physics3D.__cannoninit__();Physics3D.__bulletinit__();VertexElementFormat.__init__();VertexMesh.__init__();VertexShurikenParticleBillboard.__init__();VertexShurikenParticleMesh.__init__();VertexPositionTexture0.__init__();VertexTrail.__init__();VertexPositionTerrain.__init__();PixelLineVertex.__init__();SubMeshInstanceBatch.__init__();SubMeshDynamicBatch.__init__();ShaderInit3D.__init__();ShadowUtils.init();PBRMaterial.__init__();PBRStandardMaterial.__init__();PBRSpecularMaterial.__init__();SkyPanoramicMaterial.__init__();Mesh.__init__();PrimitiveMesh.__init__();Sprite3D.__init__();RenderableSprite3D.__init__();MeshSprite3D.__init__();SkinnedMeshSprite3D.__init__();SimpleSkinnedMeshSprite3D.__init__();ShuriKenParticle3D.__init__();TrailSprite3D.__init__();PostProcess.__init__();Scene3D.__init__();MeshRenderStaticBatchManager.__init__();Material.__initDefine__();BaseMaterial.__initDefine__();BlinnPhongMaterial.__initDefine__();SkyProceduralMaterial.__initDefine__();UnlitMaterial.__initDefine__();TrailMaterial.__initDefine__();EffectMaterial.__initDefine__();WaterPrimaryMaterial.__initDefine__();ShurikenParticleMaterial.__initDefine__();ExtendTerrainMaterial.__initDefine__();PixelLineMaterial.__initDefine__();SkyBoxMaterial.__initDefine__();Command.__init__();Laya.ClassUtils.regClass("Laya.SkyPanoramicMaterial",SkyPanoramicMaterial);Laya.ClassUtils.regClass("Laya.EffectMaterial",EffectMaterial);Laya.ClassUtils.regClass("Laya.UnlitMaterial",UnlitMaterial);Laya.ClassUtils.regClass("Laya.BlinnPhongMaterial",BlinnPhongMaterial);Laya.ClassUtils.regClass("Laya.SkyProceduralMaterial",SkyProceduralMaterial);Laya.ClassUtils.regClass("Laya.PBRStandardMaterial",PBRStandardMaterial);Laya.ClassUtils.regClass("Laya.PBRSpecularMaterial",PBRSpecularMaterial);Laya.ClassUtils.regClass("Laya.SkyBoxMaterial",SkyBoxMaterial);Laya.ClassUtils.regClass("Laya.WaterPrimaryMaterial",WaterPrimaryMaterial);Laya.ClassUtils.regClass("Laya.ExtendTerrainMaterial",ExtendTerrainMaterial);Laya.ClassUtils.regClass("Laya.ShurikenParticleMaterial",ShurikenParticleMaterial);Laya.ClassUtils.regClass("Laya.TrailMaterial",TrailMaterial);Laya.ClassUtils.regClass("Laya.PhysicsCollider",PhysicsCollider);Laya.ClassUtils.regClass("Laya.Rigidbody3D",Rigidbody3D);Laya.ClassUtils.regClass("Laya.CharacterController",CharacterController);Laya.ClassUtils.regClass("Laya.Animator",Animator);Laya.ClassUtils.regClass("PhysicsCollider",PhysicsCollider);Laya.ClassUtils.regClass("CharacterController",CharacterController);Laya.ClassUtils.regClass("Animator",Animator);Laya.ClassUtils.regClass("Rigidbody3D",Rigidbody3D);Laya.ClassUtils.regClass("FixedConstraint",FixedConstraint);Laya.ClassUtils.regClass("ConfigurableConstraint",ConfigurableConstraint);PixelLineMaterial.defaultMaterial=new PixelLineMaterial();BlinnPhongMaterial.defaultMaterial=new BlinnPhongMaterial();EffectMaterial.defaultMaterial=new EffectMaterial();UnlitMaterial.defaultMaterial=new UnlitMaterial();ShurikenParticleMaterial.defaultMaterial=new ShurikenParticleMaterial();TrailMaterial.defaultMaterial=new TrailMaterial();SkyProceduralMaterial.defaultMaterial=new SkyProceduralMaterial();SkyBoxMaterial.defaultMaterial=new SkyBoxMaterial();WaterPrimaryMaterial.defaultMaterial=new WaterPrimaryMaterial();PixelLineMaterial.defaultMaterial.lock=true;BlinnPhongMaterial.defaultMaterial.lock=true;EffectMaterial.defaultMaterial.lock=true;UnlitMaterial.defaultMaterial.lock=true;ShurikenParticleMaterial.defaultMaterial.lock=true;TrailMaterial.defaultMaterial.lock=true;SkyProceduralMaterial.defaultMaterial.lock=true;SkyBoxMaterial.defaultMaterial.lock=true;WaterPrimaryMaterial.defaultMaterial.lock=true;Laya.Texture2D.__init__();TextureCube.__init__();SkyBox.__init__();SkyDome.__init__();ScreenQuad.__init__();ScreenTriangle.__init__();FrustumCulling.__init__();HalfFloatUtils.__init__();var createMap=Laya.LoaderManager.createMap;createMap["lh"]=[Laya3D.HIERARCHY,Scene3DUtils._parse];createMap["ls"]=[Laya3D.HIERARCHY,Scene3DUtils._parseScene];createMap["lm"]=[Laya3D.MESH,MeshReader._parse];createMap["lmat"]=[Laya3D.MATERIAL,Material._parse];createMap["jpg"]=[Laya3D.TEXTURE2D,Laya.Texture2D._parse];createMap["jpeg"]=[Laya3D.TEXTURE2D,Laya.Texture2D._parse];createMap["bmp"]=[Laya3D.TEXTURE2D,Laya.Texture2D._parse];createMap["gif"]=[Laya3D.TEXTURE2D,Laya.Texture2D._parse];createMap["png"]=[Laya3D.TEXTURE2D,Laya.Texture2D._parse];createMap["dds"]=[Laya3D.TEXTURE2D,Laya.Texture2D._parse];createMap["ktx"]=[Laya3D.TEXTURE2D,Laya.Texture2D._parse];createMap["pvr"]=[Laya3D.TEXTURE2D,Laya.Texture2D._parse];createMap["lani"]=[Laya3D.ANIMATIONCLIP,AnimationClip._parse];createMap["lav"]=[Laya3D.AVATAR,Avatar._parse];createMap["ltc"]=[Laya3D.TEXTURECUBE,TextureCube._parse];createMap["ltcb"]=[Laya3D.TEXTURECUBEBIN,TextureCube._parseBin];createMap["ltcb.ls"]=[Laya3D.TEXTURECUBEBIN,TextureCube._parseBin];createMap["lanit.ls"]=[Laya3D.TEXTURE2D,Laya.Texture2D._SimpleAnimatorTextureParse];var parserMap=Laya.Loader.parserMap;parserMap[Laya3D.HIERARCHY]=Laya3D._loadHierarchy;parserMap[Laya3D.MESH]=Laya3D._loadMesh;parserMap[Laya3D.MATERIAL]=Laya3D._loadMaterial;parserMap[Laya3D.TEXTURECUBE]=Laya3D._loadTextureCube;parserMap[Laya3D.TEXTURECUBEBIN]=Laya3D._loadTextureCubeBin;parserMap[Laya3D.TEXTURE2D]=Laya3D._loadTexture2D;parserMap[Laya3D.ANIMATIONCLIP]=Laya3D._loadAnimationClip;parserMap[Laya3D.AVATAR]=Laya3D._loadAvatar;parserMap[Laya3D.SIMPLEANIMATORBIN]=Laya3D._loadSimpleAnimator;Laya3D._innerFirstLevelLoaderManager.on(Laya.Event.ERROR,null,Laya3D._eventLoadManagerError);Laya3D._innerSecondLevelLoaderManager.on(Laya.Event.ERROR,null,Laya3D._eventLoadManagerError);Laya3D._innerThirdLevelLoaderManager.on(Laya.Event.ERROR,null,Laya3D._eventLoadManagerError);Laya3D._innerFourthLevelLoaderManager.on(Laya.Event.ERROR,null,Laya3D._eventLoadManagerError);};Laya3D.enableNative3D=function enableNative3D(){var shaderData=ShaderData;var shader3D=ShaderInstance;var skinnedMeshRender=SkinnedMeshRenderer;var avatar=Avatar;var frustumCulling=FrustumCulling;if(Laya.Render.supportWebGLPlusRendering){shaderData.prototype._initData=shaderData.prototype._initDataForNative;shaderData.prototype.setBool=shaderData.prototype.setBoolForNative;shaderData.prototype.getBool=shaderData.prototype.getBoolForNative;shaderData.prototype.setInt=shaderData.prototype.setIntForNative;shaderData.prototype.getInt=shaderData.prototype.getIntForNative;shaderData.prototype.setNumber=shaderData.prototype.setNumberForNative;shaderData.prototype.getNumber=shaderData.prototype.getNumberForNative;shaderData.prototype.setVector=shaderData.prototype.setVectorForNative;shaderData.prototype.getVector=shaderData.prototype.getVectorForNative;shaderData.prototype.setVector2=shaderData.prototype.setVector2ForNative;shaderData.prototype.getVector2=shaderData.prototype.getVector2ForNative;shaderData.prototype.setVector3=shaderData.prototype.setVector3ForNative;shaderData.prototype.getVector3=shaderData.prototype.getVector3ForNative;shaderData.prototype.setQuaternion=shaderData.prototype.setQuaternionForNative;shaderData.prototype.getQuaternion=shaderData.prototype.getQuaternionForNative;shaderData.prototype.setMatrix4x4=shaderData.prototype.setMatrix4x4ForNative;shaderData.prototype.getMatrix4x4=shaderData.prototype.getMatrix4x4ForNative;shaderData.prototype.setBuffer=shaderData.prototype.setBufferForNative;shaderData.prototype.getBuffer=shaderData.prototype.getBufferForNative;shaderData.prototype.setTexture=shaderData.prototype.setTextureForNative;shaderData.prototype.getTexture=shaderData.prototype.getTextureForNative;shaderData.prototype.setAttribute=shaderData.prototype.setAttributeForNative;shaderData.prototype.getAttribute=shaderData.prototype.getAttributeForNative;shaderData.prototype.cloneTo=shaderData.prototype.cloneToForNative;shaderData.prototype.getData=shaderData.prototype.getDataForNative;shader3D.prototype._uniformMatrix2fv=shader3D.prototype._uniformMatrix2fvForNative;shader3D.prototype._uniformMatrix3fv=shader3D.prototype._uniformMatrix3fvForNative;shader3D.prototype._uniformMatrix4fv=shader3D.prototype._uniformMatrix4fvForNative;Laya.LayaGLRunner.uploadShaderUniforms=Laya.LayaGLRunner.uploadShaderUniformsForNative;}if(Laya.Render.supportWebGLPlusCulling){frustumCulling.renderObjectCulling=FrustumCulling.renderObjectCullingNative;}if(Laya.Render.supportWebGLPlusAnimation){avatar.prototype._cloneDatasToAnimator=avatar.prototype._cloneDatasToAnimatorNative;var animationClip=AnimationClip;animationClip.prototype._evaluateClipDatasRealTime=animationClip.prototype._evaluateClipDatasRealTimeForNative;skinnedMeshRender.prototype._computeSkinnedData=skinnedMeshRender.prototype._computeSkinnedDataForNative;}};Laya3D.formatRelativePath=function formatRelativePath(base,value){var path;path=base+value;var char1=value.charAt(0);if(char1==="."){var parts=path.split("/");for(var i=0,len=parts.length;i<len;i++){if(parts[i]=='..'){var index=i-1;if(index>0&&parts[index]!=='..'){parts.splice(index,2);i-=2;}}}path=parts.join('/');}return path;};Laya3D._endLoad=function _endLoad(loader,content,subResous){if(content===void 0){content=null;}if(subResous===void 0){subResous=null;}if(subResous){for(var i=0,n=subResous.length;i<n;i++){var resou=Laya.Loader.getRes(subResous[i]);resou&&resou._removeReference();}}loader.endLoad(content);};Laya3D._eventLoadManagerError=function _eventLoadManagerError(msg){Laya.Laya.loader.event(Laya.Event.ERROR,msg);};Laya3D._addHierarchyInnerUrls=function _addHierarchyInnerUrls(urls,urlMap,urlVersion,hierarchyBasePath,path,type,constructParams,propertyParams){if(constructParams===void 0){constructParams=null;}if(propertyParams===void 0){propertyParams=null;}var formatUrl=Laya3D.formatRelativePath(hierarchyBasePath,path);urlVersion&&(formatUrl=formatUrl+urlVersion);urls.push({url:formatUrl,type:type,constructParams:constructParams,propertyParams:propertyParams});urlMap.push(formatUrl);return formatUrl;};Laya3D._getSprite3DHierarchyInnerUrls=function _getSprite3DHierarchyInnerUrls(node,firstLevelUrls,secondLevelUrls,thirdLevelUrls,fourthLelUrls,subUrls,urlVersion,hierarchyBasePath){var i,n;var props=node.props;switch(node.type){case"Scene3D":var lightmaps=props.lightmaps;for(i=0,n=lightmaps.length;i<n;i++){var lightMap=lightmaps[i];if(lightMap.path){lightMap.path=Laya3D._addHierarchyInnerUrls(fourthLelUrls,subUrls,urlVersion,hierarchyBasePath,lightMap.path,Laya3D.TEXTURE2D,lightMap.constructParams,lightMap.propertyParams);}else {var lightmapColorData=lightMap.color;lightmapColorData.path=Laya3D._addHierarchyInnerUrls(fourthLelUrls,subUrls,urlVersion,hierarchyBasePath,lightmapColorData.path,Laya3D.TEXTURE2D,lightmapColorData.constructParams,lightmapColorData.propertyParams);var lightmapDirectionData=lightMap.direction;if(lightmapDirectionData)lightmapDirectionData.path=Laya3D._addHierarchyInnerUrls(fourthLelUrls,subUrls,urlVersion,hierarchyBasePath,lightmapDirectionData.path,Laya3D.TEXTURE2D,lightmapDirectionData.constructParams,lightmapDirectionData.propertyParams);}}var reflectionTextureData=props.reflectionTexture;reflectionTextureData&&(props.reflection=Laya3D._addHierarchyInnerUrls(thirdLevelUrls,subUrls,urlVersion,hierarchyBasePath,reflectionTextureData,Laya3D.TEXTURECUBE));var reflectionData=props.reflection;reflectionData&&(props.reflection=Laya3D._addHierarchyInnerUrls(fourthLelUrls,subUrls,urlVersion,hierarchyBasePath,reflectionData,Laya3D.TEXTURECUBEBIN));if(props.sky){var skyboxMaterial=props.sky.material;skyboxMaterial&&(skyboxMaterial.path=Laya3D._addHierarchyInnerUrls(secondLevelUrls,subUrls,urlVersion,hierarchyBasePath,skyboxMaterial.path,Laya3D.MATERIAL));}break;case"Camera":var skyboxMatData=props.skyboxMaterial;skyboxMatData&&(skyboxMatData.path=Laya3D._addHierarchyInnerUrls(secondLevelUrls,subUrls,urlVersion,hierarchyBasePath,skyboxMatData.path,Laya3D.MATERIAL));break;case"TrailSprite3D":case"MeshSprite3D":case"SkinnedMeshSprite3D":case"SimpleSkinnedMeshSprite3D":var meshPath=props.meshPath;meshPath&&(props.meshPath=Laya3D._addHierarchyInnerUrls(firstLevelUrls,subUrls,urlVersion,hierarchyBasePath,meshPath,Laya3D.MESH));var materials=props.materials;if(materials)for(i=0,n=materials.length;i<n;i++){materials[i].path=Laya3D._addHierarchyInnerUrls(secondLevelUrls,subUrls,urlVersion,hierarchyBasePath,materials[i].path,Laya3D.MATERIAL);}if(node.type=="SimpleSkinnedMeshSprite3D")if(props.animatorTexture)props.animatorTexture=Laya3D._addHierarchyInnerUrls(fourthLelUrls,subUrls,urlVersion,hierarchyBasePath,props.animatorTexture,Laya3D.SIMPLEANIMATORBIN);break;case"ShuriKenParticle3D":if(props.main){var resources=props.renderer.resources;var mesh=resources.mesh;var material=resources.material;mesh&&(resources.mesh=Laya3D._addHierarchyInnerUrls(firstLevelUrls,subUrls,urlVersion,hierarchyBasePath,mesh,Laya3D.MESH));material&&(resources.material=Laya3D._addHierarchyInnerUrls(secondLevelUrls,subUrls,urlVersion,hierarchyBasePath,material,Laya3D.MATERIAL));}else {var parMeshPath=props.meshPath;parMeshPath&&(props.meshPath=Laya3D._addHierarchyInnerUrls(firstLevelUrls,subUrls,urlVersion,hierarchyBasePath,parMeshPath,Laya3D.MESH));props.material.path=Laya3D._addHierarchyInnerUrls(secondLevelUrls,subUrls,urlVersion,hierarchyBasePath,props.material.path,Laya3D.MATERIAL);}break;case"Terrain":Laya3D._addHierarchyInnerUrls(fourthLelUrls,subUrls,urlVersion,hierarchyBasePath,props.dataPath,Laya3D.TERRAINRES);break;}var components=node.components;if(components){for(var k=0,p=components.length;k<p;k++){var component=components[k];switch(component.type){case"Animator":var avatarPath=component.avatarPath;var avatarData=component.avatar;avatarData&&(avatarData.path=Laya3D._addHierarchyInnerUrls(fourthLelUrls,subUrls,urlVersion,hierarchyBasePath,avatarData.path,Laya3D.AVATAR));var clipPaths=component.clipPaths;if(!clipPaths){var layersData=component.layers;for(i=0;i<layersData.length;i++){var states=layersData[i].states;for(var j=0,m=states.length;j<m;j++){var clipPath=states[j].clipPath;clipPath&&(states[j].clipPath=Laya3D._addHierarchyInnerUrls(fourthLelUrls,subUrls,urlVersion,hierarchyBasePath,clipPath,Laya3D.ANIMATIONCLIP));}}}else {for(i=0,n=clipPaths.length;i<n;i++){clipPaths[i]=Laya3D._addHierarchyInnerUrls(fourthLelUrls,subUrls,urlVersion,hierarchyBasePath,clipPaths[i],Laya3D.ANIMATIONCLIP);}}break;case"PhysicsCollider":case"Rigidbody3D":case"CharacterController":var shapes=component.shapes;for(i=0;i<shapes.length;i++){var shape=shapes[i];if(shape.type==="MeshColliderShape"){var mesh=shape.mesh;mesh&&(shape.mesh=Laya3D._addHierarchyInnerUrls(firstLevelUrls,subUrls,urlVersion,hierarchyBasePath,mesh,Laya3D.MESH));}}break;}}}var children=node.child;for(i=0,n=children.length;i<n;i++){Laya3D._getSprite3DHierarchyInnerUrls(children[i],firstLevelUrls,secondLevelUrls,thirdLevelUrls,fourthLelUrls,subUrls,urlVersion,hierarchyBasePath);}};Laya3D._loadHierarchy=function _loadHierarchy(loader){loader._originType=loader.type;loader.on(Laya.Event.LOADED,null,Laya3D._onHierarchylhLoaded,[loader]);loader.load(loader.url,Laya.Loader.JSON,false,null,true);};Laya3D._onHierarchylhLoaded=function _onHierarchylhLoaded(loader,lhData){var url=loader.url;var urlVersion=Utils3D.getURLVerion(url);var hierarchyBasePath=Laya.URL.getPath(url);var firstLevUrls=[];var secondLevUrls=[];var thirdLevUrls=[];var forthLevUrls=[];var subUrls=[];Laya3D._getSprite3DHierarchyInnerUrls(lhData.data,firstLevUrls,secondLevUrls,thirdLevUrls,forthLevUrls,subUrls,urlVersion,hierarchyBasePath);var urlCount=firstLevUrls.length+secondLevUrls.length+forthLevUrls.length;var totalProcessCount=urlCount+1;var weight=1/totalProcessCount;Laya3D._onProcessChange(loader,0,weight,1.0);if(forthLevUrls.length>0){var processCeil=urlCount/totalProcessCount;var processHandler=Laya.Handler.create(null,Laya3D._onProcessChange,[loader,weight,processCeil],false);Laya3D._innerFourthLevelLoaderManager._create(forthLevUrls,false,Laya.Handler.create(null,Laya3D._onHierarchyInnerForthLevResouLoaded,[loader,processHandler,lhData,subUrls,firstLevUrls,secondLevUrls,thirdLevUrls,weight+processCeil*forthLevUrls.length,processCeil]),processHandler,null,null,null,1,true);}else {Laya3D._onHierarchyInnerForthLevResouLoaded(loader,null,lhData,subUrls,firstLevUrls,secondLevUrls,thirdLevUrls,weight,processCeil);}};Laya3D._onHierarchyInnerForthLevResouLoaded=function _onHierarchyInnerForthLevResouLoaded(loader,processHandler,lhData,subUrls,firstLevUrls,secondLevUrls,thirdLevUrls,processOffset,processCeil){processHandler&&processHandler.recover();if(thirdLevUrls.length>0){var process=Laya.Handler.create(null,Laya3D._onProcessChange,[loader,processOffset,processCeil],false);Laya3D._innerThirdLevelLoaderManager._create(thirdLevUrls,false,Laya.Handler.create(null,Laya3D._onHierarchyInnerThirdLevResouLoaded,[loader,process,lhData,subUrls,firstLevUrls,secondLevUrls,processOffset+processCeil*secondLevUrls.length,processCeil]),processHandler,null,null,null,1,true);}else {Laya3D._onHierarchyInnerThirdLevResouLoaded(loader,null,lhData,subUrls,firstLevUrls,secondLevUrls,processOffset,processCeil);}};Laya3D._onHierarchyInnerThirdLevResouLoaded=function _onHierarchyInnerThirdLevResouLoaded(loader,processHandler,lhData,subUrls,firstLevUrls,secondLevUrls,processOffset,processCeil){processHandler&&processHandler.recover();if(secondLevUrls.length>0){var process=Laya.Handler.create(null,Laya3D._onProcessChange,[loader,processOffset,processCeil],false);Laya3D._innerSecondLevelLoaderManager._create(secondLevUrls,false,Laya.Handler.create(null,Laya3D._onHierarchyInnerSecondLevResouLoaded,[loader,process,lhData,subUrls,firstLevUrls,processOffset+processCeil*secondLevUrls.length,processCeil]),processHandler,null,null,null,1,true);}else {Laya3D._onHierarchyInnerSecondLevResouLoaded(loader,null,lhData,subUrls,firstLevUrls,processOffset,processCeil);}};Laya3D._onHierarchyInnerSecondLevResouLoaded=function _onHierarchyInnerSecondLevResouLoaded(loader,processHandler,lhData,subUrls,firstLevUrls,processOffset,processCeil){processHandler&&processHandler.recover();if(firstLevUrls.length>0){var process=Laya.Handler.create(null,Laya3D._onProcessChange,[loader,processOffset,processCeil],false);Laya3D._innerFirstLevelLoaderManager._create(firstLevUrls,false,Laya.Handler.create(null,Laya3D._onHierarchyInnerFirstLevResouLoaded,[loader,process,lhData,subUrls]),processHandler,null,null,null,1,true);}else {Laya3D._onHierarchyInnerFirstLevResouLoaded(loader,null,lhData,subUrls);}};Laya3D._onHierarchyInnerFirstLevResouLoaded=function _onHierarchyInnerFirstLevResouLoaded(loader,processHandler,lhData,subUrls){processHandler&&processHandler.recover();loader._cache=loader._createCache;var item=lhData.data.type==="Scene3D"?Scene3DUtils._parseScene(lhData,loader._propertyParams,loader._constructParams):Scene3DUtils._parse(lhData,loader._propertyParams,loader._constructParams);Laya3D._endLoad(loader,item,subUrls);};Laya3D._loadMesh=function _loadMesh(loader){loader.on(Laya.Event.LOADED,null,Laya3D._onMeshLmLoaded,[loader]);loader.load(loader.url,Laya.Loader.BUFFER,false,null,true);};Laya3D._onMeshLmLoaded=function _onMeshLmLoaded(loader,lmData){loader._cache=loader._createCache;var mesh=MeshReader._parse(lmData,loader._propertyParams,loader._constructParams);Laya3D._endLoad(loader,mesh);};Laya3D._loadMaterial=function _loadMaterial(loader){loader.on(Laya.Event.LOADED,null,Laya3D._onMaterilLmatLoaded,[loader]);loader.load(loader.url,Laya.Loader.JSON,false,null,true);};Laya3D._onMaterilLmatLoaded=function _onMaterilLmatLoaded(loader,lmatData){var url=loader.url;var urlVersion=Utils3D.getURLVerion(url);var materialBasePath=Laya.URL.getPath(url);var urls=[];var subUrls=[];var customProps=lmatData.customProps;var formatSubUrl;var version=lmatData.version;switch(version){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":var i,n;var textures=lmatData.props.textures;if(textures){for(i=0,n=textures.length;i<n;i++){var tex2D=textures[i];var tex2DPath=tex2D.path;if(tex2DPath){formatSubUrl=Laya3D.formatRelativePath(materialBasePath,tex2DPath);urlVersion&&(formatSubUrl=formatSubUrl+urlVersion);urls.push({url:formatSubUrl,constructParams:tex2D.constructParams,propertyParams:tex2D.propertyParams});subUrls.push(formatSubUrl);tex2D.path=formatSubUrl;}}}break;default:throw new Error("Laya3D:unkonwn version.");}var urlCount=urls.length;var totalProcessCount=urlCount+1;var lmatWeight=1/totalProcessCount;Laya3D._onProcessChange(loader,0,lmatWeight,1.0);if(urlCount>0){var processHandler=Laya.Handler.create(null,Laya3D._onProcessChange,[loader,lmatWeight,urlCount/totalProcessCount],false);Laya3D._innerFourthLevelLoaderManager._create(urls,false,Laya.Handler.create(null,Laya3D._onMateialTexturesLoaded,[loader,processHandler,lmatData,subUrls]),processHandler,null,null,null,1,true);}else {Laya3D._onMateialTexturesLoaded(loader,null,lmatData,null);}};Laya3D._onMateialTexturesLoaded=function _onMateialTexturesLoaded(loader,processHandler,lmatData,subUrls){loader._cache=loader._createCache;var mat=Material._parse(lmatData,loader._propertyParams,loader._constructParams);Laya3D._endLoad(loader,mat,subUrls);processHandler&&processHandler.recover();};Laya3D._loadAvatar=function _loadAvatar(loader){loader.on(Laya.Event.LOADED,null,function(data){loader._cache=loader._createCache;var avatar=Avatar._parse(data,loader._propertyParams,loader._constructParams);Laya3D._endLoad(loader,avatar);});loader.load(loader.url,Laya.Loader.JSON,false,null,true);};Laya3D._loadSimpleAnimator=function _loadSimpleAnimator(loader){loader.on(Laya.Event.LOADED,null,function(data){loader._cache=loader._createCache;var texture=Laya.Texture2D._SimpleAnimatorTextureParse(data,loader._propertyParams,loader._constructParams);Laya3D._endLoad(loader,texture);});loader.load(loader.url,Laya.Loader.BUFFER,false,null,true);};Laya3D._loadAnimationClip=function _loadAnimationClip(loader){loader.on(Laya.Event.LOADED,null,function(data){loader._cache=loader._createCache;var clip=AnimationClip._parse(data,loader._propertyParams,loader._constructParams);Laya3D._endLoad(loader,clip);});loader.load(loader.url,Laya.Loader.BUFFER,false,null,true);};Laya3D._loadTexture2D=function _loadTexture2D(loader){var url=loader.url;var index=url.lastIndexOf('.')+1;var verIndex=url.indexOf('?');var endIndex=verIndex==-1?url.length:verIndex;var ext=url.substr(index,endIndex-index);var type;switch(ext){case"jpg":case"jpeg":case"bmp":case"gif":case"png":type="nativeimage";break;case"dds":case"ktx":case"pvr":type=Laya.Loader.BUFFER;break;}loader.on(Laya.Event.LOADED,null,function(image){loader._cache=loader._createCache;var tex=Laya.Texture2D._parse(image,loader._propertyParams,loader._constructParams);Laya3D._endLoad(loader,tex);});loader.load(loader.url,type,false,null,true);};Laya3D._loadTextureCube=function _loadTextureCube(loader){loader.on(Laya.Event.LOADED,null,Laya3D._onTextureCubeLtcLoaded,[loader]);loader.load(loader.url,Laya.Loader.JSON,false,null,true);};Laya3D._loadTextureCubeBin=function _loadTextureCubeBin(loader){loader.on(Laya.Event.LOADED,null,function(data){loader._cache=loader._createCache;var _byte=new Laya.Byte(data);var version=_byte.readUTFString();if(version!=="LAYATEXTURECUBE:0000")throw "Laya3D:unknow version.";var format=_byte.readUint8();var mipCount=_byte.getUint8();var size=_byte.readUint16();var filterMode=_byte.getUint8();var warpModeU=_byte.getUint8();var warpModev=_byte.getUint8();var anisoLevel=_byte.getUint8();var cubemap=new TextureCube(size,format,mipCount>1?true:false);cubemap.filterMode=filterMode;cubemap.wrapModeU=warpModeU;cubemap.wrapModeV=warpModev;cubemap.anisoLevel=anisoLevel;var pos=_byte.pos;var mipSize=size;for(var i=0;i<mipCount;i++){var uint8Arrays=new Array(6);var mipPixelLength=mipSize*mipSize*cubemap._getFormatByteCount();for(var j=0;j<6;j++){uint8Arrays[j]=new Uint8Array(data,pos,mipPixelLength);pos+=mipPixelLength;}cubemap.setSixSidePixels(uint8Arrays,i);mipSize/=2;}Laya3D._endLoad(loader,cubemap);});loader.load(loader.url,Laya.Loader.BUFFER,false,null,true);};Laya3D._onTextureCubeLtcLoaded=function _onTextureCubeLtcLoaded(loader,ltcData){var ltcBasePath=Laya.URL.getPath(loader.url);var urls=[Laya3D.formatRelativePath(ltcBasePath,ltcData.front),Laya3D.formatRelativePath(ltcBasePath,ltcData.back),Laya3D.formatRelativePath(ltcBasePath,ltcData.left),Laya3D.formatRelativePath(ltcBasePath,ltcData.right),Laya3D.formatRelativePath(ltcBasePath,ltcData.up),Laya3D.formatRelativePath(ltcBasePath,ltcData.down)];var ltcWeight=1.0/7.0;Laya3D._onProcessChange(loader,0,ltcWeight,1.0);var processHandler=Laya.Handler.create(null,Laya3D._onProcessChange,[loader,ltcWeight,6/7],false);Laya3D._innerFourthLevelLoaderManager.load(urls,Laya.Handler.create(null,Laya3D._onTextureCubeImagesLoaded,[loader,urls,processHandler]),processHandler,"nativeimage");};Laya3D._onTextureCubeImagesLoaded=function _onTextureCubeImagesLoaded(loader,urls,processHandler){var images=new Array(6);for(var i=0;i<6;i++){images[i]=Laya.Loader.getRes(urls[i]);}loader._cache=loader._createCache;var tex=TextureCube._parse(images,loader._propertyParams,loader._constructParams);processHandler.recover();for(i=0;i<6;i++){Laya.Loader.clearRes(urls[i]);}Laya3D._endLoad(loader,tex);};Laya3D._onProcessChange=function _onProcessChange(loader,offset,weight,process){process=offset+process*weight;process<1.0&&loader.event(Laya.Event.PROGRESS,process*2/3+1/3);};Laya3D.init=function init(width,height,config,compolete){if(config===void 0){config=null;}if(compolete===void 0){compolete=null;}if(Laya3D._isInit){compolete&&compolete.run();return;}Laya3D._isInit=true;config&&config.cloneTo(Config3D._config);config=Config3D._config;FrustumCulling.debugFrustumCulling=config.debugFrustumCulling;Laya3D._editerEnvironment=config._editerEnvironment;Scene3D.octreeCulling=config.octreeCulling;Scene3D.octreeInitialSize=config.octreeInitialSize;Scene3D.octreeInitialCenter=config.octreeInitialCenter;Scene3D.octreeMinNodeSize=config.octreeMinNodeSize;Scene3D.octreeLooseness=config.octreeLooseness;var physics3D=window.Physics3D;if(physics3D==null||config.isUseCannonPhysicsEngine){Physics3D._enablePhysics=false;Laya3D.__init__(width,height,config);compolete&&compolete.run();}else {Physics3D._enablePhysics=true;physics3D(config.defaultPhysicsMemory*16,BulletInteractive._interactive).then(function(){Laya3D.__init__(width,height,config);compolete&&compolete.run();});}};_createClass(Laya3D,null,[{key:"enablePhysics",get:function get(){return Physics3D._enablePhysics;}}]);return Laya3D;}();Laya3D.HIERARCHY="HIERARCHY";Laya3D.MESH="MESH";Laya3D.MATERIAL="MATERIAL";Laya3D.TEXTURE2D="TEXTURE2D";Laya3D.TEXTURECUBE="TEXTURECUBE";Laya3D.TEXTURECUBEBIN="TEXTURECUBEBIN";Laya3D.ANIMATIONCLIP="ANIMATIONCLIP";Laya3D.AVATAR="AVATAR";Laya3D.TERRAINHEIGHTDATA="TERRAINHEIGHTDATA";Laya3D.TERRAINRES="TERRAIN";Laya3D.SIMPLEANIMATORBIN="SIMPLEANIMATOR";Laya3D._innerFirstLevelLoaderManager=new Laya.LoaderManager();Laya3D._innerSecondLevelLoaderManager=new Laya.LoaderManager();Laya3D._innerThirdLevelLoaderManager=new Laya.LoaderManager();Laya3D._innerFourthLevelLoaderManager=new Laya.LoaderManager();Laya3D._isInit=false;Laya3D._editerEnvironment=false;Laya3D.physicsSettings=new PhysicsSettings();window.Laya3D=Laya3D;var CastShadowList=/*#__PURE__*/function(_SingletonList4){_inheritsLoose(CastShadowList,_SingletonList4);function CastShadowList(){return _SingletonList4.call(this)||this;}var _proto170=CastShadowList.prototype;_proto170.add=function add(element){var index=element._indexInCastShadowList;if(index!==-1)throw "CastShadowList:element has  in  CastShadowList.";this._add(element);element._indexInCastShadowList=this.length++;};_proto170.remove=function remove(element){var index=element._indexInCastShadowList;this.length--;if(index!==this.length){var end=this.elements[this.length];this.elements[index]=end;end._indexInCastShadowList=index;}element._indexInCastShadowList=-1;};return CastShadowList;}(SingletonList);var AnimatorStateScript=/*#__PURE__*/function(){function AnimatorStateScript(){}var _proto171=AnimatorStateScript.prototype;_proto171.onStateEnter=function onStateEnter(){};_proto171.onStateUpdate=function onStateUpdate(){};_proto171.onStateExit=function onStateExit(){};return AnimatorStateScript;}();var Script3D=/*#__PURE__*/function(_Laya$Component4){_inheritsLoose(Script3D,_Laya$Component4);function Script3D(){var _this92;_this92=_Laya$Component4.apply(this,arguments)||this;_this92._indexInPool=-1;return _this92;}var _proto172=Script3D.prototype;_proto172._checkProcessTriggers=function _checkProcessTriggers(){var prototype=Script3D.prototype;if(this.onTriggerEnter!==prototype.onTriggerEnter)return true;if(this.onTriggerStay!==prototype.onTriggerStay)return true;if(this.onTriggerExit!==prototype.onTriggerExit)return true;return false;};_proto172._checkProcessCollisions=function _checkProcessCollisions(){var prototype=Script3D.prototype;if(this.onCollisionEnter!==prototype.onCollisionEnter)return true;if(this.onCollisionStay!==prototype.onCollisionStay)return true;if(this.onCollisionExit!==prototype.onCollisionExit)return true;return false;};_proto172._onAwake=function _onAwake(){this.onAwake();if(this.onStart!==Script3D.prototype.onStart)Laya.Laya.startTimer.callLater(this,this.onStart);};_proto172._onEnable=function _onEnable(){this.owner._scene._addScript(this);this.onEnable();};_proto172._onDisable=function _onDisable(){this.owner._scene._removeScript(this);this.owner.offAllCaller(this);this.onDisable();};_proto172._onDestroy=function _onDestroy(){var scripts=this.owner._scripts;scripts.splice(scripts.indexOf(this),1);var sprite=this.owner;sprite._needProcessTriggers=false;for(var i=0,n=scripts.length;i<n;i++){if(scripts[i]._checkProcessTriggers()){sprite._needProcessTriggers=true;break;}}sprite._needProcessCollisions=false;for(i=0,n=scripts.length;i<n;i++){if(scripts[i]._checkProcessCollisions()){sprite._needProcessCollisions=true;break;}}this.onDestroy();};_proto172._isScript=function _isScript(){return true;};_proto172._onAdded=function _onAdded(){var sprite=this.owner;var scripts=sprite._scripts;scripts||(sprite._scripts=scripts=[]);scripts.push(this);if(!sprite._needProcessCollisions)sprite._needProcessCollisions=this._checkProcessCollisions();if(!sprite._needProcessTriggers)sprite._needProcessTriggers=this._checkProcessTriggers();};_proto172.onAwake=function onAwake(){};_proto172.onEnable=function onEnable(){};_proto172.onStart=function onStart(){};_proto172.onTriggerEnter=function onTriggerEnter(other){};_proto172.onTriggerStay=function onTriggerStay(other){};_proto172.onTriggerExit=function onTriggerExit(other){};_proto172.onCollisionEnter=function onCollisionEnter(collision){};_proto172.onCollisionStay=function onCollisionStay(collision){};_proto172.onCollisionExit=function onCollisionExit(collision){};_proto172.onJointBreak=function onJointBreak(){};_proto172.onMouseDown=function onMouseDown(){};_proto172.onMouseDrag=function onMouseDrag(){};_proto172.onMouseClick=function onMouseClick(){};_proto172.onMouseUp=function onMouseUp(){};_proto172.onMouseEnter=function onMouseEnter(){};_proto172.onMouseOver=function onMouseOver(){};_proto172.onMouseOut=function onMouseOut(){};_proto172.onUpdate=function onUpdate(){};_proto172.onLateUpdate=function onLateUpdate(){};_proto172.onPreRender=function onPreRender(){};_proto172.onPostRender=function onPostRender(){};_proto172.onDisable=function onDisable(){};_proto172.onDestroy=function onDestroy(){};_createClass(Script3D,[{key:"isSingleton",get:function get(){return false;}}]);return Script3D;}(Laya.Component);var HeightMap=/*#__PURE__*/function(){function HeightMap(width,height,minHeight,maxHeight){this._datas=[];this._w=width;this._h=height;this._minHeight=minHeight;this._maxHeight=maxHeight;}HeightMap.creatFromMesh=function creatFromMesh(mesh,width,height,outCellSize){var vertices=[];var indexs=[];var submesheCount=mesh.subMeshCount;for(var i=0;i<submesheCount;i++){var subMesh=mesh.getSubMesh(i);var vertexBuffer=subMesh._vertexBuffer;var verts=vertexBuffer.getFloat32Data();var subMeshVertices=[];for(var j=0;j<verts.length;j+=vertexBuffer.vertexDeclaration.vertexStride/4){var position=new Vector3(verts[j+0],verts[j+1],verts[j+2]);subMeshVertices.push(position);}vertices.push(subMeshVertices);var ib=subMesh._indexBuffer;indexs.push(ib.getData());}var bounds=mesh.bounds;var minX=bounds.getMin().x;var minZ=bounds.getMin().z;var maxX=bounds.getMax().x;var maxZ=bounds.getMax().z;var minY=bounds.getMin().y;var maxY=bounds.getMax().y;var widthSize=maxX-minX;var heightSize=maxZ-minZ;var cellWidth=outCellSize.x=widthSize/(width-1);var cellHeight=outCellSize.y=heightSize/(height-1);var heightMap=new HeightMap(width,height,minY,maxY);var ray=HeightMap._tempRay;var rayDir=ray.direction;rayDir.x=0;rayDir.y=-1;rayDir.z=0;var heightOffset=0.1;var rayY=maxY+heightOffset;ray.origin.y=rayY;for(var h=0;h<height;h++){var posZ=minZ+h*cellHeight;heightMap._datas[h]=[];for(var w=0;w<width;w++){var posX=minX+w*cellWidth;var rayOri=ray.origin;rayOri.x=posX;rayOri.z=posZ;var closestIntersection=HeightMap._getPosition(ray,vertices,indexs);heightMap._datas[h][w]=closestIntersection===Number.MAX_VALUE?NaN:rayY-closestIntersection;}}return heightMap;};HeightMap.createFromImage=function createFromImage(texture,minHeight,maxHeight){var textureWidth=texture.width;var textureHeight=texture.height;var heightMap=new HeightMap(textureWidth,textureHeight,minHeight,maxHeight);var compressionRatio=(maxHeight-minHeight)/254;var pixelsInfo=texture.getPixels();var index=0;for(var h=0;h<textureHeight;h++){var colDatas=heightMap._datas[h]=[];for(var w=0;w<textureWidth;w++){var r=pixelsInfo[index++];var g=pixelsInfo[index++];var b=pixelsInfo[index++];var a=pixelsInfo[index++];if(r==255&&g==255&&b==255&&a==255)colDatas[w]=NaN;else {colDatas[w]=(r+g+b)/3*compressionRatio+minHeight;}}}return heightMap;};HeightMap._getPosition=function _getPosition(ray,vertices,indexs){var closestIntersection=Number.MAX_VALUE;for(var i=0;i<vertices.length;i++){var subMeshVertices=vertices[i];var subMeshIndexes=indexs[i];for(var j=0;j<subMeshIndexes.length;j+=3){var vertex1=subMeshVertices[subMeshIndexes[j+0]];var vertex2=subMeshVertices[subMeshIndexes[j+1]];var vertex3=subMeshVertices[subMeshIndexes[j+2]];var intersection=Picker.rayIntersectsTriangle(ray,vertex1,vertex2,vertex3);if(!isNaN(intersection)&&intersection<closestIntersection){closestIntersection=intersection;}}}return closestIntersection;};var _proto173=HeightMap.prototype;_proto173._inBounds=function _inBounds(row,col){return row>=0&&row<this._h&&col>=0&&col<this._w;};_proto173.getHeight=function getHeight(row,col){if(this._inBounds(row,col))return this._datas[row][col];else return NaN;};_createClass(HeightMap,[{key:"width",get:function get(){return this._w;}},{key:"height",get:function get(){return this._h;}},{key:"maxHeight",get:function get(){return this._maxHeight;}},{key:"minHeight",get:function get(){return this._minHeight;}}]);return HeightMap;}();HeightMap._tempRay=new Ray(new Vector3(),new Vector3());var MeshTerrainSprite3D=/*#__PURE__*/function(_MeshSprite3D){_inheritsLoose(MeshTerrainSprite3D,_MeshSprite3D);function MeshTerrainSprite3D(mesh,heightMap,name){var _this93;if(name===void 0){name=null;}_this93=_MeshSprite3D.call(this,mesh,name)||this;_this93._heightMap=heightMap;_this93._cellSize=new Vector2();return _this93;}MeshTerrainSprite3D.createFromMesh=function createFromMesh(mesh,heightMapWidth,heightMapHeight,name){if(name===void 0){name=null;}var meshTerrainSprite3D=new MeshTerrainSprite3D(mesh,null,name);meshTerrainSprite3D._initCreateFromMesh(heightMapWidth,heightMapHeight);return meshTerrainSprite3D;};MeshTerrainSprite3D.createFromMeshAndHeightMap=function createFromMeshAndHeightMap(mesh,texture,minHeight,maxHeight,name){if(name===void 0){name=null;}var meshTerrainSprite3D=new MeshTerrainSprite3D(mesh,null,name);meshTerrainSprite3D._initCreateFromMeshHeightMap(texture,minHeight,maxHeight);return meshTerrainSprite3D;};var _proto174=MeshTerrainSprite3D.prototype;_proto174._disableRotation=function _disableRotation(){var rotation=this.transform.rotation;rotation.x=0;rotation.y=0;rotation.z=0;rotation.w=1;this.transform.rotation=rotation;};_proto174._getScaleX=function _getScaleX(){var worldMat=this.transform.worldMatrix;var worldMatE=worldMat.elements;var m11=worldMatE[0];var m12=worldMatE[1];var m13=worldMatE[2];return Math.sqrt(m11*m11+m12*m12+m13*m13);};_proto174._getScaleZ=function _getScaleZ(){var worldMat=this.transform.worldMatrix;var worldMatE=worldMat.elements;var m31=worldMatE[8];var m32=worldMatE[9];var m33=worldMatE[10];return Math.sqrt(m31*m31+m32*m32+m33*m33);};_proto174._initCreateFromMesh=function _initCreateFromMesh(heightMapWidth,heightMapHeight){this._heightMap=HeightMap.creatFromMesh(this.meshFilter.sharedMesh,heightMapWidth,heightMapHeight,this._cellSize);var boundingBox=this.meshFilter.sharedMesh.bounds;var min=boundingBox.getMin();var max=boundingBox.getMax();this._minX=min.x;this._minZ=min.z;};_proto174._initCreateFromMeshHeightMap=function _initCreateFromMeshHeightMap(texture,minHeight,maxHeight){var boundingBox=this.meshFilter.sharedMesh.bounds;this._heightMap=HeightMap.createFromImage(texture,minHeight,maxHeight);this._computeCellSize(boundingBox);var min=boundingBox.getMin();var max=boundingBox.getMax();this._minX=min.x;this._minZ=min.z;};_proto174._computeCellSize=function _computeCellSize(boundingBox){var min=boundingBox.getMin();var max=boundingBox.getMax();var minX=min.x;var minZ=min.z;var maxX=max.x;var maxZ=max.z;var widthSize=maxX-minX;var heightSize=maxZ-minZ;this._cellSize.x=widthSize/(this._heightMap.width-1);this._cellSize.y=heightSize/(this._heightMap.height-1);};_proto174._update=function _update(state){this._disableRotation();};_proto174.getHeight=function getHeight(x,z){MeshTerrainSprite3D._tempVector3.x=x;MeshTerrainSprite3D._tempVector3.y=0;MeshTerrainSprite3D._tempVector3.z=z;this._disableRotation();var worldMat=this.transform.worldMatrix;worldMat.invert(MeshTerrainSprite3D._tempMatrix4x4);Vector3.transformCoordinate(MeshTerrainSprite3D._tempVector3,MeshTerrainSprite3D._tempMatrix4x4,MeshTerrainSprite3D._tempVector3);x=MeshTerrainSprite3D._tempVector3.x;z=MeshTerrainSprite3D._tempVector3.z;var c=(x-this._minX)/this._cellSize.x;var d=(z-this._minZ)/this._cellSize.y;var row=Math.floor(d);var col=Math.floor(c);var s=c-col;var t=d-row;var uy;var vy;var worldMatE=worldMat.elements;var m21=worldMatE[4];var m22=worldMatE[5];var m23=worldMatE[6];var scaleY=Math.sqrt(m21*m21+m22*m22+m23*m23);var translateY=worldMatE[13];var h01=this._heightMap.getHeight(row,col+1);var h10=this._heightMap.getHeight(row+1,col);if(isNaN(h01)||isNaN(h10))return NaN;if(s+t<=1.0){var h00=this._heightMap.getHeight(row,col);if(isNaN(h00))return NaN;uy=h01-h00;vy=h10-h00;return (h00+s*uy+t*vy)*scaleY+translateY;}else {var h11=this._heightMap.getHeight(row+1,col+1);if(isNaN(h11))return NaN;uy=h10-h11;vy=h01-h11;return (h11+(1.0-s)*uy+(1.0-t)*vy)*scaleY+translateY;}};_createClass(MeshTerrainSprite3D,[{key:"minX",get:function get(){var worldMat=this.transform.worldMatrix;var worldMatE=worldMat.elements;return this._minX*this._getScaleX()+worldMatE[12];}},{key:"minZ",get:function get(){var worldMat=this.transform.worldMatrix;var worldMatE=worldMat.elements;return this._minZ*this._getScaleZ()+worldMatE[14];}},{key:"width",get:function get(){return (this._heightMap.width-1)*this._cellSize.x*this._getScaleX();}},{key:"depth",get:function get(){return (this._heightMap.height-1)*this._cellSize.y*this._getScaleZ();}}]);return MeshTerrainSprite3D;}(MeshSprite3D);MeshTerrainSprite3D._tempVector3=new Vector3();MeshTerrainSprite3D._tempMatrix4x4=new Matrix4x4();var GradientDataVector2=/*#__PURE__*/function(){function GradientDataVector2(){this._currentLength=0;this._elements=new Float32Array(12);}var _proto175=GradientDataVector2.prototype;_proto175.add=function add(key,value){if(this._currentLength<8){if(this._currentLength===6&&key!==1){key=1;console.log("GradientDataVector2 warning:the forth key is  be force set to 1.");}this._elements[this._currentLength++]=key;this._elements[this._currentLength++]=value.x;this._elements[this._currentLength++]=value.y;}else {console.log("GradientDataVector2 warning:data count must lessEqual than 4");}};_proto175.cloneTo=function cloneTo(destObject){var destGradientDataVector2=destObject;destGradientDataVector2._currentLength=this._currentLength;var destElements=destGradientDataVector2._elements;for(var i=0,n=this._elements.length;i<n;i++){destElements[i]=this._elements[i];}};_proto175.clone=function clone(){var destGradientDataVector2=new GradientDataVector2();this.cloneTo(destGradientDataVector2);return destGradientDataVector2;};_createClass(GradientDataVector2,[{key:"gradientCount",get:function get(){return this._currentLength/3;}}]);return GradientDataVector2;}();var PixelLineData=/*#__PURE__*/function(){function PixelLineData(){this.startPosition=new Vector3();this.endPosition=new Vector3();this.startColor=new Color();this.endColor=new Color();}var _proto176=PixelLineData.prototype;_proto176.cloneTo=function cloneTo(destObject){this.startPosition.cloneTo(destObject.startPosition);this.endPosition.cloneTo(destObject.endPosition);this.startColor.cloneTo(destObject.startColor);this.endColor.cloneTo(destObject.endColor);};return PixelLineData;}();var PostProcessEffect=/*#__PURE__*/function(){function PostProcessEffect(){}var _proto177=PostProcessEffect.prototype;_proto177.render=function render(context){};return PostProcessEffect;}();var BloomEffect=/*#__PURE__*/function(_PostProcessEffect){_inheritsLoose(BloomEffect,_PostProcessEffect);function BloomEffect(){var _this94;_this94=_PostProcessEffect.call(this)||this;_this94._shader=null;_this94._shaderData=new ShaderData();_this94._linearColor=new Color();_this94._bloomTextureTexelSize=new Vector4();_this94._shaderThreshold=new Vector4();_this94._shaderParams=new Vector4();_this94._pyramid=null;_this94._intensity=0.0;_this94._threshold=1.0;_this94._softKnee=0.5;_this94._diffusion=7.0;_this94._anamorphicRatio=0.0;_this94._dirtIntensity=0.0;_this94._shaderSetting=new Vector4();_this94._dirtTileOffset=new Vector4();_this94.clamp=65472.0;_this94.color=new Color(1.0,1.0,1.0,1.0);_this94.fastMode=false;_this94.dirtTexture=null;_this94._shader=Shader3D.find("PostProcessBloom");_this94._pyramid=new Array(BloomEffect.MAXPYRAMIDSIZE*2);return _this94;}var _proto178=BloomEffect.prototype;_proto178.render=function render(context){var cmd=context.command;var viewport=context.camera.viewport;this._shaderData.setTexture(BloomEffect.SHADERVALUE_AUTOEXPOSURETEX,Laya.Texture2D.whiteTexture);var ratio=this._anamorphicRatio;var rw=ratio<0?-ratio:0;var rh=ratio>0?ratio:0;var tw=Math.floor(viewport.width/(2-rw));var th=Math.floor(viewport.height/(2-rh));var s=Math.max(tw,th);var logs;logs=Math.log2(s)+this._diffusion-10;var logsInt=Math.floor(logs);var iterations=Math.min(Math.max(logsInt,1),BloomEffect.MAXPYRAMIDSIZE);var sampleScale=0.5+logs-logsInt;this._shaderData.setNumber(BloomEffect.SHADERVALUE_SAMPLESCALE,sampleScale);var lthresh=Color.gammaToLinearSpace(this.threshold);var knee=lthresh*this._softKnee+1e-5;this._shaderThreshold.setValue(lthresh,lthresh-knee,knee*2,0.25/knee);this._shaderData.setVector(BloomEffect.SHADERVALUE_THRESHOLD,this._shaderThreshold);var lclamp=Color.gammaToLinearSpace(this.clamp);this._shaderParams.setValue(lclamp,0,0,0);this._shaderData.setVector(BloomEffect.SHADERVALUE_PARAMS,this._shaderParams);var qualityOffset=this.fastMode?1:0;var lastDownTexture=context.source;for(var i=0;i<iterations;i++){var downIndex=i*2;var upIndex=downIndex+1;var subShader=i==0?BloomEffect.SUBSHADER_PREFILTER13+qualityOffset:BloomEffect.SUBSHADER_DOWNSAMPLE13+qualityOffset;var mipDownTexture=RenderTexture.createFromPool(tw,th,Laya.RenderTextureFormat.R8G8B8,Laya.RenderTextureDepthFormat.DEPTHSTENCIL_NONE);mipDownTexture.filterMode=Laya.FilterMode.Bilinear;this._pyramid[downIndex]=mipDownTexture;if(i!==iterations-1){var mipUpTexture=RenderTexture.createFromPool(tw,th,Laya.RenderTextureFormat.R8G8B8,Laya.RenderTextureDepthFormat.DEPTHSTENCIL_NONE);mipUpTexture.filterMode=Laya.FilterMode.Bilinear;this._pyramid[upIndex]=mipUpTexture;}cmd.blitScreenTriangle(lastDownTexture,mipDownTexture,null,this._shader,this._shaderData,subShader);lastDownTexture=mipDownTexture;tw=Math.max(Math.floor(tw/2),1);th=Math.max(Math.floor(th/2),1);}var lastUpTexture=this._pyramid[(iterations-1)*2];for(i=iterations-2;i>=0;i--){downIndex=i*2;upIndex=downIndex+1;mipDownTexture=this._pyramid[downIndex];mipUpTexture=this._pyramid[upIndex];cmd.setShaderDataTexture(this._shaderData,BloomEffect.SHADERVALUE_BLOOMTEX,mipDownTexture);cmd.blitScreenTriangle(lastUpTexture,mipUpTexture,null,this._shader,this._shaderData,BloomEffect.SUBSHADER_UPSAMPLETENT+qualityOffset);lastUpTexture=mipUpTexture;}var linearColor=this._linearColor;this.color.toLinear(linearColor);var intensity=Math.pow(2,this._intensity/10.0)-1.0;var shaderSettings=this._shaderSetting;this._shaderSetting.setValue(sampleScale,intensity,this._dirtIntensity,iterations);var dirtTexture=this.dirtTexture?this.dirtTexture:Laya.Texture2D.blackTexture;var dirtRatio=dirtTexture.width/dirtTexture.height;var screenRatio=viewport.width/viewport.height;var dirtTileOffset=this._dirtTileOffset;if(dirtRatio>screenRatio)dirtTileOffset.setValue(screenRatio/dirtRatio,1.0,(1.0-dirtTileOffset.x)*0.5,0.0);else if(dirtRatio<screenRatio)dirtTileOffset.setValue(1.0,dirtRatio/screenRatio,0.0,(1.0-dirtTileOffset.y)*0.5);var compositeShaderData=context.compositeShaderData;if(this.fastMode)compositeShaderData.addDefine(PostProcess.SHADERDEFINE_BLOOM_LOW);else compositeShaderData.addDefine(PostProcess.SHADERDEFINE_BLOOM);this._bloomTextureTexelSize.setValue(1.0/lastUpTexture.width,1.0/lastUpTexture.height,lastUpTexture.width,lastUpTexture.height);compositeShaderData.setVector(PostProcess.SHADERVALUE_BLOOM_DIRTTILEOFFSET,dirtTileOffset);compositeShaderData.setVector(PostProcess.SHADERVALUE_BLOOM_SETTINGS,shaderSettings);compositeShaderData.setVector(PostProcess.SHADERVALUE_BLOOM_COLOR,new Vector4(linearColor.r,linearColor.g,linearColor.b,linearColor.a));compositeShaderData.setTexture(PostProcess.SHADERVALUE_BLOOM_DIRTTEX,dirtTexture);compositeShaderData.setTexture(PostProcess.SHADERVALUE_BLOOMTEX,lastUpTexture);compositeShaderData.setVector(PostProcess.SHADERVALUE_BLOOMTEX_TEXELSIZE,this._bloomTextureTexelSize);for(i=0;i<iterations;i++){downIndex=i*2;upIndex=downIndex+1;RenderTexture.recoverToPool(this._pyramid[downIndex]);i!==0&&i!==iterations-1&&RenderTexture.recoverToPool(this._pyramid[upIndex]);}context.deferredReleaseTextures.push(lastUpTexture);};_createClass(BloomEffect,[{key:"intensity",get:function get(){return this._intensity;},set:function set(value){this._intensity=Math.max(value,0.0);}},{key:"threshold",get:function get(){return this._threshold;},set:function set(value){this._threshold=Math.max(value,0.0);}},{key:"softKnee",get:function get(){return this._softKnee;},set:function set(value){this._softKnee=Math.min(Math.max(value,0.0),1.0);}},{key:"diffusion",get:function get(){return this._diffusion;},set:function set(value){this._diffusion=Math.min(Math.max(value,1),10);}},{key:"anamorphicRatio",get:function get(){return this._anamorphicRatio;},set:function set(value){this._anamorphicRatio=Math.min(Math.max(value,-1.0),1.0);}},{key:"dirtIntensity",get:function get(){return this._dirtIntensity;},set:function set(value){this._dirtIntensity=Math.max(value,0.0);}}]);return BloomEffect;}(PostProcessEffect);BloomEffect.SHADERVALUE_MAINTEX=Shader3D.propertyNameToID("u_MainTex");BloomEffect.SHADERVALUE_AUTOEXPOSURETEX=Shader3D.propertyNameToID("u_AutoExposureTex");BloomEffect.SHADERVALUE_SAMPLESCALE=Shader3D.propertyNameToID("u_SampleScale");BloomEffect.SHADERVALUE_THRESHOLD=Shader3D.propertyNameToID("u_Threshold");BloomEffect.SHADERVALUE_PARAMS=Shader3D.propertyNameToID("u_Params");BloomEffect.SHADERVALUE_BLOOMTEX=Shader3D.propertyNameToID("u_BloomTex");BloomEffect.SUBSHADER_PREFILTER13=0;BloomEffect.SUBSHADER_PREFILTER4=1;BloomEffect.SUBSHADER_DOWNSAMPLE13=2;BloomEffect.SUBSHADER_DOWNSAMPLE4=3;BloomEffect.SUBSHADER_UPSAMPLETENT=4;BloomEffect.SUBSHADER_UPSAMPLEBOX=5;BloomEffect.MAXPYRAMIDSIZE=16;var SceneManager=function SceneManager(){};var RandX=/*#__PURE__*/function(){function RandX(seed){if(!(seed instanceof Array)||seed.length!==4)throw new Error('Rand:Seed must be an array with 4 numbers');this._state0U=seed[0]|0;this._state0L=seed[1]|0;this._state1U=seed[2]|0;this._state1L=seed[3]|0;}var _proto179=RandX.prototype;_proto179.randomint=function randomint(){var s1U=this._state0U,s1L=this._state0L;var s0U=this._state1U,s0L=this._state1L;var sumL=(s0L>>>0)+(s1L>>>0);var resU=s0U+s1U+(sumL/2>>>31)>>>0;var resL=sumL>>>0;this._state0U=s0U;this._state0L=s0L;var t1U=0,t1L=0;var t2U=0,t2L=0;var a1=23;var m1=0xFFFFFFFF<<32-a1;t1U=s1U<<a1|(s1L&m1)>>>32-a1;t1L=s1L<<a1;s1U=s1U^t1U;s1L=s1L^t1L;t1U=s1U^s0U;t1L=s1L^s0L;var a2=18;var m2=0xFFFFFFFF>>>32-a2;t2U=s1U>>>a2;t2L=s1L>>>a2|(s1U&m2)<<32-a2;t1U=t1U^t2U;t1L=t1L^t2L;var a3=5;var m3=0xFFFFFFFF>>>32-a3;t2U=s0U>>>a3;t2L=s0L>>>a3|(s0U&m3)<<32-a3;t1U=t1U^t2U;t1L=t1L^t2L;this._state1U=t1U;this._state1L=t1L;return [resU,resL];};_proto179.random=function random(){var t2=this.randomint();var t2U=t2[0];var t2L=t2[1];var eU=0x3FF<<52-32;var eL=0;var a1=12;var m1=0xFFFFFFFF>>>32-a1;var sU=t2U>>>a1;var sL=t2L>>>a1|(t2U&m1)<<32-a1;var xU=eU|sU;var xL=eL|sL;RandX._CONVERTION_BUFFER.setUint32(0,xU,false);RandX._CONVERTION_BUFFER.setUint32(4,xL,false);var d=RandX._CONVERTION_BUFFER.getFloat64(0,false);return d-1;};return RandX;}();RandX._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8));RandX.defaultRand=new RandX([0,Date.now()/65536,0,Date.now()%65536]);var Constraint3D=function Constraint3D(){};var Point2PointConstraint=/*#__PURE__*/function(){function Point2PointConstraint(){this._pivotInA=new Vector3();this._pivotInB=new Vector3();}_createClass(Point2PointConstraint,[{key:"pivotInA",get:function get(){return this._pivotInA;},set:function set(value){this._pivotInA=value;}},{key:"pivotInB",get:function get(){return this._pivotInB;},set:function set(value){this._pivotInB=value;}},{key:"damping",get:function get(){return this._damping;},set:function set(value){this._damping=value;}},{key:"impulseClamp",get:function get(){return this._impulseClamp;},set:function set(value){this._impulseClamp=value;}},{key:"tau",get:function get(){return this._tau;},set:function set(value){this._tau=value;}}]);return Point2PointConstraint;}();var HeightfieldColliderShape=function HeightfieldColliderShape(){};var TextMesh=/*#__PURE__*/function(){function TextMesh(){}var _proto180=TextMesh.prototype;_proto180._createVertexBuffer=function _createVertexBuffer(charCount){};_proto180._resizeVertexBuffer=function _resizeVertexBuffer(charCount){};_proto180._addChar=function _addChar(){};_createClass(TextMesh,[{key:"text",get:function get(){return this._text;},set:function set(value){this._text=value;}},{key:"fontSize",get:function get(){return this._fontSize;},set:function set(value){this._fontSize=value;}},{key:"color",get:function get(){return this._color;},set:function set(value){this._color=value;}}]);return TextMesh;}();var Size=/*#__PURE__*/function(){function Size(width,height){this._width=0;this._height=0;this._width=width;this._height=height;}_createClass(Size,[{key:"width",get:function get(){if(this._width===-1)return RenderContext3D.clientWidth;return this._width;}},{key:"height",get:function get(){if(this._height===-1)return RenderContext3D.clientHeight;return this._height;}}],[{key:"fullScreen",get:function get(){return new Size(-1,-1);}}]);return Size;}();exports.AlternateLightQueue=AlternateLightQueue;exports.AnimationClip=AnimationClip;exports.AnimationClipParser03=AnimationClipParser03;exports.AnimationClipParser04=AnimationClipParser04;exports.AnimationEvent=AnimationEvent;exports.AnimationNode=AnimationNode;exports.AnimationTransform3D=AnimationTransform3D;exports.Animator=Animator;exports.AnimatorControllerLayer=AnimatorControllerLayer;exports.AnimatorPlayState=AnimatorPlayState;exports.AnimatorState=AnimatorState;exports.AnimatorStateScript=AnimatorStateScript;exports.Avatar=Avatar;exports.BaseCamera=BaseCamera;exports.BaseMaterial=BaseMaterial;exports.BaseRender=BaseRender;exports.BaseShape=BaseShape;exports.BatchMark=BatchMark;exports.BlinnPhongMaterial=BlinnPhongMaterial;exports.BlitScreenQuadCMD=BlitScreenQuadCMD;exports.BloomEffect=BloomEffect;exports.BoundBox=BoundBox;exports.BoundFrustum=BoundFrustum;exports.BoundSphere=BoundSphere;exports.Bounds=Bounds;exports.BoundsOctree=BoundsOctree;exports.BoundsOctreeNode=BoundsOctreeNode;exports.BoxColliderShape=BoxColliderShape;exports.BoxShape=BoxShape;exports.BufferState=BufferState;exports.BulletInteractive=BulletInteractive;exports.Burst=Burst;exports.Camera=Camera;exports.CameraCullInfo=CameraCullInfo;exports.CapsuleColliderShape=CapsuleColliderShape;exports.CastShadowList=CastShadowList;exports.CharacterController=CharacterController;exports.CircleShape=CircleShape;exports.Cluster=Cluster;exports.ColliderShape=ColliderShape;exports.Collision=Collision;exports.CollisionTool=CollisionTool;exports.CollisionUtils=CollisionUtils;exports.Color=Color;exports.ColorOverLifetime=ColorOverLifetime;exports.Command=Command;exports.CommandBuffer=CommandBuffer;exports.CompoundColliderShape=CompoundColliderShape;exports.ConchQuaternion=ConchQuaternion;exports.ConchVector3=ConchVector3;exports.ConchVector4=ConchVector4;exports.ConeColliderShape=ConeColliderShape;exports.ConeShape=ConeShape;exports.Config3D=Config3D;exports.ConfigurableConstraint=ConfigurableConstraint;exports.Constraint3D=Constraint3D;exports.ConstraintComponent=ConstraintComponent;exports.ContactPoint=ContactPoint;exports.ContainmentType=ContainmentType;exports.CylinderColliderShape=CylinderColliderShape;exports.DefineDatas=DefineDatas;exports.DirectionLight=DirectionLight;exports.DynamicBatchManager=DynamicBatchManager;exports.EffectMaterial=EffectMaterial;exports.Emission=Emission;exports.ExtendTerrainMaterial=ExtendTerrainMaterial;exports.FixedConstraint=FixedConstraint;exports.FloatKeyframe=FloatKeyframe;exports.FrameOverTime=FrameOverTime;exports.FrustumCulling=FrustumCulling;exports.GeometryElement=GeometryElement;exports.Gradient=Gradient;exports.GradientAngularVelocity=GradientAngularVelocity;exports.GradientColor=GradientColor;exports.GradientDataInt=GradientDataInt;exports.GradientDataNumber=GradientDataNumber;exports.GradientDataVector2=GradientDataVector2;exports.GradientMode=GradientMode;exports.GradientSize=GradientSize;exports.GradientVelocity=GradientVelocity;exports.HalfFloatUtils=HalfFloatUtils;exports.HeightMap=HeightMap;exports.HeightfieldColliderShape=HeightfieldColliderShape;exports.HemisphereShape=HemisphereShape;exports.HitResult=HitResult;exports.ILaya3D=ILaya3D;exports.IndexBuffer3D=IndexBuffer3D;exports.Input3D=Input3D;exports.Keyframe=Keyframe;exports.KeyframeNode=KeyframeNode;exports.KeyframeNodeList=KeyframeNodeList;exports.KeyframeNodeOwner=KeyframeNodeOwner;exports.Laya3D=Laya3D;exports.LightQueue=LightQueue;exports.LightSprite=LightSprite;exports.Lightmap=Lightmap;exports.LoadModelV04=LoadModelV04;exports.LoadModelV05=LoadModelV05;exports.Material=Material;exports.MathUtils3D=MathUtils3D;exports.Matrix3x3=Matrix3x3;exports.Matrix4x4=Matrix4x4;exports.Mesh=Mesh;exports.MeshColliderShape=MeshColliderShape;exports.MeshFilter=MeshFilter;exports.MeshReader=MeshReader;exports.MeshRenderDynamicBatchManager=MeshRenderDynamicBatchManager;exports.MeshRenderStaticBatchManager=MeshRenderStaticBatchManager;exports.MeshRenderer=MeshRenderer;exports.MeshSprite3D=MeshSprite3D;exports.MeshSprite3DShaderDeclaration=MeshSprite3DShaderDeclaration;exports.MeshTerrainSprite3D=MeshTerrainSprite3D;exports.MouseTouch=MouseTouch;exports.OctreeMotionList=OctreeMotionList;exports.PBRMaterial=PBRMaterial;exports.PBRSpecularMaterial=PBRSpecularMaterial;exports.PBRStandardMaterial=PBRStandardMaterial;exports.Physics3D=Physics3D;exports.Physics3DUtils=Physics3DUtils;exports.PhysicsCollider=PhysicsCollider;exports.PhysicsComponent=PhysicsComponent;exports.PhysicsSettings=PhysicsSettings;exports.PhysicsSimulation=PhysicsSimulation;exports.PhysicsTriggerComponent=PhysicsTriggerComponent;exports.PhysicsUpdateList=PhysicsUpdateList;exports.Picker=Picker;exports.PixelLineData=PixelLineData;exports.PixelLineFilter=PixelLineFilter;exports.PixelLineMaterial=PixelLineMaterial;exports.PixelLineRenderer=PixelLineRenderer;exports.PixelLineSprite3D=PixelLineSprite3D;exports.PixelLineVertex=PixelLineVertex;exports.Plane=Plane;exports.Point2PointConstraint=Point2PointConstraint;exports.PointLight=PointLight;exports.PostProcess=PostProcess;exports.PostProcessEffect=PostProcessEffect;exports.PostProcessRenderContext=PostProcessRenderContext;exports.PrimitiveMesh=PrimitiveMesh;exports.Quaternion=Quaternion;exports.QuaternionKeyframe=QuaternionKeyframe;exports.Rand=Rand;exports.RandX=RandX;exports.Ray=Ray;exports.RenderContext3D=RenderContext3D;exports.RenderElement=RenderElement;exports.RenderQueue=RenderQueue;exports.RenderState=RenderState;exports.RenderTexture=RenderTexture;exports.RenderableSprite3D=RenderableSprite3D;exports.Rigidbody3D=Rigidbody3D;exports.RotationOverLifetime=RotationOverLifetime;exports.Scene3D=Scene3D;exports.Scene3DShaderDeclaration=Scene3DShaderDeclaration;exports.Scene3DUtils=Scene3DUtils;exports.SceneManager=SceneManager;exports.ScreenQuad=ScreenQuad;exports.ScreenTriangle=ScreenTriangle;exports.Script3D=Script3D;exports.SetRenderTargetCMD=SetRenderTargetCMD;exports.SetShaderDataTextureCMD=SetShaderDataTextureCMD;exports.Shader3D=Shader3D;exports.ShaderData=ShaderData;exports.ShaderDefine=ShaderDefine;exports.ShaderInit3D=ShaderInit3D;exports.ShaderInstance=ShaderInstance;exports.ShaderPass=ShaderPass;exports.ShaderVariable=ShaderVariable;exports.ShaderVariant=ShaderVariant;exports.ShaderVariantCollection=ShaderVariantCollection;exports.ShadowCasterPass=ShadowCasterPass;exports.ShadowCullInfo=ShadowCullInfo;exports.ShadowSliceData=ShadowSliceData;exports.ShadowSpotData=ShadowSpotData;exports.ShadowUtils=ShadowUtils;exports.ShapeUtils=ShapeUtils;exports.ShuriKenParticle3D=ShuriKenParticle3D;exports.ShuriKenParticle3DShaderDeclaration=ShuriKenParticle3DShaderDeclaration;exports.ShurikenParticleData=ShurikenParticleData;exports.ShurikenParticleMaterial=ShurikenParticleMaterial;exports.ShurikenParticleRenderer=ShurikenParticleRenderer;exports.ShurikenParticleSystem=ShurikenParticleSystem;exports.SimpleSingletonList=SimpleSingletonList;exports.SimpleSkinnedMeshRenderer=SimpleSkinnedMeshRenderer;exports.SimpleSkinnedMeshSprite3D=SimpleSkinnedMeshSprite3D;exports.SingletonList=SingletonList;exports.Size=Size;exports.SizeOverLifetime=SizeOverLifetime;exports.SkinnedMeshRenderer=SkinnedMeshRenderer;exports.SkinnedMeshSprite3D=SkinnedMeshSprite3D;exports.SkinnedMeshSprite3DShaderDeclaration=SkinnedMeshSprite3DShaderDeclaration;exports.SkyBox=SkyBox;exports.SkyBoxMaterial=SkyBoxMaterial;exports.SkyDome=SkyDome;exports.SkyMesh=SkyMesh;exports.SkyPanoramicMaterial=SkyPanoramicMaterial;exports.SkyProceduralMaterial=SkyProceduralMaterial;exports.SkyRenderer=SkyRenderer;exports.SphereColliderShape=SphereColliderShape;exports.SphereShape=SphereShape;exports.SphericalHarmonicsL2=SphericalHarmonicsL2;exports.SpotLight=SpotLight;exports.Sprite3D=Sprite3D;exports.StartFrame=StartFrame;exports.StaticBatchManager=StaticBatchManager;exports.StaticPlaneColliderShape=StaticPlaneColliderShape;exports.SubMesh=SubMesh;exports.SubMeshDynamicBatch=SubMeshDynamicBatch;exports.SubMeshInstanceBatch=SubMeshInstanceBatch;exports.SubMeshRenderElement=SubMeshRenderElement;exports.SubMeshStaticBatch=SubMeshStaticBatch;exports.SubShader=SubShader;exports.TextMesh=TextMesh;exports.TextureCube=TextureCube;exports.TextureGenerator=TextureGenerator;exports.TextureMode=TextureMode;exports.TextureSheetAnimation=TextureSheetAnimation;exports.Touch=Touch;exports.TrailFilter=TrailFilter;exports.TrailGeometry=TrailGeometry;exports.TrailMaterial=TrailMaterial;exports.TrailRenderer=TrailRenderer;exports.TrailSprite3D=TrailSprite3D;exports.Transform3D=Transform3D;exports.UnlitMaterial=UnlitMaterial;exports.Utils3D=Utils3D;exports.Vector2=Vector2;exports.Vector3=Vector3;exports.Vector3Keyframe=Vector3Keyframe;exports.Vector4=Vector4;exports.VelocityOverLifetime=VelocityOverLifetime;exports.VertexBuffer3D=VertexBuffer3D;exports.VertexDeclaration=VertexDeclaration;exports.VertexElement=VertexElement;exports.VertexElementFormat=VertexElementFormat;exports.VertexMesh=VertexMesh;exports.VertexPositionTerrain=VertexPositionTerrain;exports.VertexPositionTexture0=VertexPositionTexture0;exports.VertexShuriKenParticle=VertexShuriKenParticle;exports.VertexShurikenParticleBillboard=VertexShurikenParticleBillboard;exports.VertexShurikenParticleMesh=VertexShurikenParticleMesh;exports.VertexTrail=VertexTrail;exports.Viewport=Viewport;exports.WaterPrimaryMaterial=WaterPrimaryMaterial;exports.skinnedMatrixCache=skinnedMatrixCache;})(laya_core,laya_core);

  window.Physics3D=function(A,r){var e=window.Physics3D={};return e.then=function(A){A(e);},function(A,r,e){var i=r.getWorldTransform,a=r.setWorldTransform;window.atob||(window.atob=function(A){var r=String(A).replace(/[=]+$/,"");if(r.length%4==1)throw new InvalidCharacterError("'atob' failed: The string to be decoded is not correctly encoded.");for(var e,i,a=0,f=0,n="";i=r.charAt(f++);~i&&(e=a%4?64*e+i:i,a++%4)?n+=String.fromCharCode(255&e>>(-2*a&6)):0){i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(i);}return n;});var f=new ArrayBuffer(8),n=new Int32Array(f),t=new Float32Array(f),b=new Float64Array(f);function o(A){return n[A];}function k(A,r){n[A]=r;}function c(){return b[0];}function u(A){b[0]=A;}function l(A){t[0]=A;}function s(){return t[0];}var d=new ArrayBuffer(A),v=function(A){var r=new Uint8Array(A);return function(A,e){var i,a;if("undefined"==typeof Buffer)for(i=atob(e),a=0;a<i.length;a++){r[A+a]=i.charCodeAt(a);}else for(i=Buffer.from(e,"base64"),a=0;a<i.length;a++){r[A+a]=i[a];}};}(d);v(2864,"BQ=="),v(2876,"AQ=="),v(2896,"AgAAAAMAAAAMBA=="),v(2920,"AgAAAAAAAAD/////"),v(2976,"BAAAAAUAAADQCwAADRYAAPgLAAAaFgAAqAsAAPgLAAA7FgAAsAsAAAAAAAC8CwAABgAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAAAAAAGAwAAAcAAAAQAAAACgAAAAsAAAAMAAAAEQAAABIAAAATAAAA+AsAAF0WAAC8CwAAAAAAAEwMAAAIAAAAFAAAAAoAAAALAAAADAAAABUAAAAWAAAAFwAAAPgLAACCFgAAvAsAAB0AAAAeAAAAHwAAACAAAAAK16M8AQAAAG8SgzoBAAAAigEAAIsBAAAAAABA"),v(3216,"MAs="),v(3233,"GRJEOwI/LEcUPTMwChsGRktFNw9JDhcDQB08KzYfSi0cASAlKSEIDBUWIi4QOD4LNDEYL0EJOREjQzJCOgUEJignDSoeNQcaSBMkTP8AAFN1Y2Nlc3MASWxsZWdhbCBieXRlIHNlcXVlbmNlAERvbWFpbiBlcnJvcgBSZXN1bHQgbm90IHJlcHJlc2VudGFibGUATm90IGEgdHR5AFBlcm1pc3Npb24gZGVuaWVkAE9wZXJhdGlvbiBub3QgcGVybWl0dGVkAE5vIHN1Y2ggZmlsZSBvciBkaXJlY3RvcnkATm8gc3VjaCBwcm9jZXNzAEZpbGUgZXhpc3RzAFZhbHVlIHRvbyBsYXJnZSBmb3IgZGF0YSB0eXBlAE5vIHNwYWNlIGxlZnQgb24gZGV2aWNlAE91dCBvZiBtZW1vcnkAUmVzb3VyY2UgYnVzeQBJbnRlcnJ1cHRlZCBzeXN0ZW0gY2FsbABSZXNvdXJjZSB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZQBJbnZhbGlkIHNlZWsAQ3Jvc3MtZGV2aWNlIGxpbmsAUmVhZC1vbmx5IGZpbGUgc3lzdGVtAERpcmVjdG9yeSBub3QgZW1wdHkAQ29ubmVjdGlvbiByZXNldCBieSBwZWVyAE9wZXJhdGlvbiB0aW1lZCBvdXQAQ29ubmVjdGlvbiByZWZ1c2VkAEhvc3QgaXMgdW5yZWFjaGFibGUAQWRkcmVzcyBpbiB1c2UAQnJva2VuIHBpcGUASS9PIGVycm9yAE5vIHN1Y2ggZGV2aWNlIG9yIGFkZHJlc3MATm8gc3VjaCBkZXZpY2UATm90IGEgZGlyZWN0b3J5AElzIGEgZGlyZWN0b3J5AFRleHQgZmlsZSBidXN5AEV4ZWMgZm9ybWF0IGVycm9yAEludmFsaWQgYXJndW1lbnQAQXJndW1lbnQgbGlzdCB0b28gbG9uZwBTeW1ib2xpYyBsaW5rIGxvb3AARmlsZW5hbWUgdG9vIGxvbmcAVG9vIG1hbnkgb3BlbiBmaWxlcyBpbiBzeXN0ZW0ATm8gZmlsZSBkZXNjcmlwdG9ycyBhdmFpbGFibGUAQmFkIGZpbGUgZGVzY3JpcHRvcgBObyBjaGlsZCBwcm9jZXNzAEJhZCBhZGRyZXNzAEZpbGUgdG9vIGxhcmdlAFRvbyBtYW55IGxpbmtzAE5vIGxvY2tzIGF2YWlsYWJsZQBSZXNvdXJjZSBkZWFkbG9jayB3b3VsZCBvY2N1cgBTdGF0ZSBub3QgcmVjb3ZlcmFibGUAUHJldmlvdXMgb3duZXIgZGllZABPcGVyYXRpb24gY2FuY2VsZWQARnVuY3Rpb24gbm90IGltcGxlbWVudGVkAE5vIG1lc3NhZ2Ugb2YgZGVzaXJlZCB0eXBlAElkZW50aWZpZXIgcmVtb3ZlZABMaW5rIGhhcyBiZWVuIHNldmVyZWQAUHJvdG9jb2wgZXJyb3IAQmFkIG1lc3NhZ2UATm90IGEgc29ja2V0AERlc3RpbmF0aW9uIGFkZHJlc3MgcmVxdWlyZWQATWVzc2FnZSB0b28gbGFyZ2UAUHJvdG9jb2wgd3JvbmcgdHlwZSBmb3Igc29ja2V0AFByb3RvY29sIG5vdCBhdmFpbGFibGUAUHJvdG9jb2wgbm90IHN1cHBvcnRlZABOb3Qgc3VwcG9ydGVkAEFkZHJlc3MgZmFtaWx5IG5vdCBzdXBwb3J0ZWQgYnkgcHJvdG9jb2wAQWRkcmVzcyBub3QgYXZhaWxhYmxlAE5ldHdvcmsgaXMgZG93bgBOZXR3b3JrIHVucmVhY2hhYmxlAENvbm5lY3Rpb24gcmVzZXQgYnkgbmV0d29yawBDb25uZWN0aW9uIGFib3J0ZWQATm8gYnVmZmVyIHNwYWNlIGF2YWlsYWJsZQBTb2NrZXQgaXMgY29ubmVjdGVkAFNvY2tldCBub3QgY29ubmVjdGVkAE9wZXJhdGlvbiBhbHJlYWR5IGluIHByb2dyZXNzAE9wZXJhdGlvbiBpbiBwcm9ncmVzcwBTdGFsZSBmaWxlIGhhbmRsZQBRdW90YSBleGNlZWRlZABNdWx0aWhvcCBhdHRlbXB0ZWQAQ2FwYWJpbGl0aWVzIGluc3VmZmljaWVudABObyBlcnJvciBpbmZvcm1hdGlvbgAALSsgICAwWDB4AChudWxsKQ=="),v(4912,"GQAKABkZGQAAAAAFAAAAAAAACQAAAAAL"),v(4944,"GQARChkZGQMKBwABGwkLGAAACQYLAAALAAYZAAAAGRkZ"),v(4993,"Dg=="),v(5002,"GQAKDRkZGQANAAACAAkOAAAACQAOAAAO"),v(5051,"DA=="),v(5063,"EwAAAAATAAAAAAkMAAAAAAAMAAAM"),v(5109,"EA=="),v(5121,"DwAAAAQPAAAAAAkQAAAAAAAQAAAQ"),v(5167,"Eg=="),v(5179,"EQAAAAARAAAAAAkSAAAAAAASAAASAAAaAAAAGhoa"),v(5234,"GgAAABoaGgAAAAAAAAk="),v(5283,"FA=="),v(5295,"FwAAAAAXAAAAAAkUAAAAAAAUAAAU"),v(5341,"Fg=="),v(5353,"FQAAAAAVAAAAAAkWAAAAAAAWAAAWAABTdXBwb3J0IGZvciBmb3JtYXR0aW5nIGxvbmcgZG91YmxlIHZhbHVlcyBpcyBjdXJyZW50bHkgZGlzYWJsZWQuClRvIGVuYWJsZSBpdCwgYWRkIC1sYy1wcmludHNjYW4tbG9uZy1kb3VibGUgdG8gdGhlIGxpbmsgY29tbWFuZC4K"),v(5520,"MDEyMzQ1Njc4OUFCQ0RFRi0wWCswWCAwWC0weCsweCAweABpbmYASU5GAG5hbgBOQU4ALgAKAFB1cmUgdmlydHVhbCBmdW5jdGlvbiBjYWxsZWQhAHRlcm1pbmF0ZV9oYW5kbGVyIHVuZXhwZWN0ZWRseSByZXR1cm5lZABTdDl0eXBlX2luZm8ATjEwX19jeHhhYml2MTE2X19zaGltX3R5cGVfaW5mb0UATjEwX19jeHhhYml2MTE3X19jbGFzc190eXBlX2luZm9FAE4xMF9fY3h4YWJpdjEyMF9fc2lfY2xhc3NfdHlwZV9pbmZvRQBOMTBfX2N4eGFiaXYxMjFfX3ZtaV9jbGFzc190eXBlX2luZm9FAAAAAAAYFwAAGAAAABkAAAAaAAAAGgAAABoAAAAAAAAAIBcAABsAAAAcAAAAGgAAABoAAAAaAAAAMzBidEFjdGl2YXRpbmdDb2xsaXNpb25BbGdvcml0aG0AMjBidENvbGxpc2lvbkFsZ29yaXRobQDQCwAAARcAAPgLAADgFgAAGBcAAGJ0Q29sbGlzaW9uU2hhcGVEYXRhADE2YnRDb2xsaXNpb25TaGFwZQDQCwAAQRcAAAAAAADQFwAAIQAAACIAAAAaAAAAIwAAACQAAAAlAAAAGgAAABoAAAAaAAAAGgAAACYAAAAaAAAAGgAAACcAAAAoAAAAKQAAABoAAAAaAAAAKgAAABoAAAAaAAAAGgAAABoAAAAxM2J0Q29udmV4U2hhcGUA+AsAAMAXAABUFwAAAAAAABwZAAAhAAAAKwAAACwAAAAjAAAAJAAAACUAAAAtAAAALgAAAC8AAAAwAAAAMQAAADIAAAAzAAAANAAAADUAAAApAAAANgAAADcAAAAqAAAAOAAAADkAAAA6AAAAOwAAAAAAAAA8GQAAIQAAADwAAAAsAAAAIwAAACQAAAAlAAAALQAAAC4AAAAvAAAAPQAAADEAAAAyAAAAMwAAADQAAAA1AAAAKQAAADYAAAA3AAAAKgAAADgAAAA5AAAAOgAAADsAAAAAAAAAXBkAACEAAAA+AAAALAAAACMAAAAkAAAAJQAAAC0AAAAuAAAALwAAAD8AAAAxAAAAMgAAADMAAAA0AAAANQAAACkAAAA2AAAANwAAACoAAAA4AAAAOQAAADoAAAA7AAAAMTRidENhcHN1bGVTaGFwZQAAAAD4CwAACBkAALwbAAAxNWJ0Q2Fwc3VsZVNoYXBlWAAAAPgLAAAoGQAAHBkAADE1YnRDYXBzdWxlU2hhcGVaAAAA+AsAAEgZAAAcGQAAQ2Fwc3VsZVNoYXBlAGJ0Q2Fwc3VsZVNoYXBlRGF0YQBDYXBzdWxlWABDYXBzdWxlWgAAAAAAAADYGgAAIQAAAEAAAABBAAAAIwAAACQAAAAlAAAAQgAAAC4AAABDAAAARAAAAEUAAABGAAAAMwAAAEcAAABIAAAAKQAAAEkAAABKAAAAKgAAAEsAAAA5AAAAOgAAADsAAAAAAAAA9BoAACEAAABMAAAAQQAAACMAAAAkAAAAJQAAAEIAAAAuAAAAQwAAAE0AAABOAAAARgAAADMAAABHAAAASAAAACkAAABJAAAASgAAACoAAABLAAAAOQAAADoAAAA7AAAAAAAAABAbAAAhAAAATwAAAEEAAAAjAAAAJAAAACUAAABCAAAALgAAAEMAAABQAAAAUQAAAEYAAAAzAAAARwAAAEgAAAApAAAASQAAAEoAAAAqAAAASwAAADkAAAA6AAAAOwAAADExYnRDb25lU2hhcGUAAAD4CwAAyBoAALwbAAAxMmJ0Q29uZVNoYXBlWgAA+AsAAOQaAADYGgAAMTJidENvbmVTaGFwZVgAAPgLAAAAGwAA2BoAAENvbmUAYnRDb25lU2hhcGVEYXRhAENvbmVaAENvbmVY"),v(6980,"vBsAACEAAABSAAAAQQAAACMAAAAkAAAAJQAAAFMAAAAuAAAAGgAAABoAAAAmAAAARgAAADMAAABUAAAAVQAAACkAAAA2AAAAGgAAACoAAAAaAAAAOQAAADoAAAA7AAAAMjFidENvbnZleEludGVybmFsU2hhcGUA+AsAAKQbAADQFwAAAAAAAPAbAABWAAAAVwAAADE4YnRDb252ZXhQb2x5aGVkcm9uAAAAANALAADYGwAAAAAAABwdAABYAAAAWQAAAEEAAAAjAAAAJAAAACUAAABTAAAALgAAAFoAAAAaAAAAJgAAAEYAAAAzAAAAVAAAAFUAAAApAAAANgAAAFsAAAAqAAAAXAAAADkAAAA6AAAAOwAAAF0AAAAaAAAAGgAAABoAAAAaAAAAGgAAABoAAAAaAAAAAAAAAFAdAABYAAAAXgAAAF8AAAAjAAAAJAAAACUAAABgAAAALgAAAFoAAAAaAAAAJgAAAEYAAAAzAAAAVAAAAFUAAAApAAAANgAAAFsAAAAqAAAAXAAAADkAAAA6AAAAOwAAAF0AAAAaAAAAGgAAABoAAAAaAAAAGgAAABoAAAAaAAAAMjNidFBvbHloZWRyYWxDb252ZXhTaGFwZQAAAPgLAAAAHQAAvBsAADM0YnRQb2x5aGVkcmFsQ29udmV4QWFiYkNhY2hpbmdTaGFwZQAAAAD4CwAAKB0AABwdAAAAAAAA+B0AAFgAAABhAAAAYgAAACMAAAAkAAAAJQAAAGAAAAAuAAAAWgAAAGMAAAAmAAAARgAAADMAAABUAAAAVQAAACkAAAA2AAAAWwAAACoAAABcAAAAOQAAADoAAAA7AAAAXQAAAGQAAABlAAAAZgAAAGcAAABoAAAAaQAAAGoAAABrAAAAMTZidEJVX1NpbXBsZXgxdG80AAD4CwAA5B0AAFAdAAABAAAAAwAAAAYAAAAxOGJ0VHJpYW5nbGVDYWxsYmFjawAAAADQCwAAEB4AADMxYnRJbnRlcm5hbFRyaWFuZ2xlSW5kZXhDYWxsYmFjawAAANALAAAwHgAAAAAAAMQeAABsAAAAbQAAAG4AAABvAAAAcAAAADE2YnRNYW5pZm9sZFJlc3VsdABOMzZidERpc2NyZXRlQ29sbGlzaW9uRGV0ZWN0b3JJbnRlcmZhY2U2UmVzdWx0RQAA0AsAAIseAAD4CwAAeB4AALweAAAxMmJ0RGlzcGF0Y2hlcgAA0AsAANAeAAAAAAAASB8AAHIAAABzAAAAdAAAAHUAAAB2AAAAdwAAAHgAAAB5AAAAegAAAHsAAAB8AAAAfQAAAH4AAAB/AAAAgAAAAIEAAAAyMWJ0Q29sbGlzaW9uRGlzcGF0Y2hlcgD4CwAAMB8AAOAeAAAAAAAAoB8AAIIAAACDAAAAhAAAADIzYnRDb2xsaXNpb25QYWlyQ2FsbGJhY2sAMTdidE92ZXJsYXBDYWxsYmFjawAAANALAACCHwAA+AsAAGgfAACYHwAAAAAAAOgfAACFAAAAhgAAAIcAAACIAAAAiQAAADI3YnRHSW1wYWN0Q29sbGlzaW9uQWxnb3JpdGhtAAAA+AsAAMgfAAAgFwAAAAAAALAgAABYAAAAigAAAIsAAAAjAAAAJAAAACUAAABTAAAALgAAAIwAAACNAAAAJgAAAEYAAAAzAAAAVAAAAFUAAAApAAAANgAAAI4AAAAqAAAAjwAAADkAAACQAAAAkQAAAF0AAACSAAAAkwAAAJQAAACVAAAAlgAAAJcAAACYAAAAmQAAADE3YnRUcmlhbmdsZVNoYXBlRXgAMTVidFRyaWFuZ2xlU2hhcGUAAAD4CwAAkCAAABwdAAD4CwAAfCAAAKQgAABUcmlhbmdsZQBidENvbnZleEludGVybmFsU2hhcGVEYXRhAAAAAAAAgCEAAFgAAACaAAAAYgAAACMAAAAkAAAAJQAAAGAAAAAuAAAAWgAAAGMAAAAmAAAARgAAADMAAABUAAAAVQAAACkAAAA2AAAAWwAAACoAAABcAAAAOQAAADoAAAA7AAAAXQAAAGQAAABlAAAAZgAAAGcAAABoAAAAaQAAAGoAAABrAAAAMjBidFRldHJhaGVkcm9uU2hhcGVFeAAA+AsAAGghAAD4HQAAYnRCVV9TaW1wbGV4MXRvNA=="),v(8612,"4CEAAJsAAACcAAAAnQAAAE4xOEdJTV9TaGFwZVJldHJpZXZlcjE5Q2hpbGRTaGFwZVJldHJpZXZlckUA0AsAALQhAAAAAAAALCIAAJ4AAACcAAAAnwAAAE4xOEdJTV9TaGFwZVJldHJpZXZlcjIyVHJpYW5nbGVTaGFwZVJldHJpZXZlckUAAPgLAAD8IQAA4CEAAAAAAAB4IgAAoAAAAJwAAAChAAAATjE4R0lNX1NoYXBlUmV0cmlldmVyMTlUZXRyYVNoYXBlUmV0cmlldmVyRQD4CwAATCIAAOAhAAAAAAAAtCIAAKIAAACjAAAApAAAADI1YnRHSW1wYWN0VHJpYW5nbGVDYWxsYmFjawD4CwAAmCIAACgeAAAAAAAALCMAAKUAAACmAAAApwAAAE4yN2J0R0ltcGFjdENvbGxpc2lvbkFsZ29yaXRobTEwQ3JlYXRlRnVuY0UAMzBidENvbGxpc2lvbkFsZ29yaXRobUNyZWF0ZUZ1bmMAAAAA0AsAAAAjAAD4CwAA1CIAACQjAAAAAAAAjCMAAKgAAACpAAAAqgAAAKsAAACsAAAArQAAAK4AAABidENvbGxpc2lvbk9iamVjdEZsb2F0RGF0YQAxN2J0Q29sbGlzaW9uT2JqZWN0AADQCwAAdyMAAAAAAAAsJAAAWAAAAK8AAACwAAAAIwAAACQAAAAlAAAAsQAAAC4AAACyAAAAswAAACYAAAC0AAAAMwAAAFQAAABVAAAAKQAAALUAAAC2AAAAKgAAALcAAAA5AAAAuAAAALkAAABdAAAAugAAALsAAAC8AAAAvQAAAL4AAAC/AAAAwAAAAMEAAAAxMGJ0Qm94U2hhcGUAAAAA+AsAABwkAAAcHQAAQm94AAAAgD8AAIC/"),v(9310,"gD8AAIC/"),v(9342,"gD8AAIC/"),v(9356,"AQAAAAIAAAAAAAAAAQAAAAIAAAADAAAABAAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAMAAAAEAAAABQAAAAYAAAAHAAAABQAAAAYAAAAHAAAABwAAAAAAAAAwJgAAIQAAAMIAAADDAAAAIwAAACQAAAAlAAAAxAAAAC4AAADFAAAAxgAAAMcAAADIAAAAMwAAAMkAAADKAAAAKQAAAMsAAADMAAAAKgAAAM0AAAA5AAAAOgAAADsAAADOAAAAAAAAAFAmAAAhAAAAzwAAAMMAAAAjAAAAJAAAACUAAADEAAAALgAAAMUAAADQAAAAxwAAAMgAAAAzAAAAyQAAAMoAAAApAAAAywAAANEAAAAqAAAA0gAAADkAAAA6AAAAOwAAANMAAAAAAAAAcCYAACEAAADUAAAAwwAAACMAAAAkAAAAJQAAAMQAAAAuAAAAxQAAANUAAADHAAAAyAAAADMAAADJAAAAygAAACkAAADLAAAA1gAAACoAAADXAAAAOQAAADoAAAA7AAAA2AAAADE1YnRDeWxpbmRlclNoYXBlAAAA+AsAABwmAAC8GwAAMTZidEN5bGluZGVyU2hhcGVYAAD4CwAAPCYAADAmAAAxNmJ0Q3lsaW5kZXJTaGFwZVoAAPgLAABcJgAAMCYAAEN5bGluZGVyWQBidEN5bGluZGVyU2hhcGVEYXRhAEN5bGluZGVyWABDeWxpbmRlcloAAAAAAAAAJCcAACEAAADZAAAA2gAAACMAAAAkAAAAJQAAAFMAAAAuAAAA2wAAANwAAAAmAAAA3QAAAN4AAABUAAAAVQAAACkAAADfAAAA4AAAACoAAADhAAAAOQAAADoAAAA7AAAAMTNidFNwaGVyZVNoYXBlAPgLAAAUJwAAvBsAAFNQSEVSRQAAAAAAANQnAADiAAAA4wAAAOQAAABaTjIyYnRCdmhUcmlhbmdsZU1lc2hTaGFwZTE0cGVyZm9ybVJheWNhc3RFUDE4YnRUcmlhbmdsZUNhbGxiYWNrUks5YnRWZWN0b3IzUzRfRTIxTXlOb2RlT3ZlcmxhcENhbGxiYWNrADIxYnROb2RlT3ZlcmxhcENhbGxiYWNrANALAAC0JwAA+AsAAEwnAADMJwAAAAAAAGgoAADiAAAA5QAAAOYAAABaTjIyYnRCdmhUcmlhbmdsZU1lc2hTaGFwZTE3cGVyZm9ybUNvbnZleGNhc3RFUDE4YnRUcmlhbmdsZUNhbGxiYWNrUks5YnRWZWN0b3IzUzRfUzRfUzRfRTIxTXlOb2RlT3ZlcmxhcENhbGxiYWNrAAAAAPgLAAD0JwAAzCcAAAAAAADUKAAA5wAAAOgAAAAaAAAAIwAAACQAAAAlAAAAGgAAABoAAAAaAAAAGgAAACYAAADpAAAA6gAAACcAAAAoAAAAKQAAABoAAAAxNGJ0Q29uY2F2ZVNoYXBlAAAAAPgLAADAKAAAVBcAAAAAAABEKQAA6wAAAOwAAADtAAAAIwAAACQAAAAlAAAA7gAAAO8AAADwAAAA8QAAACYAAADpAAAA6gAAAPIAAADzAAAAKQAAAPQAAAAxOGJ0U3RhdGljUGxhbmVTaGFwZQAAAAD4CwAALCkAANQoAABTVEFUSUNQTEFORQBidFN0YXRpY1BsYW5lU2hhcGVEYXRhAAAAAAAAbCoAAPUAAAD2AAAA9wAAACMAAAAkAAAAJQAAAPgAAAD5AAAA+gAAAPsAAAAmAAAA/AAAAP0AAAAnAAAAKAAAACkAAAD+AAAA/wAAAAABAAABAQAAAgEAAAMBAAAEAQAABQEAAAYBAAAHAQAACAEAAAkBAAAKAQAACwEAAAwBAAANAQAADgEAAA8BAAAQAQAAEQEAABIBAABidEdJbXBhY3RNZXNoU2hhcGVEYXRhADIzYnRHSW1wYWN0U2hhcGVJbnRlcmZhY2UAAAAA+AsAACcqAADUKAAAMjJidEdJbXBhY3RNZXNoU2hhcGVQYXJ0AAAAAPgLAABQKgAARCoAAAAAAAAsKwAAEwEAABQBAAD3AAAAIwAAACQAAAAlAAAAFQEAABYBAAAXAQAAGAEAACYAAAAZAQAA6gAAABoBAAAbAQAAKQAAABwBAAAdAQAAHgEAAAEBAAAfAQAAIAEAACEBAAAiAQAAIwEAACQBAAAlAQAAJgEAACcBAAAoAQAAKQEAACoBAAArAQAALAEAAC0BAAAuAQAALwEAADE4YnRHSW1wYWN0TWVzaFNoYXBlAAAAAPgLAAAUKwAARCoAAAAAAABEKgAAMAEAADEBAAD3AAAAIwAAACQAAAAlAAAAMgEAABYBAAAaAAAAGgAAACYAAAAzAQAA6gAAACcAAAAoAAAAKQAAADQBAAD/AAAAAAEAAAEBAAAaAAAAGgAAABoAAAAaAAAAGgAAABoAAAAaAAAAGgAAADUBAAA2AQAADAEAABoAAAAaAAAAGgAAABoAAAARAQAANwEAAAAAAABMLAAAOAEAADkBAAA6AQAAOwEAADwBAAA9AQAATjIyYnRHSW1wYWN0TWVzaFNoYXBlUGFydDIzVHJpbWVzaFByaW1pdGl2ZU1hbmFnZXJFADIyYnRQcmltaXRpdmVNYW5hZ2VyQmFzZQAAAADQCwAAKCwAAPgLAAD0KwAARCwAAEdJbXBhY3RNZXNoU2hhcGVQYXJ0AEdJbXBhY3RNZXNoAE42YnREYnZ0OElDb2xsaWRlRQDQCwAAeSw="),v(11424,"AwAAAAQAAAAEAAAABgAAAIP5ogBETm4A/CkVANFXJwDdNPUAYtvAADyZlQBBkEMAY1H+ALveqwC3YcUAOm4kANJNQgBJBuAACeouAByS0QDrHf4AKbEcAOg+pwD1NYIARLsuAJzphAC0JnAAQX5fANaROQBTgzkAnPQ5AItfhAAo+b0A+B87AN7/lwAPmAUAES/vAApaiwBtH20Az342AAnLJwBGT7cAnmY/AC3qXwC6J3UA5evHAD178QD3OQcAklKKAPtr6gAfsV8ACF2NADADVgB7/EYA8KtrACC8zwA29JoA46kdAF5hkQAIG+YAhZllAKAUXwCNQGgAgNj/ACdzTQAGBjEAylYVAMmocwB74mAAa4zAABnERwDNZ8MACejcAFmDKgCLdsQAphyWAESv3QAZV9EApT4FAAUH/wAzfj8AwjLoAJhP3gC7fTIAJj3DAB5r7wCf+F4ANR86AH/yygDxhx0AfJAhAGokfADVbvoAMC13ABU7QwC1FMYAwxmdAK3EwgAsTUEADABdAIZ9RgDjcS0Am8aaADNiAAC00nwAtKeXADdV1QDXPvYAoxAYAE12/ABknSoAcNerAGN8+AB6sFcAFxXnAMBJVgA71tkAp4Q4ACQjywDWincAWlQjAAAfuQDxChsAGc7fAJ8x/wBmHmoAmVdhAKz7RwB+f9gAImW3ADLoiQDmv2AA78TNAGw2CQBdP9QAFt7XAFg73gDem5IA0iIoACiG6ADiWE0AxsoyAAjjFgDgfcsAF8BQAPMdpwAY4FsALhM0AIMSYgCDSAEA9Y5bAK2wfwAe6fIASEpDABBn0wCq3dgArl9CAGphzgAKKKQA05m0AAam8gBcd38Ao8KDAGE8iACKc3gAr4xaAG/XvQAtpmMA9L/LAI2B7wAmwWcAVcpFAMrZNgAoqNIAwmGNABLJdwAEJhQAEkabAMRZxADIxUQATbKRAAAX8wDUQ60AKUnlAP3VEAAAvvwAHpTMAHDO7gATPvUA7PGAALPnwwDH+CgAkwWUAMFxPgAuCbMAC0XzAIgSnACrIHsALrWfAEeSwgB7Mi8ADFVtAHKnkABr5x8AMcuWAHkWSgBBeeIA9N+JAOiUlwDi5oQAmTGXAIjtawBfXzYAu/0OAEiatABnpGwAcXJCAI1dMgCfFbgAvOUJAI0xJQD3dDkAMAUcAA0MAQBLCGgALO5YAEeqkAB05wIAvdYkAPd9pgBuSHIAnxbvAI6UpgC0kfYA0VNRAM8K8gAgmDMA9Ut+ALJjaADdPl8AQF0DAIWJfwBVUikAN2TAAG3YEAAySDIAW0x1AE5x1ABFVG4ACwnBACr1aQAUZtUAJwedAF0EUAC0O9sA6nbFAIf5FwBJa30AHSe6AJZpKQDGzKwArRRUAJDiagCI2YkALHJQAASkvgB3B5QA8zBwAAD8JwDqcagAZsJJAGTgPQCX3YMAoz+XAEOU/QANhowAMUHeAJI5nQDdcIwAF7fnAAjfOwAVNysAXICgAFqAkwAQEZIAD+jYAGyArwDb/0sAOJAPAFkYdgBipRUAYcu7AMeJuQAQQL0A0vIEAEl1JwDrtvYA2yK7AAoUqgCJJi8AZIN2AAk7MwAOlBoAUTqqAB2jwgCv7a4AXCYSAG3CTQAtepwAwFaXAAM/gwAJ8PYAK0CMAG0xmQA5tAcADCAVANjDWwD1ksQAxq1LAE7KpQCnN80A5qk2AKuSlADdQmgAGWPeAHaM7wBoi1IA/Ns3AK6hqwDfFTEAAK6hAAz72gBkTWYA7QW3ACllMABXVr8AR/86AGr5uQB1vvMAKJPfAKuAMABmjPYABMsVAPoiBgDZ5B0APbOkAFcbjwA2zQkATkLpABO+pAAzI7UA8KoaAE9lqADSwaUACz8PAFt4zQAj+XYAe4sEAIkXcgDGplMAb27iAO/rAACbSlgAxNq3AKpmugB2z88A0QIdALHxLQCMmcEAw613AIZI2gD3XaAAxoD0AKzwLwDd7JoAP1y8ANDebQCQxx8AKtu2AKMlOgAAr5oArVOTALZXBAApLbQAS4B+ANoHpwB2qg4Ae1mhABYSKgDcty0A+uX9AInb/gCJvv0A5HZsAAap/AA+gHAAhW4VAP2H/wAoPgcAYWczACoYhgBNveoAs+evAI9tbgCVZzkAMb9bAITXSAAw3xYAxy1DACVhNQDJcM4AMMu4AL9s/QCkAKIABWzkAFrdoAAhb0cAYhLSALlchABwYUkAa1bgAJlSAQBQVTcAHtW3ADPxxAATbl8AXTDkAIUuqQAdssMAoTI2AAi3pADqsdQAFvchAI9p5AAn/3cADAOAAI1ALQBPzaAAIKWZALOi0wAvXQoAtPlCABHaywB9vtAAm9vBAKsXvQDKooEACGpcAC5VFwAnAFUAfxTwAOEHhgAUC2QAlkGNAIe+3gDa/SoAayW2AHuJNAAF8/4Aub+eAGhqTwBKKqgAT8RaAC34vADXWpgA9MeVAA1NjQAgOqYApFdfABQ/sQCAOJUAzCABAHHdhgDJ3rYAv2D1AE1lEQABB2sAjLCsALLA0ABRVUgAHvsOAJVywwCjBjsAwEA1AAbcewDgRcwATin6ANbKyADo80EAfGTeAJtk2ADZvjEApJfDAHdY1ABp48UA8NoTALo6PABGGEYAVXVfANK99QBuksYArC5dAA5E7QAcPkIAYcSHACn96QDn1vMAInzKAG+RNQAI4MUA/9eNAG5q4gCw/cYAkwjBAHxddABrrbIAzW6dAD5yewDGEWoA98+pAClz3wC1yboAtwBRAOKyDQB0uiQA5X1gAHTYigANFSwAgRgMAH5mlAABKRYAn3p2AP39vgBWRe8A2X42AOzZEwCLurkAxJf8ADGoJwDxbsMAlMU2ANioVgC0qLUAz8wOABKJLQBvVzQALFaJAJnO4wDWILkAa16qAD4qnAARX8wA/QtKAOH0+wCOO20A4oYsAOnUhAD8tKkA7+7RAC41yQAvOWEAOCFEABvZyACB/AoA+0pqAC8c2ABTtIQATpmMAFQizAAqVdwAwMbWAAsZlgAacLgAaZVkACZaYAA/Uu4AfxEPAPS1EQD8y/UANLwtADS87gDoXcwA3V5gAGeOmwCSM+8AyRe4AGFYmwDhV7wAUYPGANg+EADdcUgALRzdAK8YoQAhLEYAWfPXANl6mACeVMAAT4b6AFYG/ADlea4AiSI2ADitIgBnk9wAVeiqAIImOADK55sAUQ2kAJkzsQCp1w4AaQVIAGWy8AB/iKcAiEyXAPnRNgAhkrMAe4JKAJjPIQBAn9wA3EdVAOF0OgBn60IA/p3fAF7UXwB7Z6QAuqx6AFX2ogAriCMAQbpVAFluCAAhKoYAOUeDAInj5gDlntQASftAAP9W6QAcD8oAxVmKAJT6KwDTwcUAD8XPANtargBHxYYAhUNiACGGOwAseZQAEGGHACpMewCALBoAQ78SAIgmkAB4PIkAqMTkAOXbewDEOsIAJvTqAPdnigANkr8AZaMrAD2TsQC9fAsApFHcACfdYwBp4d0AmpQZAKgplQBozigACe20AESfIABOmMoAcIJjAH58IwAPuTIAp/WOABRW5wAh8QgAtZ0qAG9+TQClGVEAtfmrAILf1gCW3WEAFjYCAMQ6nwCDoqEAcu1tADmNegCCuKkAazJcAEYnWwAANO0A0gB3APz0VQABWU0A4HGA"),v(14211,"QPsh+T8AAAAALUR0PgAAAICYRvg8AAAAYFHMeDsAAACAgxvwOQAAAEAgJXo4AAAAgCKC4zYAAAAAHfNpNQAAAABQOAAAPgEAAD8BAABAAQAAIwAAACQAAAAlAAAAQQEAAEIBAABDAQAARAEAACYAAABFAQAARgEAAEcBAABIAQAAKQAAAEkBAABKAQAAYnRDb21wb3VuZFNoYXBlQ2hpbGREYXRhAGJ0Q29tcG91bmRTaGFwZURhdGEAMTVidENvbXBvdW5kU2hhcGUAAPgLAAA9OAAAVBcAAENvbXBvdW5kAGJ0SW50SW5kZXhEYXRhAGJ0U2hvcnRJbnRJbmRleFRyaXBsZXREYXRhAGJ0Q2hhckluZGV4VHJpcGxldERhdGEAYnRWZWN0b3IzRmxvYXREYXRhAGJ0VmVjdG9yM0RvdWJsZURhdGEAYnRNZXNoUGFydERhdGEAYnRTdHJpZGluZ01lc2hJbnRlcmZhY2VEYXRhADIzYnRTdHJpZGluZ01lc2hJbnRlcmZhY2UAAADQCwAA+DgAAAAAAACAOQAASwEAAEwBAABNAQAATgEAAE8BAABQAQAAUQEAAFIBAABTAQAAVAEAAFUBAABWAQAAVwEAAFgBAABZAQAAMjZidFRyaWFuZ2xlSW5kZXhWZXJ0ZXhBcnJheQAAAAD4CwAAYDkAABQ5AAAAAAAA5DkAAFoBAABbAQAATQEAAE4BAABPAQAAUAEAAFEBAABSAQAAXAEAAF0BAABVAQAAVgEAAFcBAABYAQAAWQEAADE0YnRUcmlhbmdsZU1lc2gAAAAA+AsAANA5AACAOQAAAQAAAAIAAAAAAAAAAgAAAAAAAAABAAAAAAAAAGg6AABgAQAAYQEAAGIBAAAzMGJ0R2prRXBhUGVuZXRyYXRpb25EZXB0aFNvbHZlcgAzMGJ0Q29udmV4UGVuZXRyYXRpb25EZXB0aFNvbHZlcgAAANALAAA9OgAA+AsAABw6AABgOgAAAAAAAMw6AABjAQAAZAEAAGUBAAAxN2J0R2prUGFpckRldGVjdG9yADM2YnREaXNjcmV0ZUNvbGxpc2lvbkRldGVjdG9ySW50ZXJmYWNlAADQCwAAnDoAAPgLAACIOgAAxDoAAAAAAAAQOwAAYAEAAGYBAABnAQAAMzNidE1pbmtvd3NraVBlbmV0cmF0aW9uRGVwdGhTb2x2ZXIA+AsAAOw6AABgOgAAAAAAAOQ7AABsAAAAaAEAAGkBAABqAQAAawEAAFpOMzNidE1pbmtvd3NraVBlbmV0cmF0aW9uRGVwdGhTb2x2ZXIxMmNhbGNQZW5EZXB0aEVSMjJidFZvcm9ub2lTaW1wbGV4U29sdmVyUEsxM2J0Q29udmV4U2hhcGVTNF9SSzExYnRUcmFuc2Zvcm1TN19SOWJ0VmVjdG9yM1M5X1M5X1AxMmJ0SURlYnVnRHJhd0UyMGJ0SW50ZXJtZWRpYXRlUmVzdWx0AAD4CwAAODsAALweAAAxMmJ0Q29udmV4Q2FzdAAA0AsAAPA7AAAAAAAAMDwAAGwBAABtAQAAbgEAADE1YnRHamtDb252ZXhDYXN0AAAA+AsAABw8AAAAPAAAAAAAAGw8AABsAAAAbwEAAHABAABxAQAAcgEAADE2YnRQb2ludENvbGxlY3RvcgAA+AsAAFg8AAC8HgAAAAAAANA8AABzAQAAdAEAAHUBAAAAAAAA+DwAAHYBAAB3AQAAeAEAAHkBAAB6AQAATjIzYnRDb252ZXhDb252ZXhBbGdvcml0aG0xMENyZWF0ZUZ1bmNFAPgLAACoPAAAJCMAADIzYnRDb252ZXhDb252ZXhBbGdvcml0aG0AAAD4CwAA3DwAACAXAAAAAAAAqD0AAGwAAAB7AQAAfAEAAH0BAAB+AQAAWk4yM2J0Q29udmV4Q29udmV4QWxnb3JpdGhtMTZwcm9jZXNzQ29sbGlzaW9uRVBLMjRidENvbGxpc2lvbk9iamVjdFdyYXBwZXJTMl9SSzE2YnREaXNwYXRjaGVySW5mb1AxNmJ0TWFuaWZvbGRSZXN1bHRFMTNidER1bW15UmVzdWx0AAAAAPgLAAAgPQAAvB4AAAAAAABgPgAAbAAAAH8BAACAAQAAgQEAAIIBAABaTjIzYnRDb252ZXhDb252ZXhBbGdvcml0aG0xNnByb2Nlc3NDb2xsaXNpb25FUEsyNGJ0Q29sbGlzaW9uT2JqZWN0V3JhcHBlclMyX1JLMTZidERpc3BhdGNoZXJJbmZvUDE2YnRNYW5pZm9sZFJlc3VsdEUyMWJ0V2l0aG91dE1hcmdpblJlc3VsdAAAAAD4CwAA0D0AALweAAAAAAAApD4AAGwAAACDAQAAbgAAAG8AAACEAQAAMjRidFBlcnR1cmJlZENvbnRhY3RSZXN1bHQAAPgLAACIPgAAxB4AAAAAAADsPgAAhQEAAIYBAACHAQAAiAEAAIkBAABOMTJidENvbnZleENhc3QxMENhc3RSZXN1bHRFAAAAANALAADMPgAAAAAAACQ/AABsAQAAjAEAAI0BAAAyMmJ0U3Vic2ltcGxleENvbnZleENhc3QAAAAA+AsAAAg/AAAAPAAAAAAAAOQ/AACOAQAAjwEAAJABAACRAQAAkgEAAAAAAAAMQAAAkwEAAJQBAACVAQAAYnRDb252ZXhUcmlhbmdsZUNhbGxiYWNrOjpwcm9jZXNzVHJpYW5nbGUAYnRDb252ZXhDb25jYXZlQ29sbGlzaW9uQWxnb3JpdGhtOjpwcm9jZXNzQ29sbGlzaW9uADMzYnRDb252ZXhDb25jYXZlQ29sbGlzaW9uQWxnb3JpdGhtAAAA+AsAAL4/AAAgFwAAMjRidENvbnZleFRyaWFuZ2xlQ2FsbGJhY2sAAPgLAADwPwAAKB4AAAAAAACkIAAAWAAAAJYBAACXAQAAIwAAACQAAAAlAAAAUwAAAC4AAACMAAAAjQAAACYAAABGAAAAMwAAAFQAAABVAAAAKQAAADYAAACOAAAAKgAAAI8AAAA5AAAAkAAAAJEAAABdAAAAkgAAAJMAAACUAAAAlQAAAJYAAACXAAAAmAAAAJkAAAAAAAAAVEEAAKIAAACYAQAAmQEAAFpOMzNidENvbnZleENvbmNhdmVDb2xsaXNpb25BbGdvcml0aG0yMWNhbGN1bGF0ZVRpbWVPZkltcGFjdEVQMTdidENvbGxpc2lvbk9iamVjdFMxX1JLMTZidERpc3BhdGNoZXJJbmZvUDE2YnRNYW5pZm9sZFJlc3VsdEUzMUxvY2FsVHJpYW5nbGVTcGhlcmVDYXN0Q2FsbGJhY2sAAAD4CwAAtEAAACgeAABwcm9jZXNzVHJpYW5nbGUAAAAAAKxBAACaAQAAmwEAAJwBAACdAQAAngEAADI4YnRDb21wb3VuZENvbGxpc2lvbkFsZ29yaXRobQAA+AsAAIxBAAAgFwAAAAAAAPhBAACfAQAAoAEAAKEBAACiAQAAowEAAKQBAAClAQAAMjJidENvbXBvdW5kTGVhZkNhbGxiYWNrAAAAAPgLAADcQQAAjCwAAAAAAAA8QgAApgEAAKcBAACoAQAAqQEAAKoBAAAyM2J0SGFzaGVkU2ltcGxlUGFpckNhY2hlAAAA0AsAACBCAAAAAAAAiEIAAKsBAACsAQAArQEAAK4BAACvAQAAMzZidENvbXBvdW5kQ29tcG91bmRDb2xsaXNpb25BbGdvcml0aG0AAPgLAABgQgAArEEAAAAAAADcQgAAnwEAALABAACxAQAAsgEAAKMBAACkAQAApQEAADMwYnRDb21wb3VuZENvbXBvdW5kTGVhZkNhbGxiYWNrAAAAAPgLAAC4QgAAjCwAAGJ0Q29tcG91bmRDb21wb3VuZExlYWZDYWxsYmFjazo6UHJvY2VzcwAAAAAAQEMAABgAAACzAQAAtAEAALUBAAC2AQAAMTZidEVtcHR5QWxnb3JpdGhtAAD4CwAALEMAABgXAAAAAAAAjEMAALcBAAC4AQAAuQEAALoBAAC7AQAAMzJidFNwaGVyZVNwaGVyZUNvbGxpc2lvbkFsZ29yaXRobQAA+AsAAGhDAAAgFwAAAAAAAMhDAABjAQAAvAEAAL0BAAAyMlNwaGVyZVRyaWFuZ2xlRGV0ZWN0b3IAAAAA+AsAAKxDAADEOgAAAAAAABhEAAC+AQAAvwEAAMABAADBAQAAwgEAADM0YnRTcGhlcmVUcmlhbmdsZUNvbGxpc2lvbkFsZ29yaXRobQAAAAD4CwAA8EMAACAX"),v(17456,"OGPtPtoPST9emHs/2g/JP2k3rDFoISIztA8UM2ghojPbD0k/2w9Jv+TLFkDkyxbAAAAAAAAAAIDbD0lA2w9JwAAAAACYRAAAYwEAAMMBAADEAQAAMTZidEJveEJveERldGVjdG9yAAD4CwAAhEQAAMQ6AAAAAAAA4EQAAMUBAADGAQAAxwEAAMgBAADJAQAAMjZidEJveEJveENvbGxpc2lvbkFsZ29yaXRobQAAAAD4CwAAwEQAACAXAAAAAAAALEUAAMoBAADLAQAAzAEAAM0BAADOAQAAMzFidENvbnZleFBsYW5lQ29sbGlzaW9uQWxnb3JpdGhtAAAA+AsAAAhFAAAYFwAAAAAAAKBFAADPAQAA0AEAANEBAADSAQAA0wEAANQBAAAzMWJ0RGVmYXVsdENvbGxpc2lvbkNvbmZpZ3VyYXRpb24AMjRidENvbGxpc2lvbkNvbmZpZ3VyYXRpb24AAAAA0AsAAHpFAAD4CwAAWEUAAJhFAAAAAAAA9EUAAKUAAADVAQAA1gEAAE4zM2J0Q29udmV4Q29uY2F2ZUNvbGxpc2lvbkFsZ29yaXRobTEwQ3JlYXRlRnVuY0UAAAD4CwAAwEUAACQjAAAAAAAAUEYAAKUAAADXAQAA2AEAAE4zM2J0Q29udmV4Q29uY2F2ZUNvbGxpc2lvbkFsZ29yaXRobTE3U3dhcHBlZENyZWF0ZUZ1bmNFAAAAAPgLAAAURgAAJCMAAAAAAACgRgAApQAAANkBAADaAQAATjI4YnRDb21wb3VuZENvbGxpc2lvbkFsZ29yaXRobTEwQ3JlYXRlRnVuY0UAAAAA+AsAAHBGAAAkIwAAAAAAAPhGAAClAAAA2wEAANwBAABOMzZidENvbXBvdW5kQ29tcG91bmRDb2xsaXNpb25BbGdvcml0aG0xMENyZWF0ZUZ1bmNFAAAAAPgLAADARgAAJCMAAAAAAABMRwAApQAAAN0BAADeAQAATjI4YnRDb21wb3VuZENvbGxpc2lvbkFsZ29yaXRobTE3U3dhcHBlZENyZWF0ZUZ1bmNFAPgLAAAYRwAAJCMAAAAAAACQRwAApQAAAN8BAADgAQAATjE2YnRFbXB0eUFsZ29yaXRobTEwQ3JlYXRlRnVuY0UAAAAA+AsAAGxHAAAkIwAAAAAAAORHAAClAAAA4QEAAOIBAABOMzJidFNwaGVyZVNwaGVyZUNvbGxpc2lvbkFsZ29yaXRobTEwQ3JlYXRlRnVuY0UAAAAA+AsAALBHAAAkIwAAAAAAADhIAAClAAAA4wEAAOQBAABOMzRidFNwaGVyZVRyaWFuZ2xlQ29sbGlzaW9uQWxnb3JpdGhtMTBDcmVhdGVGdW5jRQAA+AsAAARIAAAkIwAAAAAAAIRIAAClAAAA5QEAAOYBAABOMjZidEJveEJveENvbGxpc2lvbkFsZ29yaXRobTEwQ3JlYXRlRnVuY0UAAPgLAABYSAAAJCMAAAAAAADUSAAApQAAAOcBAADoAQAATjMxYnRDb252ZXhQbGFuZUNvbGxpc2lvbkFsZ29yaXRobTEwQ3JlYXRlRnVuY0UA+AsAAKRIAAAkIwAAAAAAAKxJAADpAQAA6gEAAOsBAADsAQAA7QEAAO4BAADvAQAA8AEAAPEBAADyAQAA8wEAAPQBAAD1AQAA9gEAAPcBAAD4AQAA+QEAAGJ0SGFzaGVkT3ZlcmxhcHBpbmdQYWlyQ2FjaGU6OnByb2Nlc3NBbGxPdmVybGFwcGluZ1BhaXJzADI4YnRIYXNoZWRPdmVybGFwcGluZ1BhaXJDYWNoZQAyMmJ0T3ZlcmxhcHBpbmdQYWlyQ2FjaGUAAAAA+AsAAIRJAAC4YAAA+AsAAGVJAACgSQAAAAAAADxKAACCAAAA+gEAAPsBAABaTjI4YnRIYXNoZWRPdmVybGFwcGluZ1BhaXJDYWNoZTE5Y2xlYW5Qcm94eUZyb21QYWlyc0VQMTdidEJyb2FkcGhhc2VQcm94eVAxMmJ0RGlzcGF0Y2hlckUxN0NsZWFuUGFpckNhbGxiYWNrAAAA+AsAAMxJAACYHwAAAAAAAOBKAACCAAAA/AEAAP0BAABaTjI4YnRIYXNoZWRPdmVybGFwcGluZ1BhaXJDYWNoZTM3cmVtb3ZlT3ZlcmxhcHBpbmdQYWlyc0NvbnRhaW5pbmdQcm94eUVQMTdidEJyb2FkcGhhc2VQcm94eVAxMmJ0RGlzcGF0Y2hlckUxOFJlbW92ZVBhaXJDYWxsYmFjawAAAAD4CwAAXEoAAJgfAAAAAAAAYEsAAP4BAAD/AQAAAAIAAAECAAACAgAAAwIAAAQCAAAFAgAABgIAAAcCAAAIAgAACQIAAAoCAAALAgAAMTZidERidnRCcm9hZHBoYXNlADIxYnRCcm9hZHBoYXNlSW50ZXJmYWNlAADQCwAAP0sAAPgLAAAsSwAAWEsAAAAAAACoSwAAnwEAAAwCAAANAgAADgIAAKMBAACkAQAApQEAADE4YnREYnZ0VHJlZUNvbGxpZGVyAAAAAPgLAACQSwAAjCwAAAAAAADwSwAAnwEAAA8CAAChAQAAEAIAAKMBAACkAQAApQEAADE5QnJvYWRwaGFzZVJheVRlc3RlcgAAAPgLAADYSwAAjCwAAAAAAAA4TAAAnwEAABECAAChAQAAEgIAAKMBAACkAQAApQEAADIwQnJvYWRwaGFzZUFhYmJUZXN0ZXIAAPgLAAAgTAAAjCwAAAAAgD8AAMA/AAAAANzP0TUAAAAAAMAVPwAAAACkTAAAEwIAABQCAACqAAAAqwAAABUCAAAWAgAAFwIAAGJ0UmlnaWRCb2R5RmxvYXREYXRhADExYnRSaWdpZEJvZHkAAPgLAACVTAAAjCMAAAAAAAB8TQAAGwIAABwCAAAdAgAAHgIAAB8CAAAgAgAAIQIAACICAAAjAgAAJAIAACUCAAAmAgAAJwIAAHNvbHZlR3JvdXBDYWNoZUZyaWVuZGx5U2V0dXAAc29sdmVHcm91cENhY2hlRnJpZW5kbHlJdGVyYXRpb25zAHNvbHZlR3JvdXAAMzVidFNlcXVlbnRpYWxJbXB1bHNlQ29uc3RyYWludFNvbHZlcgAxOGJ0Q29uc3RyYWludFNvbHZlcgAAAADQCwAAXE0AAPgLAAA2TQAAdE0AAAAAAAC8TQAAbAEAACgCAAApAgAAMjdidENvbnRpbnVvdXNDb252ZXhDb2xsaXNpb24AAAD4CwAAnE0AAAA8AAAAAAAAFE4AAKIAAAAqAgAAKwIAABoAAAAAAAAAQE4AAKIAAAAsAgAALQIAABoAAAAyNWJ0VHJpYW5nbGVSYXljYXN0Q2FsbGJhY2sA+AsAAPhNAAAoHgAAMjhidFRyaWFuZ2xlQ29udmV4Y2FzdENhbGxiYWNrAAD4CwAAIE4AACgeAAAAAAAA4E8AAC4CAAAvAgAAMAIAADECAAAyAgAAMwIAADQCAAA1AgAANgIAADcCAAA4AgAAOQIAADoCAABPdmVyZmxvdyBpbiBBQUJCLCBvYmplY3QgcmVtb3ZlZCBmcm9tIHNpbXVsYXRpb24ASWYgeW91IGNhbiByZXByb2R1Y2UgdGhpcywgcGxlYXNlIGVtYWlsIGJ1Z3NAY29udGludW91c3BoeXNpY3MuY29tCgBQbGVhc2UgaW5jbHVkZSBhYm92ZSBpbmZvcm1hdGlvbiwgeW91ciBQbGF0Zm9ybSwgdmVyc2lvbiBvZiBPUy4KAFRoYW5rcy4KAHVwZGF0ZUFhYmJzAGNhbGN1bGF0ZU92ZXJsYXBwaW5nUGFpcnMAcGVyZm9ybURpc2NyZXRlQ29sbGlzaW9uRGV0ZWN0aW9uAGRpc3BhdGNoQWxsQ29sbGlzaW9uUGFpcnMAY29udmV4U3dlZXBDb21wb3VuZABjb252ZXhTd2VlcFRlc3QAMTZidENvbGxpc2lvbldvcmxkANALAADNTwAAAAAAAJRQAACiAAAAOwIAACsCAAA8AgAAWk4xNmJ0Q29sbGlzaW9uV29ybGQyMXJheVRlc3RTaW5nbGVJbnRlcm5hbEVSSzExYnRUcmFuc2Zvcm1TMl9QSzI0YnRDb2xsaXNpb25PYmplY3RXcmFwcGVyUk5TXzE3UmF5UmVzdWx0Q2FsbGJhY2tFRTI5QnJpZGdlVHJpYW5nbGVSYXljYXN0Q2FsbGJhY2sAAPgLAAAAUAAAFE4AAAAAAABQUQAAogAAAD0CAAArAgAAPgIAAFpOMTZidENvbGxpc2lvbldvcmxkMjFyYXlUZXN0U2luZ2xlSW50ZXJuYWxFUksxMWJ0VHJhbnNmb3JtUzJfUEsyNGJ0Q29sbGlzaW9uT2JqZWN0V3JhcHBlclJOU18xN1JheVJlc3VsdENhbGxiYWNrRUUyOUJyaWRnZVRyaWFuZ2xlUmF5Y2FzdENhbGxiYWNrXzAAAAAA+AsAALhQAAAUTgAAAAAAAABSAACfAQAAPwIAAKEBAABAAgAAowEAAKQBAAClAQAAWk4xNmJ0Q29sbGlzaW9uV29ybGQyMXJheVRlc3RTaW5nbGVJbnRlcm5hbEVSSzExYnRUcmFuc2Zvcm1TMl9QSzI0YnRDb2xsaXNpb25PYmplY3RXcmFwcGVyUk5TXzE3UmF5UmVzdWx0Q2FsbGJhY2tFRTlSYXlUZXN0ZXIAAAD4CwAAgFEAAIwsAAAAAAAArFIAAEECAABCAgAAQwIAAEQCAABaTjE2YnRDb2xsaXNpb25Xb3JsZDIxcmF5VGVzdFNpbmdsZUludGVybmFsRVJLMTFidFRyYW5zZm9ybVMyX1BLMjRidENvbGxpc2lvbk9iamVjdFdyYXBwZXJSTlNfMTdSYXlSZXN1bHRDYWxsYmFja0VFMTVMb2NhbEluZm9BZGRlcjIAAAAA+AsAACRSAAAgXwAAAAAAAIBTAACiAAAARQIAAC0CAABGAgAAWk4xNmJ0Q29sbGlzaW9uV29ybGQyNW9iamVjdFF1ZXJ5U2luZ2xlSW50ZXJuYWxFUEsxM2J0Q29udmV4U2hhcGVSSzExYnRUcmFuc2Zvcm1TNV9QSzI0YnRDb2xsaXNpb25PYmplY3RXcmFwcGVyUk5TXzIwQ29udmV4UmVzdWx0Q2FsbGJhY2tFZkUzMkJyaWRnZVRyaWFuZ2xlQ29udmV4Y2FzdENhbGxiYWNrAAD4CwAA0FIAAEBOAAAAAAAAWFQAAKIAAABHAgAALQIAAEgCAABaTjE2YnRDb2xsaXNpb25Xb3JsZDI1b2JqZWN0UXVlcnlTaW5nbGVJbnRlcm5hbEVQSzEzYnRDb252ZXhTaGFwZVJLMTFidFRyYW5zZm9ybVM1X1BLMjRidENvbGxpc2lvbk9iamVjdFdyYXBwZXJSTlNfMjBDb252ZXhSZXN1bHRDYWxsYmFja0VmRTMyQnJpZGdlVHJpYW5nbGVDb252ZXhjYXN0Q2FsbGJhY2tfMAAAAAD4CwAApFMAAEBOAAAAAAAAMFUAAJ8BAABJAgAAoQEAAEoCAACjAQAApAEAAKUBAABaTjE2YnRDb2xsaXNpb25Xb3JsZDI1b2JqZWN0UXVlcnlTaW5nbGVJbnRlcm5hbEVQSzEzYnRDb252ZXhTaGFwZVJLMTFidFRyYW5zZm9ybVM1X1BLMjRidENvbGxpc2lvbk9iamVjdFdyYXBwZXJSTlNfMjBDb252ZXhSZXN1bHRDYWxsYmFja0VmRTIyYnRDb21wb3VuZExlYWZDYWxsYmFjawAAAAD4CwAAiFQAAIwsAAAAAAAANFYAAEsCAABMAgAATQIAAE4CAABaWk4xNmJ0Q29sbGlzaW9uV29ybGQyNW9iamVjdFF1ZXJ5U2luZ2xlSW50ZXJuYWxFUEsxM2J0Q29udmV4U2hhcGVSSzExYnRUcmFuc2Zvcm1TNV9QSzI0YnRDb2xsaXNpb25PYmplY3RXcmFwcGVyUk5TXzIwQ29udmV4UmVzdWx0Q2FsbGJhY2tFZkVOMjJidENvbXBvdW5kTGVhZkNhbGxiYWNrMTJQcm9jZXNzQ2hpbGRFaVM1X1BLMTZidENvbGxpc2lvblNoYXBlRTE0TG9jYWxJbmZvQWRkZXIAAPgLAABUVQAAAGAAAAAAAAC0VgAATwIAAFACAABRAgAAMTlidFNpbmdsZVJheUNhbGxiYWNrADIzYnRCcm9hZHBoYXNlUmF5Q2FsbGJhY2sAMjRidEJyb2FkcGhhc2VBYWJiQ2FsbGJhY2sAANALAACEVgAA+AsAAGpWAACgVgAA+AsAAFRWAACoVgAAAAAAAOxWAABPAgAAUgIAAFMCAAAyMWJ0U2luZ2xlU3dlZXBDYWxsYmFjawD4CwAA1FYAAKhWAAAAAAAAOFcAAFQCAABVAgAAVgIAAFcCAAD8////OFcAAFgCAABZAgAAWgIAADE3RGVidWdEcmF3Y2FsbGJhY2sALAwAACRXAAAAAAAAAgAAACgeAAACAAAAVB4AAAIEAAAAAAAAuFcAAFsCAABcAgAAXQIAAF4CAABpc2xhbmRVbmlvbkZpbmRBbmRRdWlja1NvcnQAcHJvY2Vzc0lzbGFuZHMAMjVidFNpbXVsYXRpb25Jc2xhbmRNYW5hZ2VyAADQCwAAm1cAAAAAAAA8WAAAXwIAAGACAABhAgAAYgIAABoAAAAaAAAAYwIAABoAAAAaAAAAZAIAAGUCAABidFR5cGVkQ29uc3RyYWludEZsb2F0RGF0YQAxN2J0VHlwZWRDb25zdHJhaW50ADEzYnRUeXBlZE9iamVjdAAA0AsAACNYAAAsDAAAD1gAAAAAAAABAAAANFgAAAIEAAAAAAAAqFoAAGYCAABnAgAAMAIAADECAAAyAgAAMwIAAGgCAAA1AgAANgIAAGkCAABqAgAAOQIAAGsCAABsAgAAbQIAAG4CAABvAgAAcAIAAHECAAByAgAAcwIAAHQCAAB1AgAAdgIAAHcCAAB4AgAAeQIAAHoCAAB7AgAAfAIAAH0CAAB+AgAAfwIAAIACAACBAgAAggIAAIMCAACEAgAAhQIAAIYCAACHAgAAiAIAAIkCAACKAgAAiwIAAIwCAACNAgAAZGVidWdEcmF3V29ybGQAaW50ZXJuYWxTaW5nbGVTdGVwU2ltdWxhdGlvbgB1cGRhdGVBY3Rpb25zAHVwZGF0ZUFjdGl2YXRpb25TdGF0ZQBzb2x2ZUNvbnN0cmFpbnRzAGNhbGN1bGF0ZVNpbXVsYXRpb25Jc2xhbmRzAHByZWRpY3RpdmUgY29udmV4U3dlZXBUZXN0AHJlbGVhc2UgcHJlZGljdGl2ZSBjb250YWN0IG1hbmlmb2xkcwBjcmVhdGVQcmVkaWN0aXZlQ29udGFjdHMAQ0NEIG1vdGlvbiBjbGFtcGluZwBpbnRlZ3JhdGVUcmFuc2Zvcm1zAGFwcGx5IHNwZWN1bGF0aXZlIGNvbnRhY3QgcmVzdGl0dXRpb24AcHJlZGljdFVuY29uc3RyYWludE1vdGlvbgBidER5bmFtaWNzV29ybGRGbG9hdERhdGEAMjNidERpc2NyZXRlRHluYW1pY3NXb3JsZAAxNWJ0RHluYW1pY3NXb3JsZAAAAPgLAACIWgAA4E8AAPgLAABuWgAAnFoAAAAAAAAcWwAAjgIAAI8CAACQAgAAMjdJbnBsYWNlU29sdmVySXNsYW5kQ2FsbGJhY2sATjI1YnRTaW11bGF0aW9uSXNsYW5kTWFuYWdlcjE0SXNsYW5kQ2FsbGJhY2tFANALAADmWgAA+AsAAMhaAAAUWwAAAAAAAGhbAABLAgAAkQIAAJICAACTAgAAMzRidENsb3Nlc3ROb3RNZUNvbnZleFJlc3VsdENhbGxiYWNrAAAAAPgLAABAWwAACGAAAAAAAADcWwAAlAIAAJUCAACqAAAAqwAAAKwAAACtAAAArgAAAJYCAACXAgAAAAAAAARcAACYAgAAmQIAAKoAAACrAAAArAAAAK0AAACuAAAAmgIAAJsCAAAxM2J0R2hvc3RPYmplY3QA+AsAAMxbAACMIwAAMjRidFBhaXJDYWNoaW5nR2hvc3RPYmplY3QAAPgLAADoWwAA3FsAAAAAAADQXAAAnAIAAJ0CAACeAgAAnwIAAKACAAChAgAAogIAAKMCAACkAgAApQIAAKYCAACnAgAAqAIAAKkCAACqAgAAqwIAAKwCAACtAgAArgIAADMwYnRLaW5lbWF0aWNDaGFyYWN0ZXJDb250cm9sbGVyADMwYnRDaGFyYWN0ZXJDb250cm9sbGVySW50ZXJmYWNlADE3YnRBY3Rpb25JbnRlcmZhY2UAAADQCwAAplwAAPgLAACFXAAAvFwAAPgLAABkXAAAxFwAAAAAAAAkXQAASwIAAK8CAACwAgAAsQIAADQzYnRLaW5lbWF0aWNDbG9zZXN0Tm90TWVDb252ZXhSZXN1bHRDYWxsYmFjawAAAPgLAAD0XAAACGAAAAAAAACUXQAAXwIAALICAACzAgAAYgIAALQCAAC1AgAAYwIAALYCAAC3AgAAuAIAALkCAAAAAAAAAQAAAAIAAAAzMGJ0R2VuZXJpYzZEb2ZTcHJpbmcyQ29uc3RyYWludAAAAAD4CwAAcF0AADxYAAACAAAAAQAAAAIAAAAAAAAAAQAAAAAAAAABAAAAAgAAAAAAAAACAAAAAAAAAAE="),v(24024,"AQAAAAEAAAACAAAAAgAAAAAAAAAwXgAAugIAALsCAACzAgAAYgIAALQCAAC1AgAAYwIAALYCAAC3AgAAuAIAALkCAAAxN2J0Rml4ZWRDb25zdHJhaW50APgLAAAcXgAAlF0AAGJ0R2VuZXJpYzZEb2ZTcHJpbmcyQ29uc3RyYWludERhdGEAAAAAAACkXgAAvAIAAL0CAAC+AgAAvwIAADE1TGF5YU1vdGlvblN0YXRlADEzYnRNb3Rpb25TdGF0ZQAAANALAACKXgAA+AsAAHheAACcXgAAAAAAAChfAABBAgAAwAIAAMECAADCAgAATjE2YnRDb2xsaXNpb25Xb3JsZDI0Q2xvc2VzdFJheVJlc3VsdENhbGxiYWNrRQBOMTZidENvbGxpc2lvbldvcmxkMTdSYXlSZXN1bHRDYWxsYmFja0UAANALAAD3XgAA+AsAAMheAAAgXwAAAAAAAHxfAADDAgAAxAIAAMECAADFAgAATjE2YnRDb2xsaXNpb25Xb3JsZDI0QWxsSGl0c1JheVJlc3VsdENhbGxiYWNrRQAA+AsAAExfAAAgXwAAAAAAAAhgAABLAgAAxgIAALACAADHAgAATjE2YnRDb2xsaXNpb25Xb3JsZDI3Q2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrRQBOMTZidENvbGxpc2lvbldvcmxkMjBDb252ZXhSZXN1bHRDYWxsYmFja0UAAAAA0AsAANJfAAD4CwAAoF8AAABgAAAAAAAAXGAAAMgCAADJAgAAsAIAAMoCAABOMTZidENvbGxpc2lvbldvcmxkMjNBbGxDb252ZXhSZXN1bHRDYWxsYmFja0UAAAD4CwAALGAAAABgAAAAAAAAwGAAAMsCAADMAgAAzQIAAM4CAADPAgAAMTlidEdob3N0UGFpckNhbGxiYWNrADI1YnRPdmVybGFwcGluZ1BhaXJDYWxsYmFjawAAANALAACaYAAA+AsAAIRgAAC4YA==");var C=function(A,r,e){var i=r.memory,a=new A.Int8Array(e),f=new A.Int16Array(e),t=new A.Int32Array(e),b=new A.Uint8Array(e),d=new A.Uint16Array(e),v=new A.Uint32Array(e),C=new A.Float32Array(e),g=new A.Float64Array(e),_=A.Math.imul,B=A.Math.fround,m=A.Math.abs,R=A.Math.clz32,G=A.Math.min,h=A.Math.max,y=A.Math.floor,Q=(A.Math.ceil,A.Math.sqrt),p=r.abort,D=(A.NaN,A.Infinity),w=r.fd_close,W=r.fd_write,F=r.getWorldTransform,Z=r.setWorldTransform,Y=r.fd_seek,E=90320,N=0;function V(A,r,e){var i,a=0;i=E-16|0,E=i,a=-1;A:{r:{if((0|e)>-1){if(A=0|W(0|A,0|r,0|e,i+12|0),!A)break r;t[256]=A;break A;}t[256]=28;break A;}a=t[i+12>>2];}return E=i+16|0,a;}function I(A){var r=0;return r=t[A+60>>2],t[A+60>>2]=r+-1|r,r=t[A>>2],8&r?(t[A>>2]=32|r,-1):(t[A+4>>2]=0,t[A+8>>2]=0,r=t[A+40>>2],t[A+24>>2]=r,t[A+20>>2]=r,t[A+16>>2]=r+t[A+44>>2],0);}function J(A,r,e){var i=0,f=0,n=0,o=0,k=0,c=0,u=0;A:{r:{e:{if(!(!e|!(3&r))){for(;a[0|A]=b[0|r],i=e+-1|0,A=A+1|0,r=r+1|0,1!=(0|e)&&(e=i,3&r);){}if(e=3&A,!e)break e;break r;}if(i=e,e=3&A,e)break r;}if(i>>>0>=16)for(e=i+-16|0;t[A>>2]=t[r>>2],t[A+4>>2]=t[r+4>>2],t[A+8>>2]=t[r+8>>2],t[A+12>>2]=t[r+12>>2],A=A+16|0,r=r+16|0,i=i+-16|0,i>>>0>15;){}else e=i;if(8&e&&(i=t[r+4>>2],t[A>>2]=t[r>>2],t[A+4>>2]=i,r=r+8|0,A=A+8|0),4&e&&(t[A>>2]=t[r>>2],r=r+4|0,A=A+4|0),2&e&&(a[0|A]=b[0|r],a[A+1|0]=b[r+1|0],r=r+2|0,A=A+2|0),!(1&e))break A;return void(a[0|A]=b[0|r]);}r:if(!(i>>>0<32)){e:{if(3!=(0|e)){if(2==(0|e))break e;if(1!=(0|e))break r;for(a[A+1|0]=b[r+1|0],f=t[r>>2],a[0|A]=f,a[A+2|0]=b[r+2|0],k=i+-3|0,c=A+3|0,u=i+-20&-16,e=0;A=e+c|0,o=r+e|0,n=t[o+4>>2],t[A>>2]=n<<8|f>>>24,f=t[o+8>>2],t[A+4>>2]=f<<8|n>>>24,n=t[o+12>>2],t[A+8>>2]=n<<8|f>>>24,f=t[o+16>>2],t[A+12>>2]=f<<8|n>>>24,e=e+16|0,k=k+-16|0,k>>>0>16;){}A=e+c|0,r=3+(r+e|0)|0,i=(i+-19|0)-u|0;break r;}for(f=t[r>>2],a[0|A]=f,k=i+-1|0,c=A+1|0,u=i+-20&-16,e=0;A=e+c|0,o=r+e|0,n=t[o+4>>2],t[A>>2]=n<<24|f>>>8,f=t[o+8>>2],t[A+4>>2]=f<<24|n>>>8,n=t[o+12>>2],t[A+8>>2]=n<<24|f>>>8,f=t[o+16>>2],t[A+12>>2]=f<<24|n>>>8,e=e+16|0,k=k+-16|0,k>>>0>18;){}A=e+c|0,r=1+(r+e|0)|0,i=(i+-17|0)-u|0;break r;}for(f=t[r>>2],a[0|A]=f,a[A+1|0]=b[r+1|0],k=i+-2|0,c=A+2|0,u=i+-20&-16,e=0;A=e+c|0,o=r+e|0,n=t[o+4>>2],t[A>>2]=n<<16|f>>>16,f=t[o+8>>2],t[A+4>>2]=f<<16|n>>>16,n=t[o+12>>2],t[A+8>>2]=n<<16|f>>>16,f=t[o+16>>2],t[A+12>>2]=f<<16|n>>>16,e=e+16|0,k=k+-16|0,k>>>0>17;){}A=e+c|0,r=2+(r+e|0)|0,i=(i+-18|0)-u|0;}16&i&&(e=b[0|r]|b[r+1|0]<<8,a[0|A]=e,a[A+1|0]=e>>>8,a[A+2|0]=b[r+2|0],a[A+3|0]=b[r+3|0],a[A+4|0]=b[r+4|0],a[A+5|0]=b[r+5|0],a[A+6|0]=b[r+6|0],a[A+7|0]=b[r+7|0],a[A+8|0]=b[r+8|0],a[A+9|0]=b[r+9|0],a[A+10|0]=b[r+10|0],a[A+11|0]=b[r+11|0],a[A+12|0]=b[r+12|0],a[A+13|0]=b[r+13|0],a[A+14|0]=b[r+14|0],a[A+15|0]=b[r+15|0],r=r+16|0,A=A+16|0),8&i&&(a[0|A]=b[0|r],a[A+1|0]=b[r+1|0],a[A+2|0]=b[r+2|0],a[A+3|0]=b[r+3|0],a[A+4|0]=b[r+4|0],a[A+5|0]=b[r+5|0],a[A+6|0]=b[r+6|0],a[A+7|0]=b[r+7|0],r=r+8|0,A=A+8|0),4&i&&(a[0|A]=b[0|r],a[A+1|0]=b[r+1|0],a[A+2|0]=b[r+2|0],a[A+3|0]=b[r+3|0],r=r+4|0,A=A+4|0),2&i&&(a[0|A]=b[0|r],a[A+1|0]=b[r+1|0],r=r+2|0,A=A+2|0),1&i&&(a[0|A]=b[0|r]);}}function X(A,r,e){var i=0,a=0,f=0,n=0,o=0,k=0;A:{if(i=t[e+16>>2],!i){if(I(e))break A;i=t[e+16>>2];}if(f=t[e+20>>2],i-f>>>0<r>>>0)return 0|yf[t[e+32>>2]](e,A,r);r:if(!(t[e+64>>2]<0)){for(a=A,i=0;;){if((0|r)==(0|i))break r;if(i=i+1|0,k=r+a|0,o=a+-1|0,a=o,10==b[k+-1|0])break;}if(n=1+(r-i|0)|0,a=0|yf[t[e+32>>2]](e,A,n),a>>>0<n>>>0)break A;A=1+(r+o|0)|0,f=t[e+20>>2],r=i+-1|0;}return J(f,A,r),A=e+20|0,t[A>>2]=t[A>>2]+r,r+n|0;}return a;}function M(A,r){var e,i,a=0;u(+A),a=0|o(1),e=0|o(0),i=a;A:{if(a=a>>>20&2047,2047!=(0|a)){if(!a){if(0==A)break A;return A=M(0x10000000000000000*A,r),t[r>>2]=t[r>>2]+-64,A;}t[r>>2]=a+-1022,k(0,0|e),k(1,-2146435073&i|1071644672),A=+c();}return A;}return t[r>>2]=0,A;}function x(A,r,e){var i=0,f=0,n=0,b=0;if(e&&(a[0|A]=r,i=A+e|0,a[i+-1|0]=r,!(e>>>0<3||(a[A+2|0]=r,a[A+1|0]=r,a[i+-3|0]=r,a[i+-2|0]=r,e>>>0<7||(a[A+3|0]=r,a[i+-4|0]=r,e>>>0<9||(i=0-A&3,f=i+A|0,r=_(255&r,16843009),t[f>>2]=r,e=e-i&-4,i=e+f|0,t[i+-4>>2]=r,e>>>0<9||(t[f+8>>2]=r,t[f+4>>2]=r,t[i+-8>>2]=r,t[i+-12>>2]=r,e>>>0<25||(t[f+24>>2]=r,t[f+20>>2]=r,t[f+16>>2]=r,t[f+12>>2]=r,t[i+-16>>2]=r,t[i+-20>>2]=r,t[i+-24>>2]=r,t[i+-28>>2]=r,b=4&f|24,e=e-b|0,e>>>0<32))))))))for(i=r,n=r,r=f+b|0;t[r>>2]=n,t[r+4>>2]=i,f=r+24|0,t[f>>2]=n,t[f+4>>2]=i,f=r+16|0,t[f>>2]=n,t[f+4>>2]=i,f=r+8|0,t[f>>2]=n,t[f+4>>2]=i,r=r+32|0,e=e+-32|0,e>>>0>31;){}return A;}function S(A,r){return A?function(A,r){if(A){if(r>>>0<=127)return a[0|A]=r,1;A:{r:{if(t[259]){if(r>>>0>2047)break r;return a[A+1|0]=63&r|128,a[0|A]=r>>>6|192,2;}if(57216!=(-128&r))break A;return a[0|A]=r,1;}if(!(57344==(-8192&r)|r>>>0<55296)){if(r+-65536>>>0>1048575)break A;return a[A+3|0]=63&r|128,a[0|A]=r>>>18|240,a[A+2|0]=r>>>6&63|128,a[A+1|0]=r>>>12&63|128,4;}return a[A+2|0]=63&r|128,a[0|A]=r>>>12|224,a[A+1|0]=r>>>6&63|128,3;}t[256]=25,A=-1;}else A=1;return A;}(A,r):0;}function T(A){var r=0,e=0,i=0;t[265]||(t[265]=1036);A:{r:{e:{for(;;){if((0|A)!=b[r+3232|0]){if(e=77,r=r+1|0,77!=(0|r))continue;break e;}break;}if(e=r,!r)break r;}for(r=3312;i=b[0|r],A=r+1|0,r=A,i||(r=A,e=e+-1|0,e);){}break A;}A=3312;}return A;}function U(A,r){var e=0,i=0;i=0!=(0|r);A:{r:{e:{i:{if(!(!r|!(3&A))){for(;;){if(!b[0|A])break i;if(i=1!=(0|r),e=r+-1|0,A=A+1|0,!(1!=(0|r)&&(r=e,3&A)))break;}if(i)break e;break r;}if(e=r,i)break e;break r;}e=r;}e:if(!(!b[0|A]|e>>>0<4))for(;;){if(r=t[A>>2],(-1^r)&r+-16843009&-2139062144)break e;if(A=A+4|0,e=e+-4|0,!(e>>>0>3))break;}if(e)for(;;){if(!b[0|A])break A;if(A=A+1|0,e=e+-1|0,!e)break;}}return 0;}return A;}function j(){var A=0;A=function(){var A=0,r=0,e=0;A:{r:{e:if(A=5376,3&A){if(!b[5376])break r;for(A=5377;;){if(!(3&A))break e;if(r=b[0|A],e=A+1|0,A=e,!r)break;}return e+-5377|0;}for(A=A+-4|0;A=A+4|0,r=t[A>>2],!((-1^r)&r+-16843009&-2139062144);){}if(!(255&r))break A;for(;r=b[A+1|0],e=A+1|0,A=e,r;){}return e-5376|0;}return 0;}return A-5376|0;}(),A=X(5376,A,2864);}function O(A,r,e){var i,a=0,f=0;if(i=E-208|0,E=i,t[i+204>>2]=e,e=i+192|0,t[e>>2]=0,t[e+4>>2]=0,e=i+184|0,t[e>>2]=0,t[e+4>>2]=0,e=i+176|0,t[e>>2]=0,t[e+4>>2]=0,t[i+168>>2]=0,t[i+172>>2]=0,t[i+160>>2]=0,t[i+164>>2]=0,t[i+200>>2]=t[i+204>>2],(0|H(0,r,i+200|0,i+80|0,i+160|0))>-1){a=t[A>>2];A:{r:{e:{i:{a:{if(t[A+60>>2]>0){if(!t[A+44>>2])break a;break i;}if(t[A>>2]=-33&a,t[A+44>>2])break i;}t[A+24>>2]=0,t[A+16>>2]=0,t[A+20>>2]=0,t[A+44>>2]=80,f=t[A+40>>2],t[A+40>>2]=i;break e;}if(t[A+16>>2])break r;}if(e=-1,I(A))break A;}e=H(A,r,i+200|0,i+80|0,i+160|0);}f&&(yf[t[A+32>>2]](A,0,0),t[A+44>>2]=0,t[A+40>>2]=f,t[A+24>>2]=0,t[A+16>>2]=0,t[A+20>>2]=0,e=0),t[A>>2]=t[A>>2]|32&a;}E=i+208|0;}function H(A,r,e,i,n){var k,c,l,s,d,v,C,B,R=0,G=0,h=0,y=0,Q=0,p=0,w=0,W=0,F=0,Z=0,Y=0,V=0,I=0,J=0,j=0,O=0,H=0,P=0,L=0,K=0,q=0,$=0,AA=0,rA=0,eA=0,iA=0,aA=0,fA=0,nA=0,tA=0,bA=0,oA=0,kA=0,cA=0,uA=0,lA=0,sA=0,dA=0,vA=0,CA=0,gA=0,_A=0;k=E-880|0,E=k,d=k+336|8,v=k+55|0,C=-338-k|0,s=k+336|9,B=k+656|0,l=k+336|0,c=k+56|0;A:{r:{for(;;){e:if(p=r,!((0|R)>(2147483647-L|0))){L=R+L|0;i:{a:{f:{n:{t:{b:{o:{k:{c:{u:{l:{s:{d:{v:{C:{g:{_:{B:{m:{R:{G:{h:{y:{Q:{p:{if(R=b[0|p],R){D:{w:{if(R)for(;;){if(37==(0|R))break w;if(R=b[r+1|0],r=r+1|0,!R)break;}G=r;break D;}for(G=r,R=G;;){if(37==b[R+1|0]){if(G=G+1|0,h=b[R+2|0],r=R+2|0,R=r,37==(0|h))continue;break D;}break;}r=R;}if(R=G-p|0,O=2147483647-L|0,(0|R)>(0|O))break e;if(!A|32&b[0|A]||X(p,R,A),R)continue;R=r+1|0,y=a[r+1|0],G=y+-48|0,G>>>0<=9?(h=36==b[r+2|0],R=h?r+3|0:R,eA=h?1:eA,y=a[(h?3:1)+r|0],I=h?G:-1):I=-1,Q=0,r=y+-32|0;D:if(!(r>>>0>31)&&(r=1<<r,75913&r))for(h=R+1|0;;){if(Q|=r,R=h,y=a[0|R],r=y+-32|0,r>>>0>=32)break D;if(h=R+1|0,r=1<<r,!(75913&r))break;}D:{w:{W:{F:{Z:{if(42==(0|y)){if(r=a[R+1|0]+-48|0,36!=b[R+2|0]|r>>>0>9)break Z;if(t[(r<<2)+n>>2]=10,w=R+3|0,eA=1,F=t[((a[R+1|0]<<3)+i|0)-384>>2],(0|F)>-1)break D;break F;}if(F=0,h=y+-48|0,h>>>0>9)break W;for(r=0;F=-1,G=a[R+1|0],w=R+1|0,R=w,r>>>0<=214748364&&(r=_(r,10),F=(0|h)>(2147483647-r|0)?-1:r+h|0),r=F,h=G+-48|0,h>>>0<10;){}if((0|F)>=0)break D;break e;}if(eA)break v;if(w=R+1|0,!A)break w;if(r=t[e>>2],t[e>>2]=r+4,eA=0,F=t[r>>2],(0|F)>-1)break D;}F=0-F|0,Q|=8192;break D;}w=R;break D;}eA=0,F=0;}R=0,y=-1;D:{w:{W:{F:{Z:{Y:{if(46==b[0|w]){if(G=a[w+1|0],42!=(0|G))break Y;if(r=a[w+2|0]+-48|0,36!=b[w+3|0]|r>>>0>9)break Z;t[(r<<2)+n>>2]=10,r=w+4|0,y=t[((a[w+2|0]<<3)+i|0)-384>>2];break w;}r=w,W=0;break D;}if(r=w+1|0,Y=G+-48|0,Y>>>0>9)break F;for(w=0,h=r;y=-1,w>>>0<=214748364&&(r=_(w,10),y=(0|Y)>(2147483647-r|0)?-1:r+Y|0),W=1,G=a[h+1|0],r=h+1|0,h=r,w=y,Y=G+-48|0,Y>>>0<10;){}break D;}if(eA)break v;if(r=w+2|0,!A)break W;G=t[e>>2],t[e>>2]=G+4,y=t[G>>2];break w;}W=1,y=0;break D;}y=0;}W=(-1^y)>>>31;}for(;;){if(h=R,G=a[0|r]+-65|0,G>>>0>57)break v;if(r=r+1|0,R=b[4912+(G+_(h,58)|0)|0],!(R+-1>>>0<8))break;}if(!R)break v;D:{w:{W:{if(27==(0|R)){if((0|I)<=-1)break W;break v;}if((0|I)<0)break w;t[(I<<2)+n>>2]=R,R=(I<<3)+i|0,G=t[R+4>>2],t[k+56>>2]=t[R>>2],t[k+60>>2]=G;}if(R=0,!A)continue;break D;}if(!A)break p;z(k+56|0,R,e);}G=-65537&Q,w=8192&Q?G:Q;D:{w:{W:{F:{Z:{Y:{E:{N:{V:{I:{J:{X:{M:{x:{S:{T:{U:{j:{O:{H:{z:{P:{L:{K:{q:{$:{AA:{rA:{eA:{iA:{aA:{fA:{nA:{tA:{bA:if(R=a[r+-1|0],Y=h&&3==(15&R)?-33&R:R,R=Y+-65|0,!(R>>>0>55)){switch(R-1|0){default:if(W&&(0|y)<=-1)break e;V=g[k+56>>3],t[k+364>>2]=0;oA:{kA:{if(u(+V),G=0|o(1),sA=1,CA=o(0)>>>0>4294967295?0:1,gA=0,_A=(0|G)<=-1,dA=_A?CA:gA,vA=(0|G)<-1,!(vA?sA:dA)){if(2048&w)break kA;H=1&w,iA=H?5542:5537;break oA;}V=-V,H=1,iA=5536;break oA;}H=1,iA=5539;}oA:{if(P=m(V),P!=D&P==P){if(P=M(V,k+364|0),V=P+P,0!=V&&(t[k+364>>2]=t[k+364>>2]+-1),tA=32|Y,97!=(0|tA))break oA;if(Q=32&Y,O=Q?iA+9|0:iA,!(12-y)|y>>>0>11)break M;for(R=y+-12|0,P=16;P*=16,R=R+1|0,R;){}if(45!=b[0|O])break x;V=-(P+(-V-P));break M;}if(y=H+3|0,8192&w|(0|F)<=(0|y))break T;if(Q=F-y|0,R=Q>>>0<256,x(k- -64|0,32,R?Q:256),h=t[A>>2],G=32&h,R)break j;for(R=!G,G=Q;1&R&&(X(k- -64|0,256,A),h=t[A>>2]),p=32&h,R=!p,G=G+-256|0,G>>>0>255;){}if(p)break T;Q&=255;break U;}if(G=(0|y)<0,0==V)break P;Z=t[k+364>>2]+-28|0,t[k+364>>2]=Z,V*=268435456;break z;case 51:break L;case 49:break q;case 22:case 54:break $;case 46:break AA;case 45:break rA;case 44:break eA;case 43:break iA;case 33:break aA;case 17:break nA;case 1:break tA;case 0:case 2:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 18:case 19:case 20:case 21:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 32:case 38:case 40:case 41:case 42:case 47:case 48:case 50:case 52:case 53:break bA;case 34:case 39:}if(G=t[k+60>>2],R=G,Q=t[k+56>>2],(0|R)<-1||(0|R)<=-1&&!(Q>>>0>4294967295))break H;if(2048&w)break S;if(Z=1&w,H=Z?4888:4886,1==(0|R)&Q>>>0>=0|R>>>0>1)break o;break k;}Z=0,H=4886;break a;}t[k+12>>2]=0,t[k+8>>2]=t[k+56>>2],t[k+56>>2]=k+8,y=-1,p=k+8|0;break fA;}if(p=t[k+56>>2],!y)break I;}for(R=0,G=p;;){if(h=t[G>>2],!h)break J;if(Q=S(k+4|0,h),h=(0|Q)<0,h|Q>>>0>y-R>>>0)break X;if(G=G+4|0,R=R+Q|0,!(y>>>0>R>>>0))break;}break J;}a[k+55|0]=t[k+56>>2],Z=0,H=4886,y=1,p=v,R=c,w=G;break i;}p=T(t[256]);break K;}if(R=0,G=255&h,G>>>0>7)continue;switch(G-1|0){case 4:continue;case 6:break D;case 5:break w;case 3:break W;case 2:break F;case 1:break Z;case 0:break Y;}t[t[k+56>>2]>>2]=L;continue;}if(p=c,G=t[k+60>>2],R=G,Q=t[k+56>>2],R|Q)for(;p=p+-1|0,a[0|p]=7&Q|48,Q=(7&R)<<29|Q>>>3,R>>>=3,Q|R;){}if(Z=0,H=4886,!(8&w))break t;if(G=c-p|0,y=(0|y)>(0|G)?y:G+1|0,W)break n;break f;}y=y>>>0>8?y:8,w|=8,Y=120;}if(Z=0,H=4886,G=t[k+60>>2],R=G,Q=t[k+56>>2],R|Q){for(G=32&Y,p=c;p=p+-1|0,a[0|p]=G|b[5520+(15&Q)|0],Q=(15&R)<<28|Q>>>4,R>>>=4,Q|R;){}if(!(8&w)|!(t[k+56>>2]|t[k+60>>2]))break t;if(H=4886+(Y>>4)|0,Z=2,W)break n;break f;}if(p=c,W)break n;break f;}R=t[k+56>>2],p=R||4896;}if(Z=0,h=(0|y)<0?2147483647:y,R=U(p,h),h=R?R-p|0:h,R=h+p|0,H=4886,(0|y)<=-1)break O;w=G,y=h;break i;}if(Z=0,H=4886,G=t[k+60>>2],R=G,Q=t[k+56>>2],1==(0|R)&Q>>>0<0|R>>>0<1)break k;break o;}Z=t[k+364>>2];}for(W=G?6:y,I=(0|Z)<0?k+368|0:B,G=I;R=V<4294967296&V>=0?~~V>>>0:0,t[G>>2]=R,G=G+4|0,V=1e9*(V-+(R>>>0)),0!=V;){}if((0|Z)>=1){h=I,$=0;break d;}J=G,h=I,R=0;break s;}if(R=0-((0<Q>>>0)+R|0)|0,Q=0-Q|0,t[k+56>>2]=Q,t[k+60>>2]=R,Z=1,H=4886,1==(0|R)&Q>>>0>=0|R>>>0>1)break o;break k;}if(w=G,y=h,!b[0|R])break i;break e;}if(G)break T;}X(k- -64|0,Q,A);}G=t[A>>2],32&G||(X(iA,H,A),G=t[A>>2]),32&G||(G=(32&Y)>>>5,X(V!=V?G?5563:5567:G?5555:5559,3,A));T:if(!(8192!=(73728&w)|(0|F)<=(0|y))){if(Q=F-y|0,R=Q>>>0<256,x(k- -64|0,32,R?Q:256),h=t[A>>2],G=32&h,R){if(G)break T;}else {for(R=!G,G=Q;1&R&&(X(k- -64|0,256,A),h=t[A>>2]),p=32&h,R=!p,G=G+-256|0,G>>>0>255;){}if(p)break T;Q&=255;}X(k- -64|0,Q,A);}R=(0|F)>(0|y)?F:y;break l;}if(Z=1,H=4887,1==(0|R)&Q>>>0<0|R>>>0<1)break k;break o;}V=V+P-P;}h=l,I=t[k+364>>2],G=I>>31,R=G^G+I;M:{if(R){for(G=0;h=(R>>>0)/10|0,a[335+(G+k|0)|0]=R-_(h,10)|48,G=G+-1|0,p=R>>>0>9,R=h,p;){}if(h=336+(G+k|0)|0,G)break M;}h=h+-1|0,a[0|h]=48;}for(j=2|H,Z=h+-2|0,a[0|Z]=Y+15,a[h+-1|0]=(0|I)<0?45:43,p=8&w,G=k+336|0;R=G,h=m(V)<2147483648?~~V:-2147483648,a[0|R]=Q|b[h+5520|0],G=R+1|0,V=16*(V-+(0|h)),(0|y)>0|p|0!=V&&1==(G-(k+336|0)|0)&&(a[R+1|0]=46,G=R+2|0),0!=V;){}if(R=-1,W=l-Z|0,((2147483645-j|0)-W|0)<(0|y))break l;if(I=73728&w,Y=G-(k+336|0)|0,Q=y&&(G+C|0)<(0|y)?y+2|0:Y,y=Q+(W+j|0)|0,I|(0|F)<=(0|y))break E;if(w=F-y|0,R=w>>>0<256,x(k- -64|0,32,R?w:256),h=t[A>>2],G=32&h,R)break V;for(R=!G,G=w;1&R&&(X(k- -64|0,256,A),h=t[A>>2]),p=32&h,R=!p,G=G+-256|0,G>>>0>255;){}if(p)break E;w&=255;break N;}if(h)break r;}if((0|R)<0)break e;if(w&=73728,w)break c;break u;}if(R=0,w&=73728,!w)break u;break c;}if(G)break E;}X(k- -64|0,w,A);}32&b[0|A]||X(O,j,A);E:if(!(65536!=(0|I)|(0|F)<=(0|y))){if(w=F-y|0,R=w>>>0<256,x(k- -64|0,48,R?w:256),h=t[A>>2],G=32&h,R){if(G)break E;}else {for(R=!G,G=w;1&R&&(X(k- -64|0,256,A),h=t[A>>2]),p=32&h,R=!p,G=G+-256|0,G>>>0>255;){}if(p)break E;w&=255;}X(k- -64|0,w,A);}32&b[0|A]||X(k+336|0,Y,A),w=Q-Y|0;E:if(!((0|w)<1)){if(G=w>>>0<256,x(k- -64|0,48,G?w:256),h=t[A>>2],R=32&h,G){if(R)break E;}else {for(R=!R,G=w;1&R&&(X(k- -64|0,256,A),h=t[A>>2]),p=32&h,R=!p,G=G+-256|0,G>>>0>255;){}if(p)break E;w&=255;}X(k- -64|0,w,A);}32&b[0|A]||X(Z,W,A);E:if(!(8192!=(0|I)|(0|F)<=(0|y))){if(Q=F-y|0,R=Q>>>0<256,x(k- -64|0,32,R?Q:256),h=t[A>>2],G=32&h,R){if(G)break E;}else {for(R=!G,G=Q;1&R&&(X(k- -64|0,256,A),h=t[A>>2]),p=32&h,R=!p,G=G+-256|0,G>>>0>255;){}if(p)break E;Q&=255;}X(k- -64|0,Q,A);}R=(0|F)>(0|y)?F:y;break l;}t[t[k+56>>2]>>2]=L;continue;}G=t[k+56>>2],t[G>>2]=L,t[G+4>>2]=L>>31;continue;}f[t[k+56>>2]>>1]=L;continue;}a[t[k+56>>2]]=L;continue;}t[t[k+56>>2]>>2]=L;continue;}G=t[k+56>>2],t[G>>2]=L,t[G+4>>2]=L>>31;continue;}if(A)break A;if(eA){if(A=t[n+4>>2],R=1,!A)break g;if(z(i+8|0,A,e),A=t[n+8>>2],!A)break Q;if(z(i+16|0,A,e),A=t[n+12>>2],!A)break y;if(z(i+24|0,A,e),A=t[n+16>>2],!A)break h;if(z(i+32|0,A,e),A=t[n+20>>2],!A)break G;if(z(i+40|0,A,e),A=t[n+24>>2],!A)break R;if(z(i+48|0,A,e),A=t[n+28>>2],!A)break m;if(z(i+56|0,A,e),A=t[n+32>>2],!A)break B;if(z(i- -64|0,A,e),A=t[n+36>>2],!A)break _;z(i+72|0,A,e);break C;}}L=0;break A;}R=2;break g;}R=3;break g;}R=4;break g;}R=5;break g;}R=6;break g;}R=7;break g;}R=8;break g;}R=9;}for(r=(R<<2)+n|0;;){if(t[r>>2])break v;if(r=r+4|0,R=R+1|0,!(R>>>0<=9))break;}}L=1;break A;}t[256]=28;break r;}R=1;}for(;;){s:{d:{v:{C:{g:{_:{B:{m:{R:{G:{h:{y:{Q:{p:{D:{w:{W:{F:{Z:{Y:{E:{N:{V:{I:{J:{X:{M:{x:{S:{if(!R){if((0|Z)>-1)break S;cA=1+((W+25>>>0)/9|0)|0,$=1;break m;}T:switch(0|$){case 0:if(Z=(0|Z)<29?Z:29,R=G+-4|0,!(R>>>0<h>>>0)){for(y=Z,Q=0;p=R,J=t[R>>2],j=31&y,32<=(63&y)>>>0?(O=J<<j,J=0):(O=(1<<j)-1&J>>>32-j,J<<=j),J=J+Q|0,Q=Gf(J,J>>>0<Q>>>0?O+1|0:O,1e9),sA=p,dA=J-Rf(Q,N,1e9,0)|0,t[sA>>2]=dA,R=R+-4|0,R>>>0>=h>>>0;){}Q&&(h=h+-4|0,t[h>>2]=Q);}for(;J=G,!(G>>>0<=h>>>0||(G=J+-4|0,t[G>>2]));){}if(Z=t[k+364>>2]-Z|0,t[k+364>>2]=Z,G=J,(0|Z)>0)break D;break G;case 3:break M;case 2:break x;case 1:break T;default:break I;}R=0-Z|0,O=(0|R)<9?R:9;T:if(h>>>0<J>>>0){for(Z=1e9>>>O,y=-1<<O^-1,p=0,R=h;Q=t[R>>2],t[R>>2]=p+(Q>>>O),p=_(Z,y&Q),R=R+4|0,R>>>0<J>>>0;){}if(h=t[h>>2]?h:h+4|0,!p)break T;t[J>>2]=p,J=J+4|0;}else h=t[h>>2]?h:h+4|0;if(Z=O+t[k+364>>2]|0,t[k+364>>2]=Z,R=102==(0|tA)?I:h,J=J-R>>2>(0|cA)?R+(cA<<2)|0:J,(0|Z)<0)break p;}if(p=0,!(h>>>0>=J>>>0||(p=_(I-h>>2,9),Q=t[h>>2],Q>>>0<10)))for(R=10;p=p+1|0,R=_(R,10),Q>>>0>=R>>>0;){}if(q=102==(0|tA)?0:p,fA=103==(0|tA),j=fA&0!=(0|W),R=(W-q|0)-j|0,(0|R)<(_(J-I>>2,9)+-9|0)){if(K=R+9216|0,y=(0|K)/9|0,O=I+(y<<2)|0,Q=O+-4092|0,R=10,y=_(y,9),(1+(K-y|0)|0)<=8)for(y=((y+q|0)-9208|0)-W-(0-j)|0;R=_(R,10),y=y+-1|0,y;){}if(j=t[Q>>2],y=(j>>>0)/(R>>>0)|0,K=Q+4|0,q=j-_(R,y)|0,(q||(0|J)!=(0|K))&&(!(1&y)&&(V=9007199254740992,!(1&a[Q+-4|0])|1e9!=(0|R)|Q>>>0<=h>>>0)||(V=9007199254740994),P=.5,y=R>>>1,q>>>0>=y>>>0&&(P=(0|J)==(0|K)&&(0|y)==(0|q)?1:1.5),!H|45!=b[0|iA]||(V=-V,P=-P),y=j-q|0,t[Q>>2]=y,V+P!=V)){if(R=R+y|0,t[Q>>2]=R,R>>>0>=1e9){for(R=O+-4096|0;t[R+4>>2]=0,R>>>0<h>>>0&&(h=h+-4|0,t[h>>2]=0),p=t[R>>2]+1|0,t[R>>2]=p,R=R+-4|0,p>>>0>999999999;){}Q=R+4|0;}if(p=_(I-h>>2,9),y=t[h>>2],!(y>>>0<10))for(R=10;p=p+1|0,R=_(R,10),y>>>0>=R>>>0;){}}R=Q+4|0,J=J>>>0>R>>>0?R:J;}S:{T:{for(;;){if(K=J,J>>>0<=h>>>0)break T;if(J=K+-4|0,t[J>>2])break;}O=1;break S;}O=0;}if(fA){if(Q=W||1,R=(0|Q)>(0|p)&(0|p)>-5,W=(R?-1^p:-1)+Q|0,Y=(R?-1:-2)+Y|0,aA=8&w,!aA){if(R=9,O&&(Q=t[K+-4>>2],Q&&(R=0,!((Q>>>0)%10))))for(y=10;R=R+1|0,y=_(y,10),!((Q>>>0)%(y>>>0));){}Q=_(K-I>>2,9)+-9|0,102!=(32|Y)?(aA=0,R=(p+Q|0)-R|0,R=(0|R)>0?R:0,W=(0|W)<(0|R)?W:R):(aA=0,R=Q-R|0,R=(0|R)>0?R:0,W=(0|W)<(0|R)?W:R);}}else aA=8&w;if(R=-1,q=W|aA,(0|W)>(0|(q?2147483645:2147483646)))break l;if(kA=1+((0!=(0|q))+W|0)|0,fA=102!=(32|Y),fA){if(y=l,R=p>>31,R^=R+p,R)for(;y=y+-1|0,Q=(R>>>0)/10|0,a[0|y]=R-_(Q,10)|48,j=R>>>0>9,R=Q,j;){}if((l-y|0)<=1){for(R=y+-1|0;a[0|R]=48,y=l-R|0,Q=R+-1|0,R=Q,(0|y)<2;){}y=Q+1|0;}if(bA=y+-2|0,a[0|bA]=Y,R=-1,a[y+-1|0]=(0|p)<0?45:43,p=l-bA|0,(0|p)>(2147483647-kA|0))break l;}else {if((0|p)>(2147483647-kA|0))break l;p=(0|p)>0?p:0;}if(p=p+kA|0,(0|p)>(2147483647^H))break l;oA=73728&w,rA=p+H|0;S:if(!(oA|(0|F)<=(0|rA))){if(Q=F-rA|0,p=Q>>>0<256,x(k- -64|0,32,p?Q:256),y=t[A>>2],R=32&y,p){if(R)break S;}else {for(R=!R,p=Q;1&R&&(X(k- -64|0,256,A),y=t[A>>2]),j=32&y,R=!j,p=p+-256|0,p>>>0>255;){}if(j)break S;Q&=255;}X(k- -64|0,Q,A);}32&b[0|A]||X(iA,H,A);S:if(!(65536!=(0|oA)|(0|F)<=(0|rA))){if(Q=F-rA|0,p=Q>>>0<256,x(k- -64|0,48,p?Q:256),y=t[A>>2],R=32&y,p){if(R)break S;}else {for(R=!R,p=Q;1&R&&(X(k- -64|0,256,A),y=t[A>>2]),j=32&y,R=!j,p=p+-256|0,p>>>0>255;){}if(j)break S;Q&=255;}X(k- -64|0,Q,A);}if(fA)break J;uA=h>>>0>I>>>0?I:h,AA=uA,$=2;break _;}if(R=t[AA>>2],R)for(p=0;Q=(R>>>0)/10|0,a[p+d|0]=R-_(Q,10)|48,p=p+-1|0,y=R>>>0>9,R=Q,y;){}else p=0;R=p+s|0;x:if((0|AA)==(0|uA))p||(R=R+-1|0,a[0|R]=48);else {if(R>>>0<=k+336>>>0)break x;for(;R=R+-1|0,a[0|R]=48,R>>>0>k+336>>>0;){}}if(32&b[0|A]||X(R,s-R|0,A),AA=AA+4|0,AA>>>0<=I>>>0)break Q;if(!q|32&b[0|A]||X(5571,1,A),(0|W)<1|AA>>>0>=K>>>0)break X;$=3;break v;}R=s,p=t[AA>>2];M:{if(p){for(;R=R+-1|0,Q=(p>>>0)/10|0,a[0|R]=p-_(Q,10)|48,y=p>>>0>9,p=Q,y;){}if(R>>>0<=k+336>>>0)break M;}for(;R=R+-1|0,a[0|R]=48,R>>>0>k+336>>>0;){}}if(32&b[0|A]||X(R,(0|W)<9?W:9,A),W=W+-9|0,!((0|W)<1)&&(AA=AA+4|0,AA>>>0<K>>>0))break y;}if((0|W)<1)break F;if(G=W>>>0<256,x(k- -64|0,48,G?W:256),h=t[A>>2],R=32&h,G)break V;for(R=!R,G=W;1&R&&(X(k- -64|0,256,A),h=t[A>>2]),p=32&h,R=!p,G=G+-256|0,G>>>0>255;){}if(p)break F;W&=255;break N;}if((0|W)<=-1)break Z;lA=O?K:h+4|0,nA=h,$=4;break d;}y=s,R=t[nA>>2];I:{if(R){for(p=0;Q=(R>>>0)/10|0,a[344+(k+p|0)|0]=R-_(Q,10)|48,p=p+-1|0,y=R>>>0>9,R=Q,y;){}if(y=345+(k+p|0)|0,p)break I;}y=y+-1|0,a[0|y]=48;}I:if((0|h)==(0|nA))32&b[0|A]||X(y,1,A),y=y+1|0,32&b[0|A]|((0|W)<1?!aA:0)||X(5571,1,A);else {if(y>>>0<=k+336>>>0)break I;for(;y=y+-1|0,a[0|y]=48,y>>>0>k+336>>>0;){}}if(R=s-y|0,32&b[0|A]||X(y,(0|W)>(0|R)?R:W,A),nA=nA+4|0,W=W-R|0,(0|W)>-1&&nA>>>0<lA>>>0)break h;if((0|W)<1)break Z;if(G=W>>>0<256,x(k- -64|0,48,G?W:256),h=t[A>>2],R=32&h,G)break E;for(R=!R,G=W;1&R&&(X(k- -64|0,256,A),h=t[A>>2]),p=32&h,R=!p,G=G+-256|0,G>>>0>255;){}if(p)break Z;W&=255;break Y;}if(R)break F;}if(X(k- -64|0,W,A),8192==(0|oA))break W;break w;}if(R)break Z;}X(k- -64|0,W,A);}32&b[0|A]||X(bA,l-bA|0,A);}if(8192!=(0|oA))break w;}if(!((0|F)<=(0|rA))){if(y=F-rA|0,R=y>>>0<256,x(k- -64|0,32,R?y:256),h=t[A>>2],G=32&h,R){if(G)break w;}else {for(R=!G,G=y;1&R&&(X(k- -64|0,256,A),h=t[A>>2]),p=32&h,R=!p,G=G+-256|0,G>>>0>255;){}if(p)break w;y&=255;}X(k- -64|0,y,A);}}R=(0|F)>(0|rA)?F:rA;break l;}$=0;break R;}$=1;break B;}$=2;break g;}$=3;break C;}$=4;break s;}R=0;continue;}R=1;continue;}R=1;continue;}R=1;continue;}R=1;continue;}R=1;continue;}R=1;continue;}R=1;continue;}R=1;continue;}R=1;}}if((0|R)>=0)continue;break e;}if(!((0|F)<=(0|R))){if(Y=F-R|0,h=Y>>>0<256,x(k- -64|0,32,h?Y:256),y=t[A>>2],G=32&y,h){if(G)break c;}else {for(G=!G,h=Y;1&G&&(X(k- -64|0,256,A),y=t[A>>2]),Q=32&y,G=!Q,h=h+-256|0,h>>>0>255;){}if(Q)break c;Y&=255;}X(k- -64|0,Y,A);}}c:if(R)for(G=0;;){if(h=t[p>>2],!h)break c;if(h=S(k+4|0,h),G=h+G|0,G>>>0>R>>>0)break c;if(32&b[0|A]||X(k+4|0,h,A),p=p+4|0,!(G>>>0<R>>>0))break;}c:if(!(8192!=(0|w)|(0|F)<=(0|R))){if(Q=F-R|0,h=Q>>>0<256,x(k- -64|0,32,h?Q:256),p=t[A>>2],G=32&p,h){if(G)break c;}else {for(G=!G,h=Q;1&G&&(X(k- -64|0,256,A),p=t[A>>2]),w=32&p,G=!w,h=h+-256|0,h>>>0>255;){}if(w)break c;Q&=255;}X(k- -64|0,Q,A);}R=(0|F)>(0|R)?F:R;continue;}G=Q,p=c;break b;}for(p=c;G=Gf(Q,R,10),I=N,h=I,p=p+-1|0,sA=p,dA=Q-Rf(G,h,10,0)|48,a[0|sA]=dA,I=9==(0|R)&Q>>>0>4294967295|R>>>0>9,Q=G,R=h,I;){}}if(R=G,R)for(;p=p+-1|0,G=(R>>>0)/10|0,a[0|p]=R-_(G,10)|48,h=R>>>0>9,R=G,h;){}}if(!W)break f;}if((0|y)<0)break e;}if(w=W?-65537&w:w,R=t[k+56>>2],G=t[k+60>>2],!(!!(R|G)|y)){p=c,R=p,y=0;break i;}G=!(R|G)+(c-p|0)|0,y=(0|y)>(0|G)?y:G;}R=c;}if(Y=R-p|0,W=(0|y)<(0|Y)?Y:y,!((0|W)>(2147483647-Z|0)||(j=W+Z|0,R=(0|F)<(0|j)?j:F,(0|R)>(0|O)))){I=73728&w;i:if(!(I|(0|j)>=(0|F))){if(O=R-j|0,h=O>>>0<256,x(k- -64|0,32,h?O:256),Q=t[A>>2],G=32&Q,h){if(G)break i;}else {for(G=!G,h=O;1&G&&(X(k- -64|0,256,A),Q=t[A>>2]),w=32&Q,G=!w,h=h+-256|0,h>>>0>255;){}if(w)break i;O&=255;}X(k- -64|0,O,A);}32&b[0|A]||X(H,Z,A);i:if(!(65536!=(0|I)|(0|j)>=(0|F))){if(Z=R-j|0,h=Z>>>0<256,x(k- -64|0,48,h?Z:256),Q=t[A>>2],G=32&Q,h){if(G)break i;}else {for(G=!G,h=Z;1&G&&(X(k- -64|0,256,A),Q=t[A>>2]),w=32&Q,G=!w,h=h+-256|0,h>>>0>255;){}if(w)break i;Z&=255;}X(k- -64|0,Z,A);}i:if(!((0|Y)>=(0|y))){if(w=W-Y|0,h=w>>>0<256,x(k- -64|0,48,h?w:256),y=t[A>>2],G=32&y,h){if(G)break i;}else {for(G=!G,h=w;1&G&&(X(k- -64|0,256,A),y=t[A>>2]),Q=32&y,G=!Q,h=h+-256|0,h>>>0>255;){}if(Q)break i;w&=255;}X(k- -64|0,w,A);}if(32&b[0|A]||X(p,Y,A),8192!=(0|I)|(0|j)>=(0|F))continue;y=R-j|0,h=y>>>0<256,x(k- -64|0,32,h?y:256),p=t[A>>2],G=32&p;i:{if(h){if(!G)break i;continue;}for(G=!G,h=y;1&G&&(X(k- -64|0,256,A),p=t[A>>2]),w=32&p,G=!w,h=h+-256|0,h>>>0>255;){}if(w)continue;y&=255;}X(k- -64|0,y,A);continue;}}break;}t[256]=61;}L=-1;}return E=k+880|0,L;}function z(A,r,e){A:{r:{e:{i:{a:{f:{n:{t:{b:{o:{if(r=r+-9|0,r>>>0<=17){switch(r-1|0){case 2:case 9:case 11:case 12:case 15:break a;case 0:case 3:case 13:break i;case 1:case 4:case 10:case 14:break e;case 16:break f;case 8:break o;case 7:break n;case 5:break t;case 6:break b;}r=t[e>>2],t[e>>2]=r+4,t[A>>2]=t[r>>2];}return;}r=t[e>>2],t[e>>2]=r+4,t[A>>2]=b[0|r];break A;}r=t[e>>2],t[e>>2]=r+4,t[A>>2]=d[r>>1];break A;}r=t[e>>2],t[e>>2]=r+4,r=f[r>>1],t[A>>2]=r;break r;}r=t[e>>2],t[e>>2]=r+4,r=a[0|r],t[A>>2]=r;break r;}j(),p();}return r=t[e>>2]+7&-8,t[e>>2]=r+8,e=t[r+4>>2],t[A>>2]=t[r>>2],void(t[A+4>>2]=e);}r=t[e>>2],t[e>>2]=r+4,r=t[r>>2],t[A>>2]=r;break r;}r=t[e>>2],t[e>>2]=r+4,t[A>>2]=t[r>>2];break A;}return void(t[A+4>>2]=r>>31);}t[A+4>>2]=0;}function P(A){var r;r=E-16|0,E=r,t[r+12>>2]=A,t[r+8>>2]=0,O(t[804],t[r+12>>2],t[r+8>>2]),function(A){var r;r=E-16|0,E=r,t[r+12>>2]=0,O(A,5573,0),E=r+16|0;}(t[804]),p();}function L(r){if(!(65535&r|(0|r)<=-1))return r=function(r){r|=0;var n=0|function(){return e.byteLength/65536|0;}(),o=n+r|0;if(n<o&&o<65536){var k=new ArrayBuffer(_(o,65536)),c=new A.Int8Array(k);c.set(a),a=c,a=new A.Int8Array(k),f=new A.Int16Array(k),t=new A.Int32Array(k),b=new A.Uint8Array(k),d=new A.Uint16Array(k),v=new A.Uint32Array(k),C=new A.Float32Array(k),g=new A.Float64Array(k),e=k,i.buffer=k;}return n;}(r>>>16),-1!=(0|r)?r<<16:(t[256]=48,-1);p();}function K(A){var r,e=0,i=0,a=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,C=0;r=E-16|0,E=r;A:{r:{e:{i:{a:{f:{n:{t:{b:{o:{k:{c:{u:{l:{s:{d:{v:{C:{g:{_:{B:{m:{R:{G:{h:{y:{Q:{p:{D:{w:{W:{F:{Z:{Y:{E:{N:{V:{if(A>>>0<=244){if(f=t[266],n=A>>>0<11?16:A+11&-8,A=n>>>3,e=f>>>A,!(3&e))break V;if(i=A+(1&(-1^e))|0,n=i<<3,e=t[n+1112>>2],A=e+8|0,a=t[e+8>>2],n=n+1104|0,(0|a)==(0|n))break N;t[a+12>>2]=n,t[n+8>>2]=a;break E;}if(n=-1,A>>>0>4294967231)break R;if(A=A+11|0,n=-8&A,u=t[267],!u)break R;if(o=0-n|0,A>>>=8,k=0,A&&(k=31,n>>>0>16777215||(e=A+1048320>>>16&8,i=A<<e,A=i+520192>>>16&4,a=A|e,A=i<<A,e=A+245760>>>16&2,A=(14-(a|e)|0)+(A<<e>>>15)|0,k=n>>>A+7&1|A<<1)),e=t[1368+(k<<2)>>2],!e)break Y;for(a=n<<(31==(0|k)?0:25-(k>>>1)|0),A=0,i=0;;){if(f=(-8&t[e+4>>2])-n|0,f>>>0<o>>>0&&(i=e,o=f,!f))break W;if(f=t[e+20>>2],e=t[16+((a>>>29&4)+e|0)>>2],A=f?(0|f)==(0|e)?A:f:A,a<<=0!=(0|e),!e)break;}if(!(A|i))break Z;break y;}if(u=t[268],n>>>0<=u>>>0)break R;if(!e)break F;if(e<<=A,A=2<<A,A=e&(0-A|A),A=(0-A&A)-1|0,e=A>>>12&16,i=e,A>>>=e,e=A>>>5&8,i|=e,A>>>=e,e=A>>>2&4,i|=e,A>>>=e,e=A>>>1&2,i|=e,A>>>=e,e=A>>>1&1,i=(i|e)+(A>>>e)|0,a=i<<3,e=t[a+1112>>2],A=t[e+8>>2],a=a+1104|0,(0|A)==(0|a))break w;t[A+12>>2]=a,t[a+8>>2]=A;break D;}d=1064,C=hf(i)&f,t[d>>2]=C;}i<<=3,t[e+4>>2]=3|i,e=e+i|0,t[e+4>>2]=1|t[e+4>>2];break A;}i=0;}if(A=2<<k,A=(0-A|A)&u,!A)break R;if(A=(A&0-A)-1|0,e=A>>>12&16,a=e,A>>>=e,e=A>>>5&8,a|=e,A>>>=e,e=A>>>2&4,a|=e,A>>>=e,e=A>>>1&2,a|=e,A>>>=e,e=A>>>1&1,A=t[1368+((a|e)+(A>>>e)<<2)>>2],A)break h;break G;}if(l=t[267],!l)break R;if(A=(l&0-l)-1|0,e=A>>>12&16,i=e,A>>>=e,e=A>>>5&8,i|=e,A>>>=e,e=A>>>2&4,i|=e,A>>>=e,e=A>>>1&2,i|=e,A>>>=e,e=A>>>1&1,a=t[1368+((i|e)+(A>>>e)<<2)>>2],o=(-8&t[a+4>>2])-n|0,i=a,A=t[i+16>>2],!A)break p;e=1;break Q;}o=0,A=e;break h;}f=hf(i)&f,t[266]=f;}A=e+8|0,t[e+4>>2]=3|n,i<<=3,o=i-n|0,t[e+i>>2]=o,n=e+n|0,t[n+4>>2]=1|o,u&&(i=u>>>3,e=1104+(i<<3)|0,a=t[271],i=1<<i,k=t[e+8>>2],i&f||(t[266]=i|f,k=e),i=k,t[i+12>>2]=a,t[e+8>>2]=a,t[a+12>>2]=e,t[a+8>>2]=i),t[271]=n,t[268]=o;break A;}e=0;}Q:{for(;;){p:{D:{w:{if(e){if(i=(-8&t[A+4>>2])-n|0,e=i>>>0<o>>>0,o=e?i:o,a=e?A:a,i=A,A=t[A+16>>2],A)break w;e=0;continue;}if(A=t[i+20>>2],A)break D;if(s=a+n|0,s>>>0<=a>>>0)break R;if(c=t[a+24>>2],i=t[a+12>>2],(0|a)!=(0|i)){if(A=t[a+8>>2],t[A+12>>2]=i,t[i+8>>2]=A,c)break p;break Q;}W:{if(e=a+20|0,A=t[e>>2],!A){if(A=t[a+16>>2],!A)break W;e=a+16|0;}for(;k=e,i=A,e=A+20|0,A=t[e>>2],A||(e=i+16|0,A=t[i+16>>2],A);){}if(t[k>>2]=0,!c)break Q;break p;}if(i=0,c)break p;break Q;}e=1;continue;}e=1;continue;}break;}p:{A=t[a+28>>2],e=1368+(A<<2)|0;D:{if((0|a)!=t[e>>2]){if(t[(t[c+16>>2]==(0|a)?16:20)+c>>2]=i,i)break D;break Q;}if(t[e>>2]=i,!i)break p;}if(t[i+24>>2]=c,A=t[a+16>>2],A&&(t[i+16>>2]=A,t[A+24>>2]=i),A=t[a+20>>2],!A)break Q;t[i+20>>2]=A,t[A+24>>2]=i;break Q;}d=1068,C=hf(A)&l,t[d>>2]=C;}o>>>0<=15?(A=n+o|0,t[a+4>>2]=3|A,A=A+a|0,t[A+4>>2]=1|t[A+4>>2]):(t[s+4>>2]=1|o,t[a+4>>2]=3|n,t[o+s>>2]=o,u&&(i=u>>>3,A=1104+(i<<3)|0,e=t[271],i=1<<i,n=t[A+8>>2],i&f||(t[266]=i|f,n=A),t[n+12>>2]=e,t[A+8>>2]=e,t[e+12>>2]=A,t[e+8>>2]=n),t[271]=s,t[268]=o),A=a+8|0;break A;}if(!A)break G;}for(;f=(-8&t[A+4>>2])-n|0,a=f>>>0<o>>>0,o=a?f:o,i=a?A:i,e=t[A+16>>2],A=e||t[A+20>>2],A;){}}if(!(!i|o>>>0>=t[268]-n>>>0||(k=i+n|0,k>>>0<=i>>>0))){if(c=t[i+24>>2],a=t[i+12>>2],(0|i)==(0|a))break m;if(A=t[i+8>>2],t[A+12>>2]=a,t[a+8>>2]=A,c)break e;break r;}}R:{G:{h:{y:{Q:{if(e=t[268],e>>>0<n>>>0){if(i=t[269],i>>>0<=n>>>0)break Q;A=t[272],e=A+n|0,i=i-n|0,t[e+4>>2]=1|i,t[269]=i,t[272]=e,t[A+4>>2]=3|n,A=A+8|0;break A;}if(A=t[271],i=e-n|0,i>>>0<16)break y;a=A+n|0,t[a+4>>2]=1|i,t[268]=i,t[271]=a,t[A+e>>2]=i,t[A+4>>2]=3|n;break h;}if(!t[384])break G;e=t[386];break R;}t[A+4>>2]=3|e,e=A+e|0,t[e+4>>2]=1|t[e+4>>2],t[271]=0,t[268]=0;}A=A+8|0;break A;}t[387]=-1,t[388]=-1,t[385]=65536,t[386]=65536,t[384]=r+12&-16^1431655768,t[389]=0,t[377]=0,e=65536;}A=0;R:{if(o=n+47|0,f=o+e|0,k=0-e|0,e=f&k,e>>>0>n>>>0){if(A=t[376],A&&(a=t[374],c=a+e|0,c>>>0<=a>>>0|c>>>0>A>>>0))break R;if(4&b[1508])break l;if(a=t[272],a)for(A=1512;;){if(c=t[A>>2],c+t[A+4>>2]>>>0>a>>>0&&c>>>0<=a>>>0)break B;if(A=t[A+8>>2],!A)break;}if(a=L(0),-1==(0|a))break s;if(f=e,A=t[385],i=A+-1|0,i&a&&(f=(e-a|0)+(i+a&0-A)|0),f>>>0<=n>>>0|f>>>0>2147483646)break s;if(A=t[376],A&&(i=t[374],k=i+f|0,k>>>0<=i>>>0|k>>>0>A>>>0))break s;if(A=L(f),(0|a)!=(0|A))break _;break u;}t[256]=48;break A;}A=0,t[256]=48;break A;}if(e=i+20|0,A=t[e>>2],!A){if(A=t[i+16>>2],!A)break g;e=i+16|0;}for(;f=e,a=A,e=A+20|0,A=t[e>>2],A||(e=a+16|0,A=t[a+16>>2],A);){}if(t[f>>2]=0,!c)break r;break e;}if(f=k&f-i,f>>>0>2147483646)break s;if(a=L(f),(0|a)==(t[A>>2]+t[A+4>>2]|0))break v;A=a;}if(a=A,n+48>>>0<=f>>>0|f>>>0>2147483646|-1==(0|A))break C;if(A=t[386],A=A+(o-f|0)&0-A,A>>>0>2147483646)break u;if(-1==(0|L(A)))break d;f=A+f|0;break u;}if(a=0,c)break e;break r;}if(-1!=(0|a))break u;break s;}if(-1!=(0|a))break u;break s;}L(0-f|0);}t[377]=4|t[377];}if(e>>>0>2147483646)break c;if(a=L(e),A=L(0),a>>>0>=A>>>0|-1==(0|a)|-1==(0|A))break c;if(f=A-a|0,f>>>0<=n+40>>>0)break c;}A=t[374]+f|0,t[374]=A,A>>>0>v[375]&&(t[375]=A);u:{l:{s:{if(i=t[272],i){for(A=1512;;){if(e=t[A>>2],o=t[A+4>>2],(e+o|0)==(0|a))break s;if(A=t[A+8>>2],!A)break;}break l;}for(A=t[270],a>>>0>=A>>>0&&A||(t[270]=a),A=0,t[379]=f,t[378]=a,t[274]=-1,t[275]=t[384],t[381]=0;e=A+1104|0,t[A+1112>>2]=e,t[A+1116>>2]=e,A=A+8|0,256!=(0|A);){}A=a+8&7?-8-a&7:0,e=A+a|0,i=f+-40|0,A=i-A|0,t[e+4>>2]=1|A,t[273]=t[388],t[269]=A,t[272]=e,t[4+(i+a|0)>>2]=40;break u;}if(!(8&b[A+12|0]|a>>>0<=i>>>0|e>>>0>i>>>0)){e=i+8&7?-8-i&7:0,a=e+i|0,k=t[269]+f|0,e=k-e|0,t[a+4>>2]=1|e,t[A+4>>2]=f+o,t[273]=t[388],t[269]=e,t[272]=a,t[4+(i+k|0)>>2]=40;break u;}}a>>>0<v[270]&&(t[270]=a),e=a+f|0,A=1512;l:{s:{d:{v:{C:{g:{_:{for(;;){if(t[A>>2]!=(0|e)){if(A=t[A+8>>2],A)continue;break _;}break;}if(!(8&b[A+12|0])){if(t[A>>2]=a,t[A+4>>2]=t[A+4>>2]+f,c=(a+8&7?-8-a&7:0)+a|0,t[c+4>>2]=3|n,a=e+(e+8&7?-8-e&7:0)|0,A=(a-c|0)-n|0,f=n+c|0,(0|i)==(0|a))break g;if(t[271]==(0|a))break k;if(e=t[a+4>>2],1!=(3&e))break a;if(u=-8&e,e>>>0>255)break o;if(i=t[a+12>>2],n=t[a+8>>2],(0|i)==(0|n))break b;t[i+8>>2]=n,t[n+12>>2]=i;break f;}}for(A=1512;e=t[A>>2],!(e>>>0<=i>>>0&&(o=e+t[A+4>>2]|0,o>>>0>i>>>0));){A=t[A+8>>2];}for(A=a+8&7?-8-a&7:0,k=A+a|0,e=f+-40|0,A=e-A|0,t[k+4>>2]=1|A,t[4+(e+a|0)>>2]=40,e=(o+(o+-39&7?39-o&7:0)|0)-47|0,e=e>>>0<i+16>>>0?i:e,t[e+4>>2]=27,t[273]=t[388],t[269]=A,t[272]=k,k=t[381],A=e+16|0,t[A>>2]=t[380],t[A+4>>2]=k,A=t[379],t[e+8>>2]=t[378],t[e+12>>2]=A,t[379]=f,t[378]=a,t[380]=e+8,t[381]=0,A=e+28|0;t[A>>2]=7,A=A+4|0,A>>>0<o>>>0;){}if((0|e)==(0|i))break u;if(A=e+4|0,t[A>>2]=-2&t[A>>2],o=e-i|0,t[e>>2]=o,t[i+4>>2]=1|o,o>>>0<=255){if(e=o>>>3,A=1104+(e<<3)|0,a=t[266],e=1<<e,!(a&e))break C;o=t[A+8>>2];break v;}if(t[i+16>>2]=0,t[i+20>>2]=0,f=i+28|0,e=o>>>8,A=0,e&&(A=31,o>>>0>16777215||(A=e,e=e+1048320>>>16&8,a=A<<e,A=a+520192>>>16&4,k=A|e,A=a<<A,e=A+245760>>>16&2,A=(14-(k|e)|0)+(A<<e>>>15)|0,A=o>>>A+7&1|A<<1)),t[f>>2]=A,e=1368+(A<<2)|0,a=t[267],f=1<<A,!(a&f))break d;for(A=o<<(31==(0|A)?0:25-(A>>>1)|0),a=t[e>>2];;){if(e=a,(0|o)==(-8&t[e+4>>2]))break l;if(a=A>>>29,A<<=1,f=16+(e+(4&a)|0)|0,a=t[f>>2],!a)break;}t[f>>2]=i;break s;}t[272]=f,A=t[269]+A|0,t[269]=A,t[f+4>>2]=1|A;break i;}t[266]=e|a,o=A;}t[o+12>>2]=i,t[A+8>>2]=i,t[i+12>>2]=A,t[i+8>>2]=o;break u;}t[e>>2]=i,t[267]=a|f;}t[i+24>>2]=e,t[i+12>>2]=i,t[i+8>>2]=i;break u;}A=t[e+8>>2],t[A+12>>2]=i,t[e+8>>2]=i,t[i+24>>2]=0,t[i+12>>2]=e,t[i+8>>2]=A;}if(e=t[269],!(e>>>0<=n>>>0)){A=t[272],i=A+n|0,e=e-n|0,t[i+4>>2]=1|e,t[269]=e,t[272]=i,t[A+4>>2]=3|n,A=A+8|0;break A;}}A=0,t[256]=48;break A;}t[271]=f,A=t[268]+A|0,t[268]=A,t[f+4>>2]=1|A,t[A+f>>2]=A;break i;}if(k=t[a+24>>2],i=t[a+12>>2],(0|i)==(0|a))break t;if(e=t[a+8>>2],t[e+12>>2]=i,t[i+8>>2]=e,k)break n;break f;}d=1064,C=t[266]&hf(e>>>3),t[d>>2]=C;break f;}if(e=a+20|0,n=t[e>>2],n||(e=a+16|0,n=t[e>>2],n)){for(;o=e,i=n,e=i+20|0,n=t[e>>2],n||(e=i+16|0,n=t[i+16>>2],n);){}if(t[o>>2]=0,!k)break f;}else if(i=0,!k)break f;}n:{e=t[a+28>>2],n=1368+(e<<2)|0;t:{if((0|a)!=t[n>>2]){if(t[k+(t[k+16>>2]==(0|a)?16:20)>>2]=i,i)break t;break f;}if(t[n>>2]=i,!i)break n;}if(t[i+24>>2]=k,e=t[a+16>>2],e&&(t[i+16>>2]=e,t[e+24>>2]=i),e=t[a+20>>2],!e)break f;t[i+20>>2]=e,t[e+24>>2]=i;break f;}d=1068,C=t[267]&hf(e),t[d>>2]=C;}A=A+u|0,a=a+u|0;}t[a+4>>2]=-2&t[a+4>>2],t[A+f>>2]=A,t[f+4>>2]=1|A;a:{f:{n:{t:{b:{if(A>>>0<=255){if(e=A>>>3,A=1104+(e<<3)|0,i=t[266],e=1<<e,!(i&e))break b;e=t[A+8>>2];break t;}if(n=f,i=A>>>8,e=0,i&&(e=31,A>>>0>16777215||(e=i,i=i+1048320>>>16&8,a=e<<i,e=a+520192>>>16&4,o=e|i,e=a<<e,i=e+245760>>>16&2,e=(14-(o|i)|0)+(e<<i>>>15)|0,e=A>>>e+7&1|e<<1)),t[n+28>>2]=e,t[f+16>>2]=0,t[f+20>>2]=0,i=1368+(e<<2)|0,a=t[267],n=1<<e,!(a&n))break n;for(e=A<<(31==(0|e)?0:25-(e>>>1)|0),a=t[i>>2];;){if(i=a,(-8&t[i+4>>2])==(0|A))break a;if(a=e>>>29,e<<=1,n=16+(i+(4&a)|0)|0,a=t[n>>2],!a)break;}t[n>>2]=f;break f;}t[266]=e|i,e=A;}t[e+12>>2]=f,t[A+8>>2]=f,t[f+12>>2]=A,t[f+8>>2]=e;break i;}t[i>>2]=f,t[267]=a|n;}t[f+24>>2]=i,t[f+12>>2]=f,t[f+8>>2]=f;break i;}A=t[i+8>>2],t[A+12>>2]=f,t[i+8>>2]=f,t[f+24>>2]=0,t[f+12>>2]=i,t[f+8>>2]=A;}A=c+8|0;break A;}e:{A=t[i+28>>2],e=1368+(A<<2)|0;i:{if((0|i)!=t[e>>2]){if(t[c+(t[c+16>>2]==(0|i)?16:20)>>2]=a,a)break i;break r;}if(t[e>>2]=a,!a)break e;}if(t[a+24>>2]=c,A=t[i+16>>2],A&&(t[a+16>>2]=A,t[A+24>>2]=a),A=t[i+20>>2],!A)break r;t[a+20>>2]=A,t[A+24>>2]=a;break r;}u=hf(A)&u,t[267]=u;}r:if(o>>>0<=15)A=n+o|0,t[i+4>>2]=3|A,A=A+i|0,t[A+4>>2]=1|t[A+4>>2];else {t[k+4>>2]=1|o,t[i+4>>2]=3|n,t[o+k>>2]=o,f=k;e:{i:{a:{f:{if(o>>>0<=255){if(e=o>>>3,A=1104+(e<<3)|0,a=t[266],e=1<<e,!(a&e))break f;e=t[A+8>>2];break a;}if(e=o>>>8,!e)break i;if(A=31,o>>>0>16777215)break e;A=e,e=e+1048320>>>16&8,a=A<<e,A=a+520192>>>16&4,n=A|e,A=a<<A,e=A+245760>>>16&2,A=(14-(n|e)|0)+(A<<e>>>15)|0,A=o>>>A+7&1|A<<1;break e;}t[266]=e|a,e=A;}t[e+12>>2]=k,t[A+8>>2]=k,t[k+12>>2]=A,t[k+8>>2]=e;break r;}A=0;}t[f+28>>2]=A,t[k+16>>2]=0,t[k+20>>2]=0,e=1368+(A<<2)|0;e:{if(a=1<<A,a&u){for(A=o<<(31==(0|A)?0:25-(A>>>1)|0),n=t[e>>2];;){if(e=n,(-8&t[e+4>>2])==(0|o))break e;if(a=A>>>29,A<<=1,a=16+(e+(4&a)|0)|0,n=t[a>>2],!n)break;}t[a>>2]=k;}else t[e>>2]=k,t[267]=a|u;t[k+24>>2]=e,t[k+12>>2]=k,t[k+8>>2]=k;break r;}A=t[e+8>>2],t[A+12>>2]=k,t[e+8>>2]=k,t[k+24>>2]=0,t[k+12>>2]=e,t[k+8>>2]=A;}A=i+8|0;}return E=r+16|0,A;}function q(A){var r=0,e=0,i=0,a=0,f=0,n=0,b=0,o=0,k=0;A:{r:if(A){i=A+-8|0,r=t[A+-4>>2],A=-8&r,f=i+A|0;e:{i:if(!(1&r)){if(!(3&r))break r;if(r=t[i>>2],i=i-r|0,i>>>0<v[270])break r;A=A+r|0;a:{f:{n:{t:{if((0|i)!=t[271]){if(r>>>0>255)break t;if(e=t[i+12>>2],a=t[i+8>>2],(0|e)==(0|a))break n;if(t[e+8>>2]=a,t[a+12>>2]=e,i>>>0<f>>>0)break e;break r;}if(r=t[f+4>>2],3!=(3&r))break i;return t[f+4>>2]=-2&r,t[268]=A,t[A+i>>2]=A,void(t[i+4>>2]=1|A);}if(n=t[i+24>>2],r=t[i+12>>2],(0|r)==(0|i))break f;if(e=t[i+8>>2],t[e+12>>2]=r,t[r+8>>2]=e,n)break a;break i;}if(o=1064,k=t[266]&hf(r>>>3),t[o>>2]=k,i>>>0<f>>>0)break e;break r;}if(e=i+20|0,a=t[e>>2],a||(e=i+16|0,a=t[e>>2],a)){for(;b=e,r=a,e=r+20|0,a=t[e>>2],a||(e=r+16|0,a=t[r+16>>2],a);){}if(t[b>>2]=0,!n)break i;}else if(r=0,!n)break i;}a:{e=t[i+28>>2],a=1368+(e<<2)|0;f:{if((0|i)!=t[a>>2]){if(t[n+(t[n+16>>2]==(0|i)?16:20)>>2]=r,r)break f;break i;}if(t[a>>2]=r,!r)break a;}if(t[r+24>>2]=n,e=t[i+16>>2],e&&(t[r+16>>2]=e,t[e+24>>2]=r),e=t[i+20>>2],!e)break i;if(t[r+20>>2]=e,t[e+24>>2]=r,i>>>0<f>>>0)break e;break r;}o=1068,k=t[267]&hf(e),t[o>>2]=k;}if(i>>>0>=f>>>0)break r;}if(r=t[f+4>>2],1&r){e:{i:{a:{f:{n:{t:{b:{o:{if(!(2&r)){if((0|f)==t[272])break o;if((0|f)==t[271])break b;if(A=(-8&r)+A|0,r>>>0>255)break t;if(e=t[f+12>>2],a=t[f+8>>2],(0|e)==(0|a))break n;t[e+8>>2]=a,t[a+12>>2]=e;break i;}t[f+4>>2]=-2&r,t[A+i>>2]=A,t[i+4>>2]=1|A;break e;}if(t[272]=i,A=t[269]+A|0,t[269]=A,t[i+4>>2]=1|A,t[271]!=(0|i))break r;return t[268]=0,void(t[271]=0);}return t[271]=i,A=t[268]+A|0,t[268]=A,t[i+4>>2]=1|A,void(t[A+i>>2]=A);}if(n=t[f+24>>2],r=t[f+12>>2],(0|f)==(0|r))break f;if(e=t[f+8>>2],t[e+12>>2]=r,t[r+8>>2]=e,n)break a;break i;}o=1064,k=t[266]&hf(r>>>3),t[o>>2]=k;break i;}if(e=f+20|0,a=t[e>>2],a||(e=f+16|0,a=t[e>>2],a)){for(;b=e,r=a,e=r+20|0,a=t[e>>2],a||(e=r+16|0,a=t[r+16>>2],a);){}if(t[b>>2]=0,!n)break i;}else if(r=0,!n)break i;}a:{e=t[f+28>>2],a=1368+(e<<2)|0;f:{if(t[a>>2]!=(0|f)){if(t[n+((0|f)==t[n+16>>2]?16:20)>>2]=r,r)break f;break i;}if(t[a>>2]=r,!r)break a;}if(t[r+24>>2]=n,e=t[f+16>>2],e&&(t[r+16>>2]=e,t[e+24>>2]=r),e=t[f+20>>2],!e)break i;t[r+20>>2]=e,t[e+24>>2]=r;break i;}o=1068,k=t[267]&hf(e),t[o>>2]=k;}if(t[A+i>>2]=A,t[i+4>>2]=1|A,t[271]==(0|i))return void(t[268]=A);}e:{i:{a:{f:{n:{t:{if(A>>>0<=255){if(r=A>>>3,A=1104+(r<<3)|0,e=t[266],r=1<<r,!(e&r))break t;e=t[A+8>>2];break n;}if(t[i+16>>2]=0,t[i+20>>2]=0,b=i+28|0,r=A>>>8,e=0,r&&(e=31,A>>>0>16777215||(e=r+1048320>>>16&8,a=r<<e,r=a+520192>>>16&4,f=r|e,r=a<<r,e=r+245760>>>16&2,r=(14-(f|e)|0)+(r<<e>>>15)|0,e=A>>>r+7&1|r<<1)),t[b>>2]=e,r=1368+(e<<2)|0,a=t[267],b=1<<e,!(a&b))break f;for(e=A<<(31==(0|e)?0:25-(e>>>1)|0),r=t[r>>2];;){if(a=r,(-8&t[r+4>>2])==(0|A))break i;if(r=e>>>29,e<<=1,b=16+(a+(4&r)|0)|0,r=t[b>>2],!r)break;}t[b>>2]=i,t[i+24>>2]=a;break a;}t[266]=r|e,e=A;}return t[e+12>>2]=i,t[A+8>>2]=i,t[i+12>>2]=A,void(t[i+8>>2]=e);}t[r>>2]=i,t[267]=a|b,t[i+24>>2]=r;}t[i+12>>2]=i,t[i+8>>2]=i;break e;}A=t[a+8>>2],t[A+12>>2]=i,t[a+8>>2]=i,t[i+24>>2]=0,t[i+12>>2]=a,t[i+8>>2]=A;}if(A=t[274]+-1|0,t[274]=A,!A)break A;}}return;}for(i=1520;A=t[i>>2],i=A+8|0,A;){}t[274]=-1;}function $(A){var r;return r=E-16|0,t[r+12>>2]=A,t[r+8>>2]=2,t[t[r+12>>2]>>2];}function AA(A){var r,e=0,i=0;for(r=E-16|0,E=r,t[r+12>>2]=A,t[r+12>>2]||(t[r+12>>2]=1);A=K(t[r+12>>2]),t[r+8>>2]=A,!A&&(e=r,i=$(1576),t[e+4>>2]=i,t[r+4>>2]);){yf[t[r+4>>2]]();}return E=r+16|0,t[r+8>>2];}function rA(A){var r;r=E-16|0,E=r,t[r+12>>2]=A,q(t[r+12>>2]),E=r+16|0;}function eA(A){A|=0,t[12+(E-16|0)>>2]=A;}function iA(A){var r;return A|=0,r=E-16|0,E=r,t[r+12>>2]=A,A=t[r+12>>2],function(A){var r;r=E-16|0,E=r,t[r+12>>2]=A,t[12+(E-16|0)>>2]=t[r+12>>2],E=r+16|0;}(A),E=r+16|0,0|A;}function aA(A){var r;return A|=0,r=E-16|0,E=r,t[r+12>>2]=A,A=t[r+12>>2],iA(A),E=r+16|0,0|A;}function fA(A,r,e){var i,f=0,n=0;return i=E-16|0,E=i,t[i+8>>2]=A,t[i+4>>2]=r,a[i+3|0]=e,1&a[i+3|0]?(f=i,n=!function(A,r){var e=0,i=0;e=b[0|A],i=b[0|r];A:if(!(!e|(0|i)!=(0|e)))for(A=A+1|0,r=r+1|0;;){if(i=b[0|r],e=b[0|A],!e)break A;if(A=A+1|0,r=r+1|0,(0|e)!=(0|i))break;}return e-i|0;}(nA(t[i+8>>2]),nA(t[i+4>>2])),a[f+15|0]=n):a[i+15|0]=t[i+8>>2]==t[i+4>>2],E=i+16|0,1&a[i+15|0];}function nA(A){var r;return r=E-16|0,t[r+12>>2]=A,t[t[r+12>>2]+4>>2];}function tA(A,r,e,i){var f;f=E-16|0,t[f+12>>2]=A,t[f+8>>2]=r,t[f+4>>2]=e,t[f>>2]=i,t[t[f+8>>2]+16>>2]?t[t[f+8>>2]+16>>2]!=t[f+4>>2]?(A=t[f+8>>2],t[A+36>>2]=t[A+36>>2]+1,t[t[f+8>>2]+24>>2]=2,a[t[f+8>>2]+54|0]=1):2==t[t[f+8>>2]+24>>2]&&(t[t[f+8>>2]+24>>2]=t[f>>2]):(t[t[f+8>>2]+16>>2]=t[f+4>>2],t[t[f+8>>2]+24>>2]=t[f>>2],t[t[f+8>>2]+36>>2]=1);}function bA(A,r,e,i){var a,f;a=E-32|0,E=a,t[a+28>>2]=A,t[a+24>>2]=r,t[a+20>>2]=e,t[a+16>>2]=i,A=t[a+28>>2],t[a+12>>2]=0,t[a+20>>2]&&(t[a+12>>2]=t[A+4>>2]>>8,1&t[A+4>>2]&&(t[a+8>>2]=t[t[a+20>>2]>>2],t[a+12>>2]=t[t[a+8>>2]+t[a+12>>2]>>2])),r=t[A>>2],e=r,i=t[a+24>>2],f=t[a+20>>2]+t[a+12>>2]|0,A=2&t[A+4>>2]?t[a+16>>2]:2,yf[t[t[r>>2]+28>>2]](e,i,f,A),E=a+32|0;}function oA(A,r,e,i,f){var n;n=E-32|0,t[n+28>>2]=A,t[n+24>>2]=r,t[n+20>>2]=e,t[n+16>>2]=i,t[n+12>>2]=f,a[t[n+24>>2]+53|0]=1,t[n+16>>2]==t[t[n+24>>2]+4>>2]&&(a[t[n+24>>2]+52|0]=1,t[t[n+24>>2]+16>>2]?t[t[n+24>>2]+16>>2]!=t[n+20>>2]?(A=t[n+24>>2],t[A+36>>2]=t[A+36>>2]+1,a[t[n+24>>2]+54|0]=1):(2==t[t[n+24>>2]+24>>2]&&(t[t[n+24>>2]+24>>2]=t[n+12>>2]),1!=t[t[n+24>>2]+48>>2]|1!=t[t[n+24>>2]+24>>2]||(a[t[n+24>>2]+54|0]=1)):(t[t[n+24>>2]+16>>2]=t[n+20>>2],t[t[n+24>>2]+24>>2]=t[n+12>>2],t[t[n+24>>2]+36>>2]=1,1!=t[t[n+24>>2]+48>>2]|1!=t[t[n+24>>2]+24>>2]||(a[t[n+24>>2]+54|0]=1)));}function kA(A,r,e,i){var a;a=E-16|0,t[a+12>>2]=A,t[a+8>>2]=r,t[a+4>>2]=e,t[a>>2]=i,t[a+4>>2]==t[t[a+8>>2]+4>>2]&&1!=t[t[a+8>>2]+28>>2]&&(t[t[a+8>>2]+28>>2]=t[a>>2]);}function cA(A,r,e,i,f,n){var b;b=E-32|0,E=b,t[b+28>>2]=A,t[b+24>>2]=r,t[b+20>>2]=e,t[b+16>>2]=i,t[b+12>>2]=f,a[b+11|0]=n,A=t[b+28>>2],t[b+4>>2]=t[A+4>>2]>>8,1&t[A+4>>2]&&(t[b>>2]=t[t[b+16>>2]>>2],t[b+4>>2]=t[t[b>>2]+t[b+4>>2]>>2]),r=t[A>>2],e=r,i=t[b+24>>2],f=t[b+20>>2],n=t[b+16>>2]+t[b+4>>2]|0,A=2&t[A+4>>2]?t[b+12>>2]:2,yf[t[t[r>>2]+20>>2]](e,i,f,n,A,1&a[b+11|0]),E=b+32|0;}function uA(A,r,e,i,f){var n;n=E-32|0,E=n,t[n+28>>2]=A,t[n+24>>2]=r,t[n+20>>2]=e,t[n+16>>2]=i,a[n+15|0]=f,A=t[n+28>>2],t[n+8>>2]=t[A+4>>2]>>8,1&t[A+4>>2]&&(t[n+4>>2]=t[t[n+20>>2]>>2],t[n+8>>2]=t[t[n+4>>2]+t[n+8>>2]>>2]),r=t[A>>2],e=r,i=t[n+24>>2],f=t[n+20>>2]+t[n+8>>2]|0,A=2&t[A+4>>2]?t[n+16>>2]:2,yf[t[t[r>>2]+24>>2]](e,i,f,A,1&a[n+15|0]),E=n+32|0;}function lA(A,r){t[A>>2]=5808,t[A+4>>2]=t[r>>2];}function sA(A){return A|=0,0|A;}function dA(A){p();}function vA(A,r){lA(A,r),t[A>>2]=5836;}function CA(A,r){return t[395]=t[395]+1,0|yf[t[790]](A,r);}function gA(A){A&&(t[396]=t[396]+1,yf[t[791]](A));}function _A(A,r,e,i){var a,n,b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=0,s=0,d=B(0),v=B(0),g=0,m=B(0),R=B(0),G=0,h=0,y=0,Q=0,p=B(0),D=0;a=E-32|0,E=a,n=t[A>>2],t[A>>2]=n+1;A:{r:{e:{i:{a:{f:{n:{t:{b:{o:{k:{c:{u:{l:{s:{d:{v:{C:{g:{_:{B:{m:{R:{G:{if(l=i-e|0,1==(0|l)){if(v=C[A+48>>2],b=C[A+32>>2],e=t[r+12>>2]+_(e,36)|0,o=C[e+8>>2],o=o<b?b:o,m=C[A- -64>>2],o=B(B(B((v<o?v:o)-b)*m)+B(.5)),o<B(4294967296)&o>=B(0))break G;r=0;break R;}if(h=function(A,r,e,i){var a,f=0,n=0,b=0,o=0,k=0,c=0,u=0,l=0,s=0,d=B(0),v=0,g=0,m=B(0),R=B(0),G=B(0),h=0,y=0,Q=0,p=0,D=0,w=0,W=0,F=0;if(a=E+-64|0,u=a+24|0,n=u,t[n>>2]=0,t[n+4>>2]=0,t[a+16>>2]=0,t[a+20>>2]=0,f=(0|e)<=(0|r),!f){for(l=e-r|0,n=24+(t[A+12>>2]+_(r,36)|0)|0;d=B(B(B(C[n+-4>>2]+C[n+-20>>2])*B(.5))+d),m=B(B(B(C[n+-8>>2]+C[n+-24>>2])*B(.5))+m),R=B(B(B(C[n>>2]+C[n+-16>>2])*B(.5))+R),n=n+36|0,l=l+-1|0,l;){}C[a+24>>2]=R,C[a+20>>2]=d,C[a+16>>2]=m;}if(n=u,u=e-r|0,G=B(B(1)/B(0|u)),C[n>>2]=G*R,C[a+20>>2]=G*d,C[a+16>>2]=G*m,n=r,!f)for(i<<=2,d=C[i+(a+16|0)>>2],l=_(r,36)+16|0,D=i+a|0,v=a+48|0,i=u;t[a+12>>2]=0,Q=A+12|0,b=t[Q>>2],f=b+l|0,c=f+8|0,o=f+-8|0,C[a+8>>2]=B(C[c>>2]+C[o>>2])*B(.5),C[a+4>>2]=B(C[f+4>>2]+C[f+-12>>2])*B(.5),k=f+-16|0,C[a>>2]=B(C[f>>2]+C[k>>2])*B(.5),C[D>>2]>d&&(w=t[k>>2],W=t[k+4>>2],p=_(n,36),b=b+p|0,s=t[b+4>>2],t[k>>2]=t[b>>2],t[k+4>>2]=s,k=t[f>>2],F=t[f+4>>2],s=b+16|0,h=t[s+4>>2],t[f>>2]=t[s>>2],t[f+4>>2]=h,s=t[c>>2],h=t[c+4>>2],g=b+24|0,y=t[g+4>>2],t[c>>2]=t[g>>2],t[c+4>>2]=y,f=f+16|0,g=t[f>>2],t[f>>2]=t[b+32>>2],f=t[o>>2],y=t[o+4>>2],c=b+8|0,b=t[c+4>>2],t[o>>2]=t[c>>2],t[o+4>>2]=b,c=a+40|0,o=c,t[o>>2]=f,t[o+4>>2]=y,t[v>>2]=k,t[v+4>>2]=F,f=v+8|0,t[f>>2]=s,t[f+4>>2]=h,t[a+32>>2]=w,t[a+36>>2]=W,k=t[a+36>>2],f=t[Q>>2]+p|0,t[f>>2]=t[a+32>>2],t[f+4>>2]=k,t[f+32>>2]=g,o=a+56|0,k=t[o+4>>2],b=f+24|0,t[b>>2]=t[o>>2],t[b+4>>2]=k,o=t[v+4>>2],k=f+16|0,t[k>>2]=t[v>>2],t[k+4>>2]=o,o=t[c+4>>2],f=f+8|0,t[f>>2]=t[c>>2],t[f+4>>2]=o,n=n+1|0),l=l+36|0,i=i+-1|0,i;){}return A=(0|u)/3|0,(0|n)<((-1^A)+e|0)&&(0|n)>(A+r|0)||(n=(u>>1)+r|0),n;}(r,e,i,function(A,r,e){var i,a=0,f=B(0),n=B(0),b=B(0),o=B(0),k=0,c=B(0),u=B(0),l=B(0),s=B(0);i=e-r|0;h:{y:{if((0|e)>(0|r)){for(a=24+(t[A+12>>2]+_(r,36)|0)|0,k=i;f=B(f+B(B(C[a+-4>>2]+C[a+-20>>2])*B(.5))),n=B(n+B(B(C[a+-8>>2]+C[a+-24>>2])*B(.5))),b=B(b+B(B(C[a>>2]+C[a+-16>>2])*B(.5))),a=a+36|0,k=k+-1|0,k;){}if(c=B(0|i),o=B(0),(0|e)<=(0|r))break y;for(u=B(B(1)/c),l=B(u*b),s=B(u*f),u=B(u*n),k=e-r|0,a=24+(t[A+12>>2]+_(r,36)|0)|0,b=B(0),f=B(0),n=B(0);o=f,f=B(B(B(C[a+-4>>2]+C[a+-20>>2])*B(.5))-s),f=B(o+B(f*f)),o=n,n=B(B(B(C[a+-8>>2]+C[a+-24>>2])*B(.5))-u),n=B(o+B(n*n)),o=b,b=B(B(B(C[a>>2]+C[a+-16>>2])*B(.5))-l),b=B(o+B(b*b)),a=a+36|0,k=k+-1|0,k;){}break h;}c=B(0|i),o=B(0);}n=o,f=B(0),b=B(0);}return c=B(B(1)/B(c+B(-1))),f=B(c*f),b=B(c*b),n=B(c*n),n<f?f<b?2:1:(n<b)<<1;}(r,e,i)),y=a+24|0,t[y>>2]=-8388609,t[a+16>>2]=-8388609,t[a+20>>2]=-8388609,t[a+8>>2]=2139095039,t[a>>2]=2139095039,t[a+4>>2]=2139095039,(0|i)<=(0|e))break m;for(G=a+16|0,s=16+(t[r+12>>2]+_(e,36)|0)|0,b=B(3.4028234663852886e38),o=B(-3.4028234663852886e38),D=a+20|0,u=B(-3.4028234663852886e38),k=B(-3.4028234663852886e38),v=B(3.4028234663852886e38),d=B(3.4028234663852886e38);g=s+-16|0,c=C[g>>2],d=d>c?c:d,C[a>>2]=d,Q=v>C[s+-12>>2]?g:a,v=C[Q+4>>2],t[a+4>>2]=t[Q+4>>2],g=b>C[s+-8>>2]?g:a,b=C[g+8>>2],t[a+8>>2]=t[g+8>>2],c=C[s>>2],k=k<c?c:k,C[G>>2]=k,g=u<C[s+4>>2]?s:G,u=C[g+4>>2],t[D>>2]=t[g+4>>2],g=o<C[s+8>>2]?s:G,o=C[g+8>>2],t[y>>2]=t[g+8>>2],s=s+36|0,l=l+-1|0,l;){}break B;}r=~~o>>>0;}if(c=C[e>>2],u=C[e+4>>2],i=t[A+16>>2]+(n<<4)|0,f[i+4>>1]=r,k=C[A+44>>2],o=C[A+28>>2],u=u<o?o:u,R=C[A+60>>2],u=B(B(B((k<u?k:u)-o)*R)+B(.5)),u<B(4294967296)&u>=B(0))break _;r=0;break g;}b=B(3.4028234663852886e38),o=B(-3.4028234663852886e38),u=B(-3.4028234663852886e38),k=B(-3.4028234663852886e38),v=B(3.4028234663852886e38),d=B(3.4028234663852886e38);}if(g=n<<4,G=A+16|0,s=g+t[G>>2]|0,R=C[A+56>>2],m=C[A+40>>2],c=C[A+24>>2],k=k<c?c:k,k=B(B(R*B((m<k?m:k)-c))+B(.5)),k<B(4294967296)&k>=B(0))break C;l=0;break v;}r=~~u>>>0;}if(f[i+2>>1]=r,d=C[A+40>>2],u=C[A+24>>2],c=c<u?u:c,p=C[A+56>>2],c=B(B(B((d<c?d:c)-u)*p)+B(.5)),c<B(4294967296)&c>=B(0))break d;r=0;break s;}l=~~k>>>0;}if(f[s+6>>1]=l,k=d<c?c:d,k=B(B(B((m<k?m:k)-c)*R)+B(.5)),k<B(4294967296)&k>=B(0))break l;l=0;break u;}r=~~c>>>0;}if(f[i>>1]=r,c=C[e+24>>2],c=c<b?b:c,b=B(B(m*B((v<c?v:c)-b))+B(.5)),b<B(4294967296)&b>=B(0))break c;r=0;break k;}l=~~k>>>0;}if(f[s>>1]=l,m=C[A- -64>>2],d=C[A+48>>2],k=C[A+32>>2],o=o<k?k:o,o=B(B(m*B((d<o?d:o)-k))+B(.5)),o<B(4294967296)&o>=B(0))break o;l=0;break b;}r=~~b>>>0;}if(b=C[e+16>>2],v=C[e+20>>2],f[i+10>>1]=r,v=v<o?o:v,o=B(B(R*B((k<v?k:v)-o))+B(.5)),o<B(4294967296)&o>=B(0))break t;r=0;break n;}l=~~o>>>0;}if(f[s+10>>1]=l,R=C[A+60>>2],c=C[A+44>>2],o=C[A+28>>2],u=u<o?o:u,u=B(B(R*B((c<u?c:u)-o))+B(.5)),u<B(4294967296)&u>=B(0))break f;l=0;break a;}r=~~o>>>0;}if(f[i+8>>1]=r,b=b<u?u:b,b=B(B(p*B((d<b?d:b)-u))+B(.5)),b<B(4294967296)&b>=B(0))break i;r=0;break e;}l=~~u>>>0;}if(f[s+8>>1]=l,b=b<k?k:b,b=B(B(B((d<b?d:b)-k)*m)+B(.5)),b<B(4294967296)&b>=B(0))break r;l=0;break A;}r=~~b>>>0;}return f[i+6>>1]=r,t[i+12>>2]=t[e+32>>2],void(E=a+32|0);}l=~~b>>>0;}f[s+4>>1]=l,b=v<o?o:v,b=B(B(B((c<b?c:b)-o)*R)+B(.5)),l=0,b<B(4294967296)&b>=B(0)&&(l=~~b>>>0),f[s+2>>1]=l,_A(A,r,e,h),_A(A,r,h,i),t[12+(g+t[G>>2]|0)>>2]=n-t[A>>2],E=a+32|0;}function BA(A,r){var e,i,f,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0;if(e=E-16|0,E=e,function(A,r){var e,i,a,f=0,n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=0,d=0,v=0,g=0;if(e=E-32|0,i=e+24|0,t[i>>2]=-8388609,t[e+16>>2]=-8388609,t[e+20>>2]=-8388609,t[e+8>>2]=2139095039,t[e>>2]=2139095039,t[e+4>>2]=2139095039,a=t[r+4>>2],(0|a)>=1)for(s=e+16|0,r=t[r+12>>2]+16|0,o=B(3.4028234663852886e38),k=B(-3.4028234663852886e38),g=e+20|0,c=B(-3.4028234663852886e38),n=B(-3.4028234663852886e38),u=B(3.4028234663852886e38),b=B(3.4028234663852886e38);f=r+-16|0,l=C[f>>2],b=b>l?l:b,C[e>>2]=b,d=u>C[r+-12>>2]?f:e,u=C[d+4>>2],t[e+4>>2]=t[d+4>>2],f=o>C[r+-8>>2]?f:e,o=C[f+8>>2],t[e+8>>2]=t[f+8>>2],l=C[r>>2],n=n<l?l:n,C[s>>2]=n,f=c<C[r+4>>2]?r:s,c=C[f+4>>2],t[g>>2]=t[f+4>>2],f=k<C[r+8>>2]?r:s,k=C[f+8>>2],t[i>>2]=t[f+8>>2],r=r+36|0,v=v+1|0,(0|v)<(0|a);){}else o=B(3.4028234663852886e38),k=B(-3.4028234663852886e38),c=B(-3.4028234663852886e38),n=B(-3.4028234663852886e38),u=B(3.4028234663852886e38),b=B(3.4028234663852886e38);t[A+68>>2]=0,t[A+52>>2]=0,k=B(k+B(1)),C[A+48>>2]=k,c=B(c+B(1)),C[A+44>>2]=c,n=B(n+B(1)),C[A+40>>2]=n,t[A+36>>2]=0,o=B(o-B(1)),C[A+32>>2]=o,u=B(u-B(1)),C[A+28>>2]=u,b=B(b-B(1)),C[A+24>>2]=b,C[A- -64>>2]=B(65535)/B(k-o),C[A+60>>2]=B(65535)/B(c-u),C[A+56>>2]=B(65535)/B(n-b);}(A,r),t[A>>2]=0,f=A+8|0,n=t[f>>2],c=t[r+4>>2],i=c<<1,(0|n)<(0|i)){if(t[A+12>>2]<(0|i)){A:{r:{if(c){if(s=CA(c<<5,16),o=t[A+8>>2],(0|o)>=1)break r;break A;}if(o=n,(0|n)<1)break A;}for(;l=t[A+16>>2]+k|0,d=t[l+4>>2],u=k+s|0,t[u>>2]=t[l>>2],t[u+4>>2]=d,l=l+8|0,d=t[l+4>>2],u=u+8|0,t[u>>2]=t[l>>2],t[u+4>>2]=d,k=k+16|0,o=o+-1|0,o;){}}o=A+16|0,k=t[o>>2],k&&(b[A+20|0]&&gA(k),t[A+16>>2]=0),t[o>>2]=s,a[A+20|0]=1,t[A+12>>2]=i;}for(o=(c<<1)-n|0,k=n<<4|12,c=e+8|0;n=t[A+16>>2]+k|0,t[n>>2]=0,t[n+-4>>2]=t[c>>2],s=t[e+4>>2],n=n+-12|0,t[n>>2]=t[e>>2],t[n+4>>2]=s,k=k+16|0,o=o+-1|0,o;){}c=t[r+4>>2];}t[f>>2]=i,_A(A,r,0,c),E=e+16|0;}function mA(A,r,e){var i=B(0),f=B(0),n=B(0),o=B(0),k=0,c=B(0),u=0,l=0,s=0,v=0,g=0,_=0,m=0,R=0,G=0,h=0,y=0,Q=0,p=0,D=0,w=B(0),W=B(0),F=0,Z=0,Y=0,E=0,N=0;w=C[A- -64>>2],n=C[A+48>>2],i=C[A+32>>2],f=C[r+24>>2],f=f<i?i:f,f=B(B(w*B((n<f?n:f)-i))+B(.5)),m=0,f<B(4294967296)&f>=B(0)&&(m=~~f>>>0),W=C[A+60>>2],c=C[A+44>>2],f=C[A+28>>2],o=C[r+20>>2],o=o<f?f:o,o=B(B(W*B((c<o?c:o)-f))+B(.5)),R=0,o<B(4294967296)&o>=B(0)&&(R=~~o>>>0),o=C[r+8>>2],o=o<i?i:o,i=B(B(B((n<o?n:o)-i)*w)+B(.5)),g=0,i<B(4294967296)&i>=B(0)&&(g=~~i>>>0),i=C[r+4>>2],i=i<f?f:i,i=B(B(B((c<i?c:i)-f)*W)+B(.5)),G=0,i<B(4294967296)&i>=B(0)&&(G=~~i>>>0),c=C[A+56>>2],f=C[A+40>>2],i=C[A+24>>2],n=C[r+16>>2],n=n<i?i:n,n=B(B(c*B((f<n?f:n)-i))+B(.5)),h=0,n<B(4294967296)&n>=B(0)&&(h=~~n>>>0),n=C[r>>2],n=n<i?i:n,i=B(B(B((f<n?f:n)-i)*c)+B(.5));A:{r:{if(!(i<B(4294967296)&i>=B(0))){if(l=t[A>>2],(0|l)>=1)break r;break A;}if(N=~~i>>>0,l=t[A>>2],(0|l)<1)break A;}for(F=A+16|0,s=e+12|0,A=0;;){r:{e:{if(Z=A<<4,r=Z+t[F>>2]|0,d[r+4>>1]<=m>>>0&&!(d[r>>1]>h>>>0|d[r+6>>1]<N>>>0|d[r+8>>1]<G>>>0|d[r+2>>1]>R>>>0)){if(y=t[r+12>>2],Y=(0|y)>-1,u=d[r+10>>1],r=u>>>0>=g>>>0,!((0|y)<0|u>>>0<g>>>0)){if(v=e+4|0,k=t[v>>2],E=e+8|0,(0|k)==t[E>>2]&&(_=k?k<<1:1,!((0|k)>=(0|_)))){i:{a:{f:{n:{if(_){if(Q=CA(_<<2,16),u=t[s>>2],k=t[v>>2],(0|k)<1)break n;break f;}if(Q=0,u=t[s>>2],(0|k)>=1)break f;}if(!u)break i;break a;}for(p=Q,D=u;t[p>>2]=t[D>>2],p=p+4|0,D=D+4|0,k=k+-1|0,k;){}}b[e+16|0]&&gA(u),t[s>>2]=0,k=t[v>>2];}t[s>>2]=Q,a[e+16|0]=1,t[E>>2]=_;}if(t[t[s>>2]+(k<<2)>>2]=y,t[v>>2]=t[v>>2]+1,!r)break e;break r;}}else Y=t[r+12>>2]>-1,r=0;if(r)break r;}if(!Y){if(A=A-t[12+(t[F>>2]+Z|0)>>2]|0,(0|A)<(0|l))continue;break A;}}if(A=A+1|0,!((0|A)<(0|l)))break;}}}function RA(A,r,e,i,f){var n;n=E-112|0,E=n,!t[A>>2]|!t[e>>2]||(function(A,r,e){var i=B(0),a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),E=B(0),N=B(0),V=B(0);g=C[r+52>>2],_=C[r+56>>2],R=C[e+52>>2],G=C[e+56>>2],b=C[r+20>>2],o=C[r+36>>2],i=C[e+20>>2],a=C[e+36>>2],f=C[e+24>>2],k=C[r+24>>2],h=C[e+40>>2],c=C[r+40>>2],V=C[r+48>>2],y=C[e+48>>2],u=C[r+4>>2],Q=C[e+4>>2],p=C[e+8>>2],l=C[r+8>>2],n=C[e+32>>2],s=C[r+32>>2],D=C[e>>2],d=C[r>>2],w=C[e+16>>2],v=C[r+16>>2],t[A+60>>2]=0,t[A+44>>2]=0,t[A+28>>2]=0,t[A+12>>2]=0,W=B(B(B(d*D)+B(v*w))+B(s*n)),C[A+16>>2]=W,F=B(B(B(l*p)+B(k*f))+B(c*h)),C[A+56>>2]=F,Z=B(B(B(l*Q)+B(k*i))+B(c*a)),C[A+52>>2]=Z,Y=B(B(B(l*D)+B(k*w))+B(c*n)),C[A+48>>2]=Y,E=B(B(B(u*p)+B(b*f))+B(o*h)),C[A+40>>2]=E,N=B(B(B(u*Q)+B(b*i))+B(o*a)),C[A+36>>2]=N,n=B(B(B(u*D)+B(b*w))+B(o*n)),C[A+32>>2]=n,f=B(B(B(d*p)+B(v*f))+B(s*h)),C[A+24>>2]=f,a=B(B(B(d*Q)+B(v*i))+B(s*a)),C[A+20>>2]=a,C[A+64>>2]=B(m(W))+B(9.999999974752427e-7),i=B(-V),C[A+8>>2]=B(B(B(l*i)-B(k*g))-B(c*_))+B(B(B(l*y)+B(k*R))+B(c*G)),C[A+4>>2]=B(B(B(u*i)-B(b*g))-B(o*_))+B(B(B(u*y)+B(b*R))+B(o*G)),C[A>>2]=B(B(B(d*i)-B(v*g))-B(s*_))+B(B(B(d*y)+B(v*R))+B(s*G)),C[A+104>>2]=B(m(F))+B(9.999999974752427e-7),C[A+100>>2]=B(m(Z))+B(9.999999974752427e-7),C[A+96>>2]=B(m(Y))+B(9.999999974752427e-7),C[A+88>>2]=B(m(E))+B(9.999999974752427e-7),C[A+84>>2]=B(m(N))+B(9.999999974752427e-7),C[A+80>>2]=B(m(n))+B(9.999999974752427e-7),C[A+72>>2]=B(m(f))+B(9.999999974752427e-7),C[A+68>>2]=B(m(a))+B(9.999999974752427e-7);}(n,r,i),function A(r,e,i,f,n,o,k){var c=0,u=0,l=0,s=0,v=0,g=0,_=0,R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=0,w=0;u=E+-64|0,E=u,_=n<<4,v=r+16|0,c=_+t[v>>2]|0,l=d[c>>1],g=d[c+2>>1],s=d[c+4>>1],t[u+44>>2]=0,R=C[r- -64>>2],G=C[r+32>>2],C[u+40>>2]=B(B(s>>>0)/R)+G,h=C[r+60>>2],y=C[r+28>>2],C[u+36>>2]=B(B(g>>>0)/h)+y,Q=C[r+56>>2],p=C[r+24>>2],C[u+32>>2]=B(B(l>>>0)/Q)+p,l=d[c+6>>1],g=d[c+8>>1],c=d[c+10>>1],t[u+60>>2]=0,C[u+56>>2]=G+B(B(c>>>0)/R),C[u+52>>2]=y+B(B(g>>>0)/h),C[u+48>>2]=p+B(B(l>>>0)/Q),l=o<<4,g=e+16|0,c=l+t[g>>2]|0,s=d[c>>1],D=d[c+2>>1],w=d[c+4>>1],t[u+12>>2]=0,R=C[e- -64>>2],G=C[e+32>>2],C[u+8>>2]=B(B(w>>>0)/R)+G,h=C[e+60>>2],y=C[e+28>>2],C[u+4>>2]=B(B(D>>>0)/h)+y,Q=C[e+56>>2],p=C[e+24>>2],C[u>>2]=B(B(s>>>0)/Q)+p,s=d[c+6>>1],D=d[c+8>>1],c=d[c+10>>1],t[u+28>>2]=0,C[u+24>>2]=G+B(B(c>>>0)/R),C[u+20>>2]=y+B(B(D>>>0)/h),C[u+16>>2]=p+B(B(s>>>0)/Q);A:{r:{e:{i:{a:{f:{n:{t:{b:{if(function(A,r,e,i){var a=B(0),f=B(0),n=B(0),t=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0);o:{k:{if(t=C[r+16>>2],f=B(B(t+C[r>>2])*B(.5)),y=C[e+16>>2],b=C[r+20>>2],a=B(B(b+C[r+4>>2])*B(.5)),Q=C[e+20>>2],o=C[r+24>>2],n=B(B(o+C[r+8>>2])*B(.5)),p=C[e+24>>2],k=C[A+16>>2],c=B(B(k+C[A>>2])*B(.5)),l=B(B(C[e>>2]+B(B(B(f*y)+B(a*Q))+B(n*p)))-c),k=B(k-c),t=B(t-f),d=C[e+64>>2],b=B(b-a),v=C[e+68>>2],o=B(o-n),g=C[e+72>>2],!(B(m(l))>B(k+B(B(B(t*d)+B(b*v))+B(o*g)))||(D=C[e+32>>2],w=C[e+36>>2],W=C[e+40>>2],u=C[A+20>>2],s=B(B(u+C[A+4>>2])*B(.5)),c=B(B(C[e+4>>2]+B(B(B(f*D)+B(a*w))+B(n*W)))-s),u=B(u-s),s=C[e+80>>2],_=C[e+84>>2],R=C[e+88>>2],B(m(c))>B(u+B(B(B(t*s)+B(b*_))+B(o*R)))||(F=C[e+48>>2],Z=C[e+52>>2],Y=C[e+56>>2],f=B(C[e+8>>2]+B(B(B(f*F)+B(a*Z))+B(n*Y))),a=C[A+24>>2],n=B(B(a+C[A+8>>2])*B(.5)),f=B(f-n),a=B(a-n),n=C[e+96>>2],G=C[e+100>>2],h=C[e+104>>2],B(m(f))>B(a+B(B(B(t*n)+B(b*G))+B(o*h)))|B(m(B(B(B(l*y)+B(c*D))+B(f*F))))>B(t+B(B(B(k*d)+B(u*s))+B(a*n)))|B(m(B(B(B(l*Q)+B(c*w))+B(f*Z))))>B(b+B(B(B(k*v)+B(u*_))+B(a*G))))))){if(A=B(m(B(B(B(l*p)+B(c*W))+B(f*Y))))>B(o+B(B(B(k*g)+B(u*R))+B(a*h))),e=1^A,!i|A)break o;if(!(!!(B(m(B(B(f*w)-B(c*Z))))>B(B(B(B(u*G)+B(a*_))+B(t*g))+B(o*d)))|B(m(B(B(f*D)-B(c*F))))>B(B(B(B(u*n)+B(a*s))+B(b*g))+B(o*v))|B(m(B(B(f*W)-B(c*Y))))>B(B(B(B(u*h)+B(a*R))+B(t*v))+B(b*d))|B(m(B(B(l*F)-B(f*y))))>B(B(B(B(k*n)+B(a*d))+B(b*R))+B(o*_))||B(m(B(B(l*Z)-B(f*Q))))>B(B(B(B(k*G)+B(a*v))+B(t*R))+B(o*s))|B(m(B(B(l*Y)-B(f*p))))>B(B(B(B(k*h)+B(a*g))+B(t*_))+B(b*s))|B(m(B(B(c*y)-B(l*D))))>B(B(B(B(k*s)+B(u*d))+B(b*h))+B(o*G))||B(m(B(B(c*Q)-B(l*w))))>B(B(B(B(k*_)+B(u*v))+B(t*h))+B(o*n))))break k;}e=0;break o;}if(e=0,!(B(m(B(B(c*p)-B(l*W))))>B(B(B(B(k*R)+B(u*g))+B(t*G))+B(b*n))))return 1;}return e;}(u+32|0,u,f,k)){if(c=t[12+(t[g>>2]+l|0)>>2],_=t[12+(_+t[v>>2]|0)>>2],(0|_)>=0){if((0|c)<0)break b;if(f=t[i+4>>2],(0|f)!=t[i+8>>2])break r;if(v=f?f<<1:1,(0|f)>=(0|v))break r;if(!v)break n;if(n=CA(v<<3,16),o=t[i+12>>2],f=t[i+4>>2],(0|f)<1)break f;break a;}if(k=n+1|0,(0|c)<0)break t;A(r,e,i,f,k,o,0),s=r,r=t[12+(t[r+16>>2]+(k<<4)|0)>>2],A(s,e,i,f,(0|r)>-1?n+2|0:k-r|0,o,0);}break A;}k=o+1|0,A(r,e,i,f,n,k,0),s=r,r=t[12+(t[e+16>>2]+(k<<4)|0)>>2],A(s,e,i,f,n,(0|r)>-1?o+2|0:k-r|0,0);break A;}c=o+1|0,A(r,e,i,f,k,c,0),o=o+2|0,_=c<<4,v=e+16|0,l=t[12+(_+t[v>>2]|0)>>2],A(r,e,i,f,k,(0|l)>-1?o:c-l|0,0),n=n+2|0,g=k<<4,l=r+16|0,s=t[12+(g+t[l>>2]|0)>>2],A(r,e,i,f,(0|s)>-1?n:k-s|0,c,0),s=r,r=t[12+(g+t[l>>2]|0)>>2],n=(0|r)>-1?n:k-r|0,r=t[12+(_+t[v>>2]|0)>>2],A(s,e,i,f,n,(0|r)>-1?o:c-r|0,0);break A;}if(n=0,o=t[i+12>>2],(0|f)>=1)break a;}if(!o)break e;break i;}for(e=o,r=n,k=f;l=t[e+4>>2],t[r>>2]=t[e>>2],t[r+4>>2]=l,e=e+8|0,r=r+8|0,k=k+-1|0,k;){}}b[i+16|0]&&(gA(o),f=t[i+4>>2]),t[i+12>>2]=0;}a[i+16|0]=1,t[i+12>>2]=n,t[i+8>>2]=v;}return t[i+4>>2]=f+1,r=t[i+12>>2]+(f<<3)|0,t[r+4>>2]=c,t[r>>2]=_,void(E=u- -64|0);}E=u- -64|0;}(A,e,f,n,0,0,1)),E=n+112|0;}function GA(A,r,e,i,a,f){var n=B(0),b=B(0),k=B(0),c=B(0),u=0,s=0,d=0,v=0,g=0,_=B(0),m=B(0),R=B(0),G=B(0),h=B(0);yf[t[t[A>>2]+8>>2]](A,r,a,f),n=C[e+8>>2],b=C[e+4>>2],c=C[a+8>>2],r=t[a+8>>2],_=C[a+4>>2],u=t[a+4>>2],m=C[a>>2],s=t[a>>2],R=C[f+8>>2],d=t[f+8>>2],G=C[f+4>>2],v=t[f+4>>2],h=C[f>>2],g=t[f>>2],k=C[e>>2],k>B(0)?(l(B(k+h)),g=o(0)):(l(B(k+m)),s=o(0)),b>B(0)?(l(B(b+G)),v=o(0)):(l(B(b+_)),u=o(0)),n>B(0)?(l(B(n+R)),d=o(0)):(l(B(n+c)),r=o(0)),n=C[i+8>>2],b=C[i>>2],k=C[i+4>>2],c=B(yf[t[t[A>>2]+16>>2]](A)),t[a+12>>2]=0,A=a+8|0,t[A>>2]=r,r=a+4|0,t[r>>2]=u,t[a>>2]=s,t[f+12>>2]=0,e=f+8|0,t[e>>2]=d,i=f+4|0,t[i>>2]=v,t[f>>2]=g,n=B(c*B(Q(B(B(B(b*b)+B(k*k))+B(n*n))))),C[a>>2]=C[a>>2]-n,C[r>>2]=C[r>>2]-n,C[A>>2]=C[A>>2]-n,C[f>>2]=n+C[f>>2],C[i>>2]=n+C[i>>2],C[e>>2]=n+C[e>>2];}function hA(A,r,e){var i,a;return A|=0,r|=0,e|=0,i=0|yf[t[t[e>>2]+40>>2]](e,A),a=0|yf[t[t[e>>2]+28>>2]](e,i),t[r>>2]=a,a&&yf[t[t[e>>2]+48>>2]](e,i),A=t[A+4>>2],t[r+8>>2]=0,t[r+4>>2]=A,5932;}function yA(A,r,e){A|=0,r|=0,e|=0;var i,a=B(0),f=0,n=B(0),b=B(0),o=B(0),k=0,c=B(0),u=0,l=0,s=B(0),d=B(0),v=B(0),g=0;i=E-48|0,E=i;A:{r:{e:{i:{a:{f:{n:{t:{b:{o:{k:{c:{u:{l:{s:if(f=t[r+4>>2],!(f>>>0>13)){switch(f-1|0){default:t[A+12>>2]=0,a=C[r+32>>2],C[A>>2]=C[e>>2]>=B(0)?a:B(-a),a=C[r+40>>2],C[A+8>>2]=C[e+8>>2]>=B(0)?a:B(-a),a=C[r+36>>2],C[A+4>>2]=C[e+4>>2]>=B(0)?a:B(-a);break A;case 12:break o;case 9:break k;case 7:break c;case 4:break u;case 3:break l;case 1:case 2:case 5:case 6:case 8:case 10:case 11:break s;case 0:}t[A+12>>2]=0,a=C[e>>2],b=C[e+4>>2],n=C[e+8>>2],o=B(B(B(a*C[r+76>>2])+B(b*C[r+80>>2]))+B(n*C[r+84>>2])),c=B(B(B(a*C[r+92>>2])+B(b*C[r+96>>2]))+B(n*C[r+100>>2])),e=r+60|0,a=B(B(B(a*C[e>>2])+B(b*C[r- -64>>2]))+B(n*C[r+68>>2])),r=((a<o?o<c?2:1:(a<c)<<1)<<4)+e|0,t[A+8>>2]=t[r+8>>2],e=t[r+4>>2],t[A>>2]=t[r>>2],t[A+4>>2]=e;break A;}yf[t[t[r>>2]+68>>2]](A,r,e);break A;}if(b=C[r+24>>2],n=C[r+20>>2],o=C[r+16>>2],k=t[r+108>>2],l=t[r+100>>2],(0|l)<1)break n;for(c=B(C[e+8>>2]*b),s=B(C[e+4>>2]*n),v=B(C[e>>2]*o),e=0,f=-1,a=B(-3.4028234663852886e38),r=k;d=B(B(B(v*C[r>>2])+B(s*C[r+4>>2]))+B(c*C[r+8>>2])),u=d>a,a=u?d:a,f=u?e:f,r=r+16|0,e=e+1|0,(0|l)!=(0|e);){}break r;}if(b=C[r+24>>2],n=C[r+20>>2],o=C[r+16>>2],k=t[r+96>>2],l=t[r+100>>2],(0|l)<1)break f;for(c=B(C[e+8>>2]*b),s=B(C[e+4>>2]*n),v=B(C[e>>2]*o),e=0,f=-1,a=B(-3.4028234663852886e38),r=k;d=B(B(B(v*C[r>>2])+B(s*C[r+4>>2]))+B(c*C[r+8>>2])),u=d>a,a=u?d:a,f=u?e:f,r=r+16|0,e=e+1|0,(0|l)!=(0|e);){}break r;}t[A>>2]=0,t[A+4>>2]=0,A=A+8|0,t[A>>2]=0,t[A+4>>2]=0;break A;}if(k=r,g=t[r+56>>2],r=g<<2,s=C[32+(k+r|0)>>2],a=C[e>>2],b=C[e+4>>2],n=C[e+8>>2],o=B(B(B(a*a)+B(b*b))+B(n*n)),!(o<B(1.4210854715202004e-14)))break b;o=B(0),n=B(1);break t;}if(k=r+40|0,u=t[k+4>>2],f=i+40|0,t[f>>2]=t[k>>2],t[f+4>>2]=u,f=t[r+36>>2],t[i+32>>2]=t[r+32>>2],t[i+36>>2]=f,t[i+28>>2]=0,t[i+16>>2]=t[e>>2],a=C[e+4>>2],t[i+20>>2]=t[e+4>>2],b=C[e+8>>2],t[i+24>>2]=t[e+8>>2],e=2,k=t[r+56>>2],2==(0|k))break a;if(a=b,f=1,r=1,1!=(0|k))break i;f=0;break e;}c=n,n=B(B(1)/B(Q(o))),c=B(c*n),o=B(b*n),n=B(a*n);}t[i+40>>2]=0,t[i+44>>2]=0,t[i+32>>2]=0,t[i+36>>2]=0,C[r+(i+32|0)>>2]=s,a=B(-0xde0b6b000000000),r=0,e=0,f=0,k=t[i+32>>2],u=t[i+36>>2],l=t[i+40>>2],b=B(B(B(n*C[i+32>>2])+B(o*C[i+36>>2]))+B(c*C[i+40>>2])),b>B(-0xde0b6b000000000)&&(f=l,e=u,a=b,r=k),t[i+40>>2]=0,t[i+44>>2]=0,t[i+32>>2]=0,t[i+36>>2]=0,C[(i+32|0)+(g<<2)>>2]=-s,k=t[i+32>>2],u=t[i+36>>2],l=t[i+40>>2],B(B(B(n*C[i+32>>2])+B(o*C[i+36>>2]))+B(c*C[i+40>>2]))>a&&(f=l,e=u,r=k),t[A+12>>2]=0,t[A+8>>2]=f,t[A+4>>2]=e,t[A>>2]=r;break A;}f=-1;break r;}f=-1;break r;}f=0,r=2,e=1;break e;}r=0;}return b=C[(i+32|0)+(k<<2)>>2],f<<=2,o=C[(f|i+32)>>2],c=C[(f|i+16)>>2],s=B(Q(B(B(c*c)+B(a*a)))),s==B(0)?(C[(i|f)>>2]=o,r<<=2,C[r+i>>2]=C[r+(i+16|0)>>2]<B(0)?B(-b):b):(n=B(o/s),C[(i|f)>>2]=c*n,r<<=2,C[r+i>>2]=C[r+(i+16|0)>>2]<B(0)?B(-b):b,n=B(a*n)),C[(e<<2)+i>>2]=n,t[A+12>>2]=0,t[A>>2]=t[i>>2],r=t[i+8>>2],t[A+4>>2]=t[i+4>>2],t[A+8>>2]=r,void(E=i+48|0);}t[A+12>>2]=0,r=k+(f<<4)|0,C[A+8>>2]=b*C[r+8>>2],C[A+4>>2]=n*C[r+4>>2],C[A>>2]=o*C[r>>2];}E=i+48|0;}function QA(A){var r=0;A:{r:if(r=t[A+4>>2],!(r>>>0>13)){switch(r-2|0){case 6:break A;case 0:case 1:case 4:case 5:case 7:case 10:break r;}return C[A+48>>2];}return B(yf[t[t[A>>2]+48>>2]](A));}return B(C[A+32>>2]*C[A+16>>2]);}function pA(A){return 12;}function DA(A){A|=0,gA(A);}function wA(A,r){var e;A|=0,r|=0,t[A>>2]=0,t[A+4>>2]=0,e=A+8|0,t[e>>2]=0,t[e+4>>2]=0,t[(t[r+56>>2]<<2)+A>>2]=1065353216;}function WA(A,r){r=B(r);}function FA(A){return 60;}function ZA(A){var r;t[A+12>>2]=-1,t[A+4>>2]=35,t[A+8>>2]=0,t[A>>2]=5988,t[A+48>>2]=1025758986,r=A+24|0,t[r>>2]=1065353216,t[r+4>>2]=0,t[A+16>>2]=1065353216,t[A+20>>2]=1065353216,t[A>>2]=6984;}function YA(A,r){A|=0,r|=0;var e=B(0),i=B(0),a=B(0);e=C[r>>2],i=C[r+4>>2],a=C[r+8>>2],t[A+28>>2]=0,C[A+24>>2]=m(a),C[A+20>>2]=m(i),C[A+16>>2]=m(e);}function EA(A){A|=0;var r=0,e=0,i=0,f=0,n=0,o=0,k=0;if(t[A>>2]=7120,r=A+56|0,e=t[r>>2],e&&(b[A+60|0]&&gA(e),t[A+56>>2]=0),t[r>>2]=0,a[A+60|0]=1,r=A+48|0,t[r>>2]=0,t[r+4>>2]=0,i=t[A+28>>2],(0|i)>=1)for(o=A+36|0,e=8;r=t[o>>2]+e|0,k=r+-4|0,f=r+4|0,n=t[f>>2],n&&(b[r+8|0]&&gA(n),t[f>>2]=0),t[k>>2]=0,t[f>>2]=0,t[r>>2]=0,a[r+8|0]=1,e=e+36|0,i=i+-1|0,i;){}return r=A+36|0,e=t[r>>2],e&&(b[A+40|0]&&gA(e),t[A+36>>2]=0),t[r>>2]=0,a[A+40|0]=1,r=A+28|0,t[r>>2]=0,t[r+4>>2]=0,r=A+16|0,e=t[r>>2],e&&(b[A+20|0]&&gA(e),t[A+16>>2]=0),t[r>>2]=0,a[A+20|0]=1,r=A+8|0,t[r>>2]=0,t[r+4>>2]=0,0|A;}function NA(A){var r,e,i,a,f,n,b,o,k,c=B(0),u=B(0),l=B(0),s=0,d=0,v=0;for(o=t[A+28>>2],r=(0|o)<1,k=A+36|0,e=A+72|0,i=A+88|0,a=A+68|0,f=A+84|0,n=A- -64|0,b=A+80|0;;){A:{r:{e:{if(s>>>0<=7){switch(s-1|0){case 0:if(c=B(C[e>>2]-C[i>>2]),u=B(C[f>>2]+C[a>>2]),l=B(C[b>>2]+C[n>>2]),!r)break e;break r;case 1:if(c=B(C[i>>2]+C[e>>2]),u=B(C[a>>2]-C[f>>2]),l=B(C[b>>2]+C[n>>2]),!r)break e;break r;case 2:if(c=B(C[e>>2]-C[i>>2]),u=B(C[a>>2]-C[f>>2]),l=B(C[b>>2]+C[n>>2]),!r)break e;break r;case 3:if(c=B(C[i>>2]+C[e>>2]),u=B(C[f>>2]+C[a>>2]),l=B(C[n>>2]-C[b>>2]),!r)break e;break r;case 4:if(c=B(C[e>>2]-C[i>>2]),u=B(C[f>>2]+C[a>>2]),l=B(C[n>>2]-C[b>>2]),!r)break e;break r;case 5:if(c=B(C[i>>2]+C[e>>2]),u=B(C[a>>2]-C[f>>2]),l=B(C[n>>2]-C[b>>2]),!r)break e;break r;case 6:if(c=B(C[e>>2]-C[i>>2]),u=B(C[a>>2]-C[f>>2]),l=B(C[n>>2]-C[b>>2]),!r)break e;break r;}u=B(C[f>>2]+C[a>>2]),l=B(C[b>>2]+C[n>>2]),c=B(C[i>>2]+C[e>>2]);}if(r)break r;}for(A=t[k>>2]+20|0,v=0,d=0;;){if(B(C[A+12>>2]+B(B(B(l*C[A>>2])+B(u*C[A+4>>2]))+B(c*C[A+8>>2])))>B(0))break A;if(A=A+36|0,d=d+1|0,!((0|d)<(0|o)))break;}}if(v=1,s=s+1|0,s>>>0<8)continue;}break;}return v;}function VA(A){var r,e,i,n,k,c=0,u=B(0),s=0,g=0,R=0,G=B(0),h=0,y=B(0),p=0,D=0,w=B(0),W=B(0),F=B(0),Z=0,Y=0,N=B(0),V=B(0),I=B(0),J=B(0),X=B(0),M=0,x=0,S=0,T=0,U=0,j=0,O=0,H=0,z=0,P=B(0),L=0,K=B(0),q=B(0),$=B(0),AA=0,rA=0,eA=0,iA=0,aA=0,fA=0,nA=0,tA=0,bA=0,oA=0,kA=B(0),cA=B(0),uA=B(0),lA=B(0),sA=B(0),dA=B(0),vA=0,_A=0,BA=0,mA=0,RA=0,GA=0,hA=B(0);r=E-96|0,E=r,t[A+64>>2]=0,t[A+68>>2]=0,a[r+52|0]=1,i=r+48|0,t[i>>2]=0,a[r+72|0]=1,c=r+40|0,t[c>>2]=0,t[c+4>>2]=0,n=r+68|0,t[n>>2]=0,a[r+92|0]=1,c=r+60|0,t[c>>2]=0,t[c+4>>2]=0,k=r+88|0,t[k>>2]=0,c=r+80|0,t[c>>2]=0,t[c+4>>2]=0,e=A+72|0,c=e,t[c>>2]=0,t[c+4>>2]=0,t[r+28>>2]=0,a[r+32|0]=1,t[r+20>>2]=0,t[r+24>>2]=0;A:if(AA=A+28|0,p=t[AA>>2],!((0|p)<1))for(vA=r- -64|0,_A=r+28|0,S=A+56|0,rA=A+60|0;;){r:{e:{if(!s){if(eA=A+36|0,s=t[eA>>2],iA=_(U,36),aA=t[4+(s+iA|0)>>2],(0|aA)>=1){for(j=0;;){c=t[12+(s+iA|0)>>2],h=t[c+(j<<2)>>2],f[r+8>>1]=h,j=j+1|0,H=(0|j)==(0|aA),g=t[c+((H?0:j)<<2)>>2],f[r+10>>1]=g,z=0,c=g<<16>>16,R=h<<16>>16,(0|c)>(0|R)&&(f[r+10>>1]=h,f[r+8>>1]=g,R=g,c=h),Z=c<<16,Y=R<<16>>16,g=Z+Y&t[vA>>2]+-1;i:if(!(g>>>0>=v[r+20>>2])&&(s=t[t[_A>>2]+(g<<2)>>2],-1!=(0|s))){for(M=t[i>>2],h=t[k>>2];;){if(p=s<<2,g=p+h|0,d[g+2>>1]!=(65535&c)||d[g>>1]!=(65535&R)){if(s=t[p+M>>2],-1!=(0|s))continue;break i;}break;}z=p+t[n>>2]|0;}c=t[A+16>>2],g=c+(Z>>16<<4)|0,c=c+(Y<<4)|0,u=B(C[g+8>>2]-C[c+8>>2]),P=u,w=B(C[g>>2]-C[c>>2]),G=B(C[g+4>>2]-C[c+4>>2]),u=B(B(1)/B(Q(B(B(B(w*w)+B(G*G))+B(u*u))))),X=B(P*u),W=B(G*u),F=B(w*u),Z=A+48|0,R=t[Z>>2];i:{if((0|R)>=1)for(s=t[S>>2],D=0;;){if(w=C[s+8>>2],u=C[s>>2],G=C[s+4>>2],(+B(m(B(w-X)))>1e-6^1?!(+B(m(B(u-F)))>1e-6|+B(m(B(G-W)))>1e-6):0)|(+B(m(B(X+w)))>1e-6^1?!(+B(m(B(F+u)))>1e-6|+B(m(B(W+G)))>1e-6):0))break i;if(s=s+16|0,D=D+1|0,!((0|D)<(0|R)))break;}if(M=A+52|0,t[M>>2]==(0|R)&&(Y=R?R<<1:1,!((0|R)>=(0|Y)))){a:{f:{if(Y){if(p=CA(Y<<4,16),R=t[Z>>2],(0|R)>=1)break f;break a;}if(p=0,(0|R)<1)break a;}for(s=0;g=t[S>>2]+s|0,c=t[g+4>>2],h=s+p|0,t[h>>2]=t[g>>2],t[h+4>>2]=c,g=g+8|0,c=t[g+4>>2],h=h+8|0,t[h>>2]=t[g>>2],t[h+4>>2]=c,s=s+16|0,R=R+-1|0,R;){}}c=t[S>>2],c&&(b[0|rA]&&gA(c),t[S>>2]=0),t[S>>2]=p,a[0|rA]=1,t[M>>2]=Y,R=t[Z>>2];}c=t[S>>2]+(R<<4)|0,t[c+12>>2]=0,C[c+8>>2]=X,C[c+4>>2]=W,C[c>>2]=F,t[Z>>2]=t[Z>>2]+1;}i:{a:{if(z){if(f[z+2>>1]=U,!H)break a;break i;}if(f[r>>1]=U,f[r+2>>1]=65535,IA(r+16|0,r+8|0,r),H)break i;}s=t[eA>>2];continue;}break;}p=t[AA>>2];}if(U=U+1|0,(0|U)<(0|p))break e;if(fA=0,nA=1,(0|p)<1)break A;fA=(0|p)>0,L=t[A+16>>2],BA=36,mA=t[A+36>>2],y=B(0),O=0,RA=3,T=4,GA=8,tA=A+72|0,bA=A+68|0,oA=A- -64|0,x=2,hA=B(.5),N=B(.3333333432674408),s=1;continue;}if(c=_(O,BA)+mA|0,Z=t[c+4>>2],(0|Z)>=(0|RA))for(Y=t[c+12>>2],s=Y+T|0,M=(t[Y>>2]<<T)+L|0,g=M+GA|0,c=M+T|0,V=C[tA>>2],I=C[bA>>2],J=C[oA>>2],D=2;R=(t[s>>2]<<T)+L|0,kA=C[R+8>>2],h=(t[Y+((0|D)%(0|Z)<<x)>>2]<<T)+L|0,cA=C[h+8>>2],K=C[M>>2],uA=C[R>>2],lA=B(K-uA),q=C[c>>2],sA=C[h+4>>2],X=B(q-sA),W=C[R+4>>2],u=B(q-W),F=C[h>>2],w=B(K-F),dA=B(B(lA*X)-B(u*w)),$=C[g>>2],G=B($-cA),P=B(u*G),u=B($-kA),X=B(P-B(u*X)),u=B(B(u*w)-B(lA*G)),u=B(B(Q(B(B(dA*dA)+B(B(X*X)+B(u*u)))))*hA),V=B(V+B(B(B(B($+kA)+cA)*N)*u)),C[tA>>2]=V,I=B(I+B(B(B(sA+B(q+W))*N)*u)),C[bA>>2]=I,J=B(J+B(B(B(F+B(K+uA))*N)*u)),C[oA>>2]=J,y=B(y+u),s=s+T|0,D=D+nA|0,(0|Z)!=(0|D);){}if(O=O+nA|0,(0|O)!=(0|p))break r;break A;}s=0;continue;}s=1;}if(t[A+96>>2]=2139095039,u=B(B(1)/y),c=A- -64|0,W=B(u*C[c>>2]),C[c>>2]=W,c=A+68|0,F=B(u*C[c>>2]),C[c>>2]=F,w=B(u*C[e>>2]),C[e>>2]=w,G=B(3.4028234663852886e38),y=B(3.4028234663852886e38),fA)for(s=t[A+36>>2]+20|0,c=A+96|0;u=B(m(B(C[s+12>>2]+B(B(B(W*C[s>>2])+B(F*C[s+4>>2]))+B(w*C[s+8>>2]))))),u<y&&(C[c>>2]=u,y=u),s=s+36|0,p=p+-1|0,p;){}if(c=t[A+8>>2],(0|c)>=1)for(s=t[A+16>>2],W=B(-3.4028234663852886e38),D=0,V=B(3.4028234663852886e38),I=B(-3.4028234663852886e38),J=B(-3.4028234663852886e38),N=B(3.4028234663852886e38);u=C[s+8>>2],W=u>W?u:W,N=u<N?u:N,u=C[s+4>>2],I=u>I?u:I,G=u<G?u:G,u=C[s>>2],J=u>J?u:J,V=u<V?u:V,s=s+16|0,D=D+1|0,(0|D)<(0|c);){}else J=B(-3.4028234663852886e38),N=B(3.4028234663852886e38),I=B(-3.4028234663852886e38),W=B(-3.4028234663852886e38),V=B(3.4028234663852886e38);s=0,t[A+128>>2]=0,F=B(W-N),C[A+124>>2]=F,w=B(I-G),C[A+120>>2]=w,u=B(J-V),C[A+116>>2]=u,t[A+112>>2]=0,C[A+108>>2]=N+W,C[A+104>>2]=G+I,C[A+100>>2]=J+V,g=u<w?w<F?2:1:(u<F)<<1,c=g<<2,u=C[c+(A+116|0)>>2],y=B(y/B(1.7320507764816284)),C[A+80>>2]=y,C[A+84>>2]=y,C[A+88>>2]=y,c=c+(A+80|0)|0,G=B(u*B(.5)),C[c>>2]=G,u=B(B(G-y)*B(.0009765625));A:{r:{e:{for(;;){if(NA(A))break e;if(G=B(G-u),C[c>>2]=G,s=s+1|0,!(s>>>0<1024))break;}if(C[A+84>>2]=y,C[A+88>>2]=y,C[A+80>>2]=y,s=r+88|0,D=t[s>>2],D)break r;break A;}c=A+80|0,g=1<<g&3,x=c+((1<<g&3)<<2)|0,p=t[x>>2],h=c+(g<<2)|0,c=h,g=t[c>>2],y=B(B(C[A+96>>2]-y)*B(.0009765625)),C[c>>2]=y+C[c>>2],G=B(y+C[x>>2]),C[x>>2]=G;e:{if(NA(A)){for(R=0;;){if(u=G,R=R+1|0,R>>>0>1023)break e;if(g=t[h>>2],C[h>>2]=y+C[h>>2],G=B(y+C[x>>2]),C[x>>2]=G,!NA(A))break;}l(u),p=o(0);}t[h>>2]=g,t[x>>2]=p;}if(s=r+88|0,D=t[s>>2],!D)break A;}b[r+92|0]&&gA(D),t[r+88>>2]=0;}t[s>>2]=0,a[r+92|0]=1,A=r+80|0,t[A>>2]=0,t[A+4>>2]=0,c=r+68|0,A=t[c>>2],A&&(b[r+72|0]&&gA(A),t[r+68>>2]=0),t[c>>2]=0,a[r+72|0]=1,A=r+60|0,t[A>>2]=0,t[A+4>>2]=0,c=r+48|0,A=t[c>>2],A&&(b[r+52|0]&&gA(A),t[r+48>>2]=0),t[c>>2]=0,a[r+52|0]=1,A=r+40|0,t[A>>2]=0,t[A+4>>2]=0,A=t[r+28>>2],A&&(b[r+32|0]&&gA(A),t[r+28>>2]=0),E=r+96|0;}function IA(A,r,e){var i=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,C=0,g=0,_=0;A:{r:{e:{i:{a:{if(o=f[r>>1],n=d[r+2>>1],C=t[A+48>>2],_=o+(n<<16)&C+-1,!(_>>>0>=v[A+4>>2])&&(i=t[t[A+12>>2]+(_<<2)>>2],-1!=(0|i)))for(k=t[A+72>>2],o&=65535,u=A+32|0;;){if(s=i<<2,l=s+k|0,d[l+2>>1]==(0|n)&&d[l>>1]==(0|o))break a;if(i=t[s+t[u>>2]>>2],-1==(0|i))break;}if(u=A+44|0,s=t[u>>2],i=s,(0|i)!=(0|C))break A;if(i=C,k=i?i<<1:1,(0|i)>=(0|k))break A;if(!k)break i;if(o=CA(k<<2,16),n=t[A+44>>2],(0|n)>=1)break e;break r;}return A=t[A+52>>2]+(i<<2)|0,r=d[e>>1]|d[e+2>>1]<<16,f[A>>1]=r,void(f[A+2>>1]=r>>>16);}if(o=0,n=C,(0|n)<1)break r;}for(i=0,l=A+52|0;c=i+o|0,g=t[l>>2]+i|0,g=d[g>>1]|d[g+2>>1]<<16,f[c>>1]=g,f[c+2>>1]=g>>>16,i=i+4|0,n=n+-1|0,n;){}}i=A+52|0,n=t[i>>2],n&&(b[A+56|0]&&gA(n),t[A+52>>2]=0),t[i>>2]=o,a[A+56|0]=1,t[A+48>>2]=k,i=t[A+44>>2];}if(i=t[A+52>>2]+(i<<2)|0,e=d[e>>1]|d[e+2>>1]<<16,f[i>>1]=e,f[i+2>>1]=e>>>16,t[u>>2]=t[u>>2]+1,k=A- -64|0,n=t[k>>2],(0|n)==t[A+68>>2]&&(e=n?n<<1:1,!((0|n)>=(0|e)))){A:{r:{if(e){if(o=CA(e<<2,16),n=t[A- -64>>2],(0|n)>=1)break r;break A;}if(o=0,(0|n)<1)break A;}for(i=0,u=A+72|0;l=i+o|0,c=t[u>>2]+i|0,c=d[c>>1]|d[c+2>>1]<<16,f[l>>1]=c,f[l+2>>1]=c>>>16,i=i+4|0,n=n+-1|0,n;){}}i=A+72|0,n=t[i>>2],n&&(b[A+76|0]&&gA(n),t[A+72>>2]=0),t[i>>2]=o,a[A+76|0]=1,t[A+68>>2]=e,n=t[A- -64>>2];}e=t[A+72>>2]+(n<<2)|0,i=d[r>>1]|d[r+2>>1]<<16,f[e>>1]=i,f[e+2>>1]=i>>>16,t[k>>2]=t[k>>2]+1,e=A+48|0,(0|C)<t[e>>2]&&(function(A){var r=0,e=0,i=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0;if(c=t[A+4>>2],i=t[A+48>>2],!((0|c)>=(0|i))){A:{r:{e:{i:{a:{if(t[A+8>>2]<(0|i)){if(!i)break a;if(n=CA(i<<2,16),o=t[A+12>>2],e=t[A+4>>2],(0|e)<1)break i;break e;}n=t[A+12>>2];break A;}if(o=t[A+12>>2],e=c,(0|e)>=1)break e;}if(o)break r;a[A+16|0]=1,t[A+12>>2]=n,t[A+8>>2]=i;break A;}for(k=n,r=o;t[k>>2]=t[r>>2],k=k+4|0,r=r+4|0,e=e+-1|0,e;){}}b[A+16|0]&&gA(o),t[A+12>>2]=n,a[A+16|0]=1,t[A+8>>2]=i;}if(r=c<<2,u=i<<2,x(r+n|0,0,u-r|0),t[A+4>>2]=i,s=A+24|0,l=t[s>>2],(0|l)<(0|i)){A:{r:{e:{if(t[A+28>>2]<(0|i)){if(!i)break e;n=CA(u,16),o=t[A+24>>2];break r;}n=t[A+32>>2];break A;}n=0,o=l;}e=o,o=t[A+32>>2];r:{if((0|e)>=1)for(k=n,r=o;t[k>>2]=t[r>>2],k=k+4|0,r=r+4|0,e=e+-1|0,e;){}else if(!o)break r;r=A+36|0,b[0|r]&&gA(o),t[A+32>>2]=n,a[0|r]=1,t[A+28>>2]=i;break A;}t[A+32>>2]=n,a[A+36|0]=1,t[A+28>>2]=i;}r=l<<2,x(r+n|0,0,u-r|0);}if(t[s>>2]=i,(0|i)>=1&&(x(t[A+12>>2],255,u),x(t[A+32>>2],255,u)),!((0|c)<1))for(r=t[A+32>>2],o=t[A+12>>2],k=t[A+72>>2],e=0,n=A+48|0;A=o+((f[k>>1]+(d[k+2>>1]<<16)&t[n>>2]+-1)<<2)|0,t[r>>2]=t[A>>2],t[A>>2]=e,k=k+4|0,r=r+4|0,e=e+1|0,(0|e)!=(0|c);){}}}(A),_=f[r>>1]+(d[r+2>>1]<<16)&t[e>>2]+-1),r=t[A+32>>2]+(s<<2)|0,A=t[A+12>>2]+(_<<2)|0,t[r>>2]=t[A>>2],t[A>>2]=s;}function JA(A,r,e,i,a,f,n){var b,o=B(0),k=0,c=0,u=B(0),l=0,s=B(0),d=B(0),v=B(0),g=0,_=0,m=0,R=0,G=0,h=0,y=0,Q=0,p=0;b=E-16|0,t[i>>2]=2139095039,k=-8388609,t[a>>2]=-8388609,c=t[A+8>>2];A:{if((0|c)>=1){for(g=r+20|0,_=r+24|0,m=r+52|0,R=r+48|0,G=r+36|0,h=r+32|0,y=r+40|0,Q=r+56|0,p=f+12|0,k=4;;){r:{e:{l=t[A+16>>2]+k|0,o=C[l+-4>>2],u=C[l>>2],s=C[l+4>>2],d=B(B(B(B(o*C[r>>2])+B(u*C[r+4>>2]))+B(s*C[r+8>>2]))+C[R>>2]),v=B(B(B(B(o*C[r+16>>2])+B(u*C[g>>2]))+B(s*C[_>>2]))+C[m>>2]),u=B(B(B(B(o*C[h>>2])+B(u*C[G>>2]))+B(s*C[y>>2]))+C[Q>>2]),o=B(B(B(d*C[e>>2])+B(v*C[e+4>>2]))+B(u*C[e+8>>2]));i:{if(!(o<C[i>>2])){if(o>C[a>>2])break i;break e;}if(C[i>>2]=o,t[p>>2]=0,C[f+8>>2]=u,C[f+4>>2]=v,C[f>>2]=d,!(o>C[a>>2]))break e;}if(C[a>>2]=o,t[n+12>>2]=0,C[n+8>>2]=u,C[n+4>>2]=v,C[n>>2]=d,k=k+16|0,c=c+-1|0,c)continue;break r;}if(k=k+16|0,c=c+-1|0,c)continue;}break;}if(k=t[a>>2],o=C[i>>2],!(o>C[a>>2]))break A;}else if(o=C[i>>2],!(o>B(-3.4028234663852886e38)))break A;t[i>>2]=k,C[a>>2]=o,A=f+8|0,r=t[A>>2],e=t[A+4>>2],i=n+8|0,a=i,k=t[a+4>>2],t[A>>2]=t[a>>2],t[A+4>>2]=k,A=t[f>>2],a=t[f+4>>2],k=t[n+4>>2],t[f>>2]=t[n>>2],t[f+4>>2]=k,f=b+8|0,t[f>>2]=r,t[f+4>>2]=e,t[n>>2]=A,t[n+4>>2]=a,t[i>>2]=r,t[i+4>>2]=e,t[b>>2]=A,t[b+4>>2]=a;}}function XA(A,r){var e,i=0,f=0,n=0,o=B(0),k=0,c=0,u=B(0),l=B(0),s=0,d=0,v=0,g=0,_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=0,p=0,D=0,w=0,W=0,F=0,Z=0,Y=B(0),E=B(0),N=0,V=0,I=0,J=0,X=0,M=0;if(e=t[A+4>>2],(0|e)>=1)for(w=A+12|0;;){A:if(d=p,p=d+1|0,!((0|p)>=(0|e)))for(v=t[w>>2],W=v+(d<<4)|0,V=W+8|0,I=W+4|0,J=p,d=p+1|0,i=(0|d)<(0|e)?1:0;;){if(i){for(Z=(J<<4)+v|0,X=Z+8|0,M=Z+4|0,F=d;;){m=C[W>>2],u=B(C[Z>>2]-m),i=(F<<4)+v|0,Y=C[I>>2],l=B(C[i+4>>2]-Y),o=B(C[M>>2]-Y),R=B(C[i>>2]-m),_=B(B(u*l)-B(o*R)),G=o,E=C[V>>2],o=B(C[i+8>>2]-E),h=B(C[X>>2]-E),G=B(B(G*o)-B(h*l)),R=B(B(h*R)-B(u*o)),h=B(B(_*_)+B(B(G*G)+B(R*R))),D=h>B(9999999747378752e-20)^1;r:if(!D){if(o=B(B(1)/B(Q(h))),u=B(_*o),l=B(R*o),o=B(G*o),s=r+4|0,f=t[s>>2],(0|f)>=1)for(i=t[r+12>>2],n=0;;){if(B(B(B(o*C[i>>2])+B(l*C[i+4>>2]))+B(u*C[i+8>>2]))>B(.9990000128746033))break r;if(i=i+16|0,n=n+1|0,!((0|n)<(0|f)))break;}if(m=B(B(B(o*m)+B(l*Y))+B(u*E)),n=t[A+4>>2],(0|n)>=1)for(i=0;;){if(B(B(B(B(B(o*C[v>>2])+B(l*C[v+4>>2]))+B(u*C[v+8>>2]))-m)+B(-.009999999776482582))>B(0))break r;if(v=v+16|0,i=i+1|0,!((0|i)<(0|n)))break;}if(m=B(-m),y=r+8|0,t[y>>2]==(0|f)&&(n=f?f<<1:1,!((0|f)>=(0|n)))){e:{i:{if(n){if(g=CA(n<<4,16),f=t[s>>2],(0|f)>=1)break i;break e;}if(g=0,(0|f)<1)break e;}for(i=0;k=t[r+12>>2]+i|0,N=t[k+4>>2],c=i+g|0,t[c>>2]=t[k>>2],t[c+4>>2]=N,k=k+8|0,N=t[k+4>>2],c=c+8|0,t[c>>2]=t[k>>2],t[c+4>>2]=N,i=i+16|0,f=f+-1|0,f;){}}i=r+12|0,f=t[i>>2],f&&(b[r+16|0]&&gA(f),t[i>>2]=0),t[i>>2]=g,a[r+16|0]=1,t[y>>2]=n,f=t[s>>2];}i=t[r+12>>2]+(f<<4)|0,C[i+12>>2]=m,C[i+8>>2]=u,C[i+4>>2]=l,C[i>>2]=o,t[s>>2]=t[s>>2]+1;}r:if(!D){if(o=B(B(1)/B(Q(h))),u=B(-B(_*o)),l=B(-B(R*o)),o=B(-B(G*o)),s=r+4|0,f=t[s>>2],(0|f)>=1)for(i=t[r+12>>2],n=0;;){if(B(B(B(C[i>>2]*o)+B(C[i+4>>2]*l))+B(C[i+8>>2]*u))>B(.9990000128746033))break r;if(i=i+16|0,n=n+1|0,!((0|n)<(0|f)))break;}if(_=B(B(B(C[W>>2]*o)+B(C[I>>2]*l))+B(C[V>>2]*u)),g=t[A+4>>2],(0|g)>=1)for(i=t[w>>2],n=0;;){if(B(B(B(B(B(C[i>>2]*o)+B(C[i+4>>2]*l))+B(C[i+8>>2]*u))-_)+B(-.009999999776482582))>B(0))break r;if(i=i+16|0,n=n+1|0,!((0|n)<(0|g)))break;}if(_=B(-_),D=r+8|0,t[D>>2]==(0|f)&&(n=f?f<<1:1,!((0|f)>=(0|n)))){e:{i:{if(n){if(g=CA(n<<4,16),f=t[s>>2],(0|f)>=1)break i;break e;}if(g=0,(0|f)<1)break e;}for(i=0;k=t[r+12>>2]+i|0,y=t[k+4>>2],c=i+g|0,t[c>>2]=t[k>>2],t[c+4>>2]=y,k=k+8|0,y=t[k+4>>2],c=c+8|0,t[c>>2]=t[k>>2],t[c+4>>2]=y,i=i+16|0,f=f+-1|0,f;){}}i=r+12|0,f=t[i>>2],f&&(b[r+16|0]&&gA(f),t[i>>2]=0),t[i>>2]=g,a[r+16|0]=1,t[D>>2]=n,f=t[s>>2];}i=t[r+12>>2]+(f<<4)|0,C[i+12>>2]=_,C[i+8>>2]=u,C[i+4>>2]=l,C[i>>2]=o,t[s>>2]=t[s>>2]+1;}if(F=F+1|0,(0|e)==(0|F))break;v=t[w>>2];}i=0;}else {if((0|d)==(0|e))break A;v=t[w>>2],J=d,d=d+1|0,i=(0|d)<(0|e)?1:0;}}if((0|e)==(0|p))break;}}function MA(A,r){var e,i=0,f=0,n=B(0),o=B(0),k=0,c=B(0),u=B(0),l=0,s=B(0),d=B(0),v=B(0),g=B(0),_=0,R=B(0),G=0,h=0,y=B(0),Q=0,p=0,D=0,w=0,W=B(0),F=B(0),Z=0,Y=0,E=B(0),N=0,V=0,I=0,J=0,X=0,M=0,x=0,S=0,T=0,U=0;if(e=t[A+4>>2],(0|e)>=1)for(Y=A+12|0;;){A:if(l=h,h=l+1|0,!((0|h)>=(0|e)))for(k=t[Y>>2],p=k+(l<<4)|0,X=p+12|0,M=p+4|0,x=p+8|0,I=h,l=h+1|0,i=(0|l)<(0|e)?1:0;;){if(i){for(D=(I<<4)+k|0,S=D+12|0,T=D+8|0,U=D+4|0,w=l;;){i=(w<<4)+k|0,o=C[i+4>>2],c=C[D>>2],d=C[U>>2],v=C[i>>2],g=B(B(o*c)-B(d*v)),u=C[i+8>>2],R=C[T>>2],W=B(B(d*u)-B(R*o)),F=B(B(R*v)-B(u*c));r:if(B(B(g*g)+B(B(W*W)+B(F*F)))>B(9999999747378752e-20)&&(n=C[M>>2],s=C[p>>2],E=B(B(v*n)-B(o*s)),y=o,o=C[x>>2],y=B(B(y*o)-B(u*n)),v=B(B(u*s)-B(v*o)),B(B(E*E)+B(B(y*y)+B(v*v)))>B(9999999747378752e-20)&&(u=B(B(d*s)-B(c*n)),d=B(B(R*n)-B(d*o)),c=B(B(c*o)-B(R*s)),B(B(u*u)+B(B(d*d)+B(c*c)))>B(9999999747378752e-20)&&(n=B(B(o*g)+B(B(n*F)+B(W*s))),B(m(n))>B(9.999999974752427e-7))))){if(n=B(B(-1)/n),s=C[i+12>>2],o=C[X>>2],R=B(g*o),g=C[S>>2],u=B(n*B(B(u*s)+B(R+B(E*g)))),c=B(n*B(B(c*s)+B(B(F*o)+B(v*g)))),n=B(n*B(B(d*s)+B(B(W*o)+B(y*g)))),f=t[A+4>>2],(0|f)>=1)for(i=0;;){if(B(B(C[k+12>>2]+B(B(B(n*C[k>>2])+B(c*C[k+4>>2]))+B(u*C[k+8>>2])))+B(-.009999999776482582))>B(0))break r;if(k=k+16|0,i=i+1|0,!((0|i)<(0|f)))break;}if(Q=r+4|0,f=t[Q>>2],J=r+8|0,(0|f)==t[J>>2]&&(Z=f?f<<1:1,!((0|f)>=(0|Z)))){e:{i:{if(Z){if(N=CA(Z<<4,16),f=t[Q>>2],(0|f)>=1)break i;break e;}if(N=0,(0|f)<1)break e;}for(i=0;G=t[r+12>>2]+i|0,V=t[G+4>>2],_=i+N|0,t[_>>2]=t[G>>2],t[_+4>>2]=V,G=G+8|0,V=t[G+4>>2],_=_+8|0,t[_>>2]=t[G>>2],t[_+4>>2]=V,i=i+16|0,f=f+-1|0,f;){}}i=r+12|0,f=t[i>>2],f&&(b[r+16|0]&&gA(f),t[i>>2]=0),t[i>>2]=N,a[r+16|0]=1,t[J>>2]=Z,f=t[Q>>2];}i=t[r+12>>2]+(f<<4)|0,t[i+12>>2]=0,C[i+8>>2]=u,C[i+4>>2]=c,C[i>>2]=n,t[Q>>2]=t[Q>>2]+1;}if(w=w+1|0,(0|e)==(0|w))break;k=t[Y>>2];}i=0;}else {if((0|l)==(0|e))break A;k=t[Y>>2],I=l,l=l+1|0,i=(0|l)<(0|e)?1:0;}}if((0|e)==(0|h))break;}}function xA(A,r){var e=0,i=0,a=0,f=0,n=0,b=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0;A:{if(s=t[A+16>>2],i=t[r+16>>2],(0|s)==(0|i)){if(!s)break A;return d=-1,n=t[A+4>>2],b=t[r+8>>2],o=t[r+12>>2],l=t[A>>2],c=Rf(o,0,l,0),k=N,o=Rf(o,a,n,0),e=o+k|0,i=N+f|0,f=e,e=e>>>0<o>>>0?i+1|0:i,o=0,n=Rf(b,o,n,a),i=f,f=N,a=i+f|0,a>>>0<f>>>0&&(e=e+1|0),i=a,f=e,a=0,e=n+c|0,e>>>0<n>>>0&&(a=a+1|0),c=a,a=a+i|0,i=f,i=a>>>0<c>>>0?i+1|0:i,f=a,a=e,c=0,b=Rf(b,o,l,v),n=c+b|0,e=N+e|0,e=n>>>0<b>>>0?e+1|0:e,C=n,b=n,n=e,a=(0|a)==(0|e)&b>>>0<c>>>0|e>>>0<a>>>0,e=f+a|0,e>>>0<a>>>0&&(i=i+1|0),c=e,b=i,o=e,l=i,a=t[A+8>>2],A=t[A+12>>2],e=t[r>>2],k=t[r+4>>2],i=0,v=a,f=Rf(k,i,a,0),r=N,u=A,a=0,k=Rf(k,i,A,a),A=r+k|0,i=N,i=A>>>0<k>>>0?i+1|0:i,r=A,k=e,A=Rf(e,0,u,a),u=N,r=u+r|0,e=i,e=r>>>0<u>>>0?e+1|0:e,a=e,i=0,e=A+f|0,e>>>0<A>>>0&&(i=i+1|0),u=i,f=i+r|0,i=a,r=f,a=r>>>0<u>>>0?i+1|0:i,u=r,r=0,f=Rf(k,0,v,0),A=r+f|0,i=e,e=e+N|0,e=A>>>0<f>>>0?e+1|0:e,f=A,A=e,r=(0|i)==(0|e)&f>>>0<r>>>0|e>>>0<i>>>0,i=u+r|0,i>>>0<r>>>0&&(a=a+1|0),e=i,r=a,(0|a)==(0|l)&o>>>0<e>>>0|l>>>0<a>>>0||(d=1,(0|r)==(0|b)&c>>>0>i>>>0|b>>>0>r>>>0||(d=-1,(0|A)==(0|n)&C>>>0<f>>>0|n>>>0<A>>>0||(d=(0|A)==(0|n)&C>>>0>f>>>0|n>>>0>A>>>0))),_(d,s);}return s-i|0;}return 0;}function SA(A,r,e){var i=0,a=0,f=0,n=0,b=0,o=0,k=0,c=0;if(f=A+56|0,n=t[f>>2],!(n||(i=A+52|0,a=t[i>>2],a?t[i>>2]=t[a+8>>2]:(a=CA(12,16),t[a+8>>2]=0,i=t[A+60>>2],t[a+4>>2]=i,k=a,c=CA(_(i,24),16),t[k>>2]=c,i=t[A+48>>2],t[A+48>>2]=a,t[a+8>>2]=i),n=t[a>>2],b=t[a+4>>2],(0|b)<1)))for(a=0,i=n;o=i,i=i+24|0,a=a+1|0,t[o>>2]=(0|a)<(0|b)?i:0,(0|a)!=(0|b);){}if(t[f>>2]=t[n>>2],i=n+16|0,t[i>>2]=0,t[i+4>>2]=0,i=n+8|0,t[i>>2]=0,t[i+4>>2]=0,t[n>>2]=0,t[n+4>>2]=0,f=t[f>>2],!(f||(i=A+52|0,a=t[i>>2],a?t[i>>2]=t[a+8>>2]:(a=CA(12,16),t[a+8>>2]=0,i=t[A+60>>2],t[a+4>>2]=i,k=a,c=CA(_(i,24),16),t[k>>2]=c,i=t[A+48>>2],t[A+48>>2]=a,t[a+8>>2]=i),f=t[a>>2],b=t[a+4>>2],(0|b)<1)))for(a=0,i=f;o=i,i=i+24|0,a=a+1|0,t[o>>2]=(0|a)<(0|b)?i:0,(0|a)!=(0|b);){}return t[A+56>>2]=t[f>>2],t[f>>2]=0,t[f+4>>2]=0,t[n+8>>2]=f,t[n+12>>2]=e,t[n+16>>2]=0,e=t[A+100>>2],t[n+20>>2]=e,t[f+8>>2]=n,t[f+12>>2]=r,t[f+16>>2]=0,t[f+20>>2]=e,r=t[A+116>>2],e=r+1|0,t[A+116>>2]=e,(0|r)>=t[A+120>>2]&&(t[A+120>>2]=e),n;}function TA(A,r,e,i){var a,f=0,n=0,b=0,o=0,k=0,c=0,u=0;a=E-16|0,E=a;A:{r:{e:{i:{if(f=e-r|0,2!=(0|f)){if(1==(0|f))break i;if(f)break e;t[i>>2]=0,t[i+4>>2]=0,A=i+8|0,t[A>>2]=0,t[A+4>>2]=0;break A;}if(e=t[t[A+92>>2]+(r<<2)>>2],f=t[e+204>>2],o=t[e+88>>2],b=t[e+200>>2],n=t[e+92>>2],(0|o)!=(0|b)|(0|n)!=(0|f))break r;if(f=n,t[e+96>>2]!=t[e+208>>2])break r;t[e+8>>2]=0,t[i+12>>2]=e,t[i+8>>2]=e,t[i+4>>2]=e,t[i>>2]=e,t[e+4>>2]=e,t[e>>2]=e;break A;}A=t[t[A+92>>2]+(r<<2)>>2],t[A+8>>2]=0,t[i+12>>2]=A,t[i+8>>2]=A,t[i+4>>2]=A,t[i>>2]=A,t[A+4>>2]=A,t[A>>2]=A;break A;}b=(0|f)/2|0,o=b+r|0,n=o;e:if(!((0|n)>=(0|e)))for(n=t[A+92>>2],f=t[(n+(o<<2)|0)-4>>2],k=t[f+88>>2],c=t[f+96>>2],u=t[f+92>>2],f=n+(r+b<<2)|0,n=o;;){if(b=t[f>>2],(0|k)!=t[b+88>>2]|t[b+92>>2]!=(0|u)|t[b+96>>2]!=(0|c))break e;if(f=f+4|0,n=n+1|0,!((0|n)<(0|e)))break;}TA(A,r,o,i),r=a+8|0,t[r>>2]=0,t[r+4>>2]=0,t[a>>2]=0,t[a+4>>2]=0,TA(A,n,e,a),function(A,r,e){var i=0,a=0,f=0,n=0,b=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0,g=0,B=0,m=0,R=0,G=0,h=0,y=0,Q=0,p=0,D=0,w=0,W=0,F=0,Z=0,Y=0,V=0,I=0,J=0,X=0,M=0,x=0,S=0,T=0,U=0,j=0,O=0,H=0,z=0,P=0,L=0,K=0,q=0;f=E-128|0,E=f;e:{i:if(t[e+4>>2]){if(!t[r+4>>2])break e;if(t[A+100>>2]=t[A+100>>2]+-1,t[f+124>>2]=0,t[f+120>>2]=0,r=function(A,r,e,i){var a=0,f=0,n=0,b=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0,g=0,B=0,m=0,R=0,G=0,h=0;a=t[A+12>>2],l=t[r+8>>2];a:{f:if(!(t[a+88>>2]!=t[l+88>>2]|t[a+92>>2]!=t[l+92>>2])){n:{if(f=t[l+4>>2],(0|l)!=(0|f)){if(a=t[l>>2],t[a+4>>2]=f,t[f>>2]=a,(0|l)==t[r>>2]&&(B=r,n=a,b=t[a+88>>2],o=t[f+88>>2],(0|b)<(0|o)|(t[a+92>>2]<t[f+92>>2]?(0|b)==(0|o):0)||(n=f),t[B>>2]=n),t[r+4>>2]!=(0|l))break f;if(n=t[a+88>>2],b=t[f+88>>2],(0|n)!=(0|b)|t[a+92>>2]<=t[f+92>>2]&&(0|n)<=(0|b))break n;t[r+4>>2]=a;break f;}if(t[e>>2]=a,A=t[l+8>>2],r=0,!A)break a;return t[i>>2]=t[A+12>>2],0;}t[r+4>>2]=f;}for(R=t[r>>2],h=t[A>>2],B=t[A+4>>2],f=B,G=t[r+4>>2],n=G,l=0,d=1;;){f:{if(k=t[f+88>>2],a=_(t[n+88>>2]-k|0,d),(0|a)>=1)c=f,b=0;else {if((0|a)>-1){b=t[f+92>>2];n:if(v)for(a=f;;){if(c=a,a=t[a>>2],(0|a)==(0|f)|(0|k)!=t[a+88>>2])break n;if(o=t[a+92>>2],s=(0|o)>(0|b),b=o,s)break;}else for(a=f;;){if(c=a,a=t[a+4>>2],(0|a)==(0|f)|(0|k)!=t[a+88>>2])break n;if(o=t[a+92>>2],s=(0|o)<=(0|b),b=o,!s)break;}if(a=t[n+92>>2],v){for(f=n;;){if(b=f,f=t[f+4>>2],(0|n)==(0|f)|(0|k)!=t[f+88>>2])break f;if(o=t[f+92>>2],s=(0|o)<(0|a),a=o,s)break;}break f;}for(f=n;;){if(b=f,f=t[f>>2],(0|n)==(0|f)|(0|k)!=t[f+88>>2])break f;if(o=t[f+92>>2],s=(0|o)>=(0|a),a=o,!s)break;}break f;}b=1;}for(;;){n:{t:{b:{if(!b){for(b=n,k=t[n+92>>2],o=a;n=t[c+92>>2],s=k-n|0,u=!v<<2,a=t[u+c>>2],!((0|a)==(0|c)||(g=t[a+92>>2]-n|0,(0|g)>0||(C=t[a+88>>2],n=_(C-t[c+88>>2]|0,d),(0|n)>-1|(0|_(o,g))>(0|_(n,s))&&n)));){o=_(t[b+88>>2]-C|0,d),c=a;}if(n=t[b+u>>2],(0|b)==(0|n))break f;if(u=t[n+92>>2]-k|0,(0|u)>-1)break f;if(k=t[n+88>>2],a=_(k-t[c+88>>2]|0,d),(0|a)<1)break f;if(k=_(k-t[b+88>>2]|0,d),!k)break b;if((0|k)>-1)break f;if((0|_(o,u))<(0|_(k,s)))break t;break f;}for(k=t[n+92>>2],g=(0!=(0|v))<<2,b=t[g+n>>2];;){if(o=a,c=f,a=t[f+92>>2],s=k-a|0,(0|n)!=(0|b)&&(u=t[b+92>>2]-k|0,!((0|u)<0))){if(C=t[b+88>>2],f=_(C-t[n+88>>2]|0,d),!f)break n;if(!((0|f)>-1)&&(0|_(o,u))<=(0|_(f,s)))break n;}if(f=t[c+g>>2],(0|c)!=(0|f)&&(C=t[f+92>>2]-a|0,!((0|C)<1||(u=t[f+88>>2],a=_(t[n+88>>2]-u|0,d),(0|a)>-1)))){if(u=_(u-t[c+88>>2]|0,d),!u)continue;if(!((0|u)>-1)&&(0|_(o,C))<(0|_(s,u)))continue;}break;}b=n;break f;}b=0;continue;}b=0;continue;}a=_(C-t[c+88>>2]|0,d),n=b,f=c,b=1;}}if(f=v?c:h,n=v?b:R,m=v?m:c,l=v?l:b,d=v?d:-1,v=v+1|0,2==(0|v))break;}t[n>>2]=f,t[f+4>>2]=n,t[m>>2]=l,t[l+4>>2]=m,t[R+88>>2]<t[h+88>>2]&&(t[A>>2]=R),t[G+88>>2]>=t[B+88>>2]&&(t[A+4>>2]=G),t[A+12>>2]=t[r+12>>2],t[e>>2]=m,r=1;}return A=r,t[i>>2]=l,A;}(r,e,f+124|0,f+120|0),p=t[f+120>>2],r){if(W=t[f+124>>2],R=t[W+96>>2],u=t[p+96>>2],l=t[W+92>>2],Z=t[p+92>>2],a=t[W+8>>2],C=t[W+88>>2],s=t[p+88>>2],t[f+80>>2]=0,r=u-R|0,e=r,i=r>>31,r=Z-l|0,d=r,v=r>>31,G=Rf(e,i,r,v),h=N,r=s-C|0,n=0-r|0,k=n,n>>=31,r=Rf(k,n,r,r>>31),w=N,Q=Rf(d,v,d,v),B=r-Q|0,w=w-(N+(r>>>0<Q>>>0)|0)|0,r=Rf(k,n,e,i),Q=0-r|0,Y=0-(N+(0<r>>>0)|0)|0,a){for(e=a;;){i=t[e+12>>2],m=t[i+92>>2],r=m-l|0,o=r,r>>=31,b=Rf(o,r,k,n),g=N;a:{f:{V=b,y=t[i+88>>2],b=y-C|0,D=b,b>>=31,F=Rf(d,v,D,b);n:if(!((0|V)!=(0-F|0)|(0-(N+(0<F>>>0)|0)|0)!=(0|g)||(r=Rf(G,h,o,r),g=N,b=Rf(D,b,Q,Y),o=b+r|0,r=N+g|0,r=o>>>0<b>>>0?r+1|0:r,b=t[i+96>>2],i=b-R|0,g=Rf(B,w,i,i>>31),o=g+o|0,i=N+r|0,i=o>>>0<g>>>0?i+1|0:i,(0|i)<0||(0|i)<=0&&!(o>>>0>=1)))){if(!c)break f;if(r=t[c+4>>2],(0|e)!=t[c>>2]){if((0|r)!=(0|e))break n;break f;}if((0|r)==(0|e)&&(i=b,r=t[t[e+8>>2]+12>>2],b=t[r+96>>2],i=i-b|0,o=t[c+12>>2],b=t[o+96>>2]-b|0,g=t[r+92>>2],m=_(i,t[o+92>>2]-g|0)-_(b,m-g|0)|0,m=Rf(m,m>>31,d,v),g=N,r=t[r+88>>2],r=_(b,y-r|0)-_(i,t[o+88>>2]-r|0)|0,o=Rf(r,r>>31,k,n),i=o+m|0,r=N+g|0,r=i>>>0<o>>>0?r+1|0:r,(0|r)<0||(0|r)<=0&&!(i>>>0>0)))break f;}if(e=t[e>>2],(0|a)!=(0|e))continue;break a;}if(c=e,e=t[e>>2],(0|a)!=(0|e))continue;}break;}t[f+80>>2]=c;}if(R=t[p+8>>2],l=0,t[f+56>>2]=0,R){for(e=R;;){r=t[e+12>>2],o=t[r+92>>2],a=o-Z|0,i=a,a=i>>31,C=Rf(i,a,k,n),b=N,D=C,m=t[r+88>>2],C=m-s|0,g=C,C=g>>31,y=Rf(d,v,g,C);a:if(!((0|D)!=(0-y|0)|(0-(N+(0<y>>>0)|0)|0)!=(0|b)||(a=Rf(G,h,i,a),i=N,C=Rf(g,C,Q,Y),a=C+a|0,i=N+i|0,i=a>>>0<C>>>0?i+1|0:i,C=t[r+96>>2],r=C-u|0,b=Rf(B,w,r,r>>31),a=b+a|0,r=N+i|0,r=a>>>0<b>>>0?r+1|0:r,(0|r)<0||(0|r)<=0&&!(a>>>0>=1)))){if(l){if(t[l>>2]!=(0|e))break a;if(t[l+4>>2]==(0|e)&&(i=C,r=t[t[e+8>>2]+12>>2],C=t[r+96>>2],a=i-C|0,i=t[l+12>>2],C=t[i+96>>2]-C|0,b=t[r+92>>2],o=_(a,t[i+92>>2]-b|0)-_(C,o-b|0)|0,o=Rf(o,o>>31,d,v),b=N,r=t[r+88>>2],r=_(C,m-r|0)-_(a,t[i+88>>2]-r|0)|0,i=Rf(r,r>>31,k,n),r=i+o|0,a=N+b|0,a=r>>>0<i>>>0?a+1|0:a,(0|a)<0||(0|a)<=0&&!(r>>>0>=1)))break a;}l=e;}if(e=t[e>>2],(0|R)==(0|e))break;}t[f+56>>2]=l;}c|l&&(UA(A,W,p,f+80|0,f+56|0),r=t[f+80>>2],r&&(W=t[r+12>>2],t[f+124>>2]=W),r=t[f+56>>2],r&&(p=t[r+12>>2],t[f+120>>2]=p)),M=t[p+92>>2],x=t[p+88>>2],S=t[p+96>>2]+1|0;}else x=t[p+88>>2]+1|0,M=t[p+92>>2],W=t[f+124>>2],S=t[p+96>>2];for(q=f+116|0,b=A+56|0,F=A+116|0,v=W,c=p,e=0,R=0,Z=0,g=0,T=1,d=0,l=0,C=0,y=0;;){t[q>>2]=-1,H=c+96|0,z=v+96|0,k=t[z>>2],r=t[H>>2]-k|0,t[f+112>>2]=r,n=t[v+88>>2],a=t[c+88>>2]-n|0,t[f+104>>2]=a,P=c+92|0,L=v+92|0,s=t[L>>2],i=t[P>>2]-s|0,t[f+108>>2]=i,k=S-k|0,n=x-n|0,h=_(k,a)-_(n,r)|0,u=h>>31,G=f+88|0,t[G>>2]=h,t[G+4>>2]=u,o=_(i,n),n=M-s|0,B=o-_(n,a)|0,s=B>>31,G=f+96|0,t[G>>2]=B,t[G+4>>2]=s,k=_(r,n)-_(i,k)|0,G=k>>31,w=k,t[f+80>>2]=k,t[f+84>>2]=G,k=a,Q=a>>31,a=Rf(h,u,a,Q),Y=N,o=f+72|0,n=i,i>>=31,m=Rf(w,G,n,i),t[o>>2]=a-m,t[o+4>>2]=Y-(N+(a>>>0<m>>>0)|0),o=G,a=r,G=r>>31,r=Rf(w,o,r,G),w=N,Y=f- -64|0,k=Rf(B,s,k,Q),t[Y>>2]=r-k,t[Y+4>>2]=w-(N+(r>>>0<k>>>0)|0),r=Rf(B,s,n,i),i=N,a=Rf(h,u,a,G),t[f+56>>2]=r-a,t[f+60>>2]=i-(N+(r>>>0<a>>>0)|0),j=f+48|0,t[j>>2]=0,J=f+40|0,r=J,t[r>>2]=0,t[r+4>>2]=0,t[f+32>>2]=0,t[f+36>>2]=0,D=jA(A,0,v,f+104|0,f+80|0,f+56|0,f+32|0),O=f+24|0,t[O>>2]=0,X=f+16|0,r=X,t[r>>2]=0,t[r+4>>2]=0,t[f+8>>2]=0,t[f+12>>2]=0;a:{f:{n:{t:{b:{if(k=jA(A,1,c,f+104|0,f+80|0,f+56|0,f+8|0),k|D){if(m=D?-1:1,!(!D|!k)){if(U=t[j>>2],r=t[O>>2],(0|U)!=(0|r))break b;if(!U)break t;m=-1,n=t[f+36>>2],s=t[X>>2],B=t[X+4>>2],a=0,G=t[f+32>>2],w=0,u=Rf(B,a,G,w),Q=N,h=0,B=Rf(B,a,n,0),i=B+Q|0,r=N+h|0,h=i,i=i>>>0<B>>>0?r+1|0:r,B=0,n=Rf(s,B,n,a),r=h,h=N,a=r+h|0,a>>>0<h>>>0&&(i=i+1|0),r=a,h=i,a=0,i=n+u|0,i>>>0<n>>>0&&(a=a+1|0),u=a,a=a+r|0,r=h,r=a>>>0<u>>>0?r+1|0:r,o=a,a=i,h=0,u=Rf(s,B,G,w),n=h+u|0,i=N+i|0,i=n>>>0<u>>>0?i+1|0:i,K=n,u=i,a=(0|a)==(0|i)&n>>>0<h>>>0|i>>>0<a>>>0,i=o+a|0,i>>>0<a>>>0&&(r=r+1|0),s=i,G=r,w=i,h=r,n=t[J+4>>2],Q=t[f+8>>2],I=t[f+12>>2],r=0,Y=t[J>>2],B=Rf(I,r,Y,0),V=N,o=0,a=0,I=Rf(I,r,n,a),i=I+V|0,r=N+o|0,r=i>>>0<I>>>0?r+1|0:r,I=0,n=Rf(Q,I,n,a),V=N,o=V+i|0,a=o,o=a>>>0<V>>>0?r+1|0:r,r=0,i=n+B|0,i>>>0<n>>>0&&(r=r+1|0),n=i,V=r,B=r+a|0,r=o,r=B>>>0<V>>>0?r+1|0:r,a=r,V=B,o=0,Q=Rf(Q,I,Y,0),B=o+Q|0,i=N+i|0,i=B>>>0<Q>>>0?i+1|0:i,r=i,i=(0|n)==(0|r)&B>>>0<o>>>0|r>>>0<n>>>0,n=V+i|0,n>>>0<i>>>0&&(a=a+1|0),i=a,(0|i)==(0|h)&w>>>0<n>>>0|h>>>0<i>>>0||(m=1,(0|i)==(0|G)&s>>>0>n>>>0|G>>>0>i>>>0||(m=-1,(0|r)==(0|u)&K>>>0<B>>>0|u>>>0<r>>>0||(m=(0|r)==(0|u)&K>>>0>B>>>0|u>>>0>r>>>0))),m=_(m,U);}if(T)break f;break n;}A=SA(A,v,c),t[v+8>>2]=A,r=t[A+8>>2],t[c+8>>2]=r,t[A+4>>2]=A,t[A>>2]=A,t[r+4>>2]=r,t[r>>2]=r;break i;}if(m=U-r|0,!T)break n;break f;}if(m=0,T)break f;}n:{if((0|m)>=0){if(t[O>>2]>-1)break f;if(!(t[X>>2]|t[X+4>>2]))break n;break f;}if(t[J>>2]|t[J+4>>2]|t[j>>2]>-1)break f;}u=e,a=R,n=d,i=l;break a;}n=SA(A,v,c),i=n,d&&(t[d+4>>2]=n,i=l),t[n>>2]=d,u=t[n+8>>2],a=u,e&&(t[e>>2]=u,a=R),t[u+4>>2]=e;}t[f+4>>2]=D,t[f>>2]=k,e=k,m||(UA(A,v,c,f+4|0,f),e=t[f>>2]);a:{f:{n:{if(!(!e|(0|m)<0)){if(g&&(r=t[g>>2],(0|k)!=(0|r)))for(;s=t[r+8>>2],R=0,l=0,d=t[r>>2],(0|r)!=(0|d)&&(t[d+4>>2]=t[r+4>>2],t[t[r+4>>2]>>2]=d,l=d),t[t[s+12>>2]+8>>2]=l,l=t[s>>2],(0|s)!=(0|l)&&(t[l+4>>2]=t[s+4>>2],t[t[s+4>>2]>>2]=l,R=l),t[t[r+12>>2]+8>>2]=R,t[r+12>>2]=0,t[r+16>>2]=0,t[r+4>>2]=0,t[r+8>>2]=0,R=t[b>>2],t[b>>2]=r,t[r>>2]=R,r=s+12|0,t[r>>2]=0,t[r+4>>2]=0,t[s+4>>2]=0,t[s+8>>2]=0,r=t[b>>2],t[b>>2]=s,t[s>>2]=r,t[F>>2]=t[F>>2]+-1,r=d,(0|k)!=(0|r);){}if(!u)break n;g||(g=t[k+4>>2],Z=a),t[g>>2]=a,t[a+4>>2]=g,t[k+4>>2]=u,t[u>>2]=k,a=0;break f;}R=c,e=u;break a;}Z=g?Z:k;}R=t[e+12>>2],t[f+120>>2]=R,S=t[H>>2],M=t[P>>2],g=t[e+8>>2],x=t[c+88>>2],e=0;}a:{f:{n:{t:{b:{o:{k:{c:{if(!((0|m)>0)&&(G=t[f+4>>2],G)){if(y&&(r=t[y+4>>2],(0|D)!=(0|r)))for(;s=r+4|0,u=t[r+8>>2],k=t[r+4>>2],c=0,l=0,d=t[r>>2],(0|r)!=(0|d)&&(t[d+4>>2]=k,t[t[s>>2]>>2]=d,l=d),t[t[u+12>>2]+8>>2]=l,l=t[u>>2],(0|u)!=(0|l)&&(t[l+4>>2]=t[u+4>>2],t[t[u+4>>2]>>2]=l,c=l),t[t[r+12>>2]+8>>2]=c,c=s+8|0,t[c>>2]=0,t[c+4>>2]=0,t[s>>2]=0,t[s+4>>2]=0,c=t[b>>2],t[b>>2]=r,t[r>>2]=c,r=u+12|0,t[r>>2]=0,t[r+4>>2]=0,t[u+4>>2]=0,t[u+8>>2]=0,r=t[b>>2],t[b>>2]=u,t[u>>2]=r,t[F>>2]=t[F>>2]+-1,r=k,(0|D)!=(0|r);){}if(!n)break c;y||(y=t[D>>2],C=i),t[y+4>>2]=i,t[i>>2]=y,t[n+4>>2]=D,t[D>>2]=n,i=0;break k;}if(d=n,r=v,(0|W)!=(0|r))break b;break o;}C=y?C:D;}if(r=t[G+12>>2],t[f+124>>2]=r,S=t[z>>2],M=t[L>>2],y=t[G+8>>2],x=t[v+88>>2],d=0,(0|r)!=(0|W))break b;}if((0|R)==(0|p)){if(!y)break t;if(r=t[y+4>>2],(0|r)!=(0|C))for(;k=r+4|0,v=t[r+8>>2],R=t[r+4>>2],c=0,l=0,A=t[r>>2],(0|r)!=(0|A)&&(t[A+4>>2]=R,t[t[k>>2]>>2]=A,l=A),t[t[v+12>>2]+8>>2]=l,A=t[v>>2],(0|v)!=(0|A)&&(t[A+4>>2]=t[v+4>>2],t[t[v+4>>2]>>2]=A,c=A),t[t[r+12>>2]+8>>2]=c,A=k+8|0,t[A>>2]=0,t[A+4>>2]=0,t[k>>2]=0,t[k+4>>2]=0,A=t[b>>2],t[b>>2]=r,t[r>>2]=A,A=v+12|0,t[A>>2]=0,t[A+4>>2]=0,t[v+4>>2]=0,t[v+8>>2]=0,A=t[b>>2],t[b>>2]=v,t[v>>2]=A,t[F>>2]=t[F>>2]+-1,r=R,(0|C)!=(0|r);){}if(d&&(t[i>>2]=y,t[y+4>>2]=i,t[C>>2]=d,t[d+4>>2]=C),!g)break n;break f;}}R=a,T=0,l=i;break a;}if(t[d+4>>2]=i,t[i>>2]=d,t[r+8>>2]=d,g)break f;}t[e>>2]=a,t[a+4>>2]=e,t[t[f+120>>2]+8>>2]=e;break i;}if(r=t[g>>2],(0|r)!=(0|Z))for(;c=t[r+8>>2],R=0,l=0,A=t[r>>2],(0|r)!=(0|A)&&(t[A+4>>2]=t[r+4>>2],t[t[r+4>>2]>>2]=A,l=A),t[t[c+12>>2]+8>>2]=l,i=t[c>>2],(0|c)!=(0|i)&&(t[i+4>>2]=t[c+4>>2],t[t[c+4>>2]>>2]=i,R=i),t[t[r+12>>2]+8>>2]=R,t[r+12>>2]=0,t[r+16>>2]=0,t[r+4>>2]=0,t[r+8>>2]=0,i=t[b>>2],t[b>>2]=r,t[r>>2]=i,r=c+12|0,t[r>>2]=0,t[r+4>>2]=0,t[c+4>>2]=0,t[c+8>>2]=0,r=t[b>>2],t[b>>2]=c,t[c>>2]=r,t[F>>2]=t[F>>2]+-1,r=A,(0|Z)!=(0|r);){}if(e){t[a+4>>2]=g,t[g>>2]=a,t[Z+4>>2]=e,t[e>>2]=Z;break i;}break i;}v=t[f+124>>2],c=t[f+120>>2];}}return void(E=f+128|0);}A=t[e+4>>2],t[r>>2]=t[e>>2],t[r+4>>2]=A,A=r+8|0,r=e+8|0,e=t[r+4>>2],t[A>>2]=t[r>>2],t[A+4>>2]=e,E=f+128|0;}(A,i,a);break A;}r=e+112|0;r:{e:{if(f=n-f|0,n=o-b|0,f|n){if(t[e+4>>2]=r,t[e>>2]=r,t[e+116>>2]=e,t[e+112>>2]=e,o=(0|f)<0,b=o&!n,n=(0|n)<0,b|=n,t[i+4>>2]=b?r:e,t[i>>2]=b?e:r,n&!f|o)break e;t[i+8>>2]=r,f=e;break r;}n=t[e+96>>2]>t[e+208>>2],f=n?r:e,t[i+8>>2]=f,t[i+4>>2]=f,t[i>>2]=f,t[f+4>>2]=f,t[f>>2]=f,r=n?e:r,e=f;break r;}t[i+8>>2]=e,f=r;}return t[i+12>>2]=f,A=SA(A,e,r),t[e+8>>2]=A,e=r,r=t[A+8>>2],t[e+8>>2]=r,t[A+4>>2]=A,t[A>>2]=A,t[r+4>>2]=r,t[r>>2]=r,void(E=a+16|0);}E=a+16|0;}function UA(A,r,e,i,a){var f,n,b,o,k,c,u,l,s,d,v,C,g,B,m,R=0,G=0,h=0,y=0,Q=0,p=0,D=0,w=0,W=0,F=0,Z=0,Y=0,E=0,V=0,I=0,J=0,X=0,M=0,x=0,S=0,T=0,U=0,j=0,O=0,H=0,z=0,P=0,L=0,K=0,q=0,$=0;X=r,H=t[i>>2],H&&(X=t[H+12>>2]),j=t[X+96>>2],M=t[X+92>>2],X=t[X+88>>2],P=t[a>>2],R=P?t[P+12>>2]:e,W=t[r+96>>2],u=t[e+96>>2]-W|0,p=t[(H||P)+12>>2],G=t[r+92>>2],h=t[p+92>>2]-G|0,l=t[e+92>>2]-G|0,y=t[p+96>>2]-W|0,Q=_(u,h)-_(l,y)|0,g=Q,d=Q>>31,Y=u>>31,Q=Rf(Q,d,u,Y),D=N,r=t[r+88>>2],p=t[p+88>>2]-r|0,s=t[e+88>>2]-r|0,e=_(p,l)-_(h,s)|0,B=e,v=e>>31,h=s>>31,e=Rf(e,v,s,h),f=Q-e|0,n=D-(N+(Q>>>0<e>>>0)|0)|0,Q=Rf(f,n,M,M>>31),D=N,w=l>>31,e=Rf(B,v,l,w),I=N,p=_(y,s)-_(p,u)|0,m=p,C=p>>31,p=Rf(p,C,u,Y),b=e-p|0,o=I-(N+(e>>>0<p>>>0)|0)|0,y=Rf(b,o,X,X>>31),e=y+Q|0,Q=N+D|0,p=Rf(m,C,s,h),h=N,Y=Rf(g,d,l,w),k=p-Y|0,c=h-(N+(p>>>0<Y>>>0)|0)|0,h=Rf(k,c,j,j>>31),Y=h+e|0,p=Y,e=N+(e>>>0<y>>>0?Q+1|0:Q)|0,Q=p>>>0<h>>>0?e+1|0:e,r=Rf(g,d,r,r>>31),e=N,W=Rf(B,v,W,W>>31),r=W+r|0,e=N+e|0,G=Rf(m,C,G,G>>31),h=G+r|0,Z=h,r=N+(r>>>0<W>>>0?e+1|0:e)|0,U=h>>>0<G>>>0?r+1|0:r,V=t[R+96>>2],S=t[R+92>>2],T=t[R+88>>2];A:{r:{e:{if(!(!H|!t[H+12>>2])){if(r=t[t[H+8>>2]+4>>2],e=t[r+12>>2],R=t[e+92>>2],W=R,Y=R>>31,G=Rf(R,Y,m,C),h=N,y=t[e+88>>2],R=y,F=R>>31,w=Rf(R,F,g,d),G=G+w|0,h=N+h|0,e=t[e+96>>2],y=e,D=e>>31,e=Rf(e,D,B,v),I=G+e|0,G=N+(G>>>0<w>>>0?h+1|0:h)|0,e=I>>>0<e>>>0?G+1|0:G,(0|e)<(0|U)||(0|e)<=(0|U)&&!(I>>>0>=Z>>>0))break r;for(I=r+12|0,w=A+100|0;;){if(t[r+20>>2]==t[w>>2])break r;if(e=Rf(f,n,W,Y),W=N,G=Rf(b,o,R,F),R=G+e|0,W=N+W|0,h=Rf(k,c,y,D),y=h+R|0,e=y,R=N+(R>>>0<G>>>0?W+1|0:W)|0,W=e>>>0<h>>>0?R+1|0:R,R=W,(0|R)<(0|Q)||(0|R)<=(0|Q)&&!(e>>>0>p>>>0))break r;if(t[i>>2]=r,p=t[I>>2],j=t[p+96>>2],M=t[p+92>>2],X=t[p+88>>2],!p)break e;if(r=t[t[r+8>>2]+4>>2],I=r+12|0,p=e,Q=R,e=t[r+12>>2],R=t[e+92>>2],W=R,Y=R>>31,G=Rf(R,Y,m,C),h=N,y=t[e+88>>2],R=y,F=R>>31,E=Rf(R,F,g,d),G=G+E|0,h=N+h|0,e=t[e+96>>2],y=e,D=e>>31,e=Rf(e,D,B,v),J=e+G|0,G=N+(G>>>0<E>>>0?h+1|0:h)|0,e=J>>>0<e>>>0?G+1|0:G,!((0|e)>(0|U)||(0|e)>=(0|U)&&!(J>>>0<Z>>>0)))break;}break r;}r=P;break A;}p=e,Q=R;}r=t[a>>2];}e=Rf(f,n,S,S>>31),R=N,G=Rf(b,o,T,T>>31),e=G+e|0,R=N+R|0,h=Rf(k,c,V,V>>31),y=h+e|0,W=y,e=N+(e>>>0<G>>>0?R+1|0:R)|0,Y=y>>>0<h>>>0?e+1|0:e;A:{r:{e:{i:{a:if(r){if(!t[r+12>>2])break a;if(I=t[t[r+8>>2]>>2],e=t[I+12>>2],G=t[e+92>>2],R=G,F=R>>31,G=Rf(R,F,m,C),h=N,D=t[e+88>>2],y=D,D=y>>31,J=Rf(y,D,g,d),G=G+J|0,E=N+h|0,e=t[e+96>>2],h=e,w=e>>31,e=Rf(e,w,B,v),x=e+G|0,G=N+(G>>>0<J>>>0?E+1|0:E)|0,e=x>>>0<e>>>0?G+1|0:G,(0|e)<(0|U)||(0|e)<=(0|U)&&!(x>>>0>=Z>>>0))break a;for(E=I+12|0,x=A+100|0;;){if(e=I,t[e+20>>2]==t[x>>2])break a;if(R=Rf(f,n,R,F),I=N,D=Rf(b,o,y,D),G=D+R|0,y=N+I|0,h=Rf(k,c,h,w),R=h+G|0,G=N+(G>>>0<D>>>0?y+1|0:y)|0,h=R>>>0<h>>>0?G+1|0:G,G=h,(0|G)<(0|Y)||(0|G)<=(0|Y)&&!(R>>>0>W>>>0))break a;if(t[a>>2]=e,r=t[E>>2],V=t[r+96>>2],S=t[r+92>>2],T=t[r+88>>2],!r)break i;if(I=t[t[e+8>>2]>>2],E=I+12|0,W=R,Y=G,r=e,e=t[I+12>>2],G=t[e+92>>2],R=G,F=R>>31,G=Rf(R,F,m,C),h=N,D=t[e+88>>2],y=D,D=y>>31,O=Rf(y,D,g,d),G=G+O|0,J=N+h|0,e=t[e+96>>2],h=e,w=e>>31,e=Rf(e,w,B,v),L=G+e|0,G=N+(G>>>0<O>>>0?J+1|0:J)|0,e=L>>>0<e>>>0?G+1|0:G,!((0|e)>(0|U)||(0|e)>=(0|U)&&!(L>>>0<Z>>>0)))break;}}else r=0;if(Q=Y-((W>>>0<p>>>0)+Q|0)|0,p=W-p|0,(0|Q)<0||(0|Q)<=0&&!(p>>>0>=1))break e;break r;}if(r=e,Q=G-((R>>>0<p>>>0)+Q|0)|0,p=R-p|0,(0|Q)>0||(0|Q)>=0&&!(p>>>0<1))break r;}if((0|Q)>-1||(0|Q)>=-1&&!(p>>>0<=4294967295))break A;for(L=A+100|0;;){for(D=V,I=S,U=T;;){e:{J=(_(I-M|0,l)+_(U-X|0,s)|0)+_(D-j|0,u)|0,A=J,W=A,Y=A>>31;i:if(!(!r|!t[r+12>>2]||($=t[t[r+4>>2]+8>>2],t[$+20>>2]<=t[L>>2]))){A=t[$+12>>2],S=t[A+92>>2],e=S-I|0,T=t[A+88>>2],R=T-U|0,V=t[A+96>>2],G=V-D|0,A=(_(e,l)+_(R,s)|0)+_(G,u)|0,e=Rf(f,n,e,e>>31),h=N,y=Rf(b,o,R,R>>31),R=y+e|0,h=N+h|0,G=Rf(k,c,G,G>>31),e=G+R|0,R=N+(R>>>0<y>>>0?h+1|0:h)|0,R=e>>>0<G>>>0?R+1|0:R,O=R;a:{f:{if(e|R){if((0|O)>-1||(0|O)>=-1&&!(e>>>0<=4294967295))break i;if(R=A,F=R>>31,G=-1,(0|R)<=0)break f;x=-1;break a;}if((0|A)>0)break e;break i;}h=R,R=A?0-R|0:0,F=A?0-((0<h>>>0)+F|0)|0:0,x=0!=(0|A);}H=1,y=W,A=Y,(0|J)>0||(H=J?-1:0,y=J?0-W|0:0,G=0!=(0|J),A=J?0-((0<W>>>0)+Y|0)|0:0),K=A;a:{f:{if(!((0|Q)<0||(0|Q)<=0&&!(p>>>0>0))){if(h=p,w=Q,(0|x)!=(0|H))break f;break a;}if(A=0!=(0|p)|0!=(0|Q),h=A?0-p|0:0,w=A?0-((0<p>>>0)+Q|0)|0:0,H=A?G:H,(0|H)==(0|x))break a;}if((x-H|0)>0)break i;break e;}if(!x)break e;if(H=-1,G=R,q=Rf(w,0,R,0),A=N,z=Rf(w,0,F,0),A=A+z|0,Z=N,E=Rf(h,0,F,0),w=N,F=w+A|0,R=0,A=A>>>0<z>>>0?Z+1|0:Z,A=F>>>0<w>>>0?A+1|0:A,z=A+1|0,w=E+q|0,w>>>0<E>>>0&&(R=1),Z=R+F|0,A=Z>>>0<R>>>0?z:A,h=Rf(h,0,G,0),R=h,G=w,w=G+N|0,w=R>>>0<R>>>0?w+1|0:w,F=w,h=R,R=(0|w)==(0|G)&R>>>0<0|w>>>0<G>>>0,E=Z+R|0,E>>>0<R>>>0&&(A=A+1|0),w=A,Z=A,q=0-e|0,z=Rf(K,0,q,0),A=N,R=0-((0<e>>>0)+O|0)|0,G=Rf(K,0,R,0),A=A+G|0,e=N,R=Rf(y,0,R,0),e=A>>>0<G>>>0?e+1|0:e,G=A,A=N,O=G+A|0,G=O>>>0<A>>>0?e+1|0:e,A=0,e=R+z|0,e>>>0<R>>>0&&(A=1),O=A+O|0,R=O>>>0<A>>>0?G+1|0:G,G=Rf(y,0,q,0),A=G,y=N+e|0,y=G>>>0<G>>>0?y+1|0:y,G=y,e=(0|e)==(0|G)&A>>>0<0|G>>>0<e>>>0,y=O+e|0,y>>>0<e>>>0&&(R=R+1|0),e=R,(0|R)==(0|Z)&E>>>0<y>>>0|Z>>>0<R>>>0||(H=1,(0|e)==(0|w)&E>>>0>y>>>0|w>>>0>e>>>0||(H=-1,(0|G)==(0|F)&h>>>0<A>>>0|F>>>0<G>>>0||(H=(0|G)==(0|F)&h>>>0>A>>>0|F>>>0>G>>>0))),(0|_(x,H))<=0)break e;}if(A=t[i>>2],!A|!t[A+12>>2])break A;if(w=t[t[A+8>>2]+4>>2],t[w+20>>2]<=t[L>>2])break A;if(A=t[w+12>>2],R=t[A+92>>2],G=R-M|0,h=G,y=G>>31,r=Rf(G,y,m,C),e=N,M=t[A+88>>2],X=M-X|0,V=X,S=V,V>>=31,T=Rf(X,V,g,d),r=r+T|0,e=N+e|0,A=t[A+96>>2],j=A-j|0,Z=j,E=Z,Z>>=31,F=Rf(B,v,E,Z),(0|r)!=(0-F|0)|(0-(N+(0<F>>>0)|0)|0)!=(0|(r>>>0<T>>>0?e+1|0:e)))break A;if(r=I-R|0,r=Rf(f,n,r,r>>31),e=N,R=U-M|0,R=Rf(b,o,R,R>>31),r=r+R|0,e=N+e|0,A=D-A|0,M=Rf(k,c,A,A>>31),A=r+M|0,r=N+(r>>>0<R>>>0?e+1|0:e)|0,r=A>>>0<M>>>0?r+1|0:r,e=r,(0|e)>-1||(0|e)>=-1&&!(A>>>0<=4294967295))break A;r=(_(G,l)+_(X,s)|0)+_(j,u)|0,R=Rf(f,n,h,y),G=N,y=Rf(b,o,S,V),R=y+R|0,G=N+G|0,X=Rf(k,c,E,Z),h=X+R|0,R=N+(R>>>0<y>>>0?G+1|0:G)|0,R=h>>>0<X>>>0?R+1|0:R,y=R;i:{a:{f:{n:{t:{b:{o:{k:{if(R|h){if((0|y)>-1||(0|y)>=-1&&!(h>>>0<=4294967295))break A;if(R=r,F=R>>31,X=-1,(0|R)<=0)break k;if(j=-1,M=1,(0|J)<=0)break o;break b;}if((0|r)>0)break i;break A;}if(G=R,R=r?0-R|0:0,F=r?0-((0<G>>>0)+F|0)|0:0,j=0!=(0|r),M=1,(0|J)>0)break b;}if(M=J?-1:0,r=W,W=J?0-r|0:0,Y=J?0-((0<r>>>0)+Y|0)|0:0,X=0!=(0|J),(0|Q)>0||(0|Q)>=0&&!(p>>>0<=0))break t;break n;}if((0|Q)<0||(0|Q)<=0&&!(p>>>0>0))break n;}if((0|M)!=(0|j))break f;break a;}if(r=p,G=0!=(0|r)|0!=(0|Q),p=G?0-r|0:0,Q=G?0-((0<r>>>0)+Q|0)|0:0,M=G?X:M,(0|M)==(0|j))break a;}if((j-M|0)<=-1)break i;break A;}if(!j)break A;if(M=-1,r=R,T=Rf(Q,0,R,0),R=N,Z=Rf(Q,0,F,0),R=R+Z|0,X=N,V=Rf(p,0,F,0),E=N,S=E+R|0,G=0,R=R>>>0<Z>>>0?X+1|0:X,R=S>>>0<E>>>0?R+1|0:R,Z=R+1|0,Q=V+T|0,Q>>>0<V>>>0&&(G=1),V=G+S|0,R=V>>>0<G>>>0?Z:R,G=Rf(p,0,r,0),r=G,p=Q,Q=Q+N|0,Q=G>>>0<G>>>0?Q+1|0:Q,X=Q,p=(0|Q)==(0|p)&G>>>0<0|Q>>>0<p>>>0,G=V+p|0,G>>>0<p>>>0&&(R=R+1|0),p=R,Q=R,T=0-h|0,Z=Rf(Y,0,T,0),V=N,R=0-((0<h>>>0)+y|0)|0,E=Rf(Y,0,R,0),h=V+E|0,Y=N,V=Rf(W,0,R,0),F=N,S=F+h|0,R=0,h=h>>>0<E>>>0?Y+1|0:Y,h=S>>>0<F>>>0?h+1|0:h,E=h+1|0,y=Z+V|0,y>>>0<V>>>0&&(R=1),Y=R+S|0,h=Y>>>0<R>>>0?E:h,V=Rf(W,0,T,0),R=V,W=y,y=y+N|0,V=R>>>0<R>>>0?y+1|0:y,y=V,W=(0|y)==(0|W)&R>>>0<0|y>>>0<W>>>0,Y=Y+W|0,Y>>>0<W>>>0&&(h=h+1|0),W=h,(0|h)==(0|Q)&G>>>0<Y>>>0|Q>>>0<h>>>0||(M=1,(0|p)==(0|W)&G>>>0>Y>>>0|p>>>0>W>>>0||(M=-1,(0|y)==(0|X)&r>>>0<R>>>0|X>>>0<y>>>0||(M=(0|y)==(0|X)&r>>>0>R>>>0|X>>>0>y>>>0))),(0|_(M,j))>-1)break A;}t[i>>2]=w,r=t[w+12>>2],X=t[r+88>>2],j=t[r+96>>2],M=t[r+92>>2],r=t[a>>2],p=A,Q=e;continue;}break;}r=(0|r)==(0|P)?0:$,t[a>>2]=r,A=S-M|0,A=Rf(f,n,A,A>>31),e=N,R=T-X|0,R=Rf(b,o,R,R>>31),A=A+R|0,e=N+e|0,p=V-j|0,Q=Rf(k,c,p,p>>31),W=A+Q|0,p=W,A=N+(A>>>0<R>>>0?e+1|0:e)|0,Q=p>>>0<Q>>>0?A+1|0:A;}}for(L=A+100|0;;){J=(_(S-M|0,l)+_(T-X|0,s)|0)+_(V-j|0,u)|0,A=J,W=A,Y=A>>31;r:if(P=t[i>>2],!(!P|!t[P+12>>2]||($=t[t[P>>2]+8>>2],t[$+20>>2]<=t[L>>2]))){A=t[$+12>>2],r=t[A+92>>2],e=r-M|0,I=t[A+88>>2],R=I-X|0,U=t[A+96>>2],G=U-j|0,A=(_(e,l)+_(R,s)|0)+_(G,u)|0,e=Rf(f,n,e,e>>31),h=N,y=Rf(b,o,R,R>>31),e=y+e|0,R=N+h|0,G=Rf(k,c,G,G>>31),Z=G+e|0,e=N+(e>>>0<y>>>0?R+1|0:R)|0,e=Z>>>0<G>>>0?e+1|0:e,O=e;e:{i:{a:{f:{n:{t:{b:{o:{if(e|Z){if((0|O)>-1||(0|O)>=-1&&!(Z>>>0<=4294967295))break r;if(R=A,F=R>>31,x=-1,(0|R)<=0)break o;if(e=-1,A=1,y=W,D=Y,(0|J)<=0)break b;break t;}if((0|A)<0)break e;break r;}if(e=R,R=A?0-R|0:0,F=A?0-((0<e>>>0)+F|0)|0:0,e=0!=(0|A),A=1,y=W,D=Y,(0|J)>0)break t;}if(A=J?-1:0,y=J?0-W|0:0,D=J?0-((0<W>>>0)+Y|0)|0:0,x=0!=(0|J),(0|Q)>0||(0|Q)>=0&&!(p>>>0<=0))break n;break f;}if((0|Q)<0||(0|Q)<=0&&!(p>>>0>0))break f;}if(h=p,w=Q,(0|A)!=(0|e))break a;break i;}if(G=0!=(0|p)|0!=(0|Q),h=G?0-p|0:0,w=G?0-((0<p>>>0)+Q|0)|0:0,A=G?x:A,(0|e)==(0|A))break i;}if((e-A|0)>=0)break e;break r;}if(e&&(A=-1,E=R,q=Rf(w,0,R,0),R=N,z=Rf(w,0,F,0),G=R+z|0,x=N,F=Rf(h,0,F,0),w=N,K=w+G|0,R=0,G=G>>>0<z>>>0?x+1|0:x,G=K>>>0<w>>>0?G+1|0:G,z=G+1|0,w=F+q|0,w>>>0<F>>>0&&(R=1),x=R+K|0,G=x>>>0<R>>>0?z:G,E=Rf(h,0,E,0),R=E,h=w,w=h+N|0,E=R>>>0<R>>>0?w+1|0:w,F=E,w=R,R=(0|F)==(0|h)&R>>>0<0|F>>>0<h>>>0,E=x+R|0,E>>>0<R>>>0&&(G=G+1|0),K=0-Z|0,q=Rf(D,0,K,0),h=N,Z=0-((0<Z>>>0)+O|0)|0,R=Rf(D,0,Z,0),h=h+R|0,D=N,R=h>>>0<R>>>0?D+1|0:D,D=y,x=Rf(y,0,Z,0),y=N,O=h+y|0,O>>>0<y>>>0&&(R=R+1|0),h=G,y=G,G=0,Z=x+q|0,Z>>>0<x>>>0&&(G=1),x=G+O|0,x>>>0<G>>>0&&(R=R+1|0),O=Rf(D,0,K,0),G=O,D=Z,Z=D+N|0,Z=G>>>0<G>>>0?Z+1|0:Z,D=(0|Z)==(0|D)&G>>>0<0|Z>>>0<D>>>0,x=x+D|0,x>>>0<D>>>0&&(R=R+1|0),D=R,(0|R)==(0|y)&E>>>0<x>>>0|y>>>0<R>>>0||(A=1,(0|h)==(0|D)&E>>>0>x>>>0|h>>>0>D>>>0||(A=-1,(0|F)==(0|Z)&w>>>0<G>>>0|F>>>0<Z>>>0||(A=(0|F)==(0|Z)&w>>>0>G>>>0|F>>>0>Z>>>0))),(0|_(A,e))<0))break r;}t[i>>2]=(0|H)==(0|P)?0:$,A=S-r|0,A=Rf(f,n,A,A>>31),e=N,R=T-I|0,R=Rf(b,o,R,R>>31),A=A+R|0,e=N+e|0,p=V-U|0,Q=Rf(k,c,p,p>>31),W=A+Q|0,p=W,A=N+(A>>>0<R>>>0?e+1|0:e)|0,Q=p>>>0<Q>>>0?A+1|0:A,X=I,M=r,j=U;continue;}if(A=t[a>>2],!A|!t[A+12>>2])break A;if(Z=t[t[A+8>>2]>>2],t[Z+20>>2]<=t[L>>2])break A;if(A=t[Z+12>>2],R=t[A+92>>2],G=R-S|0,y=G,D=G>>31,r=Rf(G,D,m,C),e=N,h=t[A+88>>2],w=h-T|0,U=w,I=w>>31,S=Rf(w,I,g,d),r=r+S|0,e=N+e|0,T=t[A+96>>2],V=T-V|0,A=V,E=A,F=A>>31,A=Rf(B,v,A,F),(0|r)!=(0-A|0)|(0-(N+(0<A>>>0)|0)|0)!=(0|(r>>>0<S>>>0?e+1|0:e)))break A;if(A=R-M|0,A=Rf(f,n,A,A>>31),r=N,e=h-X|0,R=Rf(b,o,e,e>>31),A=A+R|0,e=N+r|0,r=T-j|0,h=Rf(k,c,r,r>>31),S=A+h|0,r=S,A=N+(A>>>0<R>>>0?e+1|0:e)|0,A=r>>>0<h>>>0?A+1|0:A,h=A,(0|A)<0||(0|A)<=0&&!(r>>>0>=1))break A;A=(_(G,l)+_(w,s)|0)+_(V,u)|0,e=Rf(f,n,y,D),R=N,G=Rf(b,o,U,I),e=G+e|0,R=N+R|0,D=Rf(k,c,E,F),y=D+e|0,e=N+(e>>>0<G>>>0?R+1|0:R)|0,e=y>>>0<D>>>0?e+1|0:e,V=e;r:{e:{i:{a:{f:{n:{t:{b:{if(e|y){if((0|V)>-1||(0|V)>=-1&&!(y>>>0<=4294967295))break A;if(R=A,F=R>>31,G=-1,(0|R)<=0)break b;if(e=-1,I=1,(0|J)<=0)break t;break n;}if((0|A)<0)break r;break A;}if(e=R,R=A?0-R|0:0,F=A?0-((0<e>>>0)+F|0)|0:0,e=0!=(0|A),I=1,(0|J)>0)break n;}if(I=J?-1:0,A=W,W=J?0-A|0:0,Y=J?0-((0<A>>>0)+Y|0)|0:0,G=0!=(0|J),(0|Q)>0||(0|Q)>=0&&!(p>>>0<=0))break f;break a;}if((0|Q)<0||(0|Q)<=0&&!(p>>>0>0))break a;}if((0|e)!=(0|I))break i;break e;}if(A=p,D=0!=(0|A)|0!=(0|Q),p=D?0-A|0:0,Q=D?0-((0<A>>>0)+Q|0)|0:0,I=D?G:I,(0|I)==(0|e))break e;}if((e-I|0)<1)break A;break r;}if(!e)break A;if(I=-1,A=R,S=Rf(Q,0,R,0),R=N,T=Rf(Q,0,F,0),G=R+T|0,D=N,w=Rf(p,0,F,0),E=N,U=E+G|0,R=0,G=G>>>0<T>>>0?D+1|0:D,G=U>>>0<E>>>0?G+1|0:G,E=G+1|0,D=G,Q=w+S|0,Q>>>0<w>>>0&&(R=1),G=R+U|0,R=G>>>0<R>>>0?E:D,D=Rf(p,0,A,0),A=D,p=Q,Q=Q+N|0,D=A>>>0<A>>>0?Q+1|0:Q,U=D,Q=A,A=(0|D)==(0|p)&A>>>0<0|D>>>0<p>>>0,w=G+A|0,w>>>0<A>>>0&&(R=R+1|0),p=R,D=R,S=0-y|0,T=Rf(Y,0,S,0),A=N,G=0-((0<y>>>0)+V|0)|0,y=Rf(Y,0,G,0),A=A+y|0,R=N,Y=Rf(W,0,G,0),R=A>>>0<y>>>0?R+1|0:R,G=A,A=N,V=G+A|0,G=V>>>0<A>>>0?R+1|0:R,R=0,y=Y+T|0,y>>>0<Y>>>0&&(R=1),Y=R+V|0,A=Y>>>0<R>>>0?G+1|0:G,G=Rf(W,0,S,0),R=G,W=y,y=y+N|0,G=R>>>0<R>>>0?y+1|0:y,W=(0|G)==(0|W)&R>>>0<0|G>>>0<W>>>0,y=Y+W|0,y>>>0<W>>>0&&(A=A+1|0),W=A,(0|A)==(0|D)&w>>>0<y>>>0|D>>>0<A>>>0||(I=1,(0|p)==(0|W)&w>>>0>y>>>0|p>>>0>W>>>0||(I=-1,(0|G)==(0|U)&Q>>>0<R>>>0|U>>>0<G>>>0||(I=(0|G)==(0|U)&Q>>>0>R>>>0|U>>>0>G>>>0))),(0|_(e,I))<1)break A;}t[a>>2]=Z,A=t[Z+12>>2],T=t[A+88>>2],V=t[A+96>>2],S=t[A+92>>2],p=r,Q=h;}}}function jA(A,r,e,i,a,f,n){var b,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0,g=0,B=0,m=0,R=0,G=0,h=0,y=0,Q=0,p=0,D=0,w=0,W=0;if(b=E-32|0,E=b,o=t[e+8>>2],o){for(D=A+100|0,w=e+88|0,W=i+4|0,A=o;;){if(t[A+20>>2]>t[D>>2]){o=a+8|0,l=t[o>>2],d=t[o+4>>2],k=t[A+12>>2],C=t[k+92>>2],m=C-t[e+92>>2]|0,o=m,c=o,u=o>>31,o=Rf(l,d,o,u),d=N,l=o,G=t[k+88>>2],Q=G-t[w>>2]|0,o=Q,g=o,B=o>>31,R=Rf(t[a>>2],t[a+4>>2],o,B),l=l+R|0,o=N+d|0,o=l>>>0<R>>>0?o+1|0:o,v=l,l=a+16|0,h=t[k+96>>2],R=h-t[e+96>>2]|0,k=R,d=k,p=k>>31,y=Rf(t[l>>2],t[l+4>>2],k,p),l=v+y|0,k=N+o|0,k=l>>>0<y>>>0?k+1|0:k,o=f+8|0,o=Rf(t[o>>2],t[o+4>>2],c,u),u=N,g=Rf(t[f>>2],t[f+4>>2],g,B),c=g+o|0,o=N+u|0,o=c>>>0<g>>>0?o+1|0:o,v=c,c=f+16|0,u=Rf(t[c>>2],t[c+4>>2],d,p),c=v+u|0,o=N+o|0,o=c>>>0<u>>>0?o+1|0:o,u=o,(0|o)<0||(0|o)<=0&&!(c>>>0>=1)?(0|u)<-1||(0|u)<=-1&&!(c>>>0>4294967295)?(o=-1,t[b+24>>2]=-1,d=1,t[b+8>>2]=0-c,t[b+12>>2]=0-((0<c>>>0)+u|0)):(o=0,t[b+24>>2]=0,d=0,t[b+8>>2]=0,t[b+12>>2]=0):(t[b+24>>2]=1,o=-1,d=-1,t[b+8>>2]=c,t[b+12>>2]=u);A:{r:{e:{if(!((0|k)>0||(0|k)>=0&&!(l>>>0<=0))){if(!((0|k)<-1||(0|k)<=-1&&!(l>>>0>4294967295))){if(k=b+16|0,t[k>>2]=0,t[k+4>>2]=0,!o)break A;if(!s)break e;break r;}t[b+24>>2]=d,o=l,l=0-o|0,k=0-((0<o>>>0)+k|0)|0;}if(o=b+16|0,t[o>>2]=l,t[o+4>>2]=k,s)break r;}s=t[b+12>>2],t[n>>2]=t[b+8>>2],t[n+4>>2]=s,t[n+16>>2]=t[b+24>>2],o=b+16|0,k=t[o+4>>2],s=n+8|0,t[s>>2]=t[o>>2],t[s+4>>2]=k,s=A;break A;}r:{e:{if(o=xA(b+8|0,n),(0|o)>-1){if(o)break A;if(k=t[s+4>>2],t[s>>2]==(0|A))break e;o=(0|A)==(0|k);break r;}s=t[b+12>>2],t[n>>2]=t[b+8>>2],t[n+4>>2]=s,t[n+16>>2]=t[b+24>>2],o=b+16|0,k=t[o+4>>2],s=n+8|0,t[s>>2]=t[o>>2],t[s+4>>2]=k,s=A;break A;}o=2,(0|A)==(0|k)&&(o=t[t[A+8>>2]+12>>2],c=t[o+96>>2],l=h-c|0,k=t[s+12>>2],u=t[o+92>>2],d=t[k+92>>2]-u|0,c=t[k+96>>2]-c|0,u=C-u|0,C=_(l,d)-_(c,u)|0,v=C,y=C>>31,C=t[i+8>>2],g=t[W>>2],B=_(C,m)-_(g,R)|0,B=Rf(v,y,B,B>>31),h=N,v=u,o=t[o+88>>2],u=t[k+88>>2]-o|0,k=d,d=G-o|0,o=_(v,u)-_(k,d)|0,k=o,v=o>>31,o=m,m=t[i>>2],o=_(g,Q)-_(o,m)|0,G=Rf(k,v,o,o>>31),o=G+B|0,k=N+h|0,k=o>>>0<G>>>0?k+1|0:k,v=o,o=_(c,d)-_(l,u)|0,d=o,u=o>>31,o=_(m,R)-_(C,Q)|0,c=Rf(d,u,o,o>>31),l=v+c|0,o=N+k|0,o=l>>>0<c>>>0?o+1|0:o,o=(0|o)>0||(0|o)>=0&&!(l>>>0<=0)?2:1);}s=2!=(0|o)^r?A:s;}o=t[e+8>>2];}if(A=t[A>>2],(0|o)==(0|A))break;}return E=b+32|0,s;}return E=b+32|0,0;}function OA(A,r,e){var i,f=0,n=0,o=0,c=0,u=0,l=B(0),d=0,v=0,g=B(0),R=0,G=0,h=B(0),y=B(0),Q=0,p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=0,Y=0,N=0;if(i=E-48|0,E=i,(0|e)>=1)for(f=-246811958,o=1900671690,v=e,u=r,Q=1900671690,n=1900671690,G=-246811958,R=-246811958;c=u+8|0,d=t[c>>2],l=C[c>>2],k(0,f),f=s()<l?d:f,c=u+4|0,Z=t[c>>2],g=C[c>>2],k(0,G),G=s()<g?Z:G,o=l<(k(0,o),s())?d:o,Q=g<(k(0,Q),s())?Z:Q,c=t[u>>2],l=C[u>>2],k(0,R),R=s()<l?c:R,n=l<(k(0,n),s())?c:n,u=u+16|0,v=v+-1|0,v;){}else n=1900671690,R=-246811958,G=-246811958,f=-246811958,Q=1900671690,o=1900671690;if(k(0,G),p=s(),k(0,Q),D=s(),g=B(p-D),k(0,f),w=s(),k(0,o),h=s(),l=B(w-h),u=g<l,k(0,R),W=s(),k(0,n),F=s(),y=B(W-F),n=y<l,v=y<g,f=v?u?2:1:n<<1,t[A+112>>2]=f,o=v?(1^n)<<1:u?1:2,(0|o)==(0|f)&&(o=(f+1>>>0)%3|0),t[A+104>>2]=o,n=(3^f)-o|0,t[A+108>>2]=n,l=B(l*B(9788566967472434e-20)),g=B(g*B(9788566967472434e-20)),y=B(y*B(9788566967472434e-20)),t[A+12>>2]=0,((n+1|0)%3|0)!=(0|f)&&(g=B(-g),y=B(-y),l=B(-l)),C[A+8>>2]=l,C[A+4>>2]=g,C[A>>2]=y,t[A+28>>2]=0,C[A+24>>2]=B(w+h)*B(.5),C[A+20>>2]=B(p+D)*B(.5),C[A+16>>2]=B(W+F)*B(.5),t[i+36>>2]=0,t[i+28>>2]=0,t[i+32>>2]=0,u=l!=B(0),p=B(B(1)/l),v=g!=B(0),D=B(B(1)/g),G=y!=B(0),w=B(B(1)/y),a[i+40|0]=1,!((0|e)<1)&&(Q=i+36|0,f=CA(e<<4,16),t[Q>>2]=f,a[i+40|0]=1,t[i+32>>2]=e,n=i+16|0,o=t[n+4>>2],R=f+8|0,t[R>>2]=t[n>>2],t[R+4>>2]=o,o=t[i+12>>2],t[f>>2]=t[i+8>>2],t[f+4>>2]=o,1!=(0|e)))for(o=e+-1|0,f=16;R=t[i+12>>2],c=t[Q>>2]+f|0,t[c>>2]=t[i+8>>2],t[c+4>>2]=R,R=t[n+4>>2],c=c+8|0,t[c>>2]=t[n>>2],t[c+4>>2]=R,f=f+16|0,o=o+-1|0,o;){}if(l=u?p:l,g=v?D:g,y=G?w:y,t[i+28>>2]=e,!((0|e)<1)){for(f=t[i+36>>2]+8|0,p=C[A+24>>2],D=C[A+20>>2],w=C[A+16>>2],n=(i+8|0)+(t[A+104>>2]<<2)|0,u=(i+8|0)+(t[A+112>>2]<<2)|0,v=(i+8|0)+(t[A+108>>2]<<2)|0,o=0;h=C[r+4>>2],W=C[r+8>>2],F=C[r>>2],t[i+20>>2]=0,C[i+16>>2]=l*B(W-p),C[i+8>>2]=y*B(F-w),C[i+12>>2]=g*B(h-D),t[f+4>>2]=o,c=f+-8|0,h=C[v>>2],d=-2147483648,B(m(h))<B(2147483648)&&(d=~~h),t[c>>2]=d,c=f+-4|0,h=C[u>>2],d=-2147483648,B(m(h))<B(2147483648)&&(d=~~h),t[c>>2]=d,c=f,h=C[n>>2],d=-2147483648,B(m(h))<B(2147483648)&&(d=~~h),t[c>>2]=d,f=f+16|0,r=r+16|0,o=o+1|0,(0|o)!=(0|e);){}(0|e)<2||function A(r,e,i,a){var f=0,n=0,b=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0,g=0,_=0;u=E-16|0,E=u,l=t[r+12>>2],b=l+((i+a|0)/2<<4)|0,g=t[b+8>>2],s=t[b+4>>2],d=t[b>>2],_=r+12|0,b=i,c=a;A:for(;;){for(n=8+((b<<4)+l|0)|0,k=t[n+-4>>2],f=1,(0|k)<(0|s)||(f=0);;){r:{e:{i:{a:{if(f){if(b=b+1|0,n=n+16|0,k=t[n+-4>>2],(0|k)<(0|s))break a;f=0;continue;}if((0|k)==(0|s)){if(f=t[n+-8>>2],(0|f)<(0|d))break i;if((0|f)==(0|d)&&t[n>>2]<(0|g))break e;}for(f=c<<4;;){f:{if(k=f+l|0,o=t[k+4>>2],!((0|s)<(0|o))){if((0|o)!=(0|s))break f;if(o=t[k>>2],!((0|d)<(0|o))&&(0|o)!=(0|d)|(0|g)>=t[k+8>>2])break f;}f=f+-16|0,c=c+-1|0;continue;}break;}if((0|b)<=(0|c)&&(v=t[n+4>>2],l=u+8|0,o=l,t[o>>2]=t[n>>2],t[o+4>>2]=v,o=n+-8|0,C=t[o+4>>2],t[u>>2]=t[o>>2],t[u+4>>2]=C,v=k+8|0,C=t[v+4>>2],t[n>>2]=t[v>>2],t[n+4>>2]=C,n=t[k+4>>2],t[o>>2]=t[k>>2],t[o+4>>2]=n,k=t[u+4>>2],f=t[_>>2]+f|0,n=f,t[n>>2]=t[u>>2],t[n+4>>2]=k,n=t[l+4>>2],f=f+8|0,t[f>>2]=t[l>>2],t[f+4>>2]=n,c=c+-1|0,b=b+1|0),(0|b)<=(0|c)){l=t[_>>2];continue A;}f:{if((0|c)<=(0|i)){if((0|b)<(0|a))break f;break r;}if(A(r,e,i,c),(0|b)>=(0|a))break r;}return A(r,e,b,a),void(E=u+16|0);}f=1;continue;}f=1;continue;}f=1;continue;}break;}break;}E=u+16|0;}(i+24|0,i+8|0,0,e+-1|0);}if(t[A+44>>2]=e,t[A+40>>2]=0,t[A+36>>2]=t[A+32>>2],u=A+84|0,n=t[u>>2],(0|n)<(0|e)){if(t[A+88>>2]<(0|e)){A:{r:{if(e){if(o=CA(e<<2,16),f=t[A+84>>2],(0|f)>=1)break r;break A;}if(o=0,f=n,(0|f)<1)break A;}for(r=0,v=A+92|0;t[r+o>>2]=t[t[v>>2]+r>>2],r=r+4|0,f=f+-1|0,f;){}}r=A+92|0,f=t[r>>2],f&&(b[A+96|0]&&gA(f),t[A+92>>2]=0),t[r>>2]=o,a[A+96|0]=1,t[A+88>>2]=e;}for(r=n<<2,f=e-n|0,n=A+92|0;t[t[n>>2]+r>>2]=0,r=r+4|0,f=f+-1|0,f;){}}if(t[u>>2]=e,(0|e)>=1)for(u=A+40|0,v=A+36|0,R=A+44|0,Q=A+32|0,c=A+92|0,G=0;;){n=t[u>>2];A:if(!n){r=t[v>>2];r:{if(r){if(t[v>>2]=t[r+8>>2],n=t[r>>2],o=t[r+4>>2],(0|o)>=1)break r;break A;}if(r=CA(12,16),t[r+8>>2]=0,f=t[R>>2],t[r+4>>2]=f,Y=r,N=CA(_(f,112),16),t[Y>>2]=N,f=t[Q>>2],t[Q>>2]=r,t[r+8>>2]=f,n=t[r>>2],o=t[r+4>>2],(0|o)<1)break A;}for(r=0,f=n;d=f,f=f+112|0,r=r+1|0,t[d>>2]=(0|r)<(0|o)?f:0,(0|r)!=(0|o);){}}if(t[u>>2]=t[n>>2],r=n+8|0,t[r>>2]=0,t[r+4>>2]=0,t[n+16>>2]=0,t[n>>2]=0,t[n+4>>2]=0,t[n+104>>2]=-1,t[r>>2]=0,r=t[i+36>>2]+(G<<4)|0,f=t[r+4>>2],t[n+88>>2]=t[r>>2],t[n+92>>2]=f,r=r+8|0,f=t[r+4>>2],o=n+96|0,t[o>>2]=t[r>>2],t[o+4>>2]=f,t[n+104>>2]=-1,t[t[c>>2]+(G<<2)>>2]=n,G=G+1|0,(0|G)==(0|e))break;}r=i+36|0,f=t[r>>2],f&&(b[i+40|0]&&gA(f),t[i+36>>2]=0),t[A+116>>2]=0,t[A+120>>2]=0,t[A+100>>2]=-3,t[r>>2]=0,f=i+40|0,a[0|f]=1,t[A+60>>2]=_(e,6),t[A+56>>2]=0,t[A+52>>2]=t[A+48>>2],t[i+28>>2]=0,t[i+32>>2]=0,n=i+16|0,t[n>>2]=0,t[n+4>>2]=0,t[i+8>>2]=0,t[i+12>>2]=0,TA(A,0,e,i+8|0),t[A+124>>2]=t[i+8>>2],A=t[r>>2],A&&(b[0|f]&&gA(A),t[i+36>>2]=0),E=i+48|0;}function HA(A,r,e){var i,a=B(0),f=B(0),n=0,b=0;i=E-16|0,E=i;A:{r:{e:{if(n=e+100|0,t[n>>2]>=0)C[(t[r+108>>2]<<2)+i>>2]=t[e+88>>2];else if(a=zA(e+24|0),b=e+72|0,f=zA(b),C[(t[r+108>>2]<<2)+i>>2]=a/f,t[n>>2]<0)break e;C[(t[r+112>>2]<<2)+i>>2]=t[e+92>>2];break r;}if(a=zA(e+40|0),f=zA(b),C[(t[r+112>>2]<<2)+i>>2]=a/f,!(t[e+100>>2]>=0)){a=B(zA(e+56|0)/zA(e+72|0));break A;}}a=B(t[e+96>>2]);}C[(t[r+104>>2]<<2)+i>>2]=a,t[A+12>>2]=0,C[A+8>>2]=B(C[i+8>>2]*C[r+8>>2])+C[r+24>>2],C[A+4>>2]=B(C[i+4>>2]*C[r+4>>2])+C[r+20>>2],C[A>>2]=B(C[i>>2]*C[r>>2])+C[r+16>>2],E=i+16|0;}function zA(A){var r,e,i=0,a=0,f=0,n=B(0);return r=E-16|0,E=r,i=t[A+12>>2],a=i,e=t[A+8>>2],(0|i)<0||(0|i)<=0&&!(e>>>0>=0)?(f=t[A+4>>2],i=t[A>>2],A=i,t[r>>2]=0-A,t[r+4>>2]=0-(f+(0<A>>>0)|0),a^=-1,A=!(A|f),f=-1^e,i=A+f|0,i>>>0<f>>>0&&(a=a+1|0),A=r,t[A+8>>2]=i,t[A+12>>2]=a,n=zA(A),E=A+16|0,B(-n)):(E=r+16|0,B(B(B(+(e>>>0)+4294967296*+(a>>>0))*B(0x10000000000000000))+B(+v[A>>2]+4294967296*+v[A+4>>2])));}function PA(A,r,e){var i,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0,g=0,B=0,m=0,R=0,G=0,h=0,y=0,Q=0,p=0,D=0,w=0,W=0,F=0,Z=0,Y=0,N=0,V=0,I=0,J=0,X=0,M=0,S=0,T=0,U=0,j=0;i=E-144|0,E=i;A:{if(!((0|e)>0))return r=t[A+12>>2],r&&(b[A+16|0]&&gA(r),t[A+12>>2]=0),a[A+16|0]=1,t[A+12>>2]=0,r=A+4|0,t[r>>2]=0,t[r+4>>2]=0,r=A+32|0,e=t[r>>2],e&&(b[A+36|0]&&gA(e),t[A+32>>2]=0),t[r>>2]=0,a[A+36|0]=1,r=A+24|0,t[r>>2]=0,t[r+4>>2]=0,r=A+52|0,e=t[r>>2],e&&(b[A+56|0]&&gA(e),t[A+52>>2]=0),t[r>>2]=0,a[A+56|0]=1,A=A+44|0,t[A>>2]=0,t[A+4>>2]=0,void(E=i+144|0);if(a[i+112|0]=1,n=i+88|0,t[n>>2]=0,t[n+4>>2]=256,n=i+72|0,t[n>>2]=0,t[n+4>>2]=256,n=i+56|0,t[n>>2]=0,t[n+4>>2]=256,t[i+108>>2]=0,n=i+100|0,t[n>>2]=0,t[n+4>>2]=0,t[i+80>>2]=0,t[i+84>>2]=0,t[i+64>>2]=0,t[i+68>>2]=0,t[i+48>>2]=0,t[i+52>>2]=0,OA(i+16|0,r,e),r=t[A+4>>2],(0|r)<=-1)for(t[A+8>>2]<=-1&&(e=t[A+12>>2],e&&(b[A+16|0]&&gA(e),t[A+12>>2]=0),a[A+16|0]=1,e=A+8|0,t[e>>2]=0,t[e+4>>2]=0),e=r<<4,n=A+12|0;c=t[i+4>>2],k=t[n>>2]+e|0,t[k>>2]=t[i>>2],t[k+4>>2]=c,c=i+8|0,d=t[c+4>>2],k=k+8|0,t[k>>2]=t[c>>2],t[k+4>>2]=d,e=e+16|0,r=r+1|0,r;){}if(t[A+4>>2]=0,t[i+8>>2]=0,t[i>>2]=0,t[i+4>>2]=0,c=A+24|0,r=t[c>>2],(0|r)<=-1)for(t[A+28>>2]<=-1&&(e=t[A+32>>2],e&&(b[A+36|0]&&gA(e),t[A+32>>2]=0),a[A+36|0]=1,e=A+28|0,t[e>>2]=0,t[e+4>>2]=0),e=_(r,12),k=A+32|0;d=t[i+4>>2],n=t[k>>2]+e|0,t[n>>2]=t[i>>2],t[n+4>>2]=d,t[n+8>>2]=t[i+8>>2],e=e+12|0,r=r+1|0,r;){}if(t[c>>2]=0,e=A+44|0,n=t[e>>2],(0|n)<=-1&&(r=t[A+52>>2],t[A+48>>2]<=-1?(!r|!b[A+56|0]||gA(r),a[A+56|0]=1,r=A+48|0,t[r>>2]=0,t[r+4>>2]=0,k=0):k=r,r=n<<2,x(k+r|0,0,0-r|0)),t[e>>2]=0,r=t[i+140>>2],!(t[r+104>>2]>-1))for(t[r+104>>2]=0,c=CA(4,16),t[c>>2]=r,V=A+8|0,h=A+12|0,C=A+24|0,D=A+28|0,v=A+32|0,w=A+36|0,k=1,d=1,I=c,n=c,e=0;;){r:{e:{if(e){if(Y=t[t[(F<<Z)+c>>2]+8>>2],!Y)break e;R=Y,e=1;}else {if(l=t[(y<<2)+c>>2],HA(i,i+16|0,l),o=A+4|0,r=t[o>>2],(0|r)==t[V>>2]&&(B=r?r<<1:1,!((0|r)>=(0|B)))){i:{a:{if(B){if(u=CA(B<<4,16),r=t[o>>2],(0|r)>=1)break a;break i;}if(u=0,(0|r)<1)break i;}for(e=0;f=t[h>>2]+e|0,g=t[f+4>>2],s=e+u|0,t[s>>2]=t[f>>2],t[s+4>>2]=g,f=f+8|0,g=t[f+4>>2],s=s+8|0,t[s>>2]=t[f>>2],t[s+4>>2]=g,e=e+16|0,r=r+-1|0,r;){}}r=t[h>>2],r&&(b[A+16|0]&&gA(r),t[h>>2]=0),t[h>>2]=u,a[A+16|0]=1,t[V>>2]=B,r=t[o>>2];}if(e=t[i+4>>2],r=t[h>>2]+(r<<4)|0,t[r>>2]=t[i>>2],t[r+4>>2]=e,g=i+8|0,e=g,u=t[e+4>>2],r=r+8|0,t[r>>2]=t[e>>2],t[r+4>>2]=u,t[o>>2]=t[o>>2]+1,B=t[l+8>>2],!B)break r;W=-1,m=B,J=-1,e=0;}for(;;){i:{a:{if(!e){e=t[m+20>>2];f:{n:{if((0|e)<=-1){if(u=t[C>>2],t[g>>2]=0,t[i>>2]=0,t[i+4>>2]=0,e=u,(0|e)==t[D>>2]&&(f=e?u<<1:1,!((0|e)>=(0|f)))){t:{b:{if(f){if(o=CA(_(f,12),16),r=t[C>>2],(0|r)>=1)break b;break t;}if(o=0,r=u,(0|r)<1)break t;}for(e=0;l=t[v>>2]+e|0,N=t[l+4>>2],s=e+o|0,t[s>>2]=t[l>>2],t[s+4>>2]=N,t[s+8>>2]=t[l+8>>2],e=e+12|0,r=r+-1|0,r;){}}r=t[v>>2],r&&(b[0|w]&&gA(r),t[v>>2]=0),t[v>>2]=o,a[0|w]=1,t[D>>2]=f,e=t[C>>2];}if(o=t[i+4>>2],r=t[v>>2]+_(e,12)|0,t[r>>2]=t[i>>2],t[r+4>>2]=o,t[r+8>>2]=t[g>>2],r=t[C>>2]+1|0,t[C>>2]=r,t[g>>2]=0,t[i>>2]=0,t[i+4>>2]=0,t[D>>2]==(0|r)&&(f=r?r<<1:1,!((0|r)>=(0|f)))){t:{b:{if(f){if(o=CA(_(f,12),16),r=t[C>>2],(0|r)>=1)break b;break t;}if(o=0,(0|r)<1)break t;}for(e=0;l=t[v>>2]+e|0,N=t[l+4>>2],s=e+o|0,t[s>>2]=t[l>>2],t[s+4>>2]=N,t[s+8>>2]=t[l+8>>2],e=e+12|0,r=r+-1|0,r;){}}r=t[v>>2],r&&(b[0|w]&&gA(r),t[v>>2]=0),t[v>>2]=o,a[0|w]=1,t[D>>2]=f,r=t[C>>2];}if(e=t[i+4>>2],r=t[v>>2]+_(r,12)|0,t[r>>2]=t[i>>2],t[r+4>>2]=e,t[r+8>>2]=t[g>>2],t[C>>2]=t[C>>2]+1,f=m+20|0,t[f>>2]=u,l=u+1|0,t[t[m+8>>2]+20>>2]=l,s=t[v>>2],u=s+_(u,12)|0,t[u+4>>2]=1,t[u+16>>2]=-1,o=t[m+12>>2],r=t[o+104>>2],(0|r)>-1)e=k,k=r;else {t[o+104>>2]=k;t:{b:{o:{if((0|k)==(0|d)&&(r=d?d<<1:1,!((0|d)>=(0|r)))){if(!r)break o;n=CA(r<<2,16);break b;}r=d;break t;}n=0;}b:{if((0|d)>=1)for(e=n;t[e>>2]=t[c>>2],e=e+4|0,c=c+4|0,d=d+-1|0,d;){}else if(!c)break b;gA(I);}I=n,c=n;}t[(k<<2)+c>>2]=o,e=k+1|0,d=r;}if(t[8+(s+_(l,12)|0)>>2]=y,t[u+8>>2]=k,k=e,e=t[f>>2],r=e,(0|W)>=0)break n;break f;}if(r=e,(0|W)<0)break f;}t[t[v>>2]+_(e,12)>>2]=W-e,r=J;}if(W=e,J=r,m=t[m>>2],(0|m)!=(0|B))break a;t[t[v>>2]+_(r,12)>>2]=e-r;break r;}if(e=t[R+20>>2],(0|e)>=0){if(f=t[Q>>2],(0|f)==t[X>>2]&&(l=f?f<<G:G,!((0|f)>=(0|l)))){f:{n:{t:{if(l){if(u=CA(l<<Z,U),o=t[p>>2],f=t[Q>>2],(0|f)<(0|G))break t;}else if(u=0,o=t[p>>2],(0|f)<(0|G))break t;for(e=u,r=o;t[e>>2]=t[r>>2],e=e+M|0,r=r+M|0,f=f+S|0,f;){}break n;}if(!o)break f;}b[0|T]&&gA(o),t[p>>2]=0,f=t[Q>>2];}t[X>>2]=l,t[p>>2]=u,a[0|T]=G,e=t[R+j>>2];}for(t[t[p>>2]+(f<<Z)>>2]=e,t[Q>>2]=t[Q>>2]+G,e=R;t[e+20>>2]=S,e=t[t[e+8>>2]+4>>2],(0|R)!=(0|e);){}}if(R=t[R>>2],(0|Y)!=(0|R))break i;break e;}e=0;continue;}e=1;}}if(F=G+F|0,(0|y)==(0|F)){if(!c)break A;gA(n);break A;}e=1;continue;}y=y+1|0,(0|y)>=(0|k)?(Z=2,G=1,X=A+48|0,Q=A+44|0,p=A+52|0,M=4,S=-1,T=A+56|0,j=20,U=16,F=0,e=1):e=0;}}if(A=i+108|0,r=t[A>>2],r&&(b[i+112|0]&&gA(r),t[i+108>>2]=0),t[A>>2]=0,a[i+112|0]=1,A=i+100|0,t[A>>2]=0,t[A+4>>2]=0,e=t[i+80>>2],e)for(A=i+80|0;t[A>>2]=t[e+8>>2],gA(t[e>>2]),gA(e),e=t[A>>2],e;){}if(e=t[i+64>>2],e)for(A=i- -64|0;t[A>>2]=t[e+8>>2],gA(t[e>>2]),gA(e),e=t[A>>2],e;){}if(e=t[i+48>>2],e)for(A=i+48|0;t[A>>2]=t[e+8>>2],gA(t[e>>2]),gA(e),e=t[A>>2],e;){}E=i+144|0;}function LA(A){return ZA(A),t[A+56>>2]=0,t[A>>2]=7168,A;}function KA(A,r){var e=0,i=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0,g=0,B=0,m=0;if(t[A+8>>2]<(0|r)){A:{r:{if(r){if(C=CA(_(r,36),16),l=t[A+4>>2],(0|l)>=1)break r;break A;}if(l=t[A+4>>2],(0|l)<1)break A;}for(;;){e=_(s,36),f=e+C|0,t[f+4>>2]=0,t[f+8>>2]=0,a[f+16|0]=1,t[f+12>>2]=0,d=f+4|0;r:{e:{i:{a:{if(c=e+t[A+12>>2]|0,n=t[c+4>>2],(0|n)>=1){if(m=f+8|0,g=f+16|0,B=n<<2,o=CA(B,16),v=f+12|0,u=t[v>>2],k=t[d>>2],(0|k)<1)break a;for(i=o,e=u;t[i>>2]=t[e>>2],i=i+4|0,e=e+4|0,k=k+-1|0,k;){}break i;}t[d>>2]=n;break r;}if(!u)break e;}b[0|g]&&gA(u);}for(t[v>>2]=o,a[0|g]=1,t[m>>2]=n,x(o,0,B),t[d>>2]=n,i=t[c+12>>2],e=t[v>>2];t[e>>2]=t[i>>2],e=e+4|0,i=i+4|0,n=n+-1|0,n;){}}if(e=t[c+24>>2],t[f+20>>2]=t[c+20>>2],t[f+24>>2]=e,i=c+28|0,o=t[i+4>>2],e=f+28|0,t[e>>2]=t[i>>2],t[e+4>>2]=o,s=s+1|0,(0|s)==(0|l))break;}if(k=t[A+4>>2],!((0|k)<1))for(u=A+12|0,e=8;i=t[u>>2]+e|0,f=i+-4|0,o=i+4|0,n=t[o>>2],n&&(b[i+8|0]&&gA(n),t[o>>2]=0),t[f>>2]=0,t[o>>2]=0,t[i>>2]=0,a[i+8|0]=1,e=e+36|0,k=k+-1|0,k;){}}e=t[A+12>>2],e&&(b[A+16|0]&&gA(e),t[A+12>>2]=0),a[A+16|0]=1,t[A+12>>2]=C,t[A+8>>2]=r;}}function qA(A,r){var e,i,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0;u=t[A+4>>2],(0|u)==t[A+8>>2]&&(KA(A,u?u<<1:1),u=t[A+4>>2]),i=t[A+12>>2],f=i+_(u,36)|0,t[f+4>>2]=0,t[f+8>>2]=0,a[f+16|0]=1,t[f+12>>2]=0,e=f+4|0;A:{r:{e:{i:{if(o=t[r+4>>2],(0|o)>=1){if(C=f+8|0,d=f+16|0,v=o<<2,n=CA(v,16),s=f+12|0,f=t[s>>2],l=t[e>>2],(0|l)<1)break i;for(k=n,c=f;t[k>>2]=t[c>>2],k=k+4|0,c=c+4|0,l=l+-1|0,l;){}break e;}t[e>>2]=o;break A;}if(!f)break r;}b[0|d]&&gA(f);}for(t[s>>2]=n,a[0|d]=1,t[C>>2]=o,x(n,0,v),t[e>>2]=o,k=t[r+12>>2],c=t[s>>2];t[c>>2]=t[k>>2],c=c+4|0,k=k+4|0,o=o+-1|0,o;){}}f=t[r+24>>2],n=_(u,36)+i|0,t[n+20>>2]=t[r+20>>2],t[n+24>>2]=f,f=r+28|0,r=t[f+4>>2],n=n+28|0,t[n>>2]=t[f>>2],t[n+4>>2]=r,A=A+4|0,t[A>>2]=t[A>>2]+1;}function $A(A,r,e){var i,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,g=0,R=B(0),G=0,h=0,y=B(0),p=0,D=B(0),w=B(0),W=0,F=B(0),Z=B(0),Y=0,N=0,V=0,I=B(0),J=0,X=0,M=B(0),x=0,S=B(0),T=0,U=0,j=B(0),O=B(0),H=B(0),z=0,P=0,L=B(0),K=0,q=0,$=0,AA=B(0),rA=0,eA=0,iA=0,aA=0,fA=0,nA=0,tA=0,bA=0,oA=0,kA=0,cA=0,uA=0,lA=0,sA=0;i=E-32|0,E=i;A:{r:{e:{R=C[e+8>>2];i:{if(B(m(R))>B(.7071067690849304)){if(D=C[e+4>>2],w=B(B(R*R)+B(D*D)),y=B(B(1)/B(Q(w))),I=B(w*y),Z=C[e>>2],w=B(-B(R*y)),S=B(Z*w),D=B(D*y),F=B(-B(Z*D)),Z=B(0),k=t[A+4>>2],(0|k)<2)break i;break e;}if(w=C[e>>2],D=C[e+4>>2],Z=B(B(w*w)+B(D*D)),y=B(B(1)/B(Q(Z))),S=B(Z*y),Z=B(-B(D*y)),F=B(R*Z),w=B(w*y),I=B(-B(R*w)),D=B(0),k=t[A+4>>2],(0|k)>=2)break e;}if(J=1,1!=(0|k))break A;G=t[r+4>>2],T=8,$=r+8|0,z=12,nA=A+12|0,X=16,P=24,tA=-1,bA=4,U=r+4|0,f=0;break r;}for(f=t[A+12>>2],d=A+12|0;n=f+l|0,s=n+8|0,B(B(B(Z*C[n>>2])+B(w*C[n+4>>2]))+B(D*C[s>>2]))<B(B(B(Z*C[f>>2])+B(w*C[f+4>>2]))+B(D*C[f+8>>2]))&&(v=f+16|0,c=v,u=t[c+4>>2],k=i+24|0,t[k>>2]=t[c>>2],t[k+4>>2]=u,c=f+8|0,g=t[c+4>>2],p=i+16|0,u=p,t[u>>2]=t[c>>2],t[u+4>>2]=g,u=t[f+4>>2],t[i+8>>2]=t[f>>2],t[i+12>>2]=u,u=n+16|0,W=t[u+4>>2],t[v>>2]=t[u>>2],t[v+4>>2]=W,v=t[s+4>>2],t[c>>2]=t[s>>2],t[c+4>>2]=v,s=t[n+4>>2],t[f>>2]=t[n>>2],t[f+4>>2]=s,s=t[i+12>>2],f=t[d>>2]+l|0,t[f>>2]=t[i+8>>2],t[f+4>>2]=s,s=t[k+4>>2],n=f+16|0,t[n>>2]=t[k>>2],t[n+4>>2]=s,n=t[p+4>>2],f=f+8|0,t[f>>2]=t[p>>2],t[f+4>>2]=n,f=t[d>>2],k=t[A+4>>2]),l=l+24|0,o=o+1|0,(0|o)<(0|k);){}if(t[f+16>>2]=-246811958,(0|k)>=2)for(l=k+-1|0,n=f+40|0,j=C[f+8>>2],O=C[f>>2],L=C[f+4>>2];y=B(0),c=n,R=B(C[n+-16>>2]-O),H=B(C[n+-12>>2]-L),AA=B(C[n+-8>>2]-j),M=B(B(B(I*R)+B(F*H))+B(S*AA)),R=B(B(B(Z*R)+B(w*H))+B(D*AA)),B(B(M*M)+B(R*R))<B(1.1920928955078125e-7)||(y=B(m(M)),R>=B(0)?(R=B(B(R-y)/B(R+y)),y=B(.7853981852531433)):(R=B(B(R+y)/B(y-R)),y=B(2.356194496154785)),R=B(y+B(R*B(-.7853981852531433))),y=M<B(0)?B(-R):R),C[c>>2]=y,n=n+24|0,l=l+-1|0,l;){}if(n=f+8|0,l=t[n+4>>2],o=i+16|0,t[o>>2]=t[n>>2],t[o+4>>2]=l,o=t[f+4>>2],t[i+8>>2]=t[f>>2],t[i+12>>2]=o,function A(r,e,i,a){var f=B(0),n=0,b=0,o=0,k=B(0),c=0,u=0,l=B(0),s=0,d=0,v=0,g=0,m=0,R=B(0),G=0,h=B(0),y=B(0),Q=B(0),p=0,D=0,w=0,W=B(0),F=B(0),Z=B(0),Y=0,N=0,V=0;d=E-32|0,E=d,s=t[r+12>>2],b=s+_((i+a|0)/2|0,24)|0,D=t[b+20>>2],R=C[b+16>>2],W=C[b+8>>2],F=C[b+4>>2],Z=C[b>>2],Y=e+4|0,N=e+8|0,w=r+12|0,b=i,v=a;e:for(;;){for(h=C[e>>2],k=B(Z-h),l=B(k*k),y=C[Y>>2],k=B(F-y),l=B(l+B(k*k)),Q=C[N>>2],k=B(W-Q),k=B(l+B(k*k)),n=20+(_(b,24)+s|0)|0,c=n+-4|0,f=C[c>>2],o=0,f==R&&(o=1);;){i:{a:{f:{n:{if(!o){if(f<R)break n;break f;}if(f=B(C[n+-20>>2]-h),l=B(f*f),f=B(C[n+-16>>2]-y),l=B(l+B(f*f)),f=B(C[n+-12>>2]-Q),f=B(l+B(f*f)),f!=k){if(f<k)break n;break f;}if(t[n>>2]>=(0|D))break f;}if(b=b+1|0,n=n+24|0,c=n+-4|0,f=C[c>>2],f==R)break a;o=0;continue;}for(o=_(v,24);;){f:{u=o+s|0,G=u+16|0,f=C[G>>2];n:{if(R!=f){if(R<f)break n;break f;}if(f=B(C[u>>2]-h),l=B(f*f),f=B(C[u+4>>2]-y),l=B(l+B(f*f)),f=B(C[u+8>>2]-Q),f=B(l+B(f*f)),k!=f){if(k<f)break n;break f;}if((0|D)>=t[u+20>>2])break f;}o=o+-24|0,v=v+-1|0;continue;}break;}if((0|b)<=(0|v)&&(g=t[c+4>>2],s=d+24|0,t[s>>2]=t[c>>2],t[s+4>>2]=g,g=n+-12|0,V=t[g+4>>2],p=d+16|0,m=p,t[m>>2]=t[g>>2],t[m+4>>2]=V,n=n+-20|0,m=t[n+4>>2],t[d+8>>2]=t[n>>2],t[d+12>>2]=m,m=t[G+4>>2],t[c>>2]=t[G>>2],t[c+4>>2]=m,c=u+8|0,G=t[c+4>>2],t[g>>2]=t[c>>2],t[g+4>>2]=G,c=t[u+4>>2],t[n>>2]=t[u>>2],t[n+4>>2]=c,u=t[d+12>>2],o=t[w>>2]+o|0,n=o,t[n>>2]=t[d+8>>2],t[n+4>>2]=u,u=t[s+4>>2],n=n+16|0,t[n>>2]=t[s>>2],t[n+4>>2]=u,n=t[p+4>>2],o=o+8|0,t[o>>2]=t[p>>2],t[o+4>>2]=n,v=v+-1|0,b=b+1|0),(0|b)<=(0|v)){s=t[w>>2];continue e;}f:{if((0|v)<=(0|i)){if((0|b)<(0|a))break f;break i;}if(A(r,e,i,v),(0|b)>=(0|a))break i;}return A(r,e,b,a),void(E=d+32|0);}o=1;continue;}break;}break;}E=d+32|0;}(A,i+8|0,1,k+-1|0),v=A+12|0,n=t[v>>2],o=t[r+4>>2],(0|o)==t[r+8>>2]&&(l=o?o<<1:1,!((0|o)>=(0|l)))){e:{i:{if(l){if(s=CA(_(l,24),16),o=t[r+4>>2],(0|o)>=1)break i;break e;}if(s=0,(0|o)<1)break e;}for(f=0,p=r+12|0;u=t[p>>2]+f|0,k=u,W=t[k+4>>2],d=f+s|0,c=d,t[c>>2]=t[k>>2],t[c+4>>2]=W,k=k+16|0,W=t[k+4>>2],c=c+16|0,t[c>>2]=t[k>>2],t[c+4>>2]=W,k=u+8|0,c=t[k+4>>2],d=d+8|0,t[d>>2]=t[k>>2],t[d+4>>2]=c,f=f+24|0,o=o+-1|0,o;){}}f=r+12|0,o=t[f>>2],o&&(b[r+16|0]&&gA(o),t[r+12>>2]=0),t[f>>2]=s,a[r+16|0]=1,t[r+8>>2]=l,o=t[r+4>>2];}if(l=t[n+4>>2],f=t[r+12>>2]+_(o,24)|0,t[f>>2]=t[n>>2],t[f+4>>2]=l,l=n+16|0,s=t[l+4>>2],o=f+16|0,t[o>>2]=t[l>>2],t[o+4>>2]=s,o=n+8|0,n=t[o+4>>2],f=f+8|0,t[f>>2]=t[o>>2],t[f+4>>2]=n,d=r+4|0,o=t[d>>2]+1|0,t[d>>2]=o,n=t[v>>2]+24|0,t[r+8>>2]==(0|o)&&(l=o?o<<1:1,!((0|o)>=(0|l)))){e:{i:{if(l){if(s=CA(_(l,24),16),o=t[r+4>>2],(0|o)>=1)break i;break e;}if(s=0,(0|o)<1)break e;}for(f=0,p=r+12|0;u=t[p>>2]+f|0,W=t[u+4>>2],k=f+s|0,t[k>>2]=t[u>>2],t[k+4>>2]=W,v=u+16|0,W=t[v+4>>2],c=k+16|0,t[c>>2]=t[v>>2],t[c+4>>2]=W,v=u+8|0,c=t[v+4>>2],k=k+8|0,t[k>>2]=t[v>>2],t[k+4>>2]=c,f=f+24|0,o=o+-1|0,o;){}}f=r+12|0,o=t[f>>2],o&&(b[r+16|0]&&gA(o),t[r+12>>2]=0),t[f>>2]=s,a[r+16|0]=1,t[r+8>>2]=l,o=t[r+4>>2];}if(rA=12,l=t[n+4>>2],v=r+12|0,f=t[v>>2]+_(o,24)|0,t[f>>2]=t[n>>2],t[f+4>>2]=l,l=n+16|0,s=t[l+4>>2],o=f+16|0,t[o>>2]=t[l>>2],t[o+4>>2]=s,l=8,o=n+8|0,n=t[o+4>>2],f=f+8|0,t[f>>2]=t[o>>2],t[f+4>>2]=n,o=1,n=t[d>>2]+1|0,t[d>>2]=n,eA=2,2==t[A+4>>2])break A;p=24,iA=-48,aA=48,oA=e+8|0,s=4,kA=e+4|0,cA=32,uA=28,K=-1,d=16,lA=-24,sA=-2,W=2,f=1;}for(;;){r:{e:{if(!f){if(k=t[nA>>2],t[$>>2]==(0|G)&&(u=G?G<<J:J,!((0|G)>=(0|u)))){i:{a:{if(u){if(c=CA(_(u,P),X),G=t[U>>2],(0|G)>=(0|J))break a;break i;}if(c=0,(0|G)<(0|J))break i;}for(f=0;N=t[r+z>>2]+f|0,h=N,Y=t[h+4>>2],g=f+c|0,t[g>>2]=t[h>>2],t[g+4>>2]=Y,h=h+X|0,Y=t[h+4>>2],V=g+X|0,t[V>>2]=t[h>>2],t[V+4>>2]=Y,h=N+T|0,V=t[h+4>>2],g=g+T|0,t[g>>2]=t[h>>2],t[g+4>>2]=V,f=f+P|0,G=G+tA|0,G;){}}f=r+z|0,G=t[f>>2],G&&(b[r+X|0]&&gA(G),t[f>>2]=0),t[f>>2]=c,a[r+X|0]=J,t[$>>2]=u,G=t[U>>2];}if(c=t[k+4>>2],f=t[r+z>>2]+_(G,P)|0,t[f>>2]=t[k>>2],t[f+4>>2]=c,c=k+X|0,u=t[c+4>>2],G=f+X|0,t[G>>2]=t[c>>2],t[G+4>>2]=u,k=k+T|0,G=t[k+4>>2],f=f+T|0,t[f>>2]=t[k>>2],t[f+4>>2]=G,G=t[U>>2]+J|0,t[U>>2]=G,fA=J+fA|0,(0|fA)<t[A+bA>>2])break e;break A;}i:{a:{f:{if((0|n)>=(0|eA))for(g=t[v>>2],f=(g+_(n,p)|0)+iA|0,u=t[A+rA>>2]+_(p,W)|0,R=C[u+8>>2],y=C[u+4>>2],w=C[u>>2],c=_(n,aA),k=n<<o,D=C[oA>>2],Z=C[kA>>2],M=C[e>>2];;){if(I=C[f>>2],S=B(I-C[f+p>>2]),F=C[f+s>>2],j=B(F-y),F=B(F-C[f+uA>>2]),I=B(I-w),H=B(B(B(S*j)-B(F*I))*D),L=F,F=C[f+l>>2],O=B(F-R),F=B(F-C[f+cA>>2]),!(B(H+B(B(M*B(B(L*O)-B(F*j)))+B(Z*B(B(F*I)-B(S*O)))))>B(0)^o))break f;if(n=n+K|0,t[r+s>>2]=n,f=f+lA|0,c=c+iA|0,k=k+sA|0,!((0|n)>(0|o)))break;}if((0|n)==(0|o))break a;break i;}if(V=r+l|0,!(t[V>>2]!=(0|n)|(0|n)>=(0|k))){if(g=CA(c,d),N=r+s|0,c=t[N>>2],(0|c)>=(0|o))for(f=0;x=t[v>>2]+f|0,h=x,q=t[h+4>>2],n=f+g|0,t[n>>2]=t[h>>2],t[n+4>>2]=q,h=d+h|0,q=t[h+4>>2],Y=n+d|0,t[Y>>2]=t[h>>2],t[Y+4>>2]=q,h=l+x|0,Y=t[h+4>>2],n=n+l|0,t[n>>2]=t[h>>2],t[n+4>>2]=Y,f=f+p|0,c=c+K|0,c;){}f=t[v>>2],f&&(b[r+d|0]&&gA(f),t[v>>2]=0),t[v>>2]=g,a[r+d|0]=o,t[V>>2]=k,n=t[N>>2];}if(k=t[u+4>>2],f=_(n,p)+g|0,t[f>>2]=t[u>>2],t[f+4>>2]=k,k=u+d|0,c=t[k+4>>2],n=f+d|0,t[n>>2]=t[k>>2],t[n+4>>2]=c,n=l+u|0,k=t[n+4>>2],f=f+l|0,t[f>>2]=t[n>>2],t[f+4>>2]=k,f=r+s|0,n=t[f>>2]+o|0,t[f>>2]=n,(0|n)!=(0|o))break i;}if(n=t[A+rA>>2]+_(p,W)|0,f=1,h=r+l|0,1==t[h>>2]){if(k=CA(aA,d),V=r+s|0,c=t[V>>2],(0|c)>=(0|o))for(f=0;Y=t[v>>2]+f|0,g=Y,x=t[g+4>>2],u=f+k|0,t[u>>2]=t[g>>2],t[u+4>>2]=x,g=d+g|0,x=t[g+4>>2],N=u+d|0,t[N>>2]=t[g>>2],t[N+4>>2]=x,g=l+Y|0,N=t[g+4>>2],u=l+u|0,t[u>>2]=t[g>>2],t[u+4>>2]=N,f=f+p|0,c=c+K|0,c;){}f=t[v>>2],f&&(b[r+d|0]&&gA(f),t[v>>2]=0),t[v>>2]=k,a[r+d|0]=o,t[h>>2]=eA,f=t[V>>2];}c=t[n+4>>2],f=t[v>>2]+_(f,p)|0,t[f>>2]=t[n>>2],t[f+4>>2]=c,c=n+d|0,u=t[c+4>>2],k=f+d|0,t[k>>2]=t[c>>2],t[k+4>>2]=u,n=n+l|0,k=t[n+4>>2],f=f+l|0,t[f>>2]=t[n>>2],t[f+4>>2]=k,f=r+s|0,n=t[f>>2]+o|0,t[f>>2]=n;}if(W=o+W|0,(0|W)!=t[A+s>>2])break r;break A;}f=0;continue;}f=1;}}E=i+32|0;}function Ar(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0);a=B(yf[t[t[A>>2]+48>>2]](A)),D=C[r+52>>2],b=C[r+24>>2],o=C[r+20>>2],k=C[r+56>>2],c=C[r+40>>2],u=C[A+68>>2],v=C[A+84>>2],g=C[r+36>>2],f=C[A- -64>>2],_=C[A+80>>2],w=C[r+48>>2],R=C[r+8>>2],G=C[r>>2],h=C[r+4>>2],y=C[r+16>>2],Q=C[r+32>>2],n=C[A+60>>2],p=C[A+76>>2],t[e+12>>2]=0,l=k,k=B(B(p+n)*B(.5)),s=B(B(_+f)*B(.5)),d=B(B(v+u)*B(.5)),l=B(l+B(B(B(Q*k)+B(g*s))+B(c*d))),n=B(a+B(B(p-n)*B(.5))),f=B(a+B(B(_-f)*B(.5))),a=B(a+B(B(v-u)*B(.5))),c=B(B(B(n*B(m(Q)))+B(f*B(m(g))))+B(a*B(m(c)))),C[e+8>>2]=l-c,u=B(D+B(B(B(k*y)+B(s*o))+B(d*b))),b=B(B(B(n*B(m(y)))+B(f*B(m(o))))+B(a*B(m(b)))),C[e+4>>2]=u-b,o=B(w+B(B(B(k*G)+B(s*h))+B(d*R))),a=B(B(B(n*B(m(G)))+B(f*B(m(h))))+B(a*B(m(R)))),C[e>>2]=o-a,t[i+12>>2]=0,C[i+8>>2]=c+l,C[i+4>>2]=b+u,C[i>>2]=a+o;}function rr(A,r,e,i){A|=0,r|=0,e|=0,i|=0,yf[t[t[A>>2]+80>>2]](A,r,e,i);}function er(A){var r;return A|=0,t[A>>2]=7168,r=t[A+56>>2],r&&(yf[t[t[r>>2]>>2]](r),gA(t[A+56>>2])),0|A;}function ir(A,r){var e=B(0),i=B(0),a=B(0),f=B(0),n=B(0);return e=C[A+48>>2],i=C[A+52>>2],a=C[A+56>>2],f=C[A+60>>2],n=B(C[A+64>>2]+C[r+64>>2]),B(B(B(B(B(C[r>>2]*e)+B(C[r+4>>2]*i))+B(C[r+8>>2]*a))-f)-n)>B(0)^1|B(B(B(B(B(e*C[r+16>>2])+B(i*C[r+20>>2]))+B(a*C[r+24>>2]))-f)-n)>B(0)^1|!(B(B(B(B(B(e*C[r+32>>2])+B(i*C[r+36>>2]))+B(a*C[r+40>>2]))-f)-n)>B(0))?(e=C[r+48>>2],i=C[r+52>>2],a=C[r+56>>2],f=C[r+60>>2],B(B(B(B(B(C[A>>2]*e)+B(C[A+4>>2]*i))+B(C[A+8>>2]*a))-f)-n)>B(0)^1|B(B(B(B(B(e*C[A+16>>2])+B(i*C[A+20>>2]))+B(a*C[A+24>>2]))-f)-n)>B(0)^1|B(B(B(B(B(e*C[A+32>>2])+B(i*C[A+36>>2]))+B(a*C[A+40>>2]))-f)-n)>B(0)^1):0;}function ar(A,r,e){var i,a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=0,v=0,g=0,_=0,m=B(0),R=0;i=E-528|0,E=i,d=A+20|0,k=C[d>>2],f=B(k-C[A+4>>2]),v=A+56|0,b=C[v>>2],g=A+24|0,c=C[g>>2],n=B(c-C[A+8>>2]),_=A+52|0,o=C[_>>2],a=B(B(f*b)-B(n*o)),m=a,u=C[A+16>>2],l=B(u-C[A>>2]),s=B(l*o),o=C[A+48>>2],f=B(s-B(f*o)),s=B(a*a),a=B(B(n*o)-B(l*b)),b=B(B(1)/B(Q(B(B(f*f)+B(s+B(a*a)))))),n=B(m*b),C[i+256>>2]=n,a=B(a*b),C[i+260>>2]=a,f=B(f*b),C[i+264>>2]=f,C[i+268>>2]=B(c*f)+B(B(u*n)+B(k*a));A:{if(r=function(A,r,e,i,a){var f=0,n=B(0),b=B(0),o=B(0),k=0,c=B(0),u=0,l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=0,m=B(0),R=0;l=C[r>>2],n=C[A>>2],b=C[A+4>>2],o=C[A+8>>2],c=C[A+12>>2],s=B(B(B(B(l*n)+B(C[r+4>>2]*b))+B(C[r+8>>2]*o))-c),k=s>B(1.1920928955078125e-7),k||(f=t[r+4>>2],t[a>>2]=t[r>>2],t[a+4>>2]=f,u=r+8|0,_=t[u+4>>2],f=a+8|0,t[f>>2]=t[u>>2],t[f+4>>2]=_,c=C[A+12>>2],o=C[A+8>>2],b=C[A+4>>2],n=C[A>>2],f=1),d=C[e>>2],v=C[e+4>>2],g=C[e+8>>2],n=B(B(B(B(d*n)+B(v*b))+B(g*o))-c),(n>B(1.1920928955078125e-7)|0)!=(0|k)&&(c=C[r+4>>2],m=C[r+8>>2],k=(f<<4)+a|0,t[k+12>>2]=0,b=B(B(-s)/B(n-s)),o=B(B(1)-b),C[k+8>>2]=B(g*b)+B(m*o),C[k+4>>2]=B(v*b)+B(o*c),C[k>>2]=B(d*b)+B(l*o),f=f+1|0),k=n>B(1.1920928955078125e-7),k||(R=t[e+4>>2],u=(f<<4)+a|0,t[u>>2]=t[e>>2],t[u+4>>2]=R,_=e+8|0,R=t[_+4>>2],u=u+8|0,t[u>>2]=t[_>>2],t[u+4>>2]=R,f=f+1|0),c=C[i>>2],l=C[i+4>>2],d=C[i+8>>2],b=B(B(B(B(c*C[A>>2])+B(l*C[A+4>>2]))+B(d*C[A+8>>2]))-C[A+12>>2]),(b>B(1.1920928955078125e-7)|0)!=(0|k)&&(v=C[e+4>>2],g=C[e+8>>2],m=C[e>>2],A=(f<<4)+a|0,t[A+12>>2]=0,n=B(B(-n)/B(b-n)),o=B(B(1)-n),C[A+8>>2]=B(d*n)+B(g*o),C[A+4>>2]=B(l*n)+B(o*v),C[A>>2]=B(c*n)+B(o*m),f=f+1|0);r:{e:{i:{if(b>B(1.1920928955078125e-7)){if(!(s>B(1.1920928955078125e-7)))break i;break r;}if(e=t[i+4>>2],A=(f<<4)+a|0,t[A>>2]=t[i>>2],t[A+4>>2]=e,e=i+8|0,k=t[e+4>>2],A=A+8|0,t[A>>2]=t[e>>2],t[A+4>>2]=k,f=f+1|0,!(s>B(1.1920928955078125e-7)))break e;}if(o=C[i+4>>2],c=C[r+4>>2],n=C[i+8>>2],l=C[r+8>>2],d=C[i>>2],v=C[r>>2],A=(f<<4)+a|0,t[A+12>>2]=0,g=n,n=B(B(-b)/B(s-b)),b=B(B(1)-n),C[A+8>>2]=B(g*b)+B(n*l),C[A+4>>2]=B(b*o)+B(n*c),C[A>>2]=B(b*d)+B(n*v),f=f+1|0,s>B(1.1920928955078125e-7))break r;}e=t[r+4>>2],A=(f<<4)+a|0,t[A>>2]=t[r>>2],t[A+4>>2]=e,r=r+8|0,e=t[r+4>>2],A=A+8|0,t[A>>2]=t[r>>2],t[A+4>>2]=e,f=f+1|0;}return f;}(i+256|0,r,r+16|0,r+32|0,i+272|0),r){if(R=i+264|0,k=C[A+32>>2],f=B(k-C[A+16>>2]),b=C[_>>2],_=A+36|0,c=C[_>>2],n=B(c-C[d>>2]),d=A+48|0,o=C[d>>2],a=B(B(f*b)-B(n*o)),m=a,s=B(a*a),a=n,n=C[v>>2],v=A+40|0,u=C[v>>2],l=B(u-C[g>>2]),a=B(B(a*n)-B(l*b)),f=B(B(l*o)-B(f*n)),b=B(B(1)/B(Q(B(s+B(B(a*a)+B(f*f)))))),n=B(m*b),C[R>>2]=n,f=B(f*b),C[i+260>>2]=f,a=B(a*b),C[i+256>>2]=a,g=i+268|0,C[g>>2]=B(u*n)+B(B(k*a)+B(c*f)),r=fr(i+256|0,i+272|0,r,i),!r)break A;return k=C[A>>2],f=B(k-C[A+32>>2]),b=C[A+52>>2],c=C[A+4>>2],n=B(c-C[_>>2]),o=C[d>>2],a=B(B(f*b)-B(n*o)),m=a,s=B(a*a),a=n,n=C[A+56>>2],u=C[A+8>>2],l=B(u-C[v>>2]),a=B(B(a*n)-B(l*b)),f=B(B(l*o)-B(f*n)),b=B(B(1)/B(Q(B(s+B(B(a*a)+B(f*f)))))),n=B(m*b),C[R>>2]=n,f=B(f*b),C[i+260>>2]=f,a=B(a*b),C[i+256>>2]=a,C[g>>2]=B(u*n)+B(B(k*a)+B(c*f)),A=fr(i+256|0,i,r,e),E=i+528|0,A;}return E=i+528|0,0;}return E=i+528|0,0;}function fr(A,r,e,i){var a=0,f=0,n=B(0),b=B(0),o=B(0),k=0,c=0,u=B(0),l=B(0),s=B(0),d=B(0),v=0,g=0,_=B(0),m=0,R=0,G=0,h=B(0),y=B(0);if(o=B(B(B(B(C[r>>2]*C[A>>2])+B(C[r+4>>2]*C[A+4>>2]))+B(C[r+8>>2]*C[A+8>>2]))-C[A+12>>2]),o>B(1.1920928955078125e-7)||(a=t[r+4>>2],t[i>>2]=t[r>>2],t[i+4>>2]=a,k=r+8|0,f=t[k+4>>2],a=i+8|0,t[a>>2]=t[k>>2],t[a+4>>2]=f,f=1),(0|e)>=2)for(v=e+-1|0,m=A+8|0,R=A+4|0,G=A+12|0,a=r,b=o;k=a+16|0,l=C[k>>2],s=C[a+20>>2],g=a+24|0,d=C[g>>2],n=B(B(B(B(l*C[A>>2])+B(s*C[R>>2]))+B(d*C[m>>2]))-C[G>>2]),c=n>B(1.1920928955078125e-7),(0|c)!=(b>B(1.1920928955078125e-7)|0)&&(_=C[a+4>>2],h=C[a+8>>2],y=C[a>>2],a=(f<<4)+i|0,t[a+12>>2]=0,b=B(B(-b)/B(n-b)),u=B(B(1)-b),C[a+8>>2]=B(d*b)+B(h*u),C[a+4>>2]=B(s*b)+B(u*_),C[a>>2]=B(l*b)+B(u*y),f=f+1|0),c||(c=t[k+4>>2],a=(f<<4)+i|0,t[a>>2]=t[k>>2],t[a+4>>2]=c,c=t[g+4>>2],a=a+8|0,t[a>>2]=t[g>>2],t[a+4>>2]=c,f=f+1|0),a=k,b=n,v=v+-1|0,v;){}else n=o;A:{a=o>B(1.1920928955078125e-7);r:{if((0|a)==(n>B(1.1920928955078125e-7)|0)){if(!a)break r;break A;}if(A=(e+-1<<4)+r|0,b=C[A>>2],u=C[A+4>>2],l=C[r+4>>2],s=C[A+8>>2],d=C[r+8>>2],_=C[r>>2],A=(f<<4)+i|0,t[A+12>>2]=0,n=B(B(-n)/B(o-n)),o=B(B(1)-n),C[A+8>>2]=B(s*o)+B(n*d),C[A+4>>2]=B(o*u)+B(n*l),C[A>>2]=B(o*b)+B(n*_),f=f+1|0,a)break A;}return e=t[r+4>>2],A=(f<<4)+i|0,t[A>>2]=t[r>>2],t[A+4>>2]=e,r=r+8|0,e=t[r+4>>2],A=A+8|0,t[A>>2]=t[r>>2],t[A+4>>2]=e,f+1|0;}return f;}function nr(A,r,e){var i,a=0,f=0,n=0,b=0,o=B(0),k=B(0),c=0,u=0,l=0,s=B(0),d=0,v=B(0),g=B(0),_=B(0),m=B(0),R=B(0);if(i=E-880|0,E=i,k=C[r+64>>2],o=C[A+64>>2],u=A+56|0,a=t[u+4>>2],b=i+296|0,t[b>>2]=t[u>>2],t[b+4>>2]=a,a=t[A+52>>2],t[i+288>>2]=t[A+48>>2],t[i+292>>2]=a,a=ar(A,r,i+560|0),a&&(t[i+280>>2]=-998637568,t[i+284>>2]=0,!((0|a)<=0))){for(m=B(o+k),u=i+288|0,v=C[i+300>>2],g=C[i+296>>2],_=C[i+292>>2],b=0,s=B(-1e3),f=i+560|0,k=C[i+288>>2];o=B(m-B(B(B(B(C[f>>2]*k)+B(C[f+4>>2]*_))+B(C[f+8>>2]*g))-v)),o>=B(0)&&(o>s?(t[i+816>>2]=n,b=1,s=o):B(o+B(1.1920928955078125e-7))>=s&&(t[(i+816|0)+(b<<2)>>2]=n,b=b+1|0)),f=f+16|0,n=n+1|0,(0|a)!=(0|n);){}if(C[i+280>>2]=s,t[i+284>>2]=b,(0|b)>=1)for(f=i+304|0,n=i+816|0,a=b;d=(i+560|0)+(t[n>>2]<<4)|0,l=t[d+4>>2],t[f>>2]=t[d>>2],t[f+4>>2]=l,l=t[d+12>>2],c=f+8|0,t[c>>2]=t[d+8>>2],t[c+4>>2]=l,n=n+4|0,f=f+16|0,a=a+-1|0,a;){}if(b&&(a=i+288|0,C[a>>2]=-C[a>>2],a=i+292|0,C[a>>2]=-C[a>>2],a=i+296|0,C[a>>2]=-C[a>>2],l=r+56|0,a=t[l+4>>2],c=i+16|0,t[c>>2]=t[l>>2],t[c+4>>2]=a,a=t[r+52>>2],t[i+8>>2]=t[r+48>>2],t[i+12>>2]=a,A=ar(r,A,i+560|0),A&&(t[i>>2]=-998637568,t[i+4>>2]=0,!((0|A)<=0)))){for(R=C[i+20>>2],v=C[i+16>>2],g=C[i+12>>2],a=0,k=B(-1e3),f=i+560|0,_=C[i+8>>2],n=0;o=B(m-B(B(B(B(C[f>>2]*_)+B(C[f+4>>2]*g))+B(C[f+8>>2]*v))-R)),o>=B(0)&&(o>k?(t[i+816>>2]=n,a=1,k=o):B(o+B(1.1920928955078125e-7))>=k&&(t[(i+816|0)+(a<<2)>>2]=n,a=a+1|0)),f=f+16|0,n=n+1|0,(0|A)!=(0|n);){}if(C[i>>2]=k,t[i+4>>2]=a,(0|a)>=1)for(f=i+24|0,n=i+816|0,A=a;c=(i+560|0)+(t[n>>2]<<4)|0,r=t[c+4>>2],t[f>>2]=t[c>>2],t[f+4>>2]=r,r=t[c+12>>2],l=f+8|0,t[l>>2]=t[c+8>>2],t[l+4>>2]=r,n=n+4|0,f=f+16|0,A=A+-1|0,A;){}if(a){if(k<s)for(C[e>>2]=k,t[e+4>>2]=a,r=i+8|0,A=t[r+4>>2],t[e+8>>2]=t[r>>2],t[e+12>>2]=A,r=r+8|0,A=t[r+4>>2],u=e+16|0,t[u>>2]=t[r>>2],t[u+4>>2]=A,A=a<<4,f=A+(e+8|0)|0,n=8+(A+i|0)|0;A=t[n+4>>2],t[f>>2]=t[n>>2],t[f+4>>2]=A,r=n+8|0,A=t[r+4>>2],e=f+8|0,t[e>>2]=t[r>>2],t[e+4>>2]=A,n=n+-16|0,f=f+-16|0,a=a+-1|0,a;){}else for(C[e>>2]=s,t[e+4>>2]=b,A=t[u+4>>2],t[e+8>>2]=t[u>>2],t[e+12>>2]=A,r=u+8|0,A=t[r+4>>2],a=e+16|0,t[a>>2]=t[r>>2],t[a+4>>2]=A,A=b<<4,f=A+(e+8|0)|0,n=288+(A+i|0)|0;A=t[n+4>>2],t[f>>2]=t[n>>2],t[f+4>>2]=A,r=n+8|0,A=t[r+4>>2],e=f+8|0,t[e>>2]=t[r>>2],t[e+4>>2]=A,n=n+-16|0,f=f+-16|0,b=b+-1|0,b;){}return E=i+880|0,1;}}}return E=i+880|0,0;}function tr(A){!function(A){var r=0;ZA(A),a[A+92|0]=0,t[A+88>>2]=0,r=A+80|0,t[r>>2]=-1082130432,t[r+4>>2]=-1082130432,r=A+72|0,t[r>>2]=0,t[r+4>>2]=-1082130432,r=A- -64|0,t[r>>2]=1065353216,t[r+4>>2]=1065353216,t[A>>2]=7300,t[A+56>>2]=0,t[A+60>>2]=1065353216;}(A),t[A+96>>2]=0,t[A>>2]=7524,t[A+4>>2]=2;}function br(A){return A|=0,t[A+96>>2];}function or(A,r,e,i){}function kr(A,r){return 0;}function cr(A){A|=0,er(A),gA(A);}function ur(A){var r=0;t[A>>2]=1025,t[A+160>>2]=0,r=A+152|0,t[r>>2]=0,t[r+4>>2]=0,r=A+144|0,t[r>>2]=0,t[r+4>>2]=0,r=A+136|0,t[r>>2]=0,t[r+4>>2]=0,r=A+128|0,t[r>>2]=0,t[r+4>>2]=0,r=A+120|0,t[r>>2]=0,t[r+4>>2]=0,t[A+352>>2]=0,r=A+344|0,t[r>>2]=0,t[r+4>>2]=0,r=A+336|0,t[r>>2]=0,t[r+4>>2]=0,r=A+328|0,t[r>>2]=0,t[r+4>>2]=0,r=A+320|0,t[r>>2]=0,t[r+4>>2]=0,r=A+312|0,t[r>>2]=0,t[r+4>>2]=0,t[A+544>>2]=0,r=A+536|0,t[r>>2]=0,t[r+4>>2]=0,r=A+528|0,t[r>>2]=0,t[r+4>>2]=0,r=A+520|0,t[r>>2]=0,t[r+4>>2]=0,r=A+512|0,t[r>>2]=0,t[r+4>>2]=0,r=A+504|0,t[r>>2]=0,t[r+4>>2]=0,t[A+736>>2]=0,r=A+728|0,t[r>>2]=0,t[r+4>>2]=0,r=A+720|0,t[r>>2]=0,t[r+4>>2]=0,r=A+712|0,t[r>>2]=0,t[r+4>>2]=0,r=A+704|0,t[r>>2]=0,t[r+4>>2]=0,r=A+696|0,t[r>>2]=0,t[r+4>>2]=0,t[A+800>>2]=0,t[A+780>>2]=0,t[A+772>>2]=0,t[A+776>>2]=0;}function lr(A){var r,e=0;r=t[A+116>>2],r&&(e=t[425],e&&(yf[e](r),t[A+116>>2]=0));}function sr(A,r){var e=0,i=0,a=0,f=0;e=t[A+780>>2];A:if(4!=(0|e))t[A+780>>2]=e+1;else {if(e=function(A,r){var e,i=B(0),a=B(0),f=B(0),n=B(0),t=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),R=B(0),G=B(0),h=0,y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),E=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=B(0),M=0,x=B(0),S=B(0),T=B(0),U=B(0),j=B(0);i=C[A+84>>2],k=C[r+80>>2],h=i<k,M=1^h?-1:0,o=C[A+276>>2],i=h?i:k,h=o<i,e=h?1:M,k=C[A+468>>2],i=h?o:i,h=k<i,M=C[A+660>>2]<(h?k:i),h=M?3:h?2:e,t=C[r>>2];r:{e:{i:{a:{f:{n:{t:{b:{o:{if(b[3180]){if(!h)break o;if(d=C[A+196>>2],u=B(t-d),l=C[A+584>>2],v=C[A+392>>2],i=B(l-v),a=C[r+4>>2],g=C[A+200>>2],o=B(a-g),G=C[A+580>>2],Q=C[A+388>>2],k=B(G-Q),c=B(B(u*i)-B(o*k)),f=B(c*c),y=o,n=C[A+588>>2],_=C[A+396>>2],o=B(n-_),c=C[r+8>>2],R=C[A+204>>2],p=B(c-R),D=B(B(y*o)-B(p*i)),u=B(B(p*k)-B(u*o)),y=B(f+B(B(D*D)+B(u*u))),f=y,1!=(0|h))break b;t=B(t-C[A+4>>2]),c=B(c-C[A+12>>2]),a=B(a-C[A+8>>2]),o=B(0);break t;}if(p=C[r+8>>2],D=C[r+4>>2],!h)break f;if(n=C[A+196>>2],R=B(t-n),v=C[A+392>>2],a=C[A+584>>2],o=B(v-a),N=C[A+200>>2],Q=B(D-N),_=C[A+388>>2],c=C[A+580>>2],W=B(_-c),i=B(B(R*o)-B(Q*W)),y=B(i*i),l=C[A+396>>2],u=C[A+588>>2],F=B(l-u),V=C[A+204>>2],G=B(p-V),i=B(B(Q*F)-B(G*o)),f=B(i*i),i=B(B(G*W)-B(R*F)),k=B(y+B(f+B(i*i))),i=B(t-_),Z=B(N-a),d=B(D-v),x=B(n-c),g=B(B(i*Z)-B(d*x)),y=B(g*g),S=B(V-u),g=B(p-l),f=B(B(d*S)-B(g*Z)),s=B(f*f),f=B(B(g*x)-B(i*S)),f=B(y+B(s+B(f*f))),f=k>f?k:f,s=B(N-v),k=B(t-c),w=B(n-_),J=B(D-a),Y=B(B(s*k)-B(w*J)),y=B(Y*Y),E=B(V-l),Y=B(p-u),s=B(B(E*J)-B(s*Y)),I=B(s*s),s=B(B(w*Y)-B(E*k)),s=B(y+B(I+B(s*s))),y=f>s?f:s,f=y,1!=(0|h))break a;f=C[A+4>>2],T=B(f-c),E=B(t-f),s=C[A+12>>2],U=B(s-u),w=C[A+8>>2],j=B(w-a),I=B(p-s),X=B(D-w),o=B(0);break i;}n=C[A+588>>2],_=C[A+396>>2],o=B(n-_),l=C[A+584>>2],v=C[A+392>>2],i=B(l-v),G=C[A+580>>2],Q=C[A+388>>2],k=B(G-Q),c=C[r+8>>2],a=C[r+4>>2],f=B(0);}if(y=f,t=B(t-C[A+4>>2]),a=B(a-C[A+8>>2]),u=B(B(t*i)-B(a*k)),c=B(c-C[A+12>>2]),i=B(B(a*o)-B(c*i)),f=B(i*i),i=B(B(c*k)-B(t*o)),o=B(B(u*u)+B(f+B(i*i))),R=C[A+204>>2],g=C[A+200>>2],d=C[A+196>>2],k=B(0),2==(0|h))break n;}if(i=B(l-g),k=B(G-d),u=B(B(t*i)-B(a*k)),f=B(u*u),u=B(n-R),i=B(B(a*u)-B(c*i)),n=B(i*i),i=B(B(c*k)-B(t*u)),k=B(f+B(n+B(i*i))),i=B(0),M)break r;}i=B(v-g),u=B(Q-d),d=B(B(t*i)-B(a*u)),f=a,a=B(_-R),i=B(B(f*a)-B(c*i)),f=B(i*i),i=B(B(c*u)-B(t*a)),i=B(B(d*d)+B(f+B(i*i)));break r;}l=C[A+396>>2],u=C[A+588>>2],F=B(l-u),v=C[A+392>>2],a=C[A+584>>2],o=B(v-a),_=C[A+388>>2],c=C[A+580>>2],W=B(_-c),Y=B(p-u),J=B(D-a),k=B(t-c),g=B(p-l),d=B(D-v),i=B(t-_),f=B(0);}if(y=f,f=C[A+4>>2],E=B(t-f),w=C[A+8>>2],X=B(D-w),n=B(B(E*o)-B(X*W)),s=C[A+12>>2],I=B(p-s),o=B(B(X*F)-B(I*o)),R=B(o*o),o=B(B(I*W)-B(E*F)),o=B(B(n*n)+B(R+B(o*o))),j=B(w-a),T=B(f-c),n=B(B(i*j)-B(d*T)),R=B(n*n),U=B(s-u),n=B(B(d*U)-B(g*j)),G=B(n*n),n=B(B(g*T)-B(i*U)),n=B(R+B(G+B(n*n))),o=o>n?o:n,W=B(w-v),F=B(f-_),n=B(B(W*k)-B(F*J)),R=B(n*n),Z=B(s-l),n=B(B(Z*J)-B(W*Y)),G=B(n*n),n=B(B(F*Y)-B(Z*k)),n=B(R+B(G+B(n*n))),o=o>n?o:n,V=C[A+204>>2],G=B(p-V),N=C[A+200>>2],Q=B(D-N),n=C[A+196>>2],R=B(t-n),2==(0|h)){a=B(s-V),c=B(w-N),u=B(f-n),k=B(0);break e;}S=B(V-u),Z=B(N-a),x=B(n-c);}if(i=B(B(E*Z)-B(X*x)),a=B(i*i),i=B(B(X*S)-B(I*Z)),c=B(i*i),i=B(B(I*x)-B(E*S)),i=B(a+B(c+B(i*i))),a=B(B(R*j)-B(Q*T)),c=B(a*a),a=B(B(Q*U)-B(G*j)),u=B(a*a),a=B(B(G*T)-B(R*U)),a=B(c+B(u+B(a*a))),i=i>a?i:a,c=B(w-N),u=B(f-n),a=B(B(c*k)-B(u*J)),g=B(a*a),a=B(s-V),d=B(B(a*J)-B(c*Y)),k=B(B(u*Y)-B(a*k)),k=B(g+B(B(d*d)+B(k*k))),k=i>k?i:k,i=B(0),M)break r;Z=B(s-l),W=B(w-v),F=B(f-_),g=B(p-l),d=B(D-v),i=B(t-_);}t=B(N-v),v=B(n-_),_=B(B(E*t)-B(X*v)),l=B(V-l),t=B(B(X*l)-B(I*t)),f=B(t*t),t=B(B(I*v)-B(E*l)),t=B(B(_*_)+B(f+B(t*t))),l=B(B(R*W)-B(Q*F)),f=B(l*l),l=B(B(Q*Z)-B(G*W)),n=B(l*l),l=B(B(G*F)-B(R*Z)),l=B(f+B(n+B(l*l))),t=t>l?t:l,l=B(B(c*i)-B(u*d)),c=B(B(a*d)-B(c*g)),i=B(B(u*g)-B(a*i)),i=B(B(l*l)+B(B(c*c)+B(i*i))),i=t>i?t:i;}return t=B(m(y)),A=t>B(-0xde0b6b000000000),r=1^A?-1:0,o=B(m(o)),t=A?t:B(-0xde0b6b000000000),A=o>t,r=A?1:r,k=B(m(k)),o=A?o:t,A=k>o,B(m(i))>(A?k:o)?3:A?2:r;}(A,r),i=120+(_(e,192)+A|0)|0,a=t[i>>2],!a)break A;if(f=t[425],!f)break A;yf[f](a),t[i>>2]=0;}return e=(0|e)>0?e:0,J(4+(A+_(e,192)|0)|0,r,192),e;}function dr(A,r,e){var i,a=0,f=B(0),n=B(0),b=B(0),o=0,k=0,c=0,u=B(0),l=0,s=B(0),d=B(0),v=B(0),g=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=0,Z=0,Y=0;i=E-16|0,E=i,o=t[A+780>>2];A:if(!((0|o)<1)){for(a=(_(o,192)+A|0)-188|0,k=o;v=C[r+48>>2],G=C[r+4>>2],h=C[r+8>>2],g=C[r+52>>2],y=C[r+16>>2],u=C[r+20>>2],Q=C[r+24>>2],f=C[r+56>>2],b=C[r+32>>2],n=C[r+36>>2],m=C[r+40>>2],p=C[r>>2],t[a+60>>2]=0,s=f,f=C[a>>2],d=B(b*f),b=C[a+4>>2],d=B(d+B(n*b)),n=C[a+8>>2],m=B(s+B(d+B(m*n))),C[a+56>>2]=m,g=B(g+B(B(B(f*y)+B(b*u))+B(n*Q))),C[a+52>>2]=g,v=B(v+B(B(B(f*p)+B(b*G))+B(n*h))),C[a+48>>2]=v,G=C[e+48>>2],h=C[e+4>>2],y=C[e+8>>2],u=C[e+52>>2],Q=C[e+24>>2],p=C[e+16>>2],D=C[e+20>>2],f=C[e+56>>2],n=C[e+40>>2],b=C[e+32>>2],R=C[e+36>>2],w=C[e>>2],t[a+44>>2]=0,s=f,f=C[a+16>>2],W=B(b*f),b=C[a+20>>2],d=n,n=C[a+24>>2],R=B(s+B(B(W+B(R*b))+B(d*n))),C[a+40>>2]=R,u=B(u+B(B(B(f*p)+B(b*D))+B(n*Q))),C[a+36>>2]=u,f=B(G+B(B(B(f*w)+B(b*h))+B(n*y))),C[a+32>>2]=f,C[a+80>>2]=B(B(B(v-f)*C[a- -64>>2])+B(B(g-u)*C[a+68>>2]))+B(B(m-R)*C[a+72>>2]),l=a+156|0,t[l>>2]=t[l>>2]+1,a=a+-192|0,k=k+-1|0,(0|k)>0;){}if(!((0|o)<1))for(r=_(o,192),F=A+784|0,k=A+780|0,Z=A+776|0,Y=A+772|0;;){o=o+-1|0,e=A+r|0,l=e+-188|0,f=C[e+-108>>2],b=C[F>>2];r:{if(!(f<=b)){if(e=e+-72|0,a=t[e>>2],a&&(c=t[425],c&&(yf[c](a),t[e>>2]=0)),c=k,a=t[k>>2],e=a+-1|0,(0|o)!=(0|e)&&(e=_(e,192)+A|0,J(l,e+4|0,192),t[e+136>>2]=0,a=e+128|0,t[a>>2]=0,t[a+4>>2]=0,a=e+120|0,t[a>>2]=0,t[a+4>>2]=0,t[e+160>>2]=0,a=t[k>>2]),e=a+-1|0,t[c>>2]=e,e)break r;if(e=t[428],!e)break r;if(t[i+12>>2]=A,yf[e](i+12|0),r=r+-192|0,(0|o)>0)continue;break A;}if(n=B(C[e+-156>>2]-B(C[e+-140>>2]-B(C[e+-124>>2]*f))),s=B(n*n),n=B(C[e+-152>>2]-B(C[e+-136>>2]-B(f*C[e+-120>>2]))),f=B(C[e+-148>>2]-B(C[e+-132>>2]-B(f*C[e+-116>>2]))),B(B(s+B(n*n))+B(f*f))>B(b*b)){if(e=e+-72|0,a=t[e>>2],a&&(c=t[425],c&&(yf[c](a),t[e>>2]=0)),c=k,a=t[k>>2],e=a+-1|0,(0|o)!=(0|e)&&(e=_(e,192)+A|0,J(l,e+4|0,192),t[e+136>>2]=0,a=e+128|0,t[a>>2]=0,t[a+4>>2]=0,a=e+120|0,t[a>>2]=0,t[a+4>>2]=0,t[e+160>>2]=0,a=t[k>>2]),e=a+-1|0,t[c>>2]=e,e)break r;if(e=t[428],!e)break r;if(t[i+8>>2]=A,yf[e](i+8|0),r=r+-192|0,(0|o)>0)continue;break A;}e=t[426],e&&yf[e](l,t[Y>>2],t[Z>>2]);}if(r=r+-192|0,!((0|o)>0))break;}}E=i+16|0;}function vr(A,r){return B(C[A+232>>2]*C[r+232>>2]);}function Cr(A){A|=0,rA(A);}function gr(A,r,e){t[76+((_(r,144)+A|0)+(e<<2)|0)>>2]=1724;}function _r(A){return A|=0,t[A+72>>2];}function Br(A,r,e){var i=0,a=0;i=t[A+12>>2],i||(i=t[A+4>>2],i=0|yf[t[t[i>>2]+12>>2]](i,t[r+8>>2],t[e+8>>2]),t[A+12>>2]=i),t[t[A+16>>2]+4>>2]=i,a=t[A+4>>2],i=0|yf[t[t[a>>2]+8>>2]](a,r,e,i,1),a=t[A+16>>2],yf[t[t[a>>2]+8>>2]](a,t[A+28>>2],t[A+24>>2]),a=t[A+16>>2],yf[t[t[a>>2]+12>>2]](a,t[A+36>>2],t[A+32>>2]),yf[t[t[i>>2]+8>>2]](i,r,e,t[A+20>>2],t[A+16>>2]),yf[t[t[i>>2]>>2]](i),A=t[A+4>>2],yf[t[t[A>>2]+60>>2]](A,i);}function mr(A,r,e,i,a){var f,n=0;f=E-48|0,E=f,n=t[A+16>>2],yf[t[t[n>>2]+8>>2]](n,t[A+28>>2],t[A+24>>2]),n=t[A+16>>2],yf[t[t[n>>2]+12>>2]](n,t[A+36>>2],t[A+32>>2]),t[f+28>>2]=i,t[f+44>>2]=t[A+24>>2],t[f+40>>2]=t[A+28>>2],t[f+24>>2]=r,t[f+36>>2]=t[r+12>>2],r=t[r+8>>2],t[f+32>>2]=r,t[f+4>>2]=a,t[f+20>>2]=t[A+32>>2],t[f+16>>2]=t[A+36>>2],t[f>>2]=e,t[f+12>>2]=t[e+12>>2],i=t[e+8>>2],t[f+8>>2]=i,e=t[A+8>>2],e||(e=t[A+12>>2],e||(e=t[A+4>>2],e=0|yf[t[t[e>>2]+12>>2]](e,r,i),t[A+12>>2]=e),t[t[A+16>>2]+4>>2]=e,r=t[A+4>>2],e=0|yf[t[t[r>>2]+8>>2]](r,f+24|0,f,e,1),t[A+8>>2]=e),yf[t[t[e>>2]+8>>2]](e,f+24|0,f,t[A+20>>2],t[A+16>>2]),E=f+48|0;}function Rr(A,r,e,i,f){var n,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,g=0,_=0,m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=0,Z=0,Y=0,N=0,V=0,I=0,J=0,X=B(0),M=B(0),x=B(0),S=B(0),T=B(0),U=B(0),j=B(0),O=B(0),H=B(0),z=B(0),P=B(0),L=B(0),K=0,q=0,$=0,AA=0,rA=0,eA=0,iA=0,aA=0,fA=B(0),nA=B(0),tA=B(0),bA=0,oA=0,kA=0,cA=0,uA=0,lA=0,sA=0,dA=0;n=E-976|0,E=n;A:if(2!=(0|yf[t[t[i>>2]+80>>2]](i))){if(2!=(0|yf[t[t[f>>2]+80>>2]](f))){o=t[r+12>>2],k=o+8|0,l=t[k>>2],k=t[k+4>>2],u=o+24|0,F=t[u>>2],u=t[u+4>>2],Z=t[o+16>>2],Y=t[o+20>>2],N=t[o>>2],J=t[o+4>>2],d=o+40|0,c=t[d+4>>2],s=n+952|0,t[s>>2]=t[d>>2],t[s+4>>2]=c,s=t[o+32>>2],d=t[o+36>>2],V=o+56|0,v=t[V+4>>2],c=n+968|0,t[c>>2]=t[V>>2],t[c+4>>2]=v,c=n+936|0,t[c>>2]=F,t[c+4>>2]=u,u=n+920|0,t[u>>2]=l,t[u+4>>2]=k,t[n+912>>2]=N,t[n+916>>2]=J,k=t[o+52>>2],t[n+960>>2]=t[o+48>>2],t[n+964>>2]=k,t[n+944>>2]=s,t[n+948>>2]=d,t[n+928>>2]=Z,t[n+932>>2]=Y,o=t[e+12>>2],k=o+8|0,l=t[k>>2],k=t[k+4>>2],u=o+24|0,F=t[u>>2],u=t[u+4>>2],Z=t[o+16>>2],Y=t[o+20>>2],N=t[o>>2],J=t[o+4>>2],d=o+40|0,c=t[d+4>>2],s=n+888|0,t[s>>2]=t[d>>2],t[s+4>>2]=c,s=t[o+32>>2],d=t[o+36>>2],V=o+56|0,v=t[V+4>>2],c=n+904|0,t[c>>2]=t[V>>2],t[c+4>>2]=v,c=n+872|0,t[c>>2]=F,t[c+4>>2]=u,u=n+856|0,t[u>>2]=l,t[u+4>>2]=k,t[n+848>>2]=N,t[n+852>>2]=J,k=t[o+52>>2],t[n+896>>2]=t[o+48>>2],t[n+900>>2]=k,t[n+880>>2]=s,t[n+884>>2]=d,t[n+864>>2]=Z,t[n+868>>2]=Y,t[n+828>>2]=0,sA=n,dA=CA(256,16),t[sA+836>>2]=dA,a[n+840|0]=1,t[n+832>>2]=32,function(A,r,e,i,f){var n,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,g=0,_=0,B=0,m=0,R=0,G=0,h=0,y=0,Q=0,p=0;if(n=E+-64|0,E=n,!(!t[e+72>>2]|!t[i+72>>2]))return RA(e+72|0,A,i+72|0,r,f),void(E=n- -64|0);if(k=0|yf[t[t[e>>2]+88>>2]](e),k)for(m=n+16|0,R=n+48|0,h=n+52|0,y=n+56|0,Q=n+8|0,l=f+4|0,c=f+12|0;;){if(k=k+-1|0,yf[t[t[e>>2]+120>>2]](e,k,A,n+32|0,R),u=0|yf[t[t[i>>2]+88>>2]](i),u)for(;;){if(yf[t[t[i>>2]+120>>2]](i,k,r,n,m),u=u+-1|0,!(C[m>>2]<C[n+32>>2]|C[n>>2]>C[R>>2]|C[n+20>>2]<C[n+36>>2]|C[n+4>>2]>C[h>>2]|C[n+24>>2]<C[n+40>>2]|C[Q>>2]>C[y>>2])){if(o=t[l>>2],G=f+8|0,(0|o)==t[G>>2]&&(s=o?o<<1:1,!((0|o)>=(0|s)))){r:{e:{i:{a:{if(s){if(_=CA(s<<3,16),d=t[c>>2],o=t[l>>2],(0|o)<1)break a;break i;}if(_=0,d=t[c>>2],(0|o)>=1)break i;}if(!d)break r;break e;}for(v=d,g=_,B=o;p=t[v+4>>2],t[g>>2]=t[v>>2],t[g+4>>2]=p,v=v+8|0,g=g+8|0,B=B+-1|0,B;){}}b[f+16|0]&&(gA(d),o=t[l>>2]),t[c>>2]=0;}t[c>>2]=_,a[f+16|0]=1,t[G>>2]=s;}t[l>>2]=o+1,o=t[c>>2]+(o<<3)|0,t[o+4>>2]=u,t[o>>2]=k;}if(!u)break;}if(!k)break;}E=n- -64|0;}(n+912|0,n+848|0,i,f,n+824|0);r:{if(t[n+828>>2]){if(1==(0|yf[t[t[i>>2]+80>>2]](i))&&1==(0|yf[t[t[f>>2]+80>>2]](f))){if(function(A,r,e,i,a,f,n){var b,o=0,k=B(0),c=0,u=B(0),l=B(0),s=B(0),d=0,v=B(0),g=B(0),_=0,m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=B(0),M=B(0),x=B(0),S=B(0),T=B(0),U=B(0),j=B(0),O=B(0),H=B(0),z=B(0),P=B(0),L=B(0),K=B(0),q=B(0),$=B(0),AA=B(0),rA=0,eA=B(0),iA=0,aA=0,fA=B(0),nA=B(0),tA=B(0),bA=B(0),oA=B(0),kA=B(0),cA=0,uA=B(0);if(b=E-432|0,E=b,o=t[e+12>>2],W=C[o+56>>2],F=C[o+52>>2],Z=C[o+40>>2],Y=C[o+36>>2],N=C[o+24>>2],V=C[o+20>>2],c=t[r+12>>2],I=C[c+56>>2],J=C[c+52>>2],X=C[c+40>>2],M=C[c+36>>2],x=C[c+24>>2],S=C[c+20>>2],T=C[o+48>>2],U=C[o+32>>2],j=C[o+16>>2],O=C[o+8>>2],H=C[o+4>>2],z=C[o>>2],P=C[c+48>>2],L=C[c+32>>2],K=C[c+16>>2],q=C[c+8>>2],$=C[c+4>>2],AA=C[c>>2],t[b+424>>2]=1008981770,t[b+352>>2]=1008981770,yf[t[t[i>>2]+112>>2]](i),yf[t[t[a>>2]+112>>2]](a),n)for(iA=b+16|0;;){if(aA=A+24|0,o=t[f>>2],t[aA>>2]=o,rA=A+32|0,t[rA>>2]=t[f+4>>2],c=0|yf[t[t[i>>2]+84>>2]](i),yf[t[t[c>>2]+20>>2]](c,o,b+360|0),o=t[rA>>2],c=0|yf[t[t[a>>2]+84>>2]](a),yf[t[t[c>>2]+20>>2]](c,o,b+288|0),t[b+372>>2]=0,t[b+388>>2]=0,t[b+404>>2]=0,v=C[b+360>>2],m=C[b+364>>2],o=b+368|0,k=C[o>>2],l=B(I+B(B(B(L*v)+B(M*m))+B(X*k))),C[o>>2]=l,o=b+376|0,s=C[o>>2],c=b+380|0,u=C[c>>2],d=b+384|0,R=C[d>>2],G=B(P+B(B(B(AA*s)+B($*u))+B(q*R))),C[o>>2]=G,y=B(J+B(B(B(K*s)+B(S*u))+B(x*R))),C[c>>2]=y,fA=B(I+B(B(B(L*s)+B(M*u))+B(X*R))),C[d>>2]=fA,o=b+392|0,s=C[o>>2],c=b+396|0,u=C[c>>2],d=b+400|0,R=C[d>>2],p=B(I+B(B(B(L*s)+B(M*u))+B(X*R))),C[d>>2]=p,D=B(J+B(B(B(K*s)+B(S*u))+B(x*R))),C[c>>2]=D,h=B(P+B(B(B(AA*s)+B($*u))+B(q*R))),C[o>>2]=h,s=B(J+B(B(B(K*v)+B(S*m))+B(x*k))),C[b+364>>2]=s,v=B(P+B(B(B(AA*v)+B($*m))+B(q*k))),C[b+360>>2]=v,o=b+296|0,m=C[o>>2],k=C[b+288>>2],u=C[b+292>>2],t[b+300>>2]=0,R=B(W+B(B(B(U*k)+B(Y*u))+B(Z*m))),C[o>>2]=R,w=B(F+B(B(B(j*k)+B(V*u))+B(N*m))),C[b+292>>2]=w,m=B(T+B(B(B(z*k)+B(H*u))+B(O*m))),C[b+288>>2]=m,o=b+312|0,k=C[o>>2],c=b+304|0,u=C[c>>2],d=b+308|0,g=C[d>>2],t[b+316>>2]=0,nA=B(W+B(B(B(U*u)+B(Y*g))+B(Z*k))),C[o>>2]=nA,tA=B(F+B(B(B(j*u)+B(V*g))+B(N*k))),C[d>>2]=tA,bA=B(T+B(B(B(z*u)+B(H*g))+B(O*k))),C[c>>2]=bA,o=b+328|0,k=C[o>>2],c=b+320|0,u=C[c>>2],d=b+324|0,g=C[d>>2],t[b+332>>2]=0,oA=B(W+B(B(B(U*u)+B(Y*g))+B(Z*k))),C[o>>2]=oA,kA=B(F+B(B(B(j*u)+B(V*g))+B(N*k))),C[d>>2]=kA,g=B(T+B(B(B(z*u)+B(H*g))+B(O*k))),C[c>>2]=g,eA=l,u=B(G-v),G=B(D-s),y=B(y-s),D=B(h-v),k=B(B(u*G)-B(y*D)),h=k,uA=B(k*k),k=B(p-l),p=B(fA-l),l=B(B(y*k)-B(p*G)),k=B(B(p*D)-B(u*k)),u=B(B(1)/B(Q(B(uA+B(B(l*l)+B(k*k)))))),G=B(h*u),l=B(l*u),h=s,s=B(k*u),C[b+420>>2]=B(eA*G)+B(B(v*l)+B(h*s)),C[b+416>>2]=G,C[b+412>>2]=s,C[b+408>>2]=l,s=B(bA-m),v=B(kA-w),k=B(tA-w),u=B(g-m),l=B(B(s*v)-B(k*u)),eA=l,h=B(l*l),l=k,k=B(oA-R),g=B(nA-R),l=B(B(l*k)-B(g*v)),s=B(B(g*u)-B(s*k)),v=B(B(1)/B(Q(B(h+B(B(l*l)+B(s*s)))))),k=B(eA*v),C[b+344>>2]=k,s=B(s*v),C[b+340>>2]=s,l=B(l*v),C[b+336>>2]=l,C[b+348>>2]=B(R*k)+B(B(m*l)+B(w*s)),n=n+-1|0,ir(b+360|0,b+288|0)&&nr(b+360|0,b+288|0,b+8|0)&&(o=t[b+12>>2],o))for(c=(o<<4)+iA|0;l=C[b+8>>2],d=A+16|0,_=t[d>>2],yf[t[t[_>>2]+8>>2]](_,t[A+28>>2],t[aA>>2]),_=t[d>>2],yf[t[t[_>>2]+12>>2]](_,t[A+36>>2],t[rA>>2]),o=o+-1|0,l=B(-l),cA=A+12|0,_=t[cA>>2],_||(_=t[A+4>>2],_=0|yf[t[t[_>>2]+12>>2]](_,t[r+8>>2],t[e+8>>2]),t[cA>>2]=_),d=t[d>>2],t[d+4>>2]=_,yf[t[t[d>>2]+16>>2]](d,iA,c,l),c=c+-16|0,o;){}if(f=f+8|0,!n)break;}yf[t[t[i>>2]+116>>2]](i),yf[t[t[a>>2]+116>>2]](a),E=b+432|0;}(A,r,e,i,f,t[n+836>>2],t[n+828>>2]),A=t[n+836>>2],A)break r;break A;}if(yf[t[t[i>>2]+112>>2]](i),yf[t[t[f>>2]+112>>2]](f),LA(n+520|4),o=n+624|0,t[o>>2]=0,t[o+4>>2]=0,o=n+616|0,t[o>>2]=0,t[o+4>>2]=0,o=n+608|0,t[o>>2]=0,t[o+4>>2]=0,o=n+600|0,t[o>>2]=0,t[o+4>>2]=0,o=n+592|0,t[o>>2]=0,t[o+4>>2]=0,o=n+584|0,t[o>>2]=0,t[o+4>>2]=0,t[n+528>>2]=1,t[n+524>>2]=8188,tr(n+632|0),t[n+728>>2]=4,t[n+812>>2]=8768,t[n+804>>2]=8688,t[n+796>>2]=8616,t[n+632>>2]=8424,t[n+520>>2]=i,o=n+804|0,yf[t[t[i>>2]+96>>2]](i)||(o=t[n+520>>2],o=0|yf[t[t[o>>2]+100>>2]](o)?n+812|0:n+796|0),t[o+4>>2]=n+520,t[n+820>>2]=o,LA(n+216|4),o=n+320|0,t[o>>2]=0,t[o+4>>2]=0,o=n+312|0,t[o>>2]=0,t[o+4>>2]=0,o=n+304|0,t[o>>2]=0,t[o+4>>2]=0,o=n+296|0,t[o>>2]=0,t[o+4>>2]=0,o=n+288|0,t[o>>2]=0,t[o+4>>2]=0,o=n+280|0,t[o>>2]=0,t[o+4>>2]=0,t[n+224>>2]=1,t[n+220>>2]=8188,tr(n+328|0),t[n+424>>2]=4,t[n+508>>2]=8768,t[n+500>>2]=8688,t[n+492>>2]=8616,t[n+328>>2]=8424,t[n+216>>2]=f,o=n+500|0,yf[t[t[f>>2]+96>>2]](f)||(o=t[n+216>>2],o=0|yf[t[t[o>>2]+100>>2]](o)?n+508|0:n+492|0),t[o+4>>2]=n+216,t[n+516>>2]=o,bA=0|yf[t[t[i>>2]+92>>2]](i),oA=0|yf[t[t[f>>2]+92>>2]](f),k=t[n+828>>2],k)for(J=(k<<3)-4|0,l=n+136|0,u=n+120|0,F=n+104|0,Z=n+200|0,Y=n+184|0,N=n+168|0,kA=n+212|0,cA=n+196|0,uA=n+180|0;s=A+32|0,o=t[n+836>>2]+J|0,t[s>>2]=t[o>>2],d=A+24|0,o=t[o+-4>>2],t[d>>2]=o,c=t[n+820>>2],c=0|yf[t[t[c>>2]>>2]](c,o),o=t[n+516>>2],V=0|yf[t[t[o>>2]>>2]](o,t[s>>2]),o=t[r+12>>2],rA=t[o>>2],eA=t[o+4>>2],v=o+8|0,iA=t[v>>2],v=t[v+4>>2],AA=t[o+16>>2],aA=t[o+20>>2],K=o+24|0,q=t[K>>2],K=t[K+4>>2],_=o+40|0,g=t[_+4>>2],$=Y+8|0,t[$>>2]=t[_>>2],t[$+4>>2]=g,$=t[o+32>>2],_=t[o+36>>2],g=t[o+52>>2],t[Z>>2]=t[o+48>>2],t[Z+4>>2]=g,o=o+56|0,I=t[o+4>>2],g=Z+8|0,t[g>>2]=t[o>>2],t[g+4>>2]=I,t[Y>>2]=$,t[Y+4>>2]=_,o=N+8|0,t[o>>2]=q,t[o+4>>2]=K,t[N>>2]=AA,t[N+4>>2]=aA,AA=n+160|0,o=AA,t[o>>2]=iA,t[o+4>>2]=v,t[n+152>>2]=rA,t[n+156>>2]=eA,o=t[e+12>>2],rA=t[o>>2],eA=t[o+4>>2],v=o+8|0,iA=t[v>>2],v=t[v+4>>2],aA=t[o+16>>2],K=t[o+20>>2],q=o+24|0,$=t[q>>2],q=t[q+4>>2],g=o+40|0,I=t[g+4>>2],_=u+8|0,t[_>>2]=t[g>>2],t[_+4>>2]=I,_=t[o+32>>2],g=t[o+36>>2],I=t[o+52>>2],t[l>>2]=t[o+48>>2],t[l+4>>2]=I,o=o+56|0,lA=t[o+4>>2],I=l+8|0,t[I>>2]=t[o>>2],t[I+4>>2]=lA,t[u>>2]=_,t[u+4>>2]=g,o=F+8|0,t[o>>2]=$,t[o+4>>2]=q,t[F>>2]=aA,t[F+4>>2]=K,o=n+96|0,t[o>>2]=iA,t[o+4>>2]=v,t[n+88>>2]=rA,t[n+92>>2]=eA,bA&&(yf[t[t[i>>2]+132>>2]](n+24|0,i,t[d>>2]),fA=C[n+960>>2],nA=C[n+964>>2],tA=C[n+968>>2],X=C[n+80>>2],M=C[n+72>>2],x=C[n+76>>2],m=C[n+920>>2],R=C[n+936>>2],G=C[n+928>>2],h=C[n+932>>2],S=C[n+56>>2],T=C[n+40>>2],U=C[n+60>>2],j=C[n+44>>2],y=C[n+952>>2],O=C[n- -64>>2],p=C[n+944>>2],H=C[n+32>>2],D=C[n+948>>2],z=C[n+48>>2],w=C[n+912>>2],W=C[n+916>>2],P=C[n+24>>2],L=C[n+28>>2],t[kA>>2]=0,t[cA>>2]=0,t[uA>>2]=0,t[n+164>>2]=0,C[n+192>>2]=B(B(H*p)+B(z*D))+B(O*y),C[n+188>>2]=B(B(L*p)+B(j*D))+B(U*y),C[Y>>2]=B(B(P*p)+B(T*D))+B(S*y),C[n+176>>2]=B(B(H*G)+B(z*h))+B(O*R),C[n+172>>2]=B(B(L*G)+B(j*h))+B(U*R),C[N>>2]=B(B(P*G)+B(T*h))+B(S*R),C[AA>>2]=B(B(w*H)+B(W*z))+B(m*O),C[n+208>>2]=tA+B(B(B(p*M)+B(D*x))+B(y*X)),C[n+204>>2]=nA+B(B(B(G*M)+B(h*x))+B(R*X)),C[Z>>2]=fA+B(B(B(w*M)+B(W*x))+B(m*X)),C[n+156>>2]=B(B(w*L)+B(W*j))+B(m*U),C[n+152>>2]=B(B(P*w)+B(T*W))+B(S*m)),k=k+-1|0,oA&&(yf[t[t[f>>2]+132>>2]](n+24|0,f,t[s>>2]),fA=C[n+896>>2],nA=C[n+900>>2],tA=C[n+904>>2],X=C[n+80>>2],M=C[n+72>>2],x=C[n+76>>2],m=C[n+856>>2],R=C[n+872>>2],G=C[n+864>>2],h=C[n+868>>2],S=C[n+56>>2],T=C[n+40>>2],U=C[n+60>>2],j=C[n+44>>2],y=C[n+888>>2],O=C[n- -64>>2],p=C[n+880>>2],H=C[n+32>>2],D=C[n+884>>2],z=C[n+48>>2],w=C[n+848>>2],W=C[n+852>>2],P=C[n+24>>2],L=C[n+28>>2],t[n+148>>2]=0,t[n+132>>2]=0,t[n+116>>2]=0,t[n+100>>2]=0,C[n+128>>2]=B(B(H*p)+B(z*D))+B(O*y),C[n+124>>2]=B(B(L*p)+B(j*D))+B(U*y),C[u>>2]=B(B(P*p)+B(T*D))+B(S*y),C[n+112>>2]=B(B(H*G)+B(z*h))+B(O*R),C[n+108>>2]=B(B(L*G)+B(j*h))+B(U*R),C[F>>2]=B(B(P*G)+B(T*h))+B(S*R),C[o>>2]=B(B(w*H)+B(W*z))+B(m*O),C[n+144>>2]=tA+B(B(B(p*M)+B(D*x))+B(y*X)),C[n+140>>2]=nA+B(B(B(G*M)+B(h*x))+B(R*X)),C[l>>2]=fA+B(B(B(w*M)+B(W*x))+B(m*X)),C[n+92>>2]=B(B(w*L)+B(W*j))+B(m*U),C[n+88>>2]=B(B(P*w)+B(T*W))+B(S*m)),t[n+44>>2]=t[d>>2],t[n+40>>2]=t[A+28>>2],t[n+24>>2]=r,t[n+32>>2]=t[r+8>>2],t[n+28>>2]=c,t[n+36>>2]=n+152,t[n+20>>2]=t[s>>2],t[n+16>>2]=t[A+36>>2],t[n>>2]=e,t[n+8>>2]=t[e+8>>2],t[n+12>>2]=n+88,t[n+4>>2]=V,mr(A,n+24|0,n,c,V),J=J+-8|0,k;){}yf[t[t[i>>2]+116>>2]](i),yf[t[t[f>>2]+116>>2]](f),er(n+328|0),er(n+216|4),er(n+632|0),er(n+520|4);}if(A=t[n+836>>2],!A)break A;}b[n+840|0]&&gA(A),t[n+836>>2]=0;}else {if(k=t[f+156>>2],o=k+-1|0,t[A+36>>2]=o,!k)break A;for(k=f+164|0,f=A+36|0;Rr(A,r,e,i,t[t[k>>2]+(o<<2)>>2]),l=t[f>>2],o=l+-1|0,t[f>>2]=o,l;){}}}else {if(k=t[i+156>>2],o=k+-1|0,t[A+28>>2]=o,!k)break A;for(k=i+164|0,i=A+28|0;Rr(A,r,e,t[t[k>>2]+(o<<2)>>2],f),l=t[i>>2],o=l+-1|0,t[i>>2]=o,l;){}}E=n+976|0;}function Gr(A,r,e,i,f,n){var o,k=0,c=0,u=0,l=0,s=0,d=0,v=0,R=0,G=0,h=0,y=0,Q=0,p=0,D=0;o=E-528|0,E=o;A:{r:if(2!=(0|yf[t[t[i>>2]+80>>2]](i))){if(c=1!=(0|yf[t[t[i>>2]+80>>2]](i)),k=t[f+4>>2],!(c|28!=(0|k))){!function(A,r,e,i,a,f){var n=0,b=0,o=B(0),k=0,c=B(0),u=B(0),l=0,s=0,d=0,v=B(0),R=B(0),G=0,h=0,y=B(0),Q=B(0),p=B(0),D=0,w=B(0),W=B(0),F=0,Z=0,Y=B(0),N=0,V=B(0),I=B(0),J=0,X=0,M=0,x=0,S=0,T=0,U=0,j=0,O=0;if(b=E-144|0,E=b,n=t[r+12>>2],G=n+8|0,l=t[G+4>>2],s=b+88|0,t[s>>2]=t[G>>2],t[s+4>>2]=l,s=t[n>>2],G=t[n+4>>2],h=n+24|0,d=t[h+4>>2],l=b+104|0,t[l>>2]=t[h>>2],t[l+4>>2]=d,l=t[n+16>>2],h=t[n+20>>2],k=n+40|0,D=t[k+4>>2],d=b+120|0,t[d>>2]=t[k>>2],t[d+4>>2]=D,d=t[n+32>>2],k=t[n+36>>2],Z=n+56|0,N=t[Z+4>>2],D=b+136|0,t[D>>2]=t[Z>>2],t[D+4>>2]=N,t[b+80>>2]=s,t[b+84>>2]=G,t[b+96>>2]=l,t[b+100>>2]=h,t[b+112>>2]=d,t[b+116>>2]=k,s=t[n+52>>2],t[b+128>>2]=t[n+48>>2],t[b+132>>2]=s,n=t[e+12>>2],v=C[n+20>>2],R=C[n+24>>2],y=C[n+36>>2],W=C[n+40>>2],Q=C[n+8>>2],p=C[n>>2],Y=C[n+4>>2],V=C[n+16>>2],I=C[n+32>>2],o=C[a+52>>2],c=C[a+56>>2],u=C[a+60>>2],w=B(B(B(B(C[n+48>>2]*o)+B(C[n+52>>2]*c))+B(C[n+56>>2]*u))+C[a+68>>2]),C[b+76>>2]=w,y=B(B(B(I*o)+B(y*c))+B(W*u)),C[b+72>>2]=y,v=B(B(B(V*o)+B(v*c))+B(R*u)),C[b+68>>2]=v,R=B(B(B(p*o)+B(Y*c))+B(Q*u)),C[b+64>>2]=R,yf[t[t[i>>2]+8>>2]](i,b+80|0,b+32|0,b+48|0),o=B(yf[t[t[a>>2]+48>>2]](a)),n=b+52|0,c=B(o+C[n>>2]),C[n>>2]=c,n=b+56|0,u=B(o+C[n>>2]),C[n>>2]=u,Q=B(C[b+36>>2]-o),C[b+36>>2]=Q,W=B(o+C[b+48>>2]),C[b+48>>2]=W,p=B(C[b+32>>2]-o),C[b+32>>2]=p,o=B(C[b+40>>2]-o),C[b+40>>2]=o,p=B(B(p+W)*B(.5)),Q=B(B(Q+c)*B(.5)),o=B(B(o+u)*B(.5)),Y=B(B(B(p*R)+B(Q*v))+B(o*y)),o=B(B(B(B(W-p)*B(m(R)))+B(B(c-Q)*B(m(v))))+B(B(u-o)*B(m(y)))),!(w>B(B(Y+o)+B(9.999999974752427e-7))|B(w+B(9.999999974752427e-7))>=B(Y-o)^1)){yf[t[t[i>>2]+112>>2]](i),o=B(yf[t[t[i>>2]+48>>2]](i)),c=B(yf[t[t[a>>2]+48>>2]](a)),a=t[i+188>>2];e:if(a)for(y=B(o+c),a=a+-1|0,D=i+196|0,Z=i+184|0,N=i+192|0,s=i+160|0,G=i+164|0,l=i+168|0,J=b+116|0,X=b+112|0,M=b+120|0,x=b+136|0,S=b+128|0,T=b+100|0,U=b+96|0,j=b+104|0,O=b+132|0,h=A+28|0,d=A+4|0;;){n=t[Z>>2]+_(t[D>>2],a)|0,1!=t[N>>2]?(o=B(C[n>>2]*C[s>>2]),C[b+16>>2]=o,c=B(C[n+4>>2]*C[G>>2]),C[b+20>>2]=c,u=B(C[n+8>>2]*C[l>>2])):(o=B(g[n>>3]*+C[s>>2]),C[b+16>>2]=o,c=B(g[n+8>>3]*+C[G>>2]),C[b+20>>2]=c,u=B(g[n+16>>3]*+C[l>>2])),t[b+28>>2]=0,v=B(B(B(B(o*C[X>>2])+B(c*C[J>>2]))+B(u*C[M>>2]))+C[x>>2]),C[b+24>>2]=v,R=B(B(B(B(o*C[b+80>>2])+B(c*C[b+84>>2]))+B(u*C[b+88>>2]))+C[S>>2]),C[b+16>>2]=R,w=C[b+64>>2],o=B(B(B(B(o*C[U>>2])+B(c*C[T>>2]))+B(u*C[j>>2]))+C[O>>2]),C[b+20>>2]=o;i:{if(c=C[b+68>>2],u=C[b+72>>2],o=B(B(B(B(B(R*w)+B(o*c))+B(v*u))-C[b+76>>2])-y),o<B(0)){if(!f)break i;t[b+12>>2]=0,C[b+8>>2]=-u,C[b+4>>2]=-c,C[b>>2]=-w,k=A+16|0,n=t[k>>2],yf[t[t[n>>2]+8>>2]](n,t[h>>2],t[A+24>>2]),n=t[k>>2],yf[t[t[n>>2]+12>>2]](n,t[A+36>>2],t[A+32>>2]),F=A+12|0,n=t[F>>2],n||(n=t[d>>2],n=0|yf[t[t[n>>2]+12>>2]](n,t[e+8>>2],t[r+8>>2]),t[F>>2]=n),k=t[k>>2],t[k+4>>2]=n,yf[t[t[k>>2]+16>>2]](k,b,b+16|0,o);}if(a=a+-1|0,-1!=(0|a))continue;break e;}if(k=A+16|0,n=t[k>>2],yf[t[t[n>>2]+8>>2]](n,t[h>>2],t[A+24>>2]),n=t[k>>2],yf[t[t[n>>2]+12>>2]](n,t[A+36>>2],t[A+32>>2]),F=A+12|0,n=t[F>>2],n||(n=t[d>>2],n=0|yf[t[t[n>>2]+12>>2]](n,t[r+8>>2],t[e+8>>2]),t[F>>2]=n),k=t[k>>2],t[k+4>>2]=n,yf[t[t[k>>2]+16>>2]](k,b- -64|0,b+16|0,o),a=a+-1|0,-1==(0|a))break;}yf[t[t[i>>2]+116>>2]](i);}E=b+144|0;}(A,r,e,i,f,n);break A;}if(31==(0|k)){!function(A,r,e,i,a,f){var n=0,b=0,o=0,k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=0,Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=0,Y=0,N=0,V=0,I=0,J=B(0),X=B(0),M=B(0),x=0,S=0;if(b=E-96|0,E=b,o=t[a+20>>2],o)for(n=t[e+12>>2],J=C[n+56>>2],X=C[n+52>>2],l=C[n+40>>2],s=C[n+36>>2],d=C[n+24>>2],v=C[n+20>>2],M=C[n+48>>2],g=C[n+32>>2],m=C[n+16>>2],R=C[n+8>>2],G=C[n+4>>2],h=C[n>>2],y=o+-1|0,o=_(o,80)+-80|0,x=b+92|0,S=b+76|0;n=t[a+28>>2]+o|0,Y=t[n- -64>>2],t[x>>2]=0,t[S>>2]=0,t[b+60>>2]=0,t[b+44>>2]=0,k=C[n+8>>2],c=C[n+24>>2],u=C[n+40>>2],C[b+72>>2]=B(B(g*k)+B(s*c))+B(l*u),Q=C[n+4>>2],p=C[n+20>>2],D=C[n+36>>2],C[b+68>>2]=B(B(g*Q)+B(s*p))+B(l*D),w=C[n>>2],W=C[n+16>>2],F=C[n+32>>2],C[b- -64>>2]=B(B(g*w)+B(s*W))+B(l*F),C[b+56>>2]=B(B(m*k)+B(v*c))+B(d*u),C[b+52>>2]=B(B(m*Q)+B(v*p))+B(d*D),C[b+48>>2]=B(B(m*w)+B(v*W))+B(d*F),C[b+40>>2]=B(B(h*k)+B(G*c))+B(R*u),k=C[n+48>>2],c=C[n+52>>2],u=C[n+56>>2],C[b+88>>2]=J+B(B(B(g*k)+B(s*c))+B(l*u)),C[b+84>>2]=X+B(B(B(m*k)+B(v*c))+B(d*u)),C[b+80>>2]=M+B(B(B(h*k)+B(G*c))+B(R*u)),C[b+36>>2]=B(B(h*Q)+B(G*p))+B(R*D),C[b+32>>2]=B(B(h*w)+B(G*W))+B(R*F),t[b+8>>2]=e,N=b+16|0,V=t[e+8>>2],t[N>>2]=V,t[b+28>>2]=y,t[b+24>>2]=-1,t[b+20>>2]=b+32,t[b+12>>2]=Y,I=A+16|0,n=t[I>>2],Z=t[n+8>>2],t[Z+8>>2]==(0|V)?n=n+8|0:(Z=t[n+12>>2],n=n+12|0),t[n>>2]=b+8,Gr(A,r,b+8|0,i,Y,f),n=t[I>>2],t[(t[t[n+8>>2]+8>>2]==t[N>>2]?8:12)+n>>2]=Z,o=o+-80|0,y=y+-1|0,-1!=(0|y);){}E=b+96|0;}(A,r,e,i,f,n);break A;}if(k+-21>>>0<=8){!function(A,r,e,i,f,n){var b=0,o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),N=B(0),V=0,I=B(0);b=E-128|0,E=b,a[b+116|0]=n,t[b+112>>2]=i,t[b+100>>2]=A,t[b+96>>2]=8844,t[b+104>>2]=r,t[b+108>>2]=e,V=b,I=B(yf[t[t[f>>2]+48>>2]](f)),C[V+120>>2]=I,A=t[e+12>>2],m=C[A+52>>2],R=C[A+56>>2],r=t[r+12>>2],G=C[r+52>>2],h=C[r+56>>2],o=C[A+20>>2],k=C[A+36>>2],y=C[r+20>>2],Q=C[r+36>>2],p=C[r+24>>2],c=C[A+24>>2],D=C[r+40>>2],u=C[A+40>>2],w=C[r+32>>2],l=C[A+32>>2],W=C[r>>2],s=C[A>>2],F=C[r+16>>2],d=C[A+16>>2],v=C[A+48>>2],Z=C[r+48>>2],g=C[A+4>>2],Y=C[r+4>>2],N=C[r+8>>2],_=C[A+8>>2],t[b+92>>2]=0,t[b+76>>2]=0,t[b+60>>2]=0,C[b+72>>2]=B(B(_*N)+B(c*p))+B(u*D),C[b+68>>2]=B(B(_*Y)+B(c*y))+B(u*Q),C[b+56>>2]=B(B(g*N)+B(o*p))+B(k*D),C[b+52>>2]=B(B(g*Y)+B(o*y))+B(k*Q),v=B(-v),C[b+88>>2]=B(B(B(_*v)-B(c*m))-B(u*R))+B(B(B(_*Z)+B(c*G))+B(u*h)),C[b+84>>2]=B(B(B(g*v)-B(o*m))-B(k*R))+B(B(B(g*Z)+B(o*G))+B(k*h)),t[b+44>>2]=0,C[b+32>>2]=B(B(s*W)+B(d*F))+B(l*w),C[b+64>>2]=B(B(_*W)+B(c*F))+B(u*w),C[b+48>>2]=B(B(g*W)+B(o*F))+B(k*w),C[b+40>>2]=B(B(s*N)+B(d*p))+B(l*D),C[b+36>>2]=B(B(s*Y)+B(d*y))+B(l*Q),C[b+80>>2]=B(B(B(s*v)-B(d*m))-B(l*R))+B(B(B(s*Z)+B(d*G))+B(l*h)),yf[t[t[i>>2]+8>>2]](i,b+32|0,b+16|0,b),yf[t[t[f>>2]+64>>2]](f,b+96|0,b+16|0,b),E=b+128|0;}(A,r,e,i,f,n);break A;}if(k=t[r+12>>2],c=k+8|0,l=t[c>>2],c=t[c+4>>2],u=k+24|0,h=t[u>>2],u=t[u+4>>2],y=t[k+16>>2],Q=t[k+20>>2],R=t[k>>2],v=t[k+4>>2],G=k+40|0,s=t[G+4>>2],d=o+504|0,t[d>>2]=t[G>>2],t[d+4>>2]=s,d=t[k+32>>2],G=t[k+36>>2],p=k+56|0,D=t[p+4>>2],s=o+520|0,t[s>>2]=t[p>>2],t[s+4>>2]=D,s=o+488|0,t[s>>2]=h,t[s+4>>2]=u,u=o+472|0,t[u>>2]=l,t[u+4>>2]=c,t[o+464>>2]=R,t[o+468>>2]=v,c=t[k+52>>2],t[o+512>>2]=t[k+48>>2],t[o+516>>2]=c,t[o+496>>2]=d,t[o+500>>2]=G,t[o+480>>2]=y,t[o+484>>2]=Q,k=t[e+12>>2],c=k+8|0,l=t[c>>2],c=t[c+4>>2],u=k+24|0,h=t[u>>2],u=t[u+4>>2],y=t[k+16>>2],Q=t[k+20>>2],R=t[k>>2],v=t[k+4>>2],G=k+40|0,s=t[G+4>>2],d=o+440|0,t[d>>2]=t[G>>2],t[d+4>>2]=s,d=t[k+32>>2],G=t[k+36>>2],p=k+56|0,D=t[p+4>>2],s=o+456|0,t[s>>2]=t[p>>2],t[s+4>>2]=D,s=o+424|0,t[s>>2]=h,t[s+4>>2]=u,u=o+408|0,t[u>>2]=l,t[u+4>>2]=c,t[o+400>>2]=R,t[o+404>>2]=v,c=t[k+52>>2],t[o+448>>2]=t[k+48>>2],t[o+452>>2]=c,t[o+432>>2]=d,t[o+436>>2]=G,t[o+416>>2]=y,t[o+420>>2]=Q,t[o+388>>2]=0,a[o+392|0]=1,t[o+380>>2]=0,t[o+384>>2]=0,function(A,r,e,i,f){var n,o,k=0,c=0,u=B(0),l=B(0),s=0,d=B(0),v=0,g=0,_=B(0),m=B(0),R=0,G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=0,N=B(0),V=B(0),I=B(0),J=0,X=0,M=0,x=0,S=0;if(n=E-96|0,E=n,t[e+72>>2])return k=A+20|0,y=C[k>>2],v=n+20|0,t[v>>2]=t[k>>2],t[n+12>>2]=0,Q=C[A+4>>2],t[n+16>>2]=t[A+4>>2],w=C[A+32>>2],t[n+8>>2]=t[A+32>>2],W=C[A+16>>2],t[n+4>>2]=t[A+16>>2],F=C[A>>2],t[n>>2]=t[A>>2],_=C[A+52>>2],m=C[A+56>>2],k=A+24|0,u=C[k>>2],c=t[k>>2],k=A+40|0,p=C[k>>2],s=t[k>>2],l=C[A+8>>2],R=t[A+8>>2],d=C[A+48>>2],k=A+36|0,D=C[k>>2],A=n+24|0,t[A>>2]=t[k>>2],k=n+40|0,t[k>>2]=s,s=n+36|0,t[s>>2]=c,c=n+28|0,t[c>>2]=0,t[n+60>>2]=0,g=n+44|0,t[g>>2]=0,d=B(-d),Z=B(B(B(l*d)-B(_*u))-B(m*p)),G=C[r+48>>2],h=B(G*l),l=C[r+52>>2],h=B(h+B(l*u)),u=C[r+56>>2],C[n+56>>2]=Z+B(h+B(u*p)),C[n+52>>2]=B(B(B(Q*d)-B(_*y))-B(m*D))+B(B(B(G*Q)+B(l*y))+B(u*D)),t[n+32>>2]=R,C[n+48>>2]=B(B(B(F*d)-B(_*W))-B(m*w))+B(B(B(G*F)+B(l*W))+B(u*w)),_=C[r+36>>2],m=C[r+20>>2],y=C[r+40>>2],Q=C[r+24>>2],u=C[r+32>>2],p=C[r>>2],l=C[r+16>>2],D=C[A>>2],d=C[v>>2],G=C[r+4>>2],Z=C[k>>2],h=C[r+8>>2],N=C[s>>2],V=C[n+16>>2],I=C[n+32>>2],t[g>>2]=0,C[k>>2]=B(B(h*I)+B(Q*N))+B(y*Z),C[s>>2]=B(B(G*I)+B(m*N))+B(_*Z),t[c>>2]=0,C[A>>2]=B(B(h*V)+B(Q*d))+B(y*D),C[v>>2]=B(B(G*V)+B(m*d))+B(_*D),C[n+32>>2]=B(B(p*I)+B(l*N))+B(u*Z),C[n+16>>2]=B(B(p*V)+B(l*d))+B(u*D),t[n+12>>2]=0,C[n+8>>2]=B(B(h*F)+B(Q*W))+B(y*w),C[n+4>>2]=B(B(G*F)+B(m*W))+B(_*w),C[n>>2]=B(B(p*F)+B(l*W))+B(u*w),yf[t[t[i>>2]+8>>2]](i,n,n- -64|0,n+80|0),mA(e+72|0,n- -64|0,f),void(E=n+96|0);if(o=n+80|0,yf[t[t[i>>2]+8>>2]](i,r,n- -64|0,o),r=0|yf[t[t[e>>2]+88>>2]](e),r)for(J=n+16|0,M=n+20|0,x=n+24|0,S=n+72|0,R=f+4|0,g=f+12|0;;){if(r=r+-1|0,yf[t[t[e>>2]+120>>2]](e,r,A,n,J),!(C[o>>2]<C[n>>2]|C[n+64>>2]>C[J>>2]|C[n+84>>2]<C[n+4>>2]|C[n+68>>2]>C[M>>2]|C[n+88>>2]<C[n+8>>2]|C[S>>2]>C[x>>2])){if(c=t[R>>2],X=f+8|0,(0|c)==t[X>>2]&&(Y=c?c<<1:1,!((0|c)>=(0|Y)))){e:{i:{a:{f:{if(Y){if(i=CA(Y<<2,16),v=t[g>>2],c=t[R>>2],(0|c)>=1)break f;break a;}if(i=0,v=t[g>>2],(0|c)<1)break a;}for(k=i,s=v;t[k>>2]=t[s>>2],k=k+4|0,s=s+4|0,c=c+-1|0,c;){}break i;}if(!v)break e;}b[f+16|0]&&gA(v),t[g>>2]=0,c=t[R>>2];}t[g>>2]=i,a[f+16|0]=1,t[X>>2]=Y;}t[t[g>>2]+(c<<2)>>2]=r,t[R>>2]=t[R>>2]+1;}if(!r)break;}E=n+96|0;}(o+464|0,o+400|0,i,f,o+376|0),t[o+380>>2]){if(yf[t[t[i>>2]+112>>2]](i),LA(o+72|4),f=o+176|0,t[f>>2]=0,t[f+4>>2]=0,f=o+168|0,t[f>>2]=0,t[f+4>>2]=0,f=o+160|0,t[f>>2]=0,t[f+4>>2]=0,f=o+152|0,t[f>>2]=0,t[f+4>>2]=0,f=o+144|0,t[f>>2]=0,t[f+4>>2]=0,f=o+136|0,t[f>>2]=0,t[f+4>>2]=0,t[o+80>>2]=1,t[o+76>>2]=8188,tr(o+184|0),t[o+280>>2]=4,t[o+364>>2]=8768,t[o+356>>2]=8688,t[o+348>>2]=8616,t[o+184>>2]=8424,t[o+72>>2]=i,f=o+356|0,yf[t[t[i>>2]+96>>2]](i)||(f=t[o+72>>2],f=0|yf[t[t[f>>2]+100>>2]](f)?o+364|0:o+348|0),t[f+4>>2]=o+72,t[o+372>>2]=f,c=0|yf[t[t[i>>2]+92>>2]](i),f=t[o+380>>2],f)if(n)for(k=(f<<2)-4|0,l=A+32|0,u=o+388|0,h=o+372|0,y=A+24|0,Q=o+28|0,R=A+28|0;n=t[t[u>>2]+k>>2],t[l>>2]=n,v=t[h>>2],v=0|yf[t[t[v>>2]>>2]](v,n),c&&yf[t[t[i>>2]+132>>2]](o+8|0,i,n),t[o+8>>2]=r,t[o+20>>2]=t[r+12>>2],d=t[r+8>>2],t[o+16>>2]=d,t[Q>>2]=t[y>>2],t[o+24>>2]=t[R>>2],t[o+12>>2]=v,v=A+16|0,G=t[v>>2],n=t[G+8>>2],t[((0|d)==t[n+8>>2]?8:12)+G>>2]=o+8,Br(A,e,o+8|0),t[t[v>>2]+8>>2]=n,k=k+-4|0,f=f+-1|0,f;){}else for(k=(f<<2)-4|0,n=A+24|0,u=o+388|0,h=o+372|0,y=o+28|0,Q=A+28|0;l=t[t[u>>2]+k>>2],t[n>>2]=l,R=t[h>>2],R=0|yf[t[t[R>>2]>>2]](R,l),c&&yf[t[t[i>>2]+132>>2]](o+8|0,i,l),t[o+8>>2]=r,t[o+20>>2]=t[r+12>>2],v=t[r+8>>2],t[o+16>>2]=v,t[y>>2]=t[n>>2],t[o+24>>2]=t[Q>>2],t[o+12>>2]=R,R=A+16|0,d=t[R>>2],l=t[d+8>>2],t[((0|v)==t[l+8>>2]?8:12)+d>>2]=o+8,Br(A,o+8|0,e),t[t[R>>2]+8>>2]=l,k=k+-4|0,f=f+-1|0,f;){}yf[t[t[i>>2]+116>>2]](i),er(o+184|0),er(o+72|4);}A=t[o+388>>2],A&&(b[o+392|0]&&gA(A),t[o+388>>2]=0);}else {if(c=(n?36:28)+A|0,l=t[i+156>>2],k=l+-1|0,t[c>>2]=k,!l)break r;for(i=i+164|0;Gr(A,r,e,t[t[i>>2]+(k<<2)>>2],f,n),l=t[c>>2],k=l+-1|0,t[c>>2]=k,l;){}}return void(E=o+528|0);}E=o+528|0;}function hr(A,r,e,i,a){return B(B(1));}function yr(A){return A|=0,A+16|0;}function Qr(A,r,e){A|=0,r=B(r),e|=0,t[e>>2]=0,t[e+4>>2]=0,A=e+8|0,t[A>>2]=0,t[A+4>>2]=0;}function pr(A,r){A|=0,r=B(r),C[A+48>>2]=r;}function Dr(A){return 52;}function wr(A){return 2;}function Wr(A){return 3;}function Fr(A){return 1;}function Zr(A){return 0;}function Yr(A,r,e){}function Er(A){var r=0;t[A+132>>2]=0,t[A+136>>2]=0,t[A>>2]=9024,t[A+180>>2]=0,t[A+184>>2]=1566444395,t[A+164>>2]=1065353216,t[A+168>>2]=1065353216,t[A+188>>2]=0,t[A+192>>2]=0,t[A+276>>2]=0,t[A+280>>2]=0,t[A+268>>2]=1065353216,t[A+272>>2]=0,t[A+260>>2]=-1,t[A+264>>2]=-1,t[A+252>>2]=1,t[A+256>>2]=0,t[A+244>>2]=1036831949,t[A+248>>2]=1176256512,t[A+236>>2]=0,t[A+240>>2]=0,t[A+228>>2]=1056964608,t[A+232>>2]=0,t[A+220>>2]=1,t[A+224>>2]=0,t[A+212>>2]=-1,t[A+216>>2]=-1,t[A+204>>2]=1,t[A+208>>2]=-1,r=A+156|0,t[r>>2]=0,t[r+4>>2]=0,r=A+148|0,t[r>>2]=0,t[r+4>>2]=0,r=A+140|0,t[r>>2]=0,t[r+4>>2]=0,r=A+172|0,t[r>>2]=1065353216,t[r+4>>2]=0,r=A+196|0,t[r>>2]=0,t[r+4>>2]=0,a[A+300|0]=1,t[A+304>>2]=0,r=A+288|0,t[r>>2]=0,t[r+4>>2]=0,t[A+296>>2]=0,t[A+4>>2]=1065353216,r=A+16|0,t[r>>2]=0,t[r+4>>2]=0,r=A+8|0,t[r>>2]=0,t[r+4>>2]=0,t[A+24>>2]=1065353216,r=A+36|0,t[r>>2]=0,t[r+4>>2]=0,r=A+28|0,t[r>>2]=0,t[r+4>>2]=0,t[A+44>>2]=1065353216,r=A+56|0,t[r>>2]=0,t[r+4>>2]=0,r=A+48|0,t[r>>2]=0,t[r+4>>2]=0,r=A- -64|0,t[r>>2]=0,t[r+4>>2]=1065353216,r=A+80|0,t[r>>2]=0,t[r+4>>2]=0,r=A+72|0,t[r>>2]=0,t[r+4>>2]=0,t[A+88>>2]=1065353216,r=A+100|0,t[r>>2]=0,t[r+4>>2]=0,r=A+92|0,t[r>>2]=0,t[r+4>>2]=0,t[A+108>>2]=1065353216,t[A+128>>2]=0,r=A+120|0,t[r>>2]=0,t[r+4>>2]=0,A=A+112|0,t[A>>2]=0,t[A+4>>2]=0;}function Nr(A){A|=0;var r,e=0;return t[A>>2]=9024,e=A+296|0,r=t[e>>2],r&&(b[A+300|0]&&gA(r),t[A+296>>2]=0),t[e>>2]=0,a[A+300|0]=1,e=A+288|0,t[e>>2]=0,t[e+4>>2]=0,0|A;}function Vr(A,r){4!=(-2&t[A+220>>2])&&(t[A+220>>2]=r);}function Ir(A,r){!(3&b[A+204|0])|r&&(4!=(-2&t[A+220>>2])&&(t[A+220>>2]=1),t[A+224>>2]=0);}function Jr(A,r,e){A|=0,r|=0,e|=0;var i=0,a=0;return t[r+16>>2]=t[A+4>>2],t[r+20>>2]=t[A+8>>2],t[r+24>>2]=t[A+12>>2],t[r+28>>2]=t[A+16>>2],t[r+32>>2]=t[A+20>>2],t[r+36>>2]=t[A+24>>2],t[r+40>>2]=t[A+28>>2],t[r+44>>2]=t[A+32>>2],t[r+48>>2]=t[A+36>>2],t[r+52>>2]=t[A+40>>2],t[r+56>>2]=t[A+44>>2],t[r+60>>2]=t[A+48>>2],t[r+64>>2]=t[A+52>>2],t[r+68>>2]=t[A+56>>2],t[r+72>>2]=t[A+60>>2],t[r+76>>2]=t[A- -64>>2],t[r+80>>2]=t[A+68>>2],t[r+84>>2]=t[A+72>>2],t[r+88>>2]=t[A+76>>2],t[r+92>>2]=t[A+80>>2],t[r+96>>2]=t[A+84>>2],t[r+100>>2]=t[A+88>>2],t[r+104>>2]=t[A+92>>2],t[r+108>>2]=t[A+96>>2],t[r+112>>2]=t[A+100>>2],t[r+116>>2]=t[A+104>>2],t[r+120>>2]=t[A+108>>2],t[r+124>>2]=t[A+112>>2],t[r+128>>2]=t[A+116>>2],t[r+132>>2]=t[A+120>>2],t[r+136>>2]=t[A+124>>2],t[r+140>>2]=t[A+128>>2],t[r+144>>2]=t[A+132>>2],t[r+148>>2]=t[A+136>>2],t[r+152>>2]=t[A+140>>2],t[r+156>>2]=t[A+144>>2],t[r+160>>2]=t[A+148>>2],t[r+164>>2]=t[A+152>>2],t[r+168>>2]=t[A+156>>2],t[r+172>>2]=t[A+160>>2],t[r+176>>2]=t[A+164>>2],t[r+180>>2]=t[A+168>>2],t[r+184>>2]=t[A+172>>2],t[r+188>>2]=t[A+176>>2],t[r+232>>2]=t[A+180>>2],t[r+192>>2]=t[A+184>>2],t[r>>2]=0,a=0|yf[t[t[e>>2]+28>>2]](e,t[A+192>>2]),i=t[A+228>>2],t[r+196>>2]=t[A+224>>2],t[r+200>>2]=i,i=t[A+212>>2],t[r+240>>2]=t[A+208>>2],t[r+244>>2]=i,t[r+8>>2]=0,t[r+4>>2]=a,t[r+236>>2]=t[A+204>>2],t[r+248>>2]=t[A+220>>2],t[r+204>>2]=t[A+236>>2],t[r+208>>2]=t[A+244>>2],t[r+212>>2]=t[A+248>>2],t[r+216>>2]=t[A+232>>2],t[r+252>>2]=t[A+252>>2],a=0|yf[t[t[e>>2]+40>>2]](e,A),i=0|yf[t[t[e>>2]+28>>2]](e,a),t[r+12>>2]=i,i&&yf[t[t[e>>2]+48>>2]](e,a),t[r+220>>2]=t[A+268>>2],e=t[A+276>>2],t[r+224>>2]=t[A+272>>2],t[r+228>>2]=e,A=t[A+280>>2],t[r+260>>2]=0,t[r+256>>2]=A,9052;}function Xr(A,r){A|=0,r=B(r);var e,i,a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0);a=B(yf[t[t[A>>2]+48>>2]](A)),f=B(yf[t[t[A>>2]+48>>2]](A)),n=B(yf[t[t[A>>2]+48>>2]](A)),C[A+48>>2]=r,e=A+40|0,r=C[e>>2],i=A+36|0,b=C[i>>2],o=C[A+32>>2],k=B(yf[t[t[A>>2]+48>>2]](A)),c=B(yf[t[t[A>>2]+48>>2]](A)),u=B(yf[t[t[A>>2]+48>>2]](A)),t[A+44>>2]=0,C[i>>2]=B(f+b)-c,C[A+32>>2]=B(a+o)-k,C[e>>2]=B(n+r)-u;}function Mr(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),R=B(0),G=B(0);a=B(yf[t[t[A>>2]+48>>2]](A)),k=C[r+52>>2],b=C[r+20>>2],l=C[r+24>>2],c=C[r+56>>2],o=C[r+36>>2],f=C[A+36>>2],s=C[r+40>>2],d=C[A+40>>2],u=C[r+48>>2],v=C[r>>2],g=C[r+4>>2],_=C[r+8>>2],R=C[r+16>>2],G=C[r+32>>2],n=C[A+32>>2],t[e+12>>2]=0,n=B(a+n),f=B(a+f),a=B(a+d),o=B(B(B(n*B(m(G)))+B(f*B(m(o))))+B(a*B(m(s)))),C[e+8>>2]=c-o,b=B(B(B(n*B(m(R)))+B(f*B(m(b))))+B(a*B(m(l)))),C[e+4>>2]=k-b,a=B(B(B(n*B(m(v)))+B(f*B(m(g))))+B(a*B(m(_)))),C[e>>2]=u-a,t[i+12>>2]=0,C[i+8>>2]=c+o,C[i+4>>2]=b+k,C[i>>2]=a+u;}function xr(A,r){A|=0,r|=0;var e,i,a,f,n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0);n=B(yf[t[t[A>>2]+48>>2]](A)),b=B(yf[t[t[A>>2]+48>>2]](A)),o=B(yf[t[t[A>>2]+48>>2]](A)),e=A+20|0,k=C[e>>2],i=A+36|0,c=C[i>>2],a=A+24|0,u=C[a>>2],f=A+40|0,l=C[f>>2],s=C[A+16>>2],d=C[A+32>>2],YA(A,r),t[A+44>>2]=0,C[f>>2]=B(B(B(o+l)/u)*C[a>>2])-o,C[i>>2]=B(B(B(b+c)/k)*C[e>>2])-b,C[A+32>>2]=B(B(B(n+d)/s)*C[A+16>>2])-n;}function Sr(A){return 6;}function Tr(A){A|=0;var r=B(0),e=B(0);return r=C[A+32>>2],e=B(yf[t[t[A>>2]+48>>2]](A)),B(yf[t[t[A>>2]+48>>2]](A)),B(yf[t[t[A>>2]+48>>2]](A)),B(B(r+e));}function Ur(A,r,e,i,a,f){var n,b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=0,_=0,m=B(0),R=0,G=0,h=B(0),y=B(0),p=0,D=0,w=B(0),W=0,F=0,Z=B(0),Y=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=0,M=0,x=0,S=0,T=0,U=0,j=0,O=0,H=0;n=E-32|0,E=n;A:if(!(t[A+56>>2]<1))for(o=C[i>>2],l=C[e>>2],c=B(o-l),k=C[i+4>>2],s=C[e+4>>2],u=B(k-s),b=C[i+8>>2],d=C[e+8>>2],v=B(b-d),m=B(B(1)/B(Q(B(B(B(c*c)+B(u*u))+B(v*v))))),h=v,v=B(v*m),y=c,c=B(c*m),w=u,u=B(u*m),w=B(B(h*v)+B(B(y*c)+B(w*u))),m=C[f+8>>2],Z=B((d<b?b:d)+m),h=C[f+4>>2],Y=B((s<k?k:s)+h),y=C[f>>2],N=B((l<o?o:l)+y),d=b<d?b:d,b=C[a+8>>2],V=B(d+b),s=k<s?k:s,k=C[a+4>>2],I=B(s+k),l=o<l?o:l,o=C[a>>2],J=B(l+o),i=t[A+96>>2],l=v==B(0)?B(0xde0b6b000000000):B(B(1)/v),_=l<B(0),X=(_<<4)+n|8,s=u==B(0)?B(0xde0b6b000000000):B(B(1)/u),R=s<B(0),M=(R<<4)+n|4,x=((1^_)<<4)+n|8,S=((1^R)<<4)+n|4,d=c==B(0)?B(0xde0b6b000000000):B(B(1)/c),_=d<B(0),T=(_<<4)+n|0,U=((1^_)<<4)+n|0,_=n+16|0,W=n+20|0,F=A+56|0,R=1;;){A=i+8|0,g=t[A>>2],j=t[A+4>>2],O=t[i>>2],H=t[i+4>>2],G=i+24|0,A=t[G+4>>2],D=_+8|0,t[D>>2]=t[G>>2],t[D+4>>2]=A,D=t[i+20>>2],A=_,t[A>>2]=t[i+16>>2],t[A+4>>2]=D,C[W>>2]=C[W>>2]-k,C[A>>2]=C[A>>2]-o,t[n>>2]=O,t[n+4>>2]=H,t[n+8>>2]=g,t[n+12>>2]=j,C[n>>2]=C[n>>2]-y,C[n+4>>2]=C[n+4>>2]-h,C[n+8>>2]=C[n+8>>2]-m,A=n+24|0,C[A>>2]=C[A>>2]-b;r:{e:{i:{if(A=Y<C[i+4>>2]|I>C[i+20>>2],g=0,J>C[i+16>>2]||(g=0,N<C[i>>2]||(g=1)),!(A|1^(Z<C[i+8>>2]|V>C[G>>2]?0:g)||(c=C[e+4>>2],o=B(s*B(C[M>>2]-c)),b=C[e>>2],k=B(d*B(C[U>>2]-b)),o>k||(b=B(d*B(C[T>>2]-b)),c=B(s*B(C[S>>2]-c)),b>c||(v=C[e+8>>2],u=B(l*B(C[X>>2]-v)),k=c<k?c:k,u>k||(o=o>b?o:b,b=B(l*B(C[x>>2]-v)),o>b)))))){if(g=t[i+32>>2],A=-1==(0|g),G=(u>o?u:o)<w&(b<k?b:k)>B(0),1!=(0|G)|-1!=(0|g))break i;yf[t[t[r>>2]+8>>2]](r,t[i+36>>2],t[i+40>>2]);break e;}A=-1==t[i+32>>2],G=0;}if(!(A|G)){if(A=t[i+32>>2],i=(A<<6)+i|0,p=A+p|0,(0|p)<t[F>>2])break r;break A;}}if(i=i- -64|0,p=p+1|0,(0|p)>=t[F>>2])break A;}R=R+1|0,b=C[a+8>>2],k=C[a+4>>2],m=C[f+8>>2],h=C[f+4>>2],o=C[a>>2],y=C[f>>2];}t[434]<(0|R)&&(t[434]=R),E=n+32|0;}function jr(A,r,e,i,a,f,n){var b,o=B(0),k=B(0),c=B(0),u=B(0),l=0,s=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=0,G=B(0),h=B(0),y=0,p=0,D=0,w=0,W=B(0),F=B(0),Z=0,Y=0,N=0,V=B(0),I=B(0),J=B(0),X=0,M=0,x=0,S=0,T=0,U=0,j=0,O=0,H=0,z=0,P=0,L=0,K=0,q=0,$=0,AA=0,rA=0,eA=0,iA=0,aA=0;b=E-32|0,E=b,s=C[e+4>>2],v=C[i+4>>2],g=C[e>>2],u=C[i>>2],G=C[A+28>>2],o=C[A+12>>2],m=C[i+8>>2],h=C[e+8>>2],k=B((m<h?m:h)+C[a+8>>2]),k=k<o?o:k,V=C[A+44>>2],k=B(B((G<k?G:k)-o)*V),i=0,k<B(4294967296)&k>=B(0)&&(i=~~k>>>0),W=C[A+24>>2],k=C[A+8>>2],c=B((v<s?v:s)+C[a+4>>2]),c=c<k?k:c,I=C[A+40>>2],c=B(B((W<c?W:c)-k)*I),l=0,c<B(4294967296)&c>=B(0)&&(l=~~c>>>0),F=C[A+20>>2],c=C[A+4>>2],_=B((u<g?u:g)+C[a>>2]),_=_<c?c:_,J=C[A+36>>2],_=B(B((F<_?F:_)-c)*J),y=0,_<B(4294967296)&_>=B(0)&&(y=~~_>>>0),_=B((h<m?m:h)+C[f+8>>2]),_=_<o?o:_,o=B(B(B((G<_?G:_)-o)*V)+B(1)),p=0,o<B(4294967296)&o>=B(0)&&(p=~~o>>>0),o=B((s<v?v:s)+C[f+4>>2]),o=o<k?k:o,o=B(B(B((W<o?W:o)-k)*I)+B(1)),D=0,o<B(4294967296)&o>=B(0)&&(D=~~o>>>0),o=B((g<u?u:g)+C[f>>2]),o=o<c?c:o,o=B(B(B((F<o?F:o)-c)*J)+B(1));A:{r:{if(!(o<B(4294967296)&o>=B(0))){if(0<(0|n))break r;break A;}if(N=~~o>>>0,0>=(0|n))break A;}for(g=B(u-g),s=B(v-s),v=B(m-h),u=B(B(1)/B(Q(B(B(B(g*g)+B(s*s))+B(v*v))))),o=v,v=B(v*u),k=g,g=B(g*u),c=s,s=B(s*u),h=B(B(o*v)+B(B(k*g)+B(c*s))),S=65534&i,T=65534&l,U=65534&y,p|=1,D|=1,N|=1,i=t[A+136>>2],v=v==B(0)?B(0xde0b6b000000000):B(B(1)/v),R=v<B(0),j=(R<<4)+b|8,s=s==B(0)?B(0xde0b6b000000000):B(B(1)/s),l=s<B(0),O=(l<<4)+b|4,H=((1^R)<<4)+b|8,z=((1^l)<<4)+b|4,g=g==B(0)?B(0xde0b6b000000000):B(B(1)/g),R=g<B(0),P=(R<<4)+b|0,L=((1^R)<<4)+b|0,K=b+28|0,q=A+36|0,$=A+40|0,AA=A+44|0,rA=A+12|0,eA=b+16|0,iA=b+20|0,aA=b+24|0,R=0;;){y=t[i+12>>2],l=0;r:{e:if(!(U>>>0>d[i+6>>1]||(X=d[i>>1],N>>>0<X>>>0||(Z=i+10|0,S>>>0>d[Z>>1]||(M=d[i+4>>1],p>>>0<M>>>0||(Y=i+8|0,T>>>0>d[Y>>1]||(x=d[i+2>>1],D>>>0<x>>>0))))))){if(t[b+12>>2]=0,l=d[Z>>1],Z=d[Y>>1],Y=d[i+6>>1],t[K>>2]=0,u=C[q>>2],o=C[A+4>>2],C[b>>2]=B(B(B(X>>>0)/u)+o)-C[f>>2],k=C[$>>2],c=C[A+8>>2],C[b+4>>2]=B(B(B(x>>>0)/k)+c)-C[f+4>>2],m=C[AA>>2],G=C[rA>>2],C[b+8>>2]=B(B(B(M>>>0)/m)+G)-C[f+8>>2],C[eA>>2]=B(o+B(B(Y>>>0)/u))-C[a>>2],C[iA>>2]=B(c+B(B(Z>>>0)/k))-C[a+4>>2],C[aA>>2]=B(G+B(B(l>>>0)/m))-C[a+8>>2],c=C[e+4>>2],u=B(s*B(C[O>>2]-c)),k=C[e>>2],o=B(g*B(C[L>>2]-k)),!(u>o||(k=B(g*B(C[P>>2]-k)),c=B(s*B(C[z>>2]-c)),k>c||(G=C[e+8>>2],m=B(v*B(C[j>>2]-G)),o=c<o?c:o,m>o||(u=u>k?u:k,k=B(v*B(C[H>>2]-G)),u>k))))){if(l=(m>u?m:u)<h&(k<o?k:o)>B(0),!l|(0|y)<0)break e;l=t[i+12>>2],yf[t[t[r>>2]+8>>2]](r,l>>21,2097151&l);break r;}l=0;}if(!(l|(0|y)>-1)){if(l=t[i+12>>2],i=i-(l<<4)|0,R=R+1|0,w=w-l|0,(0|w)<(0|n))continue;break A;}}if(i=i+16|0,R=R+1|0,w=w+1|0,!((0|w)<(0|n)))break;}}t[434]<(0|R)&&(t[434]=R),E=b+32|0;}function Or(A,r,e,i){var a;a=E-16|0,E=a,t[a+8>>2]=r,t[a>>2]=10048,t[a+4>>2]=t[A+52>>2],function(A,r,e,i){var a,f=0;if(a=E-32|0,E=a,f=a+24|0,t[f>>2]=0,t[f+4>>2]=0,t[a+16>>2]=0,t[a+20>>2]=0,f=a+8|0,t[f>>2]=0,t[f+4>>2]=0,t[a>>2]=0,t[a+4>>2]=0,b[A+60|0])return jr(A,r,e,i,a+16|0,a,t[A+56>>2]),void(E=a+32|0);Ur(A,r,e,i,a+16|0,a),E=a+32|0;}(t[A+56>>2],a,e,i),E=a+16|0;}function Hr(A,r,e,i,a,f){var n;n=E-16|0,E=n,t[n+8>>2]=r,t[n>>2]=10216,t[n+4>>2]=t[A+52>>2],function(A,r,e,i,a,f){b[A+60|0]?jr(A,r,e,i,a,f,t[A+56>>2]):Ur(A,r,e,i,a,f);}(t[A+56>>2],n,e,i,a,f),E=n+16|0;}function zr(A,r,e){A|=0,r|=0,e|=0;var i,a,f,n,b,o=0,k=B(0),c=B(0),u=B(0),l=0,s=0,v=B(0);i=E-80|0,E=i,o=t[A+4>>2],yf[t[t[o>>2]+16>>2]](o,i+28|0,i+24|0,i+20|0,i+16|0,i+12|0,i+8|0,i+4|0,i,r),a=t[A+4>>2],l=a+12|0,f=t[i+12>>2]+_(t[i+8>>2],e)|0,n=t[i+28>>2],b=t[i+20>>2];A:{r:{e:{i:{a:{f:{n:{t:{b:{o:{k:{c:{u:{if(3==t[i>>2]){if(s=t[i+16>>2],o=_(s,d[f+4>>1])+n|0,!b)break u;c=B(C[a+8>>2]*B(g[o+8>>3])),u=B(C[a+4>>2]*B(g[o>>3])),k=B(g[o+16>>3]),o=l;break c;}if(s=t[i+16>>2],o=_(s,t[f+8>>2])+n|0,!b)break k;c=B(C[a+8>>2]*B(g[o+8>>3])),u=B(C[a+4>>2]*B(g[o>>3])),k=B(g[o+16>>3]),o=l;break o;}c=B(C[o+4>>2]*C[a+8>>2]),u=B(C[o>>2]*C[a+4>>2]),k=C[a+12>>2],o=o+8|0;}if(v=C[o>>2],t[i+76>>2]=0,C[i+68>>2]=c,C[i+72>>2]=v*k,C[i+64>>2]=u,o=_(s,d[f+2>>1])+n|0,!b)break b;c=B(C[a+8>>2]*B(g[o+8>>3])),u=B(C[a+4>>2]*B(g[o>>3])),k=B(g[o+16>>3]),o=l;break t;}c=B(C[o+4>>2]*C[a+8>>2]),u=B(C[o>>2]*C[a+4>>2]),k=C[a+12>>2],o=o+8|0;}if(v=C[o>>2],t[i+76>>2]=0,C[i+68>>2]=c,C[i+72>>2]=v*k,C[i+64>>2]=u,o=_(s,t[f+4>>2])+n|0,!b)break n;c=B(C[a+8>>2]*B(g[o+8>>3])),u=B(C[a+4>>2]*B(g[o>>3])),k=B(g[o+16>>3]),o=l;break f;}c=B(C[o+4>>2]*C[a+8>>2]),u=B(C[o>>2]*C[a+4>>2]),k=C[a+12>>2],o=o+8|0;}if(v=C[o>>2],t[i+60>>2]=0,C[i+52>>2]=c,C[i+56>>2]=v*k,C[i+48>>2]=u,o=_(s,d[f>>1])+n|0,!b)break a;c=B(C[a+8>>2]*B(g[o+8>>3])),u=B(C[a+4>>2]*B(g[o>>3])),k=B(g[o+16>>3]);break i;}c=B(C[o+4>>2]*C[a+8>>2]),u=B(C[o>>2]*C[a+4>>2]),k=C[a+12>>2],o=o+8|0;}if(v=C[o>>2],t[i+60>>2]=0,C[i+52>>2]=c,C[i+56>>2]=v*k,C[i+48>>2]=u,o=_(s,t[f>>2])+n|0,!b)break e;c=B(C[a+8>>2]*B(g[o+8>>3])),u=B(C[a+4>>2]*B(g[o>>3])),k=B(g[o+16>>3]);break r;}l=o+8|0,c=B(C[o+4>>2]*C[a+8>>2]),u=B(C[o>>2]*C[a+4>>2]),k=C[a+12>>2];}k=B(C[l>>2]*k);break A;}l=o+8|0,c=B(C[o+4>>2]*C[a+8>>2]),u=B(C[o>>2]*C[a+4>>2]),k=C[a+12>>2];}k=B(C[l>>2]*k);}t[i+44>>2]=0,C[i+40>>2]=k,C[i+36>>2]=c,C[i+32>>2]=u,o=t[A+8>>2],yf[t[t[o>>2]+8>>2]](o,i+32|0,r,e),A=t[A+4>>2],yf[t[t[A>>2]+24>>2]](A,r),E=i+80|0;}function Pr(A){t[A+4>>2]=35,t[A+8>>2]=0,t[A+12>>2]=-1,t[A+16>>2]=0,t[A>>2]=10364;}function Lr(A){return A|=0,A+72|0;}function Kr(A,r,e){var i=0;Pr(A),t[A+88>>2]=0,a[A+92|0]=1,i=A+80|0,t[i>>2]=0,t[i+4>>2]=0,t[A+72>>2]=0,i=A- -64|0,t[i>>2]=1065353216,t[i+4>>2]=0,t[A+56>>2]=1065353216,t[A+60>>2]=1065353216,a[A+52|0]=1,t[A+44>>2]=-8388609,i=A+36|0,t[i>>2]=-8388609,t[i+4>>2]=-8388609,t[A+28>>2]=2139095039,t[A+20>>2]=2139095039,t[A+24>>2]=2139095039,t[A+4>>2]=25,t[A+188>>2]=0,i=A+180|0,t[i>>2]=0,t[i+4>>2]=0,i=A+168|0,t[i>>2]=1065353216,t[i+4>>2]=0,i=A+160|0,t[i>>2]=1065353216,t[i+4>>2]=1065353216,t[A+152>>2]=1008981770,t[A+148>>2]=11228,t[A>>2]=10620,i=A+204|0,t[i>>2]=0,t[i+4>>2]=0,i=A+196|0,t[i>>2]=0,t[i+4>>2]=0,t[A+156>>2]=r,t[A+176>>2]=e,t[A+144>>2]=A+148;}function qr(A){A|=0;var r,e=0;return t[A>>2]=11072,e=A+88|0,r=t[e>>2],r&&(b[A+92|0]&&gA(r),t[A+88>>2]=0),t[e>>2]=0,a[A+92|0]=1,e=A+80|0,t[e>>2]=0,t[e+4>>2]=0,0|A;}function $r(A){return A|=0,A+56|0;}function Ae(A){}function re(A){A|=0;var r,e=0,i=0,f=0,n=0;if(t[A>>2]=10880,r=A+164|0,e=t[r>>2],i=t[A+156>>2],i)for(f=(i<<2)-4|0;i=i+-1|0,n=t[e+f>>2],n&&(yf[t[t[n>>2]+4>>2]](n),e=t[r>>2]),f=f+-4|0,i;){}return e&&(b[A+168|0]&&gA(e),t[A+164>>2]=0),t[A>>2]=11072,t[A+164>>2]=0,a[A+168|0]=1,e=A+156|0,t[e>>2]=0,t[e+4>>2]=0,e=A+88|0,i=t[e>>2],i&&(b[A+92|0]&&gA(i),t[A+88>>2]=0),t[e>>2]=0,a[A+92|0]=1,e=A+80|0,t[e>>2]=0,t[e+4>>2]=0,0|A;}function ee(A,r,e,i,a){}function ie(A){t[A+16>>2]=0,t[A+8>>2]=-1,t[A+12>>2]=0,t[A>>2]=0,t[A+4>>2]=0,t[A+32>>2]=0,a[A+36|0]=1,A=A+24|0,t[A>>2]=0,t[A+4>>2]=0;}function ae(A){var r,e=0;e=t[A>>2],e&&fe(A,e),gA(t[A+4>>2]),t[A+4>>2]=0,t[A+8>>2]=-1,e=A+32|0,r=t[e>>2],r&&(b[A+36|0]&&gA(r),t[A+32>>2]=0),t[A+16>>2]=0,a[A+36|0]=1,t[e>>2]=0,A=A+24|0,t[A>>2]=0,t[A+4>>2]=0;}function fe(A,r){var e;if(e=r+40|0,t[e>>2]&&(fe(A,t[r+36>>2]),fe(A,t[e>>2])),(0|r)!=t[A>>2])return gA(t[A+4>>2]),void(t[A+4>>2]=r);t[A>>2]=0,gA(t[A+4>>2]),t[A+4>>2]=r;}function ne(A){var r,e=0;e=t[A>>2],e&&fe(A,e),gA(t[A+4>>2]),t[A+4>>2]=0,t[A+8>>2]=-1,e=A+32|0,r=t[e>>2],r&&(b[A+36|0]&&gA(r),t[A+32>>2]=0),t[A+16>>2]=0,t[e>>2]=0,a[A+36|0]=1,A=A+24|0,t[A>>2]=0,t[A+4>>2]=0;}function te(A,r){var e,i=0,a=0,f=0,n=0,b=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0,g=0,_=0,B=0,m=0;e=E-32|0,E=e;A:if(r=(0|r)<=-1?t[A+12>>2]:r,!((0|r)<1)&&(i=t[A>>2],i))for(d=A+16|0,o=i+40|0,a=1,t[o>>2]&&(a=0);;){if(a){if(c=A,a=be(A,i)?t[A>>2]:0,oe(c,a,i),t[d>>2]=t[d>>2]+1,r=r+-1|0,!r)break A;i=t[A>>2],o=i+40|0,a=t[o>>2]?0:1;}else {for(v=0;;){r:{e:{i:{if(a=t[i+32>>2],a>>>0>i>>>0){if(b=a+40|0,n=t[b>>2],s=(0|n)==(0|i),k=((0|i)!=(0|n))<<2,u=t[36+(k+a|0)>>2],f=t[a+32>>2],!f)break i;c=36+(f+((t[f+40>>2]==(0|a))<<2)|0)|0;break e;}a=i;break r;}c=A;}t[c>>2]=i,t[u+32>>2]=i,t[a+32>>2]=i,t[i+32>>2]=f,t[a+36>>2]=t[i+36>>2],t[b>>2]=t[o>>2],t[t[i+36>>2]+32>>2]=a,t[t[o>>2]+32>>2]=a,n=i+36|0,t[n+(s<<2)>>2]=a,t[n+k>>2]=u,n=a+24|0,o=t[n+4>>2],f=e+24|0,g=t[n>>2],t[f>>2]=g,t[f+4>>2]=o,f=a+16|0,u=t[f+4>>2],b=e+16|0,_=t[f>>2],t[b>>2]=_,t[b+4>>2]=u,b=a+8|0,s=t[b+4>>2],k=e+8|0,B=t[b>>2],t[k>>2]=B,t[k+4>>2]=s,k=t[a+4>>2],m=t[a>>2],t[e>>2]=m,t[e+4>>2]=k,C=i+24|0,c=C,l=t[c+4>>2],t[n>>2]=t[c>>2],t[n+4>>2]=l,n=i+16|0,l=t[n+4>>2],t[f>>2]=t[n>>2],t[f+4>>2]=l,f=i+8|0,l=t[f+4>>2],t[b>>2]=t[f>>2],t[b+4>>2]=l,b=t[i+4>>2],t[a>>2]=t[i>>2],t[a+4>>2]=b,t[C>>2]=g,t[C+4>>2]=o,t[n>>2]=_,t[n+4>>2]=u,t[f>>2]=B,t[f+4>>2]=s,t[i>>2]=m,t[i+4>>2]=k;}if(i=t[d>>2]>>>v,v=v+1&31,i=t[36+(((1&i)<<2)+a|0)>>2],o=i+40|0,!t[o>>2])break;}a=1;}}E=e+32|0;}function be(A,r){var e=0,i=0,a=B(0),f=B(0),n=B(0),b=0,o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0);A:{r:{e:{if((0|r)!=t[A>>2]){if(e=t[r+32>>2],i=t[36+(((t[e+40>>2]!=(0|r))<<2)+e|0)>>2],r=t[e+32>>2],!r)break e;for(t[36+((((0|e)==t[r+40>>2])<<2)+r|0)>>2]=i,t[i+32>>2]=r,gA(t[A+4>>2]),t[A+4>>2]=e;;){if(_=C[r>>2],e=t[r+36>>2],a=C[e>>2],i=t[r+40>>2],u=C[i>>2],a=a<u?a:u,C[r>>2]=a,u=C[r+16>>2],f=C[e+16>>2],l=C[i+16>>2],f=f>l?f:l,C[r+16>>2]=f,l=C[r+4>>2],n=C[e+4>>2],s=C[i+4>>2],n=n<s?n:s,C[r+4>>2]=n,b=r+20|0,s=C[b>>2],o=C[e+20>>2],d=C[i+20>>2],o=o>d?o:d,C[b>>2]=o,d=C[r+8>>2],k=C[e+8>>2],v=C[i+8>>2],k=k<v?k:v,C[r+8>>2]=k,b=r+24|0,v=C[b>>2],c=C[e+24>>2],g=C[i+24>>2],c=c>g?c:g,C[b>>2]=c,!(s!=o|u!=f|_!=a|l!=n)&&d==k&&v==c)break A;if(r=t[r+32>>2],!r)break;}break r;}return t[A>>2]=0,0;}t[i+32>>2]=0,t[A>>2]=i,gA(t[A+4>>2]),t[A+4>>2]=e;}r=t[A>>2];}return r;}function oe(A,r,e){var i=0,a=B(0),f=B(0),n=B(0),b=0,o=0;A:{r:{if(t[A>>2]){if(i=t[r+40>>2],i)for(f=B(C[e>>2]+C[e+16>>2]),a=B(C[e+8>>2]+C[e+24>>2]),n=B(C[e+4>>2]+C[e+20>>2]);o=r+36|0,r=t[r+36>>2],r=t[o+((B(B(B(m(B(f-B(C[r>>2]+C[r+16>>2]))))+B(m(B(n-B(C[r+4>>2]+C[r+20>>2])))))+B(m(B(a-B(C[r+8>>2]+C[r+24>>2])))))<B(B(B(m(B(f-B(C[i>>2]+C[i+16>>2]))))+B(m(B(n-B(C[i+4>>2]+C[i+20>>2])))))+B(m(B(a-B(C[i+8>>2]+C[i+24>>2])))))^1)<<2)>>2],i=t[r+40>>2],i;){}if(o=t[r+32>>2],i=t[A+4>>2],!i)break r;t[A+4>>2]=0;break A;}return t[e+32>>2]=0,void(t[A>>2]=e);}i=CA(44,16),t[i>>2]=0,t[i+4>>2]=0,t[i+40>>2]=0,b=i+32|0,t[b>>2]=0,t[b+4>>2]=0,b=i+24|0,t[b>>2]=0,t[b+4>>2]=0,b=i+16|0,t[b>>2]=0,t[b+4>>2]=0,b=i+8|0,t[b>>2]=0,t[b+4>>2]=0;}if(t[i+36>>2]=0,t[i+40>>2]=0,f=C[e>>2],a=C[r>>2],C[i>>2]=f<a?f:a,f=C[e+16>>2],a=C[r+16>>2],C[i+16>>2]=f>a?f:a,f=C[e+4>>2],a=C[r+4>>2],C[i+4>>2]=f<a?f:a,f=C[e+20>>2],a=C[r+20>>2],C[i+20>>2]=f>a?f:a,f=C[e+8>>2],a=C[r+8>>2],C[i+8>>2]=f<a?f:a,t[i+32>>2]=o,f=C[e+24>>2],a=C[r+24>>2],C[i+24>>2]=f>a?f:a,o)for(A=r+32|0,t[36+(((t[t[A>>2]+40>>2]==(0|r))<<2)+o|0)>>2]=i,t[i+36>>2]=r,t[A>>2]=i,t[i+40>>2]=e,t[e+32>>2]=i,f=C[i>>2];A=i,i=o,!(!(C[i>>2]<=f^1|C[i+4>>2]<=C[A+4>>2]^1|C[i+8>>2]<=C[A+8>>2]^1|C[i+16>>2]>=C[A+16>>2]^1)&&C[i+20>>2]>=C[A+20>>2]&&C[i+24>>2]>=C[A+24>>2])&&(A=t[i+36>>2],f=C[A>>2],r=t[i+40>>2],a=C[r>>2],f=f<a?f:a,C[i>>2]=f,a=C[A+16>>2],n=C[r+16>>2],C[i+16>>2]=a>n?a:n,a=C[A+4>>2],n=C[r+4>>2],C[i+4>>2]=a<n?a:n,a=C[A+20>>2],n=C[r+20>>2],C[i+20>>2]=a>n?a:n,a=C[A+8>>2],n=C[r+8>>2],C[i+8>>2]=a<n?a:n,a=C[A+24>>2],n=C[r+24>>2],C[i+24>>2]=a>n?a:n,o=t[i+32>>2],o);){}else t[i+36>>2]=r,t[r+32>>2]=i,t[i+40>>2]=e,t[A>>2]=i,t[e+32>>2]=i;}function ke(A,r,e){var i=0,a=0,f=0;return a=t[A+4>>2],a?t[A+4>>2]=0:(a=CA(44,16),i=a,t[i>>2]=0,t[i+4>>2]=0,t[i+40>>2]=0,i=i+32|0,t[i>>2]=0,t[i+4>>2]=0,i=a+24|0,t[i>>2]=0,t[i+4>>2]=0,i=a+16|0,t[i>>2]=0,t[i+4>>2]=0,i=a+8|0,t[i>>2]=0,t[i+4>>2]=0),t[a+36>>2]=e,t[a+32>>2]=0,t[a+40>>2]=0,i=r+24|0,f=t[i+4>>2],e=a+24|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,i=r+16|0,f=t[i+4>>2],e=a+16|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,i=r+8|0,f=t[i+4>>2],e=a+8|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,e=t[r+4>>2],t[a>>2]=t[r>>2],t[a+4>>2]=e,oe(A,t[A>>2],a),t[A+12>>2]=t[A+12>>2]+1,a;}function ce(A,r,e){var i=0,a=0,f=0,n=0;A:{r:{if(n=be(A,r),n){if(f=t[A+8>>2],(0|f)<0)break r;if(!f)break A;for(;;){if(i=t[n+32>>2],!i)break A;if(n=i,a=a+1|0,!((0|a)<(0|f)))break;}break A;}n=0;break A;}n=t[A>>2];}i=t[e+4>>2],t[r>>2]=t[e>>2],t[r+4>>2]=i,a=e+24|0,i=t[a+4>>2],f=r+24|0,t[f>>2]=t[a>>2],t[f+4>>2]=i,a=e+16|0,i=t[a+4>>2],f=r+16|0,t[f>>2]=t[a>>2],t[f+4>>2]=i,i=e+8|0,e=t[i+4>>2],a=r+8|0,t[a>>2]=t[i>>2],t[a+4>>2]=e,oe(A,n,r);}function ue(A,r){be(A,r),gA(t[A+4>>2]),t[A+4>>2]=r,t[A+12>>2]=t[A+12>>2]+-1;}function le(A,r){return 1;}function se(A){var r,e;return r=A*A,e=r*A,B(e*(r*r)*(2718311493989822e-21*r-.00019839334836096632)+(e*(.008333329385889463*r-.16666666641626524)+A));}function de(A){var r;return A*=A,r=A*A,B(-.499999997251031*A+1+.04166662332373906*r+A*r*(2439044879627741e-20*A-.001388676377460993));}function ve(A,r){var e=0;A:{r:{e:{if((0|r)>=1024){if(A*=8.98846567431158e307,e=r+-1023|0,(0|e)<1024)break e;r=r+-2046|0,r=(0|r)<1023?r:1023,A*=8.98846567431158e307;break A;}if((0|r)>-1023)break A;if(A*=2.004168360008973e-292,e=r+969|0,(0|e)>-1023)break r;r=r+1938|0,r=(0|r)>-1022?r:-1022,A*=2.004168360008973e-292;break A;}r=e;break A;}r=e;}return k(0,0),k(1,r+1023<<20),A*+c();}function Ce(A,r){var e,i=0,a=0,f=0,n=0,b=0;e=E-16|0,E=e;A:{r:{e:{if(l(A),f=o(0),i=2147483647&f,i>>>0<=1305022426){if(n=+A,a=.6366197723675814*n+6755399441055744-6755399441055744,g[r>>3]=n+-1.5707963109016418*a+-1.5893254773528196e-8*a,m(a)<2147483648)break e;i=-2147483648;break A;}if(i>>>0<2139095040)break r;g[r>>3]=B(A-A),i=0;break A;}i=~~a;break A;}b=i,i=(i>>>23)-150|0,g[e+8>>3]=(k(0,b-(i<<23)|0),s()),i=function(A,r,e){var i,a,f,n,b=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0,B=0,R=0,G=0,h=0,Q=0,p=0,D=0,w=0,W=0,F=0,Z=0,Y=0,N=0,V=0,I=0,J=0,X=0,M=0,x=0,S=0,T=0,U=0,j=0,O=0,H=0,z=0,P=0,L=0,K=0,q=0,$=0,AA=0,rA=0,eA=0,iA=0;if(i=E-560|0,E=i,c=(e+-3|0)/24|0,n=(0|c)>0?c:0,R=e+_(n,-24)|0,f=t[2856],(0|f)>=0)for(c=f+1|0,e=n,u=11440+(e<<2)|0,o=i+320|0;g[o>>3]=(0|e)>=0?+t[u>>2]:0,o=o+8|0,u=u+4|0,e=e+1|0,c=c+-1|0,c;){}for(a=R+-24|0,D=i+320|0,e=0;;){r:{e:{i:{a:{f:{switch(0|e){case 0:for(b=0,e=A,u=1,o=D;b+=g[e>>3]*g[o>>3],e=e+8|0,o=o+-8|0,u=u+-1|0,u;){}if(g[(w<<3)+i>>3]=b,D=D+8|0,e=(0|w)<(0|f),w=w+1|0,e)break a;X=23,M=23-a|0,Z=24-a|0,v=2,G=-4,x=476+(i+(f<<2)|0)|0,S=i+476|0,Y=-8,T=i+-8|0,d=1,Q=3,U=5.960464477539063e-8,j=-16777216,N=4,p=-1,O=.125,H=-8,z=4194303,P=8388607,V=1,L=11440,I=8,K=.5,k=f;break i;case 1:if(e=k<<Q,b=g[e+i>>3],c=(0|k)<(0|d),!c)for(e=e+T|0,o=i+480|0,u=k;s=o,B=b,b*=U,l=-2147483648,m(b)<2147483648&&(l=~~b),b=+(0|l),B+=b*j,l=-2147483648,m(B)<2147483648&&(l=~~B),t[s>>2]=l,o=o+N|0,b=g[e>>3]+b,e=e+Y|0,u=u+p|0,u;){}b=ve(b,a),b+=y(b*O)*H,l=-2147483648,m(b)<2147483648&&(l=~~b),b-=+(0|l);n:{t:{b:{o:{k:{c:{u:{l:{u=(0|a)<(0|d);s:{d:{v:{if(!u){if(o=((i+480|0)+(k<<v)|0)+G|0,s=t[o>>2],e=s>>Z,W=o,o=s-(e<<Z)|0,t[W>>2]=o,l=e+l|0,C=o>>M,(0|C)>=(0|d))break v;break d;}if(a){if(C=2,!(b>=K^d))break v;if(C=0,0==b)break s;break l;}if(C=t[((i+480|0)+(k<<v)|0)+G>>2]>>X,(0|C)<(0|d))break d;}if(c)s=0;else for(s=0,e=i+480|0,c=k;;){o=t[e>>2],W=e;v:{if(s)J=16777215;else {if(!o){s=0;break v;}s=1,J=16777216;}t[W>>2]=J-o;}if(e=e+N|0,c=c+p|0,!c)break;}v:if(!u)if((0|a)==(0|v))e=((i+480|0)+(k<<v)|0)+G|0,t[e>>2]=t[e>>2]&z;else {if((0|a)!=(0|d))break v;e=((i+480|0)+(k<<v)|0)+G|0,t[e>>2]=t[e>>2]&P;}l=d+l|0,(0|v)==(0|C)&&(b=V-b,C=2,s&&(b-=ve(V,a)));}if(0!=b)break l;}if((0|k)>(0|f)){for(e=(k<<v)+S|0,o=0,u=k;o=t[e>>2]|o,e=e+G|0,u=u+p|0,(0|u)>(0|f);){}if(o)break u;}for(e=x,c=k;c=c+d|0,o=t[e>>2],e=e+G|0,!o;){}for(s=(i+320|0)+(k+1<<Q)|0;;){if(e=(i+320|0)+(k+1<<Q)|0,k=k+d|0,g[e>>3]=t[(k+n<<v)+L>>2],b=0,1>=(0|d))for(e=A,o=s,u=1;b+=g[e>>3]*g[o>>3],e=e+I|0,o=o+Y|0,u=u+p|0,u;){}if(g[(k<<Q)+i>>3]=b,s=s+I|0,!((0|k)<(0|c)))break;}break r;}if(b=ve(b,0-a|0),!(b>=16777216)){if(m(b)<2147483648)break c;e=-2147483648;break k;}if(c=k<<2,B=5.960464477539063e-8*b,m(B)<2147483648)break o;e=-2147483648;break b;}for(e=476+(i+(k<<2)|0)|0,R=a;k=k+-1|0,R=R+-24|0,c=t[e>>2],e=e+-4|0,!c;){}break n;}e=~~b;}R=a;break t;}e=~~B;}c=c+(i+480|0)|0,b+=-16777216*+(0|e),o=-2147483648,m(b)<2147483648&&(o=~~b),t[c>>2]=o,k=k+1|0;}t[(i+480|0)+(k<<2)>>2]=e;}if(b=ve(1,R),(0|k)<0)break f;for(u=k+1|0,e=(i+480|0)+(k<<2)|0,o=(k<<3)+i|0;g[o>>3]=b*+t[e>>2],e=e+-4|0,o=o+-8|0,b*=5.960464477539063e-8,u=u+-1|0,(0|u)>0;){}if((0|k)<0)break f;q=3,F=(k<<3)+i|0,$=14208,AA=8,rA=1,eA=-8,iA=-1,h=k,e=2;continue;}for(c=h,h=k-c|0,b=0,e=0,o=0;b+=g[e+$>>3]*g[e+F>>3],!((0|o)>=(0|f))&&(e=e+AA|0,u=o>>>0<h>>>0,o=o+rA|0,u);){}if(g[(i+160|0)+(h<<q)>>3]=b,F=F+eA|0,h=c+iA|0,(0|c)>0)break e;}if((0|k)>=0)for(o=k+1|0,e=(i+160|0)+(k<<3)|0,b=0;b+=g[e>>3],e=e+-8|0,o=o+-1|0,(0|o)>0;){}else b=0;return g[r>>3]=C?-b:b,E=i+560|0,7&l;}e=0;continue;}e=1;continue;}e=2;continue;}k=c,e=1;}}(e+8|0,e,i),a=g[e>>3],(0|f)>-1?g[r>>3]=a:(g[r>>3]=-a,i=0-i|0);}return E=e+16|0,i;}function ge(A){var r,e=0,i=0,a=0;r=E-16|0,E=r,l(A),i=o(0),e=2147483647&i;A:if(e>>>0<=1061752794){if(e>>>0<964689920)break A;A=se(+A);}else {i>>>=31;r:{e:{i:{a:{f:{n:{t:{b:{o:{if(e>>>0<=1081824209){if(a=+A,e>>>0>1075235811)break o;if(!i)break f;A=B(-de(a+1.5707963267948966));break A;}if(e>>>0>1088565717)break b;if(a=+A,e>>>0>1085271519)break t;if(!i)break a;A=de(a+4.71238898038469);break A;}A=se(-((i?3.141592653589793:-3.141592653589793)+a));break A;}if(e>>>0<2139095040)break n;A=B(A-A);break A;}A=se((i?6.283185307179586:-6.283185307179586)+a);break A;}if(e=3&Ce(A,r+8|0),2==(0|e))break i;if(1==(0|e))break e;if(e)break r;A=se(g[r+8>>3]);break A;}A=de(a+-1.5707963267948966);break A;}A=B(-de(a+-4.71238898038469));break A;}A=se(-g[r+8>>3]);break A;}A=de(g[r+8>>3]);break A;}A=B(-de(g[r+8>>3]));}return E=r+16|0,A;}function _e(A){var r,e=B(0),i=0,a=0,f=0;r=E-16|0,E=r,l(A),a=o(0),i=2147483647&a;A:if(i>>>0<=1061752794){if(e=B(1),i>>>0<964689920)break A;e=de(+A);}else {a>>>=31;r:{e:{i:{a:{f:{n:{t:{b:{o:{if(i>>>0<=1081824209){if(f=+A,i>>>0<1075235812)break o;e=B(-de((a?3.141592653589793:-3.141592653589793)+f));break A;}if(i>>>0>1088565717)break b;if(i>>>0<1085271520)break t;e=de(+A+(a?6.283185307179586:-6.283185307179586));break A;}if(!a)break f;e=se(f+1.5707963267948966);break A;}if(i>>>0<2139095040)break n;e=B(A-A);break A;}if(!a)break a;e=se(-4.71238898038469-+A);break A;}if(i=3&Ce(A,r+8|0),2==(0|i))break i;if(1==(0|i))break e;if(i)break r;e=de(g[r+8>>3]);break A;}e=se(1.5707963267948966-f);break A;}e=se(+A-4.71238898038469);break A;}e=B(-de(g[r+8>>3]));break A;}e=se(-g[r+8>>3]);break A;}e=se(g[r+8>>3]);}return A=e,E=r+16|0,A;}function Be(A,r,e){var i,f=0,n=B(0),o=0,k=0,c=0,u=B(0),l=0;i=E-144|0,E=i,t[A+72>>2]=t[A+72>>2]+1,o=r+8|0,k=t[o+4>>2],f=i+72|0,t[f>>2]=t[o>>2],t[f+4>>2]=k,o=r+24|0,k=t[o+4>>2],f=i+88|0,t[f>>2]=t[o>>2],t[f+4>>2]=k,o=r+40|0,k=t[o+4>>2],f=i+104|0,t[f>>2]=t[o>>2],t[f+4>>2]=k,o=r+56|0,k=t[o+4>>2],f=i+120|0,t[f>>2]=t[o>>2],t[f+4>>2]=k,t[i+140>>2]=0,t[i+128>>2]=e,f=t[r+4>>2],t[i+64>>2]=t[r>>2],t[i+68>>2]=f,f=t[r+20>>2],t[i+80>>2]=t[r+16>>2],t[i+84>>2]=f,f=t[r+36>>2],t[i+96>>2]=t[r+32>>2],t[i+100>>2]=f,f=t[r+52>>2],t[i+112>>2]=t[r+48>>2],t[i+116>>2]=f,t[i+132>>2]=t[e+4>>2],c=i,u=B(yf[t[t[e>>2]+48>>2]](e)),C[c+136>>2]=u,yf[t[t[e>>2]+8>>2]](e,r,i+48|0,i+32|0),n=C[i+48>>2],C[A+36>>2]>n&&(C[A+36>>2]=n),n=C[i+32>>2],C[A+52>>2]<n&&(C[A+52>>2]=n),r=A+40|0,n=C[i+52>>2],C[r>>2]>n&&(C[r>>2]=n),r=A+56|0,n=C[i+36>>2],C[r>>2]<n&&(C[r>>2]=n),r=A+44|0,n=C[i+56>>2],C[r>>2]>n&&(C[r>>2]=n),r=A+60|0,n=C[i+40>>2],C[r>>2]<n&&(C[r>>2]=n),r=t[A+68>>2],r&&(f=i+56|0,o=t[f+4>>2],e=i+8|0,t[e>>2]=t[f>>2],t[e+4>>2]=o,f=i+40|0,o=t[f+4>>2],e=i+24|0,t[e>>2]=t[f>>2],t[e+4>>2]=o,e=t[i+52>>2],t[i>>2]=t[i+48>>2],t[i+4>>2]=e,e=t[i+36>>2],t[i+16>>2]=t[i+32>>2],t[i+20>>2]=e,c=i+140|0,l=ke(r,i,t[A+20>>2]),t[c>>2]=l),function(A,r){var e=0,i=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0;if(f=t[A+4>>2],(0|f)==t[A+8>>2]&&(u=f?f<<1:1,!((0|f)>=(0|u)))){A:{r:{if(u){if(l=CA(_(u,80),16),f=t[A+4>>2],(0|f)>=1)break r;break A;}if((0|f)<1)break A;}for(c=64,s=A+12|0;e=t[s>>2]+c|0,o=e+-56|0,k=t[o+4>>2],i=c+l|0,n=i+-56|0,t[n>>2]=t[o>>2],t[n+4>>2]=k,o=e+-64|0,k=t[o+4>>2],n=i+-64|0,t[n>>2]=t[o>>2],t[n+4>>2]=k,o=e+-40|0,k=t[o+4>>2],n=i+-40|0,t[n>>2]=t[o>>2],t[n+4>>2]=k,o=e+-48|0,k=t[o+4>>2],n=i+-48|0,t[n>>2]=t[o>>2],t[n+4>>2]=k,o=e+-24|0,k=t[o+4>>2],n=i+-24|0,t[n>>2]=t[o>>2],t[n+4>>2]=k,o=e+-32|0,k=t[o+4>>2],n=i+-32|0,t[n>>2]=t[o>>2],t[n+4>>2]=k,o=e+-8|0,k=t[o+4>>2],n=i+-8|0,t[n>>2]=t[o>>2],t[n+4>>2]=k,o=e+-16|0,k=t[o+4>>2],n=i+-16|0,t[n>>2]=t[o>>2],t[n+4>>2]=k,n=t[e+4>>2],t[i>>2]=t[e>>2],t[i+4>>2]=n,e=e+8|0,n=t[e+4>>2],i=i+8|0,t[i>>2]=t[e>>2],t[i+4>>2]=n,c=c+80|0,f=f+-1|0,f;){}}i=t[A+12>>2],i&&(b[A+16|0]&&gA(i),t[A+12>>2]=0),a[A+16|0]=1,t[A+12>>2]=l,t[A+8>>2]=u,f=t[A+4>>2];}i=t[A+12>>2]+_(f,80)|0,f=t[r+4>>2],t[i>>2]=t[r>>2],t[i+4>>2]=f,f=r+8|0,c=t[f+4>>2],e=i+8|0,t[e>>2]=t[f>>2],t[e+4>>2]=c,f=r+24|0,c=t[f+4>>2],e=i+24|0,t[e>>2]=t[f>>2],t[e+4>>2]=c,e=t[r+20>>2],t[i+16>>2]=t[r+16>>2],t[i+20>>2]=e,f=r+40|0,c=t[f+4>>2],e=i+40|0,t[e>>2]=t[f>>2],t[e+4>>2]=c,e=t[r+36>>2],t[i+32>>2]=t[r+32>>2],t[i+36>>2]=e,f=r+56|0,c=t[f+4>>2],e=i+56|0,t[e>>2]=t[f>>2],t[e+4>>2]=c,e=t[r+52>>2],t[i+48>>2]=t[r+48>>2],t[i+52>>2]=e,f=r+72|0,c=t[f+4>>2],e=i+72|0,t[e>>2]=t[f>>2],t[e+4>>2]=c,e=t[r+68>>2],t[i+64>>2]=t[r+64>>2],t[i+68>>2]=e,A=A+4|0,t[A>>2]=t[A>>2]+1;}(A+16|0,i- -64|0),E=i+144|0;}function me(A,r){var e,i,a,f,n,b,o,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0,g=0,B=0,m=0,R=0;e=E-80|0,E=e,t[A+72>>2]=t[A+72>>2]+1,k=t[A+68>>2],k&&ue(k,t[76+(t[A+28>>2]+_(r,80)|0)>>2]),a=A+20|0,c=t[a>>2],f=A+28|0,B=t[f>>2],o=_(r,80),k=B+o|0,u=k+8|0,v=t[u+4>>2],s=e+8|0,t[s>>2]=t[u>>2],t[s+4>>2]=v,d=k+24|0,m=t[d+4>>2],n=e+24|0,v=n,t[v>>2]=t[d>>2],t[v+4>>2]=m,b=k+40|0,C=b,g=t[C+4>>2],v=e+40|0,t[v>>2]=t[C>>2],t[v+4>>2]=g,C=k+56|0,l=t[C+4>>2],m=e+56|0,g=m,t[g>>2]=t[C>>2],t[g+4>>2]=l,i=k+72|0,R=t[i+4>>2],g=e+72|0,l=g,t[l>>2]=t[i>>2],t[l+4>>2]=R,l=t[k+4>>2],t[e>>2]=t[k>>2],t[e+4>>2]=l,l=t[k+20>>2],t[e+16>>2]=t[k+16>>2],t[e+20>>2]=l,l=t[k+36>>2],t[e+32>>2]=t[k+32>>2],t[e+36>>2]=l,l=t[k+52>>2],t[e+48>>2]=t[k+48>>2],t[e+52>>2]=l,l=t[k+68>>2],t[e+64>>2]=t[k+64>>2],t[e+68>>2]=l,l=B,B=_(c,80)+-80|0,c=l+B|0,l=c+8|0,R=t[l+4>>2],t[u>>2]=t[l>>2],t[u+4>>2]=R,u=t[c+4>>2],t[k>>2]=t[c>>2],t[k+4>>2]=u,u=c+24|0,l=t[u+4>>2],t[d>>2]=t[u>>2],t[d+4>>2]=l,u=t[c+20>>2],t[k+16>>2]=t[c+16>>2],t[k+20>>2]=u,u=c+40|0,d=t[u+4>>2],t[b>>2]=t[u>>2],t[b+4>>2]=d,u=t[c+36>>2],t[k+32>>2]=t[c+32>>2],t[k+36>>2]=u,u=c+56|0,d=t[u+4>>2],t[C>>2]=t[u>>2],t[C+4>>2]=d,u=t[c+52>>2],t[k+48>>2]=t[c+48>>2],t[k+52>>2]=u,u=c+72|0,d=t[u+4>>2],t[i>>2]=t[u>>2],t[i+4>>2]=d,u=t[c+68>>2],t[k+64>>2]=t[c+64>>2],t[k+68>>2]=u,u=t[e+4>>2],k=t[f>>2]+B|0,t[k>>2]=t[e>>2],t[k+4>>2]=u,u=t[s+4>>2],c=k+8|0,t[c>>2]=t[s>>2],t[c+4>>2]=u,s=t[n+4>>2],c=k+24|0,t[c>>2]=t[n>>2],t[c+4>>2]=s,c=t[e+20>>2],t[k+16>>2]=t[e+16>>2],t[k+20>>2]=c,s=t[v+4>>2],c=k+40|0,t[c>>2]=t[v>>2],t[c+4>>2]=s,c=t[e+36>>2],t[k+32>>2]=t[e+32>>2],t[k+36>>2]=c,s=t[m+4>>2],c=k+56|0,t[c>>2]=t[m>>2],t[c+4>>2]=s,c=t[e+52>>2],t[k+48>>2]=t[e+48>>2],t[k+52>>2]=c,s=t[g+4>>2],c=k+72|0,t[c>>2]=t[g>>2],t[c+4>>2]=s,c=t[e+68>>2],t[k+64>>2]=t[e+64>>2],t[k+68>>2]=c,t[A+68>>2]&&(t[t[76+(t[f>>2]+o|0)>>2]+36>>2]=r),t[a>>2]=t[a>>2]+-1,E=e+80|0;}function Re(A){A|=0;var r,e=0;return t[A>>2]=14628,e=A+32|0,r=t[e>>2],r&&(b[A+36|0]&&gA(r),t[A+32>>2]=0),t[e>>2]=0,a[A+36|0]=1,e=A+24|0,t[e>>2]=0,t[e+4>>2]=0,0|A;}function Ge(A,r,e,i,a,f,n,b,o,k){A|=0,r|=0,e|=0,i|=0,a|=0,f|=0,n|=0,b|=0,o|=0,k|=0,A=t[A+32>>2]+(k<<5)|0,t[e>>2]=t[A+12>>2],t[a>>2]=t[A+20>>2],t[r>>2]=t[A+16>>2],t[i>>2]=t[A+28>>2],t[b>>2]=t[A>>2],t[f>>2]=t[A+4>>2],t[o>>2]=t[A+24>>2],t[n>>2]=t[A+8>>2];}function he(A,r){}function ye(A,r){var e=0,i=0,n=0,o=0,k=0,c=0,u=0,l=0;A:{r:e:{i:{a:f:{if(b[A+164|0]){if(o=A+128|0,e=t[o>>2],(0|e)!=t[A+132>>2])break i;if(k=e?e<<1:1,(0|e)>=(0|k))break i;if(!k)break f;i=CA(k<<2,16),e=t[A+128>>2];break a;}if(l=A+148|0,i=t[l>>2],(0|i)!=t[A+152>>2])break A;if(o=i?i<<1:1,(0|i)>=(0|o))break A;if(!o)break e;u=CA(o<<1,16),i=t[A+148>>2];break r;}u=t[A+136>>2];a:{if((0|e)>=1)for(n=i,c=u;t[n>>2]=t[c>>2],n=n+4|0,c=c+4|0,e=e+-1|0,e;){}else if(!u)break a;b[A+140|0]&&gA(u),t[A+136>>2]=0,e=t[A+128>>2];}t[A+136>>2]=i,a[A+140|0]=1,t[A+132>>2]=k;}return n=t[A+136>>2],t[n+(e<<2)>>2]=r,t[t[A+32>>2]+4>>2]=n,void(t[o>>2]=t[o>>2]+1);}k=t[A+156>>2];r:{if((0|i)>=1)for(n=u,c=k,e=i;f[n>>1]=d[c>>1],n=n+2|0,c=c+2|0,e=e+-1|0,e;){}else if(!k)break r;b[A+160|0]&&(gA(k),i=t[A+148>>2]),t[A+156>>2]=0;}t[A+156>>2]=u,a[A+160|0]=1,t[A+152>>2]=o;}t[l>>2]=i+1,n=t[A+32>>2],A=t[A+156>>2],t[n+4>>2]=A,f[A+(i<<1)>>1]=r;}function Qe(A,r,e){var i=0,f=0,n=0,o=0,k=0,c=0,u=B(0),l=B(0),s=0,d=0,v=B(0),g=B(0),_=B(0),m=B(0);A:{r:{e:i:{a:{f:{n:{t:{if(b[A+165|0]){if(n=t[A+88>>2],!(!e|(0|n)<1))for(e=t[A+96>>2],v=C[A+168>>2],g=C[r+8>>2],_=C[r+4>>2],m=C[r>>2];;){if(u=B(C[e>>2]-m),l=B(u*u),u=B(C[e+4>>2]-_),l=B(l+B(u*u)),u=B(C[e+8>>2]-g),B(l+B(u*u))<=v)break A;if(e=e+16|0,c=c+1|0,!((0|c)<(0|n)))break;}if(s=A+32|0,e=t[s>>2],t[e+12>>2]=t[e+12>>2]+1,t[A+92>>2]!=(0|n))break a;if(d=n?n<<1:1,(0|n)>=(0|d))break a;if(!d)break t;if(i=CA(d<<4,16),n=t[A+88>>2],(0|n)>=1)break n;break f;}if(f=t[A+108>>2],!(!e|(0|f)<1))for(e=t[A+116>>2],v=C[A+168>>2],g=C[r+8>>2],_=C[r+4>>2],m=C[r>>2];;){if(u=B(C[e>>2]-m),l=B(u*u),u=B(C[e+4>>2]-_),l=B(l+B(u*u)),u=B(C[e+8>>2]-g),B(l+B(u*u))<=v)break A;if(e=e+12|0,c=c+1|0,n=n+3|0,!((0|n)<(0|f)))break;}if(i=t[A+112>>2],(0|f)!=(0|i))break r;if(i=f?f<<1:1,(0|f)<(0|i)){if(!i)break i;o=CA(i<<2,16),f=t[A+108>>2];break e;}i=f;break r;}if((0|n)<1)break f;}for(e=0,c=A+96|0;f=t[c>>2]+e|0,o=t[f+4>>2],k=e+i|0,t[k>>2]=t[f>>2],t[k+4>>2]=o,f=f+8|0,o=t[f+4>>2],k=k+8|0,t[k>>2]=t[f>>2],t[k+4>>2]=o,e=e+16|0,n=n+-1|0,n;){}}o=A+96|0,e=t[o>>2],e&&(b[A+100|0]&&gA(e),t[A+96>>2]=0),t[o>>2]=i,a[A+100|0]=1,t[A+92>>2]=d,n=t[A+88>>2];}return e=t[r+4>>2],o=A+96|0,i=t[o>>2]+(n<<4)|0,t[i>>2]=t[r>>2],t[i+4>>2]=e,e=r+8|0,r=t[e+4>>2],i=i+8|0,t[i>>2]=t[e>>2],t[i+4>>2]=r,t[t[s>>2]+16>>2]=t[o>>2],A=A+88|0,r=t[A>>2],t[A>>2]=r+1,r;}k=t[A+116>>2];e:{if((0|f)>=1)for(e=o,c=k,n=f;t[e>>2]=t[c>>2],e=e+4|0,c=c+4|0,n=n+-1|0,n;){}else if(!k)break e;b[A+120|0]&&(gA(k),f=t[A+108>>2]),t[A+116>>2]=0;}t[A+116>>2]=o,a[A+120|0]=1,t[A+112>>2]=i;}s=A+108|0,e=f+1|0,t[s>>2]=e,k=t[A+116>>2],t[k+(f<<2)>>2]=t[r>>2];r:{e:{i:{a:{f:{n:{t:{if((0|e)==(0|i)){if(f=i?i<<1:1,(0|i)>=(0|f))break t;if(!f)break n;if(o=CA(f<<2,16),k=t[A+116>>2],i=t[A+108>>2],(0|i)<1)break f;break a;}o=k,f=i,i=e;break r;}o=k,f=i;break r;}if(o=0,(0|i)>=1)break a;}if(!k)break e;break i;}for(e=o,c=k,n=i;t[e>>2]=t[c>>2],e=e+4|0,c=c+4|0,n=n+-1|0,n;){}}b[A+120|0]&&(gA(k),i=t[A+108>>2]),t[A+116>>2]=0;}t[A+116>>2]=o,a[A+120|0]=1,t[A+112>>2]=f;}e=i+1|0,t[s>>2]=e,t[(i<<2)+o>>2]=t[r+4>>2];r:{e:{i:{a:{f:{n:{t:{if((0|e)==(0|f)){if(k=f?f<<1:1,(0|f)>=(0|k))break t;if(!k)break n;if(i=CA(k<<2,16),o=t[A+116>>2],f=t[A+108>>2],(0|f)<1)break f;break a;}i=o,f=e;break r;}i=o;break r;}if(i=0,(0|f)>=1)break a;}if(!o)break e;break i;}for(e=i,c=o,n=f;t[e>>2]=t[c>>2],e=e+4|0,c=c+4|0,n=n+-1|0,n;){}}b[A+120|0]&&(gA(o),f=t[A+108>>2]),t[A+116>>2]=0;}t[A+116>>2]=i,a[A+120|0]=1,t[A+112>>2]=k;}e=f+1|0,t[A+108>>2]=e,t[(f<<2)+i>>2]=t[r+8>>2],A=t[A+32>>2],t[A+16>>2]=i,t[A+12>>2]=t[A+12>>2]+1,c=((0|e)/3|0)-1|0;}return c;}function pe(A){A|=0;var r=0,e=0;return t[A>>2]=14740,r=A+156|0,e=t[r>>2],e&&(b[A+160|0]&&gA(e),t[A+156>>2]=0),t[r>>2]=0,a[A+160|0]=1,r=A+148|0,t[r>>2]=0,t[r+4>>2]=0,r=A+136|0,e=t[r>>2],e&&(b[A+140|0]&&gA(e),t[A+136>>2]=0),t[r>>2]=0,a[A+140|0]=1,r=A+128|0,t[r>>2]=0,t[r+4>>2]=0,r=A+116|0,e=t[r>>2],e&&(b[A+120|0]&&gA(e),t[A+116>>2]=0),t[r>>2]=0,a[A+120|0]=1,r=A+108|0,t[r>>2]=0,t[r+4>>2]=0,r=A+96|0,e=t[r>>2],e&&(b[A+100|0]&&gA(e),t[A+96>>2]=0),t[r>>2]=0,a[A+100|0]=1,r=A+88|0,t[r>>2]=0,t[r+4>>2]=0,Re(A),0|A;}function De(A,r,e){var i,a,f,n,b,o,k,c,u,l,s,d,v,g,m=0,R=0,G=B(0),h=0,y=B(0),p=0,D=B(0),w=B(0),W=B(0),F=B(0),Z=0,Y=0,N=0,V=B(0),I=0,J=0,X=0,M=0,x=0,S=B(0),T=B(0),U=B(0),j=B(0),O=0,H=0;i=E-96|0,E=i,t[A+376>>2]=0,t[A+364>>2]=4,t[A+368>>2]=0,p=A+316|0,t[A+360>>2]=p,t[A+356>>2]=A+284,t[A+352>>2]=A+252,t[A+348>>2]=A+220,m=t[r+4>>2],t[A>>2]=t[r>>2],t[A+4>>2]=m,R=r+16|0,h=t[R+4>>2],m=A+16|0,t[m>>2]=t[R>>2],t[m+4>>2]=h,m=t[r+12>>2],t[A+8>>2]=t[r+8>>2],t[A+12>>2]=m,R=r+32|0,h=t[R+4>>2],m=A+32|0,t[m>>2]=t[R>>2],t[m+4>>2]=h,R=r+24|0,h=t[R+4>>2],m=A+24|0,t[m>>2]=t[R>>2],t[m+4>>2]=h,R=r+48|0,h=t[R+4>>2],m=A+48|0,t[m>>2]=t[R>>2],t[m+4>>2]=h,R=r+40|0,h=t[R+4>>2],m=A+40|0,t[m>>2]=t[R>>2],t[m+4>>2]=h,R=r- -64|0,h=t[R+4>>2],m=A- -64|0,t[m>>2]=t[R>>2],t[m+4>>2]=h,m=t[r+60>>2],t[A+56>>2]=t[r+56>>2],t[A+60>>2]=m,R=r+80|0,h=t[R+4>>2],m=A+80|0,t[m>>2]=t[R>>2],t[m+4>>2]=h,R=r+72|0,h=t[R+4>>2],m=A+72|0,t[m>>2]=t[R>>2],t[m+4>>2]=h,R=r+96|0,h=t[R+4>>2],m=A+96|0,t[m>>2]=t[R>>2],t[m+4>>2]=h,R=r+88|0,h=t[R+4>>2],m=A+88|0,t[m>>2]=t[R>>2],t[m+4>>2]=h,R=r+112|0,h=t[R+4>>2],m=A+112|0,t[m>>2]=t[R>>2],t[m+4>>2]=h,R=r+104|0,h=t[R+4>>2],m=A+104|0,t[m>>2]=t[R>>2],t[m+4>>2]=h,m=t[r+120>>2],r=t[r+124>>2],t[A+180>>2]=0,t[A+144>>2]=0,t[A+120>>2]=m,t[A+124>>2]=r,R=e+8|0,h=t[R+4>>2],r=A+136|0,t[r>>2]=t[R>>2],t[r+4>>2]=h,m=t[e+4>>2],t[A+128>>2]=t[e>>2],t[A+132>>2]=m,m=A+128|0,G=C[A+128>>2],D=C[A+132>>2],w=C[r>>2],W=B(B(B(G*G)+B(D*D))+B(w*w)),W>B(0)?(C[i+40>>2]=-w,C[i+36>>2]=-D,C[i+32>>2]=-G):(t[i+40>>2]=0,t[i+32>>2]=1065353216,t[i+36>>2]=0),t[A+148>>2]=p,R=A+364|0,t[R>>2]=3,r=A+164|0,t[r>>2]=0,t[A+180>>2]=1,t[i+44>>2]=0,we(A,i+32|0,p),t[r>>2]=1065353216,r=t[A+148>>2],e=t[r+20>>2],t[m>>2]=t[r+16>>2],t[m+4>>2]=e,p=r+24|0,h=t[p+4>>2],n=m+8|0,e=n,t[e>>2]=t[p>>2],t[e+4>>2]=h,e=t[p+4>>2],b=i+88|0,J=b,h=t[p>>2],t[J>>2]=h,t[J+4>>2]=e,o=i+72|0,p=o,t[p>>2]=h,t[p+4>>2]=e,k=i+56|0,p=k,t[p>>2]=h,t[p+4>>2]=e,p=t[r+20>>2],r=t[r+16>>2],t[i+80>>2]=r,t[i+84>>2]=p,t[i+64>>2]=r,t[i+68>>2]=p,t[i+48>>2]=r,t[i+52>>2]=p,t[i+40>>2]=h,t[i+44>>2]=e,t[i+32>>2]=r,t[i+36>>2]=p,l=A+148|0,c=A+368|0,p=t[c>>2],J=A+136|0,G=C[J>>2],a=A+132|0,D=C[a>>2],f=A+128|0,w=C[f>>2],s=i+28|0,d=i- -64|0,v=i+84|0,g=i+80|0,u=A+376|0;A:{for(;;){r:{e:{i:{a:{if(V=B(Q(B(B(B(w*w)+B(D*D))+B(G*G)))),!(V<B(9999999747378752e-20))){if(t[s>>2]=0,C[i+24>>2]=-G,N=t[R>>2]+-1|0,t[R>>2]=N,I=_(p,36),r=I+A|0,h=r+180|0,e=t[h>>2],t[h>>2]=e+1,Y=e<<2,e=r+148|0,Z=Y+e|0,t[Z+16>>2]=0,N=t[348+((N<<2)+A|0)>>2],t[Z>>2]=N,C[i+20>>2]=-D,C[i+16>>2]=-w,we(A,i+16|0,N),N=t[h>>2],Z=t[(e+(N<<2)|0)-4>>2],G=C[Z+16>>2],D=B(G-C[i+32>>2]),y=B(D*D),D=C[Z+20>>2],w=B(D-C[i+36>>2]),F=B(y+B(w*w)),w=C[Z+24>>2],y=B(w-C[i+40>>2]),!(B(F+B(y*y))<B(9999999747378752e-20)||(y=B(G-C[i+48>>2]),F=B(y*y),y=B(D-C[i+52>>2]),F=B(F+B(y*y)),y=B(w-C[k>>2]),B(F+B(y*y))<B(9999999747378752e-20)||(y=B(G-C[d>>2]),F=B(y*y),y=B(D-C[i+68>>2]),F=B(F+B(y*y)),y=B(w-C[o>>2]),B(F+B(y*y))<B(9999999747378752e-20)||(y=B(G-C[g>>2]),F=B(y*y),y=B(D-C[v>>2]),F=B(F+B(y*y)),y=B(w-C[b>>2]),B(F+B(y*y))<B(9999999747378752e-20)))))){if(Z=Z+16|0,X=Z+8|0,M=t[X+4>>2],O=O+1&3,Y=(i+32|0)+(O<<4)|0,t[Y+8>>2]=t[X>>2],t[Y+12>>2]=M,x=t[Z+4>>2],t[Y>>2]=t[Z>>2],t[Y+4>>2]=x,G=B(B(B(B(C[f>>2]*G)+B(C[a>>2]*D))+B(C[J>>2]*w))/V),S=G>S?G:S,B(B(V-S)+B(V*B(-9999999747378752e-20)))<=B(0))break a;t[i+12>>2]=0;f:{n:{t:{b:{o:{if(4!=(0|N)){if(3==(0|N))break b;if(2!=(0|N))break o;if(r=t[r+152>>2],T=C[r+16>>2],e=t[e>>2],W=C[e+16>>2],V=B(T-W),U=C[r+20>>2],D=C[e+20>>2],y=B(U-D),j=C[r+24>>2],w=C[e+24>>2],F=B(j-w),G=B(B(B(V*V)+B(y*y))+B(F*F)),!(G>B(0)))break f;if(G=B(B(-B(B(B(W*V)+B(D*y))+B(w*F)))/G),G>=B(1))break t;if(G<=B(0))break n;if(t[i+12>>2]=3,C[i+20>>2]=G,C[i+16>>2]=B(1)-G,w=B(w+B(F*G)),W=B(W+B(V*G)),G=B(D+B(y*G)),W=B(B(w*w)+B(B(W*W)+B(G*G))),W>=B(0))break e;break f;}W=We(t[e>>2]+16|0,t[r+152>>2]+16|0,t[r+156>>2]+16|0,t[r+160>>2]+16|0,i+16|0,i+12|0);}if(!(W>=B(0)))break f;break e;}if(W=Fe(t[e>>2]+16|0,t[r+152>>2]+16|0,t[r+156>>2]+16|0,i+16|0,i+12|0),W>=B(0))break e;break f;}if(t[i+16>>2]=0,t[i+20>>2]=1065353216,t[i+12>>2]=2,W=B(B(B(T*T)+B(U*U))+B(j*j)),W>=B(0))break e;break f;}if(t[i+16>>2]=1065353216,t[i+20>>2]=0,t[i+12>>2]=1,W=B(B(B(W*W)+B(D*D))+B(w*w)),W>=B(0))break e;}e=A+364|0,r=t[e>>2],t[e>>2]=r+1,p=t[A+368>>2],m=_(p,36)+A|0,R=m+180|0,e=t[R>>2]+-1|0,t[R>>2]=e,t[348+((r<<2)+A|0)>>2]=t[148+(m+(e<<2)|0)>>2];break i;}e=A+364|0,r=t[e>>2],t[e>>2]=r+1,p=t[A+368>>2],m=_(p,36)+A|0,R=m+180|0,e=t[R>>2]+-1|0,t[R>>2]=e,t[348+((r<<2)+A|0)>>2]=t[148+(m+(e<<2)|0)>>2];break i;}t[A+376>>2]=1;break i;}e=A+364|0,r=t[e>>2],t[e>>2]=r+1,p=t[A+368>>2],m=_(p,36)+A|0,R=m+180|0,e=t[R>>2]+-1|0,t[R>>2]=e,t[348+((r<<2)+A|0)>>2]=t[148+(m+(e<<2)|0)>>2];}r=t[A+376>>2];break r;}if(p=1-p|0,x=_(p,36)+A|0,Z=x+180|0,t[Z>>2]=0,t[n>>2]=0,t[n+4>>2]=0,t[m>>2]=0,t[m+4>>2]=0,t[c>>2]=p,N=t[i+12>>2],X=t[h>>2],X)for(r=I+l|0,e=0,G=B(0),h=i+16|0,D=B(0),w=B(0);Y=t[r>>2],1<<e&N?(I=t[Z>>2],M=(I<<2)+x|0,t[M+148>>2]=Y,G=C[h>>2],t[M+164>>2]=t[h>>2],t[Z>>2]=I+1,Y=t[r>>2],V=C[Y+24>>2],D=C[Y+20>>2],w=B(B(C[Y+16>>2]*G)+C[f>>2]),C[f>>2]=w,D=B(B(D*G)+C[a>>2]),C[a>>2]=D,G=B(B(V*G)+C[J>>2]),C[J>>2]=G):(I=t[R>>2],t[R>>2]=I+1,t[348+((I<<2)+A|0)>>2]=Y),r=r+4|0,h=h+4|0,e=e+1|0,(0|X)!=(0|e);){}else G=B(0),D=B(0),w=B(0);if(15==(0|N)&&(t[u>>2]=1),H=H+1|0,H>>>0>=128)break A;if(r=t[u>>2],!r)continue;}break;}return t[A+372>>2]=148+(_(p,36)+A|0),1!=(0|r)?(E=i+96|0,r||(G=C[A+128>>2],D=B(G*G),G=C[A+132>>2],D=B(D+B(G*G)),G=C[A+136>>2],C[A+144>>2]=Q(B(D+B(G*G))),r=0),r):(t[A+144>>2]=0,E=i+96|0,1);}return t[A+376>>2]=2,t[A+372>>2]=148+(_(p,36)+A|0),E=i+96|0,2;}function we(A,r,e){var i,a,f,n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0);i=E-48|0,E=i,n=C[r+8>>2],b=C[r>>2],o=C[r+4>>2],t[e+12>>2]=0,k=n,n=B(B(1)/B(Q(B(B(B(b*b)+B(o*o))+B(n*n))))),C[e+8>>2]=k*n,C[e+4>>2]=o*n,C[e>>2]=b*n,r=t[A+120>>2],a=t[A+124>>2],f=t[A>>2]+(a>>1)|0,yf[1&a?t[t[f>>2]+r>>2]:r](i+32|0,f,e),t[i+12>>2]=0,C[i+8>>2]=-C[e+8>>2],C[i+4>>2]=-C[e+4>>2],C[i>>2]=-C[e>>2],function(A,r,e){var i=0,a=B(0),f=B(0),n=B(0),b=0,o=0,k=0;i=E-32|0,E=i,o=t[r+124>>2],k=t[r+4>>2]+(o>>1)|0,b=t[r+120>>2],b=1&o?t[t[k>>2]+b>>2]:b,t[i+12>>2]=0,a=C[e>>2],f=C[e+4>>2],n=C[e+8>>2],C[i+8>>2]=B(B(a*C[r+40>>2])+B(f*C[r+44>>2]))+B(n*C[r+48>>2]),C[i+4>>2]=B(B(a*C[r+24>>2])+B(f*C[r+28>>2]))+B(n*C[r+32>>2]),C[i>>2]=B(B(a*C[r+8>>2])+B(f*C[r+12>>2]))+B(n*C[r+16>>2]),yf[b](i+16|0,k,i),t[A+12>>2]=0,a=C[i+16>>2],f=C[i+20>>2],n=C[i+24>>2],C[A+8>>2]=B(B(B(a*C[r+88>>2])+B(f*C[r+92>>2]))+B(n*C[r+96>>2]))+C[r+112>>2],C[A+4>>2]=B(B(B(a*C[r+72>>2])+B(f*C[r+76>>2]))+B(n*C[r+80>>2]))+C[r+108>>2],C[A>>2]=B(B(B(a*C[r+56>>2])+B(f*C[r+60>>2]))+B(n*C[r- -64>>2]))+C[r+104>>2],E=i+32|0;}(i+16|0,A,i),n=C[i+16>>2],b=C[i+32>>2],o=C[i+20>>2],k=C[i+36>>2],c=C[i+24>>2],u=C[i+40>>2],t[e+28>>2]=0,C[e+24>>2]=u-c,C[e+20>>2]=k-o,C[e+16>>2]=b-n,E=i+48|0;}function We(A,r,e,i,a,f){var n,b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=0,s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=0,Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=0,Y=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=B(0),M=B(0),x=B(0),S=0,T=0,U=0,j=0;return n=E-96|0,E=n,t[n+92>>2]=i,t[n+88>>2]=e,t[n+84>>2]=r,t[n+80>>2]=A,t[n+60>>2]=0,Q=C[r+8>>2],G=C[i+8>>2],u=B(Q-G),C[n+56>>2]=u,p=C[r+4>>2],h=C[i+4>>2],D=B(p-h),C[n+52>>2]=D,t[n+44>>2]=0,w=C[A+8>>2],v=B(w-G),C[n+40>>2]=v,N=C[A+4>>2],_=B(N-h),C[n+36>>2]=_,V=C[A>>2],Y=C[i>>2],m=B(V-Y),C[n+32>>2]=m,W=C[r>>2],b=B(W-Y),C[n+48>>2]=b,t[n+76>>2]=0,I=C[e+8>>2],o=B(I-G),C[n+72>>2]=o,s=C[e+4>>2],c=B(s-h),C[n+68>>2]=c,F=C[e>>2],d=B(F-Y),C[n+64>>2]=d,k=B(-1),J=B(m*D),X=B(_*u),M=B(v*b),x=B(m*u),R=B(_*b),D=B(v*D),u=B(B(B(J*o)+B(B(B(B(X*d)+B(M*c))-B(x*c))-B(R*o)))-B(D*d)),u==B(0)|u!=u||(g=B(N-p),F=B(W-F),W=B(V-W),p=B(p-s),s=B(w*B(B(g*F)-B(W*p))),w=B(w-Q),Q=B(Q-I),B(u*B(s+B(B(V*B(B(w*p)-B(g*Q)))+B(N*B(B(W*Q)-B(w*F))))))<=B(0)&&(l=n+24|0,t[l>>2]=0,t[n+16>>2]=0,t[n+20>>2]=0,t[n+12>>2]=0,B(u*B(B(B(B(X-D)*Y)+B(h*B(M-x)))+B(B(J-R)*G)))>B(0)&&(k=Fe(t[n+80>>2],t[n+84>>2],i,n+16|0,n+12|0),t[a+8>>2]=0,y=t[n+20>>2],t[a>>2]=t[n+16>>2],t[a+4>>2]=y,t[a+12>>2]=t[l>>2],l=t[n+12>>2],t[f>>2]=2&l|l<<1&8|1&l),G=C[n+52>>2],h=C[n+56>>2],l=i+4|0,B(u*B(B(B(B(B(G*o)-B(h*c))*C[i>>2])+B(C[l>>2]*B(B(h*d)-B(o*b))))+B(B(B(c*b)-B(G*d))*C[i+8>>2])))>B(0)&&(b=Fe(t[n+84>>2],t[n+88>>2],i,n+16|0,n+12|0),b<k^1&&!(k<B(0))||(t[a+4>>2]=t[n+16>>2],t[a>>2]=0,y=t[n+24>>2],t[a+8>>2]=t[n+20>>2],t[a+12>>2]=y,t[f>>2]=t[n+12>>2]<<1&14,k=b)),B(u*B(B(B(B(B(c*v)-B(o*_))*C[i>>2])+B(C[l>>2]*B(B(o*m)-B(v*d))))+B(B(B(_*d)-B(c*m))*C[i+8>>2])))>B(0)&&(b=Fe(t[n+88>>2],t[n+80>>2],i,n+16|0,n+12|0),b<k^1&&!(k<B(0))||(t[a+8>>2]=t[n+16>>2],t[a+4>>2]=0,t[a>>2]=t[n+20>>2],t[a+12>>2]=t[n+24>>2],l=t[n+12>>2],t[f>>2]=l>>>1&1|l<<1&8|l<<2&4,k=b)),k<B(0)&&(S=e+4|0,k=C[S>>2],T=r+8|0,b=C[T>>2],o=C[i>>2],Z=e+8|0,c=C[Z>>2],d=C[r>>2],l=i+4|0,v=C[l>>2],R=B(B(B(k*b)*o)+B(B(c*d)*v)),s=b,b=C[e>>2],g=B(k*d),y=i+8|0,k=C[y>>2],g=B(B(R-B(v*B(s*b)))-B(g*k)),s=k,U=r+4|0,k=C[U>>2],k=B(B(B(g+B(s*B(b*k)))-B(o*B(c*k)))/u),C[a>>2]=k,j=A+4|0,b=C[j>>2],o=C[Z>>2],c=C[i>>2],Z=A+8|0,d=C[Z>>2],v=C[e>>2],_=C[l>>2],R=B(B(B(b*o)*c)+B(B(d*v)*_)),s=o,o=C[A>>2],g=B(b*v),b=C[y>>2],g=B(B(R-B(_*B(s*o)))-B(g*b)),s=b,b=C[S>>2],b=B(B(B(g+B(s*B(o*b)))-B(c*B(d*b)))/u),C[a+4>>2]=b,t[f>>2]=15,o=C[U>>2],c=C[Z>>2],d=C[i>>2],v=C[T>>2],_=C[A>>2],m=C[l>>2],R=B(B(B(o*c)*d)+B(B(v*_)*m)),s=c,c=C[r>>2],g=B(o*_),o=C[y>>2],g=B(B(R-B(m*B(s*c)))-B(g*o)),s=o,o=C[j>>2],u=B(B(B(g+B(s*B(c*o)))-B(d*B(v*o)))/u),C[a+8>>2]=u,C[a+12>>2]=B(1)-B(B(k+b)+u),k=B(0)))),E=n+96|0,k;}function Fe(A,r,e,i,a){var f=B(0),n=B(0),b=B(0),k=B(0),c=B(0),u=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=0,p=B(0),D=B(0),w=0,W=0,F=B(0),Z=B(0),Y=B(0),E=B(0),N=B(0);n=B(-1),c=C[A>>2],k=C[r>>2],f=B(c-k),b=C[r+4>>2],h=C[e+4>>2],Z=B(b-h),R=C[A+4>>2],_=B(R-b),p=C[e>>2],Y=B(k-p),s=B(B(f*Z)-B(_*Y)),u=C[r+8>>2],D=C[e+8>>2],E=B(u-D),G=C[A+8>>2],d=B(G-u),v=B(B(_*E)-B(d*Z)),g=B(B(d*Y)-B(f*E)),N=B(B(s*s)+B(B(v*v)+B(g*g)));A:if(N>B(0)){r:{e:{i:{a:{if(B(B(B(c*B(B(s*_)-B(g*d)))+B(R*B(B(v*d)-B(s*f))))+B(B(B(g*f)-B(v*_))*G))>B(0)){if(_=B(k-c),d=B(b-R),m=B(u-G),n=B(B(B(_*_)+B(d*d))+B(m*m)),f=B(-1),!(n>B(0)))break e;if(n=B(B(-B(B(B(c*_)+B(R*d))+B(G*m)))/n),n>=B(1))break a;if(y=1,n<=B(0))break i;l(B(B(1)-n)),w=o(0),l(n),W=o(0),y=3,f=B(G+B(m*n)),k=B(f*f),f=B(c+B(_*n)),b=B(f*f),f=B(R+B(d*n)),f=B(k+B(b+B(f*f)));break e;}f=B(-1);break r;}W=1065353216,y=2,f=B(B(B(k*k)+B(b*b))+B(u*u));break e;}w=1065353216,f=B(B(B(c*c)+B(R*R))+B(G*G));}t[i+8>>2]=0,t[i+4>>2]=W,t[i>>2]=w,t[a>>2]=y,u=C[r+8>>2],b=C[r+4>>2],k=C[r>>2];}G=B(D-G),R=B(h-R),_=B(p-c);r:{e:{if(B(B(B(k*B(B(s*Z)-B(g*E)))+B(b*B(B(v*E)-B(s*Y))))+B(B(B(g*Y)-B(v*Z))*u))>B(0)){n=B(-1);i:{a:{if(p=C[e>>2],d=B(p-k),D=C[e+4>>2],m=B(D-b),F=C[e+8>>2],h=B(F-u),c=B(B(B(d*d)+B(m*m))+B(h*h)),c>B(0)){if(c=B(B(-B(B(B(k*d)+B(b*m))+B(u*h)))/c),!(c>=B(1))){if(y=1,c<=B(0))break a;if(n=B(u+B(h*c)),u=B(n*n),n=B(k+B(d*c)),k=B(n*n),n=B(b+B(m*c)),n=B(u+B(k+B(n*n))),l(B(B(1)-c)),w=o(0),l(c),W=o(0),y=3,f<B(0))break e;break i;}W=1065353216,w=0,y=2,n=B(B(B(p*p)+B(D*D))+B(F*F));}if(!(f<B(0)))break i;break e;}if(n=B(B(B(k*k)+B(b*b))+B(u*u)),W=0,w=1065353216,f<B(0))break e;}if(n<f)break e;}n=f;break r;}t[i+8>>2]=W,t[i+4>>2]=w,t[i>>2]=0,t[a>>2]=y<<1;}r:{e:{if(b=C[e>>2],u=C[e+4>>2],c=C[e+8>>2],B(B(B(b*B(B(s*R)-B(g*G)))+B(u*B(B(v*G)-B(s*_))))+B(B(B(g*_)-B(v*R))*c))>B(0)){f=B(-1);i:{a:{if(p=C[A>>2],d=B(p-b),D=C[A+4>>2],m=B(D-u),F=C[A+8>>2],h=B(F-c),k=B(B(B(d*d)+B(m*m))+B(h*h)),k>B(0)){if(k=B(B(-B(B(B(b*d)+B(u*m))+B(c*h)))/k),!(k>=B(1))){if(k<=B(0))break a;if(f=B(c+B(h*k)),c=B(f*f),f=B(b+B(d*k)),b=B(f*f),f=B(u+B(m*k)),f=B(c+B(b+B(f*f))),l(B(B(1)-k)),w=o(0),l(k),W=o(0),y=3,n<B(0))break e;break i;}W=1065353216,w=0,y=2,f=B(B(B(p*p)+B(D*D))+B(F*F));}if(!(n<B(0)))break i;break e;}if(f=B(B(B(b*b)+B(u*u))+B(c*c)),W=0,w=1065353216,y=1,n<B(0))break e;}if(f<n)break e;}if(!(n<B(0)))break A;break r;}if(t[i+8>>2]=w,t[i+4>>2]=0,t[i>>2]=W,t[a>>2]=5&(y<<2|y>>>1),n=f,!(f<B(0)))break A;}k=B(B(B(B(v*C[A>>2])+B(g*C[A+4>>2]))+B(s*C[A+8>>2]))/N),n=B(g*k),b=B(C[r+4>>2]-n),f=B(v*k),u=B(C[r>>2]-f),v=B(B(Y*b)-B(Z*u)),k=B(s*k),s=B(C[r+8>>2]-k),b=B(B(Z*s)-B(E*b)),c=B(b*b),b=B(B(E*u)-B(Y*s)),c=B(Q(B(B(v*v)+B(c+B(b*b))))),b=B(Q(N)),u=B(c/b),C[i>>2]=u,t[a>>2]=7,s=B(C[e+4>>2]-n),v=B(C[e>>2]-f),g=B(B(_*s)-B(R*v)),c=B(g*g),g=B(C[e+8>>2]-k),s=B(B(R*g)-B(G*s)),d=B(s*s),s=B(B(G*v)-B(_*g)),b=B(B(Q(B(c+B(d+B(s*s)))))/b),C[i+4>>2]=b,C[i+8>>2]=B(1)-B(u+b),n=B(B(k*k)+B(B(f*f)+B(n*n)));}return n;}function Ze(A,r,e,i,f,n){var o,k=B(0),c=B(0),u=B(0),l=0,s=B(0),d=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=0,Y=B(0),N=B(0),V=0,I=0,J=0,X=B(0),M=0,x=0,S=B(0),T=B(0),U=B(0),j=B(0);o=E-19040|0,E=o,t[n>>2]=0,t[n+4>>2]=0,t[n+32>>2]=0,l=n+24|0,t[l>>2]=0,t[l+4>>2]=0,l=n+16|0,t[l>>2]=0,t[l+4>>2]=0,l=n+8|0,t[l>>2]=0,t[l+4>>2]=0,t[o+18916>>2]=e,t[o+18912>>2]=A,k=C[i+20>>2],c=C[i+36>>2],A=r+20|0,u=C[A>>2],e=r+36|0,s=C[e>>2],l=r+24|0,_=C[l>>2],d=C[i+24>>2],Z=r+40|0,m=C[Z>>2],g=C[i+40>>2],R=C[i+32>>2],G=C[i>>2],h=C[i+16>>2],y=C[i+4>>2],p=C[r+32>>2],D=C[r>>2],w=C[r+16>>2],Y=C[r+4>>2],F=C[r+8>>2],W=C[i+8>>2],t[o+18964>>2]=0,t[o+18948>>2]=0,t[o+18932>>2]=0,N=B(B(B(F*W)+B(_*d))+B(m*g)),C[o+18960>>2]=N,X=B(B(B(Y*W)+B(u*d))+B(s*g)),C[o+18956>>2]=X,d=B(B(B(D*W)+B(w*d))+B(p*g)),C[o+18952>>2]=d,g=B(B(B(F*y)+B(_*k))+B(m*c)),C[o+18944>>2]=g,W=B(B(B(Y*y)+B(u*k))+B(s*c)),C[o+18940>>2]=W,k=B(B(B(D*y)+B(w*k))+B(p*c)),C[o+18936>>2]=k,c=B(B(B(G*F)+B(h*_))+B(R*m)),C[o+18928>>2]=c,u=B(B(B(G*Y)+B(h*u))+B(R*s)),C[o+18924>>2]=u,s=B(B(B(G*D)+B(h*w))+B(R*p)),C[o+18920>>2]=s,_=C[A>>2],m=C[e>>2],R=C[l>>2],G=C[i+52>>2],h=C[r+52>>2],y=C[Z>>2],p=C[i+56>>2],D=C[r+56>>2],w=C[r>>2],Y=C[r+16>>2],F=C[r+32>>2],S=C[r+4>>2],T=C[r+8>>2],U=C[i+48>>2],j=C[r+48>>2],t[o+19036>>2]=0,t[o+19028>>2]=0,t[o+19012>>2]=0,C[o+19008>>2]=N,C[o+19004>>2]=g,C[o+19e3>>2]=c,t[o+18996>>2]=0,C[o+18992>>2]=X,C[o+18988>>2]=W,C[o+18984>>2]=u,t[o+18980>>2]=0,C[o+18976>>2]=d,C[o+18972>>2]=k,k=B(U-j),c=B(G-h),u=B(p-D),C[o+19024>>2]=B(B(T*k)+B(R*c))+B(y*u),C[o+19020>>2]=B(B(k*S)+B(c*_))+B(u*m),C[o+19016>>2]=B(B(k*w)+B(c*Y))+B(u*F),t[o+19032>>2]=351,C[o+18968>>2]=s,A=o+18664|0,t[A>>2]=0,t[A+4>>2]=0,t[o+18656>>2]=0,t[o+18660>>2]=0,t[o+18892>>2]=0,t[o+18896>>2]=0,t[o+18672>>2]=0,t[o+18904>>2]=2,t[o+28>>2]=0,C[o+24>>2]=-C[f+8>>2],C[o+20>>2]=-C[f+4>>2],C[o+16>>2]=-C[f>>2];A:{r:{if(A=De(o+18528|0,o+18912|0,o+16|0),2!=(0|A)){if(1==(0|A)){for(A=o+18520|0,e=A,t[e>>2]=0,t[e+4>>2]=0,t[o+72>>2]=0,e=o- -64|0,t[e>>2]=0,t[e+4>>2]=0,t[o+18512>>2]=0,t[o+18516>>2]=0,t[o+18508>>2]=0,t[o+16>>2]=9,t[o+56>>2]=0,t[o+60>>2]=0,i=14336;e=(o+16|0)+i|0,t[e+4144>>2]=0,l=t[A>>2],t[e+4148>>2]=l,e=e+4100|0,l&&(t[l+44>>2]=e),t[A>>2]=e,i=i+-56|0,i;){}if(t[o+18524>>2]=256,t[o+12>>2]=0,C[o+8>>2]=-C[f+8>>2],C[o+4>>2]=-C[f+4>>2],C[o>>2]=-C[f>>2],9!=(0|function(A,r,e){var i=0,f=B(0),n=0,o=B(0),k=0,c=0,u=0,l=B(0),s=0,d=B(0),g=B(0),_=B(0),m=B(0),R=0,G=0,h=B(0),y=B(0),p=0,D=B(0),w=0,W=0,F=0,Z=0,Y=0,N=0,V=0,I=0,J=B(0);p=E-16|0,E=p,V=A;e:{i:{a:{f:{n:{if(n=t[r+372>>2],!(v[n+32>>2]<2)&&function A(r){var e=0,i=0,a=0,f=0,n=0,b=0,o=0,k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=0,m=B(0),R=0;a=E-32|0,E=a;t:{i=t[r+372>>2],e=t[i+32>>2]+-1|0;b:if(!(e>>>0>3)){switch(e-1|0){default:if(t[a+28>>2]=0,t[i+20>>2]=0,e=t[r+364>>2]+-1|0,t[r+364>>2]=e,t[a+20>>2]=0,t[a+24>>2]=0,t[i+32>>2]=2,_=i,i=t[348+((e<<2)+r|0)>>2],t[_+4>>2]=i,t[a+16>>2]=1065353216,we(r,a+16|0,i),A(r))break t;if(i=r+364|0,o=t[i>>2],e=r+372|0,f=t[e>>2],b=t[f+32>>2]+-1|0,n=t[(b<<2)+f>>2],t[348+((o<<2)+r|0)>>2]=n,t[f+32>>2]=b,f=t[e>>2],t[a+12>>2]=0,b=a+24|0,C[a+8>>2]=-C[b>>2],t[i>>2]=o,o=t[f+32>>2],t[f+32>>2]=o+1,f=f+(o<<2)|0,t[f>>2]=n,C[a+4>>2]=-C[a+20>>2],C[a>>2]=-C[a+16>>2],t[f+16>>2]=0,we(r,a,n),A(r))break t;if(f=t[e>>2],n=t[f+32>>2]+-1|0,t[f+32>>2]=n,o=t[i>>2],f=t[f+(n<<2)>>2],t[348+((o<<2)+r|0)>>2]=f,t[b>>2]=0,t[b+4>>2]=0,t[i>>2]=o,i=t[e>>2],e=t[i+32>>2],t[i+32>>2]=e+1,t[a+16>>2]=0,t[a+20>>2]=0,i=i+(e<<2)|0,t[i>>2]=f,t[a+20>>2]=1065353216,t[i+16>>2]=0,we(r,a+16|0,f),A(r))break t;if(i=r+364|0,o=t[i>>2],e=r+372|0,f=t[e>>2],n=t[f+32>>2]+-1|0,b=t[(n<<2)+f>>2],t[348+((o<<2)+r|0)>>2]=b,t[f+32>>2]=n,f=t[e>>2],t[a+12>>2]=0,n=a+24|0,C[a+8>>2]=-C[n>>2],t[i>>2]=o,o=t[f+32>>2],t[f+32>>2]=o+1,f=f+(o<<2)|0,t[f>>2]=b,C[a+4>>2]=-C[a+20>>2],C[a>>2]=-C[a+16>>2],t[f+16>>2]=0,we(r,a,b),A(r))break t;if(f=t[e>>2],b=t[f+32>>2]+-1|0,t[f+32>>2]=b,o=t[i>>2],f=t[f+(b<<2)>>2],t[348+((o<<2)+r|0)>>2]=f,t[n>>2]=0,t[n+4>>2]=0,t[n>>2]=1065353216,t[i>>2]=o,i=t[e>>2],e=t[i+32>>2],t[i+32>>2]=e+1,t[a+16>>2]=0,t[a+20>>2]=0,i=i+(e<<2)|0,t[i>>2]=f,t[i+16>>2]=0,we(r,a+16|0,f),A(r))break t;if(i=r+364|0,b=t[i>>2],f=r+372|0,e=t[f>>2],o=t[e+32>>2]+-1|0,n=t[(o<<2)+e>>2],t[348+((b<<2)+r|0)>>2]=n,t[e+32>>2]=o,e=t[f>>2],t[a+12>>2]=0,C[a+8>>2]=-C[a+24>>2],t[i>>2]=b,b=t[e+32>>2],t[e+32>>2]=b+1,e=e+(b<<2)|0,t[e>>2]=n,C[a+4>>2]=-C[a+20>>2],C[a>>2]=-C[a+16>>2],t[e+16>>2]=0,we(r,a,n),A(r))break t;n=t[i>>2],t[i>>2]=n+1,i=t[f>>2],e=t[i+32>>2]+-1|0,t[i+32>>2]=e,t[348+((n<<2)+r|0)>>2]=t[i+(e<<2)>>2];break b;case 1:if(t[a+28>>2]=0,e=t[i+4>>2],f=t[i>>2],c=C[f+20>>2],u=B(C[e+20>>2]-c),n=t[i+8>>2],k=C[f+24>>2],g=B(C[n+24>>2]-k),k=B(C[e+24>>2]-k),l=B(C[n+20>>2]-c),c=B(B(u*g)-B(k*l)),C[a+16>>2]=c,m=k,k=C[f+16>>2],s=B(C[n+16>>2]-k),v=B(C[e+16>>2]-k),k=B(B(m*s)-B(v*g)),C[a+20>>2]=k,u=B(B(v*l)-B(u*s)),C[a+24>>2]=u,!(B(B(u*u)+B(B(c*c)+B(k*k)))>B(0)))break b;if(e=i+28|0,t[e>>2]=0,t[e+4>>2]=4,e=t[r+364>>2]+-1|0,t[r+364>>2]=e,_=i,i=t[348+((e<<2)+r|0)>>2],t[_+12>>2]=i,we(r,a+16|0,i),A(r))break t;if(i=r+364|0,b=t[i>>2],f=r+372|0,e=t[f>>2],o=t[e+32>>2]+-1|0,n=t[(o<<2)+e>>2],t[348+((b<<2)+r|0)>>2]=n,t[e+32>>2]=o,e=t[f>>2],t[i>>2]=b,b=t[e+32>>2],t[e+32>>2]=b+1,e=e+(b<<2)|0,t[e>>2]=n,t[a+12>>2]=0,C[a+8>>2]=-C[a+24>>2],C[a+4>>2]=-C[a+20>>2],C[a>>2]=-C[a+16>>2],t[e+16>>2]=0,we(r,a,n),A(r))break t;n=t[i>>2],t[i>>2]=n+1,i=t[f>>2],e=t[i+32>>2]+-1|0,t[i+32>>2]=e,t[348+((n<<2)+r|0)>>2]=t[i+(e<<2)>>2];break b;case 2:if(r=t[i>>2],e=t[i+12>>2],c=C[e+16>>2],g=B(C[r+16>>2]-c),f=t[i+4>>2],k=C[e+20>>2],l=B(C[f+20>>2]-k),i=t[i+8>>2],u=C[e+24>>2],s=B(C[i+24>>2]-u),v=B(C[r+20>>2]-k),d=B(C[f+24>>2]-u),m=B(C[i+16>>2]-c),u=B(C[r+24>>2]-u),c=B(C[f+16>>2]-c),k=B(C[i+20>>2]-k),c=B(B(B(B(g*l)*s)+B(B(B(B(B(v*d)*m)+B(B(u*c)*k))-B(B(g*d)*k))-B(B(v*c)*s)))-B(B(u*l)*m)),!(c!=B(0)&c==c))break b;break t;case 0:}if(e=t[i>>2],c=C[e+20>>2],f=t[i+4>>2],k=C[f+20>>2],u=C[e+24>>2],l=C[f+24>>2],v=C[e+16>>2],d=C[f+16>>2],t[a+28>>2]=0,g=B(k-c),c=B(g*B(0)),l=B(l-u),k=B(l*B(0)),s=B(c-k),C[a+16>>2]=s,v=B(d-v),u=B(v*B(0)),d=B(l-u),C[a+20>>2]=d,m=B(u-g),C[a+24>>2]=m,B(B(m*m)+B(B(s*s)+B(d*d)))>B(0)){if(t[i+24>>2]=0,t[i+32>>2]=3,e=r+364|0,f=t[e>>2]+-1|0,t[e>>2]=f,_=i,i=t[348+((f<<2)+r|0)>>2],t[_+8>>2]=i,we(r,a+16|0,i),A(r))break t;if(b=t[e>>2],f=r+372|0,i=t[f>>2],o=t[i+32>>2]+-1|0,n=t[(o<<2)+i>>2],t[348+((b<<2)+r|0)>>2]=n,t[i+32>>2]=o,i=t[f>>2],t[a+12>>2]=0,C[a+8>>2]=-C[a+24>>2],t[e>>2]=b,e=t[i+32>>2],t[i+32>>2]=e+1,i=i+(e<<2)|0,t[i>>2]=n,C[a+4>>2]=-C[a+20>>2],C[a>>2]=-C[a+16>>2],t[i+16>>2]=0,we(r,a,n),A(r))break t;e=r+364|0,i=t[e>>2],t[e>>2]=i+1,e=t[f>>2],f=t[e+32>>2]+-1|0,t[e+32>>2]=f,t[348+((i<<2)+r|0)>>2]=t[e+(f<<2)>>2];}if(o=a+28|0,t[o>>2]=0,R=a+24|0,s=B(v-c),C[R>>2]=s,d=B(k-u),C[a+20>>2]=d,l=B(c-l),C[a+16>>2]=l,B(B(s*s)+B(B(l*l)+B(d*d)))>B(0)){if(i=r+364|0,e=t[i>>2]+-1|0,t[i>>2]=e,f=r+372|0,n=t[f>>2],b=t[n+32>>2],t[n+32>>2]=b+1,n=n+(b<<2)|0,t[n+16>>2]=0,e=t[348+((e<<2)+r|0)>>2],t[n>>2]=e,we(r,a+16|0,e),A(r))break t;if(b=t[i>>2],e=t[f>>2],_=t[e+32>>2]+-1|0,n=t[(_<<2)+e>>2],t[348+((b<<2)+r|0)>>2]=n,t[e+32>>2]=_,e=t[f>>2],t[a+12>>2]=0,C[a+8>>2]=-C[a+24>>2],t[i>>2]=b,i=t[e+32>>2],t[e+32>>2]=i+1,i=e+(i<<2)|0,t[i>>2]=n,C[a+4>>2]=-C[a+20>>2],C[a>>2]=-C[a+16>>2],t[i+16>>2]=0,we(r,a,n),A(r))break t;e=r+364|0,i=t[e>>2],t[e>>2]=i+1,e=t[r+372>>2],f=t[e+32>>2]+-1|0,t[e+32>>2]=f,t[348+((i<<2)+r|0)>>2]=t[e+(f<<2)>>2];}if(t[o>>2]=0,c=B(u-c),C[R>>2]=c,u=B(k-v),C[a+20>>2]=u,k=B(g-k),C[a+16>>2]=k,B(B(c*c)+B(B(k*k)+B(u*u)))>B(0)){if(i=r+364|0,e=t[i>>2]+-1|0,t[i>>2]=e,f=r+372|0,n=t[f>>2],b=t[n+32>>2],t[n+32>>2]=b+1,n=n+(b<<2)|0,t[n+16>>2]=0,e=t[348+((e<<2)+r|0)>>2],t[n>>2]=e,we(r,a+16|0,e),A(r))break t;if(b=t[i>>2],e=t[f>>2],o=t[e+32>>2]+-1|0,n=t[(o<<2)+e>>2],t[348+((b<<2)+r|0)>>2]=n,t[e+32>>2]=o,e=t[f>>2],t[a+12>>2]=0,C[a+8>>2]=-C[a+24>>2],t[i>>2]=b,i=t[e+32>>2],t[e+32>>2]=i+1,i=e+(i<<2)|0,t[i>>2]=n,C[a+4>>2]=-C[a+20>>2],C[a>>2]=-C[a+16>>2],t[i+16>>2]=0,we(r,a,n),A(r))break t;e=r+364|0,i=t[e>>2],t[e>>2]=i+1,e=t[r+372>>2],f=t[e+32>>2]+-1|0,t[e+32>>2]=f,t[348+((i<<2)+r|0)>>2]=t[e+(f<<2)>>2];}}return E=a+32|0,0;}return E=a+32|0,1;}(r)){if(i=t[A+18496>>2],i){for(k=t[A+18508>>2],c=t[A+18500>>2],u=A+18496|0,s=A+18504|0;R=i+48|0,G=t[R>>2],G&&(t[G+44>>2]=t[i+44>>2]),G=t[i+44>>2],G&&(t[G+48>>2]=t[R>>2]),(0|i)==t[u>>2]&&(t[u>>2]=t[R>>2]),t[i+44>>2]=0,t[R>>2]=t[s>>2],R=t[s>>2],R&&(t[R+44>>2]=i),c=c+-1|0,t[s>>2]=i,k=k+1|0,i=t[u>>2],i;){}t[A+18508>>2]=k,t[A+18500>>2]=c;}if(t[A+18492>>2]=0,t[A>>2]=0,k=t[n>>2],c=t[n+12>>2],f=C[c+16>>2],m=B(C[k+16>>2]-f),i=t[n+4>>2],o=C[c+20>>2],d=B(C[i+20>>2]-o),u=t[n+8>>2],l=C[c+24>>2],g=B(C[u+24>>2]-l),_=B(C[k+20>>2]-o),h=B(C[i+24>>2]-l),y=B(C[u+16>>2]-f),l=B(C[k+24>>2]-l),f=B(C[i+16>>2]-f),o=B(C[u+20>>2]-o),B(B(B(B(m*d)*g)+B(B(B(B(B(_*h)*y)+B(B(l*f)*o))-B(B(m*h)*o))-B(B(_*f)*g)))-B(B(l*d)*y))<B(0)?(t[n>>2]=i,t[n+4>>2]=k,c=t[n+16>>2],s=n+20|0,t[n+16>>2]=t[s>>2],t[s>>2]=c,c=k):(c=i,i=k),k=Ye(A,i,c,u,1),u=n+4|0,i=n+12|0,c=Ye(A,t[u>>2],t[n>>2],t[i>>2],1),R=n+8|0,s=Ye(A,t[R>>2],t[u>>2],t[i>>2],1),u=Ye(A,t[n>>2],t[R>>2],t[i>>2],1),4==t[A+18500>>2]){if(e=t[A+18496>>2],f=C[e+16>>2],i=t[e+48>>2],i){for(f=B(f*f);o=C[i+16>>2],o=B(o*o),n=o<f,e=n?i:e,f=n?o:f,i=t[i+48>>2],i;){}f=C[e+16>>2];}for(n=t[e+28>>2],R=t[e+24>>2],G=t[e+20>>2],d=C[e+12>>2],m=C[e+8>>2],l=C[e+4>>2],o=C[e>>2],t[k+32>>2]=c,a[k+52|0]=0,t[c+32>>2]=k,a[c+52|0]=0,t[k+36>>2]=s,a[k+53|0]=0,t[s+32>>2]=k,a[s+52|0]=1,t[k+40>>2]=u,a[k+54|0]=0,t[u+32>>2]=k,a[u+52|0]=2,t[c+36>>2]=u,a[c+53|0]=2,t[u+40>>2]=c,a[u+54|0]=1,t[c+40>>2]=s,a[c+54|0]=1,t[s+36>>2]=c,i=s+53|0,a[0|i]=258,a[i+1|0]=1,t[s+40>>2]=u,a[u+53|0]=2,t[u+36>>2]=s,t[A>>2]=0,w=A+18492|0,W=p+8|0,c=A+18496|0,u=A+18504|0,F=A+18500|0,Z=A+18508|0,k=0;;){if(i=t[w>>2],i>>>0>127)break n;if(t[W>>2]=0,t[w>>2]=i+1,k=k+1|0,a[e+55|0]=k,t[p>>2]=0,t[p+4>>2]=0,i=(i<<5)+A|0,Y=i+60|0,we(r,e,Y),!(B(B(B(B(C[e>>2]*C[i+76>>2])+B(C[e+4>>2]*C[i+80>>2]))+B(C[e+8>>2]*C[i+84>>2]))-C[e+16>>2])>B(9999999747378752e-20)))break f;for(s=e+32|0,i=52;N=Ee(A,k,Y,t[s>>2],b[e+i|0],p),N&&(I=i+-51|0,s=s+4|0,i=i+1|0,I>>>0<3);){}if(!(N&v[W>>2]>2))break a;if(i=t[p>>2],a[i+53|0]=2,n=t[p+4>>2],t[i+36>>2]=n,t[n+40>>2]=i,a[n+54|0]=1,i=e+48|0,n=t[i>>2],n&&(t[n+44>>2]=t[e+44>>2]),n=t[e+44>>2],n&&(t[n+48>>2]=t[i>>2]),(0|e)==t[c>>2]&&(t[c>>2]=t[i>>2]),t[e+44>>2]=0,t[i>>2]=t[u>>2],t[F>>2]=t[F>>2]+-1,i=t[u>>2],i&&(t[i+44>>2]=e),t[u>>2]=e,t[Z>>2]=t[Z>>2]+1,e=t[c>>2],f=C[e+16>>2],i=t[e+48>>2],i){for(f=B(f*f);o=C[i+16>>2],o=B(o*o),n=o<f,e=n?i:e,f=n?o:f,i=t[i+48>>2],i;){}f=C[e+16>>2];}if(n=t[e+28>>2],R=t[e+24>>2],G=t[e+20>>2],d=C[e+12>>2],m=C[e+8>>2],l=C[e+4>>2],o=C[e>>2],!(k>>>0<255))break;}break e;}}return t[A>>2]=8,f=C[e>>2],o=C[e+4>>2],l=C[e+8>>2],t[A+52>>2]=0,r=A+48|0,m=B(-l),C[r>>2]=m,e=A+44|0,d=B(-o),C[e>>2]=d,g=B(-f),C[A+40>>2]=g,f=B(Q(B(B(B(f*f)+B(o*o))+B(l*l)))),f>B(0)?(f=B(B(1)/f),C[r>>2]=f*m,C[e>>2]=f*d,C[A+40>>2]=f*g):(t[A+40>>2]=1065353216,t[A+44>>2]=0,t[r>>2]=0),r=A+52|0,t[r>>2]=0,t[r+4>>2]=0,t[A+36>>2]=1,t[A+20>>2]=1065353216,t[A+4>>2]=t[n>>2],E=p+16|0,8;}t[A>>2]=6;break e;}r=7;break i;}r=4;}t[V>>2]=r;}return C[A+56>>2]=f,C[A+40>>2]=o,C[A+52>>2]=d,C[A+48>>2]=m,C[A+44>>2]=l,r=A+20|0,o=B(o*f),d=B(C[R+16>>2]-o),e=n+20|0,l=B(l*f),g=B(C[e>>2]-l),i=R+20|0,_=B(C[i>>2]-l),h=B(C[n+16>>2]-o),y=B(B(d*g)-B(_*h)),k=n+24|0,f=B(m*f),m=B(C[k>>2]-f),D=B(_*m),c=R+24|0,_=B(C[c>>2]-f),g=B(D-B(_*g)),m=B(B(_*h)-B(d*m)),m=B(Q(B(B(y*y)+B(B(g*g)+B(m*m))))),C[r>>2]=m,u=A+24|0,d=B(C[n+16>>2]-o),s=G+20|0,g=B(C[s>>2]-l),_=B(C[e>>2]-l),h=B(C[G+16>>2]-o),y=B(B(d*g)-B(_*h)),J=B(y*y),D=_,e=G+24|0,_=B(C[e>>2]-f),y=B(C[k>>2]-f),g=B(B(D*_)-B(y*g)),d=B(B(y*h)-B(d*_)),d=B(Q(B(J+B(B(g*g)+B(d*d))))),C[u>>2]=d,t[A+4>>2]=G,t[A+36>>2]=3,t[A+12>>2]=n,t[A+8>>2]=R,g=B(C[G+16>>2]-o),_=B(C[i>>2]-l),l=B(C[s>>2]-l),o=B(C[R+16>>2]-o),h=B(B(g*_)-B(l*o)),D=l,l=B(C[c>>2]-f),f=B(C[e>>2]-f),_=B(B(D*l)-B(f*_)),f=B(B(f*o)-B(g*l)),o=B(Q(B(B(h*h)+B(B(_*_)+B(f*f))))),f=B(o+B(m+d)),C[A+28>>2]=o/f,C[u>>2]=d/f,C[r>>2]=m/f,E=p+16|0,t[A>>2];}(o+16|0,o+18528|0,o)))break r;t[n>>2]=3;}break A;}t[n>>2]=2;break A;}if(A=o+52|0,t[A>>2])for(i=o+36|0,k=B(0),e=0,f=o+19036|0,l=o+19032|0,Z=o+8|0,c=B(0),u=B(0);V=t[f>>2],I=t[o+18912>>2]+(V>>1)|0,J=t[l>>2],yf[1&V?t[J+t[I>>2]>>2]:J](o,I,t[i+-16>>2]),s=C[i>>2],k=B(k+B(s*C[Z>>2])),c=B(c+B(s*C[o+4>>2])),u=B(u+B(C[o>>2]*s)),i=i+4|0,e=e+1|0,e>>>0<v[A>>2];){}else u=B(0),c=B(0),k=B(0);return A=r+48|0,s=C[A>>2],e=r+8|0,_=C[e>>2],i=r+4|0,d=C[i>>2],f=r+52|0,m=C[f>>2],l=r+24|0,g=C[l>>2],Z=r+16|0,R=C[Z>>2],V=r+20|0,G=C[V>>2],I=r+56|0,h=C[I>>2],J=r+40|0,y=C[J>>2],M=r+32|0,p=C[M>>2],x=r+36|0,D=C[x>>2],w=C[r>>2],t[n+16>>2]=0,C[n+12>>2]=h+B(B(B(u*p)+B(c*D))+B(k*y)),C[n+8>>2]=m+B(B(B(u*R)+B(c*G))+B(k*g)),C[n+4>>2]=s+B(B(B(u*w)+B(c*d))+B(k*_)),t[n>>2]=1,_=C[A>>2],d=C[i>>2],m=C[e>>2],g=C[f>>2],R=C[l>>2],G=C[Z>>2],h=C[V>>2],y=C[I>>2],p=C[J>>2],D=C[M>>2],w=C[x>>2],Y=C[r>>2],s=C[o+72>>2],C[n+52>>2]=-s,t[n+48>>2]=0,F=C[o- -64>>2],C[n+44>>2]=-F,W=C[o+60>>2],C[n+40>>2]=-W,N=C[o+56>>2],C[n+36>>2]=-N,t[n+32>>2]=0,u=B(u-B(N*s)),c=B(c-B(s*W)),k=B(k-B(s*F)),C[n+28>>2]=y+B(B(B(D*u)+B(w*c))+B(p*k)),C[n+24>>2]=g+B(B(B(u*G)+B(c*h))+B(k*R)),C[n+20>>2]=_+B(B(B(u*Y)+B(c*d))+B(k*m)),E=o+19040|0,1;}return E=o+19040|0,0;}function Ye(A,r,e,i,f){var n=0,b=0,o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=0,_=B(0);A:{r:{e:{if(n=t[A+18504>>2],n){if(b=t[n+48>>2],b&&(t[b+44>>2]=t[n+44>>2]),b=t[n+44>>2],b&&(t[b+48>>2]=t[n+48>>2]),b=A+18504|0,t[b>>2]==(0|n)&&(t[b>>2]=t[n+48>>2]),t[n+44>>2]=0,t[n+48>>2]=t[A+18496>>2],b=A+18508|0,t[b>>2]=t[b>>2]+-1,b=t[A+18496>>2],b&&(t[b+44>>2]=n),t[A+18496>>2]=n,b=A+18500|0,t[b>>2]=t[b>>2]+1,a[n+55|0]=0,t[n+28>>2]=i,t[n+24>>2]=e,t[n+20>>2]=r,u=C[e+24>>2],o=C[r+24>>2],_=C[i+24>>2],l=C[i+20>>2],s=C[e+20>>2],c=C[r+20>>2],d=C[e+16>>2],k=C[r+16>>2],v=C[i+16>>2],t[n+12>>2]=0,d=B(d-k),l=B(l-c),s=B(s-c),k=B(v-k),c=B(B(d*l)-B(s*k)),C[n+8>>2]=c,u=B(u-o),v=B(u*k),k=B(_-o),o=B(v-B(d*k)),C[n+4>>2]=o,k=B(B(s*k)-B(u*l)),C[n>>2]=k,g=2,o=B(Q(B(B(B(k*k)+B(o*o))+B(c*c)))),!(o>B(9999999747378752e-20)))break r;if(b=n+16|0,Ne(n,r,e,b)||Ne(n,e,i,b)||Ne(n,i,r,b)||(C[n+16>>2]=B(B(B(C[r+16>>2]*C[n>>2])+B(C[r+20>>2]*C[n+4>>2]))+B(C[r+24>>2]*C[n+8>>2]))/o),o=B(B(1)/o),C[n>>2]=o*C[n>>2],r=n+4|0,C[r>>2]=o*C[r>>2],r=n+8|0,C[r>>2]=o*C[r>>2],!f)break e;return n;}return t[A>>2]=5,0;}if(g=3,C[b>>2]>=B(-9999999747378752e-21))break A;}return t[A>>2]=g,r=t[n+48>>2],r&&(t[r+44>>2]=t[n+44>>2]),r=t[n+44>>2],r&&(t[r+48>>2]=t[n+48>>2]),r=A+18496|0,t[r>>2]==(0|n)&&(t[r>>2]=t[n+48>>2]),t[n+44>>2]=0,r=A+18504|0,t[n+48>>2]=t[r>>2],e=A+18500|0,t[e>>2]=t[e>>2]+-1,e=t[r>>2],e&&(t[e+44>>2]=n),t[r>>2]=n,A=A+18508|0,t[A>>2]=t[A>>2]+1,0;}return n;}function Ee(A,r,e,i,f,n){var o=0,k=0;A:if(b[i+55|0]!=(0|r)){o=f<<2,k=t[o+14832>>2];r:{e:{if(B(B(B(B(C[i>>2]*C[e+16>>2])+B(C[i+4>>2]*C[e+20>>2]))+B(C[i+8>>2]*C[e+24>>2]))-C[i+16>>2])<B(-9999999747378752e-21)){if(r=A,A=i+20|0,A=Ye(r,t[A+(k<<2)>>2],t[A+o>>2],e,0),!A)break A;if(t[A+32>>2]=i,a[A+52|0]=f,a[52+(i+f|0)|0]=0,t[32+((f<<2)+i|0)>>2]=A,r=t[n>>2],!r)break e;t[r+36>>2]=A,a[r+53|0]=2,t[A+40>>2]=r,a[A+54|0]=1;break r;}if(a[i+55|0]=r,!Ee(A,r,e,t[32+((k<<2)+i|0)>>2],b[52+(i+k|0)|0],n))break A;if(f=r,r=t[o+14844>>2],!Ee(A,f,e,t[32+((r<<2)+i|0)>>2],b[52+(r+i|0)|0],n))break A;return r=t[i+48>>2],r&&(t[r+44>>2]=t[i+44>>2]),r=t[i+44>>2],r&&(t[r+48>>2]=t[i+48>>2]),r=A+18496|0,(0|i)==t[r>>2]&&(t[r>>2]=t[i+48>>2]),t[i+44>>2]=0,t[i+48>>2]=t[A+18504>>2],r=A+18500|0,t[r>>2]=t[r>>2]+-1,r=t[A+18504>>2],r&&(t[r+44>>2]=i),t[A+18504>>2]=i,A=A+18508|0,t[A>>2]=t[A>>2]+1,1;}t[n+4>>2]=A;}return t[n>>2]=A,t[n+8>>2]=t[n+8>>2]+1,1;}return 0;}function Ne(A,r,e,i){var a=B(0),f=B(0),n=B(0),t=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0);return b=C[e+24>>2],a=C[r+24>>2],c=B(b-a),o=C[e+16>>2],n=C[r+16>>2],u=B(o-n),f=C[A+4>>2],k=C[e+20>>2],t=C[r+20>>2],l=B(k-t),s=C[A>>2],d=C[A+8>>2],A=0,B(B(a*B(B(u*f)-B(l*s)))+B(B(n*B(B(l*d)-B(c*f)))+B(t*B(B(c*s)-B(u*d)))))<B(0)&&(f=B(B(B(n*n)+B(t*t))+B(a*a)),B(B(B(n*u)+B(t*l))+B(a*c))>B(0)||(f=B(B(B(o*o)+B(k*k))+B(b*b)),B(B(B(o*u)+B(k*l))+B(b*c))<B(0)||(f=B(B(B(B(o*o)+B(k*k))+B(b*b))*B(B(B(n*n)+B(t*t))+B(a*a))),a=B(B(B(o*n)+B(k*t))+B(b*a)),a=B(B(f-B(a*a))/B(B(B(u*u)+B(l*l))+B(c*c))),f=a>B(0)?a:B(0))),C[i>>2]=Q(f),A=1),A;}function Ve(A){var r=0;a[A+356|0]=1,t[A>>2]=0,a[A+312|0]=0,t[A+292>>2]=1566444395,t[A+296>>2]=1566444395,r=A+300|0,t[r>>2]=1566444395,t[r+4>>2]=0,a[A+352|0]=0,r=A+344|0,t[r>>2]=0,t[r+4>>2]=0,r=A+336|0,t[r>>2]=0,t[r+4>>2]=0,A=A+332|0,a[0|A]=240&b[0|A];}function Ie(A,r,e,i){var f,n=0,b=0,o=0;n=t[r+4>>2],t[A+292>>2]=t[r>>2],t[A+296>>2]=n,n=r+8|0,o=t[n+4>>2],b=A+300|0,t[b>>2]=t[n>>2],t[b+4>>2]=o,a[A+356|0]=1,f=t[n+4>>2],b=(t[A>>2]<<4)+A|0,o=b+12|0,t[o>>2]=t[n>>2],t[o+4>>2]=f,n=b+4|0,b=t[r+4>>2],t[n>>2]=t[r>>2],t[n+4>>2]=b,b=e+8|0,o=t[b+4>>2],r=(t[A>>2]<<4)+A|0,n=r+92|0,t[n>>2]=t[b>>2],t[n+4>>2]=o,n=t[e+4>>2],r=r+84|0,t[r>>2]=t[e>>2],t[r+4>>2]=n,n=t[i+4>>2],r=(t[A>>2]<<4)+A|0,e=r+164|0,t[e>>2]=t[i>>2],t[e+4>>2]=n,e=i+8|0,i=t[e+4>>2],r=r+172|0,t[r>>2]=t[e>>2],t[r+4>>2]=i,t[A>>2]=t[A>>2]+1;}function Je(A){var r,e=0,i=0,f=0,n=0,o=0,k=0,c=B(0),u=0,l=0,s=B(0),d=0,v=0,g=B(0),_=B(0),m=0,R=B(0),G=0,h=0,y=0,Q=B(0),p=B(0),D=B(0),w=B(0),W=0,F=0,Z=B(0),Y=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=B(0),M=0;r=E-16|0,E=r;A:{r:{e:{i:{a:{f:{n:{t:{b:{o:{k:{c:{u:{l:{s:{d:{v:{C:{g:{_:{B:{m:{R:{G:{h:{y:{Q:{p:{D:{w:{W:{if(b[A+356|0]){if(a[A+352|0]=0,e=A+344|0,t[e>>2]=0,t[e+4>>2]=0,F=A+336|0,e=F,t[e>>2]=0,t[e+4>>2]=0,a[A+356|0]=0,f=A+332|0,e=-16&b[0|f],a[0|f]=e,f=t[A>>2],f>>>0>4)break r;switch(i=A+316|0,f-1|0){case 3:break p;case 2:break D;case 1:break w;case 0:break W;}i=0;break r;}i=b[A+312|0];break A;}i=t[A+168>>2],t[A+260>>2]=t[A+164>>2],t[A+264>>2]=i,i=t[A+88>>2],t[A+244>>2]=t[A+84>>2],t[A+248>>2]=i,l=A+172|0,k=t[l+4>>2],f=A+268|0,i=f,t[i>>2]=t[l>>2],t[i+4>>2]=k,l=A+92|0,k=t[l+4>>2],i=A+252|0,t[i>>2]=t[l>>2],t[i+4>>2]=k,a[A+352|0]=0,t[A+288>>2]=0,C[A+280>>2]=C[A+248>>2]-C[A+264>>2],C[A+276>>2]=C[A+244>>2]-C[A+260>>2],C[A+284>>2]=C[i>>2]-C[f>>2],i=A+344|0,t[i>>2]=0,t[i+4>>2]=0,i=A+336|0,t[i>>2]=1065353216,t[i+4>>2]=0,a[A+332|0]=e,i=1;break r;}if(R=C[A+4>>2],c=B(C[A+20>>2]-R),Q=C[A+8>>2],g=B(C[A+24>>2]-Q),p=C[A+12>>2],_=B(C[A+28>>2]-p),R=B(B(B(B(B(0)-R)*c)+B(B(B(0)-Q)*g))+B(B(B(0)-p)*_)),!(R>B(0)))break Q;if(s=B(B(B(c*c)+B(g*g))+B(_*_)),!(R<s))break G;s=B(R/s),i=3|e;break R;}if(e=r+8|0,t[e>>2]=0,t[e+4>>2]=0,t[r>>2]=0,t[r+4>>2]=0,l=A+4|0,k=A+20|0,n=A+36|0,Xe(r,l,k,n,i),t[A+256>>2]=0,g=C[A+336>>2],s=C[A+340>>2],c=C[A+344>>2],_=B(B(B(g*C[A+92>>2])+B(s*C[A+108>>2]))+B(c*C[A+124>>2])),C[A+252>>2]=_,R=B(B(B(g*C[A+88>>2])+B(s*C[A+104>>2]))+B(c*C[A+120>>2])),C[A+248>>2]=R,o=A+100|0,v=A+116|0,Q=B(B(B(g*C[A+84>>2])+B(s*C[o>>2]))+B(c*C[v>>2])),C[A+244>>2]=Q,h=A+180|0,p=C[h>>2],m=A+196|0,D=C[m>>2],w=C[A+200>>2],Z=C[A+168>>2],Y=C[A+184>>2],V=C[A+204>>2],I=C[A+172>>2],J=C[A+188>>2],X=C[A+164>>2],t[A+288>>2]=0,N=_,_=B(B(B(g*I)+B(s*J))+B(c*V)),C[A+284>>2]=N-_,N=R,R=B(B(B(g*Z)+B(s*Y))+B(c*w)),C[A+280>>2]=N-R,g=B(B(B(g*X)+B(s*p))+B(c*D)),C[A+276>>2]=Q-g,t[A+272>>2]=0,C[A+268>>2]=_,C[A+264>>2]=R,C[A+260>>2]=g,e=t[A>>2],(0|e)<4)break y;if(f=b[A+332|0],8&f)break m;if(i=e+-1|0,t[A>>2]=i,e=(i<<4)+A|0,d=e+12|0,G=t[d+4>>2],u=A+60|0,t[u>>2]=t[d>>2],t[u+4>>2]=G,d=e+4|0,G=t[d+4>>2],u=A+52|0,t[u>>2]=t[d>>2],t[u+4>>2]=G,d=e+92|0,G=t[d+4>>2],u=A+140|0,t[u>>2]=t[d>>2],t[u+4>>2]=G,d=e+84|0,G=t[d+4>>2],u=A+132|0,t[u>>2]=t[d>>2],t[u+4>>2]=G,d=e+172|0,G=t[d+4>>2],u=A+220|0,t[u>>2]=t[d>>2],t[u+4>>2]=G,e=e+164|0,d=t[e+4>>2],u=A+212|0,t[u>>2]=t[e>>2],t[u+4>>2]=d,!(4&f))break t;break n;}if(e=r+8|0,t[e>>2]=0,t[e+4>>2]=0,t[r>>2]=0,t[r+4>>2]=0,l=A+4|0,k=A+20|0,n=A+36|0,o=A+52|0,!function(A,r,e,i,f,n){var o=0,k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=0,v=0,g=B(0),_=B(0),m=0,R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=0,F=B(0),Z=B(0),Y=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=B(0),M=B(0),x=B(0),S=B(0),T=B(0),U=B(0),j=B(0),O=B(0),H=B(0),z=B(0),P=B(0),L=0,K=0;o=E-48|0,E=o,d=t[A+4>>2],t[n>>2]=t[A>>2],t[n+4>>2]=d,d=A+8|0,v=t[d+4>>2],W=n+8|0,t[W>>2]=t[d>>2],t[W+4>>2]=v,a[n+16|0]=15|b[n+16|0],v=0,a[o+24|0]=0;p:{X=C[d>>2],c=C[r+8>>2],J=B(X-c),k=C[e+8>>2],s=B(k-c),M=C[i>>2],l=C[r>>2],u=B(M-l),x=C[f+4>>2],F=C[r+4>>2],R=B(x-F),S=C[i+4>>2],G=B(S-F),T=C[f>>2],h=B(T-l),D=B(B(u*R)-B(G*h)),Z=C[e>>2],_=B(Z-l),U=C[f+8>>2],y=B(U-c),j=C[i+8>>2],g=B(j-c),w=B(B(G*y)-B(g*R)),Y=C[e+4>>2],Q=B(Y-F),N=B(B(g*h)-B(u*y)),p=B(B(s*D)+B(B(_*w)+B(Q*N))),V=B(J*D),O=C[A>>2],D=B(O-l),I=B(D*w),H=C[A+4>>2],w=B(H-F),d=B(p*p)<B(9.99999905104687e-9)?-1:B(B(V+B(I+B(w*N)))*p)<B(0),N=B(B(Q*g)-B(s*G)),z=B(B(s*u)-B(_*g)),P=B(B(_*G)-B(Q*u)),p=B(B(B(N*h)+B(z*R))+B(P*y)),V=g,g=B(B(Q*h)-B(_*R)),I=u,u=B(B(s*R)-B(Q*y)),R=B(B(_*y)-B(s*h)),s=B(B(V*g)+B(B(I*u)+B(G*R))),I=B(c-k),c=B(S-Y),G=B(T-Z),h=B(M-Z),_=B(x-Y),y=B(B(c*G)-B(h*_)),Q=B(l-Z),l=B(j-k),V=c,c=B(U-k),_=B(B(l*_)-B(V*c)),l=B(B(h*c)-B(l*G)),c=B(B(I*y)+B(B(Q*_)+B(B(F-Y)*l)));D:{w:{W:{F:{Z:{if(W=B(c*c)<B(9.99999905104687e-9)?-1:B(B(B(B(X-k)*y)+B(B(B(O-Z)*_)+B(B(H-Y)*l)))*c)<B(0),L=B(s*s)<B(9.99999905104687e-9)?-1:B(B(B(J*g)+B(B(D*u)+B(w*R)))*s)<B(0),m=B(p*p)<B(9.99999905104687e-9)?-1:B(B(B(B(D*N)+B(w*z))+B(P*J))*p)<B(0),K=W|L|m|d,(0|K)>-1){if(!K)break D;if(!m)break Z;if(Xe(A,r,e,i,o+8|0),k=C[o+8>>2],c=B(k-C[A>>2]),u=B(c*c),s=C[o+12>>2],c=B(s-C[A+4>>2]),u=B(u+B(c*c)),l=C[o+16>>2],c=B(l-C[A+8>>2]),c=B(u+B(c*c)),u=B(3.4028234663852886e38),!(c<B(3.4028234663852886e38)))break F;if(t[n+12>>2]=t[o+20>>2],C[n+8>>2]=l,C[n+4>>2]=s,C[n>>2]=k,v=t[o+32>>2],t[n+20>>2]=t[o+28>>2],t[n+24>>2]=v,t[n+32>>2]=0,t[n+28>>2]=t[o+36>>2],m=n+16|0,v=b[o+24|0],a[0|m]=1&v|240&b[0|m]|2&v|4&v,d)break W;break w;}return a[n+36|0]=1,E=o+48|0,0;}u=B(3.4028234663852886e38);}if(c=u,!d)break w;}Xe(A,r,i,f,o+8|0),s=C[o+8>>2],k=B(s-C[A>>2]),u=B(k*k),l=C[o+12>>2],k=B(l-C[A+4>>2]),g=B(u+B(k*k)),u=C[o+16>>2],k=B(u-C[A+8>>2]),k=B(g+B(k*k)),k<c&&(t[n+12>>2]=t[o+20>>2],C[n+8>>2]=u,C[n+4>>2]=l,C[n>>2]=s,t[n+20>>2]=t[o+28>>2],t[n+24>>2]=0,d=o+32|0,v=t[d+4>>2],m=n+28|0,t[m>>2]=t[d>>2],t[m+4>>2]=v,d=n+16|0,v=b[o+24|0],m=v<<1,a[0|d]=8&m|4&m|1&v|240&b[0|d],c=k);}if(L&&(Xe(A,r,f,e,o+8|0),s=C[o+8>>2],k=B(s-C[A>>2]),u=B(k*k),l=C[o+12>>2],k=B(l-C[A+4>>2]),g=B(u+B(k*k)),u=C[o+16>>2],k=B(u-C[A+8>>2]),k=B(g+B(k*k)),k<c&&(t[n+12>>2]=t[o+20>>2],C[n+8>>2]=u,C[n+4>>2]=l,C[n>>2]=s,t[n+20>>2]=t[o+28>>2],t[n+28>>2]=0,t[n+32>>2]=t[o+32>>2],t[n+24>>2]=t[o+36>>2],d=n+16|0,r=b[o+24|0],a[0|d]=1&r|240&b[0|d]|r>>>1&2|r<<2&8,c=k)),!W)break p;Xe(A,e,f,i,o+8|0),v=1,k=C[o+8>>2],s=B(k-C[A>>2]),u=B(s*s),s=C[o+12>>2],l=B(s-C[A+4>>2]),g=B(u+B(l*l)),l=C[o+16>>2],u=B(l-C[A+8>>2]),B(g+B(u*u))<c&&(t[n+12>>2]=t[o+20>>2],C[n+8>>2]=l,C[n+4>>2]=s,C[n>>2]=k,t[n+20>>2]=0,t[n+24>>2]=t[o+28>>2],t[n+32>>2]=t[o+32>>2],t[n+28>>2]=t[o+36>>2],r=n+16|0,A=b[o+24|0],a[0|r]=4&A|240&b[0|r]|A<<1&2|A<<2&8);}return E=o+48|0,v;}return E=o+48|0,1;}(r,l,k,n,o,i))break h;if(t[A+256>>2]=0,c=C[A+336>>2],g=C[A+340>>2],_=C[A+344>>2],s=C[A+348>>2],R=B(B(B(B(c*C[A+92>>2])+B(g*C[A+108>>2]))+B(_*C[A+124>>2]))+B(s*C[A+140>>2])),C[A+252>>2]=R,Q=B(B(B(B(c*C[A+88>>2])+B(g*C[A+104>>2]))+B(_*C[A+120>>2]))+B(s*C[A+136>>2])),C[A+248>>2]=Q,v=A+100|0,h=A+116|0,m=A+132|0,p=B(B(B(B(c*C[A+84>>2])+B(g*C[v>>2]))+B(_*C[h>>2]))+B(s*C[m>>2])),C[A+244>>2]=p,t[A+288>>2]=0,t[A+272>>2]=0,D=B(B(B(B(c*C[A+172>>2])+B(g*C[A+188>>2]))+B(_*C[A+204>>2]))+B(s*C[A+220>>2])),C[A+268>>2]=D,w=B(B(B(B(c*C[A+168>>2])+B(g*C[A+184>>2]))+B(_*C[A+200>>2]))+B(s*C[A+216>>2])),C[A+264>>2]=w,u=A+180|0,d=A+196|0,G=A+212|0,c=B(B(B(B(c*C[A+164>>2])+B(g*C[u>>2]))+B(_*C[d>>2]))+B(s*C[G>>2])),C[A+260>>2]=c,C[A+284>>2]=R-D,C[A+280>>2]=Q-w,C[A+276>>2]=p-c,e=t[A>>2],(0|e)<4)break B;if(f=b[A+332|0],8&f)break C;if(i=e+-1|0,t[A>>2]=i,e=(i<<4)+A|0,W=e+12|0,M=t[W+4>>2],y=o+8|0,t[y>>2]=t[W>>2],t[y+4>>2]=M,y=e+4|0,W=t[y+4>>2],t[o>>2]=t[y>>2],t[o+4>>2]=W,y=e+92|0,W=t[y+4>>2],o=m+8|0,t[o>>2]=t[y>>2],t[o+4>>2]=W,o=e+84|0,y=t[o+4>>2],t[m>>2]=t[o>>2],t[m+4>>2]=y,m=e+172|0,y=t[m+4>>2],o=G+8|0,t[o>>2]=t[m>>2],t[o+4>>2]=y,e=e+164|0,o=t[e+4>>2],t[G>>2]=t[e>>2],t[G+4>>2]=o,!(4&f))break v;break s;}i=1|e;break R;}if(i=3,3!=(0|e))break _;if(f=b[A+332|0],4&f)break n;break t;}if(!b[A+352|0])break g;i=0,a[A+312|0]=0;break A;}s=B(1),i=2|e;}e=A+344|0,t[e>>2]=0,t[e+4>>2]=0,C[A+340>>2]=s,R=B(B(1)-s),C[A+336>>2]=R,a[A+332|0]=i,t[A+256>>2]=0,c=C[A+92>>2],Q=B(c+B(s*B(C[A+108>>2]-c))),C[A+252>>2]=Q,c=C[A+88>>2],p=B(c+B(s*B(C[A+104>>2]-c))),C[A+248>>2]=p,c=C[A+84>>2],D=B(c+B(s*B(C[A+100>>2]-c))),C[A+244>>2]=D,w=C[A+180>>2],Z=C[A+184>>2],c=C[A+168>>2],Y=C[A+188>>2],g=C[A+172>>2],_=C[A+164>>2],t[A+288>>2]=0,g=B(g+B(s*B(Y-g))),C[A+284>>2]=Q-g,c=B(c+B(s*B(Z-c))),C[A+280>>2]=p-c,_=B(_+B(s*B(w-_))),C[A+276>>2]=D-_,t[A+272>>2]=0,C[A+268>>2]=g,C[A+264>>2]=c,C[A+260>>2]=_,f=1,2&i||(t[A>>2]=1,f=0),1&i||(t[A>>2]=f,i=(f<<4)+A|0,e=i+12|0,f=t[e>>2],l=t[e+4>>2],e=i+4|0,k=t[e>>2],n=t[e+4>>2],v=i+92|0,h=t[v+4>>2],e=A+84|0,o=e+8|0,t[o>>2]=t[v>>2],t[o+4>>2]=h,o=i+84|0,v=t[o+4>>2],t[e>>2]=t[o>>2],t[e+4>>2]=v,v=i+164|0,h=t[v+4>>2],e=A+164|0,t[e>>2]=t[v>>2],t[e+4>>2]=h,i=i+172|0,o=t[i+4>>2],e=e+8|0,t[e>>2]=t[i>>2],t[e+4>>2]=o,i=A+4|0,t[i>>2]=k,t[i+4>>2]=n,i=i+8|0,t[i>>2]=f,t[i+4>>2]=l),i=s>=B(0)&R>=B(0);break r;}if(i=e,4&f)break n;break t;}if(i=3,3!=(0|e))break d;if(f=b[A+332|0],!(4&f))break v;break s;}if(i=2,(0|e)<2)break u;if(f=b[A+332|0],!(2&f))break f;break a;}t[A+276>>2]=0,t[A+280>>2]=0,i=A+284|0,t[i>>2]=0,t[i+4>>2]=0,i=1,a[A+312|0]=1;break A;}if(i=e,4&f)break s;}if(i=i+-1|0,t[A>>2]=i,e=(i<<4)+A|0,m=e+12|0,G=t[m+4>>2],o=n+8|0,t[o>>2]=t[m>>2],t[o+4>>2]=G,o=e+4|0,m=t[o+4>>2],t[n>>2]=t[o>>2],t[n+4>>2]=m,o=e+92|0,m=t[o+4>>2],n=h+8|0,t[n>>2]=t[o>>2],t[n+4>>2]=m,n=e+84|0,o=t[n+4>>2],t[h>>2]=t[n>>2],t[h+4>>2]=o,o=e+172|0,h=t[o+4>>2],n=d+8|0,t[n>>2]=t[o>>2],t[n+4>>2]=h,e=e+164|0,n=t[e+4>>2],t[d>>2]=t[e>>2],t[d+4>>2]=n,!(2&f))break l;break k;}if(i=2,(0|e)<2)break c;f=b[A+332|0];}if(2&f)break k;}if(i=i+-1|0,t[A>>2]=i,e=(i<<4)+A|0,o=e+12|0,h=t[o+4>>2],n=k+8|0,t[n>>2]=t[o>>2],t[n+4>>2]=h,n=e+4|0,o=t[n+4>>2],t[k>>2]=t[n>>2],t[k+4>>2]=o,n=e+92|0,o=t[n+4>>2],k=v+8|0,t[k>>2]=t[n>>2],t[k+4>>2]=o,k=e+84|0,n=t[k+4>>2],t[v>>2]=t[k>>2],t[v+4>>2]=n,n=e+172|0,o=t[n+4>>2],k=u+8|0,t[k>>2]=t[n>>2],t[k+4>>2]=o,e=e+164|0,k=t[e+4>>2],t[u>>2]=t[e>>2],t[u+4>>2]=k,1&f)break b;break o;}if(i=1,1!=(0|e))break e;if(!(1&a[A+332|0]))break i;break e;}if(i=1,1!=(0|e))break b;if(!(1&a[A+332|0]))break o;break b;}if(1&f)break b;}i=i+-1|0,t[A>>2]=i,i=(i<<4)+A|0,f=i+12|0,k=t[f+4>>2],e=l+8|0,t[e>>2]=t[f>>2],t[e+4>>2]=k,e=i+4|0,f=t[e+4>>2],t[l>>2]=t[e>>2],t[l+4>>2]=f,l=i+92|0,k=t[l+4>>2],e=A+84|0,f=e+8|0,t[f>>2]=t[l>>2],t[f+4>>2]=k,f=i+84|0,l=t[f+4>>2],t[e>>2]=t[f>>2],t[e+4>>2]=l,l=i+172|0,k=t[l+4>>2],e=A+164|0,f=e+8|0,t[f>>2]=t[l>>2],t[f+4>>2]=k,i=i+164|0,f=t[i+4>>2],t[e>>2]=t[i>>2],t[e+4>>2]=f;}if(i=0,C[F>>2]>=B(0)^1|C[A+340>>2]>=B(0)^1|C[A+344>>2]>=B(0)^1)break r;i=s>=B(0);break r;}i=i+-1|0,t[A>>2]=i,e=(i<<4)+A|0,d=e+12|0,G=t[d+4>>2],u=n+8|0,t[u>>2]=t[d>>2],t[u+4>>2]=G,u=e+4|0,d=t[u+4>>2],t[n>>2]=t[u>>2],t[n+4>>2]=d,u=e+92|0,d=t[u+4>>2],n=v+8|0,t[n>>2]=t[u>>2],t[n+4>>2]=d,n=e+84|0,u=t[n+4>>2],t[v>>2]=t[n>>2],t[v+4>>2]=u,v=e+172|0,u=t[v+4>>2],n=m+8|0,t[n>>2]=t[v>>2],t[n+4>>2]=u,e=e+164|0,n=t[e+4>>2],t[m>>2]=t[e>>2],t[m+4>>2]=n;}if(2&f)break a;}if(i=i+-1|0,t[A>>2]=i,e=(i<<4)+A|0,v=e+12|0,m=t[v+4>>2],n=k+8|0,t[n>>2]=t[v>>2],t[n+4>>2]=m,n=e+4|0,v=t[n+4>>2],t[k>>2]=t[n>>2],t[k+4>>2]=v,n=e+92|0,v=t[n+4>>2],k=o+8|0,t[k>>2]=t[n>>2],t[k+4>>2]=v,k=e+84|0,n=t[k+4>>2],t[o>>2]=t[k>>2],t[o+4>>2]=n,n=e+172|0,o=t[n+4>>2],k=h+8|0,t[k>>2]=t[n>>2],t[k+4>>2]=o,e=e+164|0,k=t[e+4>>2],t[h>>2]=t[e>>2],t[h+4>>2]=k,1&f)break e;break i;}if(1&f)break e;}i=i+-1|0,t[A>>2]=i,i=(i<<4)+A|0,f=i+12|0,k=t[f+4>>2],e=l+8|0,t[e>>2]=t[f>>2],t[e+4>>2]=k,e=i+4|0,f=t[e+4>>2],t[l>>2]=t[e>>2],t[l+4>>2]=f,l=i+92|0,k=t[l+4>>2],e=A+84|0,f=e+8|0,t[f>>2]=t[l>>2],t[f+4>>2]=k,f=i+84|0,l=t[f+4>>2],t[e>>2]=t[f>>2],t[e+4>>2]=l,l=i+172|0,k=t[l+4>>2],e=A+164|0,f=e+8|0,t[f>>2]=t[l>>2],t[f+4>>2]=k,i=i+164|0,f=t[i+4>>2],t[e>>2]=t[i>>2],t[e+4>>2]=f;}i=0,C[F>>2]>=B(0)^1|s>=B(0)^1|c>=B(0)^1||(i=C[A+348>>2]>=B(0));}a[A+312|0]=i;}return E=r+16|0,0!=(255&i);}function Xe(A,r,e,i,f){var n,o,k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),E=B(0),N=B(0);n=-16&b[f+16|0],a[f+16|0]=n,Y=C[i>>2],v=C[r>>2],G=B(Y-v),d=C[A>>2],k=B(d-v),E=C[i+4>>2],g=C[r+4>>2],h=B(E-g),l=C[A+4>>2],c=B(l-g),N=C[i+8>>2],_=C[r+8>>2],y=B(N-_),m=C[A+8>>2],u=B(m-_),s=B(B(B(G*k)+B(h*c))+B(y*u)),o=f,w=C[e>>2],Q=B(w-v),W=C[e+4>>2],p=B(W-g),F=C[e+8>>2],D=B(F-_),c=B(B(B(Q*k)+B(p*c))+B(D*u)),c<=B(0)^1|s<=B(0)^1?(k=B(d-w),u=B(l-W),R=B(m-F),Z=B(B(B(G*k)+B(h*u))+B(y*R)),u=B(B(B(Q*k)+B(p*u))+B(D*R)),u>=B(0)^1|Z<=u^1?(R=B(B(c*Z)-B(u*s)),u<=B(0)^1|c>=B(0)^1||(k=B(0),!(R<=B(0)))?(k=B(d-Y),l=B(l-E),m=B(m-N),d=B(B(B(Q*k)+B(p*l))+B(D*m)),k=B(B(B(G*k)+B(h*l))+B(y*m)),k>=B(0)^1|d<=k^1?(l=B(B(d*s)-B(c*k)),k<=B(0)^1|s>=B(0)^1||(c=B(0),!(l<=B(0)))?(s=B(B(u*k)-B(d*Z)),s<=B(0)&&(c=B(Z-u),c>=B(0)&&(k=B(d-k),k>=B(0)))?(t[f+12>>2]=0,a[f+16|0]=6|n,k=B(c/B(c+k)),C[f+8>>2]=F+B(B(N-F)*k),C[f+4>>2]=W+B(B(E-W)*k),C[f>>2]=w+B(B(Y-w)*k),c=B(B(1)-k),u=B(0)):(t[f+12>>2]=0,a[f+16|0]=7|n,c=B(B(1)/B(R+B(s+l))),k=B(R*c),c=B(l*c),C[f+8>>2]=B(y*k)+B(_+B(D*c)),C[f+4>>2]=B(h*k)+B(g+B(p*c)),C[f>>2]=B(G*k)+B(v+B(Q*c)),u=B(B(B(1)-c)-k))):(t[f+12>>2]=0,a[f+16|0]=5|n,k=B(s/B(s-k)),C[f+8>>2]=_+B(y*k),C[f+4>>2]=g+B(h*k),C[f>>2]=v+B(G*k),u=B(B(1)-k))):(A=t[i+4>>2],t[f>>2]=t[i>>2],t[f+4>>2]=A,A=i+8|0,r=t[A+4>>2],e=f+8|0,t[e>>2]=t[A>>2],t[e+4>>2]=r,a[f+16|0]=4|n,k=B(1),c=B(0),u=B(0))):(t[f+12>>2]=0,a[f+16|0]=3|n,c=B(c/B(c-u)),C[f+8>>2]=_+B(D*c),C[f+4>>2]=g+B(p*c),C[f>>2]=v+B(Q*c),u=B(B(1)-c))):(A=t[e+4>>2],t[f>>2]=t[e>>2],t[f+4>>2]=A,A=e+8|0,r=t[A+4>>2],e=f+8|0,t[e>>2]=t[A>>2],t[e+4>>2]=r,a[f+16|0]=2|n,c=B(1),k=B(0),u=B(0))):(A=t[r+4>>2],t[f>>2]=t[r>>2],t[f+4>>2]=A,A=r+8|0,r=t[A+4>>2],e=f+8|0,t[e>>2]=t[A>>2],t[e+4>>2]=r,a[f+16|0]=1|n,c=B(0),k=B(0),u=B(1)),C[o+20>>2]=u,t[f+32>>2]=0,C[f+28>>2]=k,C[f+24>>2]=c;}function Me(A,r){var e,i,a,f=0;return i=Je(A),e=A+284|0,a=t[e+4>>2],f=r+8|0,t[f>>2]=t[e>>2],t[f+4>>2]=a,f=t[A+280>>2],t[r>>2]=t[A+276>>2],t[r+4>>2]=f,i;}function xe(A,r){var e,i=0,a=B(0),f=B(0),n=0,b=0,o=B(0),k=B(0),c=B(0),u=B(0);e=t[A>>2];A:{if((0|e)>=1)for(i=A+8|0,o=C[A+308>>2],k=C[r+8>>2],c=C[r+4>>2],u=C[r>>2];;){if(a=B(u-C[i+-4>>2]),f=B(a*a),a=B(c-C[i>>2]),f=B(f+B(a*a)),a=B(k-C[i+4>>2]),n=1,B(f+B(a*a))<=o)break A;if(i=i+16|0,b=b+1|0,!((0|b)<(0|e)))break;}n=0;}return i=n,C[r+12>>2]!=C[A+304>>2]|C[r+8>>2]!=C[A+300>>2]|C[r+4>>2]!=C[A+296>>2]|C[r>>2]!=C[A+292>>2]||(i=1),i;}function Se(A,r,e){var i=0,a=0;Je(A),i=t[A+248>>2],t[r>>2]=t[A+244>>2],t[r+4>>2]=i,i=A+252|0,a=t[i+4>>2],r=r+8|0,t[r>>2]=t[i>>2],t[r+4>>2]=a,i=A+268|0,a=t[i+4>>2],r=e+8|0,t[r>>2]=t[i>>2],t[r+4>>2]=a,r=t[A+264>>2],t[e>>2]=t[A+260>>2],t[e+4>>2]=r;}function Te(A,r,e,i,f){var n,b=B(0),o=B(0);return t[A>>2]=14972,t[A+32>>2]=e,t[A+28>>2]=r,t[A+24>>2]=i,t[A+20>>2]=f,t[A+4>>2]=0,t[A+8>>2]=1065353216,i=A+12|0,t[i>>2]=0,t[i+4>>2]=0,t[A+36>>2]=t[r+4>>2],t[A+40>>2]=t[e+4>>2],n=A,o=B(yf[t[t[r>>2]+48>>2]](r)),C[n+44>>2]=o,b=B(yf[t[t[e>>2]+48>>2]](e)),t[A+72>>2]=1,t[A+76>>2]=1,t[A+60>>2]=-1,a[A+52|0]=0,C[A+48>>2]=b,A;}function Ue(A,r,e,i,a){A|=0,r|=0,e|=0,i|=0,function(A,r,e,i){var a=0,f=0,n=B(0),o=0,k=B(0),c=0,u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=0,m=B(0),R=B(0),G=0,h=0,y=0,p=B(0),D=B(0),w=0,W=0,F=0,Z=0,Y=0,N=0,V=0,I=0,J=0,X=0,M=0,x=0,S=0,T=0,U=0,j=0,O=0,H=0,z=0,P=0,L=0,K=0,q=0,$=0,AA=0,rA=0,eA=B(0),iA=B(0),aA=B(0),fA=B(0),nA=B(0),tA=B(0),bA=0,oA=0,kA=0,cA=0,uA=0,lA=0,sA=B(0),dA=B(0),vA=B(0),CA=B(0),gA=B(0),_A=B(0),BA=B(0),mA=B(0),RA=B(0),GA=B(0),hA=B(0),QA=B(0),pA=B(0),DA=B(0),wA=B(0),WA=B(0),FA=B(0),ZA=B(0),YA=B(0),EA=B(0);for(a=E-272|0,E=a,t[A+56>>2]=0,o=a+264|0,t[o>>2]=0,t[o+4>>2]=0,t[a+256>>2]=0,t[a+260>>2]=0,Z=r+8|0,f=Z,c=t[f+4>>2],Y=a+168|0,o=Y,t[o>>2]=t[f>>2],t[o+4>>2]=c,N=r+24|0,f=N,c=t[f+4>>2],V=a+184|0,o=V,t[o>>2]=t[f>>2],t[o+4>>2]=c,I=r+40|0,f=I,c=t[f+4>>2],J=a+200|0,o=J,t[o>>2]=t[f>>2],t[o+4>>2]=c,f=r+56|0,c=t[f+4>>2],_=a+216|0,o=_,t[o>>2]=t[f>>2],t[o+4>>2]=c,o=t[r+4>>2],t[a+160>>2]=t[r>>2],t[a+164>>2]=o,o=t[r+20>>2],t[a+176>>2]=t[r+16>>2],t[a+180>>2]=o,o=t[r+36>>2],t[a+192>>2]=t[r+32>>2],t[a+196>>2]=o,o=t[r+52>>2],t[a+208>>2]=t[r+48>>2],t[a+212>>2]=o,X=r+72|0,f=X,c=t[f+4>>2],M=a+104|0,o=M,t[o>>2]=t[f>>2],t[o+4>>2]=c,x=r+88|0,f=x,c=t[f+4>>2],S=a+120|0,o=S,t[o>>2]=t[f>>2],t[o+4>>2]=c,T=r+104|0,f=T,c=t[f+4>>2],U=a+136|0,o=U,t[o>>2]=t[f>>2],t[o+4>>2]=c,f=r+120|0,c=t[f+4>>2],G=a+152|0,o=G,t[o>>2]=t[f>>2],t[o+4>>2]=c,o=r+112|0,f=t[o+4>>2],t[a+144>>2]=t[o>>2],t[a+148>>2]=f,o=t[r+68>>2],t[a+96>>2]=t[r+64>>2],t[a+100>>2]=o,j=r+80|0,o=j,f=t[o+4>>2],t[a+112>>2]=t[o>>2],t[a+116>>2]=f,O=r+96|0,o=O,f=t[o+4>>2],t[a+128>>2]=t[o>>2],t[a+132>>2]=f,k=C[_>>2],w=a+212|0,n=C[w>>2],W=a+148|0,u=C[W>>2],iA=B(B(n+u)*B(.5)),C[w>>2]=n-iA,n=k,k=C[G>>2],aA=B(B(n+k)*B(.5)),C[_>>2]=n-aA,C[W>>2]=u-iA,C[G>>2]=k-aA,k=C[a+208>>2],n=C[a+144>>2],fA=B(B(k+n)*B(.5)),C[a+208>>2]=k-fA,C[a+144>>2]=n-fA,H=t[t[A+28>>2]+4>>2]+-17>>>0<=1?t[t[A+32>>2]+4>>2]+-17>>>0<2:H,t[A+68>>2]=0,t[A+4>>2]=0,t[A+8>>2]=1065353216,t[A+60>>2]=-1,t[A+64>>2]=0,F=A+12|0,o=F,t[o>>2]=0,t[o+4>>2]=0,t[436]=t[436]+1,d=C[A+44>>2],k=C[A+48>>2],z=b[A+52|0],Ve(t[A+24>>2]),v=z?B(0):k,o=A+4|0,k=B(0xde0b6b000000000),P=r+84|0,L=r+68|0,K=r+100|0,q=r- -64|0,$=A+28|0,AA=r+128|0,f=0;;){t[a+252>>2]=0,l=C[o>>2],s=B(-l),c=A+8|0,n=C[c>>2],u=C[F>>2],C[a+248>>2]=B(B(C[Z>>2]*s)-B(C[N>>2]*n))-B(C[I>>2]*u),C[a+244>>2]=B(B(C[r+4>>2]*s)-B(n*C[r+20>>2]))-B(u*C[r+36>>2]),C[a+240>>2]=B(B(C[r>>2]*s)-B(n*C[r+16>>2]))-B(u*C[r+32>>2]),t[a+236>>2]=0,C[a+232>>2]=B(B(l*C[X>>2])+B(n*C[x>>2]))+B(u*C[T>>2]),C[a+228>>2]=B(B(l*C[L>>2])+B(n*C[P>>2]))+B(u*C[K>>2]),C[a+224>>2]=B(B(l*C[q>>2])+B(n*C[j>>2]))+B(u*C[O>>2]),yA(a+80|0,t[$>>2],a+240|0),yA(a- -64|0,t[A+32>>2],a+224|0),t[a+60>>2]=0,y=a+56|0,n=C[a+80>>2],l=C[a+84>>2],s=C[a+88>>2],u=B(B(B(B(n*C[a+192>>2])+B(l*C[a+196>>2]))+B(s*C[J>>2]))+C[_>>2]),C[y>>2]=u,m=B(B(B(B(n*C[a+176>>2])+B(l*C[a+180>>2]))+B(s*C[V>>2]))+C[w>>2]),C[a+52>>2]=m,D=B(B(B(B(n*C[a+160>>2])+B(l*C[a+164>>2]))+B(s*C[Y>>2]))+C[a+208>>2]),C[a+48>>2]=D,t[a+44>>2]=0,h=a+40|0,n=C[a+64>>2],s=C[a+68>>2],g=C[a+72>>2],l=B(B(B(B(n*C[a+128>>2])+B(s*C[a+132>>2]))+B(g*C[U>>2]))+C[G>>2]),C[h>>2]=l,p=B(B(B(B(n*C[a+112>>2])+B(s*C[a+116>>2]))+B(g*C[S>>2]))+C[W>>2]),C[a+36>>2]=p,n=B(B(B(B(n*C[a+96>>2])+B(s*C[a+100>>2]))+B(g*C[M>>2]))+C[a+144>>2]),C[a+32>>2]=n,H&&(t[h>>2]=0,t[y>>2]=0,l=B(0),u=B(0)),t[a+28>>2]=0,u=B(u-l),C[a+24>>2]=u,l=B(m-p),C[a+20>>2]=l,s=C[c>>2],n=B(D-n),C[a+16>>2]=n;A:if(n=B(B(B(n*C[o>>2])+B(l*s))+B(u*C[F>>2])),n>B(0)^1|B(n*n)>B(k*C[AA>>2])^1){if(y=A+24|0,!xe(t[y>>2],a+16|0)){r:{e:{if(n=B(k-n),!(n<=B(k*B(9.999999974752427e-7)))){if(Ie(t[y>>2],a+16|0,a+48|0,a+32|0),!Me(t[y>>2],a))break e;if(n=C[a>>2],R=B(n*n),n=C[a+4>>2],R=B(R+B(n*n)),c=a+8|0,n=C[c>>2],n=B(R+B(n*n)),!(n<B(9.999999974752427e-7)))break r;f=t[a+4>>2],t[o>>2]=t[a>>2],t[o+4>>2]=f,t[A+68>>2]=6,_=t[c+4>>2],f=o+8|0,t[f>>2]=t[c>>2],t[f+4>>2]=_,f=1;break A;}f=1,t[A+68>>2]=n<=B(0)^1?11:2;break A;}t[A+68>>2]=3,f=1;break A;}r:{if(!(B(k-n)<=B(k*B(1.1920928955078125e-7)))){if(h=t[a+4>>2],t[o>>2]=t[a>>2],t[o+4>>2]=h,rA=t[c+4>>2],h=o+8|0,t[h>>2]=t[c>>2],t[h+4>>2]=rA,h=A- -64|0,c=t[h>>2],t[h>>2]=c+1,(0|c)<=1e3){if(4!=t[t[y>>2]>>2])break r;t[A+68>>2]=13;}k=n;break A;}t[A+68>>2]=12,f=1,k=n;break A;}k=n;continue;}f=1,t[A+68>>2]=1;}else t[A+68>>2]=10,f=1;break;}n=B(0),u=z?B(0):d,l=B(u+v),_=0,c=0,f&&(Se(t[A+24>>2],a+240|0,a+224|0),c=o+8|0,G=t[c+4>>2],f=a+264|0,t[f>>2]=t[c>>2],t[f+4>>2]=G,f=t[o+4>>2],t[a+256>>2]=t[o>>2],t[a+260>>2]=f,n=C[A+4>>2],s=C[A+8>>2],g=C[A+12>>2],d=B(B(B(n*n)+B(s*s))+B(g*g)),d<B(9.999999974752427e-7)&&(t[A+68>>2]=5),f=1,d>B(1.4210854715202004e-14)?(c=a+264|0,d=B(B(1)/B(Q(d))),C[c>>2]=d*C[c>>2],C[a+256>>2]=d*C[a+256>>2],C[a+260>>2]=d*C[a+260>>2],m=B(Q(k)),k=B(u/m),C[a+240>>2]=C[a+240>>2]-B(k*n),C[a+244>>2]=C[a+244>>2]-B(k*s),C[a+248>>2]=C[a+248>>2]-B(k*g),k=B(v/m),C[a+224>>2]=B(k*n)+C[a+224>>2],C[a+228>>2]=B(k*s)+C[a+228>>2],C[a+232>>2]=B(k*g)+C[a+232>>2],c=1,n=B(B(B(1)/d)-l)):(c=0,f=2,n=B(0)),t[A+60>>2]=f),!t[A+68>>2]|!t[A+72>>2]|!t[A+20>>2]||(_=B(l+n)<C[796]),f=1^c;A:{r:{e:{i:{a:if((f||_)&&(_=t[A+20>>2],_)){G=o+8|0,t[G>>2]=0,t[G+4>>2]=0,t[o>>2]=0,t[o+4>>2]=0,t[435]=t[435]+1;f:{n:{t:{if(yf[t[t[_>>2]+8>>2]](_,t[A+24>>2],t[A+28>>2],t[A+32>>2],a+160|0,a+96|0,o,a+80|0,a- -64|0,i)){if(g=B(0),k=C[a+64>>2],d=C[a+80>>2],v=B(k-d),m=C[a+68>>2],D=C[a+84>>2],s=B(m-D),p=C[a+72>>2],eA=C[a+88>>2],u=B(p-eA),l=B(B(B(v*v)+B(s*s))+B(u*u)),l<=B(1.4210854715202004e-14)&&(g=C[A+16>>2],v=C[A+4>>2],s=C[A+8>>2],u=C[A+12>>2],l=B(B(B(v*v)+B(s*s))+B(u*u))),!(l>B(1.4210854715202004e-14)))break t;if(i=A+60|0,t[i>>2]=3,k=B(d-k),R=B(k*k),k=B(D-m),R=B(R+B(k*k)),k=B(eA-p),k=B(-B(Q(B(R+B(k*k))))),(n>k^-1)&(1^f))break n;if(C[a+268>>2]=g,n=B(B(1)/B(Q(l))),C[a+264>>2]=u*n,f=a+88|0,c=t[f+4>>2],i=a+248|0,t[i>>2]=t[f>>2],t[i+4>>2]=c,f=a+72|0,c=t[f+4>>2],i=a+232|0,t[i>>2]=t[f>>2],t[i+4>>2]=c,i=t[a+84>>2],t[a+240>>2]=t[a+80>>2],t[a+244>>2]=i,i=t[a+68>>2],t[a+224>>2]=t[a+64>>2],t[a+228>>2]=i,C[a+260>>2]=s*n,C[a+256>>2]=v*n,n=k,!(n<B(0)))break e;break r;}if(s=C[A+4>>2],g=C[A+8>>2],d=C[A+12>>2],!(B(B(B(s*s)+B(g*g))+B(d*d))>B(0)))break a;if(k=B(C[a+80>>2]-C[a+64>>2]),R=B(k*k),k=B(C[a+84>>2]-C[a+68>>2]),R=B(R+B(k*k)),k=B(C[a+88>>2]-C[a+72>>2]),k=B(B(Q(B(R+B(k*k))))-l),(k<n^-1)&(1^f))break f;if(c=a+88|0,_=t[c+4>>2],i=a+248|0,f=i,t[f>>2]=t[c>>2],t[f+4>>2]=_,_=a+72|0,G=t[_+4>>2],f=a+232|0,t[f>>2]=t[_>>2],t[f+4>>2]=G,C[i>>2]=C[i>>2]-B(u*d),i=t[a+68>>2],t[a+224>>2]=t[a+64>>2],t[a+228>>2]=i,i=t[a+84>>2],t[a+240>>2]=t[a+80>>2],t[a+244>>2]=i,C[a+228>>2]=B(v*g)+C[a+228>>2],C[a+224>>2]=B(v*s)+C[a+224>>2],C[a+240>>2]=C[a+240>>2]-B(u*s),C[a+244>>2]=C[a+244>>2]-B(u*g),C[f>>2]=B(v*d)+C[f>>2],c=o+8|0,_=t[c+4>>2],i=a+264|0,f=i,t[f>>2]=t[c>>2],t[f+4>>2]=_,f=t[o+4>>2],t[a+256>>2]=t[o>>2],t[a+260>>2]=f,u=C[a+256>>2],l=C[a+260>>2],v=C[i>>2],n=B(B(1)/B(Q(B(B(B(u*u)+B(l*l))+B(v*v))))),C[i>>2]=v*n,C[a+260>>2]=l*n,C[a+256>>2]=u*n,t[A+60>>2]=6,n=k,!(n<B(0)))break e;break r;}if(t[A+60>>2]=9,!c)break A;break i;}if(t[i>>2]=8,c)break i;break A;}t[A+60>>2]=5;}if(!c)break A;}if(n<B(0))break r;}if(!(B(n*n)<C[r+128>>2]))break A;}return i=t[a+260>>2],t[o>>2]=t[a+256>>2],t[o+4>>2]=i,C[A+56>>2]=n,f=a+264|0,c=t[f+4>>2],o=o+8|0,t[o>>2]=t[f>>2],t[o+4>>2]=c,t[a+92>>2]=0,l=C[a+256>>2],o=r+8|0,k=C[a+260>>2],c=r+24|0,u=C[f>>2],_=r+40|0,C[a+88>>2]=B(B(l*C[o>>2])+B(k*C[c>>2]))+B(u*C[_>>2]),G=r+4|0,y=r+20|0,w=r+36|0,C[a+84>>2]=B(B(l*C[G>>2])+B(k*C[y>>2]))+B(u*C[w>>2]),W=r+16|0,H=r+32|0,C[a+80>>2]=B(B(l*C[r>>2])+B(k*C[W>>2]))+B(u*C[H>>2]),t[a+76>>2]=0,F=r+72|0,l=B(-l),z=r+88|0,Y=r+104|0,C[a+72>>2]=B(B(C[F>>2]*l)-B(k*C[z>>2]))-B(u*C[Y>>2]),Z=r+68|0,V=r+84|0,N=r+100|0,C[a+68>>2]=B(B(C[Z>>2]*l)-B(k*C[V>>2]))-B(u*C[N>>2]),J=r- -64|0,I=r+80|0,M=r+96|0,C[a+64>>2]=B(B(C[J>>2]*l)-B(k*C[I>>2]))-B(u*C[M>>2]),X=A+28|0,yA(a+48|0,t[X>>2],a+80|0),S=A+32|0,yA(a+32|0,t[S>>2],a- -64|0),x=a+216|0,eA=C[x>>2],U=a+200|0,sA=C[U>>2],T=a+192|0,dA=C[T>>2],j=a+196|0,vA=C[j>>2],O=a+152|0,CA=C[O>>2],P=a+136|0,gA=C[P>>2],L=a+128|0,_A=C[L>>2],K=a+132|0,BA=C[K>>2],q=a+208|0,mA=C[q>>2],$=a+168|0,RA=C[$>>2],AA=a+144|0,GA=C[AA>>2],h=a+104|0,hA=C[h>>2],rA=a+212|0,QA=C[rA>>2],bA=a+184|0,pA=C[bA>>2],oA=a+176|0,DA=C[oA>>2],kA=a+180|0,wA=C[kA>>2],cA=a+148|0,WA=C[cA>>2],uA=a+120|0,FA=C[uA>>2],lA=a+112|0,ZA=C[lA>>2],i=a+116|0,YA=C[i>>2],k=C[f>>2],EA=C[a+160>>2],nA=C[a+164>>2],tA=C[a+96>>2],R=C[a+100>>2],v=C[a+56>>2],s=C[a+48>>2],g=C[a+52>>2],d=C[a+40>>2],m=C[a+32>>2],D=C[a+36>>2],l=C[a+256>>2],u=C[a+260>>2],t[a+92>>2]=0,p=B(-l),C[a+88>>2]=B(B(C[o>>2]*p)-B(u*C[c>>2]))-B(k*C[_>>2]),C[a+84>>2]=B(B(C[G>>2]*p)-B(u*C[y>>2]))-B(k*C[w>>2]),C[a+80>>2]=B(B(C[r>>2]*p)-B(u*C[W>>2]))-B(k*C[H>>2]),t[a+76>>2]=0,C[a+72>>2]=B(B(l*C[F>>2])+B(u*C[z>>2]))+B(k*C[Y>>2]),C[a+68>>2]=B(B(l*C[Z>>2])+B(u*C[V>>2]))+B(k*C[N>>2]),C[a+64>>2]=B(B(l*C[J>>2])+B(u*C[I>>2]))+B(k*C[M>>2]),yA(a+48|0,t[X>>2],a+80|0),yA(a+32|0,t[S>>2],a- -64|0),nA=B(B(B(B(B(mA+B(B(B(s*EA)+B(g*nA))+B(v*RA)))-B(GA+B(B(B(m*tA)+B(D*R))+B(d*hA))))*p)-B(u*B(B(QA+B(B(B(s*DA)+B(g*wA))+B(v*pA)))-B(WA+B(B(B(m*ZA)+B(D*YA))+B(d*FA))))))-B(k*B(B(eA+B(B(B(s*dA)+B(g*vA))+B(v*sA)))-B(CA+B(B(B(m*_A)+B(D*BA))+B(d*gA)))))),k=C[a+48>>2],u=C[a+52>>2],l=C[a+56>>2],v=C[a+32>>2],s=C[a+36>>2],g=C[a+40>>2],d=C[a+256>>2],m=C[a+260>>2],tA=B(B(B(B(B(B(B(k*C[a+160>>2])+B(u*C[a+164>>2]))+B(l*C[$>>2]))+C[q>>2])-B(B(B(B(v*C[a+96>>2])+B(s*C[a+100>>2]))+B(g*C[h>>2]))+C[AA>>2]))*d)+B(B(B(B(B(B(k*C[oA>>2])+B(u*C[kA>>2]))+B(l*C[bA>>2]))+C[rA>>2])-B(B(B(B(v*C[lA>>2])+B(s*C[i>>2]))+B(g*C[uA>>2]))+C[cA>>2]))*m)),R=B(B(B(B(B(k*C[T>>2])+B(u*C[j>>2]))+B(l*C[U>>2]))+C[x>>2])-B(B(B(B(v*C[L>>2])+B(s*C[K>>2]))+B(g*C[P>>2]))+C[O>>2])),k=C[f>>2],nA>B(tA+B(R*k))&&(C[f>>2]=-k,t[A+60>>2]=10,C[a+260>>2]=-m,C[a+256>>2]=-d),t[a+92>>2]=0,C[a+88>>2]=aA+C[a+232>>2],C[a+84>>2]=iA+C[a+228>>2],C[a+80>>2]=fA+C[a+224>>2],yf[t[t[e>>2]+16>>2]](e,a+256|0,a+80|0,n),void(E=a+272|0);}E=a+272|0;}(A,r,e,i);}function je(){b[2752]||(t[606]=1062847606,t[607]=0,t[604]=1042701022,t[605]=1056964440,t[602]=1062847606,t[603]=0,t[600]=-1093024784,t[601]=1050556081,t[598]=1062847606,t[599]=0,t[596]=-1093024784,t[597]=-1096927567,t[594]=1062847606,t[595]=0,t[592]=1042701022,t[593]=-1090519208,t[590]=1062847572,t[591]=0,t[588]=1057396286,t[589]=0,t[586]=1057396386,t[587]=0,t[584]=1060121912,t[585]=1056964507,t[582]=1057396420,t[583]=0,t[580]=-1098475836,t[581]=1062148969,t[578]=1057396386,t[579]=0,t[576]=-1084636143,t[577]=0,t[574]=1057396420,t[575]=0,t[572]=-1098475836,t[573]=-1085334679,t[570]=1057396386,t[571]=0,t[568]=1060121912,t[569]=-1090519141,t[566]=-2147483648,t[567]=0,t[564]=1058437413,t[565]=1062149053,t[562]=-2147483648,t[563]=0,t[560]=-2147483648,t[561]=1065353216,t[558]=-2147483648,t[559]=0,t[556]=-1089046235,t[557]=1062149053,t[554]=-2147483648,t[555]=0,t[552]=-1082951543,t[553]=1050556148,t[550]=-2147483648,t[551]=0,t[548]=-1082951543,t[549]=-1096927500,t[546]=0,t[547]=0,t[544]=-1089046235,t[545]=-1085334595,t[542]=0,t[543]=0,t[540]=0,t[541]=-1082130432,t[538]=0,t[539]=0,t[536]=1058437413,t[537]=-1085334595,t[534]=0,t[535]=0,t[532]=1064532105,t[533]=-1096927500,t[530]=0,t[531]=0,t[528]=1064532105,t[529]=1050556148,t[526]=-1090087228,t[527]=0,t[524]=1049007812,t[525]=1062148969,t[522]=-1090087262,t[523]=0,t[520]=-1087361736,t[521]=1056964507,t[518]=-1084636042,t[519]=0,t[516]=-1104782626,t[517]=1056964440,t[514]=-1090087262,t[515]=0,t[512]=-1087361736,t[513]=-1090519141,t[510]=-1084636076,t[511]=0,t[508]=-1090087362,t[509]=-2147483648,t[506]=-1090087262,t[507]=0,t[504]=1062847505,t[505]=-2147483648,t[502]=-1084636042,t[503]=0,t[500]=1054458864,t[501]=1050556081,t[498]=-1090087228,t[499]=0,t[496]=1049007812,t[497]=-1085334679,t[494]=-1084636042,t[495]=0,t[492]=-1104782626,t[493]=-1090519208,t[490]=-1084636042,t[491]=0,t[488]=1054458864,t[489]=-1096927567,t[486]=1065353216,t[487]=0,t[484]=-2147483648,t[485]=0,t[482]=1055193471,t[483]=0,t[480]=1063581978,t[481]=0,t[478]=1055193572,t[479]=0,t[476]=1049461434,t[477]=1062847522,t[474]=1055193572,t[475]=0,t[472]=-1086767520,t[473]=1057396202,t[470]=1055193572,t[471]=0,t[468]=-1086767520,t[469]=-1090087446,t[466]=1055193605,t[467]=0,t[464]=1049461434,t[465]=-1084636126,t[462]=-1092290076,t[463]=0,t[460]=1060716128,t[461]=1057396202,t[458]=-1092290043,t[459]=0,t[456]=-1098022214,t[457]=1062847522,t[454]=-1092290177,t[455]=0,t[452]=-1083901670,t[453]=-2147483648,t[450]=-1092290076,t[451]=0,t[448]=-1098022214,t[449]=-1084636126,t[446]=-1092290076,t[447]=0,t[444]=1060716128,t[445]=-1090087446,t[442]=-1082130432,t[443]=0,t[440]=0,t[441]=-2147483648,a[2752]=1);}function Oe(A,r,e,i){var f=0,n=0,o=0,k=0,c=0,u=B(0),l=0,s=0,d=0,v=0,g=B(0),_=B(0),m=0,R=0,G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=0,w=B(0),W=B(0),F=B(0),Z=0;A:if(D=t[A+4>>2],!((0|D)<2))for(k=t[A+12>>2],f=k+(D<<4)|0,G=C[f+-16>>2],w=C[e>>2],g=C[f+-12>>2],W=C[e+4>>2],_=C[f+-8>>2],F=C[e+8>>2],u=B(B(B(B(G*w)+B(g*W))+B(_*F))+i),R=r+8|0,c=r+12|0;;){f=(Z<<4)+k|0,h=C[f>>2],y=C[f+4>>2],Q=C[f+8>>2],p=B(B(B(B(h*w)+B(y*W))+B(Q*F))+i),m=t[f+12>>2];r:{e:{i:{a:{f:{n:{t:{b:{o:{k:{c:{u:{l:{s:{d:{v:{C:{g:{_:{if(u<B(0)){if(!(p<B(0)))break _;if(l=r+4|0,f=t[l>>2],(0|f)!=t[R>>2])break d;if(s=f?f<<1:1,(0|f)>=(0|s))break d;if(!s)break g;if(d=CA(s<<4,16),f=t[l>>2],(0|f)>=1)break C;break v;}if(!(p<B(0)))break r;if(u=B(u/B(u-p)),_=B(_+B(B(Q-_)*u)),g=B(g+B(B(y-g)*u)),u=B(G+B(B(h-G)*u)),s=r+4|0,f=t[s>>2],(0|f)!=t[R>>2])break c;if(l=f?f<<1:1,(0|f)>=(0|l))break c;if(!l)break s;if(d=CA(l<<4,16),f=t[s>>2],(0|f)>=1)break l;break u;}if(u=B(u/B(u-p)),_=B(_+B(B(Q-_)*u)),g=B(g+B(B(y-g)*u)),u=B(G+B(B(h-G)*u)),l=r+4|0,f=t[l>>2],(0|f)!=t[R>>2])break t;if(d=f?f<<1:1,(0|f)>=(0|d))break t;if(!d)break k;if(s=CA(d<<4,16),f=t[l>>2],(0|f)>=1)break o;break b;}if(d=0,(0|f)<1)break v;}for(k=0;n=t[c>>2]+k|0,v=t[n+4>>2],o=k+d|0,t[o>>2]=t[n>>2],t[o+4>>2]=v,n=n+8|0,v=t[n+4>>2],o=o+8|0,t[o>>2]=t[n>>2],t[o+4>>2]=v,k=k+16|0,f=f+-1|0,f;){}}f=t[c>>2],f&&(b[r+16|0]&&gA(f),t[c>>2]=0),t[c>>2]=d,a[r+16|0]=1,t[R>>2]=s,f=t[l>>2];}f=t[c>>2]+(f<<4)|0,t[f+12>>2]=m,C[f+8>>2]=Q,C[f+4>>2]=y,C[f>>2]=h;break e;}if(d=0,(0|f)<1)break u;}for(k=0;n=t[c>>2]+k|0,v=t[n+4>>2],o=k+d|0,t[o>>2]=t[n>>2],t[o+4>>2]=v,n=n+8|0,v=t[n+4>>2],o=o+8|0,t[o>>2]=t[n>>2],t[o+4>>2]=v,k=k+16|0,f=f+-1|0,f;){}}f=t[c>>2],f&&(b[r+16|0]&&gA(f),t[c>>2]=0),t[c>>2]=d,a[r+16|0]=1,t[R>>2]=l,f=t[s>>2];}if(f=t[c>>2]+(f<<4)|0,t[f+12>>2]=0,C[f+8>>2]=_,C[f+4>>2]=g,C[f>>2]=u,f=t[s>>2]+1|0,t[s>>2]=f,t[R>>2]!=(0|f))break i;if(l=f?f<<1:1,(0|f)>=(0|l))break i;if(!l)break n;if(d=CA(l<<4,16),f=t[s>>2],(0|f)>=1)break f;break a;}if(s=0,(0|f)<1)break b;}for(k=0;m=t[c>>2]+k|0,v=t[m+4>>2],n=k+s|0,t[n>>2]=t[m>>2],t[n+4>>2]=v,m=m+8|0,o=t[m+4>>2],n=n+8|0,t[n>>2]=t[m>>2],t[n+4>>2]=o,k=k+16|0,f=f+-1|0,f;){}}f=t[c>>2],f&&(b[r+16|0]&&gA(f),t[c>>2]=0),t[c>>2]=s,a[r+16|0]=1,t[R>>2]=d,f=t[l>>2];}f=t[c>>2]+(f<<4)|0,t[f+12>>2]=0,C[f+8>>2]=_,C[f+4>>2]=g,C[f>>2]=u;break e;}if(d=0,(0|f)<1)break a;}for(k=0;n=t[c>>2]+k|0,v=t[n+4>>2],o=k+d|0,t[o>>2]=t[n>>2],t[o+4>>2]=v,n=n+8|0,v=t[n+4>>2],o=o+8|0,t[o>>2]=t[n>>2],t[o+4>>2]=v,k=k+16|0,f=f+-1|0,f;){}}f=t[c>>2],f&&(b[r+16|0]&&gA(f),t[c>>2]=0),t[c>>2]=d,a[r+16|0]=1,t[R>>2]=l,f=t[s>>2];}f=t[c>>2]+(f<<4)|0,t[f+12>>2]=m,C[f+8>>2]=Q,C[f+4>>2]=y,C[f>>2]=h;}f=r+4|0,t[f>>2]=t[f>>2]+1;}if(Z=Z+1|0,(0|Z)==(0|D))break A;F=C[e+8>>2],W=C[e+4>>2],k=t[A+12>>2],w=C[e>>2],u=p,_=Q,g=y,G=h;}}function He(A,r,e,i,a,f,n){var t=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0);return t=C[i>>2],k=C[i+4>>2],c=C[i+8>>2],l=B(B(B(C[e>>2]*t)+B(C[e+4>>2]*k))+B(C[e+8>>2]*c)),b=B(B(B(t*C[A>>2])+B(k*C[A+16>>2]))+B(c*C[A+32>>2])),o=C[a+80>>2],u=B(b*(b<B(0)?B(-o):o)),b=B(B(B(t*C[A+4>>2])+B(k*C[A+20>>2]))+B(c*C[A+36>>2])),o=C[a+84>>2],u=B(u+B(b*(b<B(0)?B(-o):o))),b=B(B(B(t*C[A+8>>2])+B(k*C[A+24>>2]))+B(c*C[A+40>>2])),o=C[a+88>>2],b=B(u+B(b*(b<B(0)?B(-o):o))),o=C[a+96>>2],u=b>o?b:o,b=B(B(B(t*C[r>>2])+B(k*C[r+16>>2]))+B(c*C[r+32>>2])),o=C[f+80>>2],s=B(b*(b<B(0)?B(-o):o)),b=B(B(B(t*C[r+4>>2])+B(k*C[r+20>>2]))+B(c*C[r+36>>2])),o=C[f+84>>2],t=B(B(B(t*C[r+8>>2])+B(k*C[r+24>>2]))+B(c*C[r+40>>2])),k=C[f+88>>2],t=B(B(s+B(b*(b<B(0)?B(-o):o)))+B(t*(t<B(0)?B(-k):k))),k=C[f+96>>2],t=B(u+(t>k?t:k)),k=B(l+t),t=B(t-l),(k<t?k:t)>n^1;}function ze(A,r,e,i,f,n,o,k){var c,u=0,l=0,s=0,d=0,v=0,g=B(0),m=B(0),R=B(0),G=B(0),h=0,y=B(0),Q=B(0),p=0,D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=B(0),M=B(0),x=0,S=0,T=0,U=B(0),j=B(0),O=B(0),H=B(0),z=B(0),P=0,L=0,K=0,q=0,$=0,AA=0,rA=0,eA=0,iA=B(0),aA=B(0),fA=B(0);if(c=E-32|0,E=c,u=t[f+4>>2],(0|u)<=-1)for(t[f+8>>2]<=-1&&(d=t[f+12>>2],d&&(b[f+16|0]&&gA(d),t[f+12>>2]=0),a[f+16|0]=1,d=f+8|0,t[d>>2]=0,t[d+4>>2]=0),s=u<<4,d=f+12|0;p=t[c+20>>2],l=t[d>>2]+s|0,t[l>>2]=t[c+16>>2],t[l+4>>2]=p,v=c+24|0,p=t[v+4>>2],l=l+8|0,t[l>>2]=t[v>>2],t[l+4>>2]=p,s=s+16|0,u=u+1|0,u;){}if(d=0,t[f+4>>2]=0,l=t[i+4>>2],t[f+8>>2]<(0|l)){if(l&&(d=CA(l<<4,16),u=t[f+4>>2],!((0|u)<1)))for(s=0,p=f+12|0;v=t[p>>2]+s|0,x=t[v+4>>2],h=s+d|0,t[h>>2]=t[v>>2],t[h+4>>2]=x,v=v+8|0,S=t[v+4>>2],h=h+8|0,t[h>>2]=t[v>>2],t[h+4>>2]=S,s=s+16|0,u=u+-1|0,u;){}u=t[f+12>>2],u&&(b[f+16|0]&&gA(u),t[f+12>>2]=0),a[f+16|0]=1,t[f+12>>2]=d,t[f+8>>2]=l;}v=t[r+28>>2];A:if(!((0|v)<1)){for(s=t[r+36>>2]+20|0,D=C[e+40>>2],W=C[e+36>>2],F=C[e+24>>2],Z=C[e+20>>2],Y=C[A+8>>2],N=C[A+4>>2],V=C[A>>2],G=C[e+32>>2],w=C[e+16>>2],I=C[e+8>>2],J=C[e+4>>2],y=C[e>>2],u=0,R=B(3.4028234663852886e38),l=-1;m=C[s>>2],g=C[s+4>>2],Q=C[s+8>>2],m=B(B(B(B(B(B(m*y)+B(g*J))+B(Q*I))*V)+B(B(B(B(m*w)+B(g*Z))+B(Q*F))*N))+B(B(B(B(m*G)+B(g*W))+B(Q*D))*Y)),d=m<R,R=d?m:R,l=d?u:l,s=s+36|0,u=u+1|0,(0|u)<(0|v);){}if(!((0|l)<0)){l=t[r+36>>2]+_(l,36)|0,h=t[l+4>>2];r:{if((0|h)>=1){for(S=l+28|0,x=l+24|0,L=l+20|0,K=l+12|0,q=e+56|0,$=e+48|0,AA=e+52|0,rA=e+40|0,eA=e+32|0,v=0;;){if(d=f,s=t[r+16>>2],u=t[K>>2],f=s+(t[u+(v<<2)>>2]<<4)|0,R=C[f+8>>2],v=v+1|0,p=(0|h)==(0|v),u=s+(t[u+((p?0:v)<<2)>>2]<<4)|0,X=C[u+8>>2],m=C[f>>2],y=C[u>>2],g=C[f+4>>2],M=C[u+4>>2],iA=C[q>>2],aA=C[$>>2],fA=C[AA>>2],Q=C[rA>>2],D=C[eA>>2],W=C[e+36>>2],F=C[e+8>>2],Z=C[e+4>>2],Y=C[e+24>>2],N=C[e+16>>2],V=C[e+20>>2],G=C[S>>2],w=C[x>>2],I=C[L>>2],J=C[e>>2],t[c+28>>2]=0,y=B(m-y),M=B(g-M),X=B(R-X),U=B(B(B(J*y)+B(Z*M))+B(F*X)),j=B(B(B(N*I)+B(V*w))+B(Y*G)),O=B(B(B(y*N)+B(M*V))+B(X*Y)),H=B(B(B(J*I)+B(Z*w))+B(F*G)),z=B(B(U*j)-B(O*H)),C[c+24>>2]=-z,y=B(B(B(y*D)+B(M*W))+B(X*Q)),G=B(B(B(D*I)+B(W*w))+B(Q*G)),w=B(B(y*H)-B(U*G)),C[c+20>>2]=-w,G=B(-B(B(O*G)-B(y*j))),C[c+16>>2]=G,f=i,Oe(f,d,c+16|0,B(-B(B(B(B(aA+B(B(B(m*J)+B(g*Z))+B(R*F)))*G)-B(B(fA+B(B(B(m*N)+B(g*V))+B(R*Y)))*w))-B(B(iA+B(B(B(m*D)+B(g*W))+B(R*Q)))*z)))),u=t[f+4>>2],(0|u)<=-1)for(t[f+8>>2]<=-1&&(i=t[f+12>>2],i&&(b[f+16|0]&&gA(i),t[f+12>>2]=0),a[f+16|0]=1,i=f+8|0,t[i>>2]=0,t[i+4>>2]=0),s=u<<4;T=t[c+4>>2],i=t[f+12>>2]+s|0,t[i>>2]=t[c>>2],t[i+4>>2]=T,P=c+8|0,T=t[P+4>>2],i=i+8|0,t[i>>2]=t[P>>2],t[i+4>>2]=T,s=s+16|0,u=u+1|0,u;){}if(t[f+4>>2]=0,i=d,p)break;}if(f=t[d+4>>2],(0|f)>=1)break r;break A;}if(d=i,f=t[d+4>>2],(0|f)<1)break A;}for(R=C[l+20>>2],m=C[l+24>>2],g=C[l+28>>2],Q=B(B(B(R*C[e>>2])+B(m*C[e+4>>2]))+B(g*C[e+8>>2])),D=B(B(B(R*C[e+16>>2])+B(m*C[e+20>>2]))+B(g*C[e+24>>2])),R=B(B(B(R*C[e+32>>2])+B(m*C[e+36>>2]))+B(g*C[e+40>>2])),m=B(C[l+32>>2]-B(B(B(Q*C[e+48>>2])+B(D*C[e+52>>2]))+B(R*C[e+56>>2]))),u=0,i=d+12|0,l=0;r=t[i>>2]+u|0,e=r+8|0,g=B(m+B(B(B(Q*C[r>>2])+B(D*C[r+4>>2]))+B(R*C[e>>2]))),g=g<=n?n:g,g<=o&&(s=t[e+4>>2],f=c+24|0,t[f>>2]=t[e>>2],t[f+4>>2]=s,e=t[r+4>>2],t[c+16>>2]=t[r>>2],t[c+20>>2]=e,yf[t[t[k>>2]+16>>2]](k,A,c+16|0,g),f=t[d+4>>2]),u=u+16|0,l=l+1|0,(0|l)<(0|f);){}}}E=c+32|0;}function Pe(A,r,e,i){return t[A+12>>2]=e,t[A+8>>2]=r,t[A+4>>2]=i,t[A>>2]=15376,A;}function Le(A,r,e,i,f,n){A|=0,r|=0,e|=0,i|=0,f|=0,n|=0;var o,c,u=0,l=0,d=B(0),v=0,g=B(0),_=B(0),m=0,R=B(0),G=B(0),h=B(0),y=0,Q=0,p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=0,N=0,V=0,I=0;o=E-288|0,E=o,Ve(t[A+4>>2]),d=C[r+52>>2],g=C[e+52>>2],_=C[i+52>>2],R=C[f+52>>2],u=r+56|0,G=C[u>>2],h=C[e+56>>2],v=i+56|0,p=C[v>>2],D=C[f+56>>2],w=C[r+48>>2],W=C[e+48>>2],F=C[i+48>>2],Z=C[f+48>>2],a[o+264|0]=0,t[o+260>>2]=1566444395,t[o+224>>2]=15428,c=Te(o+144|0,t[A+8>>2],t[A+12>>2],t[A+4>>2],0),l=r+8|0,m=t[l+4>>2],A=o+16|0,t[A>>2]=t[l>>2],t[A+4>>2]=m,l=r+24|0,m=t[l+4>>2],A=o+32|0,t[A>>2]=t[l>>2],t[A+4>>2]=m,l=r+40|0,m=t[l+4>>2],A=o+48|0,t[A>>2]=t[l>>2],t[A+4>>2]=m,l=t[u+4>>2],A=o- -64|0,t[A>>2]=t[u>>2],t[A+4>>2]=l,u=i+8|0,l=t[u+4>>2],A=o+80|0,t[A>>2]=t[u>>2],t[A+4>>2]=l,t[o+136>>2]=1566444395,A=t[r+4>>2],t[o+8>>2]=t[r>>2],t[o+12>>2]=A,A=t[r+20>>2],t[o+24>>2]=t[r+16>>2],t[o+28>>2]=A,A=t[r+36>>2],t[o+40>>2]=t[r+32>>2],t[o+44>>2]=A,A=t[r+52>>2],t[o+56>>2]=t[r+48>>2],t[o+60>>2]=A,A=t[i+4>>2],t[o+72>>2]=t[i>>2],t[o+76>>2]=A,u=i+24|0,l=t[u+4>>2],A=o+96|0,t[A>>2]=t[u>>2],t[A+4>>2]=l,u=t[i+20>>2],A=o+88|0,t[A>>2]=t[i+16>>2],t[A+4>>2]=u,u=i+40|0,l=t[u+4>>2],A=o+112|0,t[A>>2]=t[u>>2],t[A+4>>2]=l,u=t[i+36>>2],A=o+104|0,t[A>>2]=t[i+32>>2],t[A+4>>2]=u,u=t[v+4>>2],A=o+128|0,t[A>>2]=t[v>>2],t[A+4>>2]=u,u=t[i+52>>2],A=o+120|0,t[A>>2]=t[i+48>>2],t[A+4>>2]=u,Ue(c,o+8|0,o+224|0,0),u=o+252|0,v=t[u+4>>2],A=o+280|0,t[A>>2]=t[u>>2],t[A+4>>2]=v,A=t[o+248>>2],t[o+272>>2]=t[o+244>>2],t[o+276>>2]=A;A:{r:{e:{i:{a:{f:{if(b[o+264|0]){if(G=B(B(h-G)-B(D-p)),R=B(B(g-d)-B(R-_)),h=B(B(W-w)-B(Z-F)),A=t[o+232>>2],y=o+236|0,v=t[y>>2],l=t[o+228>>2],Q=o+260|0,_=C[Q>>2],!(_>B(.0010000000474974513)))break f;for(u=o+244|0,m=-1,Y=o+120|0,N=o+124|0,V=o+128|0,I=o+264|0,g=B(0);;){if(m=m+1|0,m>>>0>31)break A;if(d=B(g-B(_/B(B(G*(k(0,v),s()))+B(B(R*(k(0,A),s()))+B(h*(k(0,l),s())))))),d<=g|d<B(0))break A;if(d>B(1))break r;if(yf[t[t[n>>2]>>2]](n,d),g=B(B(1)-d),C[o+56>>2]=B(g*C[r+48>>2])+B(d*C[e+48>>2]),C[o+60>>2]=B(g*C[r+52>>2])+B(d*C[e+52>>2]),C[o- -64>>2]=B(g*C[r+56>>2])+B(d*C[e+56>>2]),C[Y>>2]=B(g*C[i+48>>2])+B(d*C[f+48>>2]),C[N>>2]=B(g*C[i+52>>2])+B(d*C[f+52>>2]),C[V>>2]=B(g*C[i+56>>2])+B(d*C[f+56>>2]),Ue(c,o+8|0,o+224|0,0),!b[0|I])break A;if(_=C[Q>>2],_<B(0))break i;if(v=u+8|0,l=t[v+4>>2],A=o+280|0,t[A>>2]=t[v>>2],t[A+4>>2]=l,A=t[u+4>>2],t[o+272>>2]=t[u>>2],t[o+276>>2]=A,A=t[o+232>>2],v=t[y>>2],l=t[o+228>>2],g=d,!(_>B(.0010000000474974513)))break;}_=C[o+240>>2];break a;}break A;}d=B(0),_=C[o+240>>2];}if(B(B(G*(k(0,v),s()))+B(B(R*(k(0,A),s()))+B(h*(k(0,l),s()))))>=B(-C[n+172>>2]))break A;t[n+132>>2]=l,C[n+164>>2]=d,r=t[o+276>>2],t[n+148>>2]=t[o+272>>2],t[n+152>>2]=r,C[n+144>>2]=_,t[n+140>>2]=v,t[n+136>>2]=A,r=o+280|0,e=t[r+4>>2],A=n+156|0,t[A>>2]=t[r>>2],t[A+4>>2]=e;break e;}C[n+164>>2]=d,A=t[o+232>>2],t[n+132>>2]=t[o+228>>2],t[n+136>>2]=A,A=t[u+4>>2],t[n+148>>2]=t[u>>2],t[n+152>>2]=A,r=o+236|0,e=t[r+4>>2],A=n+140|0,t[A>>2]=t[r>>2],t[A+4>>2]=e,r=u+8|0,e=t[r+4>>2],A=n+156|0,t[A>>2]=t[r>>2],t[A+4>>2]=e;}return E=o+288|0,1;}return E=o+288|0,0;}return E=o+288|0,0;}function Ke(A,r,e,i,a,f,n,b,o,k,c){var u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),R=B(0),G=B(0),h=B(0),y=B(0),p=B(0),D=B(0),w=B(0);b=(b<<2)+k|0,_=C[b>>2],R=B(C[k+48>>2]-C[o+48>>2]),y=C[b+16>>2],p=B(C[k+52>>2]-C[o+52>>2]),D=C[b+32>>2],w=B(C[k+56>>2]-C[o+56>>2]),s=B(B(B(_*R)+B(y*p))+B(D*w)),n=(n<<2)+o|0,G=C[n>>2],d=C[n+16>>2],g=C[n+32>>2],h=B(B(B(G*R)+B(d*p))+B(g*w)),v=B(B(B(G*_)+B(d*y))+B(g*D)),l=B(B(1)-B(v*v)),l!=B(0)&&(l=B(B(h-B(v*s))/l),u=B(-e),l<u||(u=l,u>e&&(u=e)));A:{r:{e:{i:{a:{f:{if(l=B(B(v*u)-s),s=B(-a),l<s){if(a=B(B(v*s)+h),u=B(-e),!(a<u))break f;l=s;break A;}if(!(l>a))break A;if(s=B(B(v*a)+h),u=B(-e),!(s<u))break a;l=a;break A;}if(!(a>e))break e;a=s;break i;}if(!(s>e))break r;}l=a,u=e;break A;}l=s,u=a;break A;}l=a,u=s;}return s=B(D*l),e=B(s+B(w-B(g*u))),v=B(_*l),a=B(v+B(R-B(G*u))),h=B(y*l),l=B(h+B(p-B(d*u))),u=B(B(e*e)+B(B(a*a)+B(l*l))),_=B(Q(u)),R=B(B(_-i)-f),R>c||(u<=B(1.4210854715202004e-14)?B(m(g))>B(.7071067690849304)?(t[A>>2]=0,i=B(B(1)/B(Q(B(B(d*d)+B(g*g))))),e=B(d*i),C[A+8>>2]=e,u=B(-B(g*i)),C[A+4>>2]=u,i=B(0)):(t[A+8>>2]=0,e=B(B(1)/B(Q(B(B(G*G)+B(d*d))))),u=B(G*e),C[A+4>>2]=u,i=B(-B(d*e)),C[A>>2]=i,e=B(0)):(t[A+12>>2]=0,i=B(B(-1)/_),e=B(e*i),C[A+8>>2]=e,u=B(l*i),C[A+4>>2]=u,i=B(a*i),C[A>>2]=i),a=C[k+48>>2],c=C[k+52>>2],l=C[k+56>>2],t[r+12>>2]=0,C[r+8>>2]=B(s+l)+B(e*f),C[r+4>>2]=B(h+c)+B(u*f),C[r>>2]=B(v+a)+B(i*f)),R;}function qe(A,r,e,i){i=B(i);}function $e(A,r){return yf[t[798]](r),A;}function Ai(){yf[t[799]]();}function ri(A,r,e,i){return t[A+12>>2]=e,t[A+8>>2]=r,t[A+4>>2]=i,t[A>>2]=16124,A;}function ei(A,r,e,i,a,f){A|=0,r|=0,e|=0,i|=0,a|=0,f|=0;var n,b,o,k,c,u,l,s,d,v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=0,y=B(0),p=0,D=0,w=B(0),W=B(0),F=0,Z=0,Y=0,N=B(0),V=B(0),I=B(0),J=0,X=0,M=0,x=B(0),S=B(0),T=B(0),U=B(0),j=B(0),O=B(0),H=B(0),z=B(0),P=B(0),L=B(0),K=B(0),q=B(0),$=B(0),AA=B(0),rA=B(0),eA=B(0),iA=B(0),aA=B(0),fA=B(0),nA=B(0),tA=B(0),bA=B(0),oA=B(0),kA=B(0),cA=B(0),uA=B(0),lA=0;n=E-96|0,E=n,Ve(t[A+4>>2]),F=i+40|0,iA=C[F>>2],Z=i+36|0,aA=C[Z>>2],p=i+24|0,fA=C[p>>2],Y=i+20|0,nA=C[Y>>2],D=r+20|0,x=C[D>>2],J=r+36|0,S=C[J>>2],X=r+24|0,T=C[X>>2],b=r+52|0,U=C[b>>2],u=e+52|0,R=C[u>>2],o=i+52|0,j=C[o>>2],l=a+52|0,G=C[l>>2],M=r+40|0,O=C[M>>2],k=r+56|0,H=C[k>>2],s=e+56|0,v=C[s>>2],c=i+56|0,z=C[c>>2],d=a+56|0,_=C[d>>2],tA=C[i+32>>2],bA=C[i+16>>2],oA=C[i+8>>2],kA=C[i+4>>2],cA=C[i>>2],P=C[r>>2],L=C[r+16>>2],K=C[r+32>>2],q=C[r+4>>2],$=C[r+8>>2],AA=C[r+48>>2],g=C[e+48>>2],rA=C[i+48>>2],m=C[a+48>>2],h=t[A+8>>2],t[n+60>>2]=0,N=B(B(g-AA)-B(m-rA)),g=B(-N),w=B(B(R-U)-B(G-j)),W=B(B(v-H)-B(_-z)),C[n+56>>2]=B(B($*g)-B(T*w))-B(O*W),C[n+52>>2]=B(B(q*g)-B(x*w))-B(S*W),C[n+48>>2]=B(B(P*g)-B(L*w))-B(K*W),yf[t[t[h>>2]+64>>2]](n+80|0,h,n+48|0),t[n+76>>2]=0,g=C[n+80>>2],R=C[n+84>>2],G=C[n+88>>2],C[n+72>>2]=B(B(B(g*C[r+32>>2])+B(R*C[J>>2]))+B(G*C[M>>2]))+C[k>>2],C[n+68>>2]=B(B(B(g*C[r+16>>2])+B(R*C[D>>2]))+B(G*C[X>>2]))+C[b>>2],C[n+64>>2]=B(B(B(g*C[r>>2])+B(R*C[r+4>>2]))+B(G*C[r+8>>2]))+C[r+48>>2],h=t[A+12>>2],t[n+44>>2]=0,C[n+40>>2]=B(B(N*C[i+8>>2])+B(w*C[p>>2]))+B(W*C[F>>2]),C[n+36>>2]=B(B(N*C[i+4>>2])+B(w*C[Y>>2]))+B(W*C[Z>>2]),C[n+32>>2]=B(B(N*C[i>>2])+B(w*C[i+16>>2]))+B(W*C[i+32>>2]),yf[t[t[h>>2]+64>>2]](n+80|0,h,n+32|0),t[n+60>>2]=0,g=C[n+80>>2],R=C[n+84>>2],G=C[n+88>>2],m=B(B(B(B(g*C[i+32>>2])+B(R*C[Z>>2]))+B(G*C[F>>2]))+C[c>>2]),C[n+56>>2]=m,_=B(B(B(B(g*C[i>>2])+B(R*C[i+4>>2]))+B(G*C[i+8>>2]))+C[i+48>>2]),C[n+48>>2]=_,g=B(B(B(B(g*C[i+16>>2])+B(R*C[Y>>2]))+B(G*C[p>>2]))+C[o>>2]),C[n+52>>2]=g,t[n+92>>2]=0,v=B(C[n+68>>2]-g),C[n+84>>2]=v,_=B(C[n+64>>2]-_),C[n+80>>2]=_,m=B(C[n+72>>2]-m),C[n+88>>2]=m,g=B(0),R=B(0),G=B(0);A:{r:if(B(B(B(_*_)+B(v*v))+B(m*m))>B(9999999747378752e-20))for(Y=-33,F=A+4|0;;){if(Y=Y+1|0,!Y)break r;if(h=t[A+8>>2],Z=0,D=n+12|0,t[D>>2]=0,J=n+8|0,v=B(-C[n+80>>2]),_=C[n+84>>2],p=n+88|0,m=C[p>>2],C[J>>2]=B(B($*v)-B(T*_))-B(O*m),C[n+4>>2]=B(B(q*v)-B(x*_))-B(S*m),C[n>>2]=B(B(P*v)-B(L*_))-B(K*m),yf[t[t[h>>2]+64>>2]](n+16|0,h,n),t[n+76>>2]=0,X=n+72|0,v=C[n+16>>2],_=C[n+20>>2],M=n+24|0,m=C[M>>2],C[X>>2]=H+B(B(B(K*v)+B(S*_))+B(O*m)),C[n+68>>2]=U+B(B(B(L*v)+B(x*_))+B(T*m)),C[n+64>>2]=AA+B(B(B(P*v)+B(q*_))+B($*m)),h=t[A+12>>2],t[D>>2]=0,v=C[n+80>>2],_=C[n+84>>2],m=C[p>>2],C[J>>2]=B(B(oA*v)+B(fA*_))+B(iA*m),C[n+4>>2]=B(B(kA*v)+B(nA*_))+B(aA*m),C[n>>2]=B(B(cA*v)+B(bA*_))+B(tA*m),yf[t[t[h>>2]+64>>2]](n+16|0,h,n),t[n+60>>2]=0,v=C[n+16>>2],_=C[n+20>>2],m=C[M>>2],V=B(z+B(B(B(tA*v)+B(aA*_))+B(iA*m))),C[n+56>>2]=V,I=B(rA+B(B(B(cA*v)+B(kA*_))+B(oA*m))),C[n+48>>2]=I,v=B(j+B(B(B(bA*v)+B(nA*_))+B(fA*m))),C[n+52>>2]=v,h=n+44|0,t[h>>2]=0,D=n+40|0,V=B(C[X>>2]-V),C[D>>2]=V,eA=B(C[n+68>>2]-v),C[n+36>>2]=eA,I=B(C[n+64>>2]-I),C[n+32>>2]=I,y>B(1))break A;if(v=C[n+80>>2],_=C[n+84>>2],m=C[p>>2],uA=B(B(B(I*v)+B(eA*_))+B(V*m)),uA>B(0)){if(g=B(B(B(N*v)+B(w*_))+B(W*m)),g>=B(-1.4210854715202004e-14))break A;t[h>>2]=0,C[D>>2]=V,C[n+36>>2]=eA,C[n+32>>2]=I,y=B(y-B(uA/g)),g=B(B(1)-y),z=B(B(g*C[c>>2])+B(y*C[d>>2])),j=B(B(g*C[o>>2])+B(y*C[l>>2])),rA=B(B(g*C[i+48>>2])+B(y*C[a+48>>2])),H=B(B(g*C[k>>2])+B(y*C[s>>2])),U=B(B(g*C[b>>2])+B(y*C[u>>2])),AA=B(B(g*C[r+48>>2])+B(y*C[e+48>>2])),lA=t[n+92>>2],R=_,G=m,g=v;}if(xe(t[F>>2],n+32|0)||Ie(t[F>>2],n+32|0,n- -64|0,n+48|0),!Me(t[F>>2],n+80|0))break r;if(v=C[n+80>>2],_=B(v*v),v=C[n+84>>2],_=B(_+B(v*v)),v=C[p>>2],!(B(_+B(v*v))>B(9999999747378752e-20)))break;}C[f+164>>2]=y,v=B(B(B(g*g)+B(R*R))+B(G*G)),v>=B(1.4210854715202004e-14)?(t[f+144>>2]=lA,_=G,G=B(B(1)/B(Q(v))),y=B(_*G),C[f+140>>2]=y,R=B(R*G),C[f+136>>2]=R,g=B(g*G),C[f+132>>2]=g):(t[f+132>>2]=0,t[f+136>>2]=0,r=f+140|0,t[r>>2]=0,t[r+4>>2]=0,y=B(0),R=B(0),g=B(0)),Z=0,B(B(B(N*g)+B(w*R))+B(W*y))>=B(-C[f+172>>2])||(Se(t[A+4>>2],n+16|0,n),r=n+8|0,e=t[r+4>>2],A=f+156|0,t[A>>2]=t[r>>2],t[A+4>>2]=e,A=t[n+4>>2],t[f+148>>2]=t[n>>2],t[f+152>>2]=A,Z=1);}return E=n+96|0,0|Z;}function ii(A,r,e,i,f){var n;vA(A,r),t[A>>2]=16184,t[A+8>>2]=16212,t[A+60>>2]=0,n=f?e:i,t[A+48>>2]=n,e=f?i:e,t[A+44>>2]=e,i=A+56|0,r=t[r>>2],t[i>>2]=r,r=0|yf[t[t[r>>2]+12>>2]](r,t[e+8>>2],t[n+8>>2]),t[A+72>>2]=r,e=t[i>>2],yf[t[t[e>>2]+20>>2]](e,r),a[A+76|0]=f;}function ai(A,r,e,i,f){var n=0;vA(A,r),a[A+24|0]=1,t[A>>2]=16760,t[A+20>>2]=0,a[A+44|0]=1,n=A+12|0,t[n>>2]=0,t[n+4>>2]=0,t[A+40>>2]=0,a[A- -64|0]=1,n=A+32|0,t[n>>2]=0,t[n+4>>2]=0,t[A+60>>2]=0,a[A+68|0]=f,n=A+52|0,t[n>>2]=0,t[n+4>>2]=0,a[A+76|0]=0,t[A+72>>2]=t[r+4>>2],t[A+80>>2]=t[t[(f?i:e)+4>>2]+72>>2],fi(A,e,i);}function fi(A,r,e){var i,f,n,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0,g=0,_=0,B=0;if(f=E-32|0,E=f,d=A+52|0,c=t[d>>2],v=b[A+68|0],n=v?e:r,s=t[n+4>>2],i=t[s+20>>2],(0|c)<(0|i)){if(t[A+56>>2]<(0|i)){A:{r:{if(i){if(u=CA(i<<2,16),o=t[A+52>>2],(0|o)>=1)break r;break A;}if(o=c,(0|o)<1)break A;}for(C=A+60|0;t[k+u>>2]=t[t[C>>2]+k>>2],k=k+4|0,o=o+-1|0,o;){}}o=A+60|0,k=t[o>>2],k&&(b[A- -64|0]&&gA(k),t[A+60>>2]=0),t[o>>2]=u,a[A- -64|0]=1,t[A+56>>2]=i;}for(k=c<<2,o=i-c|0,c=A+60|0;t[t[c>>2]+k>>2]=0,k=k+4|0,o=o+-1|0,o;){}}if(t[d>>2]=i,(0|i)>=1)for(r=v?r:e,o=64,e=s+68|0,c=s+28|0,s=f+28|0,d=f+24|0,v=A+72|0,C=A+4|0,A=A+60|0,k=0,u=0;t[e>>2]?t[t[A>>2]+k>>2]=0:(l=t[t[c>>2]+o>>2],t[s>>2]=u,t[d>>2]=-1,t[f+8>>2]=n,g=n+8|0,B=t[g+4>>2],_=f+16|0,t[_>>2]=t[g>>2],t[_+4>>2]=B,t[f+12>>2]=l,l=t[C>>2],l=0|yf[t[t[l>>2]+8>>2]](l,f+8|0,r,t[v>>2],1),t[t[A>>2]+k>>2]=l),o=o+80|0,k=k+4|0,u=u+1|0,(0|u)!=(0|i);){}E=f+32|0;}function ni(A){A|=0;var r=0,e=0,i=0,f=0;if(t[A>>2]=16760,e=t[A+52>>2],(0|e)>=1)for(f=A+60|0;i=t[t[f>>2]+r>>2],i&&(yf[t[t[i>>2]>>2]](i),i=t[A+4>>2],yf[t[t[i>>2]+60>>2]](i,t[t[f>>2]+r>>2])),r=r+4|0,e=e+-1|0,e;){}return r=A+60|0,e=t[r>>2],e&&(b[A- -64|0]&&gA(e),t[A+60>>2]=0),t[r>>2]=0,a[A- -64|0]=1,r=A+52|0,t[r>>2]=0,t[r+4>>2]=0,r=A+40|0,e=t[r>>2],e&&(b[A+44|0]&&gA(e),t[A+40>>2]=0),t[r>>2]=0,a[A+44|0]=1,r=A+32|0,t[r>>2]=0,t[r+4>>2]=0,r=A+20|0,e=t[r>>2],e&&(b[A+24|0]&&gA(e),t[A+20>>2]=0),t[r>>2]=0,a[A+24|0]=1,r=A+12|0,t[r>>2]=0,t[r+4>>2]=0,0|A;}function ti(A,r,e,i,f){A|=0,r|=0,e|=0,i|=0,f|=0;var n,o,k,c=0,u=0,l=0,s=B(0),d=0,v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=0,p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=B(0),M=B(0),x=0,S=B(0),T=B(0),U=0,j=0,O=0,H=0,z=0,P=0,L=0,K=0,q=0;if(n=E-176|0,E=n,Q=b[A+68|0],k=Q?e:r,o=t[k+4>>2],t[o+72>>2]!=t[A+80>>2]){if(l=t[A+52>>2],(0|l)>=1)for(u=A+60|0;d=t[t[u>>2]+c>>2],d&&(yf[t[t[d>>2]>>2]](d),d=t[A+4>>2],yf[t[t[d>>2]+60>>2]](d,t[t[u>>2]+c>>2])),c=c+4|0,l=l+-1|0,l;){}fi(A,r,e),t[A+80>>2]=t[o+72>>2];}u=t[A+52>>2];A:if(u){if(U=t[o+68>>2],t[n+164>>2]=f,t[n+160>>2]=i,Q=Q?r:e,t[n+152>>2]=Q,t[n+148>>2]=k,t[n+144>>2]=16832,t[n+172>>2]=t[A+72>>2],t[n+168>>2]=t[A+60>>2],t[n+156>>2]=t[A+4>>2],r=A+32|0,l=t[r>>2],(0|l)<=-1){for(t[A+36>>2]<=-1&&(e=t[A+40>>2],e&&(b[A+44|0]&&gA(e),t[A+40>>2]=0),a[A+44|0]=1,e=A+36|0,t[e>>2]=0,t[e+4>>2]=0),c=l<<2,e=A+40|0;t[t[e>>2]+c>>2]=0,c=c+4|0,l=l+1|0,l;){}u=t[A+52>>2];}if(t[r>>2]=0,(0|u)>=1)for(H=A+28|0,L=A+60|0,i=A+32|0,r=A+40|0,K=f+8|0,j=f+12|0,l=A+36|0,O=A+44|0,q=A+52|0;;){if(e=t[t[L>>2]+(x<<2)>>2],e){if(yf[t[t[e>>2]+16>>2]](e,H),u=t[i>>2],(0|u)>=1)for(c=0,d=0;e=t[t[r>>2]+c>>2],t[e+780>>2]&&(u=f+4|0,t[u>>2]=e,z=t[e+772>>2],P=t[t[K>>2]+8>>2],(0|z)==(0|P)?dr(e,z+4|0,t[t[j>>2]+8>>2]+4|0):dr(e,t[t[j>>2]+8>>2]+4|0,P+4|0),t[u>>2]=0,u=t[i>>2]),c=c+4|0,d=d+1|0,(0|d)<(0|u);){}if((0|u)<=-1)for(t[l>>2]<=-1&&(e=t[r>>2],e&&(b[0|O]&&gA(e),t[r>>2]=0),a[0|O]=1,t[l>>2]=0,t[l+4>>2]=0),c=u<<2;t[t[r>>2]+c>>2]=0,c=c+4|0,u=u+1|0,u;){}t[i>>2]=0,u=t[q>>2];}if(x=x+1|0,!((0|x)<(0|u)))break;}if(U)r=t[k+12>>2],p=C[r+52>>2],D=C[r+56>>2],e=t[Q+12>>2],w=C[e+52>>2],W=C[e+56>>2],s=C[r+20>>2],v=C[r+36>>2],F=C[e+20>>2],Z=C[e+36>>2],Y=C[e+24>>2],g=C[r+24>>2],N=C[e+40>>2],_=C[r+40>>2],V=C[e+32>>2],m=C[r+32>>2],I=C[e>>2],R=C[r>>2],J=C[e+16>>2],G=C[r+16>>2],X=C[r+48>>2],M=C[e+48>>2],h=C[r+4>>2],S=C[e+4>>2],T=C[e+8>>2],y=C[r+8>>2],t[n+108>>2]=0,t[n+92>>2]=0,t[n+76>>2]=0,C[n+88>>2]=B(B(y*T)+B(g*Y))+B(_*N),C[n+84>>2]=B(B(y*S)+B(g*F))+B(_*Z),C[n+72>>2]=B(B(h*T)+B(s*Y))+B(v*N),C[n+68>>2]=B(B(h*S)+B(s*F))+B(v*Z),X=B(-X),C[n+104>>2]=B(B(B(y*X)-B(g*p))-B(_*D))+B(B(B(y*M)+B(g*w))+B(_*W)),C[n+100>>2]=B(B(B(h*X)-B(s*p))-B(v*D))+B(B(B(h*M)+B(s*w))+B(v*W)),t[n+60>>2]=0,C[n+48>>2]=B(B(R*I)+B(G*J))+B(m*V),C[n+80>>2]=B(B(y*I)+B(g*J))+B(_*V),C[n+64>>2]=B(B(h*I)+B(s*J))+B(v*V),C[n+56>>2]=B(B(R*T)+B(G*Y))+B(m*N),C[n+52>>2]=B(B(R*S)+B(G*F))+B(m*Z),C[n+96>>2]=B(B(B(R*X)-B(G*p))-B(m*D))+B(B(B(R*M)+B(G*w))+B(m*W)),r=t[Q+4>>2],yf[t[t[r>>2]+8>>2]](r,n+48|0,n+128|0,n+112|0),s=C[f+32>>2],C[n+128>>2]=C[n+128>>2]-s,C[n+132>>2]=C[n+132>>2]-s,C[n+136>>2]=C[n+136>>2]-s,C[n+112>>2]=s+C[n+112>>2],C[n+116>>2]=s+C[n+116>>2],C[n+120>>2]=s+C[n+120>>2],e=t[n+124>>2],r=n+40|0,t[r>>2]=t[n+120>>2],t[r+4>>2]=e,e=t[n+140>>2],r=n+24|0,t[r>>2]=t[n+136>>2],t[r+4>>2]=e,r=t[n+116>>2],t[n+32>>2]=t[n+112>>2],t[n+36>>2]=r,r=t[n+132>>2],t[n+16>>2]=t[n+128>>2],t[n+20>>2]=r,function(A,r,e,i){var f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=0;r:if(A){if(d=C[r+24>>2],v=C[r+20>>2],o=t[e+8>>2],g=C[r+16>>2],_=C[r+8>>2],m=C[r+4>>2],R=C[r>>2],f=t[e+4>>2],(0|f)<=-1)for((0|o)<=-1&&(r=t[e+12>>2],r&&(b[e+16|0]&&gA(r),t[e+12>>2]=0),a[e+16|0]=1,r=e+8|0,t[r>>2]=0,t[r+4>>2]=0,o=0),r=f<<2,n=e+12|0;t[t[n>>2]+r>>2]=0,r=r+4|0,f=f+1|0,f;){}if(n=0,r=e+4|0,t[r>>2]=0,(0|o)<=63){if(o=CA(256,16),n=t[r>>2],(0|n)>=1)for(r=0,k=e+12|0,f=n;t[r+o>>2]=t[t[k>>2]+r>>2],r=r+4|0,f=f+-1|0,f;){}r=t[e+12>>2],r&&(b[e+16|0]&&(gA(r),n=t[e+4>>2]),t[e+12>>2]=0),a[e+16|0]=1,t[e+12>>2]=o,t[e+8>>2]=64,o=64;}e:if((0|o)==(0|n)){i:{a:{f:{if(c=o<<1,(0|o)<(0|c)){if(r=0,!o)break f;if(k=CA(o<<3,16),n=t[e+4>>2],(0|n)>=1)break a;break i;}n=o;break e;}k=0,n=o;}for(o=e+12|0,f=n;t[r+k>>2]=t[t[o>>2]+r>>2],r=r+4|0,f=f+-1|0,f;){}}r=t[e+12>>2],r&&(b[e+16|0]&&(gA(r),n=t[e+4>>2]),t[e+12>>2]=0),a[e+16|0]=1,t[e+12>>2]=k,t[e+8>>2]=c;}for(c=e+4|0,f=n+1|0,t[c>>2]=f,t[t[e+12>>2]+(n<<2)>>2]=A,k=e+12|0,s=e+8|0,u=e+16|0;;){if(r=f+-1|0,t[c>>2]=r,o=t[k>>2],A=t[o+(r<<2)>>2],!(C[A>>2]<=g)){if(f=r,(0|r)>0)continue;break r;}if(!(C[A+16>>2]>=R)){if(f=r,(0|r)>0)continue;break r;}if(!(C[A+4>>2]<=v)){if(f=r,(0|r)>0)continue;break r;}if(!(C[A+20>>2]>=m)){if(f=r,(0|r)>0)continue;break r;}if(!(C[A+8>>2]<=d)){if(f=r,(0|r)>0)continue;break r;}if(!(C[A+24>>2]>=_)){if(f=r,(0|r)>0)continue;break r;}e:{i:{if(l=A+40|0,t[l>>2]){if(G=t[A+36>>2],n=t[s>>2],(0|n)!=(0|r))break e;if(n=r?r<<1:1,(0|f)<=(0|n))break i;n=r;break e;}if(yf[t[t[i>>2]+12>>2]](i,A),f=t[c>>2],(0|f)>0)continue;break r;}i:{a:{if(n){if(o=CA(n<<2,16),r=t[c>>2],(0|r)>=1)break a;break i;}if(o=0,(0|r)<1)break i;}for(f=0,e=r;t[f+o>>2]=t[t[k>>2]+f>>2],f=f+4|0,e=e+-1|0,e;){}}A=t[k>>2],A&&(b[0|u]&&(gA(A),r=t[c>>2]),t[k>>2]=0),t[k>>2]=o,a[0|u]=1,t[s>>2]=n;}A=r+1|0,t[c>>2]=A,t[(r<<2)+o>>2]=G,l=t[l>>2];e:if((0|A)==(0|n)){i:{a:{f:{if(o=n?n<<1:1,(0|n)<(0|o)){if(!o)break f;if(e=CA(o<<2,16),A=t[c>>2],(0|A)>=1)break a;break i;}A=n;break e;}if(e=0,A=n,(0|n)<1)break i;}for(r=0,f=A;t[r+e>>2]=t[t[k>>2]+r>>2],r=r+4|0,f=f+-1|0,f;){}}r=t[k>>2],r&&(b[0|u]&&(gA(r),A=t[c>>2]),t[k>>2]=0),t[k>>2]=e,a[0|u]=1,t[s>>2]=o;}if(f=A+1|0,t[c>>2]=f,t[t[k>>2]+(A<<2)>>2]=l,!((0|f)>0))break;}}}(t[U>>2],n+16|0,A+8|0,n+144|0);else if(!((0|u)<1))for(c=0,l=64,r=o+28|0;bi(n+144|0,t[t[r>>2]+l>>2],c),l=l+80|0,c=c+1|0,(0|u)!=(0|c);){}if(e=t[A+52>>2],r=A+32|0,u=t[r>>2],(0|u)<=-1)for(t[A+36>>2]<=-1&&(i=t[A+40>>2],i&&(b[A+44|0]&&gA(i),t[A+40>>2]=0),a[A+44|0]=1,i=A+36|0,t[i>>2]=0,t[i+4>>2]=0),c=u<<2,i=A+40|0;t[t[i>>2]+c>>2]=0,c=c+4|0,u=u+1|0,u;){}if(t[r>>2]=0,!((0|e)<1))for(d=64,f=A+60|0,U=n+92|0,x=n+80|0,j=n- -64|0,O=n+56|0,H=n+96|0,l=0;;){if(!(t[t[f>>2]+l>>2]&&(r=t[o+28>>2]+d|0,c=t[r>>2],i=t[k+12>>2],S=C[i+48>>2],T=C[i+52>>2],X=C[i+56>>2],p=C[r+-8>>2],D=C[r+-16>>2],w=C[r+-12>>2],s=C[i+8>>2],v=C[i>>2],g=C[i+4>>2],_=C[i+24>>2],m=C[i+16>>2],R=C[i+20>>2],W=C[r+-32>>2],F=C[r+-64>>2],Z=C[r+-48>>2],Y=C[r+-28>>2],N=C[r+-60>>2],V=C[r+-44>>2],G=C[i+40>>2],I=C[r+-24>>2],h=C[i+32>>2],J=C[r+-56>>2],y=C[i+36>>2],M=C[r+-40>>2],u=0,t[n+108>>2]=0,t[U>>2]=0,t[n+76>>2]=0,t[n+60>>2]=0,C[n+88>>2]=B(B(h*J)+B(y*M))+B(G*I),C[n+84>>2]=B(B(h*N)+B(y*V))+B(G*Y),C[x>>2]=B(B(h*F)+B(y*Z))+B(G*W),C[n+72>>2]=B(B(m*J)+B(R*M))+B(_*I),C[n+68>>2]=B(B(m*N)+B(R*V))+B(_*Y),C[j>>2]=B(B(m*F)+B(R*Z))+B(_*W),C[O>>2]=B(B(v*J)+B(g*M))+B(s*I),C[n+104>>2]=X+B(B(B(h*D)+B(y*w))+B(G*p)),C[n+100>>2]=T+B(B(B(m*D)+B(R*w))+B(_*p)),C[H>>2]=S+B(B(B(v*D)+B(g*w))+B(s*p)),C[n+52>>2]=B(B(v*N)+B(g*V))+B(s*Y),C[n+48>>2]=B(B(v*F)+B(g*Z))+B(s*W),yf[t[t[c>>2]+8>>2]](c,n+48|0,n+16|0,n+128|0),r=t[Q+4>>2],yf[t[t[r>>2]+8>>2]](r,t[Q+12>>2],n+112|0,n),c=0,C[n+16>>2]>C[n>>2]||(c=0,C[n+128>>2]<C[n+112>>2]||(c=1)),u=C[n+136>>2]<C[n+120>>2]|C[n+24>>2]>C[n+8>>2]?u:c,C[n+132>>2]<C[n+116>>2]|C[n+20>>2]>C[n+4>>2]|1^u))){if(d=d+80|0,l=l+4|0,e=e+-1|0,e)continue;break A;}if(r=t[t[f>>2]+l>>2],yf[t[t[r>>2]>>2]](r),r=t[A+4>>2],yf[t[t[r>>2]+60>>2]](r,t[t[f>>2]+l>>2]),t[t[f>>2]+l>>2]=0,d=d+80|0,l=l+4|0,e=e+-1|0,!e)break;}}E=n+176|0;}function bi(A,r,e){var i,a,f=0,n=0,b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0);i=E-160|0,E=i,f=t[A+4>>2],n=t[f+12>>2],m=C[n+52>>2],u=C[n+56>>2],b=C[n+24>>2],l=C[n+20>>2],o=C[n+40>>2],k=C[n+36>>2],f=t[t[f+4>>2]+28>>2],F=C[n+48>>2],s=C[n+8>>2],d=C[n>>2],v=C[n+4>>2],g=C[n+16>>2],c=C[n+32>>2],n=0,t[i+156>>2]=0,t[i+140>>2]=0,t[i+124>>2]=0,f=f+_(e,80)|0,R=C[f+8>>2],G=C[f+24>>2],h=C[f+40>>2],C[i+136>>2]=B(B(c*R)+B(k*G))+B(o*h),y=C[f+4>>2],Q=C[f+20>>2],p=C[f+36>>2],C[i+132>>2]=B(B(c*y)+B(k*Q))+B(o*p),C[i+120>>2]=B(B(g*R)+B(l*G))+B(b*h),C[i+116>>2]=B(B(g*y)+B(l*Q))+B(b*p),D=u,u=C[f+48>>2],w=C[f+52>>2],W=C[f+56>>2],C[i+152>>2]=D+B(B(B(c*u)+B(k*w))+B(o*W)),C[i+148>>2]=m+B(B(B(g*u)+B(l*w))+B(b*W)),t[i+108>>2]=0,D=c,c=C[f>>2],m=k,k=C[f+16>>2],Z=o,o=C[f+32>>2],C[i+128>>2]=B(B(D*c)+B(m*k))+B(Z*o),C[i+112>>2]=B(B(g*c)+B(l*k))+B(b*o),C[i+96>>2]=B(B(d*c)+B(v*k))+B(s*o),C[i+104>>2]=B(B(d*R)+B(v*G))+B(s*h),C[i+100>>2]=B(B(d*y)+B(v*Q))+B(s*p),C[i+144>>2]=F+B(B(B(d*u)+B(v*w))+B(s*W)),yf[t[t[r>>2]+8>>2]](r,i+96|0,i+80|0,i- -64|0),b=C[t[A+20>>2]+32>>2],C[i+80>>2]=C[i+80>>2]-b,C[i+84>>2]=C[i+84>>2]-b,C[i+88>>2]=C[i+88>>2]-b,C[i+64>>2]=b+C[i+64>>2],C[i+68>>2]=b+C[i+68>>2],C[i+72>>2]=b+C[i+72>>2],f=t[A+8>>2],a=t[f+4>>2],yf[t[t[a>>2]+8>>2]](a,t[f+12>>2],i+48|0,i+32|0),f=t[693],f&&!yf[f](t[t[A+8>>2]+4>>2],r)||(n=C[i+64>>2]<C[i+48>>2]|C[i+80>>2]>C[i+32>>2]?n:1,f=0,f=C[i+72>>2]<C[i+56>>2]|C[i+88>>2]>C[i+40>>2]?f:n,C[i+68>>2]<C[i+52>>2]|C[i+84>>2]>C[i+36>>2]|1^f||(t[i+28>>2]=e,t[i+24>>2]=-1,t[i+12>>2]=r,r=t[A+4>>2],t[i+8>>2]=r,t[i+16>>2]=t[r+8>>2],b=C[t[A+20>>2]+32>>2],t[i+20>>2]=i+96,b>B(0)?(r=t[A+12>>2],r=0|yf[t[t[r>>2]+8>>2]](r,i+8|0,t[A+8>>2],0,2)):(n=e<<2,r=t[n+t[A+24>>2]>>2],r||(r=t[A+12>>2],r=0|yf[t[t[r>>2]+8>>2]](r,i+8|0,t[A+8>>2],t[A+28>>2],1),f=A+24|0,t[n+t[f>>2]>>2]=r,r=t[n+t[f>>2]>>2])),n=t[A+20>>2],f=t[n+8>>2],t[f+8>>2]==t[t[A+4>>2]+8>>2]?(t[n+8>>2]=i+8,yf[t[t[n>>2]+8>>2]](n,-1,e)):(f=t[n+12>>2],t[n+12>>2]=i+8,yf[t[t[n>>2]+12>>2]](n,-1,e)),e=A+20|0,yf[t[t[r>>2]+8>>2]](r,i+8|0,t[A+8>>2],t[A+16>>2],t[e>>2]),r=t[e>>2],t[(t[t[r+8>>2]+8>>2]==t[t[A+4>>2]+8>>2]?8:12)+r>>2]=f)),E=i+160|0;}function oi(A){var r,e,i=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0;if(e=t[A+28>>2],r=t[A+12>>2],!((0|e)>=(0|r))){A:{r:{e:{if(t[A+32>>2]<(0|r)){if(!r)break e;n=CA(r<<2,16),i=t[A+28>>2];break r;}n=t[A+36>>2];break A;}i=e;}f=t[A+36>>2];r:{if((0|i)>=1)for(o=n,k=f;t[o>>2]=t[k>>2],o=o+4|0,k=k+4|0,i=i+-1|0,i;){}else if(!f)break r;i=A+40|0,b[0|i]&&gA(f),t[A+36>>2]=n,a[0|i]=1,t[A+32>>2]=r;break A;}t[A+36>>2]=n,a[A+40|0]=1,t[A+32>>2]=r;}if(i=e<<2,c=r<<2,x(i+n|0,0,c-i|0),t[A+28>>2]=r,l=A+48|0,u=t[l>>2],(0|u)<(0|r)){A:{r:{e:{if(t[A+52>>2]<(0|r)){if(!r)break e;n=CA(c,16),i=t[A+48>>2];break r;}n=t[A+56>>2];break A;}n=0,i=u;}f=t[A+56>>2];r:{if((0|i)>=1)for(o=n,k=f;t[o>>2]=t[k>>2],o=o+4|0,k=k+4|0,i=i+-1|0,i;){}else if(!f)break r;i=A+60|0,b[0|i]&&gA(f),t[A+56>>2]=n,a[0|i]=1,t[A+52>>2]=r;break A;}t[A+56>>2]=n,a[A+60|0]=1,t[A+52>>2]=r;}i=u<<2,x(i+n|0,0,c-i|0);}if(t[l>>2]=r,(0|r)>=1&&(x(t[A+36>>2],255,c),x(t[A+56>>2],255,c)),!((0|e)<1))for(k=t[A+56>>2],n=t[A+36>>2],o=t[A+16>>2],i=0;f=t[o>>2]|t[o+4>>2]<<16,f=(f<<15^-1)+f|0,f=_(f>>>10^f,9),f^=f>>>6,f=(f<<11^-1)+f|0,f=n+((t[A+12>>2]+-1&(f>>>16^f))<<2)|0,t[k>>2]=t[f>>2],t[f>>2]=i,o=o+12|0,k=k+4|0,i=i+1|0,(0|i)!=(0|e);){}}}function ki(A){var r=0,e=0,i=0,f=0,n=0,o=0,k=0;if(r=A+16|0,e=t[r>>2],e&&(b[A+20|0]&&gA(e),t[A+16>>2]=0),t[r>>2]=0,a[A+20|0]=1,r=A+8|0,t[r>>2]=0,t[r+4>>2]=0,r=A+36|0,e=t[r>>2],e&&(b[A+40|0]&&gA(e),t[A+36>>2]=0),t[r>>2]=0,a[A+40|0]=1,r=A+28|0,t[r>>2]=0,t[r+4>>2]=0,r=A+56|0,e=t[r>>2],e&&(b[A+60|0]&&gA(e),t[A+56>>2]=0),t[r>>2]=0,a[A+60|0]=1,r=A+48|0,t[r>>2]=0,t[r+4>>2]=0,t[A+12>>2]<=1){if(e=CA(24,16),i=t[A+8>>2],(0|i)>=1)for(r=0,o=A+16|0;f=t[o>>2]+r|0,k=t[f+4>>2],n=r+e|0,t[n>>2]=t[f>>2],t[n+4>>2]=k,t[n+8>>2]=t[f+8>>2],r=r+12|0,i=i+-1|0,i;){}r=t[A+16>>2],r&&(b[A+20|0]&&gA(r),t[A+16>>2]=0),t[A+16>>2]=e,a[A+20|0]=1,t[A+12>>2]=2;}oi(A);}function ci(A){return A|=0,t[A+16>>2];}function ui(A,r,e,i){ai(A,r,e,i,0),a[A+104|0]=1,t[A>>2]=16972,t[A+100>>2]=0,r=A+92|0,t[r>>2]=0,t[r+4>>2]=0,r=CA(64,16),function(A){var r,e=0,i=0,f=0,n=0,o=0,k=0;if(t[A>>2]=16908,a[A+20|0]=1,r=A+16|0,t[r>>2]=0,a[A+40|0]=1,i=A+8|0,e=i,t[e>>2]=0,t[e+4>>2]=0,t[A+36>>2]=0,a[A+60|0]=1,e=A+28|0,t[e>>2]=0,t[e+4>>2]=0,t[A+56>>2]=0,e=A+48|0,t[e>>2]=0,t[e+4>>2]=0,e=CA(24,16),i=t[i>>2],(0|i)>=1)for(;n=t[r>>2]+f|0,k=t[n+4>>2],o=e+f|0,t[o>>2]=t[n>>2],t[o+4>>2]=k,t[o+8>>2]=t[n+8>>2],f=f+12|0,i=i+-1|0,i;){}f=t[r>>2],f&&(b[A+20|0]&&gA(f),t[A+16>>2]=0),t[A+16>>2]=e,a[A+20|0]=1,t[A+12>>2]=2,oi(A);}(r),t[A+84>>2]=r,t[A+108>>2]=t[t[e+4>>2]+72>>2],t[A+112>>2]=t[t[i+4>>2]+72>>2];}function li(A){A|=0;var r=0,e=0,i=0,f=0,n=0,o=0;if(t[A>>2]=16972,e=8,r=t[A+84>>2],i=t[r+8>>2],(0|i)>=1){for(n=r+16|0,o=A+4|0;r=t[t[n>>2]+e>>2],r&&(yf[t[t[r>>2]>>2]](r),f=t[o>>2],yf[t[t[f>>2]+60>>2]](f,r)),e=e+12|0,i=i+-1|0,i;){}r=t[A+84>>2];}return ki(r),e=A+84|0,r=t[e>>2],yf[t[t[r>>2]>>2]](r),gA(t[e>>2]),e=A+100|0,r=t[e>>2],r&&(b[A+104|0]&&gA(r),t[A+100>>2]=0),t[e>>2]=0,a[A+104|0]=1,e=A+92|0,t[e>>2]=0,t[e+4>>2]=0,ni(A),0|A;}function si(A,r){A|=0,r|=0;var e=0,i=0,f=0,n=0,o=0,k=0;if(i=t[A+12>>2],!(!i|!b[A+8|0])){if(e=t[r+4>>2],(0|e)==t[r+8>>2]&&(n=e?e<<1:1,!((0|e)>=(0|n)))){A:{r:{if(n){if(o=CA(n<<2,16),e=t[r+4>>2],(0|e)>=1)break r;break A;}if((0|e)<1)break A;}for(i=0,k=r+12|0,f=e;t[i+o>>2]=t[t[k>>2]+i>>2],i=i+4|0,f=f+-1|0,f;){}}f=t[r+12>>2],f&&(b[r+16|0]&&(gA(f),e=t[r+4>>2]),t[r+12>>2]=0),t[r+12>>2]=o,a[r+16|0]=1,t[r+8>>2]=n,i=t[A+12>>2];}t[r+4>>2]=e+1,t[t[r+12>>2]+(e<<2)>>2]=i;}}function di(A,r,e,i,a){A|=0,r|=0,e|=0,i|=0,a|=0;var f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0);i=E-144|0,E=i,t[i+108>>2]=0,f=C[r+80>>2],n=C[r+96>>2],_=C[r+120>>2],W=C[r+56>>2],h=C[r+112>>2],y=C[r+116>>2],F=C[r+52>>2],b=C[r+68>>2],k=C[r+84>>2],c=C[r+100>>2],o=C[r+20>>2],v=C[r+36>>2],u=C[r+72>>2],l=C[r+88>>2],g=C[r+24>>2],s=C[r+104>>2],m=C[r+40>>2],d=C[r+64>>2],R=C[r+32>>2],G=C[r>>2],p=C[r+16>>2],Z=C[r+48>>2],D=C[r+4>>2],w=C[r+8>>2],t[i+100>>2]=0,t[i+84>>2]=0,t[i+68>>2]=0,C[i+80>>2]=B(B(w*u)+B(g*l))+B(m*s),C[i+76>>2]=B(B(D*u)+B(o*l))+B(v*s),C[i- -64>>2]=B(B(w*b)+B(g*k))+B(m*c),C[i+60>>2]=B(B(D*b)+B(o*k))+B(v*c),h=B(Z-h),y=B(F-y),_=B(W-_),C[i+96>>2]=B(B(u*h)+B(l*y))+B(s*_),C[i+92>>2]=B(B(h*b)+B(y*k))+B(_*c),t[i+52>>2]=0,C[i+72>>2]=B(B(G*u)+B(p*l))+B(R*s),C[i+56>>2]=B(B(G*b)+B(p*k))+B(R*c),C[i+48>>2]=B(B(d*w)+B(f*g))+B(n*m),C[i+44>>2]=B(B(d*D)+B(f*o))+B(n*v),C[i+40>>2]=B(B(d*G)+B(f*p))+B(n*R),C[i+88>>2]=B(B(h*d)+B(y*f))+B(_*n);A:{if(function(A,r,e,i,a,f){var n=B(0),b=B(0),o=B(0),k=0,c=0,u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=0,m=0,R=0,G=B(0),h=B(0),y=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=0;k=E-32|0,E=k,c=t[A+8>>2],b=C[c+60>>2],n=B(C[c+76>>2]-b),d=C[c- -64>>2],o=B(C[c+96>>2]-d),u=B(C[c+80>>2]-d),s=B(C[c+92>>2]-b),v=B(B(n*o)-B(u*s)),G=u,g=C[c+68>>2],u=B(C[c+100>>2]-g),l=B(C[c+84>>2]-g),o=B(B(G*u)-B(l*o)),s=B(B(l*s)-B(n*u)),u=B(B(v*v)+B(B(o*o)+B(s*s)));r:if(u>=B(1.4210854715202004e-14)&&(R=t[A+4>>2],G=B(C[R+32>>2]*C[R+16>>2]),n=B(G+f),f=B(B(1)/B(Q(u))),u=B(o*f),o=C[r>>2],s=B(s*f),l=C[r+4>>2],h=B(B(u*B(o-b))+B(s*B(l-d))),d=B(v*f),b=C[r+8>>2],f=B(h+B(d*B(b-g))),f<B(0)&&(d=B(-d),s=B(-s),u=B(-u),f=B(-f)),f<n)){if(_=r+8|0,R=t[_+4>>2],m=k+24|0,t[m>>2]=t[_>>2],t[m+4>>2]=R,_=t[r+4>>2],t[k+16>>2]=t[r>>2],t[k+20>>2]=_,_=0,t[k+12>>2]=0,C[k+8>>2]=d,C[k+4>>2]=s,C[k>>2]=u,function(A,r,e){var i=B(0),a=B(0),f=B(0),n=B(0),t=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0);return k=C[A+40>>2],b=C[A+24>>2],l=B(k-b),c=C[e+8>>2],d=C[A+32>>2],a=C[A+16>>2],t=B(d-a),f=C[r+4>>2],v=C[A+36>>2],o=C[A+20>>2],n=B(v-o),u=C[r>>2],s=B(B(c-b)*B(B(t*f)-B(n*u))),g=C[e>>2],i=n,n=C[r+8>>2],_=C[e+4>>2],l=B(s+B(B(B(g-a)*B(B(i*n)-B(l*f)))+B(B(_-o)*B(B(l*u)-B(t*n))))),i=b,b=C[A+8>>2],t=B(i-b),i=a,a=C[A>>2],s=B(i-a),i=o,o=C[A+4>>2],i=B(i-o),t=B(B(B(c-b)*B(B(s*f)-B(i*u)))+B(B(B(g-a)*B(B(i*n)-B(t*f)))+B(B(_-o)*B(B(t*u)-B(s*n))))),i=B(c-k),c=B(a-d),a=B(o-v),k=B(b-k),f=B(B(i*B(B(c*f)-B(a*u)))+B(B(B(g-d)*B(B(a*n)-B(k*f)))+B(B(_-v)*B(B(k*u)-B(c*n))))),!(l>B(0))|f>B(0)^1|t>B(0)^1?t<=B(0)&l<=B(0)&f<=B(0):1;}(c+60|0,k,k+16|0))y=B(b-B(f*d)),p=B(l-B(f*s)),D=B(o-B(f*u)),h=B(n*n);else {if((0|yf[t[t[c>>2]+100>>2]](c))<1)break r;for(h=B(n*n),R=0,_=r+4|0,c=0;m=A+8|0,Y=t[m>>2],yf[t[t[Y>>2]+104>>2]](Y,c,k+16|0,k),n=B(0),w=C[k+16>>2],f=B(C[r>>2]-w),l=B(C[k>>2]-w),W=C[k+20>>2],b=B(C[_>>2]-W),v=B(C[k+4>>2]-W),F=C[k+24>>2],o=B(C[r+8>>2]-F),g=B(C[k+8>>2]-F),Z=B(B(B(f*l)+B(b*v))+B(o*g)),Z>B(0)&&(n=B(B(B(l*l)+B(v*v))+B(g*g)),Z<n?(n=B(Z/n),o=B(o-B(g*n)),b=B(b-B(v*n)),f=B(f-B(l*n))):(o=B(o-g),b=B(b-v),f=B(f-l),n=B(1))),B(B(B(f*f)+B(b*b))+B(o*o))<h&&(D=B(w+B(l*n)),p=B(W+B(v*n)),R=1,y=B(F+B(g*n))),c=c+1|0,m=t[m>>2],(0|c)<(0|yf[t[t[m>>2]+100>>2]](m));){}if(_=0,!R)break r;b=C[r+8>>2],l=C[r+4>>2],o=C[r>>2];}f=B(o-D),o=B(l-p),b=B(b-y),n=B(B(B(f*f)+B(o*o))+B(b*b)),n<h&&(n>B(1.1920928955078125e-7)?(u=b,n=B(Q(n)),b=B(B(1)/n),C[i+8>>2]=u*b,C[i+4>>2]=o*b,C[i>>2]=f*b,G=B(G-n)):(C[i+8>>2]=d,C[i+4>>2]=s,C[i>>2]=u),t[i+12>>2]=0,t[e+12>>2]=0,C[e+8>>2]=y,C[e+4>>2]=p,C[e>>2]=D,C[a>>2]=-G,_=1);}return E=k+32|0,_;}(A,i+88|0,i+128|0,i+112|0,i+108|0,C[A+12>>2])){if(!a)break A;k=C[r+72>>2],c=C[r- -64>>2],u=C[r+68>>2],l=C[r+88>>2],s=C[r+80>>2],d=C[r+84>>2],o=C[r+104>>2],v=C[r+96>>2],g=C[r+100>>2],f=C[i+120>>2],n=C[i+112>>2],b=C[i+116>>2],t[i+36>>2]=0,m=B(B(B(n*v)+B(b*g))+B(f*o)),C[i+32>>2]=-m,R=B(B(B(n*s)+B(b*d))+B(f*l)),C[i+28>>2]=-R,G=B(B(B(c*n)+B(u*b))+B(k*f)),C[i+24>>2]=-G,t[i+20>>2]=0,n=C[i+128>>2],b=C[i+132>>2],_=o,o=C[i+136>>2],f=C[i+108>>2],C[i+16>>2]=B(B(B(B(v*n)+B(g*b))+B(_*o))+C[r+120>>2])+B(m*f),C[i+12>>2]=B(B(B(B(n*s)+B(b*d))+B(o*l))+C[r+116>>2])+B(R*f),C[i+8>>2]=B(B(B(B(n*c)+B(b*u))+B(o*k))+C[r+112>>2])+B(G*f),yf[t[t[e>>2]+16>>2]](e,i+24|0,i+8|0,f);}return void(E=i+144|0);}t[i+36>>2]=0,f=C[i+112>>2],k=C[r+96>>2],n=C[i+116>>2],c=C[r+100>>2],b=C[i+120>>2],u=C[r+104>>2],C[i+32>>2]=B(B(f*k)+B(n*c))+B(b*u),l=C[r+80>>2],s=C[r+84>>2],d=C[r+88>>2],C[i+28>>2]=B(B(f*l)+B(n*s))+B(b*d),o=C[r- -64>>2],v=C[r+68>>2],g=C[r+72>>2],C[i+24>>2]=B(B(f*o)+B(n*v))+B(b*g),t[i+20>>2]=0,f=C[i+128>>2],n=C[i+132>>2],b=C[i+136>>2],C[i+16>>2]=B(B(B(k*f)+B(c*n))+B(u*b))+C[r+120>>2],C[i+12>>2]=B(B(B(f*l)+B(n*s))+B(b*d))+C[r+116>>2],C[i+8>>2]=B(B(B(f*o)+B(n*v))+B(b*g))+C[r+112>>2],yf[t[t[e>>2]+16>>2]](e,i+24|0,i+8|0,C[i+108>>2]),E=i+144|0;}function vi(A){var r,e=0,i=B(0),a=0,f=B(0),n=B(0);l(A),e=o(0),r=e>>>31;A:{r:{e&=2147483647;e:{if(e>>>0>=1283457024){if(A!=A)break e;return B(r?-1.570796251296997:1.570796251296997);}if(e>>>0>1054867455)break r;if(a=-1,e>>>0>=964689920)break A;}return A;}A=B(m(A));r:{e:{if(e>>>0<=1066926079){if(e>>>0>1060110335)break e;A=B(B(B(A+A)+B(-1))/B(A+B(2))),a=0;break A;}if(e>>>0>1075576831)break r;A=B(B(A+B(-1.5))/B(B(A*B(1.5))+B(1))),a=2;break A;}A=B(B(A+B(-1))/B(A+B(1))),a=1;break A;}A=B(B(-1)/A),a=3;}return e=a,f=B(A*A),i=B(f*f),n=B(i*B(B(i*B(-.106480173766613))+B(-.19999158382415771))),i=B(f*B(B(i*B(B(i*B(.06168760731816292))+B(.14253635704517365)))+B(.333333283662796))),(0|e)>-1?(e<<=2,A=B(C[e+17456>>2]-B(B(B(A*B(n+i))-C[e+17472>>2])-A)),r?B(-A):A):B(A-B(A*B(n+i)));}function Ci(A,r){var e,i,a,f=0,n=0,t=B(0);A:{if(r==r&A==A){if(l(r),f=o(0),1065353216!=(0|f))break A;return vi(A);}return B(A+r);}a=f>>>30&2,l(A),n=o(0),i=n>>>31,e=a|i;A:{r:{e:{i:{a:{f:{n:{t:{b:{if(n&=2147483647,n){if(f&=2147483647,2139095040==(0|f))break b;if(f)break t;return B(i?-1.5707963705062866:1.5707963705062866);}if(3==(0|e))break a;if(2==(0|e))break i;return A;}if(2139095040!=(0|n))break n;return C[17488+(e<<2)>>2];}if(2139095040==(0|n)|f+218103808>>>0<n>>>0)break f;if(n+218103808>>>0<f>>>0&&(t=B(0),a)||(t=vi(B(m(B(A/r))))),A=t,!e)break e;if(2==(0|e))break r;if(1!=(0|e))break A;return B(-A);}return C[17504+(e<<2)>>2];}return B(i?-1.5707963705062866:1.5707963705062866);}return B(-3.1415927410125732);}return B(3.1415927410125732);}return A;}return B(B(3.1415927410125732)-B(A+B(8.742277657347586e-8)));}return B(B(A+B(8.742277657347586e-8))+B(-3.1415927410125732));}function gi(A,r,e,i,a,f,n,b,o,k){var c,u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),R=B(0),G=0,h=B(0),y=B(0),p=B(0),D=B(0),w=0,W=B(0),F=0,Z=B(0),Y=B(0),N=B(0),V=B(0),I=B(0),X=B(0),M=B(0),x=B(0),S=B(0),T=B(0),U=0,j=B(0),O=B(0),H=B(0),z=B(0),P=B(0),L=B(0),K=B(0),q=B(0),$=B(0),AA=B(0),rA=B(0),eA=B(0),iA=B(0),aA=B(0),fA=B(0),nA=B(0),tA=B(0),bA=B(0),oA=B(0),kA=B(0),cA=B(0),uA=B(0),lA=0,sA=0,dA=0,vA=0,CA=0,gA=0;c=E-368|0,E=c,P=B(C[e>>2]*B(.5)),C[c+356>>2]=P,x=C[r+36>>2],U=r+4|0,S=C[U>>2],W=C[r+20>>2],rA=C[r+40>>2],w=r+8|0,eA=C[w>>2],T=C[r+24>>2],g=C[r+16>>2],y=C[r+32>>2],R=C[A>>2],h=C[i>>2],d=C[A+4>>2],l=C[i+4>>2],u=C[A+8>>2],s=C[i+8>>2],uA=C[r>>2],L=B(C[e+4>>2]*B(.5)),C[c+360>>2]=L,H=B(C[e+8>>2]*B(.5)),C[c+364>>2]=H,z=B(C[f>>2]*B(.5)),C[c+344>>2]=z,K=B(C[f+4>>2]*B(.5)),C[c+348>>2]=K,q=B(C[f+8>>2]*B(.5)),C[c+352>>2]=q;A:{v=B(h-R),p=B(l-d),Y=B(s-u),iA=B(B(B(uA*v)+B(g*p))+B(y*Y)),O=C[a>>2],$=C[a+16>>2],l=C[a+32>>2],fA=B(B(B(uA*O)+B(g*$))+B(y*l)),R=B(m(fA)),AA=C[a+4>>2],N=C[a+20>>2],V=C[a+36>>2],nA=B(B(B(uA*AA)+B(g*N))+B(y*V)),h=B(m(nA)),I=C[a+8>>2],D=C[a+24>>2],Z=C[a+40>>2],tA=B(B(B(uA*I)+B(g*D))+B(y*Z)),d=B(m(tA)),u=B(B(m(iA))-B(B(B(P+B(z*R))+B(K*h))+B(q*d)));r:if(!(u>B(0)||(bA=B(B(B(S*I)+B(W*D))+B(x*Z)),j=B(m(bA)),oA=B(B(B(S*AA)+B(W*N))+B(x*V)),X=B(m(oA)),kA=B(B(B(S*O)+B(W*$))+B(x*l)),M=B(m(kA)),s=B(-3.4028234663852886e38),e=0,u>B(-3.4028234663852886e38)&&(F=iA<B(0),s=u,G=r,e=1),aA=B(B(B(v*S)+B(p*W))+B(Y*x)),u=B(B(m(aA))-B(B(B(L+B(z*M))+B(K*X))+B(q*j))),u>B(0)||(cA=B(B(B(eA*I)+B(T*D))+B(rA*Z)),W=B(m(cA)),x=B(B(B(eA*AA)+B(T*N))+B(rA*V)),g=B(m(x)),S=B(B(B(eA*O)+B(T*$))+B(rA*l)),y=B(m(S)),u>s&&(F=aA<B(0),s=u,G=U,e=2),T=B(B(B(v*eA)+B(p*T))+B(Y*rA)),u=B(B(m(T))-B(B(B(H+B(z*y))+B(K*g))+B(q*W))),u>B(0)||(u>s&&(F=T<B(0),s=u,G=w,e=3),l=B(B(B(v*O)+B(p*$))+B(Y*l)),u=B(B(m(l))-B(z+B(B(H*y)+B(B(P*R)+B(L*M))))),u>B(0)||(u>s&&(F=l<B(0),s=u,G=a,e=4),l=B(B(B(v*AA)+B(p*N))+B(Y*V)),u=B(B(m(l))-B(K+B(B(H*g)+B(B(P*h)+B(L*X))))),u>B(0)||(u>s&&(G=a+4|0,F=l<B(0),s=u,e=5),l=B(B(B(v*I)+B(p*D))+B(Y*Z)),u=B(B(m(l))-B(q+B(B(H*W)+B(B(P*d)+B(L*j))))),u>B(0)||(u>s&&(G=a+8|0,F=l<B(0),s=u,e=6),l=B(B(T*kA)-B(aA*S)),V=B(h+B(9999999747378752e-21)),I=B(y+B(9999999747378752e-21)),D=B(M+B(9999999747378752e-21)),Z=B(d+B(9999999747378752e-21)),u=B(B(m(l))-B(B(q*V)+B(B(B(L*I)+B(H*D))+B(K*Z)))),u>B(1.1920928955078125e-7))))))))){O=B(g+B(9999999747378752e-21)),$=B(X+B(9999999747378752e-21)),AA=B(R+B(9999999747378752e-21)),Y=B(0),M=B(kA*kA),h=B(B(S*S)+B(0)),d=B(Q(B(M+h)));e:if(d>B(1.1920928955078125e-7)){if(p=B(0),u=B(u/d),v=B(0),!(B(u*B(1.0499999523162842))>s))break e;F=l<B(0),p=B(kA/d),Y=B(B(0)/d),G=0,e=7,s=u,v=B(B(-S)/d);}else p=B(0),v=B(0);if(l=B(B(T*oA)-B(aA*x)),u=B(B(m(l))-B(B(q*AA)+B(B(B(L*O)+B(H*$))+B(z*Z)))),!(u>B(1.1920928955078125e-7)||(N=B(W+B(9999999747378752e-21)),X=B(j+B(9999999747378752e-21)),W=B(oA*oA),d=B(B(x*x)+B(0)),R=B(Q(B(W+d))),R>B(1.1920928955078125e-7)&&(u=B(u/R),B(u*B(1.0499999523162842))>s&&(F=l<B(0),p=B(oA/R),v=B(B(-x)/R),Y=B(B(0)/R),G=0,e=8,s=u)),l=B(B(T*bA)-B(aA*cA)),u=B(B(m(l))-B(B(K*AA)+B(B(z*V)+B(B(L*N)+B(H*X))))),u>B(1.1920928955078125e-7)||(g=B(bA*bA),y=B(B(cA*cA)+B(0)),R=B(Q(B(g+y))),R>B(1.1920928955078125e-7)&&(u=B(u/R),B(u*B(1.0499999523162842))>s&&(F=l<B(0),p=B(bA/R),v=B(B(-cA)/R),Y=B(B(0)/R),G=0,e=9,s=u)),l=B(B(iA*S)-B(T*fA)),u=B(B(m(l))-B(B(q*$)+B(B(B(P*I)+B(H*AA))+B(K*X)))),u>B(1.1920928955078125e-7)||(R=B(fA*fA),h=B(Q(B(R+h))),h>B(1.1920928955078125e-7)&&(u=B(u/h),B(u*B(1.0499999523162842))>s&&(F=l<B(0),p=B(B(-fA)/h),v=B(B(0)/h),Y=B(S/h),G=0,e=10,s=u)),l=B(B(iA*x)-B(T*nA)),u=B(B(m(l))-B(B(q*D)+B(B(B(P*O)+B(H*V))+B(z*X)))),u>B(1.1920928955078125e-7)||(h=B(nA*nA),d=B(Q(B(h+d))),d>B(1.1920928955078125e-7)&&(u=B(u/d),B(u*B(1.0499999523162842))>s&&(F=l<B(0),p=B(B(-nA)/d),v=B(B(0)/d),Y=B(x/d),G=0,e=11,s=u)),l=B(B(iA*cA)-B(T*tA)),u=B(B(m(l))-B(B(K*D)+B(B(z*$)+B(B(P*N)+B(H*Z))))),u>B(1.1920928955078125e-7)||(d=B(tA*tA),y=B(Q(B(d+y))),y>B(1.1920928955078125e-7)&&(u=B(u/y),B(u*B(1.0499999523162842))>s&&(F=l<B(0),p=B(B(-tA)/y),v=B(B(0)/y),Y=B(cA/y),G=0,e=12,s=u)),l=B(B(aA*fA)-B(iA*kA)),u=B(B(m(l))-B(B(q*O)+B(B(B(P*D)+B(L*AA))+B(K*N)))),u>B(1.1920928955078125e-7)||(R=B(Q(B(B(M+R)+B(0)))),R>B(1.1920928955078125e-7)&&(u=B(u/R),B(u*B(1.0499999523162842))>s&&(F=l<B(0),p=B(B(0)/R),v=B(fA/R),Y=B(B(-kA)/R),G=0,e=13,s=u)),l=B(B(aA*nA)-B(iA*oA)),u=B(B(m(l))-B(B(q*I)+B(B(B(P*$)+B(L*V))+B(z*N)))),u>B(1.1920928955078125e-7)||(h=B(Q(B(B(W+h)+B(0)))),h>B(1.1920928955078125e-7)&&(u=B(u/h),B(u*B(1.0499999523162842))>s&&(F=l<B(0),p=B(B(0)/h),v=B(nA/h),Y=B(B(-oA)/h),G=0,e=14,s=u)),l=B(B(aA*tA)-B(iA*bA)),u=B(B(m(l))-B(B(K*I)+B(B(z*O)+B(B(P*X)+B(L*Z))))),u>B(1.1920928955078125e-7)))))))))){e:{i:{if(d=B(Q(B(B(g+d)+B(0)))),d>B(1.1920928955078125e-7)&&(u=B(u/d),B(u*B(1.0499999523162842))>s))F=l<B(0),p=B(B(0)/d),v=B(tA/d),Y=B(B(-bA)/d),e=15;else {if(!e)break r;if(G){if(d=C[G>>2],t[n>>2]=t[G>>2],g=C[G+16>>2],t[n+4>>2]=t[G+16>>2],v=C[G+32>>2],t[n+8>>2]=t[G+32>>2],u=s,F)break i;break e;}u=s;}if(d=B(B(B(uA*Y)+B(v*C[r+4>>2]))+B(p*C[r+8>>2])),C[n>>2]=d,g=B(B(B(Y*C[r+16>>2])+B(v*C[r+20>>2]))+B(p*C[r+24>>2])),C[n+4>>2]=g,v=B(B(B(Y*C[r+32>>2])+B(v*C[r+36>>2]))+B(p*C[r+40>>2])),C[n+8>>2]=v,!F)break e;}C[n+8>>2]=-v,C[n+4>>2]=-g,C[n>>2]=-d;}if(C[b>>2]=-u,(0|e)>=7)return w=c+120|0,t[w>>2]=t[A+8>>2],f=t[A+4>>2],t[c+112>>2]=t[A>>2],t[c+116>>2]=f,s=B(0),Z=C[c+112>>2],M=C[c+116>>2],N=C[n>>2],W=C[r>>2],b=n+4|0,j=C[b>>2],g=C[r+16>>2],f=n+8|0,X=C[f>>2],l=C[r+32>>2],V=B((B(B(B(N*W)+B(j*g))+B(X*l))>B(0)?B(1):B(-1))*C[c+356>>2]),D=B(C[w>>2]+B(V*l)),y=C[r+4>>2],R=C[r+20>>2],l=C[r+36>>2],I=B((B(B(B(N*y)+B(j*R))+B(X*l))>B(0)?B(1):B(-1))*C[c+360>>2]),v=B(D+B(I*l)),h=C[r+8>>2],d=C[r+24>>2],l=C[r+40>>2],D=B((B(B(B(N*h)+B(j*d))+B(X*l))>B(0)?B(1):B(-1))*H),C[w>>2]=v+B(D*l),C[c+116>>2]=B(B(M+B(V*g))+B(I*R))+B(D*d),C[c+112>>2]=B(B(Z+B(V*W))+B(I*y))+B(D*h),G=c+216|0,t[G>>2]=t[i+8>>2],W=C[a>>2],g=C[a+16>>2],l=C[a+32>>2],D=B((B(B(B(N*W)+B(j*g))+B(X*l))>B(0)?B(-1):B(1))*z),v=B(C[G>>2]+B(D*l)),y=C[a+4>>2],R=C[a+20>>2],l=C[a+36>>2],Z=B((B(B(B(N*y)+B(j*R))+B(X*l))>B(0)?B(-1):B(1))*C[c+348>>2]),v=B(v+B(Z*l)),h=C[a+8>>2],d=C[a+24>>2],l=C[a+40>>2],M=B((B(B(B(N*h)+B(j*d))+B(X*l))>B(0)?B(-1):B(1))*C[c+352>>2]),V=B(v+B(M*l)),C[G>>2]=V,A=t[i+4>>2],t[c+208>>2]=t[i>>2],t[c+212>>2]=A,I=B(B(B(C[c+208>>2]+B(D*W))+B(Z*y))+B(M*h)),C[c+208>>2]=I,D=B(B(B(C[c+212>>2]+B(D*g))+B(Z*R))+B(M*d)),C[c+212>>2]=D,i=e+-7|0,A=(0|i)/3|0,r=r+(A<<2)|0,l=C[r>>2],A=(i-_(A,3)<<2)+a|0,Z=C[A>>2],y=C[r+16>>2],M=C[A+16>>2],R=C[r+32>>2],W=C[A+32>>2],g=B(B(B(l*Z)+B(y*M))+B(R*W)),h=B(B(1)-B(g*g)),h<=B(9999999747378752e-20)||(d=B(I-C[c+112>>2]),v=B(d*l),l=B(D-C[c+116>>2]),s=B(V-C[w>>2]),s=B(B(B(B(B(v+B(l*y))+B(s*R))*g)-B(B(B(d*Z)+B(l*M))+B(s*W)))*B(B(1)/h))),C[G>>2]=V+B(s*W),C[c+212>>2]=D+B(s*M),C[c+208>>2]=I+B(s*Z),t[c+284>>2]=0,C[c+280>>2]=-C[f>>2],C[c+276>>2]=-C[b>>2],C[c+272>>2]=-C[n>>2],yf[t[t[k>>2]+16>>2]](k,c+272|0,c+208|0,u),t[o>>2]=e,void(E=c+368|0);x=C[n>>2],(0|e)<=3?(S=C[n+8>>2],rA=C[n+4>>2],b=c+356|0,G=a,U=c+344|0):(x=B(-x),S=B(-C[n+8>>2]),rA=B(-C[n+4>>2]),f=i,b=c+344|0,i=A,A=f,G=r,r=a,U=c+356|0),d=B(B(B(x*C[G+8>>2])+B(rA*C[G+24>>2]))+B(S*C[G+40>>2])),C[c+336>>2]=d,u=B(B(B(x*C[G+4>>2])+B(rA*C[G+20>>2]))+B(S*C[G+36>>2])),C[c+332>>2]=u,s=B(B(B(x*C[G>>2])+B(rA*C[G+16>>2]))+B(S*C[G+32>>2])),C[c+328>>2]=s,l=B(m(u)),u=B(m(d)),a=l>u,s=B(m(s)),w=s>u,f=l>s,F=(f?a?1:2:(1^w)<<1)<<2,l=C[F+U>>2],u=B(l*C[G+F>>2]),s=B(C[i>>2]-C[A>>2]),vA=(f?a:w)?2:1,CA=(1^f)&w,a=c,C[F+(c+328|0)>>2]<B(0)?(v=B(s+u),C[c+312>>2]=v,s=B(B(C[i+4>>2]-C[A+4>>2])+B(l*C[(16|F)+G>>2])),C[c+316>>2]=s,D=B(B(C[i+8>>2]-C[A+8>>2])+B(l*C[(32|F)+G>>2]))):(v=B(s-u),C[c+312>>2]=v,s=B(B(C[i+4>>2]-C[A+4>>2])-B(l*C[(16|F)+G>>2])),C[c+316>>2]=s,D=B(B(C[i+8>>2]-C[A+8>>2])-B(l*C[(32|F)+G>>2]))),C[a+320>>2]=D;e:{i:{if(dA=((0|e)<4?-1:-4)+e|0,dA){if(a=1,1!=(0|dA))break i;a=2,f=0;break e;}a=2,f=1;break e;}f=0;}a<<=2,i=a+r|0,h=C[i>>2],d=C[i+16>>2],u=C[i+32>>2],eA=B(B(B(v*h)+B(s*d))+B(D*u)),i=CA<<2,lA=i+G|0,Z=C[lA>>2],M=C[lA+16>>2],W=C[lA+32>>2],j=B(B(B(h*Z)+B(d*M))+B(u*W)),l=C[i+U>>2],g=B(j*l),y=B(eA+g),i=vA<<2,sA=i+G|0,R=C[sA>>2],p=B(h*R),h=C[sA+16>>2],p=B(p+B(d*h)),d=C[sA+32>>2],X=B(p+B(u*d)),u=C[i+U>>2],N=B(X*u),C[c+300>>2]=y-N,i=f<<2,r=i+r|0,V=C[r>>2],I=C[r+16>>2],p=D,D=C[r+32>>2],T=B(B(B(v*V)+B(s*I))+B(p*D)),W=B(B(B(V*Z)+B(I*M))+B(D*W)),l=B(l*W),s=B(T+l),h=B(B(B(V*R)+B(I*h))+B(D*d)),R=B(u*h),C[c+296>>2]=s-R,C[c+292>>2]=y+N,p=B(s+R),C[c+288>>2]=p,u=B(eA-g),d=B(u+N),C[c+284>>2]=d,s=B(T-l),v=B(s+R),C[c+280>>2]=v,u=B(u-N),C[c+276>>2]=u,g=B(s-R),C[c+272>>2]=g,r=a+b|0,R=C[r>>2],gA=t[r>>2],r=i+b|0,F=t[r>>2],y=C[r>>2],l=B(-y);e:{i:{a:{Y=B(-g),i=y>Y;f:{if(i){if(C[c+212>>2]=u,C[c+208>>2]=g,r=c+208|8,f=1,a=2,s=B(-v),w=y>s,(0|i)!=(0|w))break f;break a;}if(f=0,a=1,r=c+208|0,s=B(-v),w=y>s,!(i^w))break a;}if(C[r>>2]=l,C[r+4>>2]=u+B(B(l-g)*B(B(d-u)/B(v-g))),r=r+8|0,w)break i;f=a;break e;}if(a=f,!w)break e;}C[r+4>>2]=d,C[r>>2]=v,f=a+1|0,r=r+8|0,v=C[c+280>>2],s=B(-v),p=C[c+288>>2];}e:{if((s<y|0)!=(y>B(-p)|0)){if(s=C[c+292>>2],u=C[c+284>>2],C[r>>2]=l,C[r+4>>2]=u+B(B(l-v)*B(B(s-u)/B(p-v))),f=f+1|0,8&f)break e;r=r+8|0;}if(v=C[c+288>>2],d=B(-v),y>d){if(C[r>>2]=v,t[r+4>>2]=t[c+292>>2],f=f+1|0,8&f)break e;v=C[c+288>>2],d=B(-v),r=r+8|0;}if(i=d<y,d=C[c+296>>2],p=B(-d),(0|i)!=(y>p|0)){if(s=C[c+300>>2],u=C[c+292>>2],C[r>>2]=l,C[r+4>>2]=u+B(B(l-v)*B(B(s-u)/B(d-v))),f=f+1|0,8&f)break e;d=C[c+296>>2],p=B(-d),r=r+8|0;}if(p<y){if(C[r>>2]=d,t[r+4>>2]=t[c+300>>2],f=f+1|0,8&f)break e;g=C[c+272>>2],Y=B(-g),d=C[c+296>>2],p=B(-d),r=r+8|0;}i:{a:{f:{n:{t:{b:{if((p<y|0)!=(Y<y|0)){if(s=C[c+276>>2],u=C[c+300>>2],C[r>>2]=l,C[r+4>>2]=u+B(B(l-d)*B(B(s-u)/B(g-d))),f=f+1|0,!(8&f))break b;break e;}if((0|f)<1)break t;}for(r=c+208|0,a=c+112|0,i=0;;){if(g=C[r>>2],g<y){if(C[a>>2]=g,t[a+4>>2]=t[r+4>>2],i=i+1|0,8&i)break n;g=C[r>>2],a=a+8|0;}if(w=r+8|0,U=(0|f)>1?w:c+208|0,u=C[U>>2],(g<y|0)!=(u<y|0)){if(l=C[r+4>>2],s=C[U+4>>2],t[a>>2]=F,C[a+4>>2]=l+B(B(y-g)*B(B(s-l)/B(u-g))),i=i+1|0,8&i)break n;a=a+8|0;}if(r=w,f=f+-1|0,!((0|f)>0))break;}if(!((0|i)<1)){for(d=B(-R),a=c+208|0,r=c+112|0,w=0;;){if(f=r+4|0,g=C[f>>2],v=B(-g),R>v){if(t[a>>2]=t[r>>2],t[a+4>>2]=t[f>>2],w=w+1|0,8&w)break a;g=C[f>>2],v=B(-g),a=a+8|0;}if(f=r+8|0,U=(0|i)>1?f:c+112|0,u=C[U+4>>2],(v<R|0)!=(R>B(-u)|0)){if(s=C[U>>2],l=C[r>>2],C[a+4>>2]=d,C[a>>2]=l+B(B(d-g)*B(B(s-l)/B(u-g))),w=w+1|0,8&w)break a;a=a+8|0;}if(r=f,i=i+-1|0,!((0|i)>0))break;}if(!((0|w)<1)){for(r=c+208|0,a=c+112|0,f=0;;){if(i=r+4|0,g=C[i>>2],g<R){if(t[a>>2]=t[r>>2],t[a+4>>2]=t[i>>2],f=f+1|0,8&f)break f;g=C[i>>2],a=a+8|0;}if(i=r+8|0,U=(0|w)>1?i:c+208|0,u=C[U+4>>2],(g<R|0)!=(u<R|0)){if(s=C[U>>2],l=C[r>>2],t[a+4>>2]=gA,C[a>>2]=l+B(B(R-g)*B(B(s-l)/B(u-g))),f=f+1|0,8&f)break f;a=a+8|0;}if(r=i,w=w+-1|0,!((0|w)>0))break;}break f;}}}f=0;break f;}f=i;}if(J(c+208|0,c+112|0,f<<3),(0|f)<1)break i;break e;}if(f=w,(0|f)>=1)break e;}break A;}for(s=B(B(1)/B(B(W*X)-B(j*h))),$=B(X*s),AA=B(j*s),N=B(h*s),j=B(W*s),X=C[(dA<<2)+b>>2],i=vA<<2,V=C[(32|i)+G>>2],r=CA<<2,I=C[(32|r)+G>>2],D=C[(16|i)+G>>2],Z=C[(16|r)+G>>2],M=C[c+320>>2],W=C[sA>>2],g=C[lA>>2],a=0,r=c+208|0,y=C[c+316>>2],R=C[c+312>>2];i=(c+112|0)+_(a,12)|0,h=C[r>>2],u=B(h-T),d=C[r+4>>2],s=B(d-eA),O=B(B($*u)-B(N*s)),s=B(B(j*s)-B(AA*u)),l=B(B(R+B(O*g))+B(s*W)),C[i>>2]=l,u=B(B(y+B(O*Z))+B(s*D)),C[i+4>>2]=u,s=B(B(M+B(O*I))+B(s*V)),C[i+8>>2]=s,s=B(X-B(B(B(x*l)+B(rA*u))+B(S*s))),C[(c+80|0)+(a<<2)>>2]=s,s>=B(0)&&(i=a<<3,C[i+(c+208|0)>>2]=h,C[(c+208|0)+(4|i)>>2]=d,a=a+1|0),r=r+8|0,f=f+-1|0,f;){}e:{i:{a:{if((0|a)>=1){if(r=(0|a)<4?a:4,f=(0|r)>1?r:1,(0|a)<=(0|f))break a;if(G=0,(0|a)>=2)for(r=c+80|4,d=C[c+80>>2],i=1;s=C[r>>2],b=s>d,d=b?s:d,G=b?i:G,r=r+4|0,i=i+1|0,(0|a)!=(0|i);){}if(function(A,r,e,i,a){var f,n=0,b=B(0),o=0,k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=0,_=B(0),R=0,G=0,h=B(0);f=E+-64|0,E=f;f:{n:{t:{if(1!=(0|A)){if(2!=(0|A))break t;k=B(B(C[r+4>>2]+C[r+12>>2])*B(.5)),b=B(B(C[r>>2]+C[r+8>>2])*B(.5));break n;}k=C[r+4>>2],b=C[r>>2];break n;}if(o=A+-1|0,(0|o)>=1)for(n=r;l=k,k=C[n+12>>2],c=C[n+4>>2],d=B(k+c),u=C[n>>2],n=n+8|0,s=C[n>>2],c=B(B(u*k)-B(s*c)),k=B(l+B(d*c)),b=B(b+c),v=B(v+B(B(u+s)*c)),o=o+-1|0,o;){}if(c=B(0xde0b6b000000000),l=b,n=(A<<3)+r|0,u=C[n+-8>>2],s=C[r+4>>2],d=C[r>>2],_=C[n+-4>>2],b=B(B(u*s)-B(d*_)),l=B(l+b),B(m(l))>B(1.1920928955078125e-7)&&(c=B(B(1)/B(l*B(3)))),o=0,(0|A)<=0)break f;k=B(B(k+B(B(s+_)*b))*c),b=B(B(v+B(B(u+d)*b))*c);}for(n=f+32|0,o=A;G=n,h=Ci(B(C[r+4>>2]-k),B(C[r>>2]-b)),C[G>>2]=h,r=r+8|0,n=n+4|0,o=o+-1|0,o;){}for(r=f,n=A;o=1,t[r>>2]=1,r=r+4|0,n=n+-1|0,n;){}}if(t[a>>2]=i,r=i<<2,n=r+f|0,t[n>>2]=0,!((0|e)<2))if(a=a+4|0,o)for(v=B(B(6.2831854820251465)/B(0|e)),c=C[r+(f+32|0)>>2],g=1;;){for(t[a>>2]=i,b=B(B(v*B(0|g))+c),u=b>B(3.1415927410125732)?B(b+B(-6.2831854820251465)):b,b=B(1e9),n=f+32|0,r=f,R=i,o=0;t[r>>2]&&(k=B(m(B(C[n>>2]-u))),k=k>B(3.1415927410125732)?B(B(6.2831854820251465)-k):k,k<b&&(t[a>>2]=o,R=o,b=k)),r=r+4|0,n=n+4|0,o=o+1|0,(0|o)!=(0|A);){}if(t[(R<<2)+f>>2]=0,a=a+4|0,g=g+1|0,(0|g)==(0|e))break;}else for(r=e+-1|0;t[a>>2]=i,t[n>>2]=0,a=a+4|0,r=r+-1|0,r;){}E=f- -64|0;}(a,c+208|0,f,G,c+32|0),(0|f)<1)break e;if((0|e)>=4)break i;for(r=c+32|0,i=0;a=t[r>>2],b=(c+112|0)+_(a,12)|0,C[c+72>>2]=C[b+8>>2]+C[A+8>>2],C[c+64>>2]=C[b>>2]+C[A>>2],C[c+68>>2]=C[b+4>>2]+C[A+4>>2],t[c+28>>2]=0,C[c+24>>2]=-C[n+8>>2],C[c+20>>2]=-C[n+4>>2],C[c+16>>2]=-C[n>>2],yf[t[t[k>>2]+16>>2]](k,c+16|0,c- -64|0,B(-C[(c+80|0)+(a<<2)>>2])),r=r+4|0,i=i+1|0,i>>>0<f>>>0;){}break e;}break A;}if((0|e)<4)for(i=c+80|0,r=c+112|0,f=a;C[c+32>>2]=C[r>>2]+C[A>>2],C[c+36>>2]=C[r+4>>2]+C[A+4>>2],C[c+40>>2]=C[r+8>>2]+C[A+8>>2],t[c+76>>2]=0,C[c+72>>2]=-C[n+8>>2],C[c+68>>2]=-C[n+4>>2],C[c+64>>2]=-C[n>>2],yf[t[t[k>>2]+16>>2]](k,c- -64|0,c+32|0,B(-C[i>>2])),r=r+12|0,i=i+4|0,f=f+-1|0,f;){}else for(i=c+80|0,r=c+112|0,f=a;l=C[n>>2],d=C[i>>2],C[c+32>>2]=B(C[r>>2]+C[A>>2])-B(l*d),u=C[n+4>>2],C[c+36>>2]=B(C[r+4>>2]+C[A+4>>2])-B(d*u),s=C[n+8>>2],C[c+40>>2]=B(C[r+8>>2]+C[A+8>>2])-B(d*s),t[c+76>>2]=0,C[c+72>>2]=-s,C[c+68>>2]=-u,C[c+64>>2]=-l,yf[t[t[k>>2]+16>>2]](k,c- -64|0,c+32|0,B(-d)),r=r+12|0,i=i+4|0,f=f+-1|0,f;){}break e;}for(r=c+32|0,i=0;a=t[r>>2],b=(c+112|0)+_(a,12)|0,R=B(C[b+8>>2]+C[A+8>>2]),C[c+72>>2]=R,h=B(C[b+4>>2]+C[A+4>>2]),C[c+68>>2]=h,d=B(C[b>>2]+C[A>>2]),C[c+64>>2]=d,t[c+28>>2]=0,l=C[n+8>>2],C[c+24>>2]=-l,u=C[n+4>>2],C[c+20>>2]=-u,s=C[n>>2],C[c+16>>2]=-s,t[c+12>>2]=0,D=l,l=C[(c+80|0)+(a<<2)>>2],C[c+8>>2]=R-B(D*l),C[c+4>>2]=h-B(u*l),C[c>>2]=d-B(s*l),yf[t[t[k>>2]+16>>2]](k,c+16|0,c,B(-l)),r=r+4|0,i=i+1|0,i>>>0<f>>>0;){}}t[o>>2]=e;}}return void(E=c+368|0);}E=c+368|0;}function _i(A,r,e,i,a){A|=0,r|=0,e|=0,i|=0,a|=0;var f=B(0),n=B(0),b=0,o=B(0),k=B(0),c=B(0),u=B(0);i=E-160|0,E=i,t[i+112>>2]=t[r>>2],t[i+64>>2]=t[r+64>>2],a=t[r+8>>2],t[i+116>>2]=t[r+4>>2],t[i+120>>2]=a,a=r+68|0,b=t[a+4>>2],t[i+68>>2]=t[a>>2],t[i+72>>2]=b,a=t[r+20>>2],t[i+128>>2]=t[r+16>>2],t[i+132>>2]=a,a=r+80|0,b=t[a+4>>2],t[i+80>>2]=t[a>>2],t[i+84>>2]=b,t[i+136>>2]=t[r+24>>2],t[i+88>>2]=t[r+88>>2],t[i+144>>2]=t[r+32>>2],t[i+96>>2]=t[r+96>>2],a=r+36|0,b=t[a+4>>2],t[i+148>>2]=t[a>>2],t[i+152>>2]=b,a=r+100|0,b=t[a+4>>2],t[i+100>>2]=t[a>>2],t[i+104>>2]=b,a=t[A+4>>2],n=C[a+40>>2],f=C[a+36>>2],o=C[a+32>>2],k=B(yf[t[t[a>>2]+48>>2]](a)),c=B(yf[t[t[a>>2]+48>>2]](a)),u=B(yf[t[t[a>>2]+48>>2]](a)),t[i+36>>2]=0,f=B(f+c),C[i+28>>2]=f+f,f=B(o+k),C[i+24>>2]=f+f,n=B(n+u),C[i+32>>2]=n+n,A=t[A+8>>2],n=C[A+40>>2],f=C[A+36>>2],o=C[A+32>>2],k=B(yf[t[t[A>>2]+48>>2]](A)),c=B(yf[t[t[A>>2]+48>>2]](A)),u=B(yf[t[t[A>>2]+48>>2]](A)),t[i+20>>2]=0,f=B(f+c),C[i+12>>2]=f+f,f=B(o+k),C[i+8>>2]=f+f,n=B(n+u),C[i+16>>2]=n+n,gi(r+48|0,i+112|0,i+24|0,r+112|0,i- -64|0,i+8|0,i+48|0,i+44|0,i+40|0,e),E=i+160|0;}function Bi(A,r,e,i,f,n,b){lA(A,r),t[A+24>>2]=b,t[A+20>>2]=n,a[A+16|0]=f,t[A+12>>2]=0,a[A+8|0]=0,t[A>>2]=17652,r=t[A+4>>2],n=f?i:e,e=f?e:i,yf[t[t[r>>2]+24>>2]](r,t[n+8>>2],t[e+8>>2])&&(r=t[A+4>>2],r=0|yf[t[t[r>>2]+12>>2]](r,t[n+8>>2],t[e+8>>2]),a[A+8|0]=1,t[A+12>>2]=r);}function mi(A,r,e,i,a){var f,n=B(0),o=B(0),k=B(0),c=0,u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=0,F=B(0),Z=B(0),Y=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=B(0),M=B(0),x=B(0),S=0,T=B(0),U=B(0),j=B(0),O=B(0),H=B(0),z=B(0),P=B(0),L=B(0),K=B(0),q=B(0),$=B(0),AA=B(0),rA=B(0),eA=B(0),iA=B(0),aA=B(0);f=E-48|0,E=f,W=b[A+16|0],S=W?i:e,c=t[S+12>>2],P=C[c+56>>2],L=C[c+52>>2],K=C[c+48>>2],W=W?e:i,e=t[W+12>>2],q=C[e+56>>2],T=C[e+48>>2],$=C[e+52>>2],S=t[S+4>>2],g=C[e+40>>2],u=C[e+8>>2],l=C[e+24>>2],s=C[e+32>>2],G=C[e>>2],h=C[e+16>>2],i=t[W+4>>2],Q=C[e+36>>2],Z=C[c+40>>2],Y=C[c+32>>2],N=C[c+36>>2],p=C[e+4>>2],V=C[c+8>>2],I=C[c>>2],J=C[c+4>>2],D=C[e+20>>2],X=C[c+24>>2],M=C[c+16>>2],x=C[c+20>>2],k=C[r+12>>2],d=C[r+8>>2],n=C[r>>2],o=C[r+4>>2],t[f+28>>2]=0,_=B(B(2)/B(B(B(B(n*n)+B(o*o))+B(d*d))+B(k*k))),v=B(d*_),U=B(n*v),m=B(o*_),j=B(k*m),y=B(U+j),F=B(o*v),R=B(n*_),O=B(k*R),_=B(F-O),H=B(n*R),z=B(o*m),o=B(B(1)-B(H+z)),R=B(B(B(Y*y)+B(N*_))+B(Z*o)),w=B(B(B(I*y)+B(J*_))+B(V*o)),o=B(B(B(M*y)+B(x*_))+B(X*o)),_=B(-C[i+52>>2]),e=i+56|0,y=C[e>>2],AA=B(B(B(B(s*R)+B(B(G*w)+B(h*o)))*_)-B(B(B(Q*R)+B(B(p*w)+B(D*o)))*y)),R=B(B(g*R)+B(B(u*w)+B(l*o))),c=i+60|0,o=C[c>>2],C[f+24>>2]=AA-B(R*o),R=B(F+O),m=B(n*m),w=B(k*v),n=B(m-w),F=B(d*v),k=B(B(1)-B(H+F)),d=B(B(Z*R)+B(B(Y*n)+B(N*k))),v=B(B(V*R)+B(B(I*n)+B(J*k))),n=B(B(X*R)+B(B(M*n)+B(x*k))),C[f+20>>2]=B(B(B(B(s*d)+B(B(G*v)+B(h*n)))*_)-B(y*B(B(Q*d)+B(B(p*v)+B(D*n)))))-B(o*B(B(g*d)+B(B(u*v)+B(l*n)))),n=B(U-j),k=B(m+w),d=B(B(1)-B(z+F)),v=B(B(Z*n)+B(B(N*k)+B(Y*d))),m=B(B(V*n)+B(B(J*k)+B(I*d))),n=B(B(X*n)+B(B(x*k)+B(M*d))),C[f+16>>2]=B(B(B(B(s*v)+B(B(G*m)+B(h*n)))*_)-B(y*B(B(Q*v)+B(B(p*m)+B(D*n)))))-B(o*B(B(g*v)+B(B(u*m)+B(l*n)))),yf[t[t[S>>2]+64>>2]](f+32|0,S,f+16|0),r=t[W+12>>2],y=C[r+48>>2],R=C[r+32>>2],w=C[r+16>>2],U=C[r+8>>2],j=C[r+4>>2],F=C[r>>2],O=C[r+56>>2],H=C[r+52>>2],z=C[r+40>>2],AA=C[r+36>>2],rA=C[r+24>>2],eA=C[r+20>>2],iA=C[i+68>>2],d=C[c>>2],v=C[i+52>>2],_=C[e>>2],n=C[f+40>>2],k=C[f+32>>2],o=C[f+36>>2],aA=C[t[A+12>>2]+784>>2],t[a+4>>2]=t[A+12>>2],m=B(-T),T=B(B(B(B(B(K*u)+B(L*l))+B(P*g))+B(B(B(u*m)-B(l*$))-B(g*q)))+B(B(B(k*B(B(B(I*u)+B(M*l))+B(Y*g)))+B(o*B(B(B(J*u)+B(x*l))+B(N*g))))+B(n*B(B(B(V*u)+B(X*l))+B(Z*g))))),G=B(B(B(B(B(K*G)+B(L*h))+B(P*s))+B(B(B(G*m)-B(h*$))-B(s*q)))+B(B(B(k*B(B(B(I*G)+B(M*h))+B(Y*s)))+B(o*B(B(B(J*G)+B(x*h))+B(N*s))))+B(n*B(B(B(V*G)+B(X*h))+B(Z*s))))),h=B(B(B(B(B(K*p)+B(L*D))+B(P*Q))+B(B(B(p*m)-B(D*$))-B(Q*q)))+B(B(B(k*B(B(B(I*p)+B(M*D))+B(Y*Q)))+B(o*B(B(B(J*p)+B(x*D))+B(N*Q))))+B(n*B(B(B(V*p)+B(X*D))+B(Z*Q))))),g=B(B(B(d*T)+B(B(v*G)+B(_*h)))-iA),g<aA&&(t[f+28>>2]=0,A=t[W+12>>2],u=C[i+52>>2],l=C[e>>2],s=C[c>>2],C[f+16>>2]=B(B(C[A>>2]*u)+B(C[A+4>>2]*l))+B(C[A+8>>2]*s),C[f+24>>2]=B(B(u*C[A+32>>2])+B(l*C[A+36>>2]))+B(s*C[A+40>>2]),C[f+20>>2]=B(B(u*C[A+16>>2])+B(l*C[A+20>>2]))+B(s*C[A+24>>2]),t[f+12>>2]=0,u=B(G-B(v*g)),l=B(h-B(_*g)),s=B(T-B(d*g)),C[f+8>>2]=B(B(B(u*R)+B(l*AA))+B(s*z))+O,C[f+4>>2]=B(B(B(u*w)+B(l*eA))+B(s*rA))+H,C[f>>2]=B(B(U*s)+B(B(F*u)+B(j*l)))+y,yf[t[t[a>>2]+16>>2]](a,f+16|0,f,g)),E=f+48|0;}function Ri(A,r){var e=0,i=0,f=0,n=0,b=0,o=0;t[A>>2]=17728,e=t[r+20>>2],f=CA(4,16),t[A+24>>2]=f,t[f>>2]=e?14864:15072,e=CA(20,16),function(A,r){t[A+12>>2]=0,t[A+16>>2]=3,t[A>>2]=15488,a[A+4|0]=0,t[A+8>>2]=r;}(e,t[A+24>>2]),t[A+28>>2]=e,e=CA(8,16),t[e>>2]=17844,a[e+4|0]=0,t[A+32>>2]=e,e=CA(8,16),t[e>>2]=17928,a[e+4|0]=0,t[A+36>>2]=e,e=CA(8,16),t[e>>2]=18020,a[e+4|0]=0,t[A+40>>2]=e,e=CA(8,16),t[e>>2]=18100,a[e+4|0]=0,t[A+44>>2]=e,e=CA(8,16),t[e>>2]=18188,a[e+4|0]=0,t[A+48>>2]=e,e=CA(8,16),t[e>>2]=18272,a[e+4|0]=0,t[A+52>>2]=e,e=CA(8,16),t[e>>2]=18340,a[e+4|0]=0,t[A+56>>2]=e,e=CA(8,16),t[e>>2]=18424,a[e+4|0]=0,t[A+72>>2]=e,e=CA(8,16),t[A+76>>2]=e,t[e>>2]=18424,a[e+4|0]=1,e=CA(8,16),t[e>>2]=18508,a[e+4|0]=0,t[A+68>>2]=e,e=CA(16,16),t[e+8>>2]=1,t[e+12>>2]=0,t[e>>2]=18584,a[e+4|0]=0,t[A+84>>2]=e,e=CA(16,16),t[e+8>>2]=1,t[e+12>>2]=0,t[e>>2]=18584,t[A+80>>2]=e,a[e+4|0]=1,n=t[r+16>>2];A:{e=t[r>>2];r:{if(e){if(t[A+8>>2]=e,a[A+12|0]=0,e=t[r+4>>2],!e)break r;break A;}if(a[A+12|0]=1,i=CA(24,16),t[i+20>>2]=0,t[i>>2]=804,e=t[r+8>>2],t[i+4>>2]=e,e=CA(_(e,804),16),t[i+12>>2]=e,t[i+16>>2]=e,f=t[i+4>>2],t[i+8>>2]=f,1==(0|f))f=e;else for(b=1-f|0,o=t[i>>2];f=e+o|0,t[e>>2]=f,e=f,b=b+1|0,b;){}if(t[f>>2]=0,t[A+8>>2]=i,e=t[r+4>>2],e)break A;}if(a[A+20|0]=1,i=CA(24,16),t[i+20>>2]=0,e=(0|n)>80?n:80,e=(0|e)>116?e+16&-16:128,t[i>>2]=e,r=t[r+12>>2],t[i+4>>2]=r,e=CA(_(r,e),16),t[i+12>>2]=e,t[i+16>>2]=e,r=t[i+4>>2],t[i+8>>2]=r,1!=(0|r)){for(f=1-r|0,n=t[i>>2];r=e+n|0,t[e>>2]=r,e=r,f=f+1|0,f;){}return t[r>>2]=0,void(t[A+16>>2]=i);}return t[e>>2]=0,void(t[A+16>>2]=i);}t[A+16>>2]=e,a[A+20|0]=0;}function Gi(A){A|=0;var r=0;return t[A>>2]=17728,b[A+20|0]&&(gA(t[t[A+16>>2]+16>>2]),gA(t[A+16>>2])),b[A+12|0]&&(gA(t[t[A+8>>2]+16>>2]),gA(t[A+8>>2])),r=t[A+28>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+28>>2]),r=t[A+32>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+32>>2]),r=t[A+36>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+36>>2]),r=t[A+40>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+40>>2]),r=t[A+44>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+44>>2]),r=t[A+48>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+48>>2]),r=t[A+52>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+52>>2]),r=t[A+56>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+56>>2]),r=t[A+72>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+72>>2]),r=t[A+76>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+76>>2]),r=t[A+68>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+68>>2]),r=t[A+84>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+84>>2]),r=t[A+80>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+80>>2]),r=t[A+24>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+24>>2]),0|A;}function hi(A){return A|=0,t[A+8>>2];}function yi(A){var r,e=0,i=0,f=0,n=0,o=0,k=0,c=0,u=0;if(t[A>>2]=18664,t[A+24>>2]=0,t[A+68>>2]=0,a[A+20|0]=1,r=A+16|0,t[r>>2]=0,a[A+44|0]=1,i=A+8|0,e=i,t[e>>2]=0,t[e+4>>2]=0,t[A+40>>2]=0,a[A- -64|0]=1,e=A+32|0,t[e>>2]=0,t[e+4>>2]=0,t[A+60>>2]=0,e=A+52|0,t[e>>2]=0,t[e+4>>2]=0,e=CA(32,16),f=t[i>>2],(0|f)>=1)for(i=12;n=i+e|0,o=t[r>>2]+i|0,t[n+-12>>2]=t[o+-12>>2],k=o+-8|0,u=t[k+4>>2],c=n+-8|0,t[c>>2]=t[k>>2],t[c+4>>2]=u,t[n>>2]=t[o>>2],i=i+16|0,f=f+-1|0,f;){}i=t[r>>2],i&&(b[A+20|0]&&gA(i),t[A+16>>2]=0),t[A+16>>2]=e,a[A+20|0]=1,t[A+12>>2]=2,Qi(A);}function Qi(A){var r,e,i=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0;if(e=t[A+32>>2],r=t[A+12>>2],!((0|e)>=(0|r))){A:{r:{e:{if(t[A+36>>2]<(0|r)){if(!r)break e;n=CA(r<<2,16),i=t[A+32>>2];break r;}n=t[A+40>>2];break A;}i=e;}f=t[A+40>>2];r:{if((0|i)>=1)for(o=n,k=f;t[o>>2]=t[k>>2],o=o+4|0,k=k+4|0,i=i+-1|0,i;){}else if(!f)break r;i=A+44|0,b[0|i]&&gA(f),t[A+40>>2]=n,a[0|i]=1,t[A+36>>2]=r;break A;}t[A+40>>2]=n,a[A+44|0]=1,t[A+36>>2]=r;}if(i=e<<2,c=r<<2,x(i+n|0,0,c-i|0),t[A+32>>2]=r,l=A+52|0,u=t[l>>2],(0|u)<(0|r)){A:{r:{e:{if(t[A+56>>2]<(0|r)){if(!r)break e;n=CA(c,16),i=t[A+52>>2];break r;}n=t[A+60>>2];break A;}n=0,i=u;}f=t[A+60>>2];r:{if((0|i)>=1)for(o=n,k=f;t[o>>2]=t[k>>2],o=o+4|0,k=k+4|0,i=i+-1|0,i;){}else if(!f)break r;i=A- -64|0,b[0|i]&&gA(f),t[A+60>>2]=n,a[0|i]=1,t[A+56>>2]=r;break A;}t[A+60>>2]=n,a[A- -64|0]=1,t[A+56>>2]=r;}i=u<<2,x(i+n|0,0,c-i|0);}if(t[l>>2]=r,(0|r)>=1&&(x(t[A+40>>2],255,c),x(t[A+60>>2],255,c)),!((0|e)<1))for(k=t[A+60>>2],n=t[A+40>>2],o=t[A+16>>2],i=0,A=A+12|0;f=t[t[o>>2]+12>>2]|t[t[o+4>>2]+12>>2]<<16,f=(f<<15^-1)+f|0,f=_(f>>>10^f,9),f^=f>>>6,f=(f<<11^-1)+f|0,f=n+((t[A>>2]+-1&(f>>>16^f))<<2)|0,t[k>>2]=t[f>>2],t[f>>2]=i,o=o+16|0,k=k+4|0,i=i+1|0,(0|i)!=(0|e);){}}}function pi(A){return A|=0,A+4|0;}function Di(A,r){A|=0,r|=0,t[A+24>>2]=r;}function wi(A){var r,e=0,i=0,f=0,n=0,o=0,k=0,c=0;if(r=E-32|0,E=r,t[A>>2]=19188,ie(A+4|0),ie(A+44|0),t[A+168>>2]=0,a[A+172|0]=1,i=A+160|0,e=i,t[e>>2]=0,t[e+4>>2]=0,a[A+153|0]=256,a[A+154|0]=1,a[A+152|0]=1,t[A+124>>2]=0,t[A+100>>2]=0,t[A+104>>2]=0,t[A+136>>2]=0,t[A+128>>2]=0,t[A+132>>2]=0,t[A+116>>2]=10,t[A+120>>2]=1,t[A+108>>2]=1,t[A+112>>2]=0,e=CA(72,16),yi(e),i=t[i>>2],t[A+148>>2]=0,t[A+96>>2]=e,t[A+140>>2]=0,t[A+144>>2]=0,t[A+92>>2]=0,e=A+84|0,t[e>>2]=0,t[e+4>>2]=0,t[r+20>>2]=0,a[r+24|0]=1,t[r+12>>2]=0,t[r+16>>2]=0,(0|i)>=2)for(f=i+-1|0,i=36,k=A+168|0;e=t[k>>2]+i|0,c=e+-12|0,n=e+-4|0,o=t[n>>2],o&&(b[0|e]&&gA(o),t[n>>2]=0),t[n>>2]=0,t[c>>2]=0,a[0|e]=1,t[e+-8>>2]=0,i=i+20|0,f=f+-1|0,f;){}else if(1!=(0|i))for(function(A){var r=0,e=0,i=0,f=0,n=0,o=0,k=0,c=0;if(t[A+8>>2]<1){if(n=CA(20,16),r=t[A+4>>2],!((0|r)<1)){for(i=A+12|0;Wi(e+n|0,t[i>>2]+e|0),e=e+20|0,r=r+-1|0,r;){}if(i=t[A+4>>2],!((0|i)<1))for(k=A+12|0,r=8;e=t[k>>2]+r|0,c=e+-4|0,f=e+4|0,o=t[f>>2],o&&(b[e+8|0]&&gA(o),t[f>>2]=0),t[c>>2]=0,t[f>>2]=0,t[e>>2]=0,a[e+8|0]=1,r=r+20|0,i=i+-1|0,i;){}}r=t[A+12>>2],r&&(b[A+16|0]&&gA(r),t[A+12>>2]=0),a[A+16|0]=1,t[A+12>>2]=n,t[A+8>>2]=1;}}(A+156|0),e=_(i,20),i=1-i|0,f=A+168|0;Wi(t[f>>2]+e|0,r+8|0),e=e+20|0,i=i+-1|0,i;){}t[A+160>>2]=1,A=t[r+20>>2],A&&(b[r+24|0]&&gA(A),t[r+20>>2]=0),E=r+32|0;}function Wi(A,r){var e=0,i=0,f=0,n=0,o=0;if(t[A+4>>2]=0,t[A+8>>2]=0,t[A+12>>2]=0,a[A+16|0]=1,f=t[r+4>>2],(0|f)>0){if(n=CA(f<<2,16),i=t[A+4>>2],(0|i)>=1)for(o=A+12|0;t[e+n>>2]=t[t[o>>2]+e>>2],e=e+4|0,i=i+-1|0,i;){}for(o=A+12|0,i=t[o>>2],i&&(b[A+16|0]&&gA(i),t[A+12>>2]=0),t[o>>2]=n,a[A+16|0]=1,t[A+8>>2]=f,e=0,i=f;t[e+n>>2]=0,e=e+4|0,n=t[o>>2],i=i+-1|0,i;){}if(t[A+4>>2]=f,(0|f)>=1)for(e=0,A=r+12|0;t[e+n>>2]=t[t[A>>2]+e>>2],e=e+4|0,f=f+-1|0,f;){}}else t[A+4>>2]=f;}function Fi(A){A|=0;var r=0,e=0,i=0,f=0,n=0,o=0,k=0;if(t[A>>2]=19188,b[A+152|0]&&(r=t[A+96>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+96>>2])),i=t[A+160>>2],(0|i)>=1)for(o=A+168|0,e=8;r=t[o>>2]+e|0,k=r+-4|0,f=r+4|0,n=t[f>>2],n&&(b[r+8|0]&&gA(n),t[f>>2]=0),t[k>>2]=0,t[f>>2]=0,t[r>>2]=0,a[r+8|0]=1,e=e+20|0,i=i+-1|0,i;){}return r=A+168|0,e=t[r>>2],e&&(b[A+172|0]&&gA(e),t[A+168>>2]=0),t[r>>2]=0,a[A+172|0]=1,r=A+160|0,t[r>>2]=0,t[r+4>>2]=0,ae(A+44|0),ae(A+4|0),0|A;}function Zi(A,r,e,i){var a,f=0,n=0,b=0,o=0,k=0,c=0,u=0,l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=0;if(a=E-256|0,E=a,r){for(l=C[e+24>>2],s=C[e+20>>2],d=C[e+16>>2],v=C[e+8>>2],g=C[e+4>>2],_=C[e>>2],t[a>>2]=r,n=64,A=a,e=1;;){A:{r:{e:{if(r=e+-1|0,c=r<<2,f=t[c+A>>2],!(C[f>>2]<=d^1|C[f+16>>2]>=_^1|C[f+4>>2]<=s^1|C[f+20>>2]>=g^1||C[f+8>>2]<=l^1|C[f+24>>2]>=v^1)){if(u=f+40|0,t[u>>2]){if(m=t[f+36>>2],(0|r)==(0|n)&&(b=n?n<<1:1,(0|e)<=(0|b)))break e;b=n,f=A;break r;}yf[t[t[i>>2]+12>>2]](i,f);}if(e=r,(0|e)>0)continue;break A;}e:{i:{a:{f:{if(b){if(f=CA(b<<2,16),(0|n)<1)break f;break a;}if(f=0,(0|n)>=1)break a;}if(!A|!k)break e;break i;}for(r=f,o=A;t[r>>2]=t[o>>2],r=r+4|0,o=o+4|0,n=n+-1|0,n;){}if(!k)break e;}gA(A);}k=1;}t[f+c>>2]=m,c=t[u>>2];r:{e:{i:{a:{f:{n:{t:{if((0|e)==(0|b)){if(n=e?e<<1:1,(0|e)>=(0|n))break t;if(!n)break n;if(A=CA(n<<2,16),(0|e)<1)break f;break a;}n=b,A=f;break r;}n=e,A=f;break r;}if(A=0,(0|e)>=1)break a;}if(!f|!k)break e;break i;}for(r=A,o=f,b=e;t[r>>2]=t[o>>2],r=r+4|0,o=o+4|0,b=b+-1|0,b;){}if(!k)break e;}gA(f);}k=1;}if(t[(e<<2)+A>>2]=c,e=e+1|0,(0|e)>0)continue;}break;}!A|!k||gA(A);}E=a+256|0;}function Yi(A,r,e,i,f,n,o,k,c,u){var l,s=0,d=0,v=0,g=B(0),_=0,m=0,R=B(0),G=B(0),h=B(0),y=0,Q=B(0),p=B(0),D=0,w=0,W=B(0),F=0,Z=0,Y=0,N=0;l=E-32|0,E=l;A:if(r){if(s=t[c+4>>2],(0|s)<=127){if(t[c+8>>2]<=127){if(v=CA(512,16),d=t[c+4>>2],(0|d)>=1)for(A=0,m=c+12|0;t[A+v>>2]=t[t[m>>2]+A>>2],A=A+4|0,d=d+-1|0,d;){}A=t[c+12>>2],A&&(b[c+16|0]&&gA(A),t[c+12>>2]=0),a[c+16|0]=1,t[c+12>>2]=v,t[c+8>>2]=128;}for(A=s<<2,d=128-s|0,s=c+12|0;t[t[s>>2]+A>>2]=0,A=A+4|0,d=d+-1|0,d;){}}for(D=c+4|0,t[D>>2]=128,t[t[c+12>>2]>>2]=r,s=126,m=c+12|0,Y=l+16|0,N=l+28|0,A=1;;){t[l+12>>2]=0,d=t[m>>2],r=A+-1|0,w=r<<2,v=t[d+w>>2],C[l+8>>2]=C[v+8>>2]-C[k+8>>2],C[l+4>>2]=C[v+4>>2]-C[k+4>>2],C[l>>2]=C[v>>2]-C[k>>2],R=C[v+24>>2],G=C[v+16>>2],g=C[o+8>>2],h=C[o>>2],C[l+20>>2]=C[v+20>>2]-C[o+4>>2],C[Y>>2]=G-h,C[l+24>>2]=R-g,t[N>>2]=0;r:{e:{i:{a:{f:{if(_=t[f+4>>2],h=C[e+4>>2],Q=C[i+4>>2],R=B(B(C[4+((_<<4)+l|0)>>2]-h)*Q),g=C[i>>2],y=t[f>>2],p=C[e>>2],G=B(g*B(C[(1-y<<4)+l>>2]-p)),!(R>G||(g=B(B(C[(y<<4)+l>>2]-p)*g),h=B(Q*B(C[4+((1-_<<4)+l|0)>>2]-h)),g>h||(_=t[f+8>>2],p=C[e+8>>2],W=C[i+8>>2],Q=B(B(C[8+((_<<4)+l|0)>>2]-p)*W),G=h<G?h:G,Q>G||(R=R>g?R:g,g=B(W*B(C[8+((1-_<<4)+l|0)>>2]-p)),R>g|(Q>R?Q:R)<n^1|(g<G?g:G)>B(0)^1))))){if(F=v+40|0,t[F>>2]){if((0|r)<=(0|s))break r;if(s=t[D>>2],_=s<<1,(0|s)>=(0|_))break e;if(Z=c+8|0,t[Z>>2]>=(0|_))break i;if(!s)break f;if(d=CA(s<<3,16),y=t[D>>2],(0|y)>=1)for(r=0;t[r+d>>2]=t[t[m>>2]+r>>2],r=r+4|0,y=y+-1|0,y;){}break a;}yf[t[t[u>>2]+12>>2]](u,v);}if(A=r,r)continue;break A;}d=0;}r=t[m>>2],r&&(b[c+16|0]&&gA(r),t[m>>2]=0),t[m>>2]=d,a[c+16|0]=1,t[Z>>2]=_;}for(r=s<<2;t[r+d>>2]=0,r=r+4|0,d=t[m>>2],s=s+-1|0,s;){}}t[D>>2]=_,s=_+-2|0;}if(t[d+w>>2]=t[v+36>>2],t[t[m>>2]+(A<<2)>>2]=t[F>>2],A=A+1|0,!A)break;}}E=l+32|0;}function Ei(A,r,e,i){var f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,g=0,_=0,B=0;A:if(!(!r|!e)){if(s=A+24|0,!(t[s>>2]>127|t[A+28>>2]>127)){if(n=CA(1024,16),f=t[A+24>>2],(0|f)>=1)for(o=A+32|0;u=t[o>>2]+k|0,l=t[u+4>>2],c=n+k|0,t[c>>2]=t[u>>2],t[c+4>>2]=l,k=k+8|0,f=f+-1|0,f;){}f=A+32|0,o=t[f>>2],o&&(b[A+36|0]&&gA(o),t[A+32>>2]=0),t[f>>2]=n,a[A+36|0]=1,t[A+28>>2]=128;}for(t[s>>2]=128,c=A+32|0,f=t[c>>2],t[f+4>>2]=e,t[f>>2]=r,r=124,v=A+28|0,g=A+36|0,f=1;;){if(e=t[c>>2],A=f,f=f+-1|0,l=f<<3,n=e+l|0,o=t[n+4>>2],n=t[n>>2],(0|f)>(0|r)){if(r=t[s>>2],u=r<<1,!((0|r)>=(0|u)|t[v>>2]>=(0|u))){if(r){if(e=CA(r<<4,16),r=t[s>>2],(0|r)>=1)for(k=0;_=t[c>>2]+k|0,B=t[_+4>>2],d=e+k|0,t[d>>2]=t[_>>2],t[d+4>>2]=B,k=k+8|0,r=r+-1|0,r;){}}else e=0;k=t[c>>2],k&&(b[0|g]&&gA(k),t[c>>2]=0),t[c>>2]=e,a[0|g]=1,t[v>>2]=u;}t[s>>2]=u,r=u+-4|0;}r:{e:{i:{a:{if((0|n)!=(0|o)){if(C[n>>2]<=C[o+16>>2]^1|C[n+16>>2]>=C[o>>2]^1|C[n+4>>2]<=C[o+20>>2]^1|C[n+20>>2]>=C[o+4>>2]^1)break a;if(C[n+8>>2]<=C[o+24>>2]^1|C[n+24>>2]>=C[o+8>>2]^1)break a;if(k=o+40|0,d=t[k>>2],u=n+40|0,!t[u>>2])break i;if(f=t[n+36>>2],!d)break e;if(e=e+l|0,t[e+4>>2]=t[o+36>>2],t[e>>2]=f,f=t[u>>2],e=A<<3,l=e+t[c>>2]|0,t[l+4>>2]=t[o+36>>2],t[l>>2]=f,f=t[n+36>>2],n=e+t[c>>2]|0,t[n+12>>2]=t[k>>2],t[n+8>>2]=f,f=t[u>>2],e=e+t[c>>2]|0,t[e+20>>2]=t[k>>2],t[e+16>>2]=f,f=A+3|0,f)continue;break A;}o=n+40|0,t[o>>2]&&(e=e+l|0,f=t[n+36>>2],t[e+4>>2]=f,t[e>>2]=f,e=A<<3,f=e+t[c>>2]|0,o=t[o>>2],t[f+4>>2]=o,t[f>>2]=o,f=t[n+40>>2],e=8+(e+t[c>>2]|0)|0,t[e>>2]=t[n+36>>2],t[e+4>>2]=f,f=A+2|0);}if(f)continue;break A;}if(!d)break r;if(e=e+l|0,t[e+4>>2]=t[o+36>>2],t[e>>2]=n,e=t[c>>2]+(A<<3)|0,t[e+4>>2]=t[k>>2],t[e>>2]=n,f=A+1|0,f)continue;break A;}if(e=e+l|0,t[e+4>>2]=o,t[e>>2]=f,e=t[u>>2],f=t[c>>2]+(A<<3)|0,t[f+4>>2]=o,t[f>>2]=e,f=A+1|0,f)continue;break A;}if(yf[t[t[i>>2]+8>>2]](i,n,o),!f)break;}}}function Ni(A,r,e,i){var a,f=0,n=0,b=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,C=0,g=0,_=0,B=0,m=0,R=0,G=0,h=0,y=0,Q=0,p=0,D=0,w=0,W=0,F=0,Z=0,Y=0;a=A+12|0;A:for(;;){w=e,u=t[a>>2],f=u+((e+i|0)/2<<4)|0,m=t[f+8>>2],c=t[f+4>>2],k=i,l=t[f>>2],f=0,l&&(f=1);r:for(;;){e:if(f){if(W=t[l+12>>2],R=-1,y=-1,n=(e<<4)+u|0,s=t[n>>2],!s){f=1;break e;}f=0;}else G=-1,Q=-1,n=(e<<4)+u|0,d=t[n>>2],f=d?2:3;for(;;){e:{i:{a:{f:{n:{t:{b:{o:{k:{c:{u:{l:{s:{d:{v:{C:switch(0|f){case 0:y=t[s+12>>2],f=1;continue;case 1:b=t[n+4>>2],b&&(R=t[b+12>>2]),f=c?t[c+12>>2]:-1;g:if(!((0|y)>(0|W))){if(!((0|l)!=(0|s)|(0|R)>(0|f))){if((0|b)!=(0|c))break v;if(v[n+8>>2]>m>>>0)break g;break v;}if((0|l)!=(0|s)|(0|R)<=(0|f))break v;}if(e=e+1|0,R=-1,y=-1,n=n+16|0,s=t[n>>2],!s)break o;f=0;continue;case 2:Q=t[d+12>>2],f=3;continue;case 6:break u;case 5:break s;case 4:break d;case 3:break C;default:break c;}b=t[n+4>>2],b&&(G=t[b+12>>2]),f=c?t[c+12>>2]:-1;C:if(!((0|Q)>-1)){if(!(d|(0|G)>(0|f))){if((0|b)!=(0|c))break v;if(v[n+8>>2]>m>>>0)break C;break v;}if((0|G)<=(0|f)|d)break v;}if(e=e+1|0,G=-1,Q=-1,n=n+16|0,d=t[n>>2],!d)break b;f=2;continue;}if(!l)break l;if(F=t[l+12>>2],_=-1,p=-1,o=(k<<4)+u|0,C=t[o>>2],C)break n;break t;}p=t[C+12>>2],f=5;continue;}_=c?t[c+12>>2]:_,b=t[o+4>>2],f=b?t[b+12>>2]:-1;s:if(!((0|F)>(0|p))){if(!((0|l)!=(0|C)|(0|_)>(0|f))){if((0|b)!=(0|c))break k;if(v[o+8>>2]<m>>>0)break s;break k;}if((0|l)!=(0|C)|(0|_)<=(0|f))break k;}if(k=k+-1|0,_=-1,p=-1,o=o+-16|0,C=t[o>>2],!C)break f;f=4;continue;}if(B=-1,D=-1,o=(k<<4)+u|0,g=t[o>>2],g)break i;break a;}D=t[g+12>>2],f=7;continue;}B=c?t[c+12>>2]:B,b=t[o+4>>2],f=b?t[b+12>>2]:-1;c:if(!((0|D)<-1)){if(!(g|(0|B)>(0|f))){if((0|b)!=(0|c))break k;if(v[o+8>>2]<m>>>0)break c;break k;}if((0|B)<=(0|f)|g)break k;}if(k=k+-1|0,B=-1,D=-1,o=o+-16|0,g=t[o>>2],!g)break e;f=6;continue;}k:{if((0|e)<=(0|k)&&(f=(e<<4)+u|0,u=t[f+4>>2],b=t[f+8>>2],Z=t[f+12>>2],h=o+8|0,Y=t[h+4>>2],f=n+8|0,t[f>>2]=t[h>>2],t[f+4>>2]=Y,h=t[n>>2],f=t[o+4>>2],t[n>>2]=t[o>>2],t[n+4>>2]=f,f=t[a>>2]+(k<<4)|0,t[f+12>>2]=Z,t[f+4>>2]=u,t[f+8>>2]=b,t[f>>2]=h,k=k+-1|0,e=e+1|0),(0|e)<=(0|k)){if(u=t[a>>2],!l)break k;f=1;continue r;}if((0|k)>(0|w)&&Ni(A,r,w,k),(0|e)<(0|i))continue A;return;}f=0;continue r;}f=1;continue;}f=3;continue;}f=5;continue;}f=4;continue;}f=5;continue;}f=7;continue;}f=6;continue;}f=7;}}}}function Vi(A,r){A|=0,r|=0,A=t[A+4>>2],yf[t[t[A>>2]+8>>2]](A,t[r+36>>2]);}function Ii(A,r){var e=B(0),i=0,a=0,f=0,n=0,t=B(0),b=0,c=B(0),u=B(0),d=B(0),v=B(0),g=0,_=0,R=B(0),G=B(0),h=B(0),y=B(0);t=B(1);A:{r:{e:if(l(A),f=o(0),1065353216!=(0|f)&&(l(r),b=o(0),i=2147483647&b,i)){i:{a:{f:{if(a=2147483647&f,!(a>>>0>2139095040|i>>>0>=2139095041)){if((0|f)<=-1)break f;break a;}return B(A+r);}if(g=2,i>>>0>1266679807)break i;if(!(i>>>0<1065353216)){if(n=150-(i>>>23)|0,_=i>>>n,g=0,(0|i)!=_<<n)break i;g=2-(1&_)|0;break i;}}g=0;}n=g;i:{a:{f:{n:{t:{if(1065353216!=(0|i)){if(2139095040!=(0|i))break t;if(1065353216!=(0|a))break n;break e;}return (0|b)>-1?A:B(B(1)/A);}if(1073741824!=(0|b))break f;return B(A*A);}if(a>>>0<1065353217)break a;return (0|b)>-1?r:B(0);}if(1056964608!=(0|b)|(0|f)<0)break i;return B(Q(A));}return B((0|b)>-1?0:-r);}e=B(m(A));i:{a:{f:{n:{if(!(!a|2139095040==(1073741824|a))){if((0|f)<=-1)break n;break i;}if(t=(0|b)<0?B(B(1)/e):e,(0|f)>-1)break e;if(!(a+-1065353216|n))break f;return 1==(0|n)?B(-t):t;}if(1==(0|n))break a;if(n)break i;return A=B(A-A),B(A/A);}return A=B(t-t),B(A/A);}t=B(-1);}i:{a:{f:{n:{t:{if(i>>>0>=1291845633){if(a>>>0>1065353207)break t;return B((0|b)<0?B(t*B(1.0000000150474662e30))*B(1.0000000150474662e30):B(t*B(1.0000000031710769e-30))*B(1.0000000031710769e-30));}if(n=a,a=a>>>0<8388608,f=a?(l(B(e*B(16777216))),o(0)):n,n=8388607&f,i=1065353216|n,a=(f>>23)+(a?-151:-127)|0,f=0,n>>>0<1885298)break f;if(n>>>0>=6140887)break n;f=1;break f;}if(a>>>0<1065353224)break a;return B((0|b)>0?B(t*B(1.0000000150474662e30))*B(1.0000000150474662e30):B(t*B(1.0000000031710769e-30))*B(1.0000000031710769e-30));}i=i+-8388608|0,a=a+1|0;}n=f<<2,v=C[n+19540>>2],k(0,i),d=s(),c=C[n+19524>>2],u=B(d-c),R=B(B(1)/B(c+d)),e=B(u*R),k(0,-4096&(l(e),o(0))),A=s(),G=B(A*A),h=A,y=u,k(0,4194304+((i>>1&-536875008|536870912)+(f<<21)|0)|0),u=s(),d=B(R*B(B(y-B(A*u))-B(A*B(d-B(u-c))))),u=B(B(e+A)*d),A=B(e*e),c=B(u+B(B(A*A)*B(B(A*B(B(A*B(B(A*B(B(A*B(B(A*B(.20697501301765442))+B(.23066075146198273)))+B(.2727281153202057)))+B(.3333333432674408)))+B(.4285714328289032)))+B(.6000000238418579)))),k(0,-4096&(l(B(B(G+B(3))+c)),o(0))),A=s(),u=B(h*A),e=B(B(d*A)+B(e*B(c-B(B(A+B(-3))-G)))),k(0,-4096&(l(B(u+e)),o(0))),A=s(),c=B(A*B(.9619140625)),d=B(C[n+19532>>2]+B(B(B(e-B(A-u))*B(.9617967009544373))+B(A*B(-.00011736857413779944)))),e=B(0|a),k(0,-4096&(l(B(B(v+B(c+d))+e)),o(0))),A=s(),v=B(B(B(A-e)-v)-c);break i;}A=B(e+B(-1)),e=B(A*B(1.44268798828125)),d=B(B(A*B(7052607543300837e-21))+B(B(B(A*A)*B(B(.5)-B(A*B(B(A*B(-.25))+B(.3333333432674408)))))*B(-1.4426950216293335))),k(0,-4096&(l(B(e+d)),o(0))),A=s(),v=B(A-e);}if(k(0,-4096&b),c=s(),e=B(A*c),A=B(B(B(d-v)*r)+B(B(r-c)*A)),r=B(e+A),l(r),i=o(0),(0|i)>=1124073473)break r;f=1124073472;i:{a:{if(1124073472==(0|i)){if(!(B(A+B(4.299566569443414e-8))>B(r-e)))break a;break r;}if(f=2147483647&i,!(A<=B(r-e)^1|-1021968384!=(0|i))|f>>>0>=1125515265)break A;if(a=0,f>>>0<1056964609)break i;}b=(8388608>>>(f>>>23)-126)+i|0,f=b>>>23&255,a=(8388607&b|8388608)>>>150-f,a=(0|i)<0?0-a|0:a,e=B(e-(k(0,b&-8388608>>f+-127),s())),l(B(A+e)),i=o(0);}return k(0,-32768&i),r=s(),v=B(r*B(.693145751953125)),e=B(B(r*B(14286065379565116e-22))+B(B(A-B(r-e))*B(.6931471824645996))),A=B(v+e),r=B(A*A),r=B(A-B(r*B(B(r*B(B(r*B(B(r*B(B(r*B(4.138136944220605e-8))+B(-16533901998627698e-22)))+B(661375597701408e-19)))+B(-.0027777778450399637)))+B(.1666666716337204)))),u=B(B(A*r)/B(r+B(-2))),r=B(e-B(A-v)),A=B(B(A-B(u-B(r+B(A*r))))+B(1)),i=0|(l(A),o(0)+(a<<23)),B((0|i)<=8388607?t*function(A,r){var e=0;i:{a:{f:{if((0|r)>=128){if(A=B(A*B(1.7014118346046923e38)),e=r+-127|0,(0|e)<128)break f;r=r+-254|0,r=(0|r)<127?r:127,A=B(A*B(1.7014118346046923e38));break i;}if((0|r)>-127)break i;if(A=B(A*B(1.9721522630525295e-31)),e=r+102|0,(0|e)>-127)break a;r=r+204|0,r=(0|r)>-126?r:-126,A=B(A*B(1.9721522630525295e-31));break i;}r=e;break i;}r=e;}return B(A*(k(0,1065353216+(r<<23)|0),s()));}(A,a):t*(k(0,i),s()));}return t;}return B(B(t*B(1.0000000150474662e30))*B(1.0000000150474662e30));}return B(B(t*B(1.0000000031710769e-30))*B(1.0000000031710769e-30));}function Ji(A){var r=B(0),e=0,i=0,a=B(0);A:{r:{e:{i:{if(l(A),i=o(0),e=2147483647&i,e>>>0>=1065353216){if(1065353216!=(0|e))break i;return B((0|i)<0?3.141592502593994:0);}if(e>>>0>1056964607)break e;if(r=B(1.570796251296997),e>>>0<847249409)break r;return r=B(A*A),B(B(B(B(7.549789415861596e-8)-B(B(B(r*B(B(r*B(B(r*B(-.008656363002955914))+B(-.04274342209100723)))+B(.16666586697101593)))/B(B(r*B(-.7066296339035034))+B(1)))*A))-A)+B(1.570796251296997));}return B(B(0)/B(A-A));}if((0|i)<=-1)break A;A=B(B(B(1)-A)*B(.5)),a=B(Q(A)),k(0,-4096&(l(a),o(0))),r=s(),A=B(B(B(B(B(A*B(B(A*B(B(A*B(-.008656363002955914))+B(-.04274342209100723)))+B(.16666586697101593)))/B(B(A*B(-.7066296339035034))+B(1)))*a)+B(B(A-B(r*r))/B(a+r)))+r),r=B(A+A);}return r;}return A=B(B(A+B(1))*B(.5)),r=B(Q(A)),A=B(B(1.570796251296997)-B(r+B(B(r*B(B(A*B(B(A*B(B(A*B(-.008656363002955914))+B(-.04274342209100723)))+B(.16666586697101593)))/B(B(A*B(-.7066296339035034))+B(1))))+B(-7.549789415861596e-8)))),B(A+A);}function Xi(A,r){var e;Er(A),a[A+560|0]=1,t[A>>2]=19556,t[A+556>>2]=0,e=A+548|0,t[e>>2]=0,t[e+4>>2]=0,function(A,r){var e=0,i=0,f=0,n=B(0),o=0,k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=0,m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=0;o=E-16|0,E=o,t[A+472>>2]=0,t[A+476>>2]=0,t[A+372>>2]=0,t[A+376>>2]=0,t[A+604>>2]=1065353216,t[A+608>>2]=1065353216,t[A+408>>2]=1065353216,t[A+412>>2]=1065353216,e=A+496|0,t[e>>2]=0,t[e+4>>2]=0,e=A+488|0,t[e>>2]=0,t[e+4>>2]=0,e=A+480|0,t[e>>2]=0,t[e+4>>2]=0,e=A+396|0,t[e>>2]=0,t[e+4>>2]=0,e=A+388|0,t[e>>2]=0,t[e+4>>2]=0,e=A+380|0,t[e>>2]=0,t[e+4>>2]=0,e=A+612|0,t[e>>2]=1065353216,t[e+4>>2]=0,t[A+416>>2]=1065353216,t[A+452>>2]=0,e=A+444|0,t[e>>2]=0,t[e+4>>2]=0,e=A+436|0,t[e>>2]=0,t[e+4>>2]=0,e=A+428|0,t[e>>2]=0,t[e+4>>2]=0,e=A+420|0,t[e>>2]=0,t[e+4>>2]=0,t[A+252>>2]=2,k=C[r+92>>2],n=C[r+96>>2],C[o+8>>2]=n,C[o+12>>2]=k,t[o+4>>2]=0,t[o>>2]=1065353216,t[A+504>>2]=t[(k<B(0)?o+4|0:k>B(1)?o:o+12|0)>>2],t[o+4>>2]=0,t[o>>2]=1065353216,t[A+508>>2]=t[(n<B(0)?o+4|0:n>B(1)?o:o+8|0)>>2],t[A+668>>2]=0,t[A+672>>2]=0,e=t[r+120>>2],t[A+532>>2]=t[r+116>>2],t[A+536>>2]=e,i=t[r+4>>2],t[A+540>>2]=i,a[A+512|0]=b[r+124|0],e=t[r+132>>2],t[A+516>>2]=t[r+128>>2],t[A+520>>2]=e,e=t[r+140>>2],t[A+524>>2]=t[r+136>>2],t[A+528>>2]=e,i?(e=A+4|0,yf[t[t[i>>2]+8>>2]](i,e)):(e=t[r+12>>2],t[A+4>>2]=t[r+8>>2],t[A+8>>2]=e,i=r+16|0,f=t[i+4>>2],e=A+12|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,i=r+32|0,f=t[i+4>>2],e=A+28|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,i=r+24|0,f=t[i+4>>2],e=A+20|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,i=r+48|0,f=t[i+4>>2],e=A+44|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,i=r+40|0,f=t[i+4>>2],e=A+36|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,i=r+56|0,f=t[i+4>>2],e=A+52|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,i=r- -64|0,f=t[i+4>>2],e=A+60|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,e=A+4|0),t[A+132>>2]=0,t[A+136>>2]=0,i=A+156|0,t[i>>2]=0,t[i+4>>2]=0,i=A+148|0,t[i>>2]=0,t[i+4>>2]=0,i=A+140|0,t[i>>2]=0,t[i+4>>2]=0,i=t[e+4>>2],t[A+68>>2]=t[e>>2],t[A+72>>2]=i,e=e+8|0,f=t[e+4>>2],i=A+76|0,t[i>>2]=t[e>>2],t[i+4>>2]=f,i=A+20|0,f=t[i+4>>2],e=A+84|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,i=A+28|0,f=t[i+4>>2],e=A+92|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,i=A+36|0,f=t[i+4>>2],e=A+100|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,i=A+44|0,f=t[i+4>>2],e=A+108|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,i=A+52|0,f=t[i+4>>2],e=A+116|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,i=A+60|0,f=t[i+4>>2],e=A+124|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,t[A+228>>2]=t[r+100>>2],t[A+236>>2]=t[r+104>>2],t[A+240>>2]=t[r+108>>2],t[A+232>>2]=t[r+112>>2],yf[t[t[A>>2]+8>>2]](A,t[r+72>>2]),e=t[703],t[A+568>>2]=e,t[703]=e+1,k=B(0),e=t[A+204>>2],n=C[r>>2],n!=B(0)?(t[A+204>>2]=-2&e,k=B(B(1)/n)):t[A+204>>2]=1|e,C[A+404>>2]=k,t[A+436>>2]=0,C[A+424>>2]=n*C[A+440>>2],C[A+432>>2]=n*C[A+448>>2],C[A+428>>2]=n*C[A+444>>2],n=C[r+80>>2],c=C[r+84>>2],m=C[r+76>>2],t[A+468>>2]=0,r=A+632|0,t[r>>2]=0,e=A+628|0,i=A+416|0,C[e>>2]=k*C[i>>2],f=A+624|0,D=A+412|0,C[f>>2]=k*C[D>>2],C[A+620>>2]=k*C[A+408>>2],R=c!=B(0)?B(B(1)/c):B(0),C[A+464>>2]=R,G=n!=B(0)?B(B(1)/n):B(0),C[A+460>>2]=G,h=m!=B(0)?B(B(1)/m):B(0),C[A+456>>2]=h,n=C[A+12>>2],c=C[A+8>>2],m=C[A+28>>2],y=C[A+20>>2],Q=C[A+24>>2],d=C[A+44>>2],v=C[A+36>>2],g=C[A+40>>2],p=C[A+4>>2],t[A+564>>2]=8,t[A+368>>2]=0,t[A+352>>2]=0,t[A+336>>2]=0,u=B(h*v),l=B(G*g),s=B(R*d),C[A+364>>2]=B(B(v*u)+B(g*l))+B(d*s),C[A+360>>2]=B(B(y*u)+B(Q*l))+B(m*s),C[A+356>>2]=B(B(p*u)+B(c*l))+B(n*s),u=B(h*y),l=B(G*Q),s=B(R*m),C[A+348>>2]=B(B(v*u)+B(g*l))+B(d*s),C[A+344>>2]=B(B(y*u)+B(Q*l))+B(m*s),C[A+340>>2]=B(B(p*u)+B(c*l))+B(n*s),u=v,v=B(h*p),l=g,g=B(G*c),s=d,d=B(R*n),C[A+332>>2]=B(B(u*v)+B(l*g))+B(s*d),C[A+328>>2]=B(B(v*y)+B(g*Q))+B(d*m),C[A+324>>2]=B(B(p*v)+B(c*g))+B(n*d),_=A+596|0,t[_>>2]=0,t[_+4>>2]=0,_=A+588|0,t[_>>2]=0,t[_+4>>2]=0,_=A+580|0,t[_>>2]=0,t[_+4>>2]=0,t[A+572>>2]=0,t[A+576>>2]=0,n=C[D>>2],c=C[A+408>>2],C[e>>2]=k*C[i>>2],C[f>>2]=k*n,C[A+620>>2]=k*c,t[A+664>>2]=0,e=A+656|0,t[e>>2]=0,t[e+4>>2]=0,e=A+648|0,t[e>>2]=0,t[e+4>>2]=0,A=A+640|0,t[A>>2]=0,t[A+4>>2]=0,t[r>>2]=0,t[r+4>>2]=0,E=o+16|0;}(A,r);}function Mi(A,r,e){xi(A+4|0,A+372|0,A+388|0,r,e);}function xi(A,r,e,i,a){var f,n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=0;if(f=E-16|0,E=f,n=C[A+52>>2],b=C[A+56>>2],k=C[A+48>>2],o=C[r>>2],c=C[r+4>>2],u=C[r+8>>2],t[a+60>>2]=0,C[a+56>>2]=b+B(u*i),C[a+52>>2]=n+B(c*i),C[a+48>>2]=k+B(o*i),k=C[e>>2],l=C[e+4>>2],s=C[e+8>>2],n=B(B(B(k*k)+B(l*l))+B(s*s)),n=n>B(1.1920928955078125e-7)?B(Q(n)):B(0),b=B(n*i)>B(.7853981852531433)?B(B(.7853981852531433)/i):n,n=b<B(.0010000000474974513)?B(B(i*B(.5))+B(b*B(B(B(B(i*i)*i)*B(-.02083333395421505))*b))):B(ge(B(B(b*B(.5))*i))/b),tf(A,f),o=C[f+12>>2],c=_e(B(B(b*i)*B(.5))),u=B(k*n),d=C[f>>2],l=B(l*n),v=C[f+4>>2],n=B(s*n),s=C[f+8>>2],b=B(B(B(B(o*c)-B(u*d))-B(l*v))-B(n*s)),k=B(B(B(B(n*o)+B(c*s))+B(u*v))-B(l*d)),i=B(B(B(B(c*d)+B(u*o))+B(l*s))-B(n*v)),n=B(B(B(n*d)+B(B(l*o)+B(c*v)))-B(u*s)),o=B(B(b*b)+B(B(k*k)+B(B(i*i)+B(n*n)))),o>B(1.1920928955078125e-7)&&(o=B(B(1)/B(Q(o))),b=B(b*o),k=B(k*o),n=B(n*o),i=B(i*o),o=B(B(b*b)+B(B(k*k)+B(B(n*n)+B(i*i))))),o>B(1.1920928955078125e-7))return t[a+12>>2]=0,t[a+44>>2]=0,t[a+28>>2]=0,c=B(B(2)/o),o=B(k*c),u=B(n*o),d=B(i*c),l=B(b*d),C[a+36>>2]=u+l,v=B(i*o),c=B(n*c),s=B(b*c),C[a+32>>2]=v-s,C[a+24>>2]=u-l,u=B(i*c),b=B(b*o),C[a+16>>2]=u+b,C[a+8>>2]=v+s,C[a+4>>2]=u-b,i=B(i*d),n=B(n*c),C[a+40>>2]=B(1)-B(i+n),b=i,i=B(k*o),C[a+20>>2]=B(1)-B(b+i),C[a>>2]=B(1)-B(n+i),void(E=f+16|0);r=t[A+4>>2],t[a>>2]=t[A>>2],t[a+4>>2]=r,e=A+8|0,g=t[e+4>>2],r=a+8|0,t[r>>2]=t[e>>2],t[r+4>>2]=g,e=A+24|0,g=t[e+4>>2],r=a+24|0,t[r>>2]=t[e>>2],t[r+4>>2]=g,r=t[A+20>>2],t[a+16>>2]=t[A+16>>2],t[a+20>>2]=r,e=A+40|0,g=t[e+4>>2],r=a+40|0,t[r>>2]=t[e>>2],t[r+4>>2]=g,r=t[A+36>>2],t[a+32>>2]=t[A+32>>2],t[a+36>>2]=r,E=f+16|0;}function Si(A,r){var e,i=0,a=0,f=0,n=0,b=0,o=0,k=0,c=B(0),u=0;e=E-32|0,E=e,r!=B(0)&&(i=t[A+540>>2],i&&yf[t[t[i>>2]+8>>2]](i,A+4|0),t[A+384>>2]=0,i=A+380|0,r=B(B(1)/r),n=A+60|0,b=A+124|0,C[i>>2]=r*B(C[n>>2]-C[b>>2]),C[A+376>>2]=r*B(C[A+56>>2]-C[A+120>>2]),o=A+52|0,k=A+116|0,C[A+372>>2]=r*B(C[o>>2]-C[k>>2]),Ti(A+68|0,A+4|0,e+16|0,e+12|0),t[A+400>>2]=0,a=A+396|0,c=C[e+12>>2],C[a>>2]=r*B(c*C[e+24>>2]),C[A+392>>2]=r*B(c*C[e+20>>2]),C[A+388>>2]=r*B(c*C[e+16>>2]),u=t[i+4>>2],f=A+140|0,t[f>>2]=t[i>>2],t[f+4>>2]=u,i=t[A+376>>2],t[A+132>>2]=t[A+372>>2],t[A+136>>2]=i,i=t[A+392>>2],t[A+148>>2]=t[A+388>>2],t[A+152>>2]=i,f=t[a+4>>2],i=A+156|0,t[i>>2]=t[a>>2],t[i+4>>2]=f,i=t[A+8>>2],t[A+68>>2]=t[A+4>>2],t[A+72>>2]=i,a=A+12|0,f=t[a+4>>2],i=A+76|0,t[i>>2]=t[a>>2],t[i+4>>2]=f,a=A+20|0,f=t[a+4>>2],i=A+84|0,t[i>>2]=t[a>>2],t[i+4>>2]=f,a=A+28|0,f=t[a+4>>2],i=A+92|0,t[i>>2]=t[a>>2],t[i+4>>2]=f,a=A+44|0,f=t[a+4>>2],i=A+108|0,t[i>>2]=t[a>>2],t[i+4>>2]=f,i=A+100|0,A=A+36|0,a=t[A+4>>2],t[i>>2]=t[A>>2],t[i+4>>2]=a,A=t[n+4>>2],t[b>>2]=t[n>>2],t[b+4>>2]=A,A=t[o+4>>2],t[k>>2]=t[o>>2],t[k+4>>2]=A),E=e+32|0;}function Ti(A,r,e,i){var a,f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),y=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0);if(a=E+-64|0,E=a,v=C[r+24>>2],g=C[r+20>>2],_=C[r+40>>2],m=C[r+36>>2],k=C[A+40>>2],c=C[A+20>>2],s=C[A+36>>2],u=C[A+24>>2],R=C[r+8>>2],y=C[r>>2],p=C[r+4>>2],D=C[r+16>>2],w=C[r+32>>2],n=C[A+8>>2],b=C[A+4>>2],d=C[A+32>>2],l=C[A+16>>2],o=C[A>>2],t[a+60>>2]=0,t[a+44>>2]=0,F=B(B(c*k)-B(u*s)),Z=B(B(u*d)-B(k*l)),Y=B(B(s*l)-B(c*d)),f=B(B(1)/B(B(B(o*F)+B(b*Z))+B(n*Y))),W=B(B(B(u*b)-B(c*n))*f),u=B(B(B(l*n)-B(u*o))*f),c=B(B(B(c*o)-B(l*b))*f),C[a+56>>2]=B(B(w*W)+B(m*u))+B(_*c),l=B(B(B(s*n)-B(k*b))*f),n=B(B(B(k*o)-B(d*n))*f),b=B(B(B(d*b)-B(s*o))*f),C[a+52>>2]=B(B(w*l)+B(m*n))+B(_*b),C[a+40>>2]=B(B(W*D)+B(u*g))+B(c*v),C[a+36>>2]=B(B(l*D)+B(n*g))+B(b*v),t[a+28>>2]=0,o=B(F*f),k=B(Z*f),f=B(Y*f),C[a+48>>2]=B(B(w*o)+B(m*k))+B(_*f),C[a+32>>2]=B(B(o*D)+B(k*g))+B(f*v),C[a+24>>2]=B(R*c)+B(B(y*W)+B(p*u)),C[a+20>>2]=B(R*b)+B(B(y*l)+B(p*n)),C[a+16>>2]=B(R*f)+B(B(y*o)+B(p*k)),tf(a+16|0,a),o=C[a>>2],b=C[a+4>>2],n=C[a+8>>2],k=C[a+12>>2],f=B(B(1)/B(Q(B(B(B(B(o*o)+B(b*b))+B(n*n))+B(k*k))))),n=B(n*f),C[a+8>>2]=n,b=B(b*f),C[a+4>>2]=b,o=B(o*f),C[a>>2]=o,f=B(k*f),C[a+12>>2]=f,f=Ji(B(G(B(h(f,B(-1))),B(1)))),C[i>>2]=f+f,t[e+12>>2]=0,C[e+8>>2]=n,C[e+4>>2]=b,C[e>>2]=o,f=B(B(B(o*o)+B(b*b))+B(n*n)),f<B(1.4210854715202004e-14))return t[e>>2]=1065353216,t[e+4>>2]=0,A=e+8|0,t[A>>2]=0,t[A+4>>2]=0,void(E=a- -64|0);f=B(B(1)/B(Q(f))),C[e+8>>2]=n*f,C[e+4>>2]=b*f,C[e>>2]=o*f,E=a- -64|0;}function Ui(A,r){var e=B(0),i=0,a=B(0),f=B(0),n=B(0);e=C[A+404>>2],e!=B(0)&&(a=C[r>>2],f=C[r+4>>2],n=C[r+8>>2],t[A+436>>2]=0,e=B(B(1)/e),C[A+432>>2]=n*e,C[A+428>>2]=e*f,C[A+424>>2]=e*a),i=t[r+4>>2],t[A+440>>2]=t[r>>2],t[A+444>>2]=i,r=r+8|0,i=t[r+4>>2],A=A+448|0,t[A>>2]=t[r>>2],t[A+4>>2]=i;}function ji(A,r){var e=0,i=B(0),a=B(0),f=B(0),n=B(0),o=B(0),k=B(0),c=B(0),u=B(0);if(c=C[A+504>>2],a=Ii(B(B(1)-c),r),n=B(a*C[A+372>>2]),C[A+372>>2]=n,e=A+376|0,i=B(a*C[e>>2]),C[e>>2]=i,e=A+380|0,a=B(a*C[e>>2]),C[e>>2]=a,u=C[A+508>>2],f=Ii(B(B(1)-u),r),r=B(f*C[A+388>>2]),C[A+388>>2]=r,e=A+392|0,o=B(f*C[e>>2]),C[e>>2]=o,e=A+396|0,f=B(f*C[e>>2]),C[e>>2]=f,b[A+512|0]&&(B(B(B(r*r)+B(o*o))+B(f*f))<C[A+524>>2]^1|B(B(B(n*n)+B(i*i))+B(a*a))<C[A+520>>2]^1||(k=C[A+516>>2],f=B(f*k),C[A+396>>2]=f,o=B(o*k),C[A+392>>2]=o,r=B(r*k),C[A+388>>2]=r,a=B(a*k),C[A+380>>2]=a,i=B(i*k),C[A+376>>2]=i,n=B(n*k),C[A+372>>2]=n),k=B(Q(B(B(B(n*n)+B(i*i))+B(a*a)))),k<c&&(k>B(.004999999888241291)?(c=a,a=B(B(1)/k),C[A+380>>2]=c-B(B(c*a)*B(.004999999888241291)),C[A+376>>2]=i-B(B(i*a)*B(.004999999888241291)),C[A+372>>2]=n-B(B(n*a)*B(.004999999888241291))):(e=A+372|0,t[e>>2]=0,t[e+4>>2]=0,e=e+8|0,t[e>>2]=0,t[e+4>>2]=0)),i=B(Q(B(B(B(r*r)+B(o*o))+B(f*f)))),i<u)){if(i>B(.004999999888241291))return i=B(B(1)/i),C[A+396>>2]=f-B(B(f*i)*B(.004999999888241291)),C[A+392>>2]=o-B(B(o*i)*B(.004999999888241291)),void(C[A+388>>2]=r-B(B(r*i)*B(.004999999888241291)));A=A+388|0,t[A>>2]=0,t[A+4>>2]=0,A=A+8|0,t[A>>2]=0,t[A+4>>2]=0;}}function Oi(A){var r=0;3&b[A+204|0]||(C[A+472>>2]=B(C[A+424>>2]*C[A+408>>2])+C[A+472>>2],r=A+476|0,C[r>>2]=B(C[A+428>>2]*C[A+412>>2])+C[r>>2],r=A+480|0,C[r>>2]=B(C[A+432>>2]*C[A+416>>2])+C[r>>2]);}function Hi(A,r){!function(A,r){var e=0,i=0,a=0,f=0,n=0,o=B(0),k=B(0),c=B(0),u=0,l=B(0),s=B(0),d=B(0),v=0,g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=0;2&b[A+204|0]?(e=t[A+8>>2],t[A+68>>2]=t[A+4>>2],t[A+72>>2]=e,i=A+12|0,a=t[i+4>>2],e=A+76|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,i=A+20|0,a=t[i+4>>2],e=A+84|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,i=A+28|0,a=t[i+4>>2],e=A+92|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,i=A+36|0,a=t[i+4>>2],e=A+100|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,i=A+44|0,a=t[i+4>>2],e=A+108|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,i=A+52|0,a=t[i+4>>2],e=A+116|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,i=A+60|0,a=t[i+4>>2],e=A+124|0,t[e>>2]=t[i>>2],t[e+4>>2]=a):(e=t[r+4>>2],t[A+68>>2]=t[r>>2],t[A+72>>2]=e,i=r+8|0,a=t[i+4>>2],e=A+76|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,i=r+24|0,a=t[i+4>>2],e=A+92|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,i=t[r+20>>2],e=A+84|0,t[e>>2]=t[r+16>>2],t[e+4>>2]=i,i=r+40|0,a=t[i+4>>2],e=A+108|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,i=t[r+36>>2],e=A+100|0,t[e>>2]=t[r+32>>2],t[e+4>>2]=i,i=t[r+52>>2],e=A+116|0,t[e>>2]=t[r+48>>2],t[e+4>>2]=i,i=r+56|0,a=t[i+4>>2],e=A+124|0,t[e>>2]=t[i>>2],t[e+4>>2]=a),e=t[A+392>>2],t[A+148>>2]=t[A+388>>2],t[A+152>>2]=e,e=t[A+376>>2],t[A+132>>2]=t[A+372>>2],t[A+136>>2]=e,i=A+396|0,a=t[i+4>>2],e=A+156|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,i=A+380|0,a=t[i+4>>2],e=A+140|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,a=r+8|0,v=t[a+4>>2],e=A+12|0,t[e>>2]=t[a>>2],t[e+4>>2]=v,i=t[r+4>>2],t[A+4>>2]=t[r>>2],t[A+8>>2]=i,v=r+24|0,n=t[v+4>>2],i=A+28|0,t[i>>2]=t[v>>2],t[i+4>>2]=n,n=t[r+20>>2],a=A+20|0,t[a>>2]=t[r+16>>2],t[a+4>>2]=n,f=r+40|0,u=t[f+4>>2],v=A+44|0,n=v,t[n>>2]=t[f>>2],t[n+4>>2]=u,u=t[r+36>>2],n=A+36|0,f=n,t[f>>2]=t[r+32>>2],t[f+4>>2]=u,u=r+56|0,D=t[u+4>>2],f=A+60|0,t[f>>2]=t[u>>2],t[f+4>>2]=D,u=t[r+52>>2],f=A+52|0,t[f>>2]=t[r+48>>2],t[f+4>>2]=u,g=C[A+8>>2],_=C[e>>2],m=C[i>>2],R=C[a>>2],G=C[A+24>>2],l=C[v>>2],y=C[A+464>>2],s=C[n>>2],d=C[A+40>>2],Q=C[A+460>>2],h=C[A+4>>2],p=C[A+456>>2],t[A+368>>2]=0,t[A+352>>2]=0,t[A+336>>2]=0,o=B(p*s),k=B(Q*d),c=B(y*l),C[A+364>>2]=B(B(s*o)+B(d*k))+B(l*c),C[A+360>>2]=B(B(R*o)+B(G*k))+B(m*c),C[A+356>>2]=B(B(h*o)+B(g*k))+B(_*c),o=B(p*R),k=B(Q*G),c=B(y*m),C[A+348>>2]=B(B(s*o)+B(d*k))+B(l*c),C[A+344>>2]=B(B(R*o)+B(G*k))+B(m*c),C[A+340>>2]=B(B(h*o)+B(g*k))+B(_*c),o=s,s=B(h*p),k=d,d=B(g*Q),c=l,l=B(_*y),C[A+332>>2]=B(B(o*s)+B(k*d))+B(c*l),C[A+328>>2]=B(B(s*R)+B(d*G))+B(l*m),C[A+324>>2]=B(B(h*s)+B(g*d))+B(_*l);}(A,r);}function zi(A,r,e){var i=B(0),a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0);t[A+12>>2]=0,a=C[r+388>>2],i=C[r+456>>2],s=i!=B(0)?B(B(1)/i):B(0),d=C[r+20>>2],f=B(s*d),o=C[r+4>>2],i=C[r+460>>2],R=i!=B(0)?B(B(1)/i):B(0),v=C[r+24>>2],k=B(R*v),c=C[r+8>>2],i=C[r+464>>2],G=i!=B(0)?B(B(1)/i):B(0),g=C[r+28>>2],u=B(G*g),_=C[r+12>>2],i=C[r+392>>2],l=B(B(a*B(B(B(f*o)+B(k*c))+B(u*_)))+B(B(B(B(f*d)+B(k*v))+B(u*g))*i)),m=C[r+36>>2],n=k,k=C[r+40>>2],b=u,u=C[r+44>>2],n=B(B(B(f*m)+B(n*k))+B(b*u)),f=C[r+396>>2],h=B(l+B(n*f)),b=B(s*o),l=B(R*c),n=B(G*_),l=B(B(B(B(B(B(b*o)+B(l*c))+B(n*_))*a)+B(i*B(B(B(b*d)+B(l*v))+B(n*g))))+B(B(B(B(b*m)+B(l*k))+B(n*u))*f)),b=B(B(a*h)-B(i*l)),C[A+8>>2]=b,n=a,a=B(s*m),s=B(o*a),o=B(R*k),s=B(s+B(c*o)),c=B(G*u),d=B(B(B(n*B(s+B(_*c)))+B(i*B(B(B(a*d)+B(o*v))+B(c*g))))+B(f*B(B(B(a*m)+B(o*k))+B(c*u)))),a=B(B(f*l)-B(n*d)),C[A+4>>2]=a,i=B(B(i*d)-B(f*h)),C[A>>2]=i,f=B(B(b*b)+B(B(i*i)+B(a*a))),f>B(e*e)&&(e=B(B(B(1)/B(Q(f)))*e),C[A+8>>2]=b*e,C[A+4>>2]=a*e,C[A>>2]=i*e);}function Pi(A,r,e){var i,a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),N=B(0),V=B(0);i=E-16|0,E=i,k=C[r+464>>2],a=C[r+460>>2],h=C[r+396>>2],y=C[r+392>>2],b=C[r+456>>2],Q=C[r+388>>2],tf(r+4|0,i),t[A+12>>2]=0,c=C[i+12>>2],u=C[i+4>>2],l=C[i+8>>2],n=B(B(B(Q*c)-B(h*u))+B(y*l)),s=C[i>>2],_=B(B(B(y*u)+B(Q*s))+B(h*l)),o=B(B(B(h*c)-B(y*s))+B(Q*u)),R=B(B(B(y*c)-B(Q*l))+B(h*s)),f=B(B(B(u*n)+B(B(l*_)+B(c*o)))-B(s*R)),v=B(f*B(0)),d=B(B(B(l*R)+B(B(s*_)+B(c*n)))-B(u*o)),G=B(d*B(0)),a=a!=B(0)?B(B(1)/a):B(0),n=B(B(B(s*o)+B(B(u*_)+B(c*R)))-B(l*n)),_=B(v+B(G+B(a*n))),b=b!=B(0)?B(B(1)/b):B(0),Y=B(B(B(B(B(G-B(b*n))+B(0))+B(_+B(0)))*e)+B(0)),o=k!=B(0)?B(B(1)/k):B(0),g=B(n*B(0)),R=B(B(f*o)+B(G+g)),W=B(v+B(B(b*d)+g)),k=B(B(B(f*W)-B(d*R))*e),p=B(f*B(-0)),N=B(b+B(B(g+B(B(b*B(0))+p))*e)),D=B(n*B(-0)),F=B(B(B(B(B(D+B(a*d))+B(0))-W)*e)+B(0)),g=B(B(B(B(g+B(B(0)-B(a*f)))+R)*e)+B(0)),Z=B(B(B(B(B(v+B(0))-B(o*d))+W)*e)+B(0)),w=B(d*B(-0)),a=B(a+B(B(w+B(B(a*B(0))+v))*e)),v=B(B(B(B(B(o*n)+B(p+B(0)))-_)*e)+B(0)),p=B(B(g*Z)-B(a*v)),o=B(o+B(B(B(o*B(0))+B(D+G))*e)),D=B(B(a*o)-B(F*Z)),G=B(B(B(B(w+B(B(b*f)+B(0)))-R)*e)+B(0)),w=B(B(F*v)-B(o*g)),b=B(B(Y*p)+B(B(N*D)+B(G*w))),b=B(m(b))>B(1.1920928955078125e-7)?B(B(1)/b):b,V=f,f=B(B(B(n*R)-B(f*_))*e),e=B(B(B(d*_)-B(n*W))*e),a=B(V-B(B(B(Y*B(B(g*k)-B(a*f)))+B(B(N*B(B(a*e)-B(F*k)))+B(G*B(B(F*f)-B(g*e)))))*b)),n=B(n-B(B(B(Y*B(B(Z*f)-B(v*k)))+B(B(N*B(B(o*k)-B(Z*e)))+B(G*B(B(v*e)-B(o*f)))))*b)),e=B(d-B(B(B(e*p)+B(B(f*D)+B(k*w)))*b)),f=B(B(B(c*a)+B(s*n))-B(u*e)),d=B(B(B(-B(s*e))-B(u*n))-B(l*a)),k=B(B(B(c*e)+B(u*a))-B(l*n)),e=B(B(B(l*e)+B(c*n))-B(s*a)),C[A+8>>2]=B(B(B(B(c*f)-B(d*l))-B(k*u))+B(e*s))-h,C[A+4>>2]=B(B(B(B(c*e)-B(d*u))-B(f*s))+B(k*l))-y,C[A>>2]=B(B(B(B(c*k)-B(d*s))-B(e*l))+B(f*u))-Q,E=i+16|0;}function Li(A,r,e){var i=B(0),a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0);t[A+12>>2]=0,i=C[r+456>>2],p=i!=B(0)?B(B(1)/i):B(0),l=C[r+36>>2],y=B(p*l),s=C[r+4>>2],i=C[r+460>>2],b=i!=B(0)?B(B(1)/i):B(0),_=C[r+40>>2],D=B(b*_),f=C[r+8>>2],i=C[r+464>>2],d=i!=B(0)?B(B(1)/i):B(0),o=C[r+44>>2],W=B(d*o),a=C[r+12>>2],n=B(B(B(y*s)+B(D*f))+B(W*a)),i=C[r+388>>2],k=C[r+20>>2],R=B(p*k),c=C[r+24>>2],Q=B(b*c),u=C[r+28>>2],G=B(d*u),w=B(B(B(R*s)+B(Q*f))+B(G*a)),F=B(i*w),v=C[r+392>>2],h=B(B(B(R*k)+B(Q*c))+B(G*u)),g=C[r+396>>2],Q=B(B(B(R*l)+B(Q*_))+B(G*o)),Y=B(g*Q),R=B(B(F+B(v*h))+Y),Z=F,G=B(p*s),F=B(b*f),d=B(d*a),f=B(B(B(G*s)+B(F*f))+B(d*a)),p=B(n+B(B(B(B(n*B(0))+B(Z-B(f*v)))+R)*e)),b=B(B(B(G*k)+B(F*c))+B(d*u)),Z=B(i*n),c=B(B(B(y*k)+B(D*c))+B(W*u)),k=B(v*c),a=B(B(B(y*l)+B(D*_))+B(W*o)),s=B(B(Z+k)+B(g*a)),k=B(b+B(B(s+B(k+B(B(b*B(0))-B(h*g))))*e)),W=B(v*b),o=B(B(B(G*l)+B(F*_))+B(d*o)),u=B(g*o),l=B(B(B(i*f)+W)+u),D=B(e*B(0)),_=B(B(R+B(B(B(g*l)-B(i*s))*e))-B(D+R)),u=B(Q+B(B(l+B(B(B(Q*B(0))+u)-B(a*i)))*e)),b=B(h+B(B(B(B(h*B(0))+B(g*b))-B(c*i))*e)),y=B(o+B(B(B(B(v*a)+B(B(o*B(0))-Y))-R)*e)),G=B(B(k*u)-B(b*y)),d=B(f+B(B(B(v*n)+B(B(f*B(0))-B(w*g)))*e)),a=B(a+B(B(B(a*B(0))+B(B(i*Q)-B(o*v)))*e)),h=B(c+B(B(B(B(c*B(0))+B(B(i*h)-W))-l)*e)),c=B(B(b*a)-B(h*u)),o=B(w+B(B(B(B(B(w*B(0))+B(g*f))-Z)-s)*e)),w=B(B(h*y)-B(k*a)),n=B(B(p*G)+B(B(d*c)+B(o*w))),f=B(m(n))>B(1.1920928955078125e-7)?B(B(1)/n):n,n=B(B(l+B(B(B(v*s)-B(g*R))*e))-B(D+l)),e=B(B(s+B(B(B(i*R)-B(v*l))*e))-B(D+s)),C[A+8>>2]=B(g-B(B(B(p*B(B(k*_)-B(b*n)))+B(B(d*B(B(b*e)-B(h*_)))+B(o*B(B(h*n)-B(k*e)))))*f))-g,C[A+4>>2]=B(v-B(B(B(p*B(B(u*n)-B(y*_)))+B(B(d*B(B(a*_)-B(u*e)))+B(o*B(B(y*e)-B(a*n)))))*f))-v,C[A>>2]=B(i-B(B(B(e*G)+B(B(n*c)+B(_*w)))*f))-i;}function Ki(A,r){var e=0,i=0,f=0,n=0,o=0,k=0;e=t[A+548>>2];A:{r:if(!((0|e)<1)){for(f=t[A+556>>2];;){if((0|r)!=t[f>>2]){if(f=f+4|0,i=i+1|0,(0|i)<(0|e))continue;break r;}break;}if((0|e)!=(0|i))break A;}if(t[A+552>>2]==(0|e)&&(o=e?e<<1:1,!((0|e)>=(0|o)))){r:{e:{if(o){if(n=CA(o<<2,16),e=t[A+548>>2],(0|e)>=1)break e;break r;}if((0|e)<1)break r;}for(f=0,k=A+556|0,i=e;t[f+n>>2]=t[t[k>>2]+f>>2],f=f+4|0,i=i+-1|0,i;){}}k=A+556|0,i=t[k>>2],i&&(b[A+560|0]&&(gA(i),e=t[A+548>>2]),t[A+556>>2]=0),t[k>>2]=n,a[A+560|0]=1,t[A+552>>2]=o;}t[t[A+556>>2]+(e<<2)>>2]=r,t[A+548>>2]=e+1,n=t[r+32>>2];r:{e:{i:{a:{f:{n:{t:{b:{if(k=t[r+28>>2],(0|A)!=(0|k)){if(e=t[n+288>>2],(0|e)!=t[n+292>>2])break f;if(o=e?e<<1:1,(0|e)>=(0|o))break f;if(!o)break b;if(r=CA(o<<2,16),e=t[n+288>>2],(0|e)>=1)break t;break n;}if(e=t[A+288>>2],(0|e)!=t[A+292>>2])break r;if(o=e?e<<1:1,(0|e)>=(0|o))break r;if(!o)break a;if(r=CA(o<<2,16),e=t[A+288>>2],(0|e)>=1)break i;break e;}if(r=0,(0|e)<1)break n;}for(f=0,A=n+296|0,i=e;t[r+f>>2]=t[t[A>>2]+f>>2],f=f+4|0,i=i+-1|0,i;){}}i=n+296|0,A=t[i>>2],A&&(b[n+300|0]&&(gA(A),e=t[n+288>>2]),t[n+296>>2]=0),t[i>>2]=r,a[n+300|0]=1,t[n+292>>2]=o;}A=n,n=k;break r;}if(r=0,(0|e)<1)break e;}for(f=0,k=A+296|0,i=e;t[r+f>>2]=t[t[k>>2]+f>>2],f=f+4|0,i=i+-1|0,i;){}}k=A+296|0,i=t[k>>2],i&&(b[A+300|0]&&(gA(i),e=t[A+288>>2]),t[A+296>>2]=0),t[k>>2]=r,a[A+300|0]=1,t[A+292>>2]=o;}t[A+288>>2]=e+1,t[A+280>>2]=(-1^e)>>>31,t[t[A+296>>2]+(e<<2)>>2]=n;}}function qi(A,r){var e=0,i=0,a=0,f=0,n=0;A:{r:{f=t[A+548>>2];e:if(!((0|f)<1)){for(a=t[A+556>>2],i=a;;){if((0|r)!=t[i>>2]){if(i=i+4|0,e=e+1|0,(0|e)<(0|f))continue;break e;}break;}if(!((0|e)>=(0|f))){e=0,i=a;i:{for(;;){if((0|r)!=t[i>>2]){if(i=i+4|0,e=e+1|0,(0|e)<(0|f))continue;break i;}break;}(0|f)<=(0|e)||(n=i,e=a,i=f+-1|0,a=i<<2,t[n>>2]=t[e+a>>2],t[A+548>>2]=i,t[a+t[A+556>>2]>>2]=r);}f=t[r+32>>2];i:{a:{if(a=t[r+28>>2],(0|A)!=(0|a)){if(r=t[f+288>>2],(0|r)<1)break i;for(e=0,A=t[f+296>>2],i=A;;){if((0|a)==t[i>>2])break a;if(i=i+4|0,e=e+1|0,!((0|e)<(0|r)))break;}break i;}if(r=t[A+288>>2],(0|r)<1)break A;for(e=0,a=t[A+296>>2],i=a;;){if((0|f)==t[i>>2])break r;if(i=i+4|0,e=e+1|0,!((0|e)<(0|r)))break;}break A;}(0|r)<=(0|e)||(e=A,r=r+-1|0,A=r<<2,t[i>>2]=t[e+A>>2],t[f+288>>2]=r,t[A+t[f+296>>2]>>2]=a);}t[f+280>>2]=(0|r)>0;}}return;}(0|r)<=(0|e)||(e=a,r=r+-1|0,a=r<<2,t[i>>2]=t[e+a>>2],t[A+288>>2]=r,t[a+t[A+296>>2]>>2]=f);}t[A+280>>2]=(0|r)>0;}function $i(A){var r=0;t[A>>2]=19640,a[A+20|0]=1,t[A+16>>2]=0,a[A+40|0]=1,r=A+8|0,t[r>>2]=0,t[r+4>>2]=0,t[A+36>>2]=0,a[A+60|0]=1,r=A+28|0,t[r>>2]=0,t[r+4>>2]=0,t[A+56>>2]=0,a[A+80|0]=1,r=A+48|0,t[r>>2]=0,t[r+4>>2]=0,t[A+76>>2]=0,a[A+100|0]=1,r=A+68|0,t[r>>2]=0,t[r+4>>2]=0,t[A+96>>2]=0,a[A+120|0]=1,r=A+88|0,t[r>>2]=0,t[r+4>>2]=0,a[A+140|0]=1,t[A+116>>2]=0,r=A+108|0,t[r>>2]=0,t[r+4>>2]=0,a[A+160|0]=1,t[A+136>>2]=0,r=A+128|0,t[r>>2]=0,t[r+4>>2]=0,a[A+180|0]=1,t[A+156>>2]=0,r=A+148|0,t[r>>2]=0,t[r+4>>2]=0,t[A+176>>2]=0,a[A+208|0]=1,r=A+168|0,t[r>>2]=0,t[r+4>>2]=0,t[A+204>>2]=0,t[A+232>>2]=0,r=A+196|0,t[r>>2]=0,t[r+4>>2]=0,t[A+224>>2]=0,t[A+220>>2]=536,t[A+216>>2]=537,t[A+212>>2]=538;}function Aa(A){A|=0;var r=0,e=0;return t[A>>2]=19640,r=A+204|0,e=t[r>>2],e&&(b[A+208|0]&&gA(e),t[A+204>>2]=0),t[r>>2]=0,a[A+208|0]=1,r=A+196|0,t[r>>2]=0,t[r+4>>2]=0,r=A+176|0,e=t[r>>2],e&&(b[A+180|0]&&gA(e),t[A+176>>2]=0),t[r>>2]=0,a[A+180|0]=1,r=A+168|0,t[r>>2]=0,t[r+4>>2]=0,r=A+156|0,e=t[r>>2],e&&(b[A+160|0]&&gA(e),t[A+156>>2]=0),t[r>>2]=0,a[A+160|0]=1,r=A+148|0,t[r>>2]=0,t[r+4>>2]=0,r=A+136|0,e=t[r>>2],e&&(b[A+140|0]&&gA(e),t[A+136>>2]=0),t[r>>2]=0,a[A+140|0]=1,r=A+128|0,t[r>>2]=0,t[r+4>>2]=0,r=A+116|0,e=t[r>>2],e&&(b[A+120|0]&&gA(e),t[A+116>>2]=0),t[r>>2]=0,a[A+120|0]=1,r=A+108|0,t[r>>2]=0,t[r+4>>2]=0,r=A+96|0,e=t[r>>2],e&&(b[A+100|0]&&gA(e),t[A+96>>2]=0),t[r>>2]=0,a[A+100|0]=1,r=A+88|0,t[r>>2]=0,t[r+4>>2]=0,r=A+76|0,e=t[r>>2],e&&(b[A+80|0]&&gA(e),t[A+76>>2]=0),t[r>>2]=0,a[A+80|0]=1,r=A+68|0,t[r>>2]=0,t[r+4>>2]=0,r=A+56|0,e=t[r>>2],e&&(b[A+60|0]&&gA(e),t[A+56>>2]=0),t[r>>2]=0,a[A+60|0]=1,r=A+48|0,t[r>>2]=0,t[r+4>>2]=0,r=A+36|0,e=t[r>>2],e&&(b[A+40|0]&&gA(e),t[A+36>>2]=0),t[r>>2]=0,a[A+40|0]=1,r=A+28|0,t[r>>2]=0,t[r+4>>2]=0,r=A+16|0,e=t[r>>2],e&&(b[A+20|0]&&gA(e),t[A+16>>2]=0),t[r>>2]=0,a[A+20|0]=1,r=A+8|0,t[r>>2]=0,t[r+4>>2]=0,0|A;}function ra(A,r,e,i,f,n,o,k,c,u,l,s){var d,v=0,g=0,m=0,R=0,G=0,h=0;if(d=A+68|0,v=t[d>>2],g=v,(0|v)==t[A+72>>2]&&(g=v,R=v?v<<1:1,!((0|v)>=(0|R)))){A:{r:{if(R){if(G=CA(_(R,152),16),m=t[A+68>>2],(0|m)>=1)break r;break A;}if(m=v,(0|v)<1)break A;}for(g=0,h=A+76|0;J(g+G|0,t[h>>2]+g|0,152),g=g+152|0,m=m+-1|0,m;){}}g=A+76|0,m=t[g>>2],m&&(b[A+80|0]&&gA(m),t[A+76>>2]=0),t[g>>2]=G,a[A+80|0]=1,t[A+72>>2]=R,g=t[A+68>>2];}t[d>>2]=g+1,v=t[A+76>>2]+_(v,152)|0,t[v+140>>2]=f,function(A,r,e,i,a,f,n,o,k,c,u,l){var s,d,v,g=B(0),m=0,R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=0,w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),E=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=B(0),M=B(0),x=B(0),S=B(0),T=B(0),U=B(0),j=0,O=B(0),H=B(0),z=B(0),P=B(0),L=B(0);t[r+148>>2]=a,t[r+144>>2]=i,t[r+96>>2]=0,t[r+100>>2]=0,U=C[f+84>>2],v=t[f+84>>2],t[r+104>>2]=v,d=t[A+16>>2],A=t[240+(d+_(a,244)|0)>>2],s=t[240+(_(i,244)+d|0)>>2],t[r+132>>2]=0,m=r+16|0;A:{r:{e:{i:{if(s){if(D=t[e+4>>2],t[m>>2]=t[e>>2],t[m+4>>2]=D,D=e+8|0,j=t[D+4>>2],m=m+8|0,t[m>>2]=t[D>>2],t[m+4>>2]=j,h=C[n+8>>2],y=C[n>>2],g=C[n+4>>2],t[r+12>>2]=0,Z=C[r+20>>2],w=C[r+16>>2],M=B(B(y*Z)-B(g*w)),C[r+8>>2]=M,W=C[r+24>>2],y=B(B(h*w)-B(y*W)),C[r+4>>2]=y,h=B(B(g*W)-B(h*Z)),C[r>>2]=h,g=C[s+332>>2],Y=C[s+328>>2],Q=C[s+608>>2],R=C[s+348>>2],I=C[s+340>>2],J=C[s+344>>2],X=C[s+612>>2],G=C[s+364>>2],p=C[s+356>>2],F=C[s+360>>2],V=C[s+604>>2],E=C[s+324>>2],t[r+76>>2]=0,F=B(X*B(B(B(h*p)+B(y*F))+B(M*G))),C[r+72>>2]=F,S=B(Q*B(B(B(h*I)+B(y*J))+B(M*R))),C[r+68>>2]=S,V=B(V*B(B(B(h*E)+B(y*Y))+B(M*g))),C[r+64>>2]=V,!A)break i;break e;}if(t[r+64>>2]=0,t[r+68>>2]=0,t[r>>2]=0,t[r+4>>2]=0,D=r+72|0,t[D>>2]=0,t[D+4>>2]=0,D=r+24|0,t[D>>2]=0,t[D+4>>2]=0,t[m>>2]=0,t[m+4>>2]=0,m=r+8|0,t[m>>2]=0,t[m+4>>2]=0,A)break e;}if(t[r+80>>2]=0,t[r+84>>2]=0,t[r+32>>2]=0,t[r+36>>2]=0,m=r+88|0,t[m>>2]=0,t[m+4>>2]=0,m=r+56|0,t[m>>2]=0,t[m+4>>2]=0,m=r+48|0,t[m>>2]=0,t[m+4>>2]=0,m=r+40|0,t[m>>2]=0,t[m+4>>2]=0,Y=B(0),Q=B(0),R=B(0),I=B(0),J=B(0),X=B(0),G=B(0),p=B(0),g=B(0),s)break r;break A;}if(g=C[e>>2],R=C[e+4>>2],G=C[e+8>>2],t[r+60>>2]=0,I=B(-G),C[r+56>>2]=I,J=B(-R),C[r+52>>2]=J,X=B(-g),C[r+48>>2]=X,p=C[o+8>>2],N=C[o+4>>2],Q=C[o>>2],t[r+44>>2]=0,Y=B(B(N*g)-B(Q*R)),C[r+40>>2]=Y,Q=B(B(Q*G)-B(p*g)),C[r+36>>2]=Q,R=B(B(p*R)-B(N*G)),C[r+32>>2]=R,g=C[A+332>>2],N=C[A+328>>2],p=C[A+608>>2],E=C[A+348>>2],x=C[A+340>>2],T=C[A+344>>2],G=C[A+612>>2],O=C[A+364>>2],H=C[A+356>>2],z=C[A+360>>2],P=C[A+604>>2],L=C[A+324>>2],t[r+92>>2]=0,G=B(G*B(B(B(R*H)+B(Q*z))+B(Y*O))),C[r+88>>2]=G,p=B(p*B(B(B(R*x)+B(Q*T))+B(Y*E))),C[r+84>>2]=p,N=B(P*B(B(B(R*L)+B(Q*N))+B(Y*g))),C[r+80>>2]=N,g=B(0),!s)break A;}g=C[n+8>>2],E=C[n+4>>2],T=B(B(B(S*g)-B(F*E))*C[e>>2]),x=F,F=C[n>>2],g=B(C[s+404>>2]+B(B(T+B(B(B(x*F)-B(g*V))*C[e+4>>2]))+B(B(B(E*V)-B(S*F))*C[e+8>>2])));}n=r,F=k,x=g,A?(k=C[o+4>>2],g=C[o+8>>2],E=B(B(B(k*G)-B(g*p))*C[e>>2]),V=B(g*N),g=C[o>>2],k=B(C[A+404>>2]+B(B(E+B(B(V-B(g*G))*C[e+4>>2]))+B(B(B(g*p)-B(k*N))*C[e+8>>2])))):k=B(0),k=B(F/B(x+k)),C[n+108>>2]=k,s?(i=_(i,244)+d|0,Z=B(B(B(B(C[i+176>>2]+C[i+208>>2])*w)+B(B(C[i+180>>2]+C[i+212>>2])*Z))+B(B(C[i+184>>2]+C[i+216>>2])*W)),g=C[i+192>>2],W=C[i+196>>2],w=C[i+200>>2]):(g=B(0),Z=B(B(B(w*B(0))+B(Z*B(0)))+B(W*B(0))),W=B(0),w=B(0)),Z=B(Z+B(B(B(g*h)+B(W*y))+B(w*M))),A?(A=_(a,244)+d|0,y=B(B(B(B(C[A+176>>2]+C[A+208>>2])*X)+B(B(C[A+180>>2]+C[A+212>>2])*J))+B(B(C[A+184>>2]+C[A+216>>2])*I)),h=C[A+192>>2],w=C[A+196>>2],W=C[A+200>>2]):(y=B(B(B(X*B(0))+B(J*B(0)))+B(I*B(0))),w=B(0),h=B(0),W=B(0)),g=16&b[f+120|0]?B(k*B(B(-B(C[c+44>>2]*B(B(B(B(C[f+48>>2]-C[f+32>>2])*C[e>>2])+B(B(C[f+52>>2]-C[f+36>>2])*C[e+4>>2]))+B(B(C[f+56>>2]-C[f+40>>2])*C[e+8>>2]))))/C[c+12>>2])):B(0),t[r+128>>2]=0,t[r+124>>2]=v,C[r+116>>2]=l,C[r+112>>2]=B(k*B(u-B(Z+B(y+B(B(B(h*R)+B(w*Q))+B(W*Y))))))+g,C[r+120>>2]=-U;}(A,v,r,e,i,n,o,k,c,u,l,s);}function ea(A,r,e,i,f,n){var k,c=0,u=0,s=0,d=0,v=0,g=0;if(k=A+88|0,c=t[k>>2],u=c,(0|c)==t[A+92>>2]&&(u=c,d=c?c<<1:1,!((0|c)>=(0|d)))){A:{r:{if(d){if(v=CA(_(d,152),16),s=t[A+88>>2],(0|s)>=1)break r;break A;}if(s=c,(0|c)<1)break A;}for(u=0,g=A+96|0;J(u+v|0,t[g>>2]+u|0,152),u=u+152|0,s=s+-1|0,s;){}}u=A+96|0,s=t[u>>2],s&&(b[A+100|0]&&gA(s),t[A+96>>2]=0),t[u>>2]=v,a[A+100|0]=1,t[A+92>>2]=d,u=t[A+88>>2];}t[k>>2]=u+1,c=t[A+96>>2]+_(c,152)|0,t[c+140>>2]=f,function(A,r,e,i,a,f){var n,b,k=0,c=B(0),u=B(0),s=B(0),d=B(0),v=B(0),g=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=0,Q=B(0),p=0,D=0,w=0,W=0,F=B(0),Z=B(0),Y=B(0);t[r+48>>2]=-2147483648,t[r+52>>2]=-2147483648,t[r+16>>2]=0,t[r+20>>2]=0,k=r+56|0,t[k>>2]=-2147483648,t[k+4>>2]=0,k=r+24|0,t[k>>2]=0,t[k+4>>2]=0,C[r+104>>2]=f,t[r+96>>2]=0,t[r+100>>2]=0,n=t[A+16>>2],A=t[240+(n+_(i,244)|0)>>2],k=t[240+(_(a,244)+n|0)>>2],t[r+132>>2]=0,t[r+148>>2]=a,t[r+144>>2]=i,s=C[e>>2],d=C[e+4>>2],v=C[e+8>>2],t[r+12>>2]=0,c=B(-v),C[r+8>>2]=c,g=B(-d),C[r+4>>2]=g,u=B(-s),C[r>>2]=u,b=r,A?(l(B(B(B(B(C[A+356>>2]*u)+B(C[A+360>>2]*g))+B(C[A+364>>2]*c))*C[A+612>>2])),p=o(0),l(B(B(B(B(C[A+340>>2]*u)+B(C[A+344>>2]*g))+B(C[A+348>>2]*c))*C[A+608>>2])),D=o(0),l(B(B(B(B(C[A+324>>2]*u)+B(C[A+328>>2]*g))+B(C[A+332>>2]*c))*C[A+604>>2])),y=o(0)):y=0,t[b+64>>2]=y,t[r+76>>2]=0,t[r+72>>2]=p,t[r+68>>2]=D,s=C[e+4>>2],d=C[e+8>>2],v=C[e>>2],t[r+44>>2]=t[e+12>>2],C[r+40>>2]=d,C[r+36>>2]=s,C[r+32>>2]=v,e=0,k&&(l(B(B(B(B(v*C[k+356>>2])+B(s*C[k+360>>2]))+B(d*C[k+364>>2]))*C[k+612>>2])),w=o(0),l(B(B(B(B(v*C[k+324>>2])+B(s*C[k+328>>2]))+B(d*C[k+332>>2]))*C[k+604>>2])),W=o(0),l(B(B(B(B(v*C[k+340>>2])+B(s*C[k+344>>2]))+B(d*C[k+348>>2]))*C[k+608>>2])),e=o(0)),t[r+80>>2]=W,t[r+92>>2]=0,t[r+88>>2]=w,t[r+84>>2]=e,e=r,A?(R=B(B(B(C[A+356>>2]*u)+B(C[A+360>>2]*g))+B(C[A+364>>2]*c)),m=B(B(B(C[A+340>>2]*u)+B(C[A+344>>2]*g))+B(C[A+348>>2]*c)),Q=B(B(B(C[A+324>>2]*u)+B(C[A+328>>2]*g))+B(C[A+332>>2]*c))):Q=B(0),R=B(B(B(B(Q*u)+B(m*g))+B(R*c))+B(0)),k?(G=B(B(B(v*C[k+356>>2])+B(s*C[k+360>>2]))+B(d*C[k+364>>2])),F=B(B(B(v*C[k+340>>2])+B(s*C[k+344>>2]))+B(d*C[k+348>>2])),m=B(B(B(C[k+324>>2]*v)+B(C[k+328>>2]*s))+B(C[k+332>>2]*d))):m=B(0),G=B(B(1)/B(R+B(B(B(m*v)+B(F*s))+B(G*d)))),C[e+108>>2]=G,m=B(0),R=B(0),A&&(A=_(i,244)+n|0,h=B(B(B(B(C[A+176>>2]+C[A+208>>2])*B(0))+B(B(C[A+180>>2]+C[A+212>>2])*B(0)))+B(B(C[A+184>>2]+C[A+216>>2])*B(0))),m=C[A+196>>2],Z=C[A+200>>2],R=C[A+192>>2]),g=B(h+B(B(Z*c)+B(B(m*g)+B(R*u)))),k?(A=_(a,244)+n|0,c=B(B(B(B(C[A+176>>2]+C[A+208>>2])*B(-0))+B(B(C[A+180>>2]+C[A+212>>2])*B(-0)))+B(B(C[A+184>>2]+C[A+216>>2])*B(-0))),Y=C[A+200>>2],h=C[A+196>>2],u=C[A+192>>2]):(c=B(-0),h=B(0),u=B(0)),C[r+124>>2]=f,C[r+116>>2]=0,C[r+120>>2]=-f,C[r+112>>2]=G*B(B(0)-B(g+B(c+B(B(d*Y)+B(B(s*h)+B(v*u))))));}(A,c,r,e,i,n);}function ia(A,r,e){var i,a=0;if(i=E-256|0,E=i,a=t[r+212>>2],!((0|a)>-1)){if(a=t[r+252>>2],2&a&&(a=a<<30>>31&r,2&b[a+204|0]||C[a+404>>2]!=B(0)))return a=t[A+8>>2],x(i+8|0,0,244),function(A,r,e){var i=0,a=0,f=0,n=B(0),b=B(0),o=B(0),k=B(0),c=0,u=B(0),l=B(0),s=B(0),d=B(0),v=B(0);r=r?t[r+252>>2]<<30>>31&r:0,t[A+64>>2]=0,t[A+68>>2]=0,t[A+144>>2]=0,t[A+148>>2]=0,i=A+88|0,t[i>>2]=0,t[i+4>>2]=0,i=A+80|0,t[i>>2]=0,t[i+4>>2]=0,i=A+72|0,t[i>>2]=0,t[i+4>>2]=0,i=A+168|0,t[i>>2]=0,t[i+4>>2]=0,i=A+160|0,t[i>>2]=0,t[i+4>>2]=0,i=A+152|0,t[i>>2]=0,t[i+4>>2]=0,r?(i=t[r+8>>2],t[A>>2]=t[r+4>>2],t[A+4>>2]=i,i=r+12|0,a=t[i+4>>2],f=A+8|0,t[f>>2]=t[i>>2],t[f+4>>2]=a,i=r+28|0,a=t[i+4>>2],f=A+24|0,t[f>>2]=t[i>>2],t[f+4>>2]=a,i=r+20|0,a=t[i+4>>2],t[A+16>>2]=t[i>>2],t[A+20>>2]=a,i=r+44|0,a=t[i+4>>2],f=A+40|0,t[f>>2]=t[i>>2],t[f+4>>2]=a,i=r+36|0,a=t[i+4>>2],t[A+32>>2]=t[i>>2],t[A+36>>2]=a,i=r+60|0,a=t[i+4>>2],f=A+56|0,t[f>>2]=t[i>>2],t[f+4>>2]=a,i=r+52|0,a=t[i+4>>2],t[A+48>>2]=t[i>>2],t[A+52>>2]=a,t[A+240>>2]=r,b=C[r+412>>2],i=r+416|0,o=C[i>>2],k=C[r+408>>2],n=C[r+404>>2],t[A+140>>2]=0,C[A+136>>2]=n*o,C[A+132>>2]=n*b,C[A+128>>2]=n*k,a=r+612|0,f=t[a+4>>2],c=A+104|0,t[c>>2]=t[a>>2],t[c+4>>2]=f,a=t[r+608>>2],t[A+96>>2]=t[r+604>>2],t[A+100>>2]=a,a=t[i+4>>2],f=A+120|0,t[f>>2]=t[i>>2],t[f+4>>2]=a,i=t[r+412>>2],t[A+112>>2]=t[r+408>>2],t[A+116>>2]=i,i=r+380|0,a=t[i+4>>2],f=A+184|0,t[f>>2]=t[i>>2],t[f+4>>2]=a,i=t[r+376>>2],t[A+176>>2]=t[r+372>>2],t[A+180>>2]=i,i=t[r+392>>2],t[A+192>>2]=t[r+388>>2],t[A+196>>2]=i,i=r+396|0,a=t[i+4>>2],f=A+200|0,t[f>>2]=t[i>>2],t[f+4>>2]=a,b=C[r+476>>2],o=C[r+480>>2],k=C[r+472>>2],n=C[r+404>>2],t[A+220>>2]=0,C[A+216>>2]=B(n*o)*e,C[A+212>>2]=B(n*b)*e,C[A+208>>2]=B(n*k)*e,k=C[r+340>>2],u=C[r+356>>2],l=C[r+328>>2],s=C[r+344>>2],d=C[r+360>>2],v=C[r+324>>2],n=C[r+488>>2],b=C[r+492>>2],o=C[r+496>>2],C[A+232>>2]=B(B(B(n*C[r+332>>2])+B(b*C[r+348>>2]))+B(o*C[r+364>>2]))*e,C[A+228>>2]=B(B(B(n*l)+B(b*s))+B(o*d))*e,C[A+224>>2]=B(B(B(v*n)+B(k*b))+B(u*o))*e):(t[A+4>>2]=0,t[A+8>>2]=0,t[A>>2]=1065353216,t[A+32>>2]=0,t[A+36>>2]=0,t[A+240>>2]=0,t[A+128>>2]=0,t[A+132>>2]=0,t[A+112>>2]=1065353216,t[A+116>>2]=1065353216,t[A+96>>2]=1065353216,t[A+100>>2]=1065353216,r=A+12|0,t[r>>2]=0,t[r+4>>2]=0,t[A+20>>2]=1065353216,r=A+24|0,t[r>>2]=0,t[r+4>>2]=0,t[A+40>>2]=1065353216,t[A+60>>2]=0,r=A+52|0,t[r>>2]=0,t[r+4>>2]=0,r=A+44|0,t[r>>2]=0,t[r+4>>2]=0,r=A+136|0,t[r>>2]=0,t[r+4>>2]=0,r=A+120|0,t[r>>2]=1065353216,t[r+4>>2]=0,r=A+104|0,t[r>>2]=1065353216,t[r+4>>2]=0,t[A+232>>2]=0,r=A+224|0,t[r>>2]=0,t[r+4>>2]=0,r=A+216|0,t[r>>2]=0,t[r+4>>2]=0,r=A+208|0,t[r>>2]=0,t[r+4>>2]=0,r=A+200|0,t[r>>2]=0,t[r+4>>2]=0,r=A+192|0,t[r>>2]=0,t[r+4>>2]=0,r=A+184|0,t[r>>2]=0,t[r+4>>2]=0,t[A+176>>2]=0,t[A+180>>2]=0),t[A+236>>2]=0;}(aa(A+4|0,i+8|0),r,e),t[r+212>>2]=a,E=i+256|0,a;if(a=t[A+188>>2],!((0|a)>-1))return r=A+188|0,t[r>>2]=t[A+8>>2],x(i+8|0,0,244),A=aa(A+4|0,i+8|0),a=A+88|0,t[a>>2]=0,t[a+4>>2]=0,a=A+80|0,t[a>>2]=0,t[a+4>>2]=0,a=A+72|0,t[a>>2]=0,t[a+4>>2]=0,t[A+64>>2]=0,t[A+68>>2]=0,a=A+168|0,t[a>>2]=0,t[a+4>>2]=0,a=A+160|0,t[a>>2]=0,t[a+4>>2]=0,a=A+152|0,t[a>>2]=0,t[a+4>>2]=0,t[A+144>>2]=0,t[A+148>>2]=0,t[A>>2]=1065353216,a=A+12|0,t[a>>2]=0,t[a+4>>2]=0,t[A+4>>2]=0,t[A+8>>2]=0,t[A+20>>2]=1065353216,t[A+32>>2]=0,t[A+36>>2]=0,a=A+24|0,t[a>>2]=0,t[a+4>>2]=0,t[A+40>>2]=1065353216,t[A+60>>2]=0,a=A+52|0,t[a>>2]=0,t[a+4>>2]=0,a=A+44|0,t[a>>2]=0,t[a+4>>2]=0,t[A+240>>2]=0,a=A+136|0,t[a>>2]=0,t[a+4>>2]=0,t[A+128>>2]=0,t[A+132>>2]=0,a=A+120|0,t[a>>2]=1065353216,t[a+4>>2]=0,t[A+112>>2]=1065353216,t[A+116>>2]=1065353216,a=A+104|0,t[a>>2]=1065353216,t[a+4>>2]=0,t[A+96>>2]=1065353216,t[A+100>>2]=1065353216,a=A+232|0,t[a>>2]=0,t[a+4>>2]=0,a=A+224|0,t[a>>2]=0,t[a+4>>2]=0,a=A+216|0,t[a>>2]=0,t[a+4>>2]=0,a=A+208|0,t[a>>2]=0,t[a+4>>2]=0,a=A+200|0,t[a>>2]=0,t[a+4>>2]=0,a=A+192|0,t[a>>2]=0,t[a+4>>2]=0,a=A+184|0,t[a>>2]=0,t[a+4>>2]=0,t[A+176>>2]=0,t[A+180>>2]=0,E=i+256|0,t[r>>2];}return E=i+256|0,a;}function aa(A,r){var e=0,i=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0;if(n=t[A+4>>2],c=n,(0|n)==t[A+8>>2]&&(c=n,l=n?n<<1:1,!((0|n)>=(0|l)))){A:{r:{if(l){if(s=CA(_(l,244),16),c=t[A+4>>2],(0|c)>=1)break r;break A;}if((0|n)<1)break A;}for(u=64,d=A+12|0;o=t[d>>2]+u|0,i=o+-56|0,k=t[i+4>>2],e=u+s|0,f=e+-56|0,t[f>>2]=t[i>>2],t[f+4>>2]=k,i=o+-64|0,k=t[i+4>>2],f=e+-64|0,t[f>>2]=t[i>>2],t[f+4>>2]=k,i=o+-40|0,k=t[i+4>>2],f=e+-40|0,t[f>>2]=t[i>>2],t[f+4>>2]=k,i=o+-48|0,k=t[i+4>>2],f=e+-48|0,t[f>>2]=t[i>>2],t[f+4>>2]=k,i=o+-32|0,k=t[i+4>>2],f=e+-32|0,t[f>>2]=t[i>>2],t[f+4>>2]=k,i=o+-24|0,k=t[i+4>>2],f=e+-24|0,t[f>>2]=t[i>>2],t[f+4>>2]=k,i=o+-8|0,k=t[i+4>>2],f=e+-8|0,t[f>>2]=t[i>>2],t[f+4>>2]=k,i=o+-16|0,k=t[i+4>>2],f=e+-16|0,t[f>>2]=t[i>>2],t[f+4>>2]=k,J(e,o,180),u=u+244|0,c=c+-1|0,c;){}}c=t[A+12>>2],c&&(b[A+16|0]&&gA(c),t[A+12>>2]=0),a[A+16|0]=1,t[A+12>>2]=s,t[A+8>>2]=l,c=t[A+4>>2];}return t[A+4>>2]=c+1,o=r+8|0,u=t[o+4>>2],c=_(n,244),n=c+t[A+12>>2]|0,e=n+8|0,t[e>>2]=t[o>>2],t[e+4>>2]=u,e=t[r+4>>2],t[n>>2]=t[r>>2],t[n+4>>2]=e,o=r+24|0,u=t[o+4>>2],e=n+24|0,t[e>>2]=t[o>>2],t[e+4>>2]=u,e=t[r+20>>2],t[n+16>>2]=t[r+16>>2],t[n+20>>2]=e,o=r+40|0,u=t[o+4>>2],e=n+40|0,t[e>>2]=t[o>>2],t[e+4>>2]=u,e=t[r+36>>2],t[n+32>>2]=t[r+32>>2],t[n+36>>2]=e,o=r+56|0,u=t[o+4>>2],e=n+56|0,t[e>>2]=t[o>>2],t[e+4>>2]=u,e=t[r+52>>2],t[n+48>>2]=t[r+48>>2],t[n+52>>2]=e,J(n- -64|0,r- -64|0,180),c+t[A+12>>2]|0;}function fa(A,r,e,i,a,f,n,o,k){var c,u,l,s,d,v=B(0),g=B(0),R=B(0),G=B(0),y=B(0),Q=B(0),p=B(0),D=0,w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),E=B(0),N=0,V=B(0),I=B(0),J=B(0),X=B(0),M=B(0),x=B(0),S=B(0);t[n>>2]=t[f+28>>2],u=t[A+16>>2],l=u+_(i,244)|0,A=t[l+240>>2],s=_(e,244)+u|0,c=t[s+240>>2],Z=C[f+12>>2],x=C[f+36>>2],Q=C[f+40>>2],D=t[a+120>>2];A:if(6&D){if(Q=2&D?C[a+144>>2]:Q,!(4&D))break A;x=C[a+148>>2];}else 8&D&&(g=B(Z*C[a+144>>2]),v=B(h(B(g+C[a+148>>2]),B(1.1920928955078125e-7))),x=B(g/v),Q=B(B(1)/v));N=a+68|0,v=C[N>>2],g=C[o>>2],G=C[o+4>>2],R=C[a+64>>2],p=B(B(v*g)-B(G*R)),y=C[o+8>>2],w=B(y*R),d=a+72|0,R=C[d>>2],W=B(w-B(R*g)),F=B(B(G*R)-B(y*v)),D=a- -64|0,y=B(0),v=B(0),g=B(0),c&&(E=B(B(B(B(F*C[c+356>>2])+B(W*C[c+360>>2]))+B(p*C[c+364>>2]))*C[c+612>>2]),g=B(B(B(B(F*C[c+340>>2])+B(W*C[c+344>>2]))+B(p*C[c+348>>2]))*C[c+608>>2]),v=B(B(B(B(F*C[c+324>>2])+B(W*C[c+328>>2]))+B(p*C[c+332>>2]))*C[c+604>>2])),C[r+64>>2]=v,t[r+76>>2]=0,C[r+72>>2]=E,C[r+68>>2]=g,G=C[N>>2],R=C[k>>2],w=C[k+4>>2],Y=C[D>>2],V=B(B(G*R)-B(w*Y)),X=C[k+8>>2],I=C[d>>2],Y=B(B(X*Y)-B(I*R)),I=B(B(w*I)-B(X*G)),G=B(0),R=B(0),X=B(B(1)/Z),A&&(y=B(-I),R=B(B(B(B(C[A+356>>2]*y)-B(C[A+360>>2]*Y))-B(C[A+364>>2]*V))*C[A+612>>2]),G=B(B(B(B(C[A+340>>2]*y)-B(C[A+344>>2]*Y))-B(C[A+348>>2]*V))*C[A+608>>2]),y=B(B(B(B(C[A+324>>2]*y)-B(C[A+328>>2]*Y))-B(C[A+332>>2]*V))*C[A+604>>2])),C[r+80>>2]=y,t[r+92>>2]=0,C[r+88>>2]=R,C[r+84>>2]=G,Z=B(0),w=B(0),c&&(w=C[o+8>>2],M=C[o+4>>2],S=B(B(B(g*w)-B(E*M))*C[a- -64>>2]),J=E,E=C[o>>2],w=B(C[c+404>>2]+B(B(S+B(B(B(J*E)-B(w*v))*C[a+68>>2]))+B(B(B(M*v)-B(g*E))*C[a+72>>2])))),N=r,M=C[n>>2],E=B(X*Q),J=E,A&&(v=C[k+4>>2],g=C[k+8>>2],Z=B(B(B(v*R)-B(g*G))*C[a- -64>>2]),Q=B(g*y),g=C[k>>2],Z=B(C[A+404>>2]+B(B(Z+B(B(Q-B(g*R))*C[a+68>>2]))+B(B(B(g*G)-B(v*y))*C[a+72>>2])))),C[N+108>>2]=M/B(J+B(w+Z)),n=r+16|0;A:{r:{e:{if(c){if(N=t[D+4>>2],t[n>>2]=t[D>>2],t[n+4>>2]=N,D=D+8|0,N=t[D+4>>2],n=n+8|0,t[n>>2]=t[D>>2],t[n+4>>2]=N,t[r+12>>2]=0,C[r+8>>2]=p,C[r+4>>2]=W,C[r>>2]=F,!A)break e;break r;}if(t[r>>2]=0,t[r+4>>2]=0,D=r+24|0,t[D>>2]=0,t[D+4>>2]=0,t[n>>2]=0,t[n+4>>2]=0,n=r+8|0,t[n>>2]=0,t[n+4>>2]=0,A)break r;}t[r+32>>2]=0,t[r+36>>2]=0,n=r+56|0,t[n>>2]=0,t[n+4>>2]=0,n=r+48|0,t[n>>2]=0,t[n+4>>2]=0,n=r+40|0,t[n>>2]=0,t[n+4>>2]=0;break A;}v=C[a- -64>>2],g=C[a+68>>2],G=C[a+72>>2],t[r+60>>2]=0,t[r+44>>2]=0,C[r+40>>2]=-V,C[r+36>>2]=-Y,C[r+32>>2]=-I,C[r+56>>2]=-G,C[r+52>>2]=-g,C[r+48>>2]=-v;}Z=C[f+64>>2],w=C[a+80>>2],y=B(0),v=B(0),g=B(0),G=B(0),c&&(g=C[c+392>>2],R=C[o+8>>2],Q=C[c+396>>2],G=C[o+4>>2],v=B(B(B(g*R)-B(Q*G))+C[c+372>>2]),p=C[c+388>>2],J=g,g=C[o>>2],G=B(B(B(G*p)-B(J*g))+C[c+380>>2]),g=B(C[c+376>>2]+B(B(Q*g)-B(R*p)))),R=B(0),p=B(0),A&&(R=C[A+392>>2],Q=C[k+8>>2],W=C[A+396>>2],p=C[k+4>>2],y=B(B(B(R*Q)-B(W*p))+C[A+372>>2]),F=C[A+388>>2],J=R,R=C[k>>2],p=B(B(B(p*F)-B(J*R))+C[A+380>>2]),R=B(C[A+376>>2]+B(B(W*R)-B(Q*F)))),n=l+240|0,o=s+240|0,Q=C[a+72>>2],W=C[a- -64>>2],F=C[a+68>>2],t[r+104>>2]=t[a+84>>2],v=B(B(B(W*B(v-y))+B(F*B(g-R)))+B(Q*B(G-p))),Q=B(m(v))<C[f+96>>2]?B(0):B(-B(v*C[a+96>>2])),4&b[f+72|0]?(v=B(C[a+124>>2]*C[f+68>>2]),C[r+100>>2]=v,!c|!t[o>>2]||(g=C[c+416>>2],G=C[r+24>>2],R=C[c+412>>2],y=C[r+20>>2],a=_(e,244)+u|0,C[a+64>>2]=B(C[a+112>>2]*B(v*B(B(C[r+16>>2]*C[a+128>>2])*C[c+408>>2])))+C[a+64>>2],k=a+68|0,C[k>>2]=B(B(v*B(R*B(y*C[a+132>>2])))*C[a+116>>2])+C[k>>2],k=a+72|0,C[k>>2]=B(B(v*B(g*B(G*C[a+136>>2])))*C[a+120>>2])+C[k>>2],g=C[r+72>>2],G=C[r+68>>2],C[a+80>>2]=B(B(v*C[a+96>>2])*C[r- -64>>2])+C[a+80>>2],R=C[a+104>>2],k=a+84|0,C[k>>2]=B(G*B(v*C[a+100>>2]))+C[k>>2],a=a+88|0,C[a>>2]=B(g*B(v*R))+C[a>>2]),!A|!t[n>>2]||(g=C[r+88>>2],G=C[r+84>>2],R=C[r+80>>2],y=C[A+416>>2],p=C[r+56>>2],W=C[A+412>>2],F=C[r+52>>2],a=_(i,244)+u|0,v=C[r+100>>2],C[a+64>>2]=B(C[a+112>>2]*B(v*B(B(C[r+48>>2]*C[a+128>>2])*C[A+408>>2])))+C[a+64>>2],A=a+68|0,C[A>>2]=B(B(v*B(W*B(F*C[a+132>>2])))*C[a+116>>2])+C[A>>2],A=a+72|0,C[A>>2]=B(B(v*B(y*B(p*C[a+136>>2])))*C[a+120>>2])+C[A>>2],v=B(-v),C[a+80>>2]=C[a+80>>2]-B(R*B(C[a+96>>2]*v)),R=C[a+104>>2],A=a+84|0,C[A>>2]=C[A>>2]-B(G*B(C[a+100>>2]*v)),A=a+88|0,C[A>>2]=C[A>>2]-B(g*B(R*v)))):t[r+100>>2]=0,a=Q<=B(0),t[r+96>>2]=0,g=B(0),G=B(0),R=B(0),p=B(0),W=B(0),F=B(0),V=B(0),t[o>>2]&&(A=_(e,244)+u|0,V=C[A+224>>2],p=C[A+208>>2],W=C[A+232>>2],F=C[A+228>>2],R=C[A+212>>2],G=C[A+216>>2]),y=B(w+Z),I=a?B(0):Q,v=B(0),Y=B(0),Q=B(0),Z=B(0),w=B(0),t[n>>2]&&(A=_(i,244)+u|0,w=C[A+224>>2],g=C[A+208>>2],Q=C[A+232>>2],Z=C[A+228>>2],Y=C[A+216>>2],v=C[A+212>>2]),A=_(e,244)+u|0,R=B(B(B(B(B(p+C[A+176>>2])*C[r+16>>2])+B(B(R+C[A+180>>2])*C[r+20>>2]))+B(B(G+C[A+184>>2])*C[r+24>>2]))+B(B(B(B(V+C[A+192>>2])*C[r>>2])+B(B(F+C[A+196>>2])*C[r+4>>2]))+B(B(W+C[A+200>>2])*C[r+8>>2]))),A=_(i,244)+u|0,v=B(I-B(R+B(B(B(B(B(g+C[A+176>>2])*C[r+48>>2])+B(B(v+C[A+180>>2])*C[r+52>>2]))+B(B(Y+C[A+184>>2])*C[r+56>>2]))+B(B(B(B(w+C[A+192>>2])*C[r+32>>2])+B(B(Z+C[A+196>>2])*C[r+36>>2]))+B(B(Q+C[A+200>>2])*C[r+40>>2]))))),g=B(0),y>B(0)?v=B(v-B(X*y)):g=B(-B(X*B(x*y))),G=C[r+108>>2],v=B(v*G),g=B(g*G),y>C[f+56>>2]^1&&t[f+52>>2]||(v=B(g+v),g=B(0)),C[r+128>>2]=g,C[r+112>>2]=v,t[r+120>>2]=0,t[r+124>>2]=1343554297,C[r+116>>2]=E*G;}function na(A,r,e,i,a,f){var n,b,o,k,c,u,l,s=B(0),d=B(0),v=0,g=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0);o=t[A+16>>2],n=t[240+(o+_(i,244)|0)>>2],b=t[240+(_(e,244)+o|0)>>2],k=t[A+76>>2],c=t[r+140>>2],u=t[f+72>>2],l=4&u;A:{r:{if(!l){if(t[100+(_(c,152)+k|0)>>2]=0,16&u)break r;break A;}if(r=_(c,152)+k|0,s=B(C[a+128>>2]*C[f+68>>2]),C[r+100>>2]=s,b&&(g=C[b+416>>2],m=C[r+24>>2],R=C[b+412>>2],G=C[r+20>>2],A=_(e,244)+o|0,d=C[b+404>>2],C[A+64>>2]=B(B(s*B(B(d*C[r+16>>2])*C[b+408>>2]))*C[A+112>>2])+C[A+64>>2],v=A+68|0,C[v>>2]=B(B(s*B(R*B(d*G)))*C[A+116>>2])+C[v>>2],v=A+72|0,C[v>>2]=B(B(s*B(g*B(d*m)))*C[A+120>>2])+C[v>>2],d=C[r+72>>2],g=C[r+68>>2],C[A+80>>2]=B(B(s*C[A+96>>2])*C[r+64>>2])+C[A+80>>2],m=C[A+104>>2],v=A+84|0,C[v>>2]=B(g*B(s*C[A+100>>2]))+C[v>>2],A=A+88|0,C[A>>2]=B(d*B(s*m))+C[A>>2]),n&&(v=_(c,152)+k|0,g=C[v+88>>2],m=C[v+84>>2],R=C[v+80>>2],G=C[n+416>>2],h=C[v+56>>2],y=C[n+412>>2],Q=C[v+52>>2],A=_(i,244)+o|0,d=C[n+404>>2],s=C[r+100>>2],C[A+64>>2]=B(B(B(B(C[v+48>>2]*d)*C[n+408>>2])*s)*C[A+112>>2])+C[A+64>>2],r=A+68|0,C[r>>2]=B(B(s*B(y*B(Q*d)))*C[A+116>>2])+C[r>>2],r=A+72|0,C[r>>2]=B(B(s*B(G*B(h*d)))*C[A+120>>2])+C[r>>2],C[A+80>>2]=C[A+80>>2]+B(R*B(s*C[A+96>>2])),d=C[A+104>>2],r=A+84|0,C[r>>2]=C[r>>2]+B(m*B(s*C[A+100>>2])),A=A+88|0,C[A>>2]=C[A>>2]+B(g*B(d*s))),!(16&u))break A;}v=c+1|0,l?(r=_(v,152)+k|0,s=B(C[a+132>>2]*C[f+68>>2]),C[r+100>>2]=s,b&&(g=C[r+24>>2],m=C[r+20>>2],A=_(e,244)+o|0,d=C[b+404>>2],C[A+64>>2]=B(B(s*B(d*C[r+16>>2]))*C[A+112>>2])+C[A+64>>2],e=A+68|0,C[e>>2]=B(B(s*B(d*m))*C[A+116>>2])+C[e>>2],e=A+72|0,C[e>>2]=B(B(s*B(d*g))*C[A+120>>2])+C[e>>2],d=C[r+72>>2],g=C[r+68>>2],C[A+80>>2]=B(B(s*C[A+96>>2])*C[r+64>>2])+C[A+80>>2],m=C[A+104>>2],e=A+84|0,C[e>>2]=B(g*B(s*C[A+100>>2]))+C[e>>2],A=A+88|0,C[A>>2]=B(d*B(s*m))+C[A>>2]),n&&(e=_(v,152)+k|0,g=C[e+88>>2],m=C[e+84>>2],R=C[e+56>>2],G=C[e+52>>2],h=C[e+48>>2],d=C[n+404>>2],A=_(i,244)+o|0,s=C[r+100>>2],C[A+80>>2]=C[A+80>>2]+B(C[e+80>>2]*B(C[A+96>>2]*s)),C[A+64>>2]=B(B(s*B(h*d))*C[A+112>>2])+C[A+64>>2],r=A+68|0,C[r>>2]=B(B(s*B(G*d))*C[A+116>>2])+C[r>>2],r=A+72|0,C[r>>2]=B(B(s*B(R*d))*C[A+120>>2])+C[r>>2],d=C[A+104>>2],r=A+84|0,C[r>>2]=C[r>>2]+B(m*B(s*C[A+100>>2])),A=A+88|0,C[A>>2]=C[A>>2]+B(g*B(d*s)))):t[100+(_(v,152)+k|0)>>2]=0;}}function ta(A,r,e){var i,f,n,o,k,c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),R=0,G=B(0),h=B(0),y=B(0),p=0,D=B(0),w=0,W=0,F=B(0),Z=B(0),Y=B(0),N=B(0),V=0,I=B(0),X=0,M=B(0),x=0,S=0,T=0,U=B(0),j=B(0),O=B(0),H=B(0),z=B(0),P=B(0),L=B(0),K=0,q=0,$=0,AA=0,rA=0,eA=0,iA=0,aA=0,fA=0,nA=B(0),tA=0,bA=0,oA=0,kA=0,cA=0,uA=0,lA=0,sA=0,dA=0,vA=0,_A=0,BA=0,mA=0,RA=0,GA=0,hA=0,yA=0,QA=0,pA=0,DA=0,wA=0,WA=0,FA=0,ZA=0,YA=0,EA=0,NA=0,VA=0,IA=0,JA=0,XA=0,MA=0,xA=0,SA=0,TA=B(0);if(f=E-80|0,E=f,n=t[r+776>>2],i=t[r+772>>2],o=ia(A,i,C[e+12>>2]),k=ia(A,n,C[e+12>>2]),W=t[A+16>>2],R=W+_(o,244)|0,c=C[R+128>>2],u=B(c*c),c=C[R+132>>2],u=B(u+B(c*c)),c=C[R+136>>2],!(B(u+B(c*c))<B(1.4210854715202004e-14)&&(R=W+_(k,244)|0,c=C[R+128>>2],u=B(c*c),c=C[R+132>>2],u=B(u+B(c*c)),c=C[R+136>>2],B(u+B(c*c))<B(1.4210854715202004e-14))||(p=t[r+780>>2],(0|p)<1)))for(R=W+_(k,244)|0,lA=R+232|0,sA=R+200|0,dA=R+228|0,vA=R+196|0,_A=R+224|0,BA=R+192|0,mA=R+216|0,RA=R+184|0,GA=R+212|0,hA=R+180|0,yA=R+208|0,QA=R+176|0,pA=R+240|0,R=W+_(o,244)|0,DA=R+232|0,wA=R+200|0,WA=R+228|0,FA=R+196|0,ZA=R+224|0,YA=R+192|0,EA=R+216|0,NA=R+184|0,VA=R+212|0,IA=R+180|0,JA=R+208|0,XA=R+176|0,MA=R+240|0,xA=r+788|0,cA=A+32|0,oA=A+28|0,fA=A+36|0,uA=A+40|0,$=n+24|0,AA=n+168|0,rA=n+20|0,eA=n+164|0,iA=n+172|0,SA=r+780|0;;){if(w=_(kA,192)+r|0,C[w+84>>2]<=C[xA>>2]){if(q=w+4|0,R=t[oA>>2],p=R,(0|R)==t[cA>>2]&&(p=R,V=R?R<<1:1,!((0|R)>=(0|V)))){A:{r:{if(V){if(X=CA(_(V,152),16),W=t[oA>>2],(0|W)>=1)break r;break A;}if(X=0,W=R,(0|R)<1)break A;}for(p=0;J(p+X|0,t[fA>>2]+p|0,152),p=p+152|0,W=W+-1|0,W;){}}p=t[fA>>2],p&&(b[0|uA]&&gA(p),t[fA>>2]=0),t[fA>>2]=X,a[0|uA]=1,t[cA>>2]=V,p=t[oA>>2];}if(t[oA>>2]=p+1,aA=t[fA>>2]+_(R,152)|0,t[aA+132>>2]=q,t[f+76>>2]=0,t[aA+148>>2]=k,t[aA+144>>2]=o,c=B(C[w+60>>2]-C[i+60>>2]),C[f+72>>2]=c,u=B(C[w+56>>2]-C[i+56>>2]),C[f+68>>2]=u,l=B(C[w+52>>2]-C[i+52>>2]),C[f+64>>2]=l,v=C[w+36>>2],y=C[n+52>>2],d=C[w+40>>2],G=C[n+56>>2],s=C[w+44>>2],g=C[n+60>>2],t[f+60>>2]=0,s=B(s-g),C[f+56>>2]=s,d=B(d-G),C[f+52>>2]=d,v=B(v-y),C[f+48>>2]=v,g=B(0),D=B(0),F=B(0),h=B(0),t[MA>>2]&&(y=B(C[YA>>2]+C[ZA>>2]),G=B(C[FA>>2]+C[WA>>2]),h=B(B(C[NA>>2]+C[EA>>2])+B(B(u*y)-B(l*G))),D=l,l=B(C[wA>>2]+C[DA>>2]),F=B(B(C[IA>>2]+C[VA>>2])+B(B(D*l)-B(c*y))),D=B(B(C[XA>>2]+C[JA>>2])+B(B(c*G)-B(u*l)))),M=B(0),I=B(0),t[pA>>2]&&(c=B(C[BA>>2]+C[_A>>2]),u=B(C[vA>>2]+C[dA>>2]),I=B(B(C[RA>>2]+C[mA>>2])+B(B(d*c)-B(v*u))),l=B(C[sA>>2]+C[lA>>2]),M=B(B(C[hA>>2]+C[GA>>2])+B(B(v*l)-B(s*c))),g=B(B(C[QA>>2]+C[yA>>2])+B(B(s*u)-B(d*l)))),K=w+76|0,N=C[K>>2],X=w+68|0,nA=C[X>>2],T=w+72|0,TA=C[T>>2],fa(A,aA,o,k,q,e,f+44|0,f- -64|0,f+48|0),t[aA+140>>2]=t[A+68>>2],W=w+92|0,C[W>>2]>B(0)){ea(A,X,o,k,R,C[w+96>>2]),l=C[K>>2],B(m(l))>B(.7071067690849304)?(c=C[T>>2],s=B(B(l*l)+B(c*c)),u=B(B(1)/B(Q(s))),c=B(c*u),C[f+32>>2]=c,t[f+24>>2]=0,d=B(s*u),C[f+8>>2]=d,u=B(-B(l*u)),C[f+28>>2]=u,l=C[X>>2],v=B(-B(l*c)),C[f+12>>2]=v,l=B(l*u),s=B(0)):(t[f+32>>2]=0,u=C[X>>2],s=C[T>>2],y=B(B(u*u)+B(s*s)),c=B(B(1)/B(Q(y))),u=B(u*c),C[f+28>>2]=u,s=B(-B(s*c)),C[f+24>>2]=s,v=B(l*s),C[f+12>>2]=v,d=B(-B(l*u)),C[f+8>>2]=d,l=B(y*c),c=B(0)),V=f+32|0,y=B(B(1)/B(Q(B(B(B(s*s)+B(u*u))+B(c*c))))),c=B(c*y),C[V>>2]=c,x=f+16|0,G=B(B(1)/B(Q(B(B(l*l)+B(B(d*d)+B(v*v)))))),l=B(l*G),C[x>>2]=l,u=B(u*y),C[f+28>>2]=u,s=B(s*y),C[f+24>>2]=s,v=B(v*G),C[f+12>>2]=v,d=B(d*G),C[f+8>>2]=d;A:{r:{e:{S=2&t[i+180>>2];i:{if(!S){if(p=2&t[n+180>>2],p)break i;break e;}if(t[f+36>>2]=0,U=C[i+4>>2],j=C[i+20>>2],O=C[i+36>>2],y=B(B(B(B(s*U)+B(u*j))+B(c*O))*C[i+164>>2]),H=C[i+8>>2],z=C[i+24>>2],P=C[i+40>>2],G=B(B(B(B(s*H)+B(u*z))+B(c*P))*C[i+168>>2]),L=C[i+12>>2],Z=u,u=C[i+28>>2],Y=c,c=C[i+44>>2],s=B(B(B(B(s*L)+B(Z*u))+B(Y*c))*C[i+172>>2]),c=B(B(B(O*y)+B(P*G))+B(c*s)),C[V>>2]=c,u=B(B(B(j*y)+B(z*G))+B(u*s)),C[f+28>>2]=u,s=B(B(B(U*y)+B(H*G))+B(L*s)),C[f+24>>2]=s,p=2&t[n+180>>2],!p)break e;}if(t[f+36>>2]=0,U=C[n+4>>2],j=C[rA>>2],O=C[n+36>>2],y=B(B(B(B(U*s)+B(j*u))+B(O*c))*C[eA>>2]),H=C[n+8>>2],z=C[$>>2],P=C[n+40>>2],G=B(B(B(B(s*H)+B(u*z))+B(c*P))*C[AA>>2]),L=C[n+12>>2],Z=u,u=C[n+28>>2],Y=c,c=C[n+44>>2],s=B(B(B(B(s*L)+B(Z*u))+B(Y*c))*C[iA>>2]),c=B(B(B(O*y)+B(P*G))+B(c*s)),C[V>>2]=c,u=B(B(B(j*y)+B(z*G))+B(u*s)),C[f+28>>2]=u,s=B(B(B(U*y)+B(H*G))+B(L*s)),C[f+24>>2]=s,!S)break A;break r;}if(!S)break A;}t[f+20>>2]=0,U=C[i+4>>2],j=C[i+20>>2],O=C[i+36>>2],y=B(B(B(B(d*U)+B(v*j))+B(l*O))*C[i+164>>2]),H=C[i+8>>2],z=C[i+24>>2],P=C[i+40>>2],G=B(B(B(B(d*H)+B(v*z))+B(l*P))*C[i+168>>2]),L=C[i+12>>2],Z=v,v=C[i+28>>2],Y=l,l=C[i+44>>2],d=B(B(B(B(d*L)+B(Z*v))+B(Y*l))*C[i+172>>2]),l=B(B(B(O*y)+B(P*G))+B(l*d)),C[x>>2]=l,v=B(B(B(j*y)+B(z*G))+B(v*d)),C[f+12>>2]=v,d=B(B(B(U*y)+B(H*G))+B(L*d)),C[f+8>>2]=d;}p&&(t[f+20>>2]=0,U=C[n+4>>2],j=C[rA>>2],O=C[n+36>>2],y=B(B(B(B(U*d)+B(j*v))+B(O*l))*C[eA>>2]),H=C[n+8>>2],z=C[$>>2],P=C[n+40>>2],G=B(B(B(B(d*H)+B(v*z))+B(l*P))*C[AA>>2]),L=C[n+12>>2],Z=v,v=C[n+28>>2],Y=l,l=C[n+44>>2],d=B(B(B(B(d*L)+B(Z*v))+B(Y*l))*C[iA>>2]),l=B(B(B(O*y)+B(P*G))+B(l*d)),C[x>>2]=l,v=B(B(B(j*y)+B(z*G))+B(v*d)),C[f+12>>2]=v,d=B(B(B(U*y)+B(H*G))+B(L*d)),C[f+8>>2]=d),+B(Q(B(B(B(s*s)+B(u*u))+B(c*c))))>.001&&ea(A,f+24|0,o,k,R,C[W>>2]),+B(Q(B(B(B(d*d)+B(v*v))+B(l*l))))>.001&&ea(A,f+8|0,o,k,R,C[W>>2]);}A:{r:{e:{if(x=e+72|0,!(1&a[w+124|0]&&32&b[0|x])){if(S=w+176|0,t[S>>2]=0,d=B(D-g),u=B(F-M),l=B(h-I),c=B(B(B(d*nA)+B(u*TA))+B(l*N)),W=w+172|0,s=C[K>>2],l=B(l-B(c*s)),C[W>>2]=l,V=w+168|0,g=u,u=C[T>>2],v=B(g-B(c*u)),C[V>>2]=v,p=w+164|0,g=d,d=C[X>>2],c=B(g-B(c*d)),C[p>>2]=c,!(64&t[x>>2])&&(y=B(B(B(c*c)+B(v*v))+B(l*l)),y>B(1.1920928955078125e-7))){if(s=B(B(1)/B(Q(y))),l=B(l*s),C[W>>2]=l,u=B(v*s),C[V>>2]=u,c=B(c*s),C[p>>2]=c,tA=i+180|0,1&a[0|tA]&&(M=C[i+172>>2],s=C[i+44>>2],d=C[i+12>>2],v=C[i+28>>2],I=C[i+164>>2],y=C[i+36>>2],G=C[i+4>>2],g=C[i+20>>2],N=C[i+168>>2],D=C[i+40>>2],F=C[i+8>>2],h=C[i+24>>2],t[S>>2]=0,Z=g,g=B(I*B(B(B(c*G)+B(u*g))+B(l*y))),Y=h,h=B(N*B(B(B(c*F)+B(u*h))+B(l*D))),l=B(M*B(B(B(c*d)+B(u*v))+B(l*s))),u=B(B(B(Z*g)+B(Y*h))+B(v*l)),C[V>>2]=u,c=B(B(B(G*g)+B(F*h))+B(d*l)),C[p>>2]=c,l=B(B(B(y*g)+B(D*h))+B(s*l)),C[W>>2]=l),bA=n+180|0,1&a[0|bA]&&(M=C[iA>>2],s=C[n+44>>2],d=C[n+12>>2],v=C[n+28>>2],I=C[eA>>2],y=C[n+36>>2],G=C[n+4>>2],g=C[rA>>2],N=C[AA>>2],D=C[n+40>>2],F=C[n+8>>2],h=C[$>>2],t[S>>2]=0,Z=g,g=B(I*B(B(B(G*c)+B(g*u))+B(y*l))),Y=h,h=B(N*B(B(B(c*F)+B(u*h))+B(l*D))),c=B(M*B(B(B(c*d)+B(u*v))+B(l*s))),C[V>>2]=B(B(Z*g)+B(Y*h))+B(v*c),C[p>>2]=B(B(G*g)+B(F*h))+B(d*c),C[W>>2]=B(B(y*g)+B(D*h))+B(s*c)),M=C[f+44>>2],ra(A,p,o,k,R,q,f- -64|0,f+48|0,M,e,B(0),B(0)),!(16&b[0|x]))break A;x=w+192|0,t[x>>2]=0,S=w+188|0,u=C[T>>2],l=C[p>>2],s=C[V>>2],d=C[X>>2],c=B(B(u*l)-B(s*d)),g=s,s=C[K>>2],v=C[W>>2],u=B(B(g*s)-B(v*u)),l=B(B(v*d)-B(s*l)),s=B(B(1)/B(Q(B(B(B(u*u)+B(l*l))+B(c*c))))),c=B(c*s),C[S>>2]=c,W=w+184|0,l=B(l*s),C[W>>2]=l,p=w+180|0,u=B(u*s),C[p>>2]=u,1&a[0|tA]&&(I=C[i+172>>2],s=C[i+44>>2],d=C[i+12>>2],v=C[i+28>>2],N=C[i+164>>2],y=C[i+36>>2],G=C[i+4>>2],g=C[i+20>>2],nA=C[i+168>>2],D=C[i+40>>2],F=C[i+8>>2],h=C[i+24>>2],t[x>>2]=0,Z=g,g=B(N*B(B(B(u*G)+B(l*g))+B(c*y))),Y=h,h=B(nA*B(B(B(u*F)+B(l*h))+B(c*D))),c=B(I*B(B(B(u*d)+B(l*v))+B(c*s))),l=B(B(B(Z*g)+B(Y*h))+B(v*c)),C[W>>2]=l,u=B(B(B(G*g)+B(F*h))+B(d*c)),C[p>>2]=u,c=B(B(B(y*g)+B(D*h))+B(s*c)),C[S>>2]=c),1&a[0|bA]&&(I=C[iA>>2],s=C[n+44>>2],d=C[n+12>>2],v=C[n+28>>2],N=C[eA>>2],y=C[n+36>>2],G=C[n+4>>2],g=C[rA>>2],nA=C[AA>>2],D=C[n+40>>2],F=C[n+8>>2],h=C[$>>2],t[x>>2]=0,Z=g,g=B(N*B(B(B(G*u)+B(g*l))+B(y*c))),Y=h,h=B(nA*B(B(B(u*F)+B(l*h))+B(c*D))),c=B(I*B(B(B(u*d)+B(l*v))+B(c*s))),C[W>>2]=B(B(Z*g)+B(Y*h))+B(v*c),C[p>>2]=B(B(G*g)+B(F*h))+B(d*c),C[S>>2]=B(B(y*g)+B(D*h))+B(s*c)),ra(A,p,o,k,R,q,f- -64|0,f+48|0,M,e,B(0),B(0));break A;}if(X=w+180|0,!(B(m(s))>B(.7071067690849304)))break e;t[p>>2]=0,g=u,v=B(B(u*u)+B(s*s)),u=B(B(1)/B(Q(v))),l=B(g*u),C[W>>2]=l,c=B(-B(s*u)),C[V>>2]=c,s=B(v*u),v=B(d*c),d=B(-B(d*l)),u=B(0);break r;}if(c=C[f+44>>2],p=w+156|0,ra(A,w+164|0,o,k,R,q,f- -64|0,f+48|0,c,e,C[w+140>>2],C[p>>2]),!(16&b[0|x]))break A;ra(A,w+180|0,o,k,R,q,f- -64|0,f+48|0,c,e,C[w+144>>2],C[p>>2]);break A;}t[W>>2]=0,g=d,d=B(B(d*d)+B(u*u)),l=B(B(1)/B(Q(d))),c=B(g*l),C[V>>2]=c,u=B(-B(u*l)),C[p>>2]=u,v=B(d*l),d=B(s*u),s=B(-B(s*c)),l=B(0);}C[X>>2]=s,T=w+188|0,C[T>>2]=v,K=w+184|0,C[K>>2]=d,tA=i+180|0,1&a[0|tA]&&(M=C[i+172>>2],s=C[i+44>>2],d=C[i+12>>2],v=C[i+28>>2],I=C[i+164>>2],y=C[i+36>>2],G=C[i+4>>2],g=C[i+20>>2],N=C[i+168>>2],D=C[i+40>>2],F=C[i+8>>2],h=C[i+24>>2],t[S>>2]=0,Z=g,g=B(I*B(B(B(G*u)+B(g*c))+B(y*l))),Y=h,h=B(N*B(B(B(u*F)+B(c*h))+B(l*D))),l=B(M*B(B(B(u*d)+B(c*v))+B(l*s))),c=B(B(B(Z*g)+B(Y*h))+B(v*l)),C[V>>2]=c,u=B(B(B(G*g)+B(F*h))+B(d*l)),C[p>>2]=u,l=B(B(B(y*g)+B(D*h))+B(s*l)),C[W>>2]=l),bA=n+180|0,1&a[0|bA]&&(M=C[iA>>2],s=C[n+44>>2],d=C[n+12>>2],v=C[n+28>>2],I=C[eA>>2],y=C[n+36>>2],G=C[n+4>>2],g=C[rA>>2],N=C[AA>>2],D=C[n+40>>2],F=C[n+8>>2],h=C[$>>2],t[S>>2]=0,Z=g,g=B(I*B(B(B(G*u)+B(g*c))+B(y*l))),Y=h,h=B(N*B(B(B(u*F)+B(c*h))+B(l*D))),c=B(M*B(B(B(u*d)+B(c*v))+B(l*s))),C[V>>2]=B(B(Z*g)+B(Y*h))+B(v*c),C[p>>2]=B(B(G*g)+B(F*h))+B(d*c),C[W>>2]=B(B(y*g)+B(D*h))+B(s*c)),M=C[f+44>>2],ra(A,p,o,k,R,q,f- -64|0,f+48|0,M,e,B(0),B(0)),W=t[x>>2],16&W&&(1&a[0|tA]&&(I=C[i+172>>2],c=C[i+44>>2],u=C[i+12>>2],l=C[i+28>>2],D=C[i+164>>2],s=C[i+36>>2],d=C[i+4>>2],v=C[i+20>>2],N=C[i+168>>2],y=C[i+40>>2],G=C[i+8>>2],g=C[i+24>>2],t[w+192>>2]=0,Z=d,h=D,d=C[X>>2],D=C[K>>2],F=C[T>>2],h=B(h*B(B(B(Z*d)+B(v*D))+B(s*F))),Y=G,G=B(N*B(B(B(d*G)+B(D*g))+B(F*y))),N=u,u=B(I*B(B(B(d*u)+B(D*l))+B(F*c))),C[X>>2]=B(B(Z*h)+B(Y*G))+B(N*u),C[K>>2]=B(B(v*h)+B(g*G))+B(l*u),C[T>>2]=B(B(s*h)+B(y*G))+B(c*u)),1&a[0|bA]&&(I=C[iA>>2],c=C[n+44>>2],u=C[n+12>>2],l=C[n+28>>2],D=C[eA>>2],s=C[n+36>>2],d=C[n+4>>2],v=C[rA>>2],N=C[AA>>2],y=C[n+40>>2],G=C[n+8>>2],g=C[$>>2],t[w+192>>2]=0,Z=d,h=D,d=C[X>>2],D=C[K>>2],F=C[T>>2],h=B(h*B(B(B(Z*d)+B(v*D))+B(s*F))),Y=G,G=B(N*B(B(B(d*G)+B(D*g))+B(F*y))),N=u,u=B(I*B(B(B(d*u)+B(D*l))+B(F*c))),C[X>>2]=B(B(Z*h)+B(Y*G))+B(N*u),C[K>>2]=B(B(v*h)+B(g*G))+B(l*u),C[T>>2]=B(B(s*h)+B(y*G))+B(c*u)),ra(A,X,o,k,R,q,f- -64|0,f+48|0,M,e,B(0),B(0)),W=t[x>>2]),80==(80&W)&&(R=w+124|0,t[R>>2]=1|t[R>>2]);}na(A,aA,o,k,q,e),p=t[SA>>2];}if(kA=kA+1|0,!((0|kA)<(0|p)))break;}E=f+80|0;}function ba(A,r,e){var i,a=0,f=0,n=0;i=E-80|0,E=i,t[A+240>>2]&&(C[A+176>>2]=C[A+64>>2]+C[A+176>>2],C[A+192>>2]=C[A+80>>2]+C[A+192>>2],a=A+180|0,C[a>>2]=C[A+68>>2]+C[a>>2],a=A+184|0,C[a>>2]=C[A+72>>2]+C[a>>2],a=A+196|0,C[a>>2]=C[A+84>>2]+C[a>>2],a=A+200|0,C[a>>2]=C[A+88>>2]+C[a>>2],(C[A+144>>2]!=B(0)|C[A+148>>2]!=B(0)|C[A+152>>2]!=B(0)|C[A+160>>2]!=B(0)||C[A+164>>2]!=B(0)||C[A+168>>2]!=B(0))&&(t[i+12>>2]=0,C[i>>2]=C[A+160>>2]*e,C[i+8>>2]=C[A+168>>2]*e,C[i+4>>2]=C[A+164>>2]*e,xi(A,A+144|0,i,r,i+16|0),f=i+24|0,n=t[f+4>>2],a=A+8|0,t[a>>2]=t[f>>2],t[a+4>>2]=n,a=t[i+20>>2],t[A>>2]=t[i+16>>2],t[A+4>>2]=a,a=t[i+36>>2],t[A+16>>2]=t[i+32>>2],t[A+20>>2]=a,f=i+40|0,n=t[f+4>>2],a=A+24|0,t[a>>2]=t[f>>2],t[a+4>>2]=n,a=t[i+52>>2],t[A+32>>2]=t[i+48>>2],t[A+36>>2]=a,f=i+56|0,n=t[f+4>>2],a=A+40|0,t[a>>2]=t[f>>2],t[a+4>>2]=n,a=t[i+68>>2],t[A+48>>2]=t[i+64>>2],t[A+52>>2]=a,a=i+72|0,f=t[a+4>>2],A=A+56|0,t[A>>2]=t[a>>2],t[A+4>>2]=f)),E=i+80|0;}function oa(A,r,e,i,a){return t[A+20>>2]=0,t[A+16>>2]=e,t[A+12>>2]=r,t[A+8>>2]=a,t[A+4>>2]=i,t[A>>2]=19856,A;}function ka(A,r,e,i){var f,n,b,o=0,k=0,c=0,u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),N=B(0),V=B(0),I=0,J=B(0),X=0,M=0,x=B(0),S=B(0),T=B(0),U=B(0),j=B(0),O=B(0),H=B(0),z=B(0),P=B(0),L=B(0);if(f=E-240|0,E=f,t[A+16>>2])return Ve(t[A+4>>2]),o=t[A+12>>2],k=t[o+4>>2],c=A+16|0,I=t[c>>2],X=t[I+4>>2],M=o,Q=B(yf[t[t[o>>2]+48>>2]](o)),o=t[c>>2],A=function(A,r,e,i,f,n,b,o,k){return t[A+72>>2]=1,t[A+76>>2]=1,t[A+60>>2]=-1,a[A+52|0]=0,C[A+48>>2]=b,C[A+44>>2]=n,t[A+40>>2]=f,t[A+36>>2]=i,t[A+32>>2]=e,t[A+28>>2]=r,t[A+24>>2]=o,t[A+20>>2]=k,t[A+4>>2]=0,t[A+8>>2]=1065353216,t[A>>2]=14972,r=A+12|0,t[r>>2]=0,t[r+4>>2]=0,A;}(f+160|0,M,I,k,X,Q,B(yf[t[t[o>>2]+48>>2]](o)),t[A+4>>2],t[A+8>>2]),k=r+8|0,c=t[k+4>>2],o=f+32|0,t[o>>2]=t[k>>2],t[o+4>>2]=c,k=r+24|0,c=t[k+4>>2],o=f+48|0,t[o>>2]=t[k>>2],t[o+4>>2]=c,k=r+40|0,c=t[k+4>>2],o=f- -64|0,t[o>>2]=t[k>>2],t[o+4>>2]=c,k=r+56|0,c=t[k+4>>2],o=f+80|0,t[o>>2]=t[k>>2],t[o+4>>2]=c,k=e+8|0,c=t[k+4>>2],o=f+96|0,t[o>>2]=t[k>>2],t[o+4>>2]=c,t[f+152>>2]=1566444395,o=t[r+4>>2],t[f+24>>2]=t[r>>2],t[f+28>>2]=o,o=t[r+20>>2],t[f+40>>2]=t[r+16>>2],t[f+44>>2]=o,o=t[r+36>>2],t[f+56>>2]=t[r+32>>2],t[f+60>>2]=o,o=t[r+52>>2],t[f+72>>2]=t[r+48>>2],t[f+76>>2]=o,r=t[e+4>>2],t[f+88>>2]=t[e>>2],t[f+92>>2]=r,o=e+24|0,k=t[o+4>>2],r=f+112|0,t[r>>2]=t[o>>2],t[r+4>>2]=k,o=t[e+20>>2],r=f+104|0,t[r>>2]=t[e+16>>2],t[r+4>>2]=o,o=e+40|0,k=t[o+4>>2],r=f+128|0,t[r>>2]=t[o>>2],t[r+4>>2]=k,o=t[e+36>>2],r=f+120|0,t[r>>2]=t[e+32>>2],t[r+4>>2]=o,o=e+56|0,k=t[o+4>>2],r=f+144|0,t[r>>2]=t[o>>2],t[r+4>>2]=k,o=t[e+52>>2],r=f+136|0,t[r>>2]=t[e+48>>2],t[r+4>>2]=o,Ue(A,f+24|0,i,0),void(E=f+240|0);W=C[r+52>>2],F=C[r+56>>2],k=e+52|0,x=C[k>>2],c=e+56|0,S=C[c>>2],m=C[r+20>>2],R=C[r+36>>2],I=e+20|0,_=C[I>>2],X=e+36|0,s=C[X>>2],n=e+24|0,d=C[n>>2],l=C[r+24>>2],b=e+40|0,u=C[b>>2],p=C[r+40>>2],T=C[r+48>>2],L=C[e+48>>2],o=t[A+12>>2],D=C[r+32>>2],w=C[r+16>>2],Z=C[r>>2],Y=C[r+4>>2],g=C[e+32>>2],G=C[e+16>>2],v=C[e>>2],h=C[e+4>>2],A=t[A+20>>2],y=C[e+8>>2],N=C[r+8>>2],t[f+172>>2]=0,j=B(B(B(N*v)+B(l*G))+B(p*g)),V=B(-C[A+52>>2]),O=B(B(B(N*h)+B(l*_))+B(p*s)),r=A+56|0,J=C[r>>2],N=B(B(B(N*y)+B(l*d))+B(p*u)),M=A+60|0,l=C[M>>2],C[f+168>>2]=B(B(j*V)-B(O*J))-B(N*l),H=B(B(B(Y*v)+B(m*G))+B(R*g)),z=B(B(B(Y*h)+B(m*_))+B(R*s)),Y=B(B(B(Y*y)+B(m*d))+B(R*u)),C[f+164>>2]=B(B(H*V)-B(J*z))-B(l*Y),P=B(B(B(Z*v)+B(w*G))+B(D*g)),Q=B(P*V),V=B(B(B(Z*h)+B(w*_))+B(D*s)),Z=B(B(B(Z*y)+B(w*d))+B(D*u)),C[f+160>>2]=B(Q-B(J*V))-B(l*Z),yf[t[t[o>>2]+64>>2]](f+24|0,o,f+160|0),m=C[r>>2],R=C[M>>2],J=C[A+68>>2],l=C[A+52>>2],p=C[f+24>>2],D=C[f+28>>2],w=C[f+32>>2],t[f+172>>2]=0,U=B(B(B(T*v)+B(W*G))+B(F*g)),Q=v,v=B(-L),g=B(B(U+B(B(B(Q*v)-B(G*x))-B(g*S)))+B(B(B(P*p)+B(H*D))+B(j*w))),u=B(B(B(B(B(T*y)+B(W*d))+B(F*u))+B(B(B(y*v)-B(d*x))-B(u*S)))+B(B(B(Z*p)+B(Y*D))+B(N*w))),d=B(B(B(B(B(T*h)+B(W*_))+B(F*s))+B(B(B(h*v)-B(_*x))-B(s*S)))+B(B(B(V*p)+B(z*D))+B(O*w))),_=B(B(B(R*u)+B(B(l*g)+B(m*d)))-J),s=B(g-B(l*_)),g=C[e+32>>2],d=B(d-B(m*_)),G=C[X>>2],u=B(u-B(R*_)),v=C[b>>2],C[f+168>>2]=B(B(B(s*g)+B(d*G))+B(u*v))+C[c>>2],h=C[e+16>>2],y=C[I>>2],W=C[n>>2],C[f+164>>2]=B(B(B(s*h)+B(d*y))+B(u*W))+C[k>>2],F=C[e+8>>2],U=B(F*u),u=C[e>>2],Q=B(u*s),s=C[e+4>>2],C[f+160>>2]=B(U+B(Q+B(s*d)))+C[e+48>>2],t[f+20>>2]=0,C[f+16>>2]=B(B(l*g)+B(m*G))+B(R*v),C[f+12>>2]=B(B(l*h)+B(m*y))+B(R*W),C[f+8>>2]=B(B(u*l)+B(s*m))+B(F*R),yf[t[t[i>>2]+16>>2]](i,f+8|0,f+160|0,_),E=f+240|0;}function ca(A,r,e,i,f,n){A|=0,r|=0,e|=0,i|=0,f|=0,n|=0;var o,c=B(0),u=B(0),l=B(0),d=0,v=B(0),g=B(0),_=B(0),m=B(0),R=0,G=0,h=B(0),y=B(0),p=B(0),D=B(0),w=B(0),W=0,F=0,Z=0,Y=0,N=0,V=0,I=B(0),J=B(0),X=0,M=0,x=0;o=E-304|0,E=o,t[o+300>>2]=0,_=B(C[e+56>>2]-C[r+56>>2]),C[o+296>>2]=_,h=B(C[e+52>>2]-C[r+52>>2]),C[o+292>>2]=h,y=B(C[e+48>>2]-C[r+48>>2]),C[o+288>>2]=y,Ti(r,e,o+112|0,o+48|0),t[o+284>>2]=0,u=C[o+48>>2],c=B(u*C[o+120>>2]),C[o+280>>2]=c,l=B(u*C[o+116>>2]),C[o+276>>2]=l,v=B(u*C[o+112>>2]),C[o+272>>2]=v,t[o+268>>2]=0,p=B(C[f+56>>2]-C[i+56>>2]),C[o+264>>2]=p,D=B(C[f+52>>2]-C[i+52>>2]),C[o+260>>2]=D,w=B(C[f+48>>2]-C[i+48>>2]),C[o+256>>2]=w,Ti(i,f,o+112|0,o+48|0),t[o+252>>2]=0,u=C[o+48>>2],g=B(u*C[o+120>>2]),C[o+248>>2]=g,m=B(u*C[o+116>>2]),C[o+244>>2]=m,u=B(u*C[o+112>>2]),C[o+240>>2]=u,e=t[A+12>>2],I=B(yf[t[t[e>>2]+16>>2]](e)),e=t[A+16>>2],e&&(J=B(yf[t[t[e>>2]+16>>2]](e)),_=C[o+296>>2],p=C[o+264>>2],g=C[o+248>>2],h=C[o+292>>2],D=C[o+260>>2],y=C[o+288>>2],w=C[o+256>>2],m=C[o+244>>2],u=C[o+240>>2],l=C[o+276>>2],v=C[o+272>>2],c=C[o+280>>2]);A:{if(m=B(B(I*B(Q(B(B(B(v*v)+B(l*l))+B(c*c)))))+B(J*B(Q(B(B(B(u*u)+B(m*m))+B(g*g)))))),l=B(w-y),v=B(D-h),g=B(p-_),B(m+B(Q(B(B(B(l*l)+B(v*v))+B(g*g)))))==B(0)||(a[o+216|0]=0,t[o+212>>2]=1566444395,t[o+176>>2]=15428,ka(A,r,i,o+176|0),f=o+204|0,d=t[f+4>>2],e=o+232|0,t[e>>2]=t[f>>2],t[e+4>>2]=d,e=t[o+200>>2],t[o+224>>2]=t[o+196>>2],t[o+228>>2]=e,!b[o+216|0]||(e=t[o+180>>2],f=o+184|0,d=t[f>>2],R=o+188|0,G=t[R>>2],B(m+B(B(B(l*C[o+180>>2])+B(v*C[f>>2]))+B(g*C[R>>2])))<=B(1.1920928955078125e-7))))return E=o+304|0,0;r:{e:{i:{if(F=n+172|0,_=B(C[o+212>>2]+C[F>>2]),_>B(.0010000000474974513)){for(R=o+20|0,X=o+160|0,Z=n+168|0,Y=o+40|0,N=o+36|0,M=o+12|0,x=o+16|0,f=0,u=B(0);;){if(W=t[Z>>2],W&&(V=o+120|0,t[V>>2]=1065353216,t[V+4>>2]=0,t[o+112>>2]=1065353216,t[o+116>>2]=1065353216,yf[t[t[W>>2]+28>>2]](W,o+224|0,B(.20000000298023224),o+112|0)),c=B(m+B(B(B(l*(k(0,e),s()))+B(v*(k(0,d),s())))+B(g*(k(0,G),s())))),c<=B(1.1920928955078125e-7))break A;if(c=B(u+B(_/c)),c<=u|c<B(0))break A;if(c>B(1))break r;if(xi(r,o+288|0,o+272|0,c,o+112|0),xi(i,o+256|0,o+240|0,c,o+48|0),e=t[Z>>2],e&&(d=o+8|0,t[d>>2]=0,t[d+4>>2]=0,t[o>>2]=1065353216,t[o+4>>2]=0,yf[t[t[e>>2]+28>>2]](e,X,B(.20000000298023224),o)),yf[t[t[n>>2]>>2]](n,c),a[0|Y]=0,t[N>>2]=1566444395,t[o>>2]=15428,ka(A,o+112|0,o+48|0,o),!b[0|Y])break i;if(d=R+8|0,G=t[d+4>>2],e=o+232|0,t[e>>2]=t[d>>2],t[e+4>>2]=G,e=t[R+4>>2],t[o+224>>2]=t[R>>2],t[o+228>>2]=e,f>>>0>63)break e;if(f=f+1|0,d=t[o+8>>2],G=t[M>>2],e=t[o+4>>2],u=c,_=B(C[N>>2]+C[F>>2]),!(_>B(.0010000000474974513)))break;}l=C[x>>2];}else c=B(0),l=C[o+192>>2];return t[n+132>>2]=e,C[n+164>>2]=c,A=t[o+228>>2],t[n+148>>2]=t[o+224>>2],t[n+152>>2]=A,C[n+144>>2]=l,t[n+140>>2]=G,t[n+136>>2]=d,r=o+232|0,e=t[r+4>>2],A=n+156|0,t[A>>2]=t[r>>2],t[A+4>>2]=e,E=o+304|0,1;}yf[t[t[n>>2]+8>>2]](n,-1,f);break A;}yf[t[t[n>>2]+8>>2]](n,-2,f+1|0);break A;}}return E=o+304|0,0;}function ua(A,r,e,i){var a=0,f=0,n=0;t[A>>2]=19920,a=r+8|0,n=t[a+4>>2],f=A+12|0,t[f>>2]=t[a>>2],t[f+4>>2]=n,a=t[r+4>>2],t[A+4>>2]=t[r>>2],t[A+8>>2]=a,r=e+8|0,a=t[r>>2],r=t[r+4>>2],n=t[e>>2],e=t[e+4>>2],t[A+40>>2]=1065353216,f=A+28|0,t[f>>2]=a,t[f+4>>2]=r,t[A+20>>2]=n,t[A+24>>2]=e,t[A+36>>2]=i;}function la(A,r,e,i,a,f){var n=0,b=0;t[A+4>>2]=r,t[A>>2]=19944,r=e+8|0,n=t[r+4>>2],b=A+16|0,t[b>>2]=t[r>>2],t[b+4>>2]=n,r=t[e+4>>2],t[A+8>>2]=t[e>>2],t[A+12>>2]=r,r=e+24|0,n=t[r+4>>2],b=A+32|0,t[b>>2]=t[r>>2],t[b+4>>2]=n,r=t[e+20>>2],n=A+24|0,t[n>>2]=t[e+16>>2],t[n+4>>2]=r,r=e+40|0,n=t[r+4>>2],b=A+48|0,t[b>>2]=t[r>>2],t[b+4>>2]=n,r=t[e+36>>2],n=A+40|0,t[n>>2]=t[e+32>>2],t[n+4>>2]=r,r=e+56|0,n=t[r+4>>2],b=A- -64|0,t[b>>2]=t[r>>2],t[b+4>>2]=n,r=t[e+52>>2],n=A+56|0,t[n>>2]=t[e+48>>2],t[n+4>>2]=r,r=i+8|0,e=t[r+4>>2],n=A+80|0,t[n>>2]=t[r>>2],t[n+4>>2]=e,r=t[i+4>>2],t[A+72>>2]=t[i>>2],t[A+76>>2]=r,r=i+24|0,e=t[r+4>>2],n=A+96|0,t[n>>2]=t[r>>2],t[n+4>>2]=e,r=t[i+20>>2],e=A+88|0,t[e>>2]=t[i+16>>2],t[e+4>>2]=r,r=i+40|0,e=t[r+4>>2],n=A+112|0,t[n>>2]=t[r>>2],t[n+4>>2]=e,r=t[i+36>>2],e=A+104|0,t[e>>2]=t[i+32>>2],t[e+4>>2]=r,r=i+56|0,e=t[r+4>>2],n=A+128|0,t[n>>2]=t[r>>2],t[n+4>>2]=e,r=t[i+52>>2],e=A+120|0,t[e>>2]=t[i+48>>2],t[e+4>>2]=r,r=a+8|0,e=t[r+4>>2],i=A+144|0,t[i>>2]=t[r>>2],t[i+4>>2]=e,r=t[a+4>>2],t[A+136>>2]=t[a>>2],t[A+140>>2]=r,r=a+24|0,e=t[r+4>>2],i=A+160|0,t[i>>2]=t[r>>2],t[i+4>>2]=e,r=t[a+20>>2],e=A+152|0,t[e>>2]=t[a+16>>2],t[e+4>>2]=r,r=a+40|0,e=t[r+4>>2],i=A+176|0,t[i>>2]=t[r>>2],t[i+4>>2]=e,r=t[a+36>>2],e=A+168|0,t[e>>2]=t[a+32>>2],t[e+4>>2]=r,r=a+56|0,e=t[r+4>>2],i=A+192|0,t[i>>2]=t[r>>2],t[i+4>>2]=e,r=t[a+52>>2],e=A+184|0,t[e>>2]=t[a+48>>2],t[e+4>>2]=r,t[A+208>>2]=0,C[A+204>>2]=f,t[A+200>>2]=1065353216;}function sa(A){A|=0;var r,e,i=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0;if(t[A>>2]=20052,r=A+16|0,i=t[r>>2],e=A+8|0,f=t[e>>2],(0|f)>=1)for(o=A+68|0,k=A+24|0;u=t[i+c>>2],n=t[u+188>>2],n&&(i=t[o>>2],i=0|yf[t[t[i>>2]+36>>2]](i),yf[t[t[i>>2]+40>>2]](i,n,t[k>>2]),i=t[o>>2],yf[t[t[i>>2]+12>>2]](i,n,t[k>>2]),t[u+188>>2]=0,f=t[e>>2],i=t[r>>2]),c=c+4|0,l=l+1|0,(0|l)<(0|f);){}return i&&(b[A+20|0]&&gA(i),t[A+16>>2]=0),t[A+16>>2]=0,a[A+20|0]=1,i=A+8|0,t[i>>2]=0,t[i+4>>2]=0,0|A;}function da(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var f,n,o,k,c=0,u=0,l=0,s=0,d=0,v=0;if(f=E-96|0,E=f,n=A+8|0,c=t[n>>2],t[r+216>>2]=c,t[A+12>>2]==(0|c)&&(s=c?c<<1:1,!((0|c)>=(0|s)))){A:{r:{if(s){if(d=CA(s<<2,16),c=t[A+8>>2],(0|c)>=1)break r;break A;}if((0|c)<1)break A;}for(v=A+16|0,u=c;t[l+d>>2]=t[t[v>>2]+l>>2],l=l+4|0,u=u+-1|0,u;){}}u=A+16|0,l=t[u>>2],l&&(b[A+20|0]&&(gA(l),c=t[A+8>>2]),t[A+16>>2]=0),t[u>>2]=d,a[A+20|0]=1,t[A+12>>2]=s;}t[n>>2]=c+1,t[t[A+16>>2]+(c<<2)>>2]=r,u=r+12|0,l=t[u+4>>2],c=f+40|0,t[c>>2]=t[u>>2],t[c+4>>2]=l,u=r+28|0,l=t[u+4>>2],c=f+56|0,t[c>>2]=t[u>>2],t[c+4>>2]=l,u=r+44|0,l=t[u+4>>2],c=f+72|0,t[c>>2]=t[u>>2],t[c+4>>2]=l,u=r+60|0,l=t[u+4>>2],c=f+88|0,t[c>>2]=t[u>>2],t[c+4>>2]=l,c=t[r+8>>2],t[f+32>>2]=t[r+4>>2],t[f+36>>2]=c,c=r+20|0,u=t[c+4>>2],t[f+48>>2]=t[c>>2],t[f+52>>2]=u,c=r+36|0,u=t[c+4>>2],t[f+64>>2]=t[c>>2],t[f+68>>2]=u,c=r+52|0,u=t[c+4>>2],t[f+80>>2]=t[c>>2],t[f+84>>2]=u,c=t[r+192>>2],yf[t[t[c>>2]+8>>2]](c,f+32|0,f+16|0,f),c=t[A+68>>2],o=r,k=0|yf[t[t[c>>2]+8>>2]](c,f+16|0,f,t[t[r+192>>2]+4>>2],r,e,i,t[A+24>>2]),t[o+188>>2]=k,E=f+96|0;}function va(A,r){var e,i=B(0),f=B(0),n=0,o=B(0),k=B(0),c=B(0),u=B(0),l=B(0);if(e=E+-64|0,E=e,n=t[r+192>>2],yf[t[t[n>>2]+8>>2]](n,r+4|0,e+48|0,e+32|0),i=C[794],o=B(C[e+48>>2]-i),C[e+48>>2]=o,c=B(C[e+52>>2]-i),C[e+52>>2]=c,u=B(C[e+56>>2]-i),C[e+56>>2]=u,f=B(i+C[e+32>>2]),C[e+32>>2]=f,k=B(i+C[e+36>>2]),C[e+36>>2]=k,l=B(i+C[e+40>>2]),C[e+40>>2]=l,3&b[r+204|0]|!b[A+44|0]|2!=t[r+252>>2]||(n=t[r+192>>2],yf[t[t[n>>2]+8>>2]](n,r+68|0,e+16|0,e),c=B(C[e+16>>2]-i),C[e+16>>2]=c,u=B(C[e+20>>2]-i),C[e+20>>2]=u,f=B(C[e+24>>2]-i),C[e+24>>2]=f,k=B(i+C[e>>2]),C[e>>2]=k,l=B(i+C[e+4>>2]),C[e+4>>2]=l,i=B(i+C[e+8>>2]),C[e+8>>2]=i,o=C[e+48>>2],c<o&&(C[e+48>>2]=c,o=c),c=C[e+52>>2],u<c&&(C[e+52>>2]=u,c=u),n=e+56|0,u=C[n>>2],f<u&&(C[n>>2]=f,u=f),f=C[e+28>>2],f<C[e+60>>2]&&(C[e+60>>2]=f),f=C[e+32>>2],f<k&&(C[e+32>>2]=k,f=k),k=C[e+36>>2],k<l&&(C[e+36>>2]=l,k=l),n=e+40|0,l=C[n>>2],l<i&&(C[n>>2]=i,l=i),i=C[e+12>>2],C[e+44>>2]<i&&(C[e+44>>2]=i)),n=t[A+68>>2],1&a[r+204|0]||(o=B(f-o),f=B(o*o),o=B(k-c),k=B(f+B(o*o)),o=B(l-u),B(k+B(o*o))<B(999999995904)))yf[t[t[n>>2]+16>>2]](n,t[r+188>>2],e+48|0,e+32|0,t[A+24>>2]);else if(Vr(r,5),!b[2820]&&(r=t[A+72>>2],r))return a[2820]=1,yf[t[t[r>>2]+44>>2]](r,20104),A=A+72|0,r=t[A>>2],yf[t[t[r>>2]+44>>2]](r,20153),r=t[A>>2],yf[t[t[r>>2]+44>>2]](r,20221),A=t[A>>2],yf[t[t[A>>2]+44>>2]](A,20286),void(E=e- -64|0);E=e- -64|0;}function Ca(A,r){A|=0,r|=0;var e=0,i=0,a=0,f=0,n=0,b=0,o=0,k=0;i=t[r+188>>2],i&&(e=t[A+68>>2],e=0|yf[t[t[e>>2]+36>>2]](e),yf[t[t[e>>2]+40>>2]](e,i,t[A+24>>2]),e=t[A+68>>2],yf[t[t[e>>2]+12>>2]](e,i,t[A+24>>2]),t[r+188>>2]=0),e=t[r+216>>2],i=t[A+8>>2];A:if((0|e)<0|(0|e)>=(0|i)){if(!((0|i)<1)){for(a=t[A+16>>2],e=a;;){if((0|r)!=t[e>>2]){if(e=e+4|0,f=f+1|0,(0|f)<(0|i))continue;break A;}break;}(0|i)<=(0|f)||(n=e,i=i+-1|0,e=i<<2,t[n>>2]=t[e+a>>2],t[A+8>>2]=i,t[e+t[A+16>>2]>>2]=r);}}else {if(f=A+16|0,a=t[f>>2],b=e<<2,o=a+b|0,k=t[o>>2],n=a,i=i+-1|0,a=i<<2,t[o>>2]=t[n+a>>2],t[A+8>>2]=i,t[a+t[f>>2]>>2]=k,(0|e)>=(0|i))break A;t[t[t[f>>2]+b>>2]+216>>2]=e;}t[r+216>>2]=-1;}function ga(A,r,e,i){var f,n=0,b=B(0),o=B(0),k=B(0),c=0,u=B(0),l=0,s=B(0),d=B(0),v=B(0),g=0,_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),p=B(0),D=B(0),w=B(0),W=0,F=B(0),Z=B(0),Y=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=B(0),M=B(0),S=B(0),T=B(0),U=0,j=0,O=0,H=0;f=E-704|0,E=f,ZA(f+624|0),t[f+676>>2]=0,n=f+668|0,t[n>>2]=0,t[n+4>>2]=0,n=f+660|0,t[n>>2]=0,t[n+4>>2]=0,n=f+652|0,t[n>>2]=0,t[n+4>>2]=0,t[f+648>>2]=1065353216,t[f+640>>2]=1065353216,t[f+644>>2]=1065353216,t[f+628>>2]=8,t[f+624>>2]=9912,n=t[e+12>>2];A:if(l=t[e+4>>2],g=t[l+4>>2],(0|g)<=19)t[f+616>>2]=0,t[f+620>>2]=0,t[f+448>>2]=16056,t[f+612>>2]=t[i+4>>2],a[f+420|0]=0,t[f+396>>2]=953267991,g=ri(f+680|0,f+624|0,l,f+88|0),j=Pe(f+72|0,f+624|0,l,f+88|0),O=g,H=8&t[i+20>>2],l=H?j:O,yf[t[t[l>>2]+8>>2]](l,A,r,n,n,f+448|0)&&(b=C[f+580>>2],k=C[f+584>>2],o=C[f+588>>2],u=B(B(B(b*b)+B(k*k))+B(o*o)),u>B(9999999747378752e-20)&&(s=C[f+612>>2],s<C[i+4>>2]&&(v=o,o=B(B(1)/B(Q(u))),C[f+588>>2]=v*o,C[f+584>>2]=k*o,C[f+580>>2]=b*o,A=f+580|0,r=A+8|0,n=t[r+4>>2],l=f+56|0,t[l>>2]=t[r>>2],t[l+4>>2]=n,C[f+64>>2]=s,r=t[A+4>>2],t[f+48>>2]=t[A>>2],t[f+52>>2]=r,t[f+44>>2]=0,t[f+40>>2]=t[e+8>>2],B(yf[t[t[i>>2]+12>>2]](i,f+40|0,1)))));else {r:{e:{if(g+-21>>>0<=8){if(c=n+20|0,_=C[c>>2],m=C[n+36>>2],s=C[n+24>>2],k=C[n+52>>2],v=C[n+40>>2],g=n+56|0,p=C[g>>2],R=C[n+32>>2],G=C[n>>2],h=C[n+16>>2],y=C[n+4>>2],u=C[n+48>>2],D=C[n+8>>2],t[f+460>>2]=0,Z=B(-k),F=B(s*Z),Y=B(-p),V=B(v*Y),d=B(B(F-B(D*u))+V),b=C[A+48>>2],o=C[A+52>>2],I=B(s*o),w=C[A+56>>2],J=B(v*w),C[f+456>>2]=d+B(B(B(D*b)+I)+J),u=B(-u),X=B(m*Y),N=B(B(B(y*u)-B(_*k))+X),S=B(m*w),C[f+452>>2]=N+B(B(B(y*b)+B(_*o))+S),p=B(B(B(G*u)-B(h*k))-B(R*p)),C[f+448>>2]=p+B(B(B(G*b)+B(h*o))+B(R*w)),t[f+52>>2]=0,M=d,k=C[r+48>>2],T=B(D*k),d=s,s=C[r+52>>2],D=B(d*s),d=v,v=C[r+56>>2],d=B(d*v),C[f+48>>2]=M+B(B(T+D)+d),M=N,N=B(m*v),C[f+44>>2]=M+B(B(B(y*k)+B(_*s))+N),C[f+40>>2]=p+B(B(B(G*k)+B(h*s))+B(R*v)),A=n+32|0,r=n+16|0,21!=t[l+4>>2])break e;e=t[e+8>>2],ua(f+88|0,f+448|0,f+40|0,t[i+20>>2]),t[f+140>>2]=l,t[f+136>>2]=e,t[f+132>>2]=i,t[f+88>>2]=20464,e=n+8|0,c=t[e+4>>2],W=f+152|0,t[W>>2]=t[e>>2],t[W+4>>2]=c,e=t[n+4>>2],t[f+144>>2]=t[n>>2],t[f+148>>2]=e,e=r+8|0,c=t[e+4>>2],W=f+168|0,t[W>>2]=t[e>>2],t[W+4>>2]=c,e=t[r+4>>2],c=f+160|0,t[c>>2]=t[r>>2],t[c+4>>2]=e,r=A+8|0,e=t[r+4>>2],c=f+184|0,t[c>>2]=t[r>>2],t[c+4>>2]=e,r=t[A+4>>2],e=f+176|0,t[e>>2]=t[A>>2],t[e+4>>2]=r,A=t[g+4>>2],r=f+200|0,t[r>>2]=t[g>>2],t[r+4>>2]=A,A=t[n+52>>2],r=f+192|0,t[r>>2]=t[n+48>>2],t[r+4>>2]=A,t[f+128>>2]=t[i+4>>2],Or(l,f+88|0,f+448|0,f+40|0);break A;}if(31!=(0|g))break A;if(g=t[l+68>>2],t[f+64>>2]=i,t[f+60>>2]=r,t[f+56>>2]=A,t[f+52>>2]=n,t[f+48>>2]=l,t[f+40>>2]=20836,t[f+44>>2]=t[e+8>>2],!g)break r;u=C[n>>2],s=C[n+4>>2],b=C[n+8>>2],t[f+100>>2]=0,d=b,_=C[n+48>>2],b=B(C[A+48>>2]-_),m=C[n+52>>2],k=B(C[A+52>>2]-m),v=C[n+24>>2],R=C[n+56>>2],o=B(C[A+56>>2]-R),G=C[n+40>>2],C[f+96>>2]=B(B(d*b)+B(k*v))+B(o*G),d=B(b*s),s=C[n+20>>2],h=C[n+36>>2],C[f+92>>2]=B(d+B(k*s))+B(o*h),b=B(b*u),u=C[n+16>>2],y=C[n+32>>2],C[f+88>>2]=B(b+B(k*u))+B(o*y),D=C[n>>2],w=C[n+4>>2],b=C[n+8>>2],t[f+460>>2]=0,d=b,b=B(C[r+48>>2]-_),k=B(C[r+52>>2]-m),o=B(C[r+56>>2]-R),C[f+456>>2]=B(B(d*b)+B(v*k))+B(G*o),C[f+452>>2]=B(B(b*w)+B(k*s))+B(o*h),C[f+448>>2]=B(B(b*D)+B(k*u))+B(o*y),function(A,r,e,i){var a=0,f=B(0),n=B(0),b=B(0),o=B(0),k=0,c=B(0),u=B(0),l=0,s=0,d=0,v=0,g=0,_=B(0),m=B(0),R=0,G=0,h=0,y=B(0),p=0,D=0,w=B(0),W=0,F=0,Z=0,Y=0,N=0,V=0;if(a=E-544|0,E=a,A){for(f=C[r+8>>2],o=C[e+8>>2],c=C[r>>2],n=C[e>>2],u=C[r+4>>2],b=C[e+4>>2],t[a+32>>2]=A,n=B(n-c),b=B(b-u),f=B(o-f),o=B(B(1)/B(Q(B(B(B(n*n)+B(b*b))+B(f*f))))),_=f,f=B(f*o),m=n,n=B(n*o),y=b,b=B(b*o),y=B(B(_*f)+B(B(m*n)+B(y*b))),f=f==B(0)?B(0xde0b6b000000000):B(B(1)/f),A=f<B(0),W=(A<<4)+a|8,b=b==B(0)?B(0xde0b6b000000000):B(B(1)/b),e=b<B(0),F=(e<<4)+a|4,Z=((1^A)<<4)+a|8,Y=((1^e)<<4)+a|4,n=n==B(0)?B(0xde0b6b000000000):B(B(1)/n),A=n<B(0),N=(A<<4)+a|0,V=((1^A)<<4)+a|0,p=a+16|0,g=126,l=128,d=a+32|0,s=128,G=1;;){i:{A=G+-1|0,D=A<<2,v=t[D+d>>2],e=t[v+20>>2],t[p>>2]=t[v+16>>2],t[p+4>>2]=e,k=v+24|0,h=t[k+4>>2],e=p+8|0,t[e>>2]=t[k>>2],t[e+4>>2]=h,e=t[v+4>>2],t[a>>2]=t[v>>2],t[a+4>>2]=e,e=v+8|0,k=t[e+4>>2],t[a+8>>2]=t[e>>2],t[a+12>>2]=k;a:{f:{n:{t:{b:{o:{k:{c:{u:{l:{s:{d:{if(o=B(b*B(C[F>>2]-u)),_=B(n*B(C[V>>2]-c)),!(o>_||(c=B(n*B(C[N>>2]-c)),u=B(b*B(C[Y>>2]-u)),c>u||(w=C[r+8>>2],m=B(f*B(C[W>>2]-w)),u=u<_?u:_,m>u||(c=o>c?o:c,o=B(f*B(C[Z>>2]-w)),c>o|(m>c?m:c)<y^1|(o<u?o:u)>B(0)^1))))){if(h=v+40|0,t[h>>2]){if((0|A)<=(0|g))break d;if(k=s<<1,(0|s)>=(0|k))break s;if((0|l)>=(0|k))break l;if(!s)break u;if(e=CA(s<<3,16),A=e,(0|s)<1)break c;for(A=e,g=d,l=s;t[A>>2]=t[g>>2],A=A+4|0,g=g+4|0,l=l+-1|0,l;){}if(R)break k;break o;}yf[t[t[i>>2]+12>>2]](i,v);}if(e=d,k=s,A)break a;break i;}e=d,k=s;break f;}e=d;break n;}e=d;break t;}A=0;}if(e=A,A=R,R=1,l=R,!A)break b;if(l=k,!d)break t;}gA(d);}l=1;}R=l,l=k;}A=s<<2,x(A+e|0,0,A);}g=k+-2|0;}if(t[e+D>>2]=t[v+36>>2],t[(G<<2)+e>>2]=t[h>>2],A=G+1|0,!A)break i;}u=C[r+4>>2],c=C[r>>2],d=e,s=k,G=A;continue;}break;}!R|!e||gA(e);}E=a+544|0;}(t[g>>2],f+88|0,f+448|0,f+40|0);break A;}_=C[A>>2],m=C[r>>2],R=C[n+4>>2],G=C[c>>2],c=n+8|0,h=C[c>>2],y=C[n>>2],t[f+692>>2]=0,p=B(B(B(h*u)+F)+V),C[f+688>>2]=B(B(B(b*h)+I)+J)+p,F=B(B(B(R*u)+B(G*Z))+X),C[f+684>>2]=B(B(B(b*R)+B(o*G))+S)+F,o=B(B(B(b*y)+B(o*m))+B(w*_)),b=B(B(B(y*u)+B(m*Z))+B(_*Y)),C[f+680>>2]=o+b,t[f+84>>2]=0,C[f+80>>2]=B(B(B(k*h)+D)+d)+p,C[f+76>>2]=B(B(B(k*R)+B(s*G))+N)+F,C[f+72>>2]=B(B(B(k*y)+B(s*m))+B(v*_))+b,e=t[e+8>>2],ua(f+88|0,f+680|0,f+72|0,t[i+20>>2]),t[f+140>>2]=l,t[f+136>>2]=e,t[f+132>>2]=i,t[f+88>>2]=20648,e=t[c+4>>2],W=f+152|0,t[W>>2]=t[c>>2],t[W+4>>2]=e,e=t[n+4>>2],t[f+144>>2]=t[n>>2],t[f+148>>2]=e,e=t[r+4>>2],c=f+160|0,t[c>>2]=t[r>>2],t[c+4>>2]=e,r=r+8|0,e=t[r+4>>2],c=f+168|0,t[c>>2]=t[r>>2],t[c+4>>2]=e,r=A+8|0,e=t[r+4>>2],c=f+184|0,t[c>>2]=t[r>>2],t[c+4>>2]=e,r=t[A+4>>2],e=f+176|0,t[e>>2]=t[A>>2],t[e+4>>2]=r,A=t[g+4>>2],r=f+200|0,t[r>>2]=t[g>>2],t[r+4>>2]=A,A=t[n+52>>2],r=f+192|0,t[r>>2]=t[n+48>>2],t[r+4>>2]=A,t[f+128>>2]=t[i+4>>2],A=t[f+692>>2],r=f+32|0,t[r>>2]=t[f+688>>2],t[r+4>>2]=A,A=t[f+684>>2],t[f+24>>2]=t[f+680>>2],t[f+28>>2]=A,b=C[f+72>>2],b<C[f+24>>2]&&(C[f+24>>2]=b),k=C[f+76>>2],k<C[f+28>>2]&&(C[f+28>>2]=k),o=C[f+80>>2],o<C[f+32>>2]&&(C[f+32>>2]=o),u=C[f+84>>2],u<C[f+36>>2]&&(C[f+36>>2]=u),A=f+688|0,r=t[A+4>>2],e=f+16|0,t[e>>2]=t[A>>2],t[e+4>>2]=r,A=t[f+684>>2],t[f+8>>2]=t[f+680>>2],t[f+12>>2]=A,C[f+8>>2]<b&&(C[f+8>>2]=b),C[f+12>>2]<k&&(C[f+12>>2]=k),C[f+16>>2]<o&&(C[f+16>>2]=o),C[f+20>>2]<u&&(C[f+20>>2]=u),yf[t[t[l>>2]+64>>2]](l,f+88|0,f+24|0,f+8|0);break A;}if(A=t[l+20>>2],!((0|A)<1))for(r=A+-1|0,i=64,g=f+148|0,c=f+132|0,W=f+120|0,U=f+136|0,e=0;;){if(A=t[l+28>>2]+i|0,l=t[A>>2],J=C[n+52>>2],X=C[n+56>>2],G=C[A+-16>>2],h=C[A+-12>>2],y=C[A+-8>>2],b=C[n+20>>2],k=C[n+24>>2],D=C[A+-64>>2],w=C[A+-48>>2],p=C[A+-32>>2],Z=C[A+-60>>2],Y=C[A+-44>>2],F=C[A+-28>>2],V=C[A+-56>>2],o=C[n+36>>2],d=C[A+-40>>2],u=C[n+40>>2],I=C[A+-24>>2],N=C[n+48>>2],s=C[n+8>>2],_=C[n>>2],m=C[n+4>>2],v=C[n+16>>2],R=C[n+32>>2],t[g>>2]=0,t[c>>2]=0,t[f+116>>2]=0,t[f+100>>2]=0,C[f+128>>2]=B(B(V*R)+B(d*o))+B(I*u),C[f+124>>2]=B(B(Z*R)+B(Y*o))+B(F*u),C[W>>2]=B(B(D*R)+B(w*o))+B(p*u),C[f+112>>2]=B(B(V*v)+B(d*b))+B(I*k),C[f+108>>2]=B(B(Z*v)+B(Y*b))+B(F*k),C[f+104>>2]=B(B(D*v)+B(w*b))+B(p*k),C[f+96>>2]=B(B(_*V)+B(m*d))+B(s*I),C[f+144>>2]=X+B(B(B(R*G)+B(o*h))+B(u*y)),C[f+140>>2]=J+B(B(B(v*G)+B(b*h))+B(k*y)),C[U>>2]=N+B(B(B(_*G)+B(m*h))+B(s*y)),C[f+92>>2]=B(B(_*Z)+B(m*Y))+B(s*F),C[f+88>>2]=B(B(D*_)+B(w*m))+B(p*s),t[f+700>>2]=e,t[f+696>>2]=-1,t[f+688>>2]=t[f+44>>2],t[f+692>>2]=f+88,t[f+684>>2]=l,t[f+680>>2]=0,A=f+464|0,t[A>>2]=-1,t[A+4>>2]=0,A=f+456|0,t[A>>2]=0,t[A+4>>2]=1,t[f+476>>2]=e,A=t[f- -64>>2],t[f+472>>2]=A,t[f+468>>2]=t[A+20>>2],t[f+452>>2]=1065353216,t[f+448>>2]=21012,t[f+452>>2]=t[A+4>>2],ga(t[f+56>>2],t[f+60>>2],f+680|0,f+448|0),(0|r)==(0|e))break A;e=e+1|0,i=i+80|0,n=t[f+52>>2],l=t[f+48>>2];}}E=f+704|0;}function _a(A,r,e,i,a,f,n,b){var o;o=E-32|0,E=o,t[o+24>>2]=-1,t[o+28>>2]=-1,t[o+20>>2]=f,t[o+16>>2]=i,t[o+12>>2]=a,t[o+8>>2]=0,Ba(A,r,e,o+8|0,n,b),E=o+32|0;}function Ba(A,r,e,i,f,n){var b,o=B(0),k=0,c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=0,m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=0,M=B(0),x=B(0),S=B(0),T=0,U=0,j=0,O=0,H=0,z=0,P=0,L=0,K=0,q=0,$=0,AA=0,rA=0,eA=0;b=E-688|0,E=b,k=t[i+12>>2];A:{r:{if(X=t[i+4>>2],_=t[X+4>>2],!((0|_)<=19)){e:{i:{a:{f:{n:{t:{b:{o:{k:{if(_+-21>>>0<=8){if(28==(0|_))break k;if(21!=(0|_))break o;G=C[k+20>>2],m=C[k+36>>2],g=C[k+52>>2],R=C[k+24>>2],d=C[k+56>>2],h=C[k+40>>2],y=C[k+32>>2],p=C[k>>2],D=C[k+16>>2],w=C[k+4>>2],W=C[k+8>>2],o=C[k+48>>2],t[b+92>>2]=0,o=B(-o),l=B(B(B(W*o)-B(R*g))-B(h*d)),v=C[r+48>>2],s=C[r+52>>2],c=C[r+56>>2],C[b+88>>2]=l+B(B(B(W*v)+B(R*s))+B(h*c)),u=B(B(B(w*o)-B(G*g))-B(m*d)),C[b+84>>2]=u+B(B(B(w*v)+B(G*s))+B(m*c)),o=B(B(B(p*o)-B(D*g))-B(y*d)),C[b+80>>2]=o+B(B(B(p*v)+B(D*s))+B(y*c)),t[b+676>>2]=0,v=l,s=C[e+48>>2],c=C[e+52>>2],l=C[e+56>>2],C[b+672>>2]=v+B(B(B(W*s)+B(R*c))+B(h*l)),C[b+668>>2]=u+B(B(B(w*s)+B(G*c))+B(m*l)),C[b+664>>2]=o+B(B(B(p*s)+B(D*c))+B(y*l)),t[b+516>>2]=0,F=C[e+8>>2],g=C[e+24>>2],d=C[e+40>>2],C[b+528>>2]=B(B(W*F)+B(R*g))+B(h*d),v=C[e+4>>2],s=C[e+20>>2],c=C[e+36>>2],C[b+524>>2]=B(B(W*v)+B(R*s))+B(h*c),C[b+512>>2]=B(B(w*F)+B(G*g))+B(m*d),C[b+508>>2]=B(B(w*v)+B(G*s))+B(m*c),t[b+500>>2]=0,l=C[e>>2],u=C[e+16>>2],o=C[e+32>>2],C[b+520>>2]=B(B(W*l)+B(R*u))+B(h*o),C[b+504>>2]=B(B(w*l)+B(G*u))+B(m*o),C[b+496>>2]=B(B(p*F)+B(D*g))+B(y*d),C[b+492>>2]=B(B(p*v)+B(D*s))+B(y*c),C[b+488>>2]=B(B(p*l)+B(D*u))+B(y*o),t[b+548>>2]=0,_=b+540|0,t[_>>2]=0,t[_+4>>2]=0,_=b+532|0,t[_>>2]=0,t[_+4>>2]=0,i=t[i+8>>2],la(b+128|0,A,r,e,k,B(yf[t[t[X>>2]+48>>2]](X))),t[b+348>>2]=X,t[b+344>>2]=i,t[b+128>>2]=21184,C[b+336>>2]=n,t[b+340>>2]=f,t[b+328>>2]=t[f+4>>2],yf[t[t[A>>2]+8>>2]](A,b+488|0,b- -64|0,b+48|0),Hr(X,b+128|0,b+80|0,b+664|0,b- -64|0,b+48|0);break A;}if(31!=(0|_))break r;if($e(b+40|0,20393),O=k+52|0,h=C[O>>2],H=k+56|0,y=C[H>>2],p=C[r+52>>2],D=C[r+56>>2],z=k+20|0,Z=C[z>>2],P=k+36|0,Y=C[P>>2],w=C[r+20>>2],W=C[r+36>>2],F=C[r+24>>2],L=k+24|0,N=C[L>>2],g=C[r+40>>2],K=k+40|0,V=C[K>>2],I=C[k+32>>2],J=C[k>>2],G=C[k+16>>2],d=C[r+32>>2],v=C[r>>2],s=C[r+16>>2],o=C[k+48>>2],c=C[r+48>>2],m=C[k+4>>2],l=C[r+4>>2],u=C[r+8>>2],R=C[k+8>>2],q=b+188|0,t[q>>2]=0,$=b+172|0,t[$>>2]=0,AA=b+156|0,t[AA>>2]=0,rA=b+168|0,C[rA>>2]=B(B(R*u)+B(N*F))+B(V*g),eA=b+164|0,C[eA>>2]=B(B(R*l)+B(N*w))+B(V*W),T=b+152|0,C[T>>2]=B(B(m*u)+B(Z*F))+B(Y*g),U=b+148|0,C[U>>2]=B(B(m*l)+B(Z*w))+B(Y*W),j=b+184|0,o=B(-o),C[j>>2]=B(B(B(R*o)-B(N*h))-B(V*y))+B(B(B(R*c)+B(N*p))+B(V*D)),_=b+180|0,C[_>>2]=B(B(B(m*o)-B(Z*h))-B(Y*y))+B(B(B(m*c)+B(Z*p))+B(Y*D)),t[b+140>>2]=0,C[b+160>>2]=B(B(R*v)+B(N*s))+B(V*d),C[b+144>>2]=B(B(m*v)+B(Z*s))+B(Y*d),C[b+136>>2]=B(B(J*u)+B(G*F))+B(I*g),C[b+176>>2]=B(B(B(J*o)-B(G*h))-B(I*y))+B(B(B(J*c)+B(G*p))+B(I*D)),C[b+132>>2]=B(B(J*l)+B(G*w))+B(I*W),C[b+128>>2]=B(B(J*v)+B(G*s))+B(I*d),yf[t[t[A>>2]+8>>2]](A,b+128|0,b- -64|0,b+48|0),h=C[O>>2],y=C[H>>2],p=C[e+52>>2],D=C[e+56>>2],Z=C[z>>2],Y=C[P>>2],w=C[e+20>>2],W=C[e+36>>2],F=C[e+24>>2],N=C[L>>2],g=C[e+40>>2],V=C[K>>2],I=C[k+32>>2],J=C[k>>2],G=C[k+16>>2],d=C[e+32>>2],v=C[e>>2],s=C[e+16>>2],o=C[k+48>>2],c=C[e+48>>2],m=C[k+4>>2],l=C[e+4>>2],u=C[e+8>>2],R=C[k+8>>2],t[q>>2]=0,t[$>>2]=0,t[AA>>2]=0,C[rA>>2]=B(B(R*u)+B(N*F))+B(V*g),C[eA>>2]=B(B(R*l)+B(N*w))+B(V*W),C[T>>2]=B(B(m*u)+B(Z*F))+B(Y*g),C[U>>2]=B(B(m*l)+B(Z*w))+B(Y*W),o=B(-o),C[j>>2]=B(B(B(R*o)-B(N*h))-B(V*y))+B(B(B(R*c)+B(N*p))+B(V*D)),C[_>>2]=B(B(B(m*o)-B(Z*h))-B(Y*y))+B(B(B(m*c)+B(Z*p))+B(Y*D)),t[b+140>>2]=0,C[b+160>>2]=B(B(R*v)+B(N*s))+B(V*d),C[b+144>>2]=B(B(m*v)+B(Z*s))+B(Y*d),C[b+136>>2]=B(B(J*u)+B(G*F))+B(I*g),C[b+176>>2]=B(B(B(J*o)-B(G*h))-B(I*y))+B(B(B(J*c)+B(G*p))+B(I*D)),C[b+132>>2]=B(B(J*l)+B(G*w))+B(I*W),C[b+128>>2]=B(B(J*v)+B(G*s))+B(I*d),yf[t[t[A>>2]+8>>2]](A,b+128|0,b+24|0,b+8|0),o=C[b+24>>2],o<C[b+64>>2]&&(C[b+64>>2]=o),o=C[b+28>>2],o<C[b+68>>2]&&(C[b+68>>2]=o),o=C[b+32>>2],o<C[b+72>>2]&&(C[b+72>>2]=o),o=C[b+36>>2],o<C[b+76>>2]&&(C[b+76>>2]=o),o=C[b+8>>2],C[b+48>>2]<o&&(C[b+48>>2]=o),o=C[b+12>>2],C[b+52>>2]<o&&(C[b+52>>2]=o),o=C[b+16>>2],C[b+56>>2]<o&&(C[b+56>>2]=o),o=C[b+20>>2],C[b+60>>2]<o&&(C[b+60>>2]=o),t[b+520>>2]=f,t[b+516>>2]=k,C[b+508>>2]=n,t[b+504>>2]=e,t[b+500>>2]=r,t[b+496>>2]=A,t[b+492>>2]=i,t[b+488>>2]=21612,t[b+512>>2]=X,i=t[X+68>>2],!i)break b;e=b+56|0,r=t[e+4>>2],A=b+152|0,t[A>>2]=t[e>>2],t[A+4>>2]=r,e=b+72|0,r=t[e+4>>2],A=b+136|0,t[A>>2]=t[e>>2],t[A+4>>2]=r,A=t[b+52>>2],t[b+144>>2]=t[b+48>>2],t[b+148>>2]=A,A=t[b+68>>2],t[b+128>>2]=t[b+64>>2],t[b+132>>2]=A,Zi(i,t[i>>2],b+128|0,b+488|0);break t;}C[b+300>>2]=n,t[b+296>>2]=0,t[b+128>>2]=16056,t[b+292>>2]=t[f+4>>2],A=function(A,r,e){return t[A+20>>2]=e,t[A+16>>2]=0,t[A+12>>2]=r,t[A+4>>2]=0,t[A+8>>2]=0,t[A>>2]=19856,A;}(b+80|0,A,X),yf[t[t[A>>2]+8>>2]](A,r,e,k,k,b+128|0)&&(c=C[b+260>>2],l=C[b+264>>2],u=C[b+268>>2],o=B(B(B(c*c)+B(l*l))+B(u*u)),o>B(9999999747378752e-20)&&(n=C[b+292>>2],n<C[f+4>>2]&&(o=B(B(1)/B(Q(o))),C[b+268>>2]=u*o,C[b+264>>2]=l*o,C[b+260>>2]=c*o,e=b+284|0,r=t[e+4>>2],A=b+520|0,t[A>>2]=t[e>>2],t[A+4>>2]=r,_=b+260|0,e=_+8|0,r=t[e+4>>2],A=b+504|0,t[A>>2]=t[e>>2],t[A+4>>2]=r,C[b+528>>2]=n,A=t[b+280>>2],t[b+512>>2]=t[b+276>>2],t[b+516>>2]=A,A=t[_+4>>2],t[b+496>>2]=t[_>>2],t[b+500>>2]=A,t[b+492>>2]=0,t[b+488>>2]=t[i+8>>2],B(yf[t[t[f>>2]+12>>2]](f,b+488|0,1)))));break A;}if(G=C[e+52>>2],m=C[e+56>>2],R=C[k+52>>2],h=C[k+56>>2],y=C[r+52>>2],p=C[r+56>>2],M=C[k+20>>2],x=C[k+36>>2],S=C[k+24>>2],Z=C[k+40>>2],D=C[e+48>>2],o=C[k+48>>2],w=C[r+48>>2],Y=C[k+32>>2],N=C[k>>2],V=C[k+16>>2],I=C[k+4>>2],J=C[k+8>>2],t[b+516>>2]=0,W=C[e+8>>2],F=C[e+24>>2],g=C[e+40>>2],C[b+528>>2]=B(B(J*W)+B(S*F))+B(Z*g),d=C[e+4>>2],v=C[e+20>>2],s=C[e+36>>2],C[b+524>>2]=B(B(J*d)+B(S*v))+B(Z*s),C[b+512>>2]=B(B(I*W)+B(M*F))+B(x*g),C[b+508>>2]=B(B(I*d)+B(M*v))+B(x*s),t[b+500>>2]=0,c=C[e>>2],l=C[e+16>>2],u=C[e+32>>2],C[b+520>>2]=B(B(J*c)+B(S*l))+B(Z*u),C[b+504>>2]=B(B(I*c)+B(M*l))+B(x*u),C[b+496>>2]=B(B(N*W)+B(V*F))+B(Y*g),C[b+492>>2]=B(B(N*d)+B(V*v))+B(Y*s),C[b+488>>2]=B(B(N*c)+B(V*l))+B(Y*u),t[b+548>>2]=0,_=b+540|0,t[_>>2]=0,t[_+4>>2]=0,_=b+532|0,t[_>>2]=0,t[_+4>>2]=0,i=t[i+8>>2],la(b+128|0,A,r,e,k,B(yf[t[t[X>>2]+48>>2]](X))),t[b+348>>2]=X,t[b+344>>2]=i,t[b+128>>2]=21396,C[b+336>>2]=n,t[b+340>>2]=f,t[b+328>>2]=t[f+4>>2],yf[t[t[A>>2]+8>>2]](A,b+488|0,b+80|0,b+664|0),t[b+76>>2]=0,n=B(-o),d=B(B(B(J*n)-B(S*R))-B(Z*h)),v=B(d+B(B(B(J*w)+B(S*y))+B(Z*p))),C[b+72>>2]=v,u=B(B(B(I*n)-B(M*R))-B(x*h)),s=B(u+B(B(B(I*w)+B(M*y))+B(x*p))),C[b+68>>2]=s,o=B(B(B(N*n)-B(V*R))-B(Y*h)),n=B(o+B(B(B(N*w)+B(V*y))+B(Y*p))),C[b+64>>2]=n,g=B(u+B(B(B(I*D)+B(M*G))+B(x*m))),c=B(o+B(B(B(N*D)+B(V*G))+B(Y*m))),l=n,c<l&&(C[b+64>>2]=c,l=c),d=B(d+B(B(B(J*D)+B(S*G))+B(Z*m))),u=s,g<u&&(C[b+68>>2]=g,u=g),o=v,d<o&&(C[b+72>>2]=d,o=d),t[b+60>>2]=0,C[b+56>>2]=v,C[b+52>>2]=s,C[b+48>>2]=n,n<c)break n;if(s<g)break f;break a;}if(T=X+20|0,!(t[T>>2]<1))for(i=64,U=b+188|0,j=b+172|0,_=b+176|0,r=1;;){if(A=t[X+28>>2]+i|0,f=t[A>>2],m=C[A+-16>>2],R=C[A+-12>>2],h=C[A+-8>>2],y=C[A+-64>>2],p=C[A+-48>>2],D=C[A+-32>>2],w=C[A+-60>>2],W=C[A+-44>>2],F=C[A+-28>>2],u=C[A+-56>>2],o=C[A+-40>>2],n=C[A+-24>>2],t[U>>2]=0,t[j>>2]=0,t[b+156>>2]=0,t[b+140>>2]=0,g=C[k+32>>2],d=C[k+36>>2],v=C[k+40>>2],C[b+168>>2]=B(B(u*g)+B(o*d))+B(n*v),C[b+164>>2]=B(B(w*g)+B(W*d))+B(F*v),C[b+160>>2]=B(B(y*g)+B(p*d))+B(D*v),s=C[k+16>>2],c=C[k+20>>2],l=C[k+24>>2],C[b+152>>2]=B(B(u*s)+B(o*c))+B(n*l),C[b+148>>2]=B(B(w*s)+B(W*c))+B(F*l),C[b+144>>2]=B(B(y*s)+B(p*c))+B(D*l),M=u,u=C[k>>2],x=o,o=C[k+4>>2],S=n,n=C[k+8>>2],C[b+136>>2]=B(B(M*u)+B(x*o))+B(S*n),C[b+184>>2]=B(B(B(m*g)+B(R*d))+B(h*v))+C[k+56>>2],C[b+180>>2]=B(B(B(m*s)+B(R*c))+B(h*l))+C[k+52>>2],C[_>>2]=B(B(B(m*u)+B(R*o))+B(h*n))+C[k+48>>2],C[b+132>>2]=B(B(w*u)+B(W*o))+B(F*n),C[b+128>>2]=B(B(y*u)+B(p*o))+B(D*n),A=b+88|0,t[A>>2]=1,t[A+4>>2]=-1,e=r+-1|0,t[b+100>>2]=e,A=t[b+520>>2],t[b+96>>2]=A,t[b+84>>2]=1065353216,t[b+80>>2]=21828,t[b+84>>2]=t[A+4>>2],t[b+684>>2]=e,t[b+680>>2]=-1,A=t[b+492>>2],t[b+672>>2]=t[A+8>>2],t[b+668>>2]=f,t[b+664>>2]=A,t[b+676>>2]=b+128,Ba(t[b+496>>2],t[b+500>>2],t[b+504>>2],b+664|0,b+80|0,C[b+508>>2]),(0|r)>=t[T>>2])break t;i=i+80|0,r=r+1|0,k=t[b+516>>2];}}Ai();break A;}if(C[b+48>>2]=c,n=c,!(s<g))break a;}if(C[b+52>>2]=g,s=g,v<d)break i;break e;}if(!(v<d))break e;}C[b+56>>2]=d,v=d;}C[b+72>>2]=C[b+88>>2]+o,C[b+56>>2]=C[b+672>>2]+v,C[b+64>>2]=C[b+80>>2]+l,C[b+68>>2]=C[b+84>>2]+u,C[b+48>>2]=C[b+664>>2]+n,C[b+52>>2]=C[b+668>>2]+s,yf[t[t[X>>2]+64>>2]](X,b+128|0,b- -64|0,b+48|0);break A;}C[b+660>>2]=n,t[b+656>>2]=0,t[b+488>>2]=16056,t[b+652>>2]=t[f+4>>2],a[b+460|0]=0,t[b+436>>2]=953267991,t[b+64>>2]=14864,A=oa(b+664|0,A,X,b+128|0,b- -64|0),yf[t[t[A>>2]+8>>2]](A,r,e,k,k,b+488|0)&&(c=C[b+620>>2],l=C[b+624>>2],u=C[b+628>>2],o=B(B(B(c*c)+B(l*l))+B(u*u)),o>B(9999999747378752e-20)&&(n=C[b+652>>2],n<C[f+4>>2]&&(o=B(B(1)/B(Q(o))),C[b+628>>2]=u*o,C[b+624>>2]=l*o,C[b+620>>2]=c*o,e=b+644|0,r=t[e+4>>2],A=b+112|0,t[A>>2]=t[e>>2],t[A+4>>2]=r,_=b+620|0,e=_+8|0,r=t[e+4>>2],A=b+96|0,t[A>>2]=t[e>>2],t[A+4>>2]=r,C[b+120>>2]=n,A=t[b+640>>2],t[b+104>>2]=t[b+636>>2],t[b+108>>2]=A,A=t[_+4>>2],t[b+88>>2]=t[_>>2],t[b+92>>2]=A,t[b+84>>2]=0,t[b+80>>2]=t[i+8>>2],B(yf[t[t[f>>2]+12>>2]](f,b+80|0,1)))));}return void(E=b+688|0);}E=b+688|0;}function ma(A,r,e,i,a,f){var n,b,o=0,k=0,c=0,u=0,l=0,s=0,d=B(0),v=B(0),g=0,_=B(0),m=B(0),R=B(0),G=B(0),h=0,y=B(0),p=0,D=B(0),w=0,W=0,F=B(0);n=E-400|0,E=n,$e(n+392|0,20413),u=e+8|0,c=u,o=t[c+4>>2],g=n+336|0,t[g>>2]=t[c>>2],t[g+4>>2]=o,g=e+24|0,o=g,l=t[o+4>>2],c=n+352|0,t[c>>2]=t[o>>2],t[c+4>>2]=l,c=e+40|0,s=t[c+4>>2],o=n+368|0,t[o>>2]=t[c>>2],t[o+4>>2]=s,o=e+56|0,p=t[o+4>>2],l=n+384|0,t[l>>2]=t[o>>2],t[l+4>>2]=p,l=i+8|0,h=t[l+4>>2],s=n+272|0,t[s>>2]=t[l>>2],t[s+4>>2]=h,s=t[e+4>>2],t[n+328>>2]=t[e>>2],t[n+332>>2]=s,s=t[e+20>>2],t[n+344>>2]=t[e+16>>2],t[n+348>>2]=s,s=t[e+36>>2],t[n+360>>2]=t[e+32>>2],t[n+364>>2]=s,s=t[e+52>>2],t[n+376>>2]=t[e+48>>2],t[n+380>>2]=s,s=t[i+4>>2],t[n+264>>2]=t[i>>2],t[n+268>>2]=s,s=i+24|0,k=t[s+4>>2],p=n+288|0,t[p>>2]=t[s>>2],t[p+4>>2]=k,p=i+40|0,k=p,w=t[k+4>>2],h=n+304|0,t[h>>2]=t[k>>2],t[h+4>>2]=w,h=i+56|0,W=t[h+4>>2],k=n+320|0,t[k>>2]=t[h>>2],t[k+4>>2]=W,k=t[i+20>>2],t[n+280>>2]=t[i+16>>2],t[n+284>>2]=k,k=t[i+36>>2],t[n+296>>2]=t[i+32>>2],t[n+300>>2]=k,k=t[i+52>>2],t[n+312>>2]=t[i+48>>2],t[n+316>>2]=k,Ti(n+328|0,n+264|0,n,n+248|0),t[n+228>>2]=0,d=C[n+248>>2],C[n+224>>2]=d*C[n+8>>2],C[n+220>>2]=d*C[n+4>>2],C[n+216>>2]=d*C[n>>2],k=n+208|0,t[k>>2]=0,t[k+4>>2]=0,t[n+200>>2]=0,t[n+204>>2]=0,k=n+56|0,t[k>>2]=0,t[k+4>>2]=0,k=n+48|0,t[k>>2]=0,t[k+4>>2]=0,tf(n+328|0,n+248|0),k=n+44|0,t[k>>2]=0,w=n+28|0,t[w>>2]=0,d=C[n+248>>2],v=C[n+252>>2],_=C[n+256>>2],R=C[n+260>>2],m=B(B(2)/B(B(B(B(d*d)+B(v*v))+B(_*_))+B(R*R))),D=B(_*m),G=B(v*D),y=B(d*m),F=B(R*y),C[n+36>>2]=G+F,W=n+24|0,C[W>>2]=G-F,G=B(d*y),y=v,v=B(v*m),m=B(y*v),C[n+40>>2]=B(1)-B(G+m),_=B(_*D),C[n+20>>2]=B(1)-B(G+_),t[n+12>>2]=0,G=B(d*D),y=B(R*v),C[n+32>>2]=G-y,d=B(d*v),v=B(R*D),C[n+16>>2]=d+v,C[n+8>>2]=G+y,C[n+4>>2]=d-v,C[n>>2]=B(1)-B(m+_),GA(r,n,n+200|0,n+216|0,n+248|0,n+232|0),b=t[u+4>>2],t[k>>2]=t[u>>2],t[k+4>>2]=b,k=t[e+20>>2],u=n+52|0,t[u>>2]=t[e+16>>2],t[u+4>>2]=k,k=t[g+4>>2],u=n+60|0,t[u>>2]=t[g>>2],t[u+4>>2]=k,g=t[e+36>>2],u=n+68|0,t[u>>2]=t[e+32>>2],t[u+4>>2]=g,g=t[c+4>>2],u=n+76|0,t[u>>2]=t[c>>2],t[u+4>>2]=g,c=t[e+52>>2],u=n+84|0,t[u>>2]=t[e+48>>2],t[u+4>>2]=c,k=t[o+4>>2],g=n+92|0,c=g,t[c>>2]=t[o>>2],t[c+4>>2]=k,o=t[l+4>>2],c=n+108|0,t[c>>2]=t[l>>2],t[c+4>>2]=o,t[n>>2]=22216,c=t[e+4>>2],t[n+36>>2]=t[e>>2],t[n+40>>2]=c,e=t[i+4>>2],t[n+100>>2]=t[i>>2],t[n+104>>2]=e,o=t[i+52>>2],e=n+148|0,t[e>>2]=t[i+48>>2],t[e+4>>2]=o,l=t[h+4>>2],c=n+156|0,o=c,t[o>>2]=t[h>>2],t[o+4>>2]=l,l=t[s+4>>2],o=n+124|0,t[o>>2]=t[s>>2],t[o+4>>2]=l,l=t[i+20>>2],o=n+116|0,t[o>>2]=t[i+16>>2],t[o+4>>2]=l,l=t[p+4>>2],o=n+140|0,t[o>>2]=t[p>>2],t[o+4>>2]=l,l=t[i+36>>2],o=n+132|0,t[o>>2]=t[i+32>>2],t[o+4>>2]=l,t[n+192>>2]=r,C[n+188>>2]=f,t[n+184>>2]=a,d=C[n+88>>2],v=C[n+152>>2],f=C[u>>2],R=C[e>>2],_=C[g>>2],m=C[c>>2],t[n+180>>2]=A,f=B(R-f),d=B(v-d),v=B(m-_),R=B(B(1)/B(Q(B(B(B(f*f)+B(d*d))+B(v*v))))),_=B(v*R),D=_==B(0)?B(0xde0b6b000000000):B(B(1)/_),t[w>>2]=D<B(0),m=B(d*R),G=m==B(0)?B(0xde0b6b000000000):B(B(1)/m),t[W>>2]=G<B(0),C[n+12>>2]=D,C[n+8>>2]=G,y=f,f=B(f*R),C[n+32>>2]=B(v*_)+B(B(y*f)+B(d*m)),f=f==B(0)?B(0xde0b6b000000000):B(B(1)/f),C[n+4>>2]=f,t[n+20>>2]=f<B(0),A=t[A+68>>2],yf[t[t[A>>2]+24>>2]](A,n+376|0,n+312|0,n,n+248|0,n+232|0),Ai(),E=n+400|0;}function Ra(A){A|=0;var r,e=0,i=0,f=0,n=B(0),o=0,k=0,c=B(0),u=0,l=0,s=0,d=B(0),v=B(0),g=B(0),_=0,m=0,R=B(0),G=0,h=0,y=0,Q=0;if(r=E-192|0,E=r,yf[t[t[A>>2]+20>>2]](A)){if(e=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[e>>2]+100>>2]](e),e=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[e>>2]+8>>2]](r+80|0,e),e=0|yf[t[t[A>>2]+20>>2]](A),8&yf[t[t[e>>2]+56>>2]](e)&&(e=t[A+24>>2],e&&(f=0|yf[t[t[e>>2]+36>>2]](e),!((0|f)<1))))for(l=r+176|0,e=0,s=A+24|0;;){if(i=t[s>>2],k=0|yf[t[t[i>>2]+40>>2]](i,e),i=t[k+780>>2],(0|i)>=1)for(k=k+160|0;u=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[u>>2]+40>>2]](u,k+-124|0,k+-92|0,C[k+-76>>2],t[k>>2],l),k=k+192|0,i=i+-1|0,i;){}if(e=e+1|0,(0|f)==(0|e))break;}if(e=0|yf[t[t[A>>2]+20>>2]](A),3&yf[t[t[e>>2]+56>>2]](e)&&(G=A+8|0,!(t[G>>2]<1)))for(l=r+160|0,s=r+96|0,u=r+112|0,_=r+128|0,m=r+144|0,h=A+72|0,Q=A+44|0,k=0;;){if(e=t[t[A+16>>2]+k>>2],!(32&b[e+204|0])){if(yf[t[t[A>>2]+20>>2]](A)&&(i=0|yf[t[t[A>>2]+20>>2]](A),1&yf[t[t[i>>2]+56>>2]](i))){i=r+72|0,t[i>>2]=1053609165,t[i+4>>2]=0,t[r+64>>2]=1053609165,t[r+68>>2]=1053609165;A:{r:{e:{i:{a:{f:{if(f=t[e+220>>2]+-1|0,f>>>0<=4){switch(f-1|0){case 3:break e;case 2:break i;case 1:break a;case 0:break f;}if(f=r+88|0,o=t[f+4>>2],t[i>>2]=t[f>>2],t[i+4>>2]=o,f=t[r+84>>2],t[r+64>>2]=t[r+80>>2],t[r+68>>2]=f,1&a[e+205|0])break r;break A;}if(t[i>>2]=1050253722,t[i+4>>2]=0,t[r+64>>2]=1050253722,t[r+68>>2]=1050253722,1&a[e+205|0])break r;break A;}if(f=s+8|0,o=t[f+4>>2],t[i>>2]=t[f>>2],t[i+4>>2]=o,f=t[s+4>>2],t[r+64>>2]=t[s>>2],t[r+68>>2]=f,1&a[e+205|0])break r;break A;}if(f=u+8|0,o=t[f+4>>2],t[i>>2]=t[f>>2],t[i+4>>2]=o,f=t[u+4>>2],t[r+64>>2]=t[u>>2],t[r+68>>2]=f,1&a[e+205|0])break r;break A;}if(f=_+8|0,o=t[f+4>>2],t[i>>2]=t[f>>2],t[i+4>>2]=o,f=t[_+4>>2],t[r+64>>2]=t[_>>2],t[r+68>>2]=f,1&a[e+205|0])break r;break A;}if(f=m+8|0,o=t[f+4>>2],t[i>>2]=t[f>>2],t[i+4>>2]=o,f=t[m+4>>2],t[r+64>>2]=t[m>>2],t[r+68>>2]=f,!(1&a[e+205|0]))break A;}f=e+316|0,o=t[f+4>>2],t[i>>2]=t[f>>2],t[i+4>>2]=o,i=t[e+312>>2],t[r+64>>2]=t[e+308>>2],t[r+68>>2]=i;}yf[t[t[A>>2]+28>>2]](A,e+4|0,t[e+192>>2],r- -64|0);}if(i=t[h>>2],i&&2&yf[t[t[i>>2]+56>>2]](i)){if(f=l+8|0,o=t[f+4>>2],i=r+40|0,t[i>>2]=t[f>>2],t[i+4>>2]=o,i=t[l+4>>2],t[r+32>>2]=t[l>>2],t[r+36>>2]=i,i=t[e+192>>2],yf[t[t[i>>2]+8>>2]](i,e+4|0,r- -64|0,r+48|0),i=r+72|0,n=C[794],C[i>>2]=C[i>>2]-n,f=r+56|0,C[f>>2]=n+C[f>>2],C[r+64>>2]=C[r+64>>2]-n,C[r+68>>2]=C[r+68>>2]-n,C[r+48>>2]=n+C[r+48>>2],C[r+52>>2]=n+C[r+52>>2],!(3&b[e+204|0]|!b[0|Q]|2!=t[e+252>>2])){o=t[e+192>>2],yf[t[t[o>>2]+8>>2]](o,e+68|0,r+16|0,r),e=r+24|0,c=B(C[e>>2]-n),C[e>>2]=c,e=r+8|0,d=B(n+C[e>>2]),C[e>>2]=d,R=B(C[r+16>>2]-n),C[r+16>>2]=R,v=B(C[r+20>>2]-n),C[r+20>>2]=v,g=B(n+C[r>>2]),C[r>>2]=g,n=B(n+C[r+4>>2]),C[r+4>>2]=n;A:{r:{e:{i:{if(R<C[r+64>>2]){if(C[r+64>>2]=R,v<C[r+68>>2])break i;break e;}if(!(v<C[r+68>>2]))break e;}if(C[r+68>>2]=v,c<C[i>>2])break r;break A;}if(!(c<C[i>>2]))break A;}C[i>>2]=c;}A:{r:{e:{i:{a:{c=C[r+28>>2],e=r+76|0;f:{if(c<C[e>>2]){if(C[e>>2]=c,C[r+48>>2]<g)break f;break a;}if(!(C[r+48>>2]<g))break a;}if(C[r+48>>2]=g,C[r+52>>2]<n)break i;break e;}if(!(C[r+52>>2]<n))break e;}if(C[r+52>>2]=n,C[f>>2]<d)break r;break A;}if(!(C[f>>2]<d))break A;}C[f>>2]=d;}e=r+60|0,n=C[r+12>>2],C[e>>2]<n&&(C[e>>2]=n);}e=t[h>>2],yf[t[t[e>>2]+60>>2]](e,r- -64|0,r+48|0,r+32|0);}}if(k=k+4|0,y=y+1|0,!((0|y)<t[G>>2]))break;}}E=r+192|0;}function Ga(A,r){var e,i,f,n,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0;if(e=E-96|0,E=e,a[e+52|0]=1,d=e+48|0,t[d>>2]=0,a[e+72|0]=1,o=e+40|0,t[o>>2]=0,t[o+4>>2]=0,f=e+68|0,t[f>>2]=0,a[e+92|0]=1,o=e+60|0,t[o>>2]=0,t[o+4>>2]=0,i=e+88|0,t[i>>2]=0,o=e+80|0,t[o>>2]=0,t[o+4>>2]=0,t[e+28>>2]=0,a[e+32|0]=1,t[e+20>>2]=0,t[e+24>>2]=0,n=A+8|0,o=t[n>>2],!((0|o)<1)){for(v=e+28|0,C=e- -64|0;;){A:{s=t[t[t[A+16>>2]+(u<<2)>>2]+192>>2],t[e+12>>2]=s;r:{e:if(c=s+(s<<15^-1)|0,c=_(c>>>10^c,9),c^=c>>>6,c=(c<<11^-1)+c|0,l=l+-1&(c>>>16^c),!(l>>>0>=k>>>0)&&(k=t[t[v>>2]+(l<<2)>>2],-1!=(0|k))){for(l=t[d>>2],c=t[i>>2];;){if(t[c+(k<<3)>>2]!=(0|s)){if(k=t[l+(k<<2)>>2],-1!=(0|k))continue;break e;}break;}if(t[f>>2]+(k<<2)){if(u=u+1|0,(0|u)<(0|o))break r;break A;}}if(t[e>>2]=s,ha(e+16|0,e,e+12|0),k=t[e+12>>2],yf[t[t[k>>2]+60>>2]](k,r),u=u+1|0,o=t[n>>2],(0|u)>=(0|o))break A;}l=t[C>>2],k=t[e+20>>2];continue;}break;}if(!((0|o)<1))for(k=0,s=A+16|0,l=A+8|0,A=0;u=t[t[s>>2]+k>>2],d=t[u+252>>2],1!=(0|d)&&64!=(0|d)||(yf[t[t[u>>2]+24>>2]](u,r),o=t[l>>2]),k=k+4|0,A=A+1|0,(0|A)<(0|o);){}}A=t[i>>2],A&&(b[e+92|0]&&gA(A),t[e+88>>2]=0),t[e+88>>2]=0,a[e+92|0]=1,A=e+80|0,t[A>>2]=0,t[A+4>>2]=0,A=e+68|0,r=t[A>>2],r&&(b[e+72|0]&&gA(r),t[e+68>>2]=0),t[A>>2]=0,a[e+72|0]=1,A=e+60|0,t[A>>2]=0,t[A+4>>2]=0,A=e+48|0,r=t[A>>2],r&&(b[e+52|0]&&gA(r),t[e+48>>2]=0),t[A>>2]=0,a[e+52|0]=1,A=e+40|0,t[A>>2]=0,t[A+4>>2]=0,A=t[e+28>>2],A&&(b[e+32|0]&&gA(A),t[e+28>>2]=0),E=e+96|0;}function ha(A,r,e){var i=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,C=0;A:{r:{e:{i:{a:{if(n=t[r>>2],o=(n<<15^-1)+n|0,o=_(o>>>10^o,9),o^=o>>>6,o=(o<<11^-1)+o|0,i=o>>>16^o,o=t[A+48>>2],l=i&o+-1,!(l>>>0>=v[A+4>>2])&&(f=t[t[A+12>>2]+(l<<2)>>2],-1!=(0|f)))for(i=t[A+72>>2],k=A+32|0;;){if((0|n)==t[i+(f<<3)>>2])break a;if(f=t[t[k>>2]+(f<<2)>>2],-1==(0|f))break;}if(u=A+44|0,d=t[u>>2],n=d,(0|n)!=(0|o))break A;if(n=o,c=n?n<<1:1,(0|n)>=(0|c))break A;if(!c)break i;if(k=CA(c<<2,16),n=t[A+44>>2],(0|n)>=1)break e;break r;}return void(t[t[A+52>>2]+(f<<2)>>2]=t[e>>2]);}if(k=0,(0|o)<1)break r;}for(f=0,s=A+52|0,i=n;t[f+k>>2]=t[t[s>>2]+f>>2],f=f+4|0,i=i+-1|0,i;){}}i=A+52|0,f=t[i>>2],f&&(b[A+56|0]&&(gA(f),n=t[A+44>>2]),t[A+52>>2]=0),t[i>>2]=k,a[A+56|0]=1,t[A+48>>2]=c;}if(t[u>>2]=n+1,t[t[A+52>>2]+(n<<2)>>2]=t[e>>2],n=A- -64|0,i=t[n>>2],(0|i)==t[A+68>>2]&&(e=i?i<<1:1,!((0|i)>=(0|e)))){A:{r:{if(e){if(k=CA(e<<3,16),i=t[A- -64>>2],(0|i)>=1)break r;break A;}if(k=0,(0|i)<1)break A;}for(f=0,c=A+72|0;s=t[c>>2]+f|0,C=t[s+4>>2],u=f+k|0,t[u>>2]=t[s>>2],t[u+4>>2]=C,f=f+8|0,i=i+-1|0,i;){}}i=A+72|0,f=t[i>>2],f&&(b[A+76|0]&&gA(f),t[A+72>>2]=0),t[i>>2]=k,a[A+76|0]=1,t[A+68>>2]=e,i=t[A- -64>>2];}e=t[A+72>>2]+(i<<3)|0,i=t[r+4>>2],t[e>>2]=t[r>>2],t[e+4>>2]=i,t[n>>2]=t[n>>2]+1,e=A+48|0,(0|o)<t[e>>2]&&(function(A){var r=0,e=0,i=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0;if(k=t[A+4>>2],i=t[A+48>>2],!((0|k)>=(0|i))){A:{r:{e:{i:{a:{if(t[A+8>>2]<(0|i)){if(!i)break a;if(f=CA(i<<2,16),o=t[A+12>>2],e=t[A+4>>2],(0|e)<1)break i;break e;}f=t[A+12>>2];break A;}if(o=t[A+12>>2],e=k,(0|e)>=1)break e;}if(o)break r;a[A+16|0]=1,t[A+12>>2]=f,t[A+8>>2]=i;break A;}for(n=f,r=o;t[n>>2]=t[r>>2],n=n+4|0,r=r+4|0,e=e+-1|0,e;){}}b[A+16|0]&&gA(o),t[A+12>>2]=f,a[A+16|0]=1,t[A+8>>2]=i;}if(r=k<<2,c=i<<2,x(r+f|0,0,c-r|0),t[A+4>>2]=i,l=A+24|0,u=t[l>>2],(0|u)<(0|i)){A:{r:{e:{if(t[A+28>>2]<(0|i)){if(!i)break e;f=CA(c,16),e=t[A+24>>2];break r;}f=t[A+32>>2];break A;}f=0,e=u;}o=t[A+32>>2];r:{if((0|e)>=1)for(n=f,r=o;t[n>>2]=t[r>>2],n=n+4|0,r=r+4|0,e=e+-1|0,e;){}else if(!o)break r;r=A+36|0,b[0|r]&&gA(o),t[A+32>>2]=f,a[0|r]=1,t[A+28>>2]=i;break A;}t[A+32>>2]=f,a[A+36|0]=1,t[A+28>>2]=i;}r=u<<2,x(r+f|0,0,c-r|0);}if(t[l>>2]=i,(0|i)>=1&&(x(t[A+12>>2],255,c),x(t[A+32>>2],255,c)),!((0|k)<1))for(n=t[A+32>>2],o=t[A+12>>2],r=t[A+72>>2],e=0,f=A+48|0;A=t[r>>2],A=(A<<15^-1)+A|0,A=_(A>>>10^A,9),A^=A>>>6,A=(A<<11^-1)+A|0,A=o+((t[f>>2]+-1&(A>>>16^A))<<2)|0,t[n>>2]=t[A>>2],t[A>>2]=e,r=r+8|0,n=n+4|0,e=e+1|0,(0|e)!=(0|k);){}}}(A),r=t[r>>2],r=(r<<15^-1)+r|0,r=_(r>>>10^r,9),r^=r>>>6,r=(r<<11^-1)+r|0,l=t[e>>2]+-1&(r>>>16^r)),r=t[A+32>>2]+(d<<2)|0,A=t[A+12>>2]+(l<<2)|0,t[r>>2]=t[A>>2],t[A>>2]=d;}function ya(A,r,e,i,a){A|=0,r|=0,e=B(e),i|=0,a|=0;var f,n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0);return f=E-48|0,E=f,t[f+44>>2]=a,t[f+40>>2]=i,k=C[A- -64>>2],c=C[A+60>>2],u=C[A+80>>2],l=C[A+72>>2],s=C[A+76>>2],d=C[A+96>>2],v=C[A+88>>2],g=C[A+92>>2],_=C[A+56>>2],n=C[r+8>>2],b=C[r>>2],o=C[r+4>>2],t[f+28>>2]=0,C[f+24>>2]=B(B(b*v)+B(o*g))+B(n*d),C[f+20>>2]=B(B(b*l)+B(o*s))+B(n*u),C[f+16>>2]=B(B(_*b)+B(c*o))+B(k*n),C[f+32>>2]=e,t[f+8>>2]=t[A+48>>2],t[f+12>>2]=f+40,A=t[A+44>>2],e=B(yf[t[t[A>>2]+12>>2]](A,f+8|0,1)),E=f+48|0,B(e);}function Qa(A,r,e,i,a,f){A|=0,r|=0,e|=0,i=B(i),a|=0,f|=0;var n,b=0,o=0;return n=E+-64|0,E=n,t[n+60>>2]=f,t[n+56>>2]=a,a=t[A+212>>2],C[a+4>>2]>=i&&(b=e+8|0,o=t[b+4>>2],f=n+40|0,t[f>>2]=t[b>>2],t[f+4>>2]=o,b=r+8|0,o=t[b+4>>2],f=n+24|0,t[f>>2]=t[b>>2],t[f+4>>2]=o,f=t[e+4>>2],t[n+32>>2]=t[e>>2],t[n+36>>2]=f,e=t[r+4>>2],t[n+16>>2]=t[r>>2],t[n+20>>2]=e,C[n+48>>2]=i,t[n+8>>2]=t[A+216>>2],t[n+12>>2]=n+56,i=B(yf[t[t[a>>2]+12>>2]](a,n+8|0,1))),E=n- -64|0,B(i);}function pa(A){var r;r=t[A+12>>2],r&&(b[A+16|0]&&gA(r),t[A+12>>2]=0),a[A+16|0]=1,t[A+12>>2]=0,A=A+4|0,t[A>>2]=0,t[A+4>>2]=0;}function Da(A){var r,e,i=0,a=0,f=0,n=0,b=0,o=0;if(e=E-16|0,E=e,r=t[A+4>>2],!((0|r)<=0)){for(f=t[A+12>>2];;){if(i=n,b=(i<<3)+f|0,a=t[b>>2],(0|i)!=(0|a))for(o=b;i=(a<<3)+f|0,t[o>>2]=t[i>>2],i=t[i>>2],o=(i<<3)+f|0,a=t[o>>2],(0|i)!=(0|a);){}if(t[b>>2]=i,n=n+1|0,(0|r)==(0|n))break;}(0|r)<2||function A(r,e,i,a){var f=0,n=0,b=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0;for(c=r+12|0;;){for(s=i,k=t[c>>2],d=t[k+((i+a|0)/2<<3)>>2],b=i,o=a;;){for(n=((b<<3)+k|0)-8|0;b=b+1|0,n=n+8|0,t[n>>2]<(0|d);){}for(i=b+-1|0,f=8+(o<<3)|0;o=o+-1|0,u=f+k|0,l=f+-8|0,f=l,t[u+-8>>2]>(0|d);){}if(f=o+1|0,(0|i)<=(0|f)&&(v=t[n>>2],u=t[n+4>>2],f=k+l|0,i=t[f+4>>2],t[n>>2]=t[f>>2],t[n+4>>2]=i,i=t[c>>2]+l|0,t[i>>2]=v,t[i+4>>2]=u,f=o,i=b),!((0|i)<=(0|f)))break;k=t[c>>2],b=i,o=f;}if((0|f)>(0|s)&&A(r,e,s,f),!((0|i)<(0|a)))break;}}(A,e+8|0,0,r+-1|0);}E=e+16|0;}function wa(A,r,e,i){var f,n,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0,g=0,_=0,B=0,m=0,R=0,G=0,h=0,y=0;f=E-16|0,E=f,function(A,r,e){var i,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0,g=0,_=0,B=0,m=0,R=0,G=0,h=0,y=0,Q=0,p=0,D=0,w=0,W=0,F=0,Z=0,Y=0,N=0,V=0,I=0,J=0,X=0;if(i=E-16|0,E=i,$e(i+8|0,22384),n=A+28|0,k=t[n>>2],(0|k)<=-1)for(t[A+32>>2]<=-1&&(f=t[A+36>>2],f&&(b[A+40|0]&&gA(f),t[A+36>>2]=0),a[A+40|0]=1,f=A+32|0,t[f>>2]=0,t[f+4>>2]=0),f=k<<2,o=A+36|0;t[t[o>>2]+f>>2]=0,f=f+4|0,k=k+1|0,k;){}for(t[n>>2]=0,Da(A+4|0),G=t[A+8>>2],(0|G)>=1?(w=3,Y=16,h=A+16|0,N=-1,v=2,f=1):f=0;;){A:{r:{e:{i:{a:{f:{if(!f){if(W=0|yf[t[t[r>>2]+36>>2]](r),(0|W)<1)break f;c=2,s=1,V=A- -64|0,F=A+32|0,_=A+28|0,C=A+36|0,y=4,I=-1,Z=A+40|0,J=16,B=0,l=1;break r;}if(!l){for(u=t[h>>2],n=m,Q=n<<w,d=u+Q|0,f=d+8|0,R=t[d>>2];k=m,m=k+1|0,(0|m)<(0|G)&&(o=t[f>>2],f=f+8|0,(0|o)==(0|R));){}n:if(p=(0|n)>(0|k),!p){for(o=n+N|0,f=d+4|0,D=e+Y|0,X=t[D>>2],d=1;g=t[(t[f>>2]<<v)+X>>2],t[g+208>>2]==(0|R)&&(g=t[g+220>>2],d&=4!=(0|g)&1!=(0|g)),f=f+8|0,o=o+1|0,(0|o)<(0|k);){}if(1&d){if(p)break n;for(f=4|Q;;){if(o=t[t[D>>2]+(t[f+u>>2]<<v)>>2],t[o+208>>2]==(0|R)&&Vr(o,v),(0|n)>=(0|k))break n;f=f+8|0,n=n+1|0,u=t[h>>2];}}if(!p)for(f=4|Q;;){if(o=t[t[D>>2]+(t[f+u>>2]<<v)>>2],(0|R)!=t[o+208>>2]|t[o+220>>2]!=(0|v)||(Vr(o,w),t[o+224>>2]=0),(0|n)>=(0|k))break n;f=f+8|0,n=n+1|0,u=t[h>>2];}}if((0|m)<(0|G))break a;f=0;continue;}u=0|yf[t[t[r>>2]+40>>2]](r,B),n=t[u+776>>2];n:{t:{b:{o:{if(k=t[u+772>>2],t[k+220>>2]!=(0|c)&&k){if(o=t[k+204>>2],!(c&o))break o;}else {if(!n|t[n+220>>2]==(0|c))break n;if(o=t[k+204>>2],!(c&o)|t[k+220>>2]==(0|c))break o;}if(!(o&y)){if(Ir(n,0),o=t[n+204>>2],c&o)break b;break t;}}if(o=t[n+204>>2],!(c&o))break t;}o&y|t[n+220>>2]==(0|c)||Ir(k,0);}if(b[0|V]&&yf[t[t[r>>2]+28>>2]](r,k,n)){if(n=t[_>>2],(0|n)==t[F>>2]&&(l=n?n<<s:s,!((0|n)>=(0|l)))){t:{b:{if(l){if(o=CA(l<<c,J),n=t[_>>2],(0|n)>=(0|s))break b;break t;}if(o=0,(0|n)<(0|s))break t;}for(f=0,k=n;t[f+o>>2]=t[t[C>>2]+f>>2],f=f+y|0,k=k+I|0,k;){}}k=t[C>>2],k&&(b[0|Z]&&(gA(k),n=t[_>>2]),t[C>>2]=0),t[C>>2]=o,a[0|Z]=s,t[F>>2]=l;}t[_>>2]=n+s,t[t[C>>2]+(n<<c)>>2]=u;}}if(B=s+B|0,(0|B)!=(0|W))break i;}return Ai(),void(E=i+16|0);}l=0;break e;}l=1;break A;}f=1;continue;}f=1;continue;}f=1;}}(A,r,e),n=t[A+8>>2],$e(f+8|0,22412);A:if(b[A+64|0]){if(_=t[A+28>>2],(0|_)>=2&&function A(r,e,i,a){var f=0,n=0,b=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0;for(l=r+12|0;;){for(d=i,b=t[l>>2],s=t[b+((i+a|0)/2<<2)>>2],n=a;;){k=t[t[s+772>>2]+208>>2],c=(0|k)<0;r:if(c)for(o=i+-1|0,i=((i<<2)+b|0)-4|0,f=t[t[s+776>>2]+208>>2];;){if(i=i+4|0,u=t[i>>2],v=t[t[u+772>>2]+208>>2],(0|v)>-1){if(o=o+1|0,(0|v)<(0|f))continue;break r;}if(o=o+1|0,!(t[t[u+776>>2]+208>>2]<(0|f)))break;}else for(o=i+-1|0,i=((i<<2)+b|0)-4|0;;){if(i=i+4|0,f=t[i>>2],u=t[t[f+772>>2]+208>>2],(0|u)>-1){if(o=o+1|0,(0|u)<(0|k))continue;break r;}if(o=o+1|0,!(t[t[f+776>>2]+208>>2]<(0|k)))break;}r:if(c)for(f=n+1|0,n=4+((n<<2)+b|0)|0,b=t[t[s+776>>2]+208>>2];;){if(n=n+-4|0,k=t[n>>2],c=t[t[k+772>>2]+208>>2],(0|c)>-1){if(f=f+-1|0,(0|b)<(0|c))continue;break r;}if(f=f+-1|0,!((0|b)<t[t[k+776>>2]+208>>2]))break;}else for(f=n+1|0,n=4+((n<<2)+b|0)|0;;){if(n=n+-4|0,b=t[n>>2],c=t[t[b+772>>2]+208>>2],(0|c)>-1){if(f=f+-1|0,(0|k)<(0|c))continue;break r;}if(f=f+-1|0,!((0|k)<t[t[b+776>>2]+208>>2]))break;}r:{e:{if((0|o)>(0|f)){if(n=f,i=o,(0|i)<=(0|f))break e;break r;}if(b=t[i>>2],t[i>>2]=t[n>>2],t[t[l>>2]+(f<<2)>>2]=b,i=o+1|0,n=f+-1|0,(0|i)>(0|n))break r;}b=t[l>>2];continue;}break;}if((0|n)>(0|d)&&A(r,e,d,n),!((0|i)<(0|a)))break;}}(A+24|0,f,0,_+-1|0),(0|n)<1)break A;for(G=A+16|0,C=A+52|0,s=A+48|0,c=A+56|0,B=A+60|0,y=A+36|0,R=1;;){A=t[G>>2],v=t[A+(d<<3)>>2],g=1;r:if(!((0|d)>=(0|n)))for(;;){if(l=t[t[e+16>>2]+(t[4+((d<<3)+A|0)>>2]<<2)>>2],o=t[s>>2],(0|o)==t[C>>2]&&(k=o?o<<1:1,!((0|o)>=(0|k)))){e:{i:{if(k){if(u=CA(k<<2,16),o=t[s>>2],(0|o)>=1)break i;break e;}if(u=0,(0|o)<1)break e;}for(A=0,r=o;t[A+u>>2]=t[t[c>>2]+A>>2],A=A+4|0,r=r+-1|0,r;){}}A=t[c>>2],A&&(b[0|B]&&(gA(A),o=t[s>>2]),t[c>>2]=0),t[c>>2]=u,a[0|B]=1,t[C>>2]=k;}if(t[s>>2]=o+1,t[t[c>>2]+(o<<2)>>2]=l,A=t[l+220>>2],g&=5==(0|A)|2==(0|A),d=d+1|0,(0|d)>=(0|n))break r;if(A=t[G>>2],t[A+(d<<3)>>2]!=(0|v))break;}u=0;r:{e:{i:{a:{f:{if((0|m)<(0|_)){if(r=t[y>>2],k=m<<2,o=r+k|0,l=t[o>>2],h=t[t[l+772>>2]+208>>2],(0|h)<=-1)break f;if(A=0,(0|v)==(0|h))break a;break i;}if(A=0,g)break r;break e;}if(A=0,t[t[l+776>>2]+208>>2]!=(0|v))break i;}for(A=4+(r+k|0)|0,r=1;;){if(u=r,R=r+m|0,!((0|R)>=(0|_)))if(k=t[A>>2],l=t[t[k+772>>2]+208>>2],(0|l)>-1){if(A=A+4|0,r=u+1|0,(0|v)==(0|l))continue;}else if(A=A+4|0,r=u+1|0,t[t[k+776>>2]+208>>2]==(0|v))continue;break;}if(A=o,g)break r;break e;}if(g)break r;}yf[t[t[i>>2]+8>>2]](i,t[c>>2],t[s>>2],A,u,v);}if(r=t[s>>2],(0|r)<=-1)for(t[C>>2]<=-1&&(A=t[c>>2],A&&(b[0|B]&&gA(A),t[c>>2]=0),a[0|B]=1,t[C>>2]=0,t[C+4>>2]=0),A=r<<2;t[t[c>>2]+A>>2]=0,A=A+4|0,r=r+1|0,r;){}if(m=u?R:m,t[s>>2]=0,!((0|d)<(0|n)))break;}}else A=0|yf[t[t[r>>2]+44>>2]](r),r=0|yf[t[t[r>>2]+36>>2]](r),yf[t[t[i>>2]+8>>2]](i,t[e+16>>2],t[e+8>>2],A,r,-1);Ai(),E=f+16|0;}function Wa(A){var r=0,e=0,i=0,a=0,f=0,n=0;A:{r:{e:{if(l(A),a=o(0),e=a>>>23&255,255!=(0|e)){if(i=a<<1,i>>>0<=2173837238)break e;if(n=129,!e)break r;r=8388607&a|8388608;break A;}return A=B(A*B(6.2831854820251465)),B(A/A);}return -2121130058==(0|i)?B(A*B(0)):A;}if(e=0,r=a<<9,(0|r)>=0)for(;e=e+-1|0,r<<=1,(0|r)>-1;){}r=a<<1-e;}i=r-13176795|0,f=(0|i)>-1;A:{r:{if((0|e)>(0|n))for(;;){if(f&&(r=i,!r))break r;if(r<<=1,i=r-13176795|0,f=(0|i)>-1,e=e+-1|0,!((0|e)>(0|n)))break;}if(f&&(r=i,!r))break A;if(r>>>0<=8388607)for(;e=e+-1|0,r<<=1,r>>>0<8388608;){}return k(0,-2147483648&a|((0|e)>=1?r+-8388608|e<<23:r>>>1-e)),s();}return B(A*B(0));}return B(A*B(0));}function Fa(A,r,e,i){var a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0);f=_e(e),n=C[r+444>>2],e=ge(e),B(m(f))>B(1.1920928955078125e-7)?(a=B(e*e),k=B(f*f),b=B(a/k),o=C[r+448>>2],n=B(Q(B(B(b+B(1))/B(B(B(1)/B(o*o))+B(b/B(n*n))))))):(a=B(e*e),k=B(f*f)),t[A+12>>2]=0,b=B(n*B(.5)),a=B(ge(b)/B(Q(B(a+B(k+B(0)))))),e=B(e*a),n=B(a*B(0)),f=B(f*a),o=B(f*B(0)),c=B(e*B(-0)),k=B(B(B(-B(n*i))-o)-c),a=_e(b),u=B(a*B(0)),l=B(n*B(0)),b=B(B(u+l)-B(f*i)),o=B(B(B(a*i)+o)-c),i=B(B(u-B(e*i))-l),C[A+8>>2]=B(B(B(e*k)+B(a*b))-B(o*f))+B(i*n),C[A+4>>2]=B(B(B(a*i)-B(k*f))-B(b*n))-B(e*o),C[A>>2]=B(B(e*i)+B(B(a*o)-B(k*n)))+B(b*f);}function Za(A,r,e,i,a){var f=B(0);f=B(1);A:if(!(r>e)&&(f=B(0),r!=e)){r:{e:{if(i=B(i/a),i<B(0)){if(A>=r^1|B(r-i)>A^1)break e;return B(B(r-A)/i);}if(!(i>B(0)))break A;if(A<=e^1|B(e-i)<A^1)break r;return B(B(e-A)/i);}return B(A<r?0:1);}return B(A>e?0:1);}return f;}function Ya(A,r,e){A|=0,r|=0,e|=0;var i=0,a=0,f=0,n=0,o=0;n=r,o=0|yf[t[t[e>>2]+28>>2]](e,t[A+28>>2]),t[n>>2]=o,n=r,o=0|yf[t[t[e>>2]+28>>2]](e,t[A+32>>2]),t[n+4>>2]=o,i=0|yf[t[t[e>>2]+40>>2]](e,A),a=0|yf[t[t[e>>2]+28>>2]](e,i),t[r+8>>2]=a,a&&yf[t[t[e>>2]+48>>2]](e,i),t[r+12>>2]=t[A+4>>2],t[r+24>>2]=b[A+21|0],t[r+40>>2]=t[A+24>>2],t[r+44>>2]=t[A+16>>2],t[r+48>>2]=b[A+20|0],e=t[A+12>>2],i=t[A+40>>2],t[r+28>>2]=t[A+36>>2],t[r+32>>2]=i,t[r+20>>2]=e,t[r+16>>2]=t[A+8>>2],i=0,t[r+36>>2]=0,e=t[A+28>>2],a=t[e+548>>2];A:if(!((0|a)<1))for(e=t[e+556>>2],f=r+36|0;;){if((0|A)!=t[e>>2]){if(e=e+4|0,i=i+1|0,(0|i)<(0|a))continue;break A;}if(t[f>>2]=1,e=e+4|0,i=i+1|0,!((0|i)<(0|a)))break;}e=t[A+32>>2],a=t[e+548>>2];A:if(!((0|a)<1))for(e=t[e+556>>2],i=0,r=r+36|0;;){if((0|A)!=t[e>>2]){if(e=e+4|0,i=i+1|0,(0|i)<(0|a))continue;break A;}if(t[r>>2]=1,e=e+4|0,i=i+1|0,!((0|i)<(0|a)))break;}return 22516;}function Ea(A){var r=0,e=0,i=B(0),a=0;A:{r:{e:{if(l(A),a=o(0),e=2147483647&a,e>>>0>=1065353216){if(1065353216!=(0|e))break e;return B(1.5707963267948966*+A+7.52316384526264e-37);}if(e>>>0>1056964607)break A;if(e+-8388608>>>0<956301312)break r;return i=B(A*A),B(B(B(B(i*B(B(i*B(B(i*B(-.008656363002955914))+B(-.04274342209100723)))+B(.16666586697101593)))/B(B(i*B(-.7066296339035034))+B(1)))*A)+A);}A=B(B(0)/B(A-A));}return A;}return A=B(B(B(1)-B(m(A)))*B(.5)),r=Q(+A),r+=r*+B(B(A*B(B(A*B(B(A*B(-.008656363002955914))+B(-.04274342209100723)))+B(.16666586697101593)))/B(B(A*B(-.7066296339035034))+B(1))),A=B(1.5707963267948966-(r+r)),(0|a)<0?B(-A):A;}function Na(A,r){return C[1192+((r<<2)+A|0)>>2];}function Va(A){return A|=0,t[A>>2]=22472,0|A;}function Ia(A,r,e,i){var n;!function(A,r,e){t[A>>2]=20052,a[A+76|0]=1,t[A+72>>2]=0,t[A+68>>2]=e,t[A+28>>2]=0,t[A+32>>2]=0,t[A+24>>2]=r,a[A+20|0]=1,t[A+16>>2]=0,t[A- -64>>2]=0,a[A+60|0]=0,t[A+56>>2]=1025758986,a[A+54|0]=1,f[A+52>>1]=256,t[A+48>>2]=0,a[A+44|0]=1,r=A+36|0,t[r>>2]=1,t[r+4>>2]=1065353216,A=A+8|0,t[A>>2]=0,t[A+4>>2]=0;}(A,r,e),e=A+100|0,t[e>>2]=1050253722,t[e+4>>2]=1015580809,t[A+92>>2]=1058642330,t[A+96>>2]=1065353216,t[A+88>>2]=0,t[A+80>>2]=0,t[A+84>>2]=0,e=A+132|0,t[e>>2]=0,t[e+4>>2]=1045220557,e=A+124|0,t[e>>2]=1045220557,t[e+4>>2]=1045220557,e=A+108|0,t[e>>2]=0,t[e+4>>2]=10,e=A+184|0,t[e>>2]=0,t[e+4>>2]=1045220557,e=A+176|0,t[e>>2]=1120403456,t[e+4>>2]=1900671690,t[A+172>>2]=128,e=A+164|0,t[e>>2]=260,t[e+4>>2]=2,e=A+156|0,t[e>>2]=0,t[e+4>>2]=1062836634,e=A+148|0,t[e>>2]=-1121724662,t[e+4>>2]=1036831949,e=A+140|0,t[e>>2]=0,t[e+4>>2]=1,e=A+116|0,t[e>>2]=1101004800,t[e+4>>2]=1065353216,a[A+208|0]=1,t[A>>2]=22620,t[A+216>>2]=i,t[A+212>>2]=0,t[A+204>>2]=0,a[A+240|0]=1,e=A+196|0,t[e>>2]=0,t[e+4>>2]=0,a[A+260|0]=1,t[A+236>>2]=0,e=A+228|0,t[e>>2]=0,t[e+4>>2]=0,t[A+256>>2]=0,f[A+290>>1]=0,t[A+264>>2]=0,t[A+268>>2]=-1054867456,e=A+248|0,t[e>>2]=0,t[e+4>>2]=0,e=A+280|0,t[e>>2]=0,t[e+4>>2]=0,e=A+272|0,t[e>>2]=0,t[e+4>>2]=0,a[A+308|0]=1,t[A+304>>2]=0,a[A+336|0]=1,a[A+316|0]=1,t[A+312>>2]=0,e=A+296|0,t[e>>2]=0,t[e+4>>2]=0,t[A+332>>2]=0,t[A+340>>2]=0,e=A+324|0,t[e>>2]=0,t[e+4>>2]=0,n=A,i?e=0:(e=CA(236,16),$i(e),t[A+216>>2]=e,e=1),a[n+289|0]=e,e=CA(68,16),function(A){var r=0;t[A>>2]=22368,r=A+4|0,t[r+12>>2]=0,a[r+16|0]=1,t[r+4>>2]=0,t[r+8>>2]=0,t[A+36>>2]=0,a[A+40|0]=1,a[A+60|0]=1,r=A+28|0,t[r>>2]=0,t[r+4>>2]=0,t[A+56>>2]=0,a[A+64|0]=1,A=A+48|0,t[A>>2]=0,t[A+4>>2]=0;}(e),a[A+288|0]=1,t[A+220>>2]=e,e=CA(88,16),t[e+52>>2]=0,t[e+56>>2]=0,t[e+72>>2]=0,t[e+76>>2]=0,a[e+44|0]=1,t[e+24>>2]=r,t[e+20>>2]=0,t[e+12>>2]=0,t[e+16>>2]=0,t[e+4>>2]=0,t[e>>2]=23228,t[e+40>>2]=0,a[e+64|0]=1,t[e+32>>2]=0,t[e+36>>2]=0,t[e+60>>2]=0,a[e+84|0]=1,t[e+80>>2]=0,t[e+8>>2]=t[A+216>>2],t[A+212>>2]=e;}function Ja(A){A|=0;var r=0,e=0;return t[A>>2]=22620,b[A+288|0]&&(r=t[A+220>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+220>>2])),r=t[A+212>>2],r&&(yf[t[t[r>>2]>>2]](r),gA(t[A+212>>2])),b[A+289|0]&&(r=t[A+216>>2],yf[t[t[r>>2]>>2]](r),gA(t[A+216>>2])),r=A+332|0,e=t[r>>2],e&&(b[A+336|0]&&gA(e),t[A+332>>2]=0),t[r>>2]=0,a[A+336|0]=1,r=A+324|0,t[r>>2]=0,t[r+4>>2]=0,r=A+304|0,e=t[r>>2],e&&(b[A+308|0]&&gA(e),t[A+304>>2]=0),t[r>>2]=0,a[A+308|0]=1,r=A+296|0,t[r>>2]=0,t[r+4>>2]=0,r=A+256|0,e=t[r>>2],e&&(b[A+260|0]&&gA(e),t[A+256>>2]=0),t[r>>2]=0,a[A+260|0]=1,r=A+248|0,t[r>>2]=0,t[r+4>>2]=0,r=A+236|0,e=t[r>>2],e&&(b[A+240|0]&&gA(e),t[A+236>>2]=0),t[r>>2]=0,a[A+240|0]=1,r=A+228|0,t[r>>2]=0,t[r+4>>2]=0,r=A+204|0,e=t[r>>2],e&&(b[A+208|0]&&gA(e),t[A+204>>2]=0),t[r>>2]=0,a[A+208|0]=1,r=A+196|0,t[r>>2]=0,t[r+4>>2]=0,sa(A),0|A;}function Xa(A,r){A|=0,r|=0,yf[t[t[A>>2]+64>>2]](A,r);}function Ma(A,r){A|=0,r|=0,yf[t[t[A>>2]+68>>2]](A,r);}function xa(A){var r,e,i,f=0,n=0,o=0,k=0,c=0;if(o=t[A+8>>2],r=o,k=t[A+32>>2],k&&(n=t[A+40>>2]),e=n,n=t[A+52>>2],n&&(f=t[A+60>>2]),i=f,f=t[A+72>>2],c=t[A+80>>2],f||(c=0),B(yf[t[t[o>>2]+12>>2]](r,e,k,i,n,c,f,t[A+4>>2],t[A+20>>2],t[A+24>>2])),o=A+32|0,n=t[o>>2],(0|n)<=-1)for(t[A+36>>2]<=-1&&(f=t[A+40>>2],f&&(b[A+44|0]&&gA(f),t[A+40>>2]=0),a[A+44|0]=1,f=A+36|0,t[f>>2]=0,t[f+4>>2]=0),f=n<<2,k=A+40|0;t[t[k>>2]+f>>2]=0,f=f+4|0,n=n+1|0,n;){}if(t[o>>2]=0,o=A+52|0,n=t[o>>2],(0|n)<=-1)for(t[A+56>>2]<=-1&&(f=t[A+60>>2],f&&(b[A- -64|0]&&gA(f),t[A+60>>2]=0),a[A- -64|0]=1,f=A+56|0,t[f>>2]=0,t[f+4>>2]=0),f=n<<2,k=A+60|0;t[t[k>>2]+f>>2]=0,f=f+4|0,n=n+1|0,n;){}if(t[o>>2]=0,o=A+72|0,n=t[o>>2],(0|n)<=-1)for(t[A+76>>2]<=-1&&(f=t[A+80>>2],f&&(b[A+84|0]&&gA(f),t[A+80>>2]=0),a[A+84|0]=1,f=A+76|0,t[f>>2]=0,t[f+4>>2]=0),f=n<<2,A=A+80|0;t[t[A>>2]+f>>2]=0,f=f+4|0,n=n+1|0,n;){}t[o>>2]=0;}function Sa(A,r){return A|=0,r|=0,t[t[A+236>>2]+(r<<2)>>2];}function Ta(A,r,e,i,a,f){var n,b=0,o=0,k=0,c=B(0),u=0,l=B(0),s=0,d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=0;if(n=E-272|0,E=n,k=e+8|0,o=t[k+4>>2],b=n+216|0,t[b>>2]=t[k>>2],t[b+4>>2]=o,k=e+24|0,o=t[k+4>>2],b=n+232|0,t[b>>2]=t[k>>2],t[b+4>>2]=o,k=e+40|0,o=t[k+4>>2],b=n+248|0,t[b>>2]=t[k>>2],t[b+4>>2]=o,o=e+56|0,u=t[o+4>>2],k=n+264|0,b=k,t[b>>2]=t[o>>2],t[b+4>>2]=u,o=i+8|0,u=t[o+4>>2],b=n+152|0,t[b>>2]=t[o>>2],t[b+4>>2]=u,b=e,o=t[b+4>>2],t[n+208>>2]=t[b>>2],t[n+212>>2]=o,o=t[b+20>>2],t[n+224>>2]=t[b+16>>2],t[n+228>>2]=o,o=t[b+36>>2],t[n+240>>2]=t[b+32>>2],t[n+244>>2]=o,o=t[b+52>>2],t[n+256>>2]=t[b+48>>2],t[n+260>>2]=o,b=t[i+4>>2],t[n+144>>2]=t[i>>2],t[n+148>>2]=b,o=i+24|0,u=t[o+4>>2],b=n+168|0,t[b>>2]=t[o>>2],t[b+4>>2]=u,o=i+40|0,u=t[o+4>>2],b=n+184|0,t[b>>2]=t[o>>2],t[b+4>>2]=u,u=i+56|0,s=t[u+4>>2],b=n+200|0,t[b>>2]=t[u>>2],t[b+4>>2]=s,o=t[i+20>>2],t[n+160>>2]=t[i+16>>2],t[n+164>>2]=o,o=t[i+36>>2],t[n+176>>2]=t[i+32>>2],t[n+180>>2]=o,o=t[i+52>>2],t[n+192>>2]=t[i+48>>2],t[n+196>>2]=o,t[n+108>>2]=0,C[n+104>>2]=C[b>>2]-C[k>>2],C[n+100>>2]=C[n+196>>2]-C[n+260>>2],C[n+96>>2]=C[n+192>>2]-C[n+256>>2],Ti(n+208|0,n+144|0,n+16|0,n+128|0),t[n+92>>2]=0,c=C[n+128>>2],C[n+88>>2]=c*C[n+24>>2],C[n+84>>2]=c*C[n+20>>2],C[n+80>>2]=c*C[n+16>>2],b=n+72|0,t[b>>2]=0,t[b+4>>2]=0,b=n- -64|0,t[b>>2]=0,t[b+4>>2]=0,tf(n+208|0,n+128|0),t[n+60>>2]=0,t[n+44>>2]=0,c=C[n+128>>2],l=C[n+132>>2],v=C[n+136>>2],m=C[n+140>>2],_=B(B(2)/B(B(B(B(c*c)+B(l*l))+B(v*v))+B(m*m))),R=B(v*_),d=B(l*R),g=B(c*_),G=B(m*g),C[n+52>>2]=d+G,C[n+40>>2]=d-G,d=B(c*g),g=l,l=B(l*_),_=B(g*l),C[n+56>>2]=B(1)-B(d+_),v=B(v*R),C[n+36>>2]=B(1)-B(d+v),t[n+28>>2]=0,d=B(c*R),g=B(m*l),C[n+48>>2]=d-g,c=B(c*l),l=B(m*R),C[n+32>>2]=c+l,C[n+24>>2]=d+g,C[n+20>>2]=c-l,C[n+16>>2]=B(1)-B(_+v),GA(r,n+16|0,n+96|0,n+80|0,n+128|0,n+112|0),b=A+328|0,t[b>>2]>=1)for(k=i+48|0,o=e+48|0,u=A+336|0,i=0,A=0;e=t[t[u>>2]+i>>2],yf[t[t[a>>2]+8>>2]](a,t[e+188>>2])&&(s=t[e+192>>2],h=e+4|0,yf[t[t[s>>2]+8>>2]](s,h,n+16|0,n+96|0),t[n+28>>2]=0,t[n+108>>2]=0,s=n+24|0,C[s>>2]=C[s>>2]+C[n+136>>2],s=n+104|0,C[s>>2]=C[s>>2]+C[n+120>>2],C[n+20>>2]=C[n+20>>2]+C[n+132>>2],C[n+16>>2]=C[n+16>>2]+C[n+128>>2],C[n+96>>2]=C[n+96>>2]+C[n+112>>2],C[n+100>>2]=C[n+100>>2]+C[n+116>>2],t[n+12>>2]=1065353216,Ua(o,k,n+16|0,n+96|0,n+12|0,n+80|0)&&_a(r,n+208|0,n+144|0,e,t[e+192>>2],h,a,f)),i=i+4|0,A=A+1|0,(0|A)<t[b>>2];){}E=n+272|0;}function Ua(A,r,e,i,a,f){var n,b,c,u,d,v,g,_,m,R,G,h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),N=B(0),V=B(0),I=B(0),J=B(0);if(n=E-16|0,p=C[i>>2],y=C[e>>2],D=B(B(p+y)*B(.5)),h=B(C[r>>2]-D),p=B(p-y),Y=B(p*B(.5)),u=h>Y,p=B(p*B(-.5)),d=h<p,Q=C[i+4>>2],w=C[e+4>>2],F=B(B(Q+w)*B(.5)),y=B(C[r+4>>2]-F),Q=B(Q-w),w=B(Q*B(-.5)),v=y<w,N=B(Q*B(.5)),g=y>N,Q=C[i+8>>2],W=C[e+8>>2],Z=B(B(Q+W)*B(.5)),I=B(C[r+8>>2]-Z),Q=B(Q-W),J=B(Q*B(-.5)),_=I<J,V=B(Q*B(.5)),m=d|u<<3|v<<1|g<<4|_<<2|(I>V)<<5,W=B(C[A>>2]-D),e=W>Y,R=W<p,Q=B(C[A+4>>2]-F),i=Q<w,b=Q>N,w=B(C[A+8>>2]-Z),c=w<J,A=e<<3|R|i<<1|b<<4|c<<2|(w>V)<<5,m&A)return 0;p=C[a>>2],r=t[a>>2],G=n+8|0,t[G>>2]=0,t[G+4>>2]=0,t[n>>2]=0,t[n+4>>2]=0,Z=B(h-W);A:{r:{e:{i:{a:{f:{n:{t:{b:{o:{k:{c:{u:{l:{s:{d:{v:{C:{g:{if(R){if(D=B(B(B(-W)-Y)/Z),D>=B(0))break g;if(D=B(0),F=B(y-Q),i)break v;break C;}if(D=B(0),d&&(h=B(B(B(-W)-Y)/Z),h<p&&(l(h),r=o(0),p=h)),F=B(y-Q),!i)break C;break v;}if(t[n+12>>2]=0,t[n+4>>2]=0,t[n+8>>2]=0,t[n>>2]=1065353216,F=B(y-Q),i)break v;}if(!v)break d;if(h=B(B(B(-Q)-N)/F),!(h<(k(0,r),s())))break d;l(h),r=o(0),p=h;break d;}if(h=B(B(B(-Q)-N)/F),D<=h){if(i=n+8|0,t[i>>2]=0,t[i+4>>2]=0,t[n>>2]=0,t[n+4>>2]=0,t[n+4>>2]=1065353216,D=B(I-w),c)break s;break l;}}if(h=D,D=B(I-w),!c)break l;}if(y=B(B(B(-w)-V)/D),!(h<=y))break u;if(i=n+8|0,t[i>>2]=0,t[i+4>>2]=0,t[i>>2]=1065353216,t[n>>2]=0,t[n+4>>2]=0,e)break c;break k;}if(_&&(y=B(B(B(-w)-V)/D),y<(k(0,r),s()))){if(l(y),r=o(0),p=y,y=h,e)break c;break k;}}if(y=h,!e)break k;}if(h=B(B(Y-W)/Z),!(y<=h))break o;if(t[n+12>>2]=0,t[n+4>>2]=0,t[n+8>>2]=0,t[n>>2]=-1082130432,b)break b;break t;}u&&(h=B(B(Y-W)/Z),h<(k(0,r),s())&&(l(h),r=o(0),p=h));}if(h=y,!b)break t;}if(y=B(B(N-Q)/F),!(h<=y))break n;if(e=n+8|0,t[e>>2]=0,t[e+4>>2]=0,t[n>>2]=0,t[n+4>>2]=0,t[n+4>>2]=-1082130432,!(32&A))break f;break a;}if(g&&(y=B(B(N-Q)/F),y<(k(0,r),s()))){if(l(y),r=o(0),p=y,y=h,!(32&A))break f;break a;}}if(y=h,32&A)break a;}if(!(32&m))break i;if(h=B(B(V-w)/D),!(h<(k(0,r),s())))break i;p=h;break i;}if(h=B(B(V-w)/D),y<=h)break e;}if(h=y,h<=p)break r;break A;}if(A=n+8|0,t[A>>2]=0,t[A+4>>2]=0,t[A>>2]=-1082130432,t[n>>2]=0,t[n+4>>2]=0,!(h<=p))break A;}return C[a>>2]=h,A=t[n+4>>2],t[f>>2]=t[n>>2],t[f+4>>2]=A,r=n+8|0,e=t[r+4>>2],A=f+8|0,t[A>>2]=t[r>>2],t[A+4>>2]=e,1;}return 0;}function ja(A,r){var e,i,a,f,n,b,o,k,c,u,l,s,d,v=B(0),g=0,_=B(0),R=B(0),G=B(0),h=B(0),y=0,p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=0,N=B(0),V=B(0),I=B(0),J=B(0);e=E-80|0,E=e,y=A+256|0;A:{w=C[r+12>>2],N=C[A+264>>2],v=C[r+8>>2];r:if(C[A+268>>2]!=w|N!=v|C[A+260>>2]!=C[r+4>>2]||C[y>>2]!=C[r>>2]){if(g=A+260|0,_=C[g>>2],G=C[A+256>>2],F=C[r>>2],Z=C[r+4>>2],V=B(B(B(F*F)+B(Z*Z))+B(v*v)),V>B(0)){if(C[A+268>>2]=w,w=B(B(1)/B(Q(V))),h=B(v*w),C[A+264>>2]=h,p=B(Z*w),C[g>>2]=p,W=B(F*w),C[A+256>>2]=W,r=t[A+8>>2],!r)break r;break A;}if(t[y>>2]=0,t[y+4>>2]=0,r=y+8|0,t[r>>2]=0,t[r+4>>2]=0,r=t[A+8>>2],r)break A;}return void(E=e+80|0);}R=B(B(B(W*W)+B(p*p))+B(h*h));A:if(R!=B(0)&&(v=B(B(B(G*G)+B(_*_))+B(N*N)),v!=B(0))){R=B(B(1)/B(Q(R))),h=B(h*R),C[A+264>>2]=h,D=B(p*R),C[A+260>>2]=D,p=B(W*R),C[A+256>>2]=p;r:{e:{if(v=B(B(1)/B(Q(v))),W=B(N*v),_=B(_*v),G=B(G*v),v=B(B(W*h)+B(B(_*D)+B(G*p))),v<B(-.9999998807907104)){if(!(B(m(h))>B(.7071067690849304)))break e;v=B(B(1)/B(Q(B(B(D*D)+B(h*h))))),w=B(D*v),Z=B(-B(h*v)),F=B(0);break r;}v=B(v+B(1)),v=B(Q(B(v+v))),R=B(B(1)/v),w=B(B(B(_*p)-B(G*D))*R),Z=B(B(B(G*h)-B(W*p))*R),F=B(B(B(W*D)-B(_*h))*R),V=B(v*B(.5));break A;}v=B(B(1)/B(Q(B(B(D*D)+B(p*p))))),Z=B(p*v),w=B(0),F=B(-B(D*v));}V=B(0);}y=r+12|0,g=t[y+4>>2],i=e+24|0,Y=i,t[Y>>2]=t[y>>2],t[Y+4>>2]=g,g=r+20|0,f=t[g>>2],n=t[g+4>>2],g=r+36|0,b=t[g>>2],o=t[g+4>>2],g=r+28|0,k=t[g>>2],c=t[g+4>>2],g=r+44|0,u=t[g>>2],l=t[g+4>>2],s=t[r+4>>2],d=t[r+8>>2],y=r+60|0,g=t[y+4>>2],a=e+72|0,Y=a,t[Y>>2]=t[y>>2],t[Y+4>>2]=g,Y=e+56|0,g=Y,t[g>>2]=u,t[g+4>>2]=l,y=e+40|0,g=y,t[g>>2]=k,t[g+4>>2]=c,t[e+16>>2]=s,t[e+20>>2]=d,g=r+52|0,r=t[g+4>>2],t[e+64>>2]=t[g>>2],t[e+68>>2]=r,t[e+48>>2]=b,t[e+52>>2]=o,t[e+32>>2]=f,t[e+36>>2]=n,tf(e+16|0,e),_=C[e>>2],G=C[e+12>>2],R=C[e+8>>2],v=C[e+4>>2],I=B(B(B(B(V*_)-B(G*F))-B(R*Z))+B(v*w)),J=B(B(B(B(V*G)+B(_*F))+B(v*Z))+B(R*w)),D=B(B(B(B(V*R)-B(G*w))-B(v*F))+B(_*Z)),_=B(B(B(B(V*v)-B(G*Z))-B(_*w))+B(R*F)),v=B(B(2)/B(B(J*J)+B(B(D*D)+B(B(I*I)+B(_*_))))),N=B(D*v),p=B(I*N),h=B(_*v),W=B(J*h),C[i>>2]=p+W,t[e+60>>2]=0,t[e+44>>2]=0,G=B(_*N),R=B(I*v),v=B(J*R),C[e+52>>2]=G+v,C[y>>2]=G-v,v=B(I*R),_=B(_*h),C[Y>>2]=B(1)-B(v+_),G=B(D*N),C[e+36>>2]=B(1)-B(v+G),t[e+28>>2]=0,C[e+48>>2]=p-W,R=B(I*h),v=B(J*N),C[e+32>>2]=R+v,C[e+20>>2]=R-v,g=t[A+8>>2],r=g+12|0,A=t[i+4>>2],t[r>>2]=t[i>>2],t[r+4>>2]=A,C[e+16>>2]=B(1)-B(_+G),A=t[e+20>>2],t[g+4>>2]=t[e+16>>2],t[g+8>>2]=A,A=t[y+4>>2],r=g+28|0,t[r>>2]=t[y>>2],t[r+4>>2]=A,A=t[e+36>>2],r=g+20|0,t[r>>2]=t[e+32>>2],t[r+4>>2]=A,t[g+304>>2]=t[g+304>>2]+1,A=t[e+52>>2],r=g+36|0,t[r>>2]=t[e+48>>2],t[r+4>>2]=A,A=t[Y+4>>2],r=g+44|0,t[r>>2]=t[Y>>2],t[r+4>>2]=A,A=t[a+4>>2],r=g+60|0,t[r>>2]=t[a>>2],t[r+4>>2]=A,A=t[e+68>>2],r=g+52|0,t[r>>2]=t[e+64>>2],t[r+4>>2]=A,E=e+80|0;}function Oa(A,r){var e,i=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=B(0),g=B(0),_=0,m=0,R=0,G=0,h=0,y=0,Q=0,p=B(0),D=B(0),w=B(0),W=0;if(e=E-96|0,E=e,i=t[A+12>>2],yf[t[t[i>>2]+8>>2]](i,t[A+8>>2]+4|0,e+80|0,e- -64|0),i=t[r+68>>2],yf[t[t[i>>2]+16>>2]](i,t[t[A+8>>2]+188>>2],e+80|0,e- -64|0,t[r+24>>2]),i=t[r+24>>2],yf[t[t[i>>2]+32>>2]](i,t[t[A+8>>2]+344>>2],r+28|0,i),r=t[A+8>>2],n=r+60|0,o=t[n+4>>2],k=A+140|0,i=k,t[i>>2]=t[n>>2],t[i+4>>2]=o,i=r+52|0,n=t[i+4>>2],t[A+132>>2]=t[i>>2],t[A+136>>2]=n,n=A+132|0,r=t[r+344>>2],(0|yf[t[t[r>>2]+36>>2]](r))>=1)for(G=A+200|0,l=A+204|0,s=A+208|0,o=A+212|0,d=A+216|0,c=A+8|0,h=A+16|0,_=A+136|0;;){if(i=t[l>>2],(0|i)<=-1)for(t[s>>2]<=-1&&(r=t[o>>2],r&&(b[0|d]&&gA(r),t[o>>2]=0),a[0|d]=1,t[s>>2]=0,t[s+4>>2]=0),r=i<<2;t[t[o>>2]+r>>2]=0,r=r+4|0,i=i+1|0,i;){}if(t[l>>2]=0,r=t[t[c>>2]+344>>2],i=t[12+(0|yf[t[t[r>>2]+28>>2]](r))>>2]+(u<<4)|0,r=t[t[i+4>>2]>>2],f=t[t[i>>2]>>2],!((4&b[f+204|0]?f:0)|(4&b[r+204|0]?r:0))&&yf[t[t[A>>2]+56>>2]](A,f,r)&&(r=t[i+8>>2],r&&yf[t[t[r>>2]+16>>2]](r,G),m=t[l>>2],!((0|m)<1)))for(y=t[c>>2],Q=t[o>>2],f=0;;){if(r=t[Q+(f<<2)>>2],R=t[r+780>>2],(0|R)>=1)for(g=t[r+772>>2]==(0|y)?B(-1):B(1),r=r+84|0,p=B(-C[h>>2]),i=0;v=C[r>>2],v<p&&(D=C[r+-8>>2],w=C[r+-12>>2],C[n>>2]=B(B(v*B(g*C[r+-16>>2]))*B(.20000000298023224))+C[n>>2],C[_>>2]=B(B(v*B(g*w))*B(.20000000298023224))+C[_>>2],C[k>>2]=B(B(v*B(g*D))*B(.20000000298023224))+C[k>>2],W=1),r=r+192|0,i=i+1|0,(0|i)<(0|R);){}if(f=f+1|0,!((0|f)<(0|m)))break;}if(u=u+1|0,r=t[t[c>>2]+344>>2],!((0|u)<(0|yf[t[t[r>>2]+36>>2]](r))))break;}return o=n+8|0,l=t[o+4>>2],r=e+56|0,t[r>>2]=t[o>>2],t[r+4>>2]=l,A=t[A+8>>2],o=A+12|0,c=t[o+4>>2],i=e+8|0,t[i>>2]=t[o>>2],t[i+4>>2]=c,s=A+28|0,u=s,f=t[u+4>>2],l=e+24|0,c=l,t[c>>2]=t[u>>2],t[c+4>>2]=f,u=A+44|0,k=u,d=t[k+4>>2],c=e+40|0,f=c,t[f>>2]=t[k>>2],t[f+4>>2]=d,f=t[n+4>>2],n=t[n>>2],t[A+304>>2]=t[A+304>>2]+1,t[e+48>>2]=n,t[e+52>>2]=f,n=t[A+8>>2],t[e>>2]=t[A+4>>2],t[e+4>>2]=n,n=A+20|0,f=n,k=t[f+4>>2],t[e+16>>2]=t[f>>2],t[e+20>>2]=k,f=A+36|0,d=t[f+4>>2],t[e+32>>2]=t[f>>2],t[e+36>>2]=d,k=t[e+4>>2],t[A+4>>2]=t[e>>2],t[A+8>>2]=k,k=t[i+4>>2],t[o>>2]=t[i>>2],t[o+4>>2]=k,i=t[l+4>>2],t[s>>2]=t[l>>2],t[s+4>>2]=i,i=t[e+20>>2],t[n>>2]=t[e+16>>2],t[n+4>>2]=i,i=t[c+4>>2],t[u>>2]=t[c>>2],t[u+4>>2]=i,i=t[e+36>>2],t[f>>2]=t[e+32>>2],t[f+4>>2]=i,n=t[r+4>>2],i=A+60|0,t[i>>2]=t[r>>2],t[i+4>>2]=n,r=t[e+52>>2],A=A+52|0,t[A>>2]=t[e+48>>2],t[A+4>>2]=r,E=e+96|0,W;}function Ha(A,r){var e=B(0),i=B(0),a=B(0),f=B(0),n=B(0),b=0,o=B(0),k=B(0),c=B(0),u=B(0),l=0,s=B(0);e=B(C[A+152>>2]-C[A+132>>2]),a=B(C[A+156>>2]-C[A+136>>2]),i=B(C[A+160>>2]-C[A+140>>2]),o=B(Q(B(B(B(e*e)+B(a*a))+B(i*i)))),o>B(1.1920928955078125e-7)&&(c=C[r+8>>2],n=C[r>>2],u=C[r+4>>2],r=A+132|0,l=t[r+4>>2],b=A+152|0,t[b>>2]=t[r>>2],t[b+4>>2]=l,r=r+8|0,l=t[r+4>>2],b=b+8|0,t[b>>2]=t[r>>2],t[b+4>>2]=l,r=A+152|0,f=e,e=B(B(1)/o),f=B(f*e),k=f,s=B(f*n),f=B(a*e),i=B(i*e),e=B(B(s+B(f*u))+B(i*c)),e=B(e+e),a=B(k-B(n*e)),k=a,i=B(i-B(c*e)),e=B(f-B(u*e)),a=B(B(1)/B(Q(B(B(i*i)+B(B(a*a)+B(e*e)))))),f=B(k*a),k=n,i=B(i*a),e=B(e*a),n=B(B(c*i)+B(B(n*f)+B(u*e))),C[r>>2]=B(o*B(f-B(k*n)))+C[r>>2],r=A+156|0,C[r>>2]=B(o*B(e-B(u*n)))+C[r>>2],A=A+160|0,C[A>>2]=B(o*B(i-B(c*n)))+C[A>>2]);}function za(A,r,e){var i,a,f,n,o,k,c,u,l,s,d,v,g,_,m,R,G,h,y,p,D,w,W,F,Z,Y,N,V,I,J,X,M,x,S,T,U,j,O,H,z=0,P=B(0),L=B(0),K=B(0),q=B(0),$=0,AA=B(0),rA=B(0),eA=0,iA=B(0),aA=B(0),fA=0,nA=B(0),tA=B(0),bA=B(0),oA=B(0),kA=B(0),cA=0,uA=0,lA=0,sA=0,dA=0,vA=0,CA=0,gA=0,_A=B(0),BA=0,mA=B(0),RA=B(0),GA=0,hA=0,yA=B(0),QA=B(0),pA=B(0),DA=B(0),wA=B(0),WA=B(0);for(i=E-240|0,E=i,m=i+188|0,$=m,t[$>>2]=0,t[$+4>>2]=0,o=i+196|0,t[o>>2]=1065353216,k=i+200|0,$=k,t[$>>2]=0,t[$+4>>2]=0,c=i+216|0,t[c>>2]=1065353216,P=C[e>>2],L=C[e+4>>2],K=C[e+8>>2],t[A+164>>2]=0,u=A+160|0,l=A+140|0,C[u>>2]=K+C[l>>2],s=A+156|0,d=A+136|0,C[s>>2]=L+C[d>>2],C[A+152>>2]=P+C[A+132>>2],t[i+176>>2]=1065353216,t[i+180>>2]=0,t[i+184>>2]=0,t[i+208>>2]=0,t[i+212>>2]=0,R=i+236|0,t[R>>2]=0,G=i+228|0,e=G,t[e>>2]=0,t[e+4>>2]=0,h=i+220|0,e=h,t[e>>2]=0,t[e+4>>2]=0,t[i+112>>2]=1065353216,y=i+124|0,e=y,t[e>>2]=0,t[e+4>>2]=0,t[i+116>>2]=0,t[i+120>>2]=0,v=i+132|0,t[v>>2]=1065353216,g=i+136|0,e=g,t[e>>2]=0,t[e+4>>2]=0,t[i+144>>2]=0,t[i+148>>2]=0,_=i+152|0,t[_>>2]=1065353216,p=i+172|0,t[p>>2]=0,D=i+164|0,e=D,t[e>>2]=0,t[e+4>>2]=0,w=i+156|0,e=w,t[e>>2]=0,t[e+4>>2]=0,e=A+152|0,$=A+132|0,Z=i+48|0,a=i+16|0,f=i+160|0,n=i+224|0,lA=-11,Y=A+180|0,N=A+176|0,V=A+168|0,I=A+172|0,J=A+188|0,X=A+184|0,M=A+192|0,x=A+196|0,W=i+100|0,S=i+96|0,T=i+92|0,U=i+88|0,F=i+80|0,j=i+84|0,O=A- -64|0,H=A+250|0,aA=B(1);;){lA=lA+1|0;A:if(lA)if(z=t[$+4>>2],t[n>>2]=t[$>>2],t[n+4>>2]=z,z=t[e+4>>2],t[f>>2]=t[e>>2],t[f+4>>2]=z,sA=$+8|0,fA=sA,eA=t[fA+4>>2],z=n+8|0,t[z>>2]=t[fA>>2],t[z+4>>2]=eA,fA=e+8|0,eA=fA,uA=t[eA+4>>2],z=f+8|0,t[z>>2]=t[eA>>2],t[z+4>>2]=uA,yA=C[$>>2],QA=C[e>>2],pA=C[d>>2],DA=C[s>>2],wA=C[l>>2],WA=C[u>>2],L=C[Y>>2],AA=C[N>>2],P=C[V>>2],K=C[I>>2],t[h>>2]=0,t[i+204>>2]=0,t[m>>2]=0,t[w>>2]=0,t[i+140>>2]=0,t[y>>2]=0,uA=i+212|0,rA=B(B(2)/B(B(B(B(P*P)+B(K*K))+B(AA*AA))+B(L*L))),q=B(AA*rA),tA=B(K*q),bA=B(P*rA),oA=B(L*bA),C[uA>>2]=tA+oA,dA=i+208|0,kA=B(P*q),rA=B(K*rA),iA=B(L*rA),C[dA>>2]=kA-iA,C[k>>2]=tA-oA,vA=i+192|0,tA=B(P*rA),oA=B(L*q),C[vA>>2]=tA+oA,CA=i+184|0,C[CA>>2]=kA+iA,P=B(P*bA),bA=B(K*rA),C[c>>2]=B(1)-B(P+bA),kA=B(AA*q),C[o>>2]=B(1)-B(P+kA),P=C[X>>2],L=C[J>>2],AA=C[M>>2],K=C[x>>2],q=B(B(2)/B(B(B(B(P*P)+B(L*L))+B(AA*AA))+B(K*K))),gA=i+148|0,rA=B(AA*q),iA=B(L*rA),nA=B(P*q),_A=B(K*nA),C[gA>>2]=iA+_A,BA=i+144|0,mA=B(P*rA),q=B(L*q),RA=B(K*q),C[BA>>2]=mA-RA,C[g>>2]=iA-_A,GA=i+128|0,iA=B(P*q),K=B(K*rA),C[GA>>2]=iA+K,hA=i+120|0,C[hA>>2]=mA+RA,P=B(P*nA),L=B(L*q),C[_>>2]=B(1)-B(P+L),nA=P,P=B(AA*rA),C[v>>2]=B(1)-B(nA+P),C[i+180>>2]=tA-oA,C[i+176>>2]=B(1)-B(bA+kA),C[i+116>>2]=iA-K,C[i+112>>2]=B(1)-B(L+P),z=a+24|0,t[z>>2]=0,t[z+4>>2]=0,z=a+16|0,t[z>>2]=0,t[z+4>>2]=0,z=a+8|0,t[z>>2]=0,t[z+4>>2]=0,t[a>>2]=0,t[a+4>>2]=0,t[W>>2]=0,t[W+4>>2]=0,C[S>>2]=wA-WA,C[T>>2]=pA-DA,C[U>>2]=yA-QA,t[F>>2]=0,eA=A+8|0,z=t[eA>>2],t[j>>2]=z,z=t[z+188>>2],t[i+8>>2]=t[z+4>>2],t[i+4>>2]=1065353216,t[i>>2]=23780,t[i+12>>2]=t[z+8>>2],z=A+12|0,cA=t[z>>2],P=B(yf[t[t[cA>>2]+48>>2]](cA)),cA=t[z>>2],yf[t[t[cA>>2]+44>>2]](cA,B(P+C[O>>2])),(C[i+176>>2]!=C[i+112>>2]|C[vA>>2]!=C[GA>>2]|C[dA>>2]!=C[BA>>2]|C[i+180>>2]!=C[i+116>>2]||C[o>>2]!=C[v>>2]|C[uA>>2]!=C[gA>>2]|C[CA>>2]!=C[hA>>2]|C[k>>2]!=C[g>>2]||C[c>>2]!=C[_>>2]|C[R>>2]!=C[p>>2]|C[i+232>>2]!=C[i+168>>2]|C[G>>2]!=C[D>>2]||C[n>>2]!=C[f>>2])&&(b[0|H]?Ta(t[eA>>2],t[z>>2],i+176|0,i+112|0,i,C[r+56>>2]):ma(r,t[z>>2],i+176|0,i+112|0,i,C[r+56>>2])),z=t[z>>2],yf[t[t[z>>2]+44>>2]](z,P),P=C[i+4>>2],P<B(1)&&(z=t[eA>>2],!(4&b[z+204|0])&&yf[t[t[A>>2]+56>>2]](A,z,t[F>>2]))){if(Ha(A,Z),L=B(C[e>>2]-C[$>>2]),K=B(C[s>>2]-C[d>>2]),AA=B(C[u>>2]-C[l>>2]),q=B(B(B(L*L)+B(K*K))+B(AA*AA)),!(q>B(1.1920928955078125e-7)))break A;if(nA=L,L=B(B(1)/B(Q(q))),B(B(B(B(nA*L)*C[A+84>>2])+B(B(K*L)*C[A+88>>2]))+B(B(AA*L)*C[A+92>>2]))<=B(0))break A;if(aA=B(aA-P),aA>B(.009999999776482582))continue;}else if(z=t[e+4>>2],t[$>>2]=t[e>>2],t[$+4>>2]=z,z=t[fA+4>>2],t[sA>>2]=t[fA>>2],t[sA+4>>2]=z,aA=B(aA-P),aA>B(.009999999776482582))continue;break;}E=i+240|0;}function Pa(A){return A|=0,0|yf[t[t[A>>2]+48>>2]](A);}function La(A,r,e,i,n,b){var o=0;return function(A,r,e){t[A+44>>2]=0,t[A+36>>2]=0,t[A+40>>2]=1028443341,t[A+32>>2]=e,t[A+28>>2]=r,t[A+24>>2]=-1,f[A+20>>1]=1,t[A+16>>2]=2139095039,t[A+8>>2]=-1,t[A+12>>2]=-1,t[A>>2]=22472,t[A+4>>2]=12;}(A,r,e),t[A>>2]=23864,e=i+8|0,o=t[e+4>>2],r=A+56|0,t[r>>2]=t[e>>2],t[r+4>>2]=o,r=t[i+4>>2],t[A+48>>2]=t[i>>2],t[A+52>>2]=r,e=i+24|0,o=t[e+4>>2],r=A+72|0,t[r>>2]=t[e>>2],t[r+4>>2]=o,e=t[i+20>>2],r=A- -64|0,t[r>>2]=t[i+16>>2],t[r+4>>2]=e,e=i+40|0,o=t[e+4>>2],r=A+88|0,t[r>>2]=t[e>>2],t[r+4>>2]=o,e=t[i+36>>2],r=A+80|0,t[r>>2]=t[i+32>>2],t[r+4>>2]=e,e=i+56|0,o=t[e+4>>2],r=A+104|0,t[r>>2]=t[e>>2],t[r+4>>2]=o,e=t[i+52>>2],r=A+96|0,t[r>>2]=t[i+48>>2],t[r+4>>2]=e,e=n+8|0,i=t[e+4>>2],r=A+120|0,t[r>>2]=t[e>>2],t[r+4>>2]=i,r=t[n+4>>2],t[A+112>>2]=t[n>>2],t[A+116>>2]=r,e=n+24|0,i=t[e+4>>2],r=A+136|0,t[r>>2]=t[e>>2],t[r+4>>2]=i,e=t[n+20>>2],r=A+128|0,t[r>>2]=t[n+16>>2],t[r+4>>2]=e,e=n+40|0,i=t[e+4>>2],r=A+152|0,t[r>>2]=t[e>>2],t[r+4>>2]=i,e=t[n+36>>2],r=A+144|0,t[r>>2]=t[n+32>>2],t[r+4>>2]=e,e=n+56|0,i=t[e+4>>2],r=A+168|0,t[r>>2]=t[e>>2],t[r+4>>2]=i,e=t[n+52>>2],r=A+160|0,t[r>>2]=t[n+48>>2],t[r+4>>2]=e,r=A+720|0,t[r>>2]=0,t[r+4>>2]=0,r=A+712|0,t[r>>2]=0,t[r+4>>2]=0,r=A+704|0,t[r>>2]=0,t[r+4>>2]=0,r=A+696|0,t[r>>2]=0,t[r+4>>2]=0,r=A+688|0,t[r>>2]=0,t[r+4>>2]=0,t[A+680>>2]=0,t[A+684>>2]=0,t[A+736>>2]=1045220557,r=A+728|0,t[r>>2]=1045220557,t[r+4>>2]=1045220557,t[A+756>>2]=0,r=A+748|0,t[r>>2]=0,t[r+4>>2]=0,r=A+740|0,t[r>>2]=0,t[r+4>>2]=0,t[A+768>>2]=1063675494,r=A+760|0,t[r>>2]=1063675494,t[r+4>>2]=1063675494,t[A+812>>2]=0,r=A+804|0,t[r>>2]=0,t[r+4>>2]=0,t[A+828>>2]=0,r=A+820|0,t[r>>2]=0,t[r+4>>2]=0,a[A+838|0]=0,r=A+836|0,a[0|r]=0,a[r+1|0]=0,t[A+848>>2]=0,r=A+840|0,t[r>>2]=0,t[r+4>>2]=0,a[A+858|0]=0,r=A+856|0,a[0|r]=0,a[r+1|0]=0,t[A+868>>2]=0,r=A+860|0,t[r>>2]=0,t[r+4>>2]=0,t[A+884>>2]=0,r=A+876|0,t[r>>2]=0,t[r+4>>2]=0,t[A+900>>2]=0,r=A+892|0,t[r>>2]=0,t[r+4>>2]=0,r=A+793|0,a[0|r]=0,a[r+1|0]=0,a[r+2|0]=0,a[r+3|0]=0,a[r+4|0]=0,a[r+5|0]=0,a[r+6|0]=0,a[r+7|0]=0,r=A+788|0,t[r>>2]=0,t[r+4>>2]=0,r=A+780|0,t[r>>2]=0,t[r+4>>2]=0,r=A+772|0,t[r>>2]=0,t[r+4>>2]=0,t[A+964>>2]=0,r=A+956|0,t[r>>2]=0,t[r+4>>2]=0,r=A+948|0,t[r>>2]=0,t[r+4>>2]=0,r=A+940|0,t[r>>2]=0,t[r+4>>2]=0,r=A+932|0,t[r>>2]=0,t[r+4>>2]=0,r=A+924|0,t[r>>2]=0,t[r+4>>2]=0,r=A+916|0,t[r>>2]=0,t[r+4>>2]=0,r=A+908|0,t[r>>2]=0,t[r+4>>2]=0,a[A+1032|0]=0,t[A+1028>>2]=0,a[A+1024|0]=0,t[A+1020>>2]=0,a[A+1016|0]=0,t[A+1012>>2]=0,a[A+1008|0]=0,r=A+1e3|0,t[r>>2]=0,t[r+4>>2]=1036831949,a[A+996|0]=0,t[A+992>>2]=0,r=A+984|0,t[r>>2]=0,t[r+4>>2]=1063675494,r=A+976|0,t[r>>2]=0,t[r+4>>2]=1045220557,t[A+968>>2]=1065353216,t[A+972>>2]=-1082130432,t[A+1052>>2]=0,r=A+1044|0,t[r>>2]=0,t[r+4>>2]=0,r=A+1036|0,t[r>>2]=0,t[r+4>>2]=0,a[A+1120|0]=0,t[A+1116>>2]=0,a[A+1112|0]=0,t[A+1108>>2]=0,a[A+1104|0]=0,t[A+1100>>2]=0,a[A+1096|0]=0,r=A+1088|0,t[r>>2]=0,t[r+4>>2]=1036831949,a[A+1084|0]=0,t[A+1080>>2]=0,r=A+1072|0,t[r>>2]=0,t[r+4>>2]=1063675494,r=A+1064|0,t[r>>2]=0,t[r+4>>2]=1045220557,r=A+1056|0,t[r>>2]=1065353216,t[r+4>>2]=-1082130432,t[A+1140>>2]=0,r=A+1132|0,t[r>>2]=0,t[r+4>>2]=0,r=A+1124|0,t[r>>2]=0,t[r+4>>2]=0,a[A+1208|0]=0,t[A+1204>>2]=0,a[A+1200|0]=0,t[A+1196>>2]=0,a[A+1192|0]=0,t[A+1188>>2]=0,a[A+1184|0]=0,r=A+1176|0,t[r>>2]=0,t[r+4>>2]=1036831949,a[A+1172|0]=0,t[A+1168>>2]=0,r=A+1160|0,t[r>>2]=0,t[r+4>>2]=1063675494,r=A+1152|0,t[r>>2]=0,t[r+4>>2]=1045220557,r=A+1144|0,t[r>>2]=1065353216,t[r+4>>2]=-1082130432,t[A+1228>>2]=0,r=A+1220|0,t[r>>2]=0,t[r+4>>2]=0,r=A+1212|0,t[r>>2]=0,t[r+4>>2]=0,t[A+1456>>2]=0,t[A+1232>>2]=b,Ka(A,t[A+28>>2]+4|0,t[A+32>>2]+4|0),A;}function Ka(A,r,e){var i=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),y=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0);Z=C[r+52>>2],Y=C[r+56>>2],s=C[A+96>>2],d=C[A+100>>2],v=C[A+104>>2],i=C[r+20>>2],f=C[r+24>>2],g=C[A- -64>>2],_=C[A+80>>2],m=C[A+52>>2],R=C[A+68>>2],y=C[A+84>>2],p=C[A+56>>2],n=C[r+36>>2],D=C[A+72>>2],b=C[r+40>>2],w=C[A+88>>2],F=C[r+48>>2],o=C[r+8>>2],k=C[r>>2],c=C[r+4>>2],u=C[r+16>>2],W=C[A+48>>2],l=C[r+32>>2],t[A+1296>>2]=0,t[A+1280>>2]=0,t[A+1264>>2]=0,t[A+1248>>2]=0,C[A+1276>>2]=B(B(p*l)+B(D*n))+B(w*b),C[A+1272>>2]=B(B(m*l)+B(R*n))+B(y*b),C[A+1268>>2]=B(B(W*l)+B(g*n))+B(_*b),C[A+1260>>2]=B(B(p*u)+B(D*i))+B(w*f),C[A+1256>>2]=B(B(m*u)+B(R*i))+B(y*f),C[A+1252>>2]=B(B(W*u)+B(g*i))+B(_*f),C[A+1244>>2]=B(B(k*p)+B(c*D))+B(o*w),C[A+1240>>2]=B(B(k*m)+B(c*R))+B(o*y),C[A+1236>>2]=B(B(W*k)+B(g*c))+B(_*o),C[A+1292>>2]=Y+B(B(B(l*s)+B(n*d))+B(b*v)),C[A+1288>>2]=Z+B(B(B(u*s)+B(i*d))+B(f*v)),C[A+1284>>2]=F+B(B(B(k*s)+B(c*d))+B(o*v)),Z=C[e+52>>2],Y=C[e+56>>2],s=C[A+160>>2],d=C[A+164>>2],v=C[A+168>>2],i=C[e+20>>2],f=C[e+24>>2],g=C[A+128>>2],_=C[A+144>>2],m=C[A+116>>2],R=C[A+132>>2],y=C[A+148>>2],p=C[A+120>>2],D=C[A+136>>2],n=C[e+36>>2],w=C[A+152>>2],b=C[e+40>>2],F=C[e+48>>2],o=C[e+8>>2],k=C[e>>2],c=C[e+4>>2],u=C[e+16>>2],W=C[A+112>>2],l=C[e+32>>2],t[A+1360>>2]=0,t[A+1344>>2]=0,t[A+1328>>2]=0,t[A+1312>>2]=0,C[A+1340>>2]=B(B(p*l)+B(D*n))+B(w*b),C[A+1336>>2]=B(B(m*l)+B(R*n))+B(y*b),C[A+1332>>2]=B(B(W*l)+B(g*n))+B(_*b),C[A+1324>>2]=B(B(p*u)+B(D*i))+B(w*f),C[A+1320>>2]=B(B(m*u)+B(R*i))+B(y*f),C[A+1316>>2]=B(B(W*u)+B(g*i))+B(_*f),C[A+1308>>2]=B(B(k*p)+B(c*D))+B(o*w),C[A+1304>>2]=B(B(k*m)+B(c*R))+B(o*y),C[A+1300>>2]=B(B(W*k)+B(g*c))+B(_*o),C[A+1356>>2]=Y+B(B(B(l*s)+B(n*d))+B(b*v)),C[A+1352>>2]=Z+B(B(B(u*s)+B(i*d))+B(f*v)),C[A+1348>>2]=F+B(B(B(k*s)+B(c*d))+B(o*v)),function(A){var r=B(0),e=B(0),i=B(0),a=B(0),f=B(0),n=0,b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0);if(t[A+1440>>2]=0,b=C[A+1256>>2],o=C[A+1276>>2],k=C[A+1260>>2],c=C[A+1272>>2],g=B(B(b*o)-B(k*c)),e=C[A+1236>>2],i=C[A+1240>>2],u=C[A+1268>>2],l=C[A+1252>>2],_=B(B(k*u)-B(o*l)),f=B(B(c*l)-B(b*u)),a=C[A+1244>>2],r=B(B(1)/B(B(B(g*e)+B(i*_))+B(f*a))),s=B(C[A+1356>>2]-C[A+1292>>2]),d=B(C[A+1348>>2]-C[A+1284>>2]),v=B(C[A+1352>>2]-C[A+1288>>2]),f=B(B(s*B(B(B(b*e)-B(l*i))*r))+B(B(d*B(f*r))+B(v*B(B(B(u*i)-B(c*e))*r)))),C[A+1436>>2]=f,e=B(B(s*B(B(B(l*a)-B(k*e))*r))+B(B(d*B(_*r))+B(v*B(B(B(o*e)-B(u*a))*r)))),C[A+1432>>2]=e,r=B(B(s*B(B(B(k*i)-B(b*a))*r))+B(B(d*B(g*r))+B(v*B(B(B(c*a)-B(o*i))*r)))),C[A+1428>>2]=r,C[A+940>>2]=r,i=C[A+680>>2],a=C[A+696>>2],i>a?t[A+908>>2]=0:(C[A+908>>2]=r-i,n=3,i!=a&&(C[A+924>>2]=r-a,n=4)),C[A+944>>2]=e,t[A+956>>2]=n,r=C[A+684>>2],i=C[A+700>>2],r>i?(t[A+912>>2]=0,n=0):(C[A+912>>2]=e-r,n=3,r!=i&&(C[A+928>>2]=e-i,n=4)),C[A+948>>2]=f,t[A+960>>2]=n,r=C[A+688>>2],e=C[A+704>>2],r>e)return t[A+916>>2]=0,void(t[A+964>>2]=0);C[A+916>>2]=f-r,r!=e?(C[A+932>>2]=f-e,t[A+964>>2]=4):t[A+964>>2]=3;}(A),function(A){var r=B(0),e=B(0),i=B(0),a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=0,s=B(0),d=B(0),v=0,g=B(0),_=B(0),m=B(0),R=B(0),y=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=0;l=E-48|0,E=l,u=C[A+1332>>2],g=C[A+1316>>2],_=C[A+1336>>2],m=C[A+1304>>2],R=C[A+1320>>2],y=C[A+1340>>2],p=C[A+1308>>2],D=C[A+1324>>2],f=C[A+1244>>2],c=C[A+1256>>2],n=C[A+1272>>2],b=C[A+1240>>2],i=C[A+1268>>2],o=C[A+1260>>2],a=C[A+1252>>2],k=C[A+1276>>2],w=C[A+1300>>2],r=C[A+1236>>2],t[l+44>>2]=0,t[l+28>>2]=0,Z=B(B(c*k)-B(o*n)),s=B(B(o*i)-B(k*a)),d=B(B(n*a)-B(c*i)),e=B(B(1)/B(B(B(r*Z)+B(b*s))+B(d*f))),d=B(d*e),W=B(B(B(i*b)-B(n*r))*e),F=B(B(B(c*r)-B(a*b))*e),C[l+40>>2]=B(B(p*d)+B(D*W))+B(y*F),C[l+36>>2]=B(B(m*d)+B(W*R))+B(F*_),s=B(s*e),i=B(B(B(k*r)-B(i*f))*e),r=B(B(B(a*f)-B(o*r))*e),C[l+24>>2]=B(B(p*s)+B(D*i))+B(y*r),C[l+20>>2]=B(B(m*s)+B(i*R))+B(r*_),t[l+12>>2]=0,C[l+32>>2]=B(u*F)+B(B(w*d)+B(g*W)),C[l+16>>2]=B(u*r)+B(B(w*s)+B(g*i)),r=B(Z*e),n=B(B(B(n*f)-B(k*b))*e),e=B(B(B(o*b)-B(c*f))*e),C[l+8>>2]=B(B(p*r)+B(D*n))+B(y*e),C[l+4>>2]=B(B(r*m)+B(n*R))+B(e*_),C[l>>2]=B(u*e)+B(B(w*r)+B(g*n)),Y=A;A:{r:{e:{i:{a:{f:{n:{if(v=t[A+1232>>2],v>>>0<=5){t:{switch(v-1|0){default:!function(A,r){var e=B(0),i=B(0),a=0,f=B(0);b:{if(e=C[A+32>>2],e<B(1)){if(!(e>B(-1)))break b;return a=r,f=Ci(B(-C[A+36>>2]),C[A+40>>2]),C[a>>2]=f,a=r,f=Ea(B(G(B(h(C[A+32>>2],B(-1))),B(1)))),C[a+4>>2]=f,a=r,f=Ci(B(-C[A+16>>2]),C[A>>2]),void(C[a+8>>2]=f);}return e=C[A+20>>2],i=C[A+4>>2],t[r+4>>2]=1070141403,a=r,f=Ci(i,e),C[a>>2]=f,void(C[r+8>>2]=0);}e=C[A+20>>2],i=C[A+4>>2],t[r+4>>2]=-1077342245,a=r,f=B(-Ci(i,e)),C[a>>2]=f,C[r+8>>2]=0;}(l,A+1364|0);break t;case 0:!function(A,r){var e=B(0),i=B(0),a=0,f=B(0);b:{if(e=C[A+16>>2],e<B(1)){if(!(e>B(-1)))break b;return a=r,f=Ci(C[A+24>>2],C[A+20>>2]),C[a>>2]=f,a=r,f=Ci(C[A+32>>2],C[A>>2]),C[a+4>>2]=f,a=r,f=Ea(B(G(B(h(B(-C[A+16>>2]),B(-1))),B(1)))),void(C[a+8>>2]=f);}return e=C[A+40>>2],i=C[A+8>>2],t[r+4>>2]=0,a=r,f=Ci(B(-i),e),C[a>>2]=f,void(C[r+8>>2]=-1.5707963705062866);}e=C[A+40>>2],i=C[A+8>>2],t[r+4>>2]=0,a=r,f=B(-Ci(B(-i),e)),C[a>>2]=f,C[r+8>>2]=1.5707963705062866;}(l,A+1364|0);break t;case 1:!function(A,r){var e=B(0),i=0,a=B(0);b:{if(e=C[A+36>>2],e<B(1)){if(!(e>B(-1)))break b;return i=r,a=Ea(B(G(B(h(B(-e),B(-1))),B(1)))),C[i>>2]=a,i=r,a=Ci(C[A+32>>2],C[A+40>>2]),C[i+4>>2]=a,i=r,a=Ci(C[A+4>>2],C[A+20>>2]),void(C[i+8>>2]=a);}return t[r>>2]=-1077342245,i=r,a=Ci(B(-C[A+16>>2]),C[A>>2]),C[i+4>>2]=a,void(C[r+8>>2]=0);}t[r>>2]=1070141403,i=r,a=B(-Ci(B(-C[A+16>>2]),C[A>>2])),C[i+4>>2]=a,C[r+8>>2]=0;}(l,A+1364|0);break t;case 2:!function(A,r){var e=B(0),i=0,a=B(0);b:{if(e=C[A+4>>2],e<B(1)){if(!(e>B(-1)))break b;return i=r,a=Ci(B(-C[A+36>>2]),C[A+20>>2]),C[i>>2]=a,i=r,a=Ci(B(-C[A+8>>2]),C[A>>2]),C[i+4>>2]=a,i=r,a=Ea(B(G(B(h(C[A+4>>2],B(-1))),B(1)))),void(C[i+8>>2]=a);}return t[r>>2]=0,i=r,a=Ci(C[A+24>>2],C[A+40>>2]),C[i+4>>2]=a,void(C[r+8>>2]=1.5707963705062866);}t[r>>2]=0,i=r,a=B(-Ci(C[A+24>>2],C[A+40>>2])),C[i+4>>2]=a,C[r+8>>2]=-1.5707963705062866;}(l,A+1364|0);break t;case 3:!function(A,r){var e=B(0),i=0,a=B(0);b:{if(e=C[A+24>>2],e<B(1)){if(!(e>B(-1)))break b;return i=r,a=Ea(B(G(B(h(e,B(-1))),B(1)))),C[i>>2]=a,i=r,a=Ci(B(-C[A+8>>2]),C[A+40>>2]),C[i+4>>2]=a,i=r,a=Ci(B(-C[A+16>>2]),C[A+20>>2]),void(C[i+8>>2]=a);}return t[r>>2]=1070141403,t[r+4>>2]=0,i=r,a=Ci(C[A+32>>2],C[A>>2]),void(C[i+8>>2]=a);}t[r>>2]=-1077342245,t[r+4>>2]=0,i=r,a=B(-Ci(C[A+32>>2],C[A>>2])),C[i+8>>2]=a;}(l,A+1364|0);break t;case 4:}!function(A,r){var e=B(0),i=0,a=B(0);b:{if(e=C[A+8>>2],e<B(1)){if(!(e>B(-1)))break b;return i=r,a=Ci(C[A+24>>2],C[A+40>>2]),C[i>>2]=a,i=r,a=Ea(B(G(B(h(B(-C[A+8>>2]),B(-1))),B(1)))),C[i+4>>2]=a,i=r,a=Ci(C[A+4>>2],C[A>>2]),void(C[i+8>>2]=a);}return t[r>>2]=0,t[r+4>>2]=-1077342245,i=r,a=Ci(B(-C[A+16>>2]),B(-C[A+32>>2])),void(C[i+8>>2]=a);}t[r>>2]=0,t[r+4>>2]=1070141403,i=r,a=B(-Ci(C[A+16>>2],C[A+32>>2])),C[i+8>>2]=a;}(l,A+1364|0);}v=t[A+1232>>2];}if(v>>>0<=5){switch(v-1|0){case 4:break e;case 3:break i;case 2:break a;case 1:break f;case 0:break n;}t[A+1408>>2]=0,t[A+1424>>2]=0,t[A+1392>>2]=0,e=C[A+1316>>2],a=C[A+1244>>2],n=C[A+1300>>2],k=C[A+1260>>2],f=B(B(e*a)-B(n*k)),C[A+1404>>2]=f,u=C[A+1276>>2],i=C[A+1332>>2],b=B(B(n*u)-B(a*i)),C[A+1400>>2]=b,r=B(B(i*k)-B(e*u)),C[A+1396>>2]=r,c=B(B(n*b)-B(e*r)),C[A+1420>>2]=c,n=B(B(i*r)-B(n*f)),C[A+1416>>2]=n,i=B(B(e*f)-B(i*b)),C[A+1412>>2]=i,o=B(B(k*r)-B(a*b)),C[A+1388>>2]=o,a=B(B(a*f)-B(u*r)),C[A+1384>>2]=a,e=B(B(u*b)-B(k*f));break r;}c=C[A+1420>>2],n=C[A+1416>>2],i=C[A+1412>>2],f=C[A+1404>>2],b=C[A+1400>>2],r=C[A+1396>>2],o=C[A+1388>>2],a=C[A+1384>>2],e=C[A+1380>>2];break A;}t[A+1424>>2]=0,t[A+1408>>2]=0,t[A+1392>>2]=0,e=C[A+1300>>2],k=C[A+1256>>2],r=C[A+1316>>2],a=C[A+1240>>2],c=B(B(e*k)-B(r*a)),C[A+1420>>2]=c,o=C[A+1332>>2],u=C[A+1272>>2],n=B(B(a*o)-B(e*u)),C[A+1416>>2]=n,i=B(B(r*u)-B(o*k)),C[A+1412>>2]=i,f=B(B(r*i)-B(e*n)),C[A+1404>>2]=f,b=B(B(e*c)-B(o*i)),C[A+1400>>2]=b,r=B(B(o*n)-B(r*c)),C[A+1396>>2]=r,o=B(B(a*n)-B(k*i)),C[A+1388>>2]=o,a=B(B(u*i)-B(a*c)),C[A+1384>>2]=a,e=B(B(k*c)-B(u*n));break r;}t[A+1424>>2]=0,t[A+1408>>2]=0,t[A+1392>>2]=0,f=C[A+1304>>2],r=C[A+1260>>2],b=C[A+1320>>2],k=C[A+1244>>2],o=B(B(f*r)-B(b*k)),C[A+1388>>2]=o,i=C[A+1336>>2],u=C[A+1276>>2],a=B(B(k*i)-B(f*u)),C[A+1384>>2]=a,e=B(B(b*u)-B(i*r)),C[A+1380>>2]=e,c=B(B(b*e)-B(f*a)),C[A+1420>>2]=c,n=B(B(f*o)-B(i*e)),C[A+1416>>2]=n,i=B(B(i*a)-B(b*o)),C[A+1412>>2]=i,f=B(B(k*a)-B(r*e)),C[A+1404>>2]=f,b=B(B(u*e)-B(k*o)),C[A+1400>>2]=b,r=B(B(r*o)-B(u*a)),C[A+1396>>2]=r;break A;}t[A+1424>>2]=0,t[A+1408>>2]=0,t[A+1392>>2]=0,e=C[A+1236>>2],k=C[A+1320>>2],r=C[A+1252>>2],a=C[A+1304>>2],c=B(B(e*k)-B(r*a)),C[A+1420>>2]=c,o=C[A+1268>>2],u=C[A+1336>>2],n=B(B(a*o)-B(e*u)),C[A+1416>>2]=n,i=B(B(r*u)-B(o*k)),C[A+1412>>2]=i,f=B(B(r*i)-B(e*n)),C[A+1404>>2]=f,b=B(B(e*c)-B(o*i)),C[A+1400>>2]=b,r=B(B(o*n)-B(r*c)),C[A+1396>>2]=r,o=B(B(a*n)-B(k*i)),C[A+1388>>2]=o,a=B(B(u*i)-B(a*c)),C[A+1384>>2]=a,e=B(B(k*c)-B(u*n));break r;}t[A+1424>>2]=0,t[A+1408>>2]=0,t[A+1392>>2]=0,f=C[A+1240>>2],r=C[A+1324>>2],b=C[A+1256>>2],k=C[A+1308>>2],o=B(B(f*r)-B(b*k)),C[A+1388>>2]=o,i=C[A+1272>>2],u=C[A+1340>>2],a=B(B(k*i)-B(f*u)),C[A+1384>>2]=a,e=B(B(b*u)-B(i*r)),C[A+1380>>2]=e,c=B(B(b*e)-B(f*a)),C[A+1420>>2]=c,n=B(B(f*o)-B(i*e)),C[A+1416>>2]=n,i=B(B(i*a)-B(b*o)),C[A+1412>>2]=i,f=B(B(k*a)-B(r*e)),C[A+1404>>2]=f,b=B(B(u*e)-B(k*o)),C[A+1400>>2]=b,r=B(B(r*o)-B(u*a)),C[A+1396>>2]=r;break A;}t[A+1408>>2]=0,t[A+1424>>2]=0,t[A+1392>>2]=0,e=C[A+1252>>2],a=C[A+1308>>2],n=C[A+1236>>2],k=C[A+1324>>2],f=B(B(e*a)-B(n*k)),C[A+1404>>2]=f,u=C[A+1340>>2],i=C[A+1268>>2],b=B(B(n*u)-B(a*i)),C[A+1400>>2]=b,r=B(B(i*k)-B(e*u)),C[A+1396>>2]=r,c=B(B(n*b)-B(e*r)),C[A+1420>>2]=c,n=B(B(i*r)-B(n*f)),C[A+1416>>2]=n,i=B(B(e*f)-B(i*b)),C[A+1412>>2]=i,o=B(B(k*r)-B(a*b)),C[A+1388>>2]=o,a=B(B(a*f)-B(u*r)),C[A+1384>>2]=a,e=B(B(u*b)-B(k*f));}C[Y+1380>>2]=e;}k=c,c=B(B(1)/B(Q(B(B(B(i*i)+B(n*n))+B(c*c))))),C[A+1420>>2]=k*c,C[A+1416>>2]=n*c,C[A+1412>>2]=i*c,c=f,f=B(B(1)/B(Q(B(B(B(r*r)+B(b*b))+B(f*f))))),C[A+1404>>2]=c*f,C[A+1400>>2]=b*f,C[A+1396>>2]=r*f,f=B(B(1)/B(Q(B(B(B(e*e)+B(a*a))+B(o*o))))),C[A+1388>>2]=o*f,C[A+1384>>2]=a*f,C[A+1380>>2]=e*f,E=l+48|0;}(A),f=C[t[A+28>>2]+404>>2],i=C[t[A+32>>2]+404>>2],a[A+1452|0]=f<B(1.1920928955078125e-7)|i<B(1.1920928955078125e-7),F=i,i=B(f+i),i=i>B(0)?B(F/i):B(.5),C[A+1444>>2]=i,C[A+1448>>2]=B(1)-i;}function qa(A,r){var e,i=B(0),a=B(0),f=B(0),n=B(0),b=B(0);a=C[1364+((r<<2)+A|0)>>2],e=_(r,88)+A|0,f=C[e+968>>2],n=C[e+972>>2];A:if(!(f>=n)){r:{e:{i:{a:{if(a<f){if(i=Wa(B(f-a)),!(i<B(-3.1415927410125732)))break a;i=B(i+B(6.2831854820251465));break i;}if(!(a>n))break A;if(i=Wa(B(a-n)),!(i<B(-3.1415927410125732)))break e;i=B(i+B(6.2831854820251465));break r;}i>B(3.1415927410125732)&&(i=B(i+B(-6.2831854820251465)));}b=B(m(i)),i=Wa(B(n-a)),i<B(-3.1415927410125732)?i=B(i+B(6.2831854820251465)):i>B(3.1415927410125732)&&(i=B(i+B(-6.2831854820251465))),a=b<B(m(i))?a:B(a+B(6.2831854820251465));break A;}i>B(3.1415927410125732)&&(i=B(i+B(-6.2831854820251465)));}b=B(m(i)),i=Wa(B(a-f)),i<B(-3.1415927410125732)?i=B(i+B(6.2831854820251465)):i>B(3.1415927410125732)&&(i=B(i+B(-6.2831854820251465))),a=B(m(i))<b?B(a+B(-6.2831854820251465)):a;}if(C[e+1048>>2]=a,f>n)return A=_(r,88)+A|0,t[A+1040>>2]=0,void(t[A+1052>>2]=0);A=_(r,88)+A|0,C[A+1040>>2]=a-f,f!=n?(t[A+1052>>2]=4,C[A+1044>>2]=a-n):t[A+1052>>2]=3;}function $a(A,r,e,i,a,f,n,o,k,c,u,l,s){var d=B(0),v=B(0),g=B(0),m=0,R=0,y=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0);c=_(t[k+24>>2],c);A:{r:{e:{i:{if(m=t[r+84>>2],3!=(0|m)){if(4!=(0|m))break A;if(!l)break i;y=C[n+8>>2],p=C[n>>2],D=C[n+4>>2],W=C[o+8>>2],v=C[u+8>>2],F=C[o>>2],d=C[u>>2],w=C[o+4>>2],g=C[u+4>>2],Af(A,e,i,k,c,u,l,s),v=B(B(B(B(p*d)+B(D*g))+B(y*v))-B(B(B(d*F)+B(g*w))+B(v*W)));break e;}Af(A,e,i,k,c,u,l,s),m=c<<2,C[m+t[k+28>>2]>>2]=B(B(C[k>>2]*C[r+12>>2])*C[r+72>>2])*B(0|(l?-1:1)),t[m+t[k+36>>2]>>2]=-8388609,t[m+t[k+40>>2]>>2]=2139095039,m=r+16|0,R=1;break r;}y=C[a+8>>2],p=C[a>>2],D=C[a+4>>2],W=C[f+8>>2],v=C[u+8>>2],F=C[f>>2],d=C[u>>2],w=C[f+4>>2],g=C[u+4>>2],Af(A,e,i,k,c,u,0,s),v=B(B(B(B(p*d)+B(D*g))+B(y*v))-B(B(B(d*F)+B(g*w))+B(v*W)));}R=t[k+28>>2]+(c<<2)|0,y=B(0|(l?-1:1)),d=B(B(B(C[k>>2]*C[r+12>>2])*C[r+72>>2])*y),C[R>>2]=d,g=B(d-B(v*C[r+12>>2]));e:if(l){if(!(g>B(0)))break e;if(g=d,d=B(-B(v*C[r+8>>2])),!(g<d))break e;C[R>>2]=d;}else g<B(0)&&(g=d,d=B(-B(v*C[r+8>>2])),g>d&&(C[R>>2]=d));R=c<<2,C[R+t[k+36>>2]>>2]=B(l?0:-3.4028234663852886e38),C[R+t[k+40>>2]>>2]=B(l?3.4028234663852886e38:0),t[R+t[k+32>>2]>>2]=t[r+16>>2],c=t[k+24>>2]+c|0,Af(A,e,i,k,c,u,l,s),R=t[k+28>>2]+(c<<2)|0,m=r+12|0,d=B(B(B(C[k>>2]*C[m>>2])*C[r+76>>2])*y),C[R>>2]=d,g=B(d-B(v*C[m>>2])),m=r+16|0;e:if(l){if(!(g<B(0)))break e;if(v=B(-B(v*C[r+8>>2])),!(d>v))break e;C[R>>2]=v;}else g>B(0)&&(v=B(-B(v*C[r+8>>2])),d<v&&(C[R>>2]=v));R=c<<2,C[R+t[k+36>>2]>>2]=B(l?-3.4028234663852886e38:0),C[R+t[k+40>>2]>>2]=B(l?0:3.4028234663852886e38),R=2;}t[t[k+32>>2]+(c<<2)>>2]=t[m>>2],c=t[k+24>>2]+c|0;}return b[r+28|0]&&(!b[r+40|0]&&(Af(A,e,i,k,c,u,l,s),v=C[r+32>>2],v=Za(C[r+80>>2],C[r>>2],C[r+4>>2],l?v:B(-v),B(C[k>>2]*C[r+20>>2])),m=c<<2,C[m+t[k+28>>2]>>2]=v*C[r+32>>2],C[m+t[k+36>>2]>>2]=-C[r+36>>2],t[m+t[k+40>>2]>>2]=t[r+36>>2],t[m+t[k+32>>2]>>2]=t[r+24>>2],R=R+1|0,c=t[k+24>>2]+c|0,!b[r+28|0]|!b[r+40|0])||(d=C[r+44>>2],v=B(C[r+80>>2]-d),l&&(m=v>B(3.1415927410125732),d=m?B(d+B(6.2831854820251465)):d,v=m?B(v+B(-6.2831854820251465)):v,v<B(-3.1415927410125732)&&(d=B(d+B(-6.2831854820251465)),v=B(v+B(6.2831854820251465)))),Af(A,e,i,k,c,u,l,s),g=B(0),y=C[r+32>>2],p=v<B(0)?B(-y):y,v!=B(0)&&(D=B(-p),w=C[r+80>>2],g=C[r>>2],y=C[r+4>>2],g>y?(y=v<B(0)?d:B(3.4028234663852886e38),d=v>B(0)?d:B(-3.4028234663852886e38)):(y=v<B(0)&&d<y?d:y,d=v>B(0)&&d>g?d:g),g=Za(w,d,y,D,B(C[k>>2]*C[r+20>>2]))),m=c<<2,C[m+t[k+28>>2]>>2]=B(p*g)*B(0|(l?-1:1)),C[m+t[k+36>>2]>>2]=-C[r+36>>2],t[m+t[k+40>>2]>>2]=t[r+36>>2],t[m+t[k+32>>2]>>2]=t[r+24>>2],R=R+1|0,c=t[k+24>>2]+c|0)),b[r+48|0]&&(w=C[r+68>>2],d=C[r+80>>2],Af(A,e,i,k,c,u,l,s),v=C[k>>2],g=C[r+52>>2],y=C[r+60>>2],w=B(d-w),l?(W=C[u+8>>2],F=B(C[n+8>>2]*W),d=C[u>>2],p=C[u+4>>2],D=B(B(C[n>>2]*d)+B(C[n+4>>2]*p))):(W=C[u+8>>2],F=B(C[a+8>>2]*W),o=f,d=C[u>>2],p=C[u+4>>2],D=B(B(C[a>>2]*d)+B(C[a+4>>2]*p))),p=B(B(D+F)-B(B(B(d*C[o>>2])+B(p*C[o+4>>2]))+B(W*C[o+8>>2]))),v=B(B(1)/v),d=B(B(1)/C[t[A+32>>2]+404>>2]),D=B(B(1)/C[t[A+28>>2]+404>>2]),d=D>d?d:D,!b[r+56|0]|B(v*B(Q(B(g/d))))>B(.25)^1||(g=B(B(B(B(B(1)/v)/v)*B(.0625))*d)),A=c<<2,D=B(v*B(w*g)),g=B(p*(B(y*v)>d&&b[r+64|0]?B(d/v):y)),d=B(0|(l?-1:1)),g=B(v*B(g*d)),v=B(D-g),C[A+t[k+28>>2]>>2]=p+B(v*d),g=B(-g),r=v<g,d=r?g:v,v=r?v:g,l?(C[A+t[k+36>>2]>>2]=G(B(-d),B(0)),d=B(-v)):C[A+t[k+36>>2]>>2]=G(v,B(0)),A=c<<2,C[A+t[k+40>>2]>>2]=h(d,B(0)),t[A+t[k+32>>2]>>2]=0,R=R+1|0),R;}function Af(A,r,e,i,a,f,n,o){var k,c,u,l,s,d=B(0),v=B(0),g=B(0),_=0,m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0);k=a<<2,_=t[(n?12:8)+i>>2],t[k+_>>2]=t[f>>2],c=a+1|0,u=c<<2,t[_+u>>2]=t[f+4>>2],l=a+2|0,s=l<<2,t[_+s>>2]=t[f+8>>2],_=t[(n?20:16)+i>>2],C[_+k>>2]=-C[f>>2],C[_+u>>2]=-C[f+4>>2],C[_+s>>2]=-C[f+8>>2],n||(n=E-16|0,t[n+12>>2]=0,d=B(C[A+1284>>2]-C[r+48>>2]),v=C[f+4>>2],m=B(C[A+1288>>2]-C[r+52>>2]),g=C[f>>2],h=B(B(d*v)-B(m*g)),C[n+8>>2]=h,R=B(C[A+1292>>2]-C[r+56>>2]),G=d,d=C[f+8>>2],y=B(B(g*R)-B(G*d)),C[n+4>>2]=y,R=B(B(m*d)-B(R*v)),C[n>>2]=R,Q=B(C[A+1348>>2]-C[e+48>>2]),p=B(C[A+1352>>2]-C[e+52>>2]),m=B(B(v*Q)-B(g*p)),G=B(C[A+1356>>2]-C[e+56>>2]),g=B(B(g*G)-B(Q*d)),v=B(B(p*d)-B(G*v)),!b[A+1452|0]|o||(d=C[A+1444>>2],C[n+8>>2]=h*d,C[n+4>>2]=y*d,C[n>>2]=R*d,d=C[A+1448>>2],m=B(m*d),g=B(g*d),v=B(v*d)),r=t[n+4>>2],e=a<<2,A=e+t[i+12>>2]|0,t[A>>2]=t[n>>2],t[A+4>>2]=r,t[A+8>>2]=t[n+8>>2],A=t[i+20>>2],C[A+e>>2]=-v,C[A+(c<<2)>>2]=-g,C[A+(l<<2)>>2]=-m);}function rf(A){A|=0,t[A>>2]=22472,gA(A);}function ef(A){return A|=0,B(C[A>>2]);}function af(A){return A|=0,B(C[A+4>>2]);}function ff(A){return A|=0,B(C[A+8>>2]);}function nf(A){return A|=0,A+48|0;}function tf(A,r){var e,i=B(0),a=0,f=0,n=B(0),b=0,k=B(0),c=0,u=0,s=B(0),d=0;e=E-16|0,i=C[A>>2],k=C[A+20>>2],n=C[A+40>>2],s=B(B(i+k)+n),s>B(0)?(k=B(Q(B(s+B(1)))),i=B(B(.5)/k),n=B(i*B(C[A+16>>2]-C[A+4>>2])),C[e+8>>2]=n,l(n),a=o(0),n=B(i*B(C[A+8>>2]-C[A+32>>2])),C[e+4>>2]=n,i=B(i*B(C[A+36>>2]-C[A+24>>2])),C[e>>2]=i,l(i),A=o(0),i=B(k*B(.5)),C[e+12>>2]=i,l(i),f=o(0),l(n),b=o(0)):(a=i<k?k<n?2:1:(i<n)<<1,b=a<<2,c=(a<<4)+A|0,f=(a+1>>>0)%3|0,u=(f<<4)+A|0,f<<=2,d=A,A=(a+2>>>0)%3|0,a=d+(A<<4)|0,A<<=2,i=B(Q(B(B(B(C[b+c>>2]-C[u+f>>2])-C[a+A>>2])+B(1)))),C[(b|e)>>2]=i*B(.5),i=B(B(.5)/i),C[e+12>>2]=B(C[a+f>>2]-C[A+u>>2])*i,C[(e|f)>>2]=i*B(C[b+u>>2]+C[f+c>>2]),C[(A|e)>>2]=i*B(C[a+b>>2]+C[A+c>>2]),f=t[e+12>>2],a=t[e+8>>2],A=t[e>>2],b=t[e+4>>2]),t[r+12>>2]=f,t[r+8>>2]=a,t[r+4>>2]=b,t[r>>2]=A;}function bf(A){A|=0,A&&yf[t[t[A>>2]+4>>2]](A);}function of(A,r){A|=0,r|=0,t[A+12>>2]=r;}function kf(A,r){A|=0,r=B(r),C[A+4>>2]=r;}function cf(A,r){A|=0,r|=0,t[A+8>>2]=r;}function uf(A){return A|=0,A+24|0;}function lf(A){var r;A|=0,r=t[A+12>>2],r&&(b[A+16|0]&&gA(r),t[A+12>>2]=0),a[A+16|0]=1,t[A+12>>2]=0,A=A+4|0,t[A>>2]=0,t[A+4>>2]=0;}function sf(A){return A|=0,A+32|0;}function df(A){return A|=0,A- -64|0;}function vf(A){return A|=0,0|yf[t[t[A>>2]+36>>2]](A);}function Cf(A,r){A|=0,r|=0,yf[t[t[A>>2]+60>>2]](A,r);}function gf(A,r,e){var i=B(0),a=B(0),f=B(0),n=B(0),t=0,b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0);i=C[A+404>>2],i!=B(0)&&(f=C[r+8>>2],a=C[r+4>>2],n=C[A+408>>2],C[A+372>>2]=B(i*B(C[r>>2]*n))+C[A+372>>2],t=A+376|0,b=a,a=C[A+412>>2],C[t>>2]=B(i*B(b*a))+C[t>>2],t=A+380|0,b=i,i=C[A+416>>2],C[t>>2]=B(b*B(f*i))+C[t>>2],c=C[A+612>>2],u=C[A+364>>2],l=C[A+356>>2],s=C[A+360>>2],d=C[A+608>>2],v=C[A+348>>2],g=C[A+340>>2],_=C[A+344>>2],k=C[e+4>>2],f=B(i*C[r+8>>2]),a=B(a*C[r+4>>2]),o=C[e+8>>2],i=B(B(k*f)-B(a*o)),n=B(n*C[r>>2]),b=B(n*o),o=C[e>>2],f=B(b-B(f*o)),a=B(B(a*o)-B(n*k)),C[A+388>>2]=B(B(B(B(C[A+324>>2]*i)+B(C[A+328>>2]*f))+B(a*C[A+332>>2]))*C[A+604>>2])+C[A+388>>2],r=A+392|0,C[r>>2]=B(d*B(B(B(i*g)+B(f*_))+B(a*v)))+C[r>>2],A=A+396|0,C[A>>2]=B(c*B(B(B(i*l)+B(f*s))+B(a*u)))+C[A>>2]);}function _f(A){A|=0;var r=0,e=0;return t[A>>2]=24380,r=A+128|0,e=t[r>>2],e&&(b[A+132|0]&&gA(e),t[A+128>>2]=0),t[r>>2]=0,a[A+132|0]=1,r=A+120|0,t[r>>2]=0,t[r+4>>2]=0,r=A+108|0,e=t[r>>2],e&&(b[A+112|0]&&gA(e),t[A+108>>2]=0),t[r>>2]=0,a[A+112|0]=1,r=A+100|0,t[r>>2]=0,t[r+4>>2]=0,r=A+88|0,e=t[r>>2],e&&(b[A+92|0]&&gA(e),t[A+88>>2]=0),t[r>>2]=0,a[A+92|0]=1,r=A+80|0,t[r>>2]=0,t[r+4>>2]=0,r=A+36|0,e=t[r>>2],e&&(b[A+40|0]&&gA(e),t[A+36>>2]=0),t[r>>2]=0,a[A+40|0]=1,r=A+28|0,t[r>>2]=0,t[r+4>>2]=0,0|A;}function Bf(A){A|=0;var r=0,e=0;return t[A>>2]=24604,r=A+120|0,e=t[r>>2],e&&(b[A+124|0]&&gA(e),t[A+120>>2]=0),t[r>>2]=0,a[A+124|0]=1,r=A+112|0,t[r>>2]=0,t[r+4>>2]=0,r=A+100|0,e=t[r>>2],e&&(b[A+104|0]&&gA(e),t[A+100>>2]=0),t[r>>2]=0,a[A+104|0]=1,r=A+92|0,t[r>>2]=0,t[r+4>>2]=0,r=A+80|0,e=t[r>>2],e&&(b[A+84|0]&&gA(e),t[A+80>>2]=0),t[r>>2]=0,a[A+84|0]=1,r=A+72|0,t[r>>2]=0,t[r+4>>2]=0,r=A+28|0,e=t[r>>2],e&&(b[A+32|0]&&gA(e),t[A+28>>2]=0),t[r>>2]=0,a[A+32|0]=1,r=A+20|0,t[r>>2]=0,t[r+4>>2]=0,0|A;}function mf(A,r){!function(A,r){n[0]=A,n[1]=r;}(0|A,0|r);}function Rf(A,r,e,i){return A=function(A,r,e,i){var a,f,n,t,b=0,o=0;return b=e>>>16,o=A>>>16,t=_(b,o),a=65535&e,f=65535&A,n=_(a,f),o=(n>>>16)+_(o,a)|0,b=(65535&o)+_(b,f)|0,A=(((_(r,e)+t|0)+_(A,i)|0)+(o>>>16)|0)+(b>>>16)|0,r=65535&n|b<<16,N=A,r;}(A,r,e,i),A;}function Gf(A,r,e){return function(A,r,e){var i=0,a=0,f=0,n=0,t=0,b=0,o=0,k=0,c=0;A:{r:{e:{i:{a:{f:{n:{t:{b:{if(a=r,a){if(i=e,!i)break b;break t;}return r=A,A=(A>>>0)/(e>>>0)|0,mf(r-_(A,e)|0,0),N=0,A;}if(!A)break n;break f;}if(n=i+-1|0,!(n&i))break a;n=(R(i)+33|0)-R(a)|0,t=0-n|0;break e;}return A=(a>>>0)/0|0,mf(0,a-_(A,0)|0),N=0,A;}if(i=32-R(a)|0,i>>>0<31)break i;break r;}if(mf(A&n,0),1==(0|i))break A;return i=i?31-R(i+-1^i)|0:32,e=31&i,32<=(63&i)>>>0?(a=0,A=r>>>e):(a=r>>>e,A=((1<<e)-1&r)<<32-e|A>>>e),N=a,A;}n=i+1|0,t=63-i|0;}if(i=r,a=63&n,f=31&a,32<=a>>>0?(a=0,f=i>>>f):(a=i>>>f,f=((1<<f)-1&i)<<32-f|A>>>f),t&=63,i=31&t,32<=t>>>0?(r=A<<i,A=0):(r=(1<<i)-1&A>>>32-i|r<<i,A<<=i),n)for(i=-1,t=e+-1|0,t>>>0<4294967295&&(i=0);b=f<<1|r>>>31,o=b,a=a<<1|f>>>31,b=i-(a+(t>>>0<b>>>0)|0)>>31,k=e&b,f=o-k|0,a=a-(o>>>0<k>>>0)|0,r=r<<1|A>>>31,A=c|A<<1,b&=1,c=b,n=n+-1|0,n;){}return mf(f,a),N=r<<1|A>>>31,b|A<<1;}mf(A,r),A=0,r=0;}return N=r,A;}(A,r,e);}function hf(A){var r;return r=31&A,A=0-A&31,(-1>>>r&-2)<<r|(-1<<A&-2)>>>A;}var yf=[null,function(A){return A|=0,A=0|w(t[A+56>>2]),A?(t[256]=A,A=-1):A=0,0|A;},function(A,r,e){A|=0,r|=0,e|=0;var i,a=0,f=0,n=0,b=0,o=0,k=0;i=E-16|0,E=i,t[i+12>>2]=e,t[i+8>>2]=r,r=t[A+24>>2],t[i>>2]=r,r=t[A+20>>2]-r|0,t[i+4>>2]=r,n=2;A:{r:{if(b=r+e|0,a=V(t[A+56>>2],i,2),(0|b)!=(0|a))for(r=i,k=A+56|0;;){if((0|a)<=-1)break r;if(f=t[r+4>>2],o=a>>>0>f>>>0,r=o?r+8|0:r,f=a-(o?f:0)|0,t[r>>2]=f+t[r>>2],t[r+4>>2]=t[r+4>>2]-f,b=b-a|0,n=n-o|0,a=V(t[k>>2],r,n),(0|b)==(0|a))break;}r=t[A+40>>2],t[A+24>>2]=r,t[A+20>>2]=r,t[A+16>>2]=r+t[A+44>>2],A=e;break A;}t[A+16>>2]=0,t[A+20>>2]=0,t[A+24>>2]=0,t[A>>2]=32|t[A>>2],A=0,2!=(0|n)&&(A=e-t[r+4>>2]|0);}return a=A,E=i+16|0,0|a;},function(A,r,e,i){return A|=0,r|=0,e|=0,i|=0,A=function(A,r,e,i){var a;return a=E-16|0,E=a,A=0|Y(0|A,0|r,0|e,255&i,a+8|0),A?(t[256]=76==(0|A)?70:A,e=-1,A=-1):(e=t[a+12>>2],A=t[a+8>>2]),E=a+16|0,N=e,A;}(t[A+56>>2],r,e,i),0|A;},function(){p();},function(){var A;A=E-16|0,E=A,t[A+12>>2]=1568,t[A+12>>2]&&(t[A+8>>2]=t[t[A+12>>2]>>2],t[A+8>>2]&&(t[A+4>>2]=t[A+8>>2]+48,t[12+(E-16|0)>>2]=t[A+4>>2])),function(A){var r;r=E-16|0,E=r,t[r+12>>2]=A,yf[t[r+12>>2]](),P(5605),p();}($(1560)),p();},iA,aA,aA,function(A){var r;A|=0,r=E-16|0,E=r,t[r+12>>2]=A,A=t[r+12>>2],iA(A),rA(A),E=r+16|0;},eA,eA,function(A,r,e){var i;return A|=0,r|=0,e|=0,i=E-80|0,E=i,t[i+72>>2]=A,t[i+68>>2]=r,t[i+64>>2]=e,r=t[i+72>>2],1&fA(r,t[i+68>>2],0)?a[i+79|0]=1:(e=i,A=t[i+68>>2],A=A?function(A){var r=0;if(r=E-96|0,E=r,t[r+92>>2]=A,t[r+88>>2]=2992,t[r+84>>2]=3004,t[r+80>>2]=0,t[r+76>>2]=t[t[r+92>>2]>>2],t[r+72>>2]=t[t[r+76>>2]+-8>>2],t[r+68>>2]=t[r+92>>2]+t[r+72>>2],t[r+64>>2]=t[t[r+76>>2]+-4>>2],t[r+60>>2]=0,t[r>>2]=t[r+84>>2],t[r+4>>2]=t[r+92>>2],t[r+8>>2]=t[r+88>>2],t[r+12>>2]=t[r+80>>2],t[r+16>>2]=0,t[r+20>>2]=0,t[r+24>>2]=0,t[r+28>>2]=0,t[r+32>>2]=0,t[r+36>>2]=0,t[r+40>>2]=0,t[r+44>>2]=0,t[r+48>>2]=0,a[r+52|0]=0,a[r+53|0]=0,a[r+54|0]=0,1&fA(t[r+64>>2],t[r+84>>2],0))t[r+48>>2]=1,A=t[r+64>>2],yf[t[t[A>>2]+20>>2]](A,r,t[r+68>>2],t[r+68>>2],1,0),1==t[r+24>>2]&&(t[r+60>>2]=t[r+68>>2]);else {A=t[r+64>>2],yf[t[t[A>>2]+24>>2]](A,r,t[r+68>>2],1,0);A:{r:{if(A=t[r+36>>2],A){if(1==(0|A))break r;break A;}1!=t[r+40>>2]|1!=t[r+28>>2]|1!=t[r+32>>2]||(t[r+60>>2]=t[r+20>>2]);break A;}t[r+40>>2]|1!=t[r+28>>2]|1!=t[r+32>>2]&&1!=t[r+24>>2]||(t[r+60>>2]=t[r+16>>2]);}}return E=r+96|0,t[r+60>>2];}(A):0,t[e+60>>2]=A,t[i+60>>2]?(t[i>>2]=t[i+60>>2],t[i+4>>2]=0,t[i+8>>2]=r,t[i+12>>2]=-1,t[i+16>>2]=0,t[i+20>>2]=0,t[i+24>>2]=0,t[i+28>>2]=0,t[i+32>>2]=0,t[i+36>>2]=0,t[i+40>>2]=0,t[i+44>>2]=0,t[i+48>>2]=0,a[i+52|0]=0,a[i+53|0]=0,a[i+54|0]=0,t[i+48>>2]=1,A=t[i+60>>2],yf[t[t[A>>2]+28>>2]](A,i,t[t[i+64>>2]>>2],1),1!=t[i+24>>2]?a[i+79|0]=0:(t[t[i+64>>2]>>2]=t[i+16>>2],a[i+79|0]=1)):a[i+79|0]=0),E=i+80|0,1&a[i+79|0];},function(A,r,e,i,f,n){var b;A|=0,r|=0,e|=0,i|=0,f|=0,n|=0,b=E-32|0,E=b,t[b+28>>2]=A,t[b+24>>2]=r,t[b+20>>2]=e,t[b+16>>2]=i,t[b+12>>2]=f,a[b+11|0]=n,A=t[b+28>>2],1&fA(A,t[t[b+24>>2]+8>>2],1&a[b+11|0])&&oA(A,t[b+24>>2],t[b+20>>2],t[b+16>>2],t[b+12>>2]),E=b+32|0;},function(A,r,e,i,f){var n;A|=0,r|=0,e|=0,i|=0,f|=0,n=E-32|0,E=n,t[n+28>>2]=A,t[n+24>>2]=r,t[n+20>>2]=e,t[n+16>>2]=i,a[n+15|0]=f,A=t[n+28>>2],1&fA(A,t[t[n+24>>2]+8>>2],1&a[n+15|0])?kA(A,t[n+24>>2],t[n+20>>2],t[n+16>>2]):1&fA(A,t[t[n+24>>2]>>2],1&a[n+15|0])&&(t[n+20>>2]!=t[t[n+24>>2]+20>>2]&&t[n+20>>2]!=t[t[n+24>>2]+16>>2]?(t[t[n+24>>2]+32>>2]=t[n+16>>2],t[t[n+24>>2]+20>>2]=t[n+20>>2],A=t[n+24>>2],t[A+40>>2]=t[A+40>>2]+1,1!=t[t[n+24>>2]+36>>2]|2!=t[t[n+24>>2]+24>>2]||(a[t[n+24>>2]+54|0]=1),t[t[n+24>>2]+44>>2]=4):1==t[n+16>>2]&&(t[t[n+24>>2]+32>>2]=1)),E=n+32|0;},function(A,r,e,i){var a;A|=0,r|=0,e|=0,i|=0,a=E-16|0,E=a,t[a+12>>2]=A,t[a+8>>2]=r,t[a+4>>2]=e,t[a>>2]=i,A=t[a+12>>2],1&fA(A,t[t[a+8>>2]+8>>2],0)&&tA(A,t[a+8>>2],t[a+4>>2],t[a>>2]),E=a+16|0;},function(A){var r;A|=0,r=E-16|0,E=r,t[r+12>>2]=A,A=t[r+12>>2],aA(A),rA(A),E=r+16|0;},function(A,r,e,i,f,n){var b;A|=0,r|=0,e|=0,i|=0,f|=0,n|=0,b=E-32|0,E=b,t[b+28>>2]=A,t[b+24>>2]=r,t[b+20>>2]=e,t[b+16>>2]=i,t[b+12>>2]=f,a[b+11|0]=n,A=t[b+28>>2],1&fA(A,t[t[b+24>>2]+8>>2],1&a[b+11|0])?oA(A,t[b+24>>2],t[b+20>>2],t[b+16>>2],t[b+12>>2]):(A=t[A+8>>2],yf[t[t[A>>2]+20>>2]](A,t[b+24>>2],t[b+20>>2],t[b+16>>2],t[b+12>>2],1&a[b+11|0])),E=b+32|0;},function(A,r,e,i,f){var n;if(A|=0,r|=0,e|=0,i|=0,f|=0,n=E-32|0,E=n,t[n+28>>2]=A,t[n+24>>2]=r,t[n+20>>2]=e,t[n+16>>2]=i,a[n+15|0]=f,A=t[n+28>>2],1&fA(A,t[t[n+24>>2]+8>>2],1&a[n+15|0]))kA(A,t[n+24>>2],t[n+20>>2],t[n+16>>2]);else A:if(1&fA(A,t[t[n+24>>2]>>2],1&a[n+15|0])){if(t[n+20>>2]==t[t[n+24>>2]+20>>2]||t[n+20>>2]==t[t[n+24>>2]+16>>2]){1==t[n+16>>2]&&(t[t[n+24>>2]+32>>2]=1);break A;}t[t[n+24>>2]+32>>2]=t[n+16>>2],a[n+14|0]=0,4!=t[t[n+24>>2]+44>>2]&&(a[n+13|0]=0,a[t[n+24>>2]+52|0]=0,a[t[n+24>>2]+53|0]=0,A=t[A+8>>2],yf[t[t[A>>2]+20>>2]](A,t[n+24>>2],t[n+20>>2],t[n+20>>2],1,1&a[n+15|0]),1&a[t[n+24>>2]+53|0]&&(a[n+13|0]=1,1&a[t[n+24>>2]+52|0]&&(a[n+14|0]=1)),1&a[n+13|0]?t[t[n+24>>2]+44>>2]=3:t[t[n+24>>2]+44>>2]=4),1&a[n+14|0]||(t[t[n+24>>2]+20>>2]=t[n+20>>2],A=t[n+24>>2],t[A+40>>2]=t[A+40>>2]+1,1!=t[t[n+24>>2]+36>>2]|2!=t[t[n+24>>2]+24>>2]||(a[t[n+24>>2]+54|0]=1));}else A=t[A+8>>2],yf[t[t[A>>2]+24>>2]](A,t[n+24>>2],t[n+20>>2],t[n+16>>2],1&a[n+15|0]);E=n+32|0;},function(A,r,e,i){var a;A|=0,r|=0,e|=0,i|=0,a=E-16|0,E=a,t[a+12>>2]=A,t[a+8>>2]=r,t[a+4>>2]=e,t[a>>2]=i,A=t[a+12>>2],1&fA(A,t[t[a+8>>2]+8>>2],0)?tA(A,t[a+8>>2],t[a+4>>2],t[a>>2]):(A=t[A+8>>2],yf[t[t[A>>2]+28>>2]](A,t[a+8>>2],t[a+4>>2],t[a>>2])),E=a+16|0;},function(A){var r;A|=0,r=E-16|0,E=r,t[r+12>>2]=A,A=t[r+12>>2],aA(A),rA(A),E=r+16|0;},function(A,r,e,i,f,n){var b;if(A|=0,r|=0,e|=0,i|=0,f|=0,n|=0,b=E-32|0,E=b,t[b+28>>2]=A,t[b+24>>2]=r,t[b+20>>2]=e,t[b+16>>2]=i,t[b+12>>2]=f,a[b+11|0]=n,A=t[b+28>>2],1&fA(A,t[t[b+24>>2]+8>>2],1&a[b+11|0]))oA(A,t[b+24>>2],t[b+20>>2],t[b+16>>2],t[b+12>>2]);else {if(a[b+10|0]=1&a[t[b+24>>2]+52|0],a[b+9|0]=1&a[t[b+24>>2]+53|0],t[b+4>>2]=(A+16|0)+(t[A+12>>2]<<3),t[b>>2]=A+16,a[t[b+24>>2]+52|0]=0,a[t[b+24>>2]+53|0]=0,cA(t[b>>2],t[b+24>>2],t[b+20>>2],t[b+16>>2],t[b+12>>2],1&a[b+11|0]),a[b+10|0]=0!=(1&a[b+10|0]|1&a[t[b+24>>2]+52|0]),a[b+9|0]=0!=(1&a[b+9|0]|1&a[t[b+24>>2]+53|0]),r=t[b>>2]+8|0,t[b>>2]=r,r>>>0<v[b+4>>2])for(;;){A:if(!(1&a[t[b+24>>2]+54|0])){if(1&a[t[b+24>>2]+52|0]){if(!(2&t[A+8>>2])|1==t[t[b+24>>2]+24>>2])break A;}else if(!(1&t[A+8>>2])&&1&a[t[b+24>>2]+53|0])break A;if(a[t[b+24>>2]+52|0]=0,a[t[b+24>>2]+53|0]=0,cA(t[b>>2],t[b+24>>2],t[b+20>>2],t[b+16>>2],t[b+12>>2],1&a[b+11|0]),a[b+10|0]=0!=(1&a[b+10|0]|1&a[t[b+24>>2]+52|0]),a[b+9|0]=0!=(1&a[b+9|0]|1&a[t[b+24>>2]+53|0]),r=t[b>>2]+8|0,t[b>>2]=r,r>>>0<v[b+4>>2])continue;}break;}a[t[b+24>>2]+52|0]=1&a[b+10|0],a[t[b+24>>2]+53|0]=1&a[b+9|0];}E=b+32|0;},function(A,r,e,i,f){var n;if(A|=0,r|=0,e|=0,i|=0,f|=0,n=E-48|0,E=n,t[n+44>>2]=A,t[n+40>>2]=r,t[n+36>>2]=e,t[n+32>>2]=i,a[n+31|0]=f,A=t[n+44>>2],1&fA(A,t[t[n+40>>2]+8>>2],1&a[n+31|0]))kA(A,t[n+40>>2],t[n+36>>2],t[n+32>>2]);else A:if(1&fA(A,t[t[n+40>>2]>>2],1&a[n+31|0])){if(t[n+36>>2]==t[t[n+40>>2]+20>>2]||t[n+36>>2]==t[t[n+40>>2]+16>>2]){1==t[n+32>>2]&&(t[t[n+40>>2]+32>>2]=1);break A;}if(t[t[n+40>>2]+32>>2]=t[n+32>>2],a[n+30|0]=0,4!=t[t[n+40>>2]+44>>2]){for(a[n+29|0]=0,t[n+24>>2]=(A+16|0)+(t[A+12>>2]<<3),t[n+20>>2]=A+16;;){r:if(!(v[n+20>>2]>=v[n+24>>2]||(a[t[n+40>>2]+52|0]=0,a[t[n+40>>2]+53|0]=0,cA(t[n+20>>2],t[n+40>>2],t[n+36>>2],t[n+36>>2],1,1&a[n+31|0]),1&a[t[n+40>>2]+54|0]))){if(1&a[t[n+40>>2]+53|0])if(a[n+29|0]=1,1&a[t[n+40>>2]+52|0]){if(a[n+30|0]=1,!(2&t[A+8>>2])|1==t[t[n+40>>2]+24>>2])break r;}else if(!(1&t[A+8>>2]))break r;t[n+20>>2]=t[n+20>>2]+8;continue;}break;}1&a[n+29|0]?t[t[n+40>>2]+44>>2]=3:t[t[n+40>>2]+44>>2]=4;}1&a[n+30|0]||(t[t[n+40>>2]+20>>2]=t[n+36>>2],A=t[n+40>>2],t[A+40>>2]=t[A+40>>2]+1,1!=t[t[n+40>>2]+36>>2]|2!=t[t[n+40>>2]+24>>2]||(a[t[n+40>>2]+54|0]=1));}else if(t[n+16>>2]=(A+16|0)+(t[A+12>>2]<<3),t[n+12>>2]=A+16,uA(t[n+12>>2],t[n+40>>2],t[n+36>>2],t[n+32>>2],1&a[n+31|0]),r=t[n+12>>2]+8|0,t[n+12>>2]=r,r>>>0<v[n+16>>2])if(1==t[t[n+40>>2]+36>>2]||2&t[A+8>>2])for(;!(1&a[t[n+40>>2]+54|0])&&(uA(t[n+12>>2],t[n+40>>2],t[n+36>>2],t[n+32>>2],1&a[n+31|0]),A=t[n+12>>2]+8|0,t[n+12>>2]=A,A>>>0<v[n+16>>2]);){}else if(1&t[A+8>>2])for(;!(!!(1&a[t[n+40>>2]+54|0])|!(1!=t[t[n+40>>2]+36>>2]|1!=t[t[n+40>>2]+24>>2]))&&(uA(t[n+12>>2],t[n+40>>2],t[n+36>>2],t[n+32>>2],1&a[n+31|0]),A=t[n+12>>2]+8|0,t[n+12>>2]=A,A>>>0<v[n+16>>2]);){}else for(;!(!!(1&a[t[n+40>>2]+54|0])|1==t[t[n+40>>2]+36>>2])&&(uA(t[n+12>>2],t[n+40>>2],t[n+36>>2],t[n+32>>2],1&a[n+31|0]),A=t[n+12>>2]+8|0,t[n+12>>2]=A,A>>>0<v[n+16>>2]);){}E=n+48|0;},function(A,r,e,i){var f;if(A|=0,r|=0,e|=0,i|=0,f=E-32|0,E=f,t[f+28>>2]=A,t[f+24>>2]=r,t[f+20>>2]=e,t[f+16>>2]=i,A=t[f+28>>2],1&fA(A,t[t[f+24>>2]+8>>2],0))tA(A,t[f+24>>2],t[f+20>>2],t[f+16>>2]);else if(t[f+12>>2]=(A+16|0)+(t[A+12>>2]<<3),t[f+8>>2]=A+16,bA(t[f+8>>2],t[f+24>>2],t[f+20>>2],t[f+16>>2]),A=t[f+8>>2]+8|0,t[f+8>>2]=A,A>>>0<v[f+12>>2])for(;bA(t[f+8>>2],t[f+24>>2],t[f+20>>2],t[f+16>>2]),!(1&a[t[f+24>>2]+54|0])&&(A=t[f+8>>2]+8|0,t[f+8>>2]=A,A>>>0<v[f+12>>2]);){}E=f+32|0;},sA,dA,function(){P(5575),p();},sA,dA,function(A,r){A|=0,r|=0;var e=0;return A=0|yf[t[792]](3+(A+r|0)|0),A&&(e=3+(A+r|0)&0-r,t[e+-4>>2]=A),0|e;},function(A){A|=0,A&&yf[t[793]](t[A+-4>>2]);},function(A){return A|=0,0|K(A);},function(A){A|=0,q(A);},sA,dA,function(A,r,e){A|=0,r|=0,e|=0;var i,a=0,f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0);i=E-96|0,E=i,a=i+44|0,t[a>>2]=0,t[a+4>>2]=0,t[i+52>>2]=1065353216,a=i+56|0,t[a>>2]=0,t[a+4>>2]=0,t[i+72>>2]=1065353216,t[i+92>>2]=0,a=i+84|0,t[a>>2]=0,t[a+4>>2]=0,a=i+76|0,t[a>>2]=0,t[a+4>>2]=0,t[i+36>>2]=0,t[i+40>>2]=0,t[i+32>>2]=1065353216,t[i+64>>2]=0,t[i+68>>2]=0,yf[t[t[A>>2]+8>>2]](A,i+32|0,i+16|0,i),o=C[i>>2],k=C[i+16>>2],f=B(o-k),b=B(f*f),f=C[i+4>>2],c=C[i+20>>2],n=B(f-c),l=B(b+B(n*n)),n=C[i+8>>2],b=C[i+24>>2],u=B(n-b),C[e>>2]=B(Q(B(l+B(u*u))))*B(.5),t[r+12>>2]=0,C[r+8>>2]=B(n+b)*B(.5),C[r+4>>2]=B(f+c)*B(.5),C[r>>2]=B(o+k)*B(.5),E=i+96|0;},function(A){A|=0;var r,e=B(0),i=B(0);return r=E-32|0,E=r,yf[t[t[A>>2]+12>>2]](A,r+16|0,r+12|0),E=r+32|0,e=C[r+16>>2],i=B(e*e),e=C[r+20>>2],i=B(i+B(e*e)),e=C[r+24>>2],B(B(C[r+12>>2]+B(Q(B(i+B(e*e))))));},function(A,r){return A|=0,r=B(r),B(B(B(yf[t[t[A>>2]+16>>2]](A))*r));},function(A,r){A|=0,t[A+8>>2]=1065353216,t[A+12>>2]=0,t[A>>2]=1065353216,t[A+4>>2]=1065353216;},pA,hA,function(A,r){A|=0,r|=0;var e,i=0,a=0,f=0,n=0,b=0;f=r,n=0|yf[t[t[A>>2]+52>>2]](A),b=1,a=t[t[r>>2]+16>>2],i=0|yf[a](0|f,0|n,0|b),b=r,n=i,f=0|yf[t[t[A>>2]+56>>2]](A,t[i+8>>2],r),e=A,a=t[t[r>>2]+20>>2],yf[a](0|b,0|n,0|f,1346455635,0|e);},function(A,r,e,i,a,f,n){A|=0,r|=0,e|=0,i|=0,a|=0,f|=0,n|=0;var b,o,k,c,u,l,s,d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=B(0),M=B(0),x=B(0),S=B(0),T=B(0),U=B(0),j=B(0),O=B(0),H=B(0);b=E-48|0,E=b,t[b+44>>2]=0,d=C[e>>2],v=C[e+4>>2],g=C[e+8>>2],C[b+32>>2]=B(B(C[r>>2]*d)+B(C[r+16>>2]*v))+B(C[r+32>>2]*g),o=r+24|0,k=r+40|0,C[b+40>>2]=B(B(d*C[r+8>>2])+B(v*C[o>>2]))+B(g*C[k>>2]),c=r+20|0,u=r+36|0,C[b+36>>2]=B(B(d*C[r+4>>2])+B(v*C[c>>2]))+B(g*C[u>>2]),yf[t[t[A>>2]+64>>2]](b+16|0,A,b+32|0),l=r+56|0,y=C[l>>2],Q=C[k>>2],p=C[u>>2],s=r+52|0,G=C[s>>2],D=C[o>>2],w=C[c>>2],W=C[r+32>>2],h=C[r+48>>2],F=C[r+8>>2],Z=C[r>>2],Y=C[r+4>>2],N=C[r+16>>2],d=C[b+24>>2],v=C[b+16>>2],g=C[b+20>>2],t[b+12>>2]=0,C[b+8>>2]=-C[b+40>>2],C[b+4>>2]=-C[b+36>>2],C[b>>2]=-C[b+32>>2],yf[t[t[A>>2]+64>>2]](b+16|0,A,b),V=C[l>>2],I=C[k>>2],J=C[u>>2],X=C[s>>2],M=C[o>>2],x=C[c>>2],S=C[r+32>>2],T=C[r+48>>2],U=C[r+8>>2],j=C[r>>2],O=C[r+4>>2],H=C[r+16>>2],_=C[b+24>>2],m=C[b+16>>2],R=C[b+20>>2],h=B(h+B(B(B(v*Z)+B(g*Y))+B(d*F))),G=B(G+B(B(B(v*N)+B(g*w))+B(d*D))),d=B(y+B(B(B(v*W)+B(g*p))+B(d*Q))),C[i>>2]=B(B(h*C[e>>2])+B(G*C[e+4>>2]))+B(d*C[e+8>>2]),v=B(T+B(B(B(m*j)+B(R*O))+B(_*U))),g=B(X+B(B(B(m*H)+B(R*x))+B(_*M))),_=B(V+B(B(B(m*S)+B(R*J))+B(_*I))),C[a>>2]=B(B(v*C[e>>2])+B(g*C[e+4>>2]))+B(_*C[e+8>>2]),t[n+12>>2]=0,C[n+8>>2]=_,C[n+4>>2]=g,C[n>>2]=v,t[f+12>>2]=0,C[f+8>>2]=d,C[f+4>>2]=G,C[f>>2]=h,m=C[i>>2],R=C[a>>2],m>R&&(C[i>>2]=R,C[a>>2]=m,t[n+12>>2]=0,C[n+8>>2]=d,C[n+4>>2]=G,C[n>>2]=h,t[f+12>>2]=0,C[f+8>>2]=_,C[f+4>>2]=g,C[f>>2]=v),E=b+48|0;},DA,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f,n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),R=B(0),G=B(0),h=B(0);a=E-16|0,t[a+12>>2]=0,f=A+32|0,A=t[A+56>>2],b=C[f+((A+2|0)%3<<2)>>2],C[a+8>>2]=b,C[a+4>>2]=b,C[a>>2]=b,A<<=2,C[A+a>>2]=b+C[A+f>>2],b=C[r+52>>2],c=C[r+24>>2],d=C[r+20>>2],l=C[r+56>>2],o=C[r+40>>2],k=C[r+36>>2],s=C[r+48>>2],v=C[r+8>>2],g=C[r>>2],_=C[r+4>>2],R=C[r+16>>2],n=C[r+32>>2],t[e+12>>2]=0,u=B(m(n)),n=C[a>>2],G=B(m(k)),k=C[a+4>>2],h=B(m(o)),o=C[a+8>>2],u=B(B(B(u*n)+B(G*k))+B(h*o)),C[e+8>>2]=l-u,c=B(B(B(n*B(m(R)))+B(k*B(m(d))))+B(o*B(m(c)))),C[e+4>>2]=b-c,n=B(B(B(n*B(m(g)))+B(k*B(m(_))))+B(o*B(m(v)))),C[e>>2]=s-n,t[i+12>>2]=0,C[i+8>>2]=l+u,C[i+4>>2]=b+c,C[i>>2]=s+n;},function(A,r){A|=0,r|=0;var e,i,a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0);a=C[A+20>>2],e=A+36|0,f=C[e>>2],n=C[A+24>>2],i=A+40|0,b=C[i>>2],o=C[A+16>>2],k=C[A+32>>2],YA(A,r),c=C[r>>2],u=C[r+4>>2],l=C[r+8>>2],t[A+44>>2]=0,C[i>>2]=l*B(b/n),C[e>>2]=u*B(f/a),C[A+32>>2]=c*B(k/o),t[A+48>>2]=t[(A+32|0)+((t[A+56>>2]+2|0)%3<<2)>>2];},yr,function(A,r,e){A|=0,r=B(r),e|=0;var i,a,f=B(0),n=B(0),b=0,o=B(0);i=E-16|0,a=A+32|0,b=t[A+56>>2],A=t[a+((b+2|0)%3<<2)>>2],t[i+4>>2]=A,t[i>>2]=A,t[i+12>>2]=0,t[i+8>>2]=A,A=b<<2,b=A+i|0,C[b>>2]=C[A+a>>2]+C[b>>2],r=B(r*B(.0833333283662796)),f=C[i>>2],f=B(f+f),f=B(f*f),n=C[i+4>>2],n=B(n+n),n=B(n*n),C[e+8>>2]=r*B(f+n),o=f,f=C[i+8>>2],f=B(f+f),f=B(f*f),C[e+4>>2]=r*B(o+f),C[e>>2]=r*B(n+f);},function(A){return 6504;},wA,WA,function(A){return A|=0,B(C[A+48>>2]);},FA,function(A,r,e){return A|=0,r|=0,e|=0,hA(A,r,e),t[r+28>>2]=t[A+32>>2],t[r+32>>2]=t[A+36>>2],t[r+36>>2]=t[A+40>>2],t[r+40>>2]=t[A+44>>2],t[r+12>>2]=t[A+16>>2],t[r+16>>2]=t[A+20>>2],t[r+20>>2]=t[A+24>>2],t[r+24>>2]=t[A+28>>2],t[r+48>>2]=0,t[r+44>>2]=t[A+48>>2],A=t[A+56>>2],t[r+56>>2]=0,t[r+52>>2]=A,6517;},function(A,r,e){A|=0,r|=0,e|=0;var i=B(0),a=B(0),f=B(0),n=B(0),b=B(0);yf[t[t[r>>2]+68>>2]](A,r,e),B(yf[t[t[r>>2]+48>>2]](r))!=B(0)&&(a=C[e+4>>2],i=C[e>>2],f=C[e+8>>2],n=B(yf[t[t[r>>2]+48>>2]](r)),r=B(B(B(i*i)+B(a*a))+B(f*f))<B(1.4210854715202004e-14),i=r?B(-1):i,b=i,f=r?B(-1):f,a=r?B(-1):a,i=B(B(1)/B(Q(B(B(f*f)+B(B(i*i)+B(a*a)))))),C[A>>2]=C[A>>2]+B(n*B(b*i)),C[A+4>>2]=C[A+4>>2]+B(n*B(a*i)),C[A+8>>2]=C[A+8>>2]+B(n*B(f*i)));},function(A,r,e){A|=0,r|=0,e|=0;var i,a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=0,c=B(0),u=B(0),l=B(0),s=B(0);i=E-16|0,t[A>>2]=0,t[A+4>>2]=0,k=A+8|0,t[k>>2]=0,t[k+4>>2]=0,b=C[e>>2],n=C[e+4>>2],f=C[e+8>>2],a=B(B(B(b*b)+B(n*n))+B(f*f)),a<B(9999999747378752e-20)?(f=B(0),a=B(1)):(a=B(B(1)/B(Q(a))),c=B(f*a),f=B(n*a),a=B(b*a)),t[i+8>>2]=0,t[i+12>>2]=0,t[i>>2]=0,t[i+4>>2]=0,e=t[r+56>>2]<<2,k=e+i|0,o=C[32+(r+e|0)>>2],C[k>>2]=o,b=B(-0xde0b6b000000000),u=C[i>>2],l=C[i+4>>2],s=C[i+8>>2],n=B(B(B(a*u)+B(f*l))+B(c*s)),n>B(-0xde0b6b000000000)&&(C[A>>2]=u,t[A+12>>2]=t[i+12>>2],C[A+8>>2]=s,C[A+4>>2]=l,b=n),t[i+8>>2]=0,t[i+12>>2]=0,t[i>>2]=0,t[i+4>>2]=0,C[k>>2]=-o,n=C[i>>2],o=f,f=C[i+4>>2],o=B(B(a*n)+B(o*f)),a=C[i+8>>2],B(o+B(c*a))>b&&(C[A>>2]=n,t[A+12>>2]=t[i+12>>2],C[A+8>>2]=a,C[A+4>>2]=f);},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f=0,n=0,b=0,o=B(0),k=B(0),c=B(0),u=B(0),l=0,s=0,d=B(0),v=0,g=B(0),_=B(0),m=B(0),R=B(0),G=0;if(a=E-16|0,(0|i)>=1)for(v=A+56|0;f=a+8|0,t[f>>2]=0,t[f+4>>2]=0,t[a>>2]=0,t[a+4>>2]=0,b=t[v>>2],n=b<<2,l=n+a|0,n=32+(A+n|0)|0,k=C[n>>2],t[l>>2]=t[n>>2],g=B(-0xde0b6b000000000),_=C[a>>2],n=r+s|0,o=C[n>>2],m=C[a+4>>2],l=n+4|0,c=C[l>>2],R=C[f>>2],G=n+8|0,d=C[G>>2],u=B(B(B(_*o)+B(m*c))+B(R*d)),u>B(-0xde0b6b000000000)&&(b=e+s|0,C[b>>2]=_,t[b+12>>2]=t[a+12>>2],C[b+8>>2]=R,C[b+4>>2]=m,d=C[G>>2],c=C[l>>2],b=t[v>>2],k=C[32+((b<<2)+A|0)>>2],o=C[n>>2],g=u),t[f>>2]=0,t[f+4>>2]=0,t[a>>2]=0,t[a+4>>2]=0,C[(b<<2)+a>>2]=-k,k=C[a>>2],u=C[a+4>>2],c=B(B(k*o)+B(u*c)),o=C[f>>2],B(c+B(o*d))>g&&(f=e+s|0,C[f>>2]=k,t[f+12>>2]=t[a+12>>2],C[f+8>>2]=o,C[f+4>>2]=u),s=s+16|0,i=i+-1|0,i;){}},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f,n,b,o,k,c,u,l,s,d=B(0),v=B(0),g=B(0),_=0,m=0,R=0,G=0,h=0,y=0,Q=B(0),p=0,D=0;for(a=E-80|0,E=a,Q=B(yf[t[t[A>>2]+48>>2]](A)),f=r+24|0,n=r+40|0,b=r+20|0,o=r+36|0,k=r+16|0,c=r+32|0,u=r+56|0,l=r+52|0,s=r+48|0;G=a+72|0,_=G,t[_>>2]=0,t[_+4>>2]=0,t[a+64>>2]=0,t[a+68>>2]=0,p=(a- -64|0)+m|0,t[p>>2]=1065353216,h=a+44|0,t[h>>2]=0,y=a+40|0,d=C[a+64>>2],_=r+8|0,v=C[a+68>>2],g=C[G>>2],C[y>>2]=B(B(d*C[_>>2])+B(v*C[f>>2]))+B(g*C[n>>2]),R=r+4|0,C[a+36>>2]=B(B(d*C[R>>2])+B(v*C[b>>2]))+B(g*C[o>>2]),C[a+32>>2]=B(B(d*C[r>>2])+B(v*C[k>>2]))+B(g*C[c>>2]),yf[t[t[A>>2]+64>>2]](a+48|0,A,a+32|0),t[h>>2]=0,d=C[a+48>>2],v=C[a+52>>2],g=C[a+56>>2],C[y>>2]=B(B(B(d*C[c>>2])+B(v*C[o>>2]))+B(g*C[n>>2]))+C[u>>2],C[a+36>>2]=B(B(B(d*C[k>>2])+B(v*C[b>>2]))+B(g*C[f>>2]))+C[l>>2],C[a+32>>2]=B(B(B(d*C[r>>2])+B(v*C[R>>2]))+B(g*C[_>>2]))+C[s>>2],D=(a+32|0)+m|0,C[i+m>>2]=Q+C[D>>2],t[p>>2]=-1082130432,t[a+12>>2]=0,d=C[a+64>>2],v=C[a+68>>2],g=C[G>>2],C[a+8>>2]=B(B(d*C[_>>2])+B(v*C[f>>2]))+B(g*C[n>>2]),C[a+4>>2]=B(B(d*C[R>>2])+B(v*C[b>>2]))+B(g*C[o>>2]),C[a>>2]=B(B(d*C[r>>2])+B(v*C[k>>2]))+B(g*C[c>>2]),yf[t[t[A>>2]+64>>2]](a+16|0,A,a),t[h>>2]=0,d=C[a+16>>2],v=C[a+20>>2],g=C[a+24>>2],C[y>>2]=B(B(B(d*C[c>>2])+B(v*C[o>>2]))+B(g*C[n>>2]))+C[u>>2],C[a+36>>2]=B(B(B(d*C[k>>2])+B(v*C[b>>2]))+B(g*C[f>>2]))+C[l>>2],C[a+32>>2]=B(B(B(d*C[r>>2])+B(v*C[R>>2]))+B(g*C[_>>2]))+C[s>>2],C[e+m>>2]=C[D>>2]-Q,m=m+4|0,12!=(0|m);){}E=a+80|0;},Zr,Yr,DA,function(A){return 6536;},DA,function(A){return 6545;},DA,rr,function(A,r){A|=0,r|=0;var e,i=0,a=B(0),f=B(0);i=t[A+72>>2]<<2,e=A+16|0,f=B(C[A+64>>2]*B(C[i+r>>2]/C[i+e>>2])),C[A+64>>2]=f,i=t[A+68>>2]<<2,a=B(C[i+r>>2]/C[i+e>>2]),i=t[A+76>>2]<<2,a=B(C[A+60>>2]*B(B(a+B(C[i+r>>2]/C[i+e>>2]))*B(.5))),C[A+60>>2]=a,C[A+56>>2]=a/B(Q(B(B(f*f)+B(a*a)))),YA(A,r);},function(A,r,e){A|=0,r=B(r),e|=0;var i,a=B(0),f=0,n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0);i=E-96|0,E=i,f=i+44|0,t[f>>2]=0,t[f+4>>2]=0,t[i+52>>2]=1065353216,f=i+56|0,t[f>>2]=0,t[f+4>>2]=0,t[i+72>>2]=1065353216,t[i+92>>2]=0,f=i+84|0,t[f>>2]=0,t[f+4>>2]=0,f=i+76|0,t[f>>2]=0,t[f+4>>2]=0,t[i+36>>2]=0,t[i+40>>2]=0,t[i+32>>2]=1065353216,t[i+64>>2]=0,t[i+68>>2]=0,yf[t[t[A>>2]+8>>2]](A,i+32|0,i+16|0,i),o=C[i+24>>2],k=C[i+8>>2],n=C[i+16>>2],b=C[i>>2],c=C[i+20>>2],u=C[i+4>>2],a=B(yf[t[t[A>>2]+48>>2]](A)),t[e+12>>2]=0,r=B(r*B(.0833333283662796)),n=B(a+B(B(b-n)*B(.5))),n=B(n+n),n=B(n*n),b=B(a+B(B(u-c)*B(.5))),b=B(b+b),b=B(b*b),C[e+8>>2]=r*B(n+b),a=B(a+B(B(k-o)*B(.5))),a=B(a+a),a=B(a*a),C[e+4>>2]=r*B(n+a),C[e>>2]=r*B(b+a),E=i+96|0;},function(A){return 6940;},function(A,r){A|=0,t[A+8>>2]=0,t[A+12>>2]=0,t[A>>2]=0,t[A+4>>2]=1065353216;},pr,FA,function(A,r,e){return A|=0,r|=0,e|=0,hA(A,r,e),t[r+28>>2]=t[A+32>>2],t[r+32>>2]=t[A+36>>2],t[r+36>>2]=t[A+40>>2],t[r+40>>2]=t[A+44>>2],t[r+12>>2]=t[A+16>>2],t[r+16>>2]=t[A+20>>2],t[r+20>>2]=t[A+24>>2],t[r+24>>2]=t[A+28>>2],t[r+48>>2]=0,t[r+44>>2]=t[A+48>>2],A=t[A+72>>2],t[r+56>>2]=0,t[r+52>>2]=A,6945;},function(A,r,e){A|=0,r|=0,e|=0;var i,a,f=B(0),n=B(0),b=B(0),o=B(0),k=0,c=B(0);n=B(C[r+64>>2]*B(.5)),i=t[r+68>>2],a=t[r+72>>2],k=a<<2,f=C[e>>2],o=B(f*f),f=C[e+4>>2],o=B(o+B(f*f)),f=C[e+8>>2];A:{if(C[k+e>>2]>B(C[r+56>>2]*B(Q(B(o+B(f*f))))))t[(i<<2)+A>>2]=0,C[A+k>>2]=n,k=t[r+76>>2];else {if(f=C[(i<<2)+e>>2],k=t[r+76>>2],b=C[(k<<2)+e>>2],c=B(Q(B(B(f*f)+B(b*b)))),c>B(1.1920928955078125e-7)){o=f,f=B(C[r+60>>2]/c),C[(i<<2)+A>>2]=o*f,C[(a<<2)+A>>2]=-n,n=B(b*f);break A;}t[(i<<2)+A>>2]=0,C[(a<<2)+A>>2]=-n;}n=B(0);}C[(k<<2)+A>>2]=n,B(yf[t[t[r>>2]+48>>2]](r))!=B(0)&&(n=C[e+4>>2],f=C[e>>2],b=C[e+8>>2],c=B(yf[t[t[r>>2]+48>>2]](r)),r=B(B(B(f*f)+B(n*n))+B(b*b))<B(1.4210854715202004e-14),f=r?B(-1):f,o=f,b=r?B(-1):b,n=r?B(-1):n,f=B(B(1)/B(Q(B(B(b*b)+B(B(f*f)+B(n*n)))))),C[A>>2]=C[A>>2]+B(c*B(o*f)),C[A+4>>2]=C[A+4>>2]+B(c*B(n*f)),C[A+8>>2]=C[A+8>>2]+B(c*B(b*f)));},function(A,r,e){A|=0,r|=0,e|=0;var i,a,f=B(0),n=B(0),b=B(0),o=0,k=B(0),c=B(0);n=B(C[r+64>>2]*B(.5)),i=t[r+68>>2],a=t[r+72>>2],o=a<<2,f=C[e>>2],b=B(f*f),f=C[e+4>>2],b=B(b+B(f*f)),f=C[e+8>>2];A:{if(C[o+e>>2]>B(C[r+56>>2]*B(Q(B(b+B(f*f))))))t[(i<<2)+A>>2]=0,C[A+o>>2]=n,e=t[r+76>>2];else {if(f=C[(i<<2)+e>>2],o=e,e=t[r+76>>2],k=C[o+(e<<2)>>2],c=B(Q(B(B(f*f)+B(k*k)))),c>B(1.1920928955078125e-7)){b=f,f=B(C[r+60>>2]/c),C[(i<<2)+A>>2]=b*f,C[(a<<2)+A>>2]=-n,n=B(k*f);break A;}t[(i<<2)+A>>2]=0,C[(a<<2)+A>>2]=-n;}n=B(0);}C[(e<<2)+A>>2]=n;},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f=B(0),n=0,b=B(0),o=B(0),k=0,c=B(0),u=0,l=B(0),s=0,d=0,v=0,g=0,_=0;if(a=E-16|0,(0|i)>=1)for(s=A+56|0,d=A+72|0,v=A- -64|0,g=A+68|0,u=A+76|0,_=A+60|0;;){b=B(C[v>>2]*B(.5)),A=t[g>>2],n=t[d>>2]<<2,f=C[r>>2],o=B(f*f),f=C[r+4>>2],o=B(o+B(f*f)),f=C[r+8>>2];A:{if(C[n+r>>2]>B(C[s>>2]*B(Q(B(o+B(f*f))))))t[(A<<2)+a>>2]=0,C[a+n>>2]=b,A=t[u>>2];else {if(k=A<<2,f=C[k+r>>2],A=t[u>>2],c=C[(A<<2)+r>>2],l=B(Q(B(B(f*f)+B(c*c)))),l>B(1.1920928955078125e-7)){o=f,f=B(C[_>>2]/l),C[a+k>>2]=o*f,C[a+n>>2]=-b,b=B(c*f);break A;}t[a+k>>2]=0,C[a+n>>2]=-b;}b=B(0);}if(C[(A<<2)+a>>2]=b,n=a+8|0,k=t[n+4>>2],A=e+8|0,t[A>>2]=t[n>>2],t[A+4>>2]=k,A=t[a+4>>2],t[e>>2]=t[a>>2],t[e+4>>2]=A,r=r+16|0,e=e+16|0,i=i+-1|0,!i)break;}},DA,function(A){return 6961;},function(A,r){A|=0,t[A+8>>2]=1065353216,t[A+12>>2]=0,t[A>>2]=0,t[A+4>>2]=0;},DA,function(A){return 6967;},function(A,r){A|=0,t[A+8>>2]=0,t[A+12>>2]=0,t[A>>2]=1065353216,t[A+4>>2]=0;},dA,YA,Dr,function(A,r,e){return A|=0,r|=0,e|=0,hA(A,r,e),t[r+28>>2]=t[A+32>>2],t[r+32>>2]=t[A+36>>2],t[r+36>>2]=t[A+40>>2],t[r+40>>2]=t[A+44>>2],t[r+12>>2]=t[A+16>>2],t[r+16>>2]=t[A+20>>2],t[r+20>>2]=t[A+24>>2],t[r+24>>2]=t[A+28>>2],t[r+48>>2]=0,t[r+44>>2]=t[A+48>>2],8389;},EA,function(A){A|=0,gA(EA(A));},er,dA,function(A,r,e){A|=0,r=B(r),e|=0;var i,a=B(0),f=0,n=B(0),b=B(0);i=E-96|0,E=i,a=B(yf[t[t[A>>2]+48>>2]](A)),f=i+44|0,t[f>>2]=0,t[f+4>>2]=0,t[i+52>>2]=1065353216,f=i+56|0,t[f>>2]=0,t[f+4>>2]=0,t[i+72>>2]=1065353216,t[i+92>>2]=0,f=i+84|0,t[f>>2]=0,t[f+4>>2]=0,f=i+76|0,t[f>>2]=0,t[f+4>>2]=0,t[i+36>>2]=0,t[i+40>>2]=0,t[i+32>>2]=1065353216,t[i+64>>2]=0,t[i+68>>2]=0,yf[t[t[A>>2]+8>>2]](A,i+32|0,i+16|0,i),t[e+12>>2]=0,r=B(r*B(.0833333283662796)),n=B(a+B(B(C[i>>2]-C[i+16>>2])*B(.5))),n=B(n+n),n=B(n*n),b=B(a+B(B(C[i+4>>2]-C[i+20>>2])*B(.5))),b=B(b+b),b=B(b*b),C[e+8>>2]=r*B(n+b),a=B(a+B(B(C[i+8>>2]-C[i+24>>2])*B(.5))),a=B(a+a),a=B(a*a),C[e+4>>2]=r*B(n+a),C[e>>2]=r*B(b+a),E=i+96|0;},function(A,r,e){A|=0,r|=0,e|=0;var i,a=0,f=B(0),n=B(0),b=0,o=B(0),k=B(0),c=0,u=0,l=0,s=B(0),d=B(0);if(i=E-2048|0,E=i,t[A>>2]=0,t[A+4>>2]=0,a=A+8|0,t[a>>2]=0,t[a+4>>2]=0,o=C[e>>2],k=C[e+4>>2],f=C[e+8>>2],n=B(B(B(o*o)+B(k*k))+B(f*f)),n<B(9999999747378752e-20)?o=B(1):(n=B(B(1)/B(Q(n))),s=B(f*n),d=B(k*n),o=B(o*n)),(0|yf[t[t[r>>2]+96>>2]](r))>=1)for(n=B(-0xde0b6b000000000);;){c=128;A:{r:{if(!(((0|yf[t[t[r>>2]+96>>2]](r))-u|0)>127||(c=(0|yf[t[t[r>>2]+96>>2]](r))-u|0,(0|c)>=1))){if(f=B(-3.4028234663852886e38),l=-1,B(-3.4028234663852886e38)>n)break r;break A;}for(e=0,a=i;yf[t[t[r>>2]+108>>2]](r,e,a),a=a+16|0,e=e+1|0,(0|c)!=(0|e);){}for(a=0,l=-1,f=B(-3.4028234663852886e38),e=i;k=B(B(B(o*C[e>>2])+B(d*C[e+4>>2]))+B(s*C[e+8>>2])),b=k>f,f=b?k:f,l=b?a:l,e=e+16|0,a=a+1|0,(0|a)!=(0|c);){}if(!(f>n))break A;}b=(l<<4)+i|0,e=t[b+12>>2],a=A+8|0,t[a>>2]=t[b+8>>2],t[a+4>>2]=e,e=t[b+4>>2],t[A>>2]=t[b>>2],t[A+4>>2]=e,n=f;}if(u=u+128|0,!((0|u)<(0|yf[t[t[r>>2]+96>>2]](r))))break;}E=i+2048|0;},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f=0,n=0,b=B(0),o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=B(0),g=0,_=0,m=0,R=B(0),G=B(0),h=B(0);if(a=E-2048|0,E=a,!((0|i)<1)){for(n=e+12|0,f=i;t[n>>2]=-581039253,n=n+16|0,f=f+-1|0,f;){}if(!((0|i)<1))for(;;){if((0|yf[t[t[A>>2]+96>>2]](A))>=1)for(f=l<<4,c=f+e|0,s=c+12|0,d=r+f|0,_=d+8|0,m=d+4|0,k=0;;){u=128;A:{r:{if(!(((0|yf[t[t[A>>2]+96>>2]](A))-k|0)>127||(u=(0|yf[t[t[A>>2]+96>>2]](A))-k|0,(0|u)>=1))){if(b=B(-3.4028234663852886e38),o=-1,B(-3.4028234663852886e38)>C[s>>2])break r;break A;}for(n=0,f=a;yf[t[t[A>>2]+108>>2]](A,n,f),f=f+16|0,n=n+1|0,(0|u)!=(0|n);){}for(R=C[_>>2],G=C[m>>2],h=C[d>>2],f=0,o=-1,b=B(-3.4028234663852886e38),n=a;v=B(B(B(h*C[n>>2])+B(G*C[n+4>>2]))+B(R*C[n+8>>2])),g=v>b,b=g?v:b,o=g?f:o,n=n+16|0,f=f+1|0,(0|u)!=(0|f);){}if(!(b>C[s>>2]))break A;}f=(o<<4)+a|0,o=t[f+12>>2],n=c+8|0,t[n>>2]=t[f+8>>2],t[n+4>>2]=o,n=t[f+4>>2],t[c>>2]=t[f>>2],t[c+4>>2]=n,C[s>>2]=b;}if(k=k+128|0,!((0|k)<(0|yf[t[t[A>>2]+96>>2]](A))))break;}if(l=l+1|0,(0|l)==(0|i))break;}}E=a+2048|0;},function(A,r){A|=0,r|=0;var e,i=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=B(0),v=0,g=0,m=0,R=0,G=B(0),h=0,y=0,p=0,D=0,w=B(0),W=0,F=0,Z=0,Y=0,N=0,V=0,I=0,J=0,X=0,M=0,S=0,T=0,U=0,j=0,O=0,H=0,z=B(0),P=B(0),L=0,K=0,q=0,$=0,AA=0,rA=0,eA=0,iA=0,aA=0,fA=0,nA=0,tA=0,bA=0,oA=0,kA=0,cA=0,uA=0,lA=0,sA=0,dA=0,vA=0,_A=0,BA=0,mA=0,RA=B(0),GA=B(0),hA=B(0),yA=0,QA=0,pA=0,DA=0,wA=0,WA=0,FA=0,ZA=0,YA=0,EA=0,NA=0,IA=0,JA=0,xA=0,SA=0,TA=0,UA=0,jA=0,OA=0,HA=0,zA=0,LA=0,Ar=0,rr=0,er=B(0),ir=0,ar=0,fr=0,nr=0,tr=0,br=B(0),or=0,kr=0,cr=0,ur=0,lr=0,sr=0,dr=0,vr=0,Cr=0,gr=0,_r=0,Br=0,mr=0,Rr=0,Gr=0,hr=0,yr=0,Qr=0,pr=0,Dr=0,wr=0,Wr=B(0),Fr=B(0),Zr=B(0),Yr=B(0),Er=B(0),Nr=B(0),Vr=B(0),Ir=0,Jr=0,Xr=0;e=E-240|0,E=e,i=t[A+56>>2],i&&(yf[t[t[i>>2]>>2]](i),gA(t[A+56>>2])),i=CA(132,16),function(A){var r=0;t[A>>2]=7120,a[A+20|0]=1,t[A+16>>2]=0,a[A+40|0]=1,r=A+8|0,t[r>>2]=0,t[r+4>>2]=0,t[A+36>>2]=0,a[A+60|0]=1,r=A+28|0,t[r>>2]=0,t[r+4>>2]=0,t[A+56>>2]=0,A=A+48|0,t[A>>2]=0,t[A+4>>2]=0;}(i),t[A+56>>2]=i,t[e+228>>2]=0,t[e+220>>2]=0,t[e+224>>2]=0,a[e+232|0]=1,(0|yf[t[t[A>>2]+96>>2]](A))>=1?(bA=8,Cr=-1,SA=e+228|0,fr=4,i=1):i=0;A:for(;;){r:{e:{i:{a:{f:{n:{t:{b:{o:{k:{c:{u:{l:{s:{d:{v:{C:{g:{_:{B:{m:{R:{G:{h:{y:{Q:{if(!i){if(a[e+188|0]=1,t[e+184>>2]=0,a[e+208|0]=1,i=e+176|0,t[i>>2]=0,t[i+4>>2]=0,t[e+204>>2]=0,i=e+196|0,t[i>>2]=0,t[i+4>>2]=0,t[e+164>>2]=0,a[e+168|0]=1,t[e+156>>2]=0,t[e+160>>2]=0,r){if(t[e+60>>2]=0,q=1,a[e+64|0]=1,t[e+52>>2]=0,t[e+56>>2]=0,XA(e+216|0,e+48|0),t[e+140>>2]=0,a[e+144|0]=1,t[e+132>>2]=0,t[e+136>>2]=0,t[e+52>>2]<1)break Q;TA=4,UA=12,gr=e+60|0,oA=8,QA=16,_r=-1,pA=0,o=2;break s;}PA(e+152|0,kA,t[e+220>>2]);break y;}p:{D:{w:switch(0|o){case 0:if(s=$?$<<1:1,(0|$)>=(0|s))break B;f=s?CA(s<<fr,16):0;W:{if((0|$)>=1)for(i=f,n=kA;c=t[n+4>>2],t[i>>2]=t[n>>2],t[i+4>>2]=c,k=n+bA|0,c=t[k+4>>2],l=i+bA|0,t[l>>2]=t[k>>2],t[l+4>>2]=c,i=i+16|0,n=n+16|0,$=$+Cr|0,$;){}else if(!kA)break W;b[e+232|0]&&gA(kA),t[SA>>2]=0;}t[SA>>2]=f,a[e+232|0]=1,t[(e+216|0)+bA>>2]=s;break D;case 4:break G;case 3:break h;case 2:break p;case 1:break w;default:break R;}f=kA;}if(t[e+220>>2]=jA+1,i=t[e+156>>2],c=jA<<fr,n=c+f|0,f=n,t[f>>2]=t[e+152>>2],t[f+4>>2]=i,f=(e+152|0)+bA|0,i=t[f+4>>2],n=n+bA|0,t[n>>2]=t[f>>2],t[n+4>>2]=i,kA=t[SA>>2],yf[t[t[A>>2]+108>>2]](A,OA,c+kA|0),OA=OA+1|0,(0|OA)<(0|yf[t[t[A>>2]+96>>2]](A))){if($=t[(e+216|0)+bA>>2],jA=t[e+220>>2],(0|$)!=(0|jA))break m;o=0;break C;}i=0;continue;}if(l=(e+104|0)+oA|0,f=t[gr>>2]+(pA<<TA)|0,t[l>>2]=t[f+oA>>2],i=t[f+4>>2],t[e+104>>2]=t[f>>2],t[e+108>>2]=i,d=B(C[f+12>>2]-B(yf[t[t[A>>2]+48>>2]](A))),n=t[e+132>>2],o=(e+128|0)+oA|0,(0|n)==t[o>>2]&&(v=n?n<<q:q,!((0|n)>=(0|v)))){p:{D:{if(v){if(R=CA(v<<TA,QA),n=t[e+132>>2],(0|n)>=(0|q))break D;break p;}if(R=0,(0|n)<(0|q))break p;}for(i=0;s=t[(e+128|0)+UA>>2]+i|0,f=t[s+4>>2],k=i+R|0,t[k>>2]=t[s>>2],t[k+4>>2]=f,c=s+oA|0,f=t[c+4>>2],k=k+oA|0,t[k>>2]=t[c>>2],t[k+4>>2]=f,i=i+QA|0,n=n+_r|0,n;){}}f=(e+128|0)+UA|0,i=t[f>>2],i&&(b[(e+128|0)+QA|0]&&gA(i),t[f>>2]=0),t[f>>2]=R,a[(e+128|0)+QA|0]=q,t[o>>2]=v,n=t[e+132>>2];}if(i=t[e+108>>2],f=t[(e+128|0)+UA>>2]+(n<<TA)|0,t[f>>2]=t[e+104>>2],t[f+4>>2]=i,C[f+12>>2]=d,t[f+oA>>2]=t[l>>2],t[e+132>>2]=t[e+132>>2]+q,pA=q+pA|0,(0|pA)<t[e+52>>2])break _;}t[e+116>>2]=0,a[e+120|0]=q,t[e+108>>2]=0,t[e+112>>2]=0,MA(e+128|0,e+104|0),PA(e+152|0,t[e+116>>2],t[e+108>>2]),i=t[e+116>>2],i&&(b[e+120|0]&&gA(i),t[e+116>>2]=0),i=t[e+140>>2],i&&(b[e+144|0]&&gA(i),t[e+140>>2]=0),i=t[e+60>>2],i&&(b[e- -64|0]&&gA(i),t[e+60>>2]=0);}if(N=t[e+196>>2],(0|N)>=1){for(DA=CA(N<<4,16),i=DA,n=N;f=t[e+52>>2],t[i>>2]=t[e+48>>2],t[i+4>>2]=f,c=e+56|0,f=t[c+4>>2],k=i+8|0,t[k>>2]=t[c>>2],t[k+4>>2]=f,i=i+16|0,n=n+-1|0,n;){}i=DA;}else DA=0,i=0;wA=i,t[e+140>>2]=0,a[e+144|0]=1,t[e+132>>2]=0,t[e+136>>2]=0,i=e+63|0,a[0|i]=0,a[i+1|0]=0,a[i+2|0]=0,a[i+3|0]=0,i=e+56|0,t[i>>2]=0,t[i+4>>2]=0,t[e+48>>2]=0,t[e+52>>2]=0;y:if((0|N)>-1){if(!N)break y;for(KA(e+128|0,N),l=e+48|3,n=20,c=e+140|0,f=N;k=b[l+4|0]|b[l+5|0]<<8|b[l+6|0]<<16|b[l+7|0]<<24,o=t[c>>2]+n|0,i=b[0|l]|b[l+1|0]<<8|b[l+2|0]<<16|b[l+3|0]<<24,a[0|o]=i,a[o+1|0]=i>>>8,a[o+2|0]=i>>>16,a[o+3|0]=i>>>24,a[o+4|0]=k,a[o+5|0]=k>>>8,a[o+6|0]=k>>>16,a[o+7|0]=k>>>24,a[o+-4|0]=1,t[o+-8>>2]=0,i=o+-16|0,t[i>>2]=0,t[i+4>>2]=0,i=l+8|0,k=b[i+4|0]|b[i+5|0]<<8|b[i+6|0]<<16|b[i+7|0]<<24,o=o+8|0,i=b[0|i]|b[i+1|0]<<8|b[i+2|0]<<16|b[i+3|0]<<24,a[0|o]=i,a[o+1|0]=i>>>8,a[o+2|0]=i>>>16,a[o+3|0]=i>>>24,a[o+4|0]=k,a[o+5|0]=k>>>8,a[o+6|0]=k>>>16,a[o+7|0]=k>>>24,n=n+36|0,f=f+-1|0,f;){}}else for(n=-1^N,o=_(N,36)+8|0,c=e+140|0,i=0;;){if(l=i+o|0,f=l+-4|0,k=l+4|0,i=t[k>>2],i&&(b[l+8|0]&&gA(i),t[k>>2]=0),t[f>>2]=0,t[k>>2]=0,t[l>>2]=0,a[l+8|0]=1,!n)break y;o=o+36|0,n=n+-1|0,i=t[c>>2];}if(t[e+132>>2]=N,h=t[A+56>>2],R=h+8|0,c=t[R>>2],n=t[e+156>>2],(0|c)<(0|n)){if(t[h+12>>2]<(0|n)){y:{Q:{if(n){if(f=CA(n<<4,16),o=t[h+8>>2],(0|o)>=1)break Q;break y;}if(f=0,o=c,(0|o)<1)break y;}for(i=0;v=t[h+16>>2]+i|0,k=t[v+4>>2],s=i+f|0,l=s,t[l>>2]=t[v>>2],t[l+4>>2]=k,l=v+8|0,k=t[l+4>>2],s=s+8|0,t[s>>2]=t[l>>2],t[s+4>>2]=k,i=i+16|0,o=o+-1|0,o;){}}k=h+16|0,i=t[k>>2],i&&(b[h+20|0]&&gA(i),t[h+16>>2]=0),t[k>>2]=f,a[h+20|0]=1,t[h+12>>2]=n;}for(i=c<<4,o=n-c|0;f=t[e+52>>2],k=t[h+16>>2]+i|0,t[k>>2]=t[e+48>>2],t[k+4>>2]=f,c=e+56|0,f=t[c+4>>2],k=k+8|0,t[k>>2]=t[c>>2],t[k+4>>2]=f,i=i+16|0,o=o+-1|0,o;){}}if(t[R>>2]=n,(0|n)>=1)for(i=0,l=A+56|0,o=e+164|0;s=t[o>>2]+i|0,f=t[s+4>>2],k=t[t[l>>2]+16>>2]+i|0,t[k>>2]=t[s>>2],t[k+4>>2]=f,c=s+8|0,f=t[c+4>>2],k=k+8|0,t[k>>2]=t[c>>2],t[k+4>>2]=f,i=i+16|0,n=n+-1|0,n;){}if((0|N)<1)break a;WA=2,Br=e+204|0,eA=12,nr=32,mr=e+184|0,Rr=36,tr=8,V=4,I=1,Gr=-1,HA=16,br=B(1),or=24,hr=e+68|0,yr=1900671690,Qr=28,pr=A+56|0,AA=0,o=3;break u;}sA=0,kr=t[mr>>2]+_(t[t[Br>>2]+(AA<<WA)>>2],eA)|0,iA=kr,Z=0;break t;}G:if((0|g)==(0|aA)){h:{y:{if(aA=g?g<<FA:FA,(0|g)<(0|aA)){if(!aA)break y;cA=CA(aA<<cr,Dr);break h;}aA=g;break G;}cA=0;}h:{if(g)for(n=0,i=cA;t[i>>2]=t[J>>2],i=i+ur|0,J=J+ur|0,n=n+FA|0,(0|g)!=(0|n);){}else if(!J){aA=1;break h;}gA(lr);}lr=cA,J=cA;}if(t[(g<<cr)+J>>2]=g,g=g+FA|0,(0|g)<t[e+132>>2])break g;zA=20,ZA=e+68|0,j=-1,X=2,D=16,y=4,fA=36,dA=12,uA=e+140|0,lA=28,p=24,wr=-2,Wr=B(.9990000128746033),u=1,O=8,vA=e+40|0,LA=A+56|0,sr=32,Fr=B(1),o=5;break k;}if(i=g+j|0,f=t[(i<<X)+J>>2],m=CA(y,D),t[m>>2]=f,(0|i)>=(0|u)){Ar=t[uA>>2],f=Ar+_(f,fA)|0,Zr=C[f+20>>2],Yr=C[f+lA>>2],Er=C[f+p>>2],_A=g+wr|0,M=1,g=i,dr=m,S=m,T=1;break o;}T=1,S=m,g=i;break b;}o=1;break v;}o=1;break d;}o=2;break l;}o=4;break c;}i=1;continue;}i=1;continue;}i=1;continue;}i=1;continue;}i=1;continue;}i=1;continue;}i=1;continue;}i=1;continue;}Z=1;break n;}i=1;break f;}i=2;break f;}i=2;}f:for(;;){n:{t:{b:{o:{k:{c:{u:{l:{s:{d:{v:{C:{g:{_:{B:{m:{R:{G:{h:{y:{Q:{p:{D:{w:{W:{F:{Z:{switch(0|i){case 0:if(i=t[nA>>2],i&&(b[0|rr]&&gA(i),t[nA>>2]=0),i=t[H>>2],i&&(b[0|BA]&&gA(i),t[H>>2]=0),i=t[Y>>2],!i)break Z;b[0|mA]&&gA(i),t[Y>>2]=0;break Z;case 1:YA=0,Z=5;break B;}Y:switch(0|Z){case 0:if(h=_(AA,Rr),R=(e+128|0)+eA|0,K=h+t[R>>2]|0,EA=K+V|0,s=t[8+(_(t[iA+4>>2],eA)+iA|0)>>2],o=t[K+4>>2],(0|o)==t[K+8>>2]&&(v=o?o<<I:I,!((0|o)>=(0|v)))){v?(c=CA(v<<WA,HA),o=t[EA>>2]):c=0,k=K+tr|0,l=K+eA|0,f=t[K+12>>2];E:{if((0|o)>=(0|I))for(i=c,n=f;t[i>>2]=t[n>>2],i=i+V|0,n=n+V|0,o=o+Gr|0,o;){}else if(!f)break E;b[K+16|0]&&gA(f),t[l>>2]=0,o=t[EA>>2];}t[l>>2]=c,t[k>>2]=v,a[K+16|0]=I;}if(t[t[K+12>>2]+(o<<WA)>>2]=s,t[EA>>2]=t[EA>>2]+I,(0|sA)<=(0|I)&&(i=t[(e+152|0)+eA>>2],f=i+(s<<V)|0,er=C[f+4>>2],i=i+(t[iA+8>>2]<<V)|0,w=C[i+4>>2],z=C[f>>2],P=C[i>>2],G=C[f+8>>2],d=C[i+8>>2],i=(e+48|0)+(sA<<V)|0,t[i+12>>2]=0,z=B(P-z),P=B(w-er),d=B(d-G),G=B(br/B(Q(B(B(B(z*z)+B(P*P))+B(d*d))))),C[i+8>>2]=d*G,C[i+4>>2]=P*G,C[i>>2]=z*G,sA=I+sA|0),i=_(t[V+iA>>2],eA)+iA|0,iA=_(t[i>>2],eA)+i|0,(0|iA)!=(0|kr))break w;E:{N:{if((0|sA)!=(0|WA)){if(i=(AA<<V)+wA|0,t[i>>2]=0,t[i+4>>2]=0,i=i+tr|0,t[i>>2]=0,t[i+4>>2]=0,k=h+t[R>>2]|0,f=t[k+4>>2],(0|f)>=(0|I))break N;}else if(i=(AA<<V)+wA|0,t[i+12>>2]=0,w=C[hr>>2],z=C[e+48>>2],d=C[e+52>>2],P=C[(e+48|0)+HA>>2],G=B(B(w*z)-B(d*P)),er=G,Nr=B(G*G),G=C[(e+48|0)+or>>2],Vr=B(d*G),d=C[e+56>>2],w=B(Vr-B(d*w)),G=B(B(d*P)-B(G*z)),d=B(br/B(Q(B(Nr+B(B(w*w)+B(G*G)))))),C[i+8>>2]=er*d,C[i+4>>2]=G*d,d=B(w*d),C[i>>2]=d,f=t[R>>2],n=f+h|0,C[n+20>>2]=d,t[n+or>>2]=t[i+4>>2],i=t[i+8>>2],t[n+nr>>2]=yr,t[n+Qr>>2]=i,k=f+h|0,f=t[k+4>>2],(0|f)>=(0|I))break N;w=B(1.0000000150474662e30);break E;}for(i=t[k+12>>2],n=(AA<<V)+wA|0,z=C[n+8>>2],P=C[n+4>>2],G=C[n>>2],n=t[t[pr>>2]+HA>>2],w=B(1.0000000150474662e30),o=0;c=n+(t[i>>2]<<V)|0,d=B(B(B(C[c>>2]*G)+B(C[c+4>>2]*P))+B(C[c+8>>2]*z)),w=w>d?d:w,i=i+V|0,o=o+I|0,(0|o)<(0|f);){}}if(C[k+nr>>2]=-w,AA=I+AA|0,(0|AA)!=(0|N))break W;break a;case 1:E:{N:{V:{I:{J:{X:{if(c=t[(_A<<X)+J>>2],i=_(c,fA)+Ar|0,!(B(B(B(Zr*C[i+20>>2])+B(Er*C[i+p>>2]))+B(Yr*C[i+lA>>2]))>Wr^u)){if((0|M)!=(0|T))break X;if(f=M?M<<u:u,(0|M)>=(0|f))break X;if(!f)break J;S=CA(f<<X,D);break I;}if(f=M,(0|_A)>=(0|u))break N;break E;}f=M;break V;}S=0;}I:{if((0|M)>=(0|u))for(i=S;t[i>>2]=t[m>>2],i=i+y|0,m=m+y|0,M=M+j|0,M;){}else if(!m)break I;gA(dr);}dr=S,m=S;}t[(T<<X)+m>>2]=c,T=u+T|0;V:if(!((0|g)<(0|u))){for(n=0,i=J;;){if(t[i>>2]!=(0|c)){if(i=i+y|0,n=n+u|0,(0|n)<(0|g))continue;break V;}break;}(0|g)<=(0|n)||(n=i,g=g+j|0,i=(g<<X)+J|0,t[n>>2]=t[i>>2],t[i>>2]=c);}if((0|_A)<(0|u))break E;}_A=j+_A|0,Ar=t[uA>>2],M=f,Z=1;break h;}if((0|T)<=(0|u))break Z;L=0,Y=(e+104|0)+dA|0,t[Y>>2]=0,mA=(e+104|0)+D|0,a[0|mA]=u,t[e+108>>2]=0,t[e+112>>2]=0,t[vA>>2]=0,t[vA+4>>2]=0,t[e+32>>2]=0,t[e+36>>2]=0,RA=B(0),W=0,GA=B(0),hA=B(0),NA=0,Z=2;break G;case 2:if(i=t[uA>>2]+_(t[(NA<<X)+m>>2],fA)|0,G=C[i+p>>2],d=C[i+20>>2],C[vA>>2]=C[i+lA>>2]+RA,C[e+32>>2]=d+hA,C[e+36>>2]=G+GA,rA=t[i+4>>2],(0|rA)<(0|u))break v;Ir=i+y|0,Jr=i+dA|0,IA=0,i=0;break g;case 3:if(o=_(p,tA),k=(o+t[nA>>2]|0)+zA|0,c=(e+48|0)+O|0,t[c>>2]==(0|F)&&(l=F?F<<u:u,!((0|F)>=(0|l)))){E:{N:{V:{if(l){if(f=CA(l<<X,D),U=t[H>>2],F=t[e+52>>2],(0|F)<(0|u))break V;}else if(f=0,U=t[H>>2],(0|F)<(0|u))break V;for(i=f,n=U;t[i>>2]=t[n>>2],i=i+y|0,n=n+y|0,F=F+j|0,F;){}break N;}if(!U)break E;}b[0|BA]&&gA(U),t[H>>2]=0,F=t[e+52>>2];}t[H>>2]=f,a[0|BA]=u,t[c>>2]=l;}t[t[H>>2]+(F<<X)>>2]=t[k>>2],F=t[e+52>>2]+u|0,t[e+52>>2]=F;E:{N:{if(U=t[e+108>>2],(0|U)>=(0|u))for(i=t[Y>>2]+zA|0,f=t[20+(o+t[nA>>2]|0)>>2],n=0;;){if((0|f)==t[i>>2])break N;if(i=i+p|0,n=n+u|0,!((0|n)<(0|U)))break;}if(tA=u+tA|0,(0|tA)<t[e+12>>2])break D;break E;}if(t[i>>2]=j,tA=u+tA|0,(0|tA)<t[e+12>>2])break p;}if((0|U)<(0|u))break s;break d;case 4:break Y;default:break F;}if(ir=t[20+(_(p,JA)+Xr|0)>>2],(0|ir)==(0|j))break C;if((0|T)<=0){xA=0,i=1;break g;}yA=0,i=2;break g;}if((0|T)<(0|u))break l;i=1;continue;}s=(e+48|0)+D|0,a[0|s]=u,v=(e+48|0)+dA|0,t[v>>2]=0,i=t[(YA<<X)+m>>2],t[e+52>>2]=0,t[e+56>>2]=0;F:{Z:{Y:{E:{if(R=t[uA>>2]+_(i,fA)|0,o=t[R+4>>2],(0|o)>=(0|u)){if(l=o<<X,k=CA(l,D),c=t[v>>2],f=t[e+52>>2],(0|f)<(0|u))break E;for(i=k,n=c;t[i>>2]=t[n>>2],i=i+y|0,n=n+y|0,f=f+j|0,f;){}break Y;}t[e+52>>2]=o;break F;}if(!c)break Z;}b[0|s]&&gA(c);}for(t[v>>2]=k,a[0|s]=u,t[(e+48|0)+O>>2]=o,x(k,0,l),t[e+52>>2]=o,i=t[R+12>>2],n=t[v>>2];t[n>>2]=t[i>>2],n=n+y|0,i=i+y|0,o=o+j|0,o;){}}if(i=t[R+24>>2],t[ZA>>2]=t[R+20>>2],t[ZA+4>>2]=i,f=R+lA|0,i=t[f+4>>2],n=O+ZA|0,t[n>>2]=t[f>>2],t[n+4>>2]=i,qA(t[LA>>2]+p|0,e+48|0),i=t[v>>2],i&&(b[0|s]&&gA(i),t[v>>2]=0),YA=u+YA|0,(0|YA)!=(0|T))break Q;break l;}o=3,i=1;continue A;}Z=0;break y;}Z=3;break R;}Z=3;break m;}Z=5;break _;}i=2;continue;}i=2;continue;}i=2;continue;}i=2;continue;}i=2;continue;}i=2;continue;}i=2;continue;}for(;;){g:{_:{B:{m:{R:{switch(0|i){case 0:v=t[t[Jr>>2]+(IA<<X)>>2],c=t[t[LA>>2]+D>>2]+(v<<y)|0,f=c+O|0,i=t[f+4>>2],k=(e+8|0)+O|0,n=k,t[n>>2]=t[f>>2],t[n+4>>2]=i,i=t[c+4>>2],t[e+8>>2]=t[c>>2],t[e+12>>2]=i;G:{if((0|W)>=(0|u)){for(i=t[Y>>2]+zA|0,n=0;;){if((0|v)==t[i>>2])break G;if(i=i+p|0,n=n+u|0,!((0|n)<(0|L)))break;}W=L;}i=t[k+4>>2],R=(e+48|0)+O|0,f=R,t[f>>2]=t[k>>2],t[f+4>>2]=i,i=t[e+12>>2],t[e+48>>2]=t[e+8>>2],t[e+52>>2]=i;h:{y:{Q:{p:{D:{w:{if(s=(e+104|0)+O|0,t[s>>2]==(0|W)&&(rA=W?W<<u:u,!((0|W)>=(0|rA)))){if(!rA)break w;if(f=CA(_(p,rA),D),c=t[Y>>2],L=t[e+108>>2],W=L,(0|W)<(0|u))break p;break D;}L=W;break h;}if(f=0,c=t[Y>>2],(0|W)<(0|u))break p;}for(i=f,n=c;k=t[n+4>>2],t[i>>2]=t[n>>2],t[i+4>>2]=k,o=n+D|0,k=t[o+4>>2],l=i+D|0,t[l>>2]=t[o>>2],t[l+4>>2]=k,o=n+O|0,k=t[o+4>>2],l=i+O|0,t[l>>2]=t[o>>2],t[l+4>>2]=k,i=i+p|0,n=n+p|0,W=W+j|0,W;){}break Q;}if(!c)break y;}b[0|mA]&&(gA(c),L=t[e+108>>2]),t[Y>>2]=0;}t[Y>>2]=f,a[0|mA]=u,t[s>>2]=rA;}i=t[e+52>>2],f=t[Y>>2]+_(p,L)|0,t[f>>2]=t[e+48>>2],t[f+4>>2]=i,t[f+20>>2]=v,t[f+D>>2]=t[(e+48|0)+D>>2],i=t[R+4>>2],f=f+O|0,t[f>>2]=t[R>>2],t[f+4>>2]=i,L=t[e+108>>2]+u|0,t[e+108>>2]=L,rA=t[Ir>>2];}if(W=L,IA=u+IA|0,(0|IA)<(0|rA))break B;break v;case 1:if(i=_(fA,xA)+vr|0,f=t[i+4>>2],(0|f)>0)for(i=t[i+12>>2],n=0;;){if(t[i>>2]==(0|ir))break R;if(i=i+y|0,n=n+u|0,!((0|n)<(0|f)))break;}if(xA=u+xA|0,(0|xA)<(0|ar))break _;break C;}i=m,n=0;G:{for(;;){if(t[i>>2]==(0|yA))break G;if(i=i+y|0,n=n+u|0,!((0|n)<(0|T)))break;}if(i=_(fA,yA)+vr|0,f=t[i+4>>2],!((0|f)<(0|u)))for(i=t[i+12>>2],n=0;;){if(t[i>>2]==(0|ir))break m;if(i=i+y|0,n=n+u|0,!((0|n)<(0|f)))break;}}if(yA=u+yA|0,(0|yA)<(0|ar))break g;break C;}i=0;continue f;}i=0;continue f;}i=0;continue;}i=1;continue;}i=2;}}if(JA=u+JA|0,(0|JA)>=(0|U))break s;Z=4,i=2;continue;}if(RA=C[vA>>2],GA=C[e+36>>2],hA=C[e+32>>2],NA=u+NA|0,(0|NA)!=(0|T))break k;if(t[e+52>>2]=0,t[e+56>>2]=0,i=t[uA>>2]+_(t[m>>2],fA)|0,t[ZA>>2]=t[i+20>>2],t[(e+48|0)+p>>2]=t[i+p>>2],t[(e+48|0)+lA>>2]=t[i+lA>>2],H=(e+48|0)+dA|0,t[H>>2]=0,BA=(e+48|0)+D|0,a[0|BA]=u,t[(e+48|0)+sr>>2]=t[i+sr>>2],nA=(e+8|0)+dA|0,t[nA>>2]=0,rr=(e+8|0)+D|0,a[0|rr]=u,d=B(Fr/B(Q(B(B(B(hA*hA)+B(GA*GA))+B(RA*RA))))),C[vA>>2]=RA*d,t[e+12>>2]=0,t[e+16>>2]=0,C[e+36>>2]=GA*d,C[e+32>>2]=hA*d,$A(e+104|0,e+8|0,e+32|0),t[e+12>>2]>0){tA=0,F=t[e+52>>2],Z=3;break t;}if(U=t[e+108>>2],(0|U)<(0|u))break s;}if(ar=t[e+132>>2],!((0|ar)<(0|u))){vr=t[uA>>2],Xr=t[Y>>2],JA=0;break o;}}if(qA(t[LA>>2]+p|0,e+48|0),i=t[nA>>2],i&&(b[0|rr]&&gA(i),t[nA>>2]=0),i=t[H>>2],i&&(b[0|BA]&&gA(i),t[H>>2]=0),i=t[Y>>2],i){if(b[0|mA]&&gA(i),t[Y>>2]=0,m)break u;break c;}}if(!m)break c;}gA(S);}if(!g){if(VA(t[A+56>>2]),J&&gA(cA),f=t[e+132>>2],(0|f)>=1)break i;break e;}o=5,i=1;continue A;}Z=2;break b;}Z=4;break n;}i=2;continue;}i=2;continue;}i=2;}}if(FA=1,t[e+132>>2]>=1){g=0,ur=4,cr=2,Dr=16,J=0,lr=0,cA=0,aA=0;break r;}if(VA(t[A+56>>2]),f=t[e+132>>2],(0|f)<1)break e;}for(i=e+140|0,n=8;m=t[i>>2]+n|0,r=m+-4|0,S=m+4|0,A=t[S>>2],A&&(b[m+8|0]&&gA(A),t[S>>2]=0),t[r>>2]=0,t[S>>2]=0,t[m>>2]=0,a[m+8|0]=1,n=n+36|0,f=f+-1|0,f;){}}return A=t[e+140>>2],A&&(b[e+144|0]&&gA(A),t[e+140>>2]=0),wA&&gA(DA),r=e+204|0,A=t[r>>2],A&&(b[e+208|0]&&gA(A),t[e+204>>2]=0),t[r>>2]=0,a[e+208|0]=1,A=e+196|0,t[A>>2]=0,t[A+4>>2]=0,r=e+184|0,A=t[r>>2],A&&(b[e+188|0]&&gA(A),t[e+184>>2]=0),t[r>>2]=0,a[e+188|0]=1,A=e+176|0,t[A>>2]=0,t[A+4>>2]=0,A=t[e+164>>2],A&&(b[e+168|0]&&gA(A),t[e+164>>2]=0),A=t[e+228>>2],A&&(b[e+232|0]&&gA(A),t[e+228>>2]=0),E=e+240|0,1;}o=4,i=1;}},dA,Ar,function(A,r){A|=0,r|=0;var e,i=B(0);e=E-96|0,E=e,YA(A,r),a[A+92|0]=1,b[1696]||(t[403]=0,t[404]=0,t[401]=0,t[402]=0,t[400]=1065353216,t[405]=1065353216,t[408]=0,t[409]=0,t[406]=0,t[407]=0,t[412]=-1082130432,t[410]=1065353216,t[411]=0,t[415]=0,t[416]=0,t[413]=0,t[414]=0,t[417]=-1082130432,t[420]=0,t[421]=0,t[418]=0,t[419]=0,t[422]=-1082130432,t[423]=0,a[1696]=1),r=x(e,0,96),yf[t[t[A>>2]+76>>2]](A,1600,r,6),i=C[A+48>>2],C[A+76>>2]=C[r>>2]+i,C[A+60>>2]=C[r+48>>2]-i,C[A+80>>2]=i+C[r+20>>2],C[A- -64>>2]=C[r+68>>2]-i,C[A+84>>2]=i+C[r+40>>2],C[A+68>>2]=C[r+88>>2]-i,E=r+96|0;},cr,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0,Ar(A,r,e,i);},function(A){return 8588;},br,function(A){return A|=0,A=t[A+96>>2]+-2|0,A>>>0<=2?t[7684+(A<<2)>>2]:0;},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a=0,f=0;A:{r:{e:{i:{a:{f:{n:{t:{b:{if(a=t[A+96>>2],4!=(0|a)){if(3==(0|a))break b;if(2!=(0|a))break a;break i;}if(r>>>0>5)break a;switch(r-1|0){case 1:break e;case 0:break r;case 4:break f;case 3:break n;case 2:break t;}break i;}b:{if(2!=(0|r)){if(1==(0|r))break b;if(r)break a;break i;}break e;}break r;}r=t[A+104>>2],t[e>>2]=t[A+100>>2],t[e+4>>2]=r,r=e+8|0,e=A+108|0,a=t[e+4>>2],t[r>>2]=t[e>>2],t[r+4>>2]=a;break A;}a=A+124|0,f=t[a+4>>2],r=e+8|0,t[r>>2]=t[a>>2],t[r+4>>2]=f,r=A+116|0,a=t[r+4>>2],t[e>>2]=t[r>>2],t[e+4>>2]=a;break A;}a=A+140|0,f=t[a+4>>2],r=e+8|0,t[r>>2]=t[a>>2],t[r+4>>2]=f,r=A+132|0,a=t[r+4>>2],t[e>>2]=t[r>>2],t[e+4>>2]=a,e=A+156|0,a=t[e+4>>2],r=i+8|0,t[r>>2]=t[e>>2],t[r+4>>2]=a,A=A+148|0,r=t[A+4>>2],t[i>>2]=t[A>>2],t[i+4>>2]=r;}return;}return r=t[A+104>>2],t[e>>2]=t[A+100>>2],t[e+4>>2]=r,r=e+8|0,e=A+108|0,a=t[e+4>>2],t[r>>2]=t[e>>2],t[r+4>>2]=a,e=A+124|0,a=t[e+4>>2],r=i+8|0,t[r>>2]=t[e>>2],t[r+4>>2]=a,A=A+116|0,r=t[A+4>>2],t[i>>2]=t[A>>2],void(t[i+4>>2]=r);}return a=A+140|0,f=t[a+4>>2],r=e+8|0,t[r>>2]=t[a>>2],t[r+4>>2]=f,r=A+132|0,a=t[r+4>>2],t[e>>2]=t[r>>2],t[e+4>>2]=a,e=A+108|0,a=t[e+4>>2],r=i+8|0,t[r>>2]=t[e>>2],t[r+4>>2]=a,r=t[A+104>>2],t[i>>2]=t[A+100>>2],void(t[i+4>>2]=r);}return a=A+124|0,f=t[a+4>>2],r=e+8|0,t[r>>2]=t[a>>2],t[r+4>>2]=f,r=A+116|0,a=t[r+4>>2],t[e>>2]=t[r>>2],t[e+4>>2]=a,e=A+140|0,a=t[e+4>>2],r=i+8|0,t[r>>2]=t[e>>2],t[r+4>>2]=a,A=A+132|0,r=t[A+4>>2],t[i>>2]=t[A>>2],void(t[i+4>>2]=r);}e=A+156|0,a=t[e+4>>2],r=i+8|0,t[r>>2]=t[e>>2],t[r+4>>2]=a,A=A+148|0,r=t[A+4>>2],t[i>>2]=t[A>>2],t[i+4>>2]=r;},function(A,r,e){var i,a;A|=0,r|=0,e|=0,A=(r<<4)+A|0,r=A+108|0,a=t[r+4>>2],i=e+8|0,t[i>>2]=t[r>>2],t[i+4>>2]=a,A=A+100|0,r=t[A+4>>2],t[e>>2]=t[A>>2],t[e+4>>2]=r;},function(A){return A|=0,A=t[A+96>>2],0|(4==(0|A)?4:(3==(0|A))<<1);},or,function(A,r,e){return e=B(e),0;},kr,sA,Cr,function(A,r,e){A|=0,r|=0,e|=0,t[A+24>>2]=e,t[A+16>>2]=r;},function(A,r,e){A|=0,r|=0,e|=0,t[A+28>>2]=e,t[A+20>>2]=r;},function(A,r,e,i){A|=0,r|=0,e|=0,i=B(i);var a,f=0,n=B(0),o=B(0),k=B(0),c=0,u=B(0),l=B(0),s=0,d=0,v=B(0),g=0,R=B(0),y=0,p=0,D=0,w=B(0),W=B(0),F=B(0),Z=B(0),Y=0,N=0,V=B(0),I=B(0),X=B(0),M=B(0),x=B(0),S=B(0),T=B(0),U=B(0),j=B(0),O=B(0),H=B(0),z=0;if(a=E-192|0,E=a,!(C[t[A+4>>2]+784>>2]<i)){R=C[e+8>>2],o=B(B(C[r+8>>2]*i)+R),w=C[e+4>>2],k=B(B(C[r+4>>2]*i)+w),W=C[e>>2],v=B(B(C[r>>2]*i)+W),p=A+4|0,c=t[p>>2],N=t[c+780>>2],d=t[c+772>>2],D=t[t[A+8>>2]+8>>2],y=(0|d)==(0|D),y?(n=B(v-C[d+52>>2]),u=B(k-C[d+56>>2]),l=B(o-C[d+60>>2]),F=B(B(B(n*C[d+12>>2])+B(u*C[d+28>>2]))+B(l*C[d+44>>2])),Z=B(B(B(n*C[d+8>>2])+B(u*C[d+24>>2]))+B(l*C[d+40>>2])),n=B(B(B(n*C[d+4>>2])+B(u*C[d+20>>2]))+B(l*C[d+36>>2])),f=t[t[A+12>>2]+8>>2]):(f=t[t[A+12>>2]+8>>2],n=B(v-C[f+52>>2]),u=B(k-C[f+56>>2]),l=B(o-C[f+60>>2]),F=B(B(B(n*C[f+12>>2])+B(u*C[f+28>>2]))+B(l*C[f+44>>2])),Z=B(B(B(n*C[f+8>>2])+B(u*C[f+24>>2]))+B(l*C[f+40>>2])),n=B(B(B(n*C[f+4>>2])+B(u*C[f+20>>2]))+B(l*C[f+36>>2])),f=D),V=C[f+20>>2],I=C[f+36>>2],X=C[f+40>>2],M=C[f+8>>2],x=C[f+24>>2],S=C[f+44>>2],T=C[f+60>>2],u=C[f+12>>2],l=C[f+52>>2],U=C[f+28>>2],j=C[f+56>>2],O=C[f+4>>2],t[a+28>>2]=0,t[a+156>>2]=0,f=a+148|0,t[f>>2]=0,t[f+4>>2]=0,f=a+140|0,t[f>>2]=0,t[f+4>>2]=0,f=a+132|0,t[f>>2]=0,t[f+4>>2]=0,f=a+124|0,t[f>>2]=0,t[f+4>>2]=0,f=r+8|0,s=t[f+4>>2],g=a+72|0,t[g>>2]=t[f>>2],t[g+4>>2]=s,H=u,u=B(W-l),l=B(w-j),R=B(R-T),C[a+24>>2]=B(B(H*u)+B(U*l))+B(S*R),C[a+20>>2]=B(B(u*M)+B(l*x))+B(R*X),t[a+12>>2]=0,C[a+8>>2]=F,C[a+4>>2]=Z,C[a>>2]=n,C[a+80>>2]=i,t[a+92>>2]=0,t[a+96>>2]=0,t[a+84>>2]=0,t[a+88>>2]=0,t[a+116>>2]=0,t[a+120>>2]=0,f=t[r+4>>2],t[a+64>>2]=t[r>>2],t[a+68>>2]=f,C[a+16>>2]=B(B(u*O)+B(l*V))+B(R*I),t[a+60>>2]=0,C[a+56>>2]=o,C[a+52>>2]=k,r=e+8|0,f=t[r+4>>2],s=a+40|0,t[s>>2]=t[r>>2],t[s+4>>2]=f,C[a+48>>2]=v,r=t[e+4>>2],t[a+32>>2]=t[e>>2],t[a+36>>2]=r,e=function(A,r){var e,i=B(0),a=B(0),f=0,n=B(0),b=0,o=B(0),k=B(0),c=B(0);if(e=t[A+780>>2],(0|e)>=1){for(f=A+8|0,o=C[r+8>>2],k=C[r+4>>2],c=C[r>>2],a=C[A+784>>2],a=B(a*a),A=0,r=-1;i=B(C[f+-4>>2]-c),n=B(i*i),i=B(C[f>>2]-k),n=B(n+B(i*i)),i=B(C[f+4>>2]-o),i=B(n+B(i*i)),b=i<a,a=b?i:a,r=b?A:r,f=f+192|0,A=A+1|0,(0|e)!=(0|A);){}return r;}return -1;}(c,a),g=t[A+8>>2],f=t[g+8>>2],s=t[A+12>>2],c=t[s+8>>2],C[a+96>>2]=C[f+232>>2]*C[c+232>>2],i=C[f+228>>2],n=C[c+228>>2],C[a+84>>2]=G(B(h(B(i*n),B(-10))),B(10)),C[a+88>>2]=G(B(h(B(B(n*C[f+236>>2])+B(i*C[c+236>>2])),B(-10))),B(10)),C[a+92>>2]=G(B(h(B(B(n*C[f+240>>2])+B(i*C[c+240>>2])),B(-10))),B(10)),r=t[f+204>>2],(128&b[c+204|0]||128&r)&&(C[a+148>>2]=C[f+244>>2]+C[c+244>>2],r=g+8|0,C[a+144>>2]=B(1)/B(B(B(1)/C[t[r>>2]+248>>2])+B(B(1)/C[t[s+8>>2]+248>>2])),t[a+120>>2]=8|t[a+120>>2],r=t[t[r>>2]+204>>2]),(2&b[t[s+8>>2]+205|0]||512&r)&&(t[a+120>>2]=16|t[a+120>>2]),i=C[a+72>>2],B(m(i))>B(.7071067690849304)?(k=C[a+68>>2],n=B(B(i*i)+B(k*k)),o=B(B(1)/B(Q(n))),v=B(n*o),l=C[a+64>>2],n=B(-B(i*o)),u=B(l*n),i=B(k*o),o=B(-B(l*i)),k=B(0)):(v=C[a- -64>>2],o=C[a+68>>2],k=B(B(v*v)+B(o*o)),n=B(B(1)/B(Q(k))),u=B(k*n),k=B(-B(o*n)),o=B(i*k),n=B(v*n),v=B(-B(i*n)),i=B(0)),C[a+184>>2]=u,C[a+180>>2]=o,C[a+168>>2]=i,C[a+164>>2]=n,C[a+176>>2]=v,C[a+160>>2]=k,y?(f=A+28|0,r=A+20|0,c=A+16|0,s=A+24|0):(f=A+24|0,r=A+16|0,c=A+20|0,s=A+28|0),t[a+112>>2]=t[f>>2],t[a+108>>2]=t[s>>2],t[a+104>>2]=t[r>>2],t[a+100>>2]=t[c>>2],r=t[p>>2];A:{r:{if((0|e)>=0){if(r=r+_(e,192)|0,f=r+136|0,i=C[f>>2],c=r+132|0,n=C[c>>2],s=r+128|0,o=C[s>>2],y=r+160|0,g=t[y>>2],16&b[a+120|0]&&(k=B(B(o*C[r+88>>2])+B(0)),!(B(B(n*n)+B(i*i))>B(k*k)))||(Y=r+120|0,z=t[Y>>2],J(r+4|0,a,192),C[s>>2]=o,t[Y>>2]=z,C[c>>2]=n,C[f>>2]=i),t[y>>2]=g,r=t[429],r)break r;break A;}if(e=sr(r,a),r=t[429],!r)break A;}f=A+8|0,A=A+12|0,(8&b[t[t[A>>2]+8>>2]+204|0]||8&b[t[t[f>>2]+8>>2]+204|0])&&(s=4+(t[p>>2]+_(e,192)|0)|0,e=(0|d)!=(0|D),yf[r](s,t[(e?A:f)>>2],t[a+100>>2],t[a+108>>2],t[(e?f:A)>>2],t[a+104>>2],t[a+112>>2]));}N||(A=t[427],A&&yf[A](p));}E=a+192|0;},function(A,r,e){A|=0,r|=0,e|=0;var i,a,f,n=B(0);if(i=E-96|0,E=i,a=t[t[A>>2]>>2],f=t[t[A+4>>2]>>2],yf[t[t[r>>2]+24>>2]](r,a,f)&&(t[i+88>>2]=-1,t[i+92>>2]=-1,t[i+72>>2]=0,t[i+80>>2]=a,t[i+84>>2]=a+4,t[i+76>>2]=t[a+192>>2],t[i+64>>2]=-1,t[i+68>>2]=-1,t[i+48>>2]=0,t[i+56>>2]=f,t[i+60>>2]=f+4,t[i+52>>2]=t[f+192>>2],t[A+8>>2]||(r=0|yf[t[t[r>>2]+8>>2]](r,i+72|0,i+48|0,0,1),t[A+8>>2]=r,r))){if(r=function(A,r,e){return t[A+32>>2]=0,t[A+12>>2]=e,t[A+8>>2]=r,t[A+4>>2]=0,t[A>>2]=7780,A;}(i+8|0,i+72|0,i+48|0),A=t[A+8>>2],1==t[e+8>>2])return yf[t[t[A>>2]+8>>2]](A,i+72|0,i+48|0,e,r),void(E=i+96|0);n=B(yf[t[t[A>>2]+12>>2]](A,a,f,e,r)),C[e+12>>2]>n&&(C[e+12>>2]=n);}E=i+96|0;},function(A){A|=0;var r,e=0;return t[A>>2]=7920,e=A+20|0,r=t[e>>2],r&&(b[A+24|0]&&gA(r),t[A+20>>2]=0),t[e>>2]=0,a[A+24|0]=1,e=A+12|0,t[e>>2]=0,t[e+4>>2]=0,0|A;},function(A){A|=0;var r,e=0;t[A>>2]=7920,e=A+20|0,r=t[e>>2],r&&(b[A+24|0]&&gA(r),t[A+20>>2]=0),t[e>>2]=0,a[A+24|0]=1,e=A+12|0,t[e>>2]=0,t[e+4>>2]=0,rA(A);},function(A,r,e,i,a){var f,n;return A|=0,r|=0,e|=0,i|=0,a|=0,f=E-16|0,E=f,t[f+12>>2]=i,t[f+8>>2]=A,i=t[t[e+4>>2]+4>>2],n=t[t[r+4>>2]+4>>2],1==(0|a)?(A=t[76+((_(n,144)+A|0)+(i<<2)|0)>>2],A=0|yf[t[t[A>>2]+8>>2]](A,f+8|0,r,e),E=f+16|0,0|A):(A=t[5260+((_(n,144)+A|0)+(i<<2)|0)>>2],A=0|yf[t[t[A>>2]+8>>2]](A,f+8|0,r,e),E=f+16|0,0|A);},function(A,r,e){A|=0,r|=0,e|=0;var i,f=0,n=0,o=0,k=B(0),c=B(0),u=0,l=0,s=0;i=E-16|0,E=i,t[430]=t[430]+1,n=3176,2&t[A+4>>2]&&(f=t[r+192>>2],k=B(yf[t[t[f>>2]+20>>2]](f,C[794])),C[i+12>>2]=k,f=t[e+192>>2],c=B(yf[t[t[f>>2]+20>>2]](f,C[794])),C[i+8>>2]=c,n=k<c?i+12|0:i+8|0),o=t[n>>2],k=C[e+184>>2],c=C[r+184>>2],f=t[A+72>>2],n=t[f+12>>2];A:{if(n)t[f+12>>2]=t[n>>2],t[f+8>>2]=t[f+8>>2]+-1;else {if(n=0,4&b[A+4|0])break A;n=CA(804,16);}if(t[n>>2]=1025,t[n+160>>2]=0,f=n+152|0,t[f>>2]=0,t[f+4>>2]=0,f=n+144|0,t[f>>2]=0,t[f+4>>2]=0,f=n+136|0,t[f>>2]=0,t[f+4>>2]=0,f=n+128|0,t[f>>2]=0,t[f+4>>2]=0,t[n+120>>2]=0,t[n+124>>2]=0,t[n+352>>2]=0,f=n+344|0,t[f>>2]=0,t[f+4>>2]=0,f=n+336|0,t[f>>2]=0,t[f+4>>2]=0,f=n+328|0,t[f>>2]=0,t[f+4>>2]=0,f=n+320|0,t[f>>2]=0,t[f+4>>2]=0,t[n+312>>2]=0,t[n+316>>2]=0,t[n+544>>2]=0,f=n+536|0,t[f>>2]=0,t[f+4>>2]=0,f=n+528|0,t[f>>2]=0,t[f+4>>2]=0,f=n+520|0,t[f>>2]=0,t[f+4>>2]=0,f=n+512|0,t[f>>2]=0,t[f+4>>2]=0,t[n+504>>2]=0,t[n+508>>2]=0,t[n+736>>2]=0,f=n+728|0,t[f>>2]=0,t[f+4>>2]=0,f=n+720|0,t[f>>2]=0,t[f+4>>2]=0,f=n+712|0,t[f>>2]=0,t[f+4>>2]=0,f=n+704|0,t[f>>2]=0,t[f+4>>2]=0,t[n+696>>2]=0,t[n+700>>2]=0,C[n+788>>2]=c<k?c:k,t[n+784>>2]=o,t[n+780>>2]=0,t[n+776>>2]=e,t[n+772>>2]=r,u=A+12|0,f=t[u>>2],t[n+800>>2]=f,t[A+16>>2]==(0|f)&&(o=f?f<<1:1,!((0|f)>=(0|o)))){r:{e:{if(o){if(l=CA(o<<2,16),f=t[A+12>>2],(0|f)>=1)break e;break r;}if((0|f)<1)break r;}for(r=0,s=A+20|0,e=f;t[r+l>>2]=t[t[s>>2]+r>>2],r=r+4|0,e=e+-1|0,e;){}}r=A+20|0,e=t[r>>2],e&&(b[A+24|0]&&(gA(e),f=t[A+12>>2]),t[A+20>>2]=0),t[r>>2]=l,a[A+24|0]=1,t[A+16>>2]=o;}t[u>>2]=f+1,t[t[A+20>>2]+(f<<2)>>2]=n;}return E=i+16|0,0|n;},function(A,r){A|=0,r|=0;var e,i,a,f,n,b,o=0,k=0,c=0;if(t[430]=t[430]+-1,yf[t[t[A>>2]+20>>2]](A,r),o=A+20|0,k=t[o>>2],e=t[r+800>>2],i=e<<2,c=k+i|0,f=t[c>>2],n=c,b=k,k=A+12|0,c=t[k>>2]+-1|0,a=c<<2,t[n>>2]=t[b+a>>2],t[t[o>>2]+a>>2]=f,t[k>>2]=c,t[t[t[o>>2]+i>>2]+800>>2]=e,r&&(A=t[A+72>>2],o=t[A+16>>2],!(o>>>0>r>>>0|o+_(t[A>>2],t[A+4>>2])>>>0<=r>>>0)))return t[r>>2]=t[A+12>>2],t[A+12>>2]=r,void(t[A+8>>2]=t[A+8>>2]+1);gA(r);},function(A,r){A|=0,r|=0;var e=0,i=0,a=0,f=0;if(A=E-16|0,E=A,i=t[r+780>>2],(0|i)>=1)for(e=r+4|0,f=r+780|0;lr(e),e=e+192|0,a=a+1|0,i=t[f>>2],(0|a)<(0|i);){}i&&(e=t[428],e&&(t[A+12>>2]=r,yf[e](A+12|0))),t[r+780>>2]=0,E=A+16|0;},function(A,r,e){A|=0,r|=0,e|=0;var i=0;A=t[r+220>>2];A:if(2!=(0|A)&&5!=(0|A)||(A=0,i=t[e+220>>2],!(2==(0|i)|5==(0|i)))){if(!t[r+280>>2]||yf[t[t[r>>2]+12>>2]](r,e)){if(A=1,!t[e+280>>2])break A;if(yf[t[t[e>>2]+12>>2]](e,r))break A;}A=0;}return 0|A;},function(A,r,e){A|=0,r|=0,e|=0,A=0;A:{if(r=t[r+204>>2],!(4&r||(e=t[e+204>>2],4&e))){if(!(3&r))break A;A=!(3&e);}return 0|A;}return 1;},function(A,r,e,i){var a;A|=0,r|=0,e|=0,i|=0,a=E-16|0,E=a,t[a+8>>2]=A,t[a+4>>2]=e,t[a>>2]=8028,yf[t[t[r>>2]+48>>2]](r,a,i),E=a+16|0;},function(A){return A|=0,t[A+12>>2];},function(A,r){return A|=0,r|=0,t[t[A+20>>2]+(r<<2)>>2];},function(A){return A|=0,t[A+12>>2]?t[A+20>>2]:0;},_r,_r,function(A,r){var e;return A|=0,r|=0,A=t[A+68>>2],e=t[A+12>>2],e?(t[A+12>>2]=t[e>>2],t[A+8>>2]=t[A+8>>2]+-1,0|e):0|CA(r,16);},function(A,r){A|=0,r|=0;var e=0;if(r&&(A=t[A+68>>2],e=t[A+16>>2],!(e>>>0>r>>>0|_(t[A>>2],t[A+4>>2])+e>>>0<=r>>>0)))return t[r>>2]=t[A+12>>2],t[A+12>>2]=r,void(t[A+8>>2]=t[A+8>>2]+1);gA(r);},sA,Cr,function(A,r){var e;return A|=0,r|=0,e=r,r=t[A+8>>2],yf[t[r+64>>2]](e,r,t[A+4>>2]),0;},function(A){A|=0;var r=0,e=0;return t[A>>2]=8116,r=t[A+12>>2],r&&(e=t[A+4>>2],yf[t[t[e>>2]+16>>2]](e,r),t[A+12>>2]=0),r=t[A+8>>2],r&&(yf[t[t[r>>2]>>2]](r),r=t[A+4>>2],e=A+8|0,yf[t[t[r>>2]+60>>2]](r,t[e>>2]),t[e>>2]=0),t[A+24>>2]=-1,t[A+28>>2]=-1,r=A+32|0,t[r>>2]=-1,t[r+4>>2]=-1,0|A;},function(A){A|=0;var r=0,e=0;t[A>>2]=8116,r=t[A+12>>2],r&&(e=t[A+4>>2],yf[t[t[e>>2]+16>>2]](e,r),t[A+12>>2]=0),r=t[A+8>>2],r&&(yf[t[t[r>>2]>>2]](r),r=t[A+4>>2],e=A+8|0,yf[t[t[r>>2]+60>>2]](r,t[e>>2]),t[e>>2]=0),t[A+24>>2]=-1,t[A+28>>2]=-1,r=A+32|0,t[r>>2]=-1,t[r+4>>2]=-1,rA(A);},function(A,r,e,i,a){A|=0,r|=0,e|=0,i|=0,a|=0;var f=0,n=0;f=t[A+12>>2],f&&(n=t[A+4>>2],yf[t[t[n>>2]+16>>2]](n,f),t[A+12>>2]=0),f=t[A+8>>2],f&&(yf[t[t[f>>2]>>2]](f),f=t[A+4>>2],n=A+8|0,yf[t[t[f>>2]+60>>2]](f,t[n>>2]),t[n>>2]=0),t[A+24>>2]=-1,t[A+28>>2]=-1,f=A+32|0,t[f>>2]=-1,t[f+4>>2]=-1,t[A+20>>2]=i,t[A+16>>2]=a;A:{if(i=t[r+4>>2],25==t[i+4>>2]){if(a=t[e+4>>2],25!=t[a+4>>2])break A;return void Rr(A,r,e,i,a);}return a=t[e+4>>2],void(25==t[a+4>>2]&&Gr(A,e,r,a,i,1));}Gr(A,r,e,i,a,0);},hr,function(A,r){A|=0,r|=0;var e=0,i=0,f=0,n=0,o=0,k=0;if(i=t[A+12>>2],i){if(e=t[r+4>>2],(0|e)==t[r+8>>2]&&(n=e?e<<1:1,!((0|e)>=(0|n)))){A:{r:{if(n){if(o=CA(n<<2,16),e=t[r+4>>2],(0|e)>=1)break r;break A;}if((0|e)<1)break A;}for(i=0,k=r+12|0,f=e;t[i+o>>2]=t[t[k>>2]+i>>2],i=i+4|0,f=f+-1|0,f;){}}f=t[r+12>>2],f&&(b[r+16|0]&&(gA(f),e=t[r+4>>2]),t[r+12>>2]=0),t[r+12>>2]=o,a[r+16|0]=1,t[r+8>>2]=n,i=t[A+12>>2];}t[r+4>>2]=e+1,t[t[r+12>>2]+(e<<2)>>2]=i;}},cr,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f,n=B(0),b=B(0),o=B(0),k=0,c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=0,_=0,m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=0;a=E-48|0,n=C[A+60>>2],c=C[r+16>>2],b=C[A- -64>>2],m=C[r+20>>2],o=C[A+68>>2],R=C[r+24>>2],G=C[r+52>>2],h=B(B(B(B(n*c)+B(b*m))+B(o*R))+G),C[a+40>>2]=h,u=C[r+32>>2],y=C[r+36>>2],Q=C[r+40>>2],p=C[r+56>>2],D=B(B(B(B(n*u)+B(b*y))+B(o*Q))+p),C[a+36>>2]=D,l=n,n=C[r>>2],s=C[r+4>>2],w=o,o=C[r+8>>2],d=C[r+48>>2],W=B(B(B(B(l*n)+B(b*s))+B(w*o))+d),C[a+44>>2]=W,t[a+28>>2]=0,b=C[A+76>>2],v=C[A+80>>2],l=C[A+84>>2],F=B(G+B(B(B(c*b)+B(m*v))+B(R*l))),C[a+20>>2]=F,Z=B(p+B(B(B(u*b)+B(y*v))+B(Q*l))),C[a+24>>2]=Z,b=B(d+B(B(B(n*b)+B(s*v))+B(o*l))),C[a+16>>2]=b,l=d,d=C[A+92>>2],w=s,s=C[A+96>>2],v=C[A+100>>2],o=B(l+B(B(B(n*d)+B(w*s))+B(o*v))),C[a>>2]=o,r=b>o,k=W>(r?o:b)^1,g=k?a+44|0:a,n=C[A+48>>2],C[e>>2]=C[(r?g:k?g:a+16|0)>>2]-n,t[a+12>>2]=0,u=B(p+B(B(B(u*d)+B(y*s))+B(Q*v))),C[a+8>>2]=u,A=a+8|0,r=Z>u,k=D>C[(r?a:a+16|0)+8>>2]^1,g=k?a+36|0:A,_=g,g=a+24|0,C[e+8>>2]=C[(r?_:k?_:g)>>2]-n,c=B(G+B(B(B(c*d)+B(m*s))+B(R*v))),C[a+4>>2]=c,Y=e,r=4|a,e=F>c,k=h>C[(e?a:a+16|0)+4>>2]^1,_=k?a+40|0:r,f=_,_=a+16|4,C[Y+4>>2]=C[(e?f:k?f:_)>>2]-n,Y=A,A=Z<u,e=D<C[(A?a:a+16|0)+8>>2]^1,k=e?a+36|0:Y,C[i+8>>2]=n+C[(A?k:e?k:g)>>2],e=r,A=F<c,r=h<C[(A?a:a+16|0)+4>>2]^1,e=r?a+40|0:e,C[i+4>>2]=n+C[(A?e:r?e:_)>>2],A=b<o,r=W<(A?o:b)^1,e=r?a+44|0:a,C[i>>2]=n+C[(A?e:r?e:a+16|0)>>2];},Qr,function(A){return 8380;},function(A,r,e){A|=0,r|=0,e|=0;var i=B(0),a=B(0),f=B(0),n=B(0),b=B(0);i=C[e>>2],a=C[e+4>>2],f=C[e+8>>2],n=B(B(B(i*C[r+76>>2])+B(a*C[r+80>>2]))+B(f*C[r+84>>2])),b=B(B(B(i*C[r+92>>2])+B(a*C[r+96>>2]))+B(f*C[r+100>>2])),i=B(B(B(i*C[r+60>>2])+B(a*C[r- -64>>2]))+B(f*C[r+68>>2])),r=(r+60|0)+((i<n?n<b?2:1:(i<b)<<1)<<4)|0,e=t[r+4>>2],t[A>>2]=t[r>>2],t[A+4>>2]=e,r=r+8|0,e=t[r+4>>2],A=A+8|0,t[A>>2]=t[r>>2],t[A+4>>2]=e;},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a=B(0),f=0,n=0,b=B(0),o=B(0),k=B(0),c=B(0),u=0,l=0,s=0,d=0,v=0,g=0,_=0,m=0,R=0;if((0|i)>=1)for(u=A+100|0,l=A+96|0,s=A+92|0,d=A+84|0,v=A+80|0,g=A+76|0,_=A+68|0,m=A- -64|0,A=A+60|0;a=C[r>>2],b=C[r+4>>2],o=C[r+8>>2],k=B(B(B(a*C[g>>2])+B(b*C[v>>2]))+B(o*C[d>>2])),c=B(B(B(a*C[s>>2])+B(b*C[l>>2]))+B(o*C[u>>2])),a=B(B(B(a*C[A>>2])+B(b*C[m>>2]))+B(o*C[_>>2])),f=A+((a<k?k<c?2:1:(a<c)<<1)<<4)|0,n=t[f+4>>2],t[e>>2]=t[f>>2],t[e+4>>2]=n,f=f+8|0,R=t[f+4>>2],n=e+8|0,t[n>>2]=t[f>>2],t[n+4>>2]=R,r=r+16|0,e=e+16|0,i=i+-1|0,i;){}},wr,function(A,r,e){A|=0,r|=0,e|=0;var i=B(0),a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0);n=C[A+92>>2],b=C[A+76>>2],o=C[A+80>>2],c=C[A+100>>2],a=C[A+68>>2],u=C[A+84>>2],k=C[A+96>>2],i=C[A- -64>>2],f=C[A+60>>2],t[e+12>>2]=0,b=B(b-f),k=B(k-i),o=B(o-i),f=B(n-f),i=B(B(b*k)-B(o*f)),l=i,s=B(i*i),i=B(c-a),n=B(u-a),a=B(B(o*i)-B(n*k)),i=B(B(n*f)-B(b*i)),f=B(B(1)/B(Q(B(s+B(B(a*a)+B(i*i)))))),n=B(l*f),C[e+8>>2]=n,i=B(i*f),C[e+4>>2]=i,a=B(a*f),C[e>>2]=a,r&&(C[e+8>>2]=-n,C[e+4>>2]=-i,C[e>>2]=-a);},Wr,Wr,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0,yf[t[t[A>>2]+108>>2]](A,r,e),yf[t[t[A>>2]+108>>2]](A,(r+1|0)%3|0,i);},function(A,r,e){var i,a;A|=0,r|=0,e|=0,A=(r<<4)+A|0,r=A+68|0,a=t[r+4>>2],i=e+8|0,t[i>>2]=t[r>>2],t[i+4>>2]=a,A=A+60|0,r=t[A+4>>2],t[e>>2]=t[A>>2],t[e+4>>2]=r;},Fr,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0,yf[t[t[A>>2]+124>>2]](A,i,r,e);},function(A,r,e){A|=0,r|=0,e=B(e);var i,a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=0,g=0,_=0;return i=E-32|0,E=i,s=C[A+60>>2],o=B(C[A+76>>2]-s),f=C[A- -64>>2],b=B(C[A+96>>2]-f),a=B(C[A+80>>2]-f),k=B(C[A+92>>2]-s),n=B(B(o*b)-B(a*k)),u=n,d=B(n*n),l=a,a=C[A+68>>2],n=B(C[A+100>>2]-a),c=B(C[A+84>>2]-a),b=B(B(l*n)-B(c*b)),o=B(B(c*k)-B(o*n)),k=B(B(1)/B(Q(B(d+B(B(b*b)+B(o*o)))))),n=B(u*k),b=B(b*k),o=B(o*k),f=B(B(B(C[r+8>>2]*n)+B(B(C[r>>2]*b)+B(C[r+4>>2]*o)))-B(B(a*n)+B(B(s*b)+B(f*o)))),s=B(-e),f>=s^1|f<=e^1||(yf[t[t[A>>2]+104>>2]](A,0,i+16|0,i),v=r+8|0,k=C[i+16>>2],f=B(C[i>>2]-k),c=C[i+20>>2],a=B(C[i+4>>2]-c),e=B(B(o*f)-B(b*a)),u=e,d=B(e*e),e=B(n*a),l=C[i+24>>2],a=B(C[i+8>>2]-l),e=B(e-B(o*a)),f=B(B(b*a)-B(n*f)),a=B(B(1)/B(Q(B(d+B(B(e*e)+B(f*f)))))),u=B(u*a),e=B(e*a),g=r+4|0,f=B(f*a),B(B(B(C[v>>2]*u)+B(B(C[r>>2]*e)+B(C[g>>2]*f)))-B(B(l*u)+B(B(k*e)+B(c*f))))<s||(yf[t[t[A>>2]+104>>2]](A,1,i+16|0,i),k=C[i+16>>2],f=B(C[i>>2]-k),c=C[i+20>>2],a=B(C[i+4>>2]-c),e=B(B(o*f)-B(b*a)),u=e,d=B(e*e),e=B(n*a),l=C[i+24>>2],a=B(C[i+8>>2]-l),e=B(e-B(o*a)),f=B(B(b*a)-B(n*f)),a=B(B(1)/B(Q(B(d+B(B(e*e)+B(f*f)))))),u=B(u*a),e=B(e*a),f=B(f*a),B(B(B(C[v>>2]*u)+B(B(C[r>>2]*e)+B(C[g>>2]*f)))-B(B(l*u)+B(B(k*e)+B(c*f))))<s||(yf[t[t[A>>2]+104>>2]](A,2,i+16|0,i),f=C[i+16>>2],a=B(C[i>>2]-f),k=C[i+20>>2],c=B(C[i+4>>2]-k),e=B(B(o*a)-B(b*c)),u=e,l=B(e*e),d=B(n*c),e=o,o=C[i+24>>2],c=B(C[i+8>>2]-o),e=B(d-B(e*c)),n=B(B(b*c)-B(n*a)),b=B(B(1)/B(Q(B(l+B(B(e*e)+B(n*n)))))),a=B(u*b),e=B(e*b),n=B(n*b),B(B(B(C[r+8>>2]*a)+B(B(C[r>>2]*e)+B(C[r+4>>2]*n)))-B(B(o*a)+B(B(f*e)+B(k*n))))<s||(_=1)))),E=i+32|0,0|_;},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0);o=C[A+92>>2],k=C[A+76>>2],c=C[A+80>>2],l=C[A+100>>2],r=A+68|0,b=C[r>>2],s=C[A+84>>2],u=C[A+96>>2],f=C[A- -64>>2],n=C[A+60>>2],t[e+12>>2]=0,k=B(k-n),u=B(u-f),c=B(c-f),n=B(o-n),f=B(B(k*u)-B(c*n)),d=f,v=B(f*f),f=B(l-b),o=B(s-b),b=B(B(c*f)-B(o*u)),f=B(B(o*n)-B(k*f)),n=B(B(1)/B(Q(B(v+B(B(b*b)+B(f*f)))))),C[e+8>>2]=d*n,C[e+4>>2]=f*n,C[e>>2]=b*n,a=t[r+4>>2],e=i+8|0,t[e>>2]=t[r>>2],t[e+4>>2]=a,r=t[A+64>>2],t[i>>2]=t[A+60>>2],t[i+4>>2]=r;},cr,function(A,r){return A|=0,r|=0,A=t[t[A+4>>2]>>2],0|yf[t[t[A>>2]+128>>2]](A,r);},sA,Cr,function(A,r){var e,i;return A|=0,r|=0,e=t[A+4>>2],i=t[e>>2],yf[t[t[i>>2]+104>>2]](i,r,e+4|0),t[A+4>>2]+4|0;},Cr,function(A,r){var e,i;return A|=0,r|=0,e=t[A+4>>2],i=t[e>>2],yf[t[t[i>>2]+108>>2]](i,r,e+112|0),t[A+4>>2]+112|0;},Cr,sA,Cr,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f,n=0,o=0,k=0;a=E-144|0,E=a,f=LA(a+32|0),o=r+8|0,k=t[o+4>>2],n=a+100|0,t[n>>2]=t[o>>2],t[n+4>>2]=k,o=t[r+20>>2],n=a+108|0,t[n>>2]=t[r+16>>2],t[n+4>>2]=o,o=r+24|0,k=t[o+4>>2],n=a+116|0,t[n>>2]=t[o>>2],t[n+4>>2]=k,o=t[r+36>>2],n=a+124|0,t[n>>2]=t[r+32>>2],t[n+4>>2]=o,o=r+40|0,k=t[o+4>>2],n=a+132|0,t[n>>2]=t[o>>2],t[n+4>>2]=k,t[a+36>>2]=1,t[a+32>>2]=8188,n=t[r+4>>2],t[a+92>>2]=t[r>>2],t[a+96>>2]=n,t[a+80>>2]=t[A+24>>2],r=t[A+4>>2],k=b[A+20|0],k?(t[r+28>>2]=e,n=r+24|0):(t[r+36>>2]=e,n=r+32|0),t[n>>2]=i,n=t[A+12>>2],o=t[n+8>>2],t[a+20>>2]=t[n+12>>2],t[a+16>>2]=o,t[a+28>>2]=i,t[a+24>>2]=e,t[a+8>>2]=n,e=t[r+16>>2],i=t[e+8>>2],n=t[i+8>>2],t[a+12>>2]=a+32,(0|n)==(0|o)?e=e+8|0:(i=t[e+12>>2],e=e+12|0),t[e>>2]=a+8,Gr(r,t[A+8>>2],a+8|0,t[A+16>>2],a+32|0,0!=(0|k)),A=t[t[A+4>>2]+16>>2],t[(t[t[A+8>>2]+8>>2]==t[a+16>>2]?8:12)+A>>2]=i,er(f),E=a+144|0;},sA,Cr,function(A,r,e,i){return A|=0,r|=0,A=t[r>>2],A=0|yf[t[t[A>>2]+56>>2]](A,40),vA(A,r),t[A>>2]=8116,t[A+8>>2]=0,t[A+12>>2]=0,0|A;},Nr,function(A){A|=0;var r,e=0;t[A>>2]=9024,e=A+296|0,r=t[e>>2],r&&(b[A+300|0]&&gA(r),t[A+296>>2]=0),t[e>>2]=0,a[A+300|0]=1,e=A+288|0,t[e>>2]=0,t[e+4>>2]=0,gA(A);},function(A,r){A|=0,r|=0,t[A+200>>2]=r,t[A+192>>2]=r,t[A+304>>2]=t[A+304>>2]+1;},function(A,r){A|=0,r|=0;var e,i=0;e=t[A+288>>2],i=e;A:if(!((0|e)<1)){for(A=t[A+296>>2],i=0;;){if(t[A>>2]==(0|r))break A;if(A=A+4|0,i=i+1|0,!((0|i)<(0|e)))break;}i=e;}return (0|i)>=(0|e)|0;},function(A){return 264;},Jr,function(A,r){A|=0,r|=0;var e,i=0,a=0,f=0,n=0,b=0;f=r,n=0|yf[t[t[A>>2]+16>>2]](A),b=1,a=t[t[r>>2]+16>>2],i=0|yf[a](0|f,0|n,0|b),b=r,n=i,f=0|yf[t[t[A>>2]+20>>2]](A,t[i+8>>2],r),e=A,a=t[t[r>>2]+20>>2],yf[a](0|b,0|n,0|f,1245859651,0|e);},cr,Mr,xr,function(A,r,e){A|=0,r=B(r),e|=0;var i=B(0),a=B(0),f=B(0),n=B(0),b=B(0),o=B(0);i=C[A+40>>2],a=C[A+36>>2],f=C[A+32>>2],n=B(yf[t[t[A>>2]+48>>2]](A)),b=B(yf[t[t[A>>2]+48>>2]](A)),o=B(yf[t[t[A>>2]+48>>2]](A)),t[e+12>>2]=0,r=B(r/B(12)),f=B(f+n),f=B(f+f),f=B(f*f),a=B(a+b),a=B(a+a),a=B(a*a),C[e+8>>2]=r*B(f+a),i=B(i+o),i=B(i+i),i=B(i*i),C[e+4>>2]=r*B(f+i),C[e>>2]=r*B(a+i);},function(A){return 9272;},Xr,function(A,r,e){A|=0,r|=0,e|=0;var i=B(0),a=B(0),f=B(0),n=B(0),b=B(0),o=B(0);i=C[r+36>>2],a=C[r+40>>2],f=C[r+32>>2],n=B(yf[t[t[r>>2]+48>>2]](r)),b=B(yf[t[t[r>>2]+48>>2]](r)),o=B(yf[t[t[r>>2]+48>>2]](r)),t[A+12>>2]=0,a=B(a+o),C[A+8>>2]=C[e+8>>2]>=B(0)?a:B(-a),i=B(i+b),C[A+4>>2]=C[e+4>>2]>=B(0)?i:B(-i),i=B(f+n),C[A>>2]=C[e>>2]>=B(0)?i:B(-i);},function(A,r,e){A|=0,r|=0,e|=0;var i=B(0);t[A+12>>2]=0,i=C[r+32>>2],C[A>>2]=C[e>>2]>=B(0)?i:B(-i),i=C[r+40>>2],C[A+8>>2]=C[e+8>>2]>=B(0)?i:B(-i),i=C[r+36>>2],C[A+4>>2]=C[e+4>>2]>=B(0)?i:B(-i);},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a=0,f=B(0),n=B(0),b=B(0),o=0,k=0,c=0,u=B(0),l=B(0),s=B(0);if((0|i)>=1)for(o=A+36|0,k=A+40|0,c=A+32|0,A=0;f=C[o>>2],a=A+r|0,u=C[a+4>>2],n=C[k>>2],l=C[a+8>>2],b=C[c>>2],s=C[a>>2],a=A+e|0,t[a+12>>2]=0,C[a>>2]=s>=B(0)?b:B(-b),C[a+8>>2]=l>=B(0)?n:B(-n),C[a+4>>2]=u>=B(0)?f:B(-f),A=A+16|0,i=i+-1|0,i;){}},Sr,function(A,r,e){A|=0,r|=0,e|=0,r>>>0<=5&&(t[e+12>>2]=0,A=r<<2,t[e+8>>2]=t[A+9324>>2],t[e+4>>2]=t[A+9300>>2],t[e>>2]=t[A+9276>>2]);},function(A){return 8;},pA,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f=0,n=0;a=A,r>>>0<=11&&(r<<=2,f=t[r+9396>>2],n=t[r+9348>>2]),yf[t[t[A>>2]+108>>2]](a,n,e),yf[t[t[A>>2]+108>>2]](A,f,i);},function(A,r,e){A|=0,r|=0,e|=0;var i=B(0),a=B(0),f=B(0),n=B(0),b=B(0),o=B(0);a=C[A+40>>2],i=C[A+36>>2],f=C[A+32>>2],n=B(yf[t[t[A>>2]+48>>2]](A)),b=B(yf[t[t[A>>2]+48>>2]](A)),o=B(yf[t[t[A>>2]+48>>2]](A)),t[e+12>>2]=0,i=B(i+b),A=r>>>1&1,C[e+4>>2]=B(i*B(1^A))-B(i*B(0|A)),i=B(f+n),A=1&r,C[e>>2]=B(i*B(1^A))-B(i*B(0|A)),a=B(a+o),A=r>>>2&1,C[e+8>>2]=B(a*B(1^A))-B(a*B(0|A));},Sr,function(A,r,e,i){var a,f,n;A|=0,r|=0,e|=0,i|=0,a=E-48|0,E=a,yf[t[t[A>>2]+124>>2]](A,a+32|0,i),t[r+12>>2]=0,i=t[a+40>>2],t[r+8>>2]=i,f=t[a+36>>2],t[r+4>>2]=f,n=r,r=t[a+32>>2],t[n>>2]=r,t[a+12>>2]=0,t[a+8>>2]=-2147483648^i,t[a+4>>2]=-2147483648^f,t[a>>2]=-2147483648^r,yf[t[t[A>>2]+64>>2]](a+16|0,A,a),r=a+24|0,i=t[r+4>>2],A=e+8|0,t[A>>2]=t[r>>2],t[A+4>>2]=i,A=t[a+20>>2],t[e>>2]=t[a+16>>2],t[e+4>>2]=A,E=a+48|0;},function(A,r,e){A|=0,r|=0,e=B(e);var i=B(0),a=B(0),f=0;return i=C[r>>2],a=C[A+32>>2],i<=B(a+e)^1|i>=B(B(-a)-e)^1||(i=C[r+4>>2],a=C[A+36>>2],i<=B(a+e)^1|i>=B(B(-a)-e)^1||(i=C[r+8>>2],a=C[A+40>>2],i<=B(a+e)&&(f=i>=B(B(-a)-e)))),0|f;},function(A,r,e){A|=0,r|=0,e|=0;var i=0,a=B(0),f=B(0),n=B(0);if(e>>>0<=5){f=C[A+40>>2],n=C[A+36>>2],a=C[A+32>>2],A=1065353216,i=e;A:{r:{e:{i:{a:{f:switch(e-1|0){case 0:e=0,A=-1082130432,i=0;break A;case 1:e=1065353216;break a;case 4:break e;case 3:break i;case 2:break f;default:break A;}e=-1082130432;}A=0,a=n,i=0;break A;}i=1065353216;break r;}i=-1082130432;}A=0,a=f,e=0;}t[r+8>>2]=i,t[r+4>>2]=e,t[r>>2]=A,C[r+12>>2]=-a;}},DA,Mr,xr,function(A,r,e){A|=0,r=B(r),e|=0;var i,a,f,n,b=B(0),o=B(0),k=B(0),c=B(0),u=0,l=B(0);i=E-16|0,E=i,u=A+40|0,f=t[u+4>>2],a=i+8|0,t[a>>2]=t[u>>2],t[a+4>>2]=f,u=t[A+36>>2],t[i>>2]=t[A+32>>2],t[i+4>>2]=u,b=B(yf[t[t[A>>2]+48>>2]](A)),c=B(yf[t[t[A>>2]+48>>2]](A)),n=a,l=B(B(yf[t[t[A>>2]+48>>2]](A))+C[a>>2]),C[n>>2]=l,C[i>>2]=b+C[i>>2],C[i+4>>2]=c+C[i+4>>2],b=B(r*B(.5)),c=B(r*B(.25)),r=B(r/B(12));A:{r:{if(A=t[A+56>>2],2!=(0|A)){if(A)break r;k=b,b=C[i+4>>2],o=B(b*b),b=B(k*o),k=r,r=C[i>>2],o=B(B(c*o)+B(k*B(r*B(r*B(4))))),k=o;break A;}o=b,b=C[i>>2],b=B(b*b),k=B(o*b),o=r,r=C[i+8>>2],b=B(B(c*b)+B(o*B(r*B(r*B(4))))),o=b;break A;}o=b,b=C[i>>2],b=B(b*b),o=B(o*b),k=r,r=C[i+4>>2],b=B(B(c*b)+B(k*B(r*B(r*B(4))))),k=b;}t[e+12>>2]=0,C[e+8>>2]=k,C[e+4>>2]=o,C[e>>2]=b,E=i+16|0;},function(A){return 9852;},wA,Xr,FA,function(A,r,e){return A|=0,r|=0,e|=0,hA(A,r,e),t[r+28>>2]=t[A+32>>2],t[r+32>>2]=t[A+36>>2],t[r+36>>2]=t[A+40>>2],t[r+40>>2]=t[A+44>>2],t[r+12>>2]=t[A+16>>2],t[r+16>>2]=t[A+20>>2],t[r+20>>2]=t[A+24>>2],t[r+24>>2]=t[A+28>>2],t[r+48>>2]=0,t[r+44>>2]=t[A+48>>2],A=t[A+56>>2],t[r+56>>2]=0,t[r+52>>2]=A,9862;},function(A,r,e){A|=0,r|=0,e|=0;var i,a,f,n=B(0),b=B(0),o=B(0),k=0,c=B(0),u=B(0);i=E-16|0,E=i,yf[t[t[r>>2]+68>>2]](i,r,e),a=i+8|0,f=t[a+4>>2],k=A+8|0,t[k>>2]=t[a>>2],t[k+4>>2]=f,k=t[i+4>>2],t[A>>2]=t[i>>2],t[A+4>>2]=k,B(yf[t[t[r>>2]+48>>2]](r))!=B(0)&&(b=C[e+4>>2],n=C[e>>2],o=C[e+8>>2],c=B(yf[t[t[r>>2]+48>>2]](r)),r=B(B(B(n*n)+B(b*b))+B(o*o))<B(1.4210854715202004e-14),n=r?B(-1):n,u=n,o=r?B(-1):o,b=r?B(-1):b,n=B(B(1)/B(Q(B(B(o*o)+B(B(n*n)+B(b*b)))))),C[A>>2]=C[A>>2]+B(c*B(u*n)),C[A+4>>2]=C[A+4>>2]+B(c*B(b*n)),C[A+8>>2]=C[A+8>>2]+B(c*B(o*n))),E=i+16|0;},function(A,r,e){A|=0,r|=0,e|=0;var i=B(0),a=B(0),f=B(0),n=B(0),t=B(0),b=B(0);if(f=C[r+36>>2],i=C[r+32>>2],a=C[e>>2],n=C[e+8>>2],t=B(Q(B(B(a*a)+B(n*n)))),t!=B(0))return b=C[e+4>>2],i=B(i/t),C[A+8>>2]=n*i,C[A+4>>2]=b<B(0)?B(-f):f,void(C[A>>2]=a*i);a=C[e+4>>2],C[A+8>>2]=0,C[A+4>>2]=a<B(0)?B(-f):f,C[A>>2]=i;},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a=B(0),f=B(0),n=B(0),t=B(0),b=B(0),o=0;if((0|i)>=1)for(o=A+36|0,A=A+32|0;a=C[o>>2],f=C[A>>2],t=C[r>>2],n=C[r+8>>2],b=B(Q(B(B(t*t)+B(n*n)))),b==B(0)?(n=B(0),a=C[r+4>>2]<B(0)?B(-a):a):(f=B(f/b),n=B(n*f),f=B(t*f),a=C[r+4>>2]<B(0)?B(-a):a),C[e>>2]=f,C[e+8>>2]=n,C[e+4>>2]=a,e=e+16|0,r=r+16|0,i=i+-1|0,i;){}},Tr,DA,function(A){return 9882;},function(A,r,e){A|=0,r|=0,e|=0;var i=B(0),a=B(0),f=B(0),n=B(0),t=B(0),b=B(0);if(i=C[r+36>>2],f=C[r+32>>2],a=C[e+4>>2],n=C[e+8>>2],t=B(Q(B(B(a*a)+B(n*n)))),t!=B(0))return b=C[e>>2],i=B(i/t),C[A+8>>2]=n*i,C[A>>2]=b<B(0)?B(-f):f,void(C[A+4>>2]=a*i);a=C[e>>2],C[A+8>>2]=0,C[A>>2]=a<B(0)?B(-f):f,C[A+4>>2]=i;},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a=B(0),f=B(0),n=B(0),t=B(0),b=B(0),o=0,k=0;if((0|i)>=1)for(o=A+32|0,A=A+36|0;a=C[o>>2],f=C[A>>2],k=e,t=C[r+4>>2],n=C[r+8>>2],b=B(Q(B(B(t*t)+B(n*n)))),b==B(0)?(n=B(0),a=C[r>>2]<B(0)?B(-a):a):(f=B(f/b),n=B(n*f),f=B(t*f),a=C[r>>2]<B(0)?B(-a):a),C[k>>2]=a,C[e+8>>2]=n,C[e+4>>2]=f,e=e+16|0,r=r+16|0,i=i+-1|0,i;){}},function(A){A|=0;var r=B(0),e=B(0);return r=C[A+36>>2],B(yf[t[t[A>>2]+48>>2]](A)),e=B(yf[t[t[A>>2]+48>>2]](A)),B(yf[t[t[A>>2]+48>>2]](A)),B(B(r+e));},DA,function(A){return 9892;},function(A,r,e){A|=0,r|=0,e|=0;var i=B(0),a=B(0),f=B(0),n=B(0),t=B(0);if(i=C[r+40>>2],n=C[r+32>>2],a=C[e>>2],f=C[e+4>>2],t=B(Q(B(B(a*a)+B(f*f)))),t!=B(0))return C[A+8>>2]=C[e+8>>2]<B(0)?B(-i):i,i=B(n/t),C[A>>2]=a*i,void(C[A+4>>2]=f*i);C[A+8>>2]=C[e+8>>2]<B(0)?B(-i):i,C[A>>2]=n,C[A+4>>2]=0;},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a=B(0),f=B(0),n=B(0),t=B(0),b=B(0),o=0;if((0|i)>=1)for(o=A+40|0,A=A+32|0;a=C[o>>2],f=C[A>>2],t=C[r>>2],n=C[r+4>>2],b=B(Q(B(B(t*t)+B(n*n)))),b==B(0)?(n=B(0),a=C[r+8>>2]<B(0)?B(-a):a):(f=B(f/b),n=B(n*f),f=B(t*f),a=C[r+8>>2]<B(0)?B(-a):a),C[e>>2]=f,C[e+8>>2]=a,C[e+4>>2]=n,e=e+16|0,r=r+16|0,i=i+-1|0,i;){}},Tr,DA,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0);o=B(yf[t[t[A>>2]+48>>2]](A)),k=B(yf[t[t[A>>2]+48>>2]](A)),c=B(yf[t[t[A>>2]+48>>2]](A)),A=r+52|0,f=C[A>>2],a=r+56|0,n=C[a>>2],b=C[r+48>>2],t[e+12>>2]=0,C[e+8>>2]=n-c,C[e+4>>2]=f-k,C[e>>2]=b-o,f=C[A>>2],n=C[a>>2],b=C[r+48>>2],t[i+12>>2]=0,C[i+8>>2]=c+n,C[i+4>>2]=k+f,C[i>>2]=o+b;},function(A,r,e){A|=0,r=B(r),e|=0;var i=B(0),a=B(0);i=B(yf[t[t[A>>2]+48>>2]](A)),a=B(yf[t[t[A>>2]+48>>2]](A)),t[e+12>>2]=0,r=B(a*B(i*B(r*B(.4000000059604645)))),C[e+8>>2]=r,C[e+4>>2]=r,C[e>>2]=r;},function(A){return 10032;},pr,function(A){return A|=0,B(B(C[A+32>>2]*C[A+16>>2]));},function(A,r,e){A|=0,r|=0,e|=0;var i,a,f,n=B(0),b=B(0),o=B(0),k=0,c=B(0),u=B(0);i=E-16|0,E=i,yf[t[t[r>>2]+68>>2]](i,r,e),f=i+8|0,k=t[f+4>>2],a=A+8|0,t[a>>2]=t[f>>2],t[a+4>>2]=k,k=t[i+4>>2],t[A>>2]=t[i>>2],t[A+4>>2]=k,b=C[e+4>>2],n=C[e>>2],o=C[e+8>>2],c=B(yf[t[t[r>>2]+48>>2]](r)),r=B(B(B(n*n)+B(b*b))+B(o*o))<B(1.4210854715202004e-14),n=r?B(-1):n,u=n,o=r?B(-1):o,b=r?B(-1):b,n=B(B(1)/B(Q(B(B(o*o)+B(B(n*n)+B(b*b)))))),C[A>>2]=C[A>>2]+B(c*B(u*n)),C[A+4>>2]=C[A+4>>2]+B(c*B(b*n)),C[a>>2]=C[a>>2]+B(c*B(o*n)),E=i+16|0;},function(A,r,e){A|=0,t[A>>2]=0,t[A+4>>2]=0,A=A+8|0,t[A>>2]=0,t[A+4>>2]=0;},function(A,r,e,i){e|=0,i|=0,(0|i)>=1&&x(e,0,i<<4);},sA,Cr,zr,Cr,zr,sA,dA,function(A,r){A|=0,r=B(r),C[A+16>>2]=r;},function(A){return A|=0,B(C[A+16>>2]);},sA,DA,function(A,r,e,i){e|=0,i|=0,t[e+8>>2]=-581039253,t[e+12>>2]=0,t[e>>2]=-581039253,t[e+4>>2]=-581039253,t[i+8>>2]=1566444395,t[i+12>>2]=0,t[i>>2]=1566444395,t[i+4>>2]=1566444395;},function(A,r){A|=0,r|=0;var e=0;e=t[r+4>>2],t[A+72>>2]=t[r>>2],t[A+76>>2]=e,r=r+8|0,e=t[r+4>>2],A=A+80|0,t[A>>2]=t[r>>2],t[A+4>>2]=e;},Lr,Qr,function(A){return 10576;},Dr,function(A,r,e){return A|=0,r|=0,e|=0,hA(A,r,e),t[r+12>>2]=t[A+72>>2],t[r+16>>2]=t[A+76>>2],t[r+20>>2]=t[A+80>>2],t[r+24>>2]=t[A+84>>2],t[r+28>>2]=t[A+52>>2],t[r+32>>2]=t[A+56>>2],t[r+36>>2]=t[A+60>>2],t[r+40>>2]=t[A- -64>>2],A=t[A+68>>2],t[r+48>>2]=0,t[r+44>>2]=A,10588;},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f,n,b,o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),R=B(0),G=B(0),h=B(0),y=B(0),p=B(0),D=B(0);a=E-48|0,E=a,s=C[i>>2],u=C[e>>2],c=B(B(s-u)*B(.5)),l=B(c*c),k=C[i+4>>2],o=C[e+4>>2],c=B(B(k-o)*B(.5)),g=B(l+B(c*c)),l=C[i+8>>2],d=C[e+8>>2],c=B(B(l-d)*B(.5)),c=B(Q(B(g+B(c*c)))),l=B(B(l+d)*B(.5)),d=B(B(k+o)*B(.5)),_=B(B(s+u)*B(.5)),s=C[A+60>>2],B(m(s))>B(.7071067690849304)?(u=C[A+56>>2],k=B(B(s*s)+B(u*u)),o=B(B(1)/B(Q(k))),R=B(k*o),k=C[A+52>>2],v=B(u*o),G=B(-B(k*v)),o=B(-B(s*o)),h=B(k*o)):(k=C[A+52>>2],u=C[A+56>>2],R=B(B(k*k)+B(u*u)),o=B(B(1)/B(Q(R))),h=B(R*o),p=B(-B(u*o)),G=B(s*p),o=B(k*o),R=B(-B(s*o))),y=C[A+68>>2],A=a+44|0,t[A>>2]=0,e=a+28|0,t[e>>2]=0,i=a+40|0,g=l,l=B(B(B(s*l)+B(B(_*k)+B(d*u)))-y),y=B(g-B(s*l)),v=B(c*v),g=B(y-v),s=B(c*h),h=B(g-s),C[i>>2]=h,f=a+36|0,d=B(d-B(u*l)),o=B(c*o),D=B(d-o),u=B(c*G),G=B(D-u),C[f>>2]=G,n=a+24|0,v=B(v+y),C[n>>2]=v-s,b=a+20|0,o=B(o+d),C[b>>2]=o-u,t[a+12>>2]=0,k=B(_-B(k*l)),l=B(c*p),d=B(k-l),c=B(c*R),_=B(d-c),C[a+32>>2]=_,k=B(l+k),C[a+16>>2]=k-c,l=B(s+v),C[a+8>>2]=l,o=B(u+o),C[a+4>>2]=o,k=B(c+k),C[a>>2]=k,yf[t[t[r>>2]+8>>2]](r,a,0,0),t[A>>2]=0,C[i>>2]=l,C[f>>2]=o,t[e>>2]=0,C[n>>2]=s+g,C[b>>2]=u+D,C[a+32>>2]=k,C[a+16>>2]=c+d,t[a+12>>2]=0,C[a+8>>2]=h,C[a+4>>2]=G,C[a>>2]=_,yf[t[t[r>>2]+8>>2]](r,a,0,1),E=a+48|0;},qr,function(A){A|=0;var r,e=0;t[A>>2]=11072,e=A+88|0,r=t[e>>2],r&&(b[A+92|0]&&gA(r),t[A+88>>2]=0),t[e>>2]=0,a[A+92|0]=1,e=A+80|0,t[e>>2]=0,t[e+4>>2]=0,gA(A);},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0);h=C[r+52>>2],c=C[r+24>>2],d=C[r+20>>2],a=C[r+56>>2],u=C[r+40>>2],n=C[A+44>>2],b=C[A+28>>2],o=C[A+36>>2],l=C[r+36>>2],k=C[A+40>>2],f=C[A+24>>2],y=C[r+48>>2],v=C[r+8>>2],g=C[r>>2],_=C[r+4>>2],R=C[r+16>>2],G=C[r+32>>2],s=C[A+20>>2],t[e+12>>2]=0,Q=a,a=B(B(s+o)*B(.5)),f=B(B(f+k)*B(.5)),b=B(B(b+n)*B(.5)),s=B(Q+B(B(B(G*a)+B(l*f))+B(u*b))),o=B(o-a),k=B(k-f),n=B(n-b),u=B(B(B(o*B(m(G)))+B(k*B(m(l))))+B(n*B(m(u)))),C[e+8>>2]=s-u,l=B(h+B(B(B(a*R)+B(f*d))+B(b*c))),c=B(B(B(o*B(m(R)))+B(k*B(m(d))))+B(n*B(m(c)))),C[e+4>>2]=l-c,a=B(y+B(B(B(a*g)+B(f*_))+B(b*v))),f=B(B(B(o*B(m(g)))+B(k*B(m(_))))+B(n*B(m(v)))),C[e>>2]=a-f,t[i+12>>2]=0,C[i+8>>2]=u+s,C[i+4>>2]=c+l,C[i>>2]=f+a;},function(A,r){A|=0,r|=0;var e=0,i=0;i=t[r+4>>2],e=A+160|0,t[e>>2]=t[r>>2],t[e+4>>2]=i,r=r+8|0,i=t[r+4>>2],e=A+168|0,t[e>>2]=t[r>>2],t[e+4>>2]=i,yf[t[t[A>>2]+72>>2]](A);},function(A){return A|=0,A+160|0;},function(A,r,e){A|=0,r=B(r),e|=0;var i=0,a=B(0),f=B(0),n=0,b=B(0),o=0,k=B(0),c=B(0),u=B(0),l=B(0),s=0,d=0,v=0,m=0,R=0;if(yf[t[t[A>>2]+112>>2]](A),i=e+8|0,t[i>>2]=0,t[i+4>>2]=0,t[e>>2]=0,t[e+4>>2]=0,n=t[A+188>>2],n)if(r=B(r/B(0|n)),i=t[A+196>>2],o=t[A+184>>2],1!=t[A+192>>2])for(s=0-i|0,i=8+(o+_(i,n+-1|0)|0)|0,o=A+164|0,d=A+160|0,v=A+168|0,m=e+4|0;a=C[v>>2],b=C[i>>2],f=B(C[i+-8>>2]*C[d>>2]),f=B(f*f),l=B(C[i+-4>>2]*C[o>>2]),l=B(l*l),k=B(B(r*B(f+l))+k),C[e+8>>2]=k,a=B(b*a),a=B(a*a),c=B(B(r*B(f+a))+c),C[m>>2]=c,u=B(u+B(r*B(l+a))),C[e>>2]=u,i=i+s|0,n=n+-1|0,n;){}else for(s=0-i|0,i=16+(o+_(i,n+-1|0)|0)|0,o=A+164|0,d=A+160|0,v=A+168|0,m=e+8|0,R=e+4|0;a=C[v>>2],b=B(g[i+-16>>3]*+C[d>>2]),b=B(b*b),f=B(g[i+-8>>3]*+C[o>>2]),f=B(f*f),k=B(B(r*B(b+f))+k),C[m>>2]=k,a=B(g[i>>3]*+a),a=B(a*a),c=B(B(r*B(b+a))+c),C[R>>2]=c,u=B(u+B(r*B(f+a))),C[e>>2]=u,i=i+s|0,n=n+-1|0,n;){}yf[t[t[A>>2]+116>>2]](A);},function(A){return 11352;},function(A,r){A|=0,r=B(r),C[A+152>>2]=r,yf[t[t[A>>2]+72>>2]](A);},function(A){return A|=0,B(C[A+152>>2]);},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var f,n=0,o=0,k=0,c=0;f=E-128|0,E=f,yf[t[t[A>>2]+112>>2]](A),o=e+8|0,k=t[o+4>>2],n=f+104|0,t[n>>2]=t[o>>2],t[n+4>>2]=k,o=i+8|0,k=t[o+4>>2],n=f+120|0,t[n>>2]=t[o>>2],t[n+4>>2]=k,n=t[e+4>>2],t[f+96>>2]=t[e>>2],t[f+100>>2]=n,e=t[i+4>>2],t[f+112>>2]=t[i>>2],t[f+116>>2]=e,t[f+84>>2]=0,a[f+88|0]=1,t[f+76>>2]=0,t[f+80>>2]=0,mA(A+72|0,f+96|0,f+72|0);A:{e=t[f+76>>2];r:{if(e){for(o=t[A+176>>2],t[f+64>>2]=1008981770,i=(e<<2)-4|0,n=f+84|0;k=t[t[n>>2]+i>>2],c=0|yf[t[t[A>>2]+84>>2]](A),yf[t[t[c>>2]+20>>2]](c,k,f),yf[t[t[r>>2]+8>>2]](r,f,o,t[t[n>>2]+i>>2]),i=i+-4|0,e=e+-1|0,e;){}if(yf[t[t[A>>2]+116>>2]](A),i=t[f+84>>2],!i)break r;break A;}if(yf[t[t[A>>2]+116>>2]](A),i=t[f+84>>2],i)break A;}return void(E=f+128|0);}b[f+88|0]&&gA(i),t[f+84>>2]=0,E=f+128|0;},function(A){A|=0;var r,e,i,n,o,k=0,c=B(0),u=B(0),l=B(0),s=B(0),v=B(0),g=B(0);yf[t[t[A>>2]+112>>2]](A),k=A+72|0,t[A+72>>2]?function(A){var r,e=0,i=B(0),a=0,n=B(0),b=B(0),o=B(0),k=B(0),c=0,u=0,l=B(0),s=B(0),v=B(0),g=B(0),_=0,m=B(0),R=B(0),G=B(0),h=0,y=B(0),Q=0,p=0,D=0,w=B(0),W=0,F=0,Z=0,Y=0,N=0,V=0,I=0,J=0,X=0,M=0,x=0,S=0,T=0,U=0,j=0,O=0,H=B(0),z=B(0),P=B(0),L=B(0),K=0,q=0,$=0;r=E+-64|0,E=r,e=t[A>>2];A:if(e)for(Q=e<<4,h=e+1|0,N=A+16|0,W=t[N>>2],p=r+16|0,_=r+48|0,K=A+72|0,V=A+32|0,Z=r+40|0,I=A+48|0,J=A- -64|0,X=A+28|0,M=A+44|0,x=A+60|0,S=A+40|0,T=A+56|0,Y=r+52|0;;){r:{e:{i:{a:{if(c=Q+W|0,e=t[c+-4>>2],(0|e)>=0){if(c=t[K>>2],yf[t[t[c>>2]+16>>2]](c,e,r+32|0),b=C[I>>2],i=C[V>>2],o=C[Z>>2],o=o<i?i:o,m=C[J>>2],o=B(B(B((b<o?b:o)-i)*m)+B(.5)),o<B(4294967296)&o>=B(0))break a;e=0;break i;}if(a=r+56|0,t[a>>2]=-8388609,t[_>>2]=-8388609,t[_+4>>2]=-8388609,t[r+36>>2]=2139095039,t[r+40>>2]=2139095039,e=d[c>>1],u=d[c+2>>1],D=d[c+4>>1],F=r+12|0,t[F>>2]=0,U=r+8|0,m=C[J>>2],l=C[V>>2],b=B(B(B(D>>>0)/m)+l),C[U>>2]=b,R=C[x>>2],s=C[X>>2],o=B(B(B(u>>>0)/R)+s),C[r+4>>2]=o,G=C[T>>2],k=C[A+24>>2],i=B(B(B(e>>>0)/G)+k),C[r>>2]=i,e=d[c+6>>1],u=d[c+8>>1],D=d[c+10>>1],j=r+28|0,t[j>>2]=0,O=r+24|0,g=B(l+B(B(D>>>0)/m)),C[O>>2]=g,D=r+20|0,w=B(s+B(B(u>>>0)/R)),C[D>>2]=w,n=B(k+B(B(e>>>0)/G)),C[p>>2]=n,y=i<B(3.4028234663852886e38)?i:B(3.4028234663852886e38),C[r+32>>2]=y,e=o<B(3.4028234663852886e38)?r:r+32|0,o=C[e+4>>2],e=t[e+4>>2],u=b<B(3.4028234663852886e38)?r:r+32|0,i=C[u+8>>2],u=t[u+8>>2],v=n>B(-3.4028234663852886e38)?n:B(-3.4028234663852886e38),C[_>>2]=v,t[Z>>2]=u,t[r+36>>2]=e,e=w>B(-3.4028234663852886e38)?p:_,n=C[e+4>>2],t[Y>>2]=t[e+4>>2],e=g>B(-3.4028234663852886e38)?p:_,b=C[e+8>>2],t[a>>2]=t[e+8>>2],e=t[c+12>>2],e=(((0|e)>-1?e:-1)-e|0)+h|0,e&&(e=(e<<4)+W|0,u=d[e+2>>1],q=d[e>>1],$=d[e+4>>1],t[F>>2]=0,H=B(B(B($>>>0)/m)+l),C[U>>2]=H,g=B(B(B(q>>>0)/G)+k),C[r>>2]=g,z=B(B(B(u>>>0)/R)+s),C[r+4>>2]=z,u=d[e+6>>1],F=d[e+8>>1],e=d[e+10>>1],t[j>>2]=0,P=B(l+B(B(e>>>0)/m)),C[O>>2]=P,L=B(s+B(B(F>>>0)/R)),C[D>>2]=L,w=B(k+B(B(u>>>0)/G)),C[p>>2]=w,e=z<o?r:r+32|0,o=C[e+4>>2],e=t[e+4>>2],u=H<i?r:r+32|0,i=C[u+8>>2],u=t[u+8>>2],v=v<w?w:v,C[_>>2]=v,t[Z>>2]=u,u=L>n?p:_,n=C[u+4>>2],t[Y>>2]=t[u+4>>2],u=a,a=P>b?p:_,b=C[a+8>>2],t[u>>2]=t[a+8>>2],y=y>g?g:y,C[r+32>>2]=y,t[r+36>>2]=e),g=C[I>>2],b=b<l?l:b,b=B(B(m*B((g<b?g:b)-l))+B(.5)),b<B(4294967296)&b>=B(0))break e;e=0;break r;}e=~~o>>>0;}if(k=C[r+32>>2],n=C[r+36>>2],W=t[N>>2],c=W+Q|0,f[c+-12>>1]=e,e=c+-14|0,l=C[M>>2],o=C[X>>2],n=n<o?o:n,R=C[x>>2],n=B(B(B((l<n?l:n)-o)*R)+B(.5)),a=0,n<B(4294967296)&n>=B(0)&&(a=~~n>>>0),f[e>>1]=a,e=c+-16|0,s=C[S>>2],n=C[A+24>>2],k=k<n?n:k,G=C[T>>2],k=B(B(B((s<k?s:k)-n)*G)+B(.5)),a=0,k<B(4294967296)&k>=B(0)&&(a=~~k>>>0),f[e>>1]=a,k=C[r+56>>2],k=k<i?i:k,i=B(B(m*B((b<k?b:k)-i))+B(.5)),e=0,i<B(4294967296)&i>=B(0)&&(e=~~i>>>0),i=C[_>>2],b=C[Y>>2],f[c+-6>>1]=e,e=c+-8|0,b=b<o?o:b,o=B(B(R*B((l<b?l:b)-o))+B(.5)),a=0,o<B(4294967296)&o>=B(0)&&(a=~~o>>>0),f[e>>1]=a,e=c+-10|0,i=i<n?n:i,i=B(B(G*B((s<i?s:i)-n))+B(.5)),a=0,i<B(4294967296)&i>=B(0)&&(a=~~i>>>0),f[e>>1]=a,Q=Q+-16|0,h=h+-1|0,1!=(0|h))continue;break A;}e=~~b>>>0;}if(f[c+-6>>1]=e,e=c+-8|0,b=C[M>>2],n=n<s?s:n,n=B(B(R*B((b<n?b:n)-s))+B(.5)),a=0,n<B(4294967296)&n>=B(0)&&(a=~~n>>>0),f[e>>1]=a,e=c+-10|0,n=C[S>>2],v=v<k?k:v,v=B(B(G*B((n<v?n:v)-k))+B(.5)),a=0,v<B(4294967296)&v>=B(0)&&(a=~~v>>>0),f[e>>1]=a,e=c+-12|0,i=i<l?l:i,i=B(B(B((g<i?g:i)-l)*m)+B(.5)),a=0,i<B(4294967296)&i>=B(0)&&(a=~~i>>>0),f[e>>1]=a,e=c+-14|0,i=o<s?s:o,i=B(B(B((b<i?b:i)-s)*R)+B(.5)),a=0,i<B(4294967296)&i>=B(0)&&(a=~~i>>>0),f[e>>1]=a,e=c+-16|0,i=y<k?k:y,i=B(B(B((n<i?n:i)-k)*G)+B(.5)),a=0,i<B(4294967296)&i>=B(0)&&(a=~~i>>>0),f[e>>1]=a,Q=Q+-16|0,h=h+-1|0,1==(0|h))break;}E=r- -64|0;}(k):function(A){var r,e,i=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0;r=E+-64|0,E=r,a[r+56|0]=1,t[r+44>>2]=0,t[r+48>>2]=0,t[r+52>>2]=0,i=t[A+72>>2],e=0|yf[t[t[i>>2]+12>>2]](i),n=r+32|0,i=n,t[i>>2]=0,t[i+4>>2]=0,u=r+24|0,i=u,t[i>>2]=0,t[i+4>>2]=0,f=r+16|0,i=f,t[i>>2]=0,t[i+4>>2]=0,t[r+8>>2]=0,t[r+12>>2]=0;A:if((0|e)>0){if(l=r+52|0,i=CA(_(e,36),16),t[l>>2]=i,a[r+56|0]=1,t[r+48>>2]=e,t[i+32>>2]=0,o=t[f+4>>2],k=i+8|0,t[k>>2]=t[f>>2],t[k+4>>2]=o,f=t[r+12>>2],t[i>>2]=t[r+8>>2],t[i+4>>2]=f,f=t[r+28>>2],t[i+16>>2]=t[r+24>>2],t[i+20>>2]=f,f=t[n+4>>2],i=i+24|0,t[i>>2]=t[n>>2],t[i+4>>2]=f,1!=(0|e))for(k=e+-1|0,n=36;o=t[r+12>>2],f=t[l>>2]+n|0,i=f,t[i>>2]=t[r+8>>2],t[i+4>>2]=o,o=r+16|0,c=t[o+4>>2],i=i+8|0,t[i>>2]=t[o>>2],t[i+4>>2]=c,i=u,c=t[i+4>>2],o=f+16|0,t[o>>2]=t[i>>2],t[o+4>>2]=c,i=i+8|0,c=t[i+4>>2],o=f+24|0,t[o>>2]=t[i>>2],t[o+4>>2]=c,t[f+32>>2]=0,n=n+36|0,k=k+-1|0,k;){}if(t[r+44>>2]=e,(0|e)<1)break A;for(i=t[r+52>>2],n=0,u=A+72|0;f=t[u>>2],yf[t[t[f>>2]+16>>2]](f,n,i),t[i+32>>2]=n,i=i+36|0,n=n+1|0,(0|n)<(0|e);){}}else t[r+44>>2]=e;BA(A,r+40|0),A=t[r+52>>2],A&&(b[r+56|0]&&gA(A),t[r+52>>2]=0),E=r- -64|0;}(k),yf[t[t[A>>2]+116>>2]](A),k=t[A+88>>2],r=d[k+8>>1],e=d[k+10>>1],i=d[k>>1],n=d[k+2>>1],o=d[k+4>>1],k=d[k+6>>1],t[A+48>>2]=0,t[A+32>>2]=0,c=C[A+96>>2],u=C[A+128>>2],C[A+36>>2]=c+B(B(k>>>0)/u),l=C[A+136>>2],s=C[A+104>>2],C[A+28>>2]=B(B(o>>>0)/l)+s,v=C[A+132>>2],g=C[A+100>>2],C[A+24>>2]=B(B(n>>>0)/v)+g,C[A+20>>2]=c+B(B(i>>>0)/u),C[A+44>>2]=s+B(B(e>>>0)/l),C[A+40>>2]=g+B(B(r>>>0)/v);},function(A){A|=0,a[A+52|0]=1;},function(A){return 25;},Fr,function(A){return A|=0,A+148|0;},function(A){return A|=0,t[A+208>>2];},Zr,Fr,Zr,function(A,r,e){A|=0,r|=0,e|=0,function(A,r,e){var i=B(0),a=0,f=0,n=0;r=t[A+52>>2]+_(t[A+56>>2],r)|0,n=t[A+36>>2],3!=t[A+64>>2]?(a=t[r+8>>2],f=t[r+4>>2],r=t[r>>2]):(a=d[r+4>>1],f=d[r+2>>1],r=d[r>>1]),r=n+_(r,t[A+48>>2])|0,n=e+68|0,1!=t[A+44>>2]?(C[e+60>>2]=C[r>>2]*C[A+12>>2],C[e- -64>>2]=C[r+4>>2]*C[A+16>>2],i=B(C[r+8>>2]*C[A+20>>2])):(C[e+60>>2]=g[r>>3]*+C[A+12>>2],C[e- -64>>2]=g[r+8>>3]*+C[A+16>>2],i=B(g[r+16>>3]*+C[A+20>>2])),C[n>>2]=i,r=t[A+36>>2]+_(t[A+48>>2],f)|0,f=e+84|0,1!=t[A+44>>2]?(C[e+76>>2]=C[r>>2]*C[A+12>>2],C[e+80>>2]=C[r+4>>2]*C[A+16>>2],i=B(C[r+8>>2]*C[A+20>>2])):(C[e+76>>2]=g[r>>3]*+C[A+12>>2],C[e+80>>2]=g[r+8>>3]*+C[A+16>>2],i=B(g[r+16>>3]*+C[A+20>>2])),C[f>>2]=i,r=t[A+36>>2]+_(t[A+48>>2],a)|0,a=e+100|0,1!=t[A+44>>2]?(C[e+92>>2]=C[r>>2]*C[A+12>>2],C[e+96>>2]=C[r+4>>2]*C[A+16>>2],i=B(C[r+8>>2]*C[A+20>>2])):(C[e+92>>2]=g[r>>3]*+C[A+12>>2],C[e+96>>2]=g[r+8>>3]*+C[A+16>>2],i=B(g[r+16>>3]*+C[A+20>>2])),C[a>>2]=i,yf[t[t[e>>2]+44>>2]](e,C[A+4>>2]);}(A+148|0,r,e);},Yr,function(A){A|=0;var r=0;A=t[A+144>>2],r=t[A+32>>2],(0|r)>=1?t[A+32>>2]=r+1:(r=t[A+8>>2],yf[t[t[r>>2]+16>>2]](r,A+36|0,A+40|0,A+44|0,A+48|0,A+52|0,A+56|0,A+60|0,A- -64|0,t[A+28>>2]),t[A+32>>2]=1);},function(A){A|=0;var r=0,e=0;A=t[A+144>>2],r=t[A+32>>2],r&&(e=A+32|0,(0|r)>=2?A=r+-1|0:(r=t[A+8>>2],yf[t[t[r>>2]+24>>2]](r,t[A+28>>2]),t[A+36>>2]=0,A=0),t[e>>2]=A);},function(A,r,e,i,a){A|=0,r|=0,e|=0,i|=0,a|=0;var f,n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0);f=E-32|0,E=f,A=0|yf[t[t[A>>2]+84>>2]](A),yf[t[t[A>>2]+16>>2]](A,r,f),s=C[e+56>>2],u=C[e+36>>2],v=C[e+40>>2],p=C[e+48>>2],g=C[e+8>>2],_=C[e>>2],R=C[e+4>>2],G=C[e+32>>2],o=C[f+16>>2],n=B(B(o+C[f>>2])*B(.5)),r=f+20|0,k=C[r>>2],b=B(B(k+C[f+4>>2])*B(.5)),A=f+24|0,c=C[A>>2],d=B(B(c+C[f+8>>2])*B(.5)),o=B(o-n),l=C[e+16>>2],k=B(k-b),h=C[e+20>>2],c=B(c-d),y=C[e+24>>2],Q=B(B(B(o*B(m(l)))+B(k*B(m(h))))+B(c*B(m(y)))),l=B(B(B(B(n*l)+B(b*h))+B(d*y))+C[e+52>>2]),C[r>>2]=Q+l,t[f+12>>2]=0,s=B(s+B(B(B(n*G)+B(b*u))+B(d*v))),u=B(B(B(o*B(m(G)))+B(k*B(m(u))))+B(c*B(m(v)))),C[f+8>>2]=s-u,e=t[f+12>>2],r=i+8|0,t[r>>2]=t[f+8>>2],t[r+4>>2]=e,C[f+4>>2]=l-Q,n=B(p+B(B(B(n*_)+B(b*R))+B(d*g))),b=B(B(B(o*B(m(_)))+B(k*B(m(R))))+B(c*B(m(g)))),C[f>>2]=n-b,r=t[f+4>>2],t[i>>2]=t[f>>2],t[i+4>>2]=r,t[f+28>>2]=0,C[A>>2]=u+s,C[f+16>>2]=b+n,r=t[f+20>>2],t[a>>2]=t[f+16>>2],t[a+4>>2]=r,e=t[A+4>>2],r=a+8|0,t[r>>2]=t[A>>2],t[r+4>>2]=e,E=f+32|0;},kr,kr,Yr,Yr,or,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var f,n=B(0),o=B(0),k=B(0),c=B(0),u=0,l=0,s=0,v=0;f=E-112|0,E=f,yf[t[t[A>>2]+112>>2]](A),t[f+100>>2]=0,a[f+104|0]=1,t[f+92>>2]=0,t[f+96>>2]=0,t[f+84>>2]=0,n=B(C[i>>2]-C[e>>2]),o=B(C[i+4>>2]-C[e+4>>2]),k=B(C[i+8>>2]-C[e+8>>2]),c=B(B(1)/B(Q(B(B(B(n*n)+B(o*o))+B(k*k))))),C[f+80>>2]=k*c,C[f+76>>2]=o*c,C[f+72>>2]=n*c,function(A,r,e,i){var f,n=B(0),o=0,k=B(0),c=B(0),u=0,l=0,s=0,v=B(0),g=B(0),_=0,R=B(0),G=0,h=B(0),y=0,Q=0,p=B(0),D=B(0),w=0,W=0,F=B(0),Z=B(0),Y=B(0),E=0,N=0,V=0,I=0,J=0,X=0,M=0;f=t[A>>2];A:if(!((0|f)<1))for(W=A+16|0,N=A+56|0,V=A+24|0,I=A- -64|0,J=A+32|0,X=A+60|0,M=A+28|0,y=i+12|0;;){s=G<<4,A=s+t[W>>2]|0,u=d[A+4>>1],v=C[I>>2],k=C[J>>2],l=d[A+10>>1],o=d[A+2>>1],g=C[X>>2],c=C[M>>2],_=d[A+8>>1],R=C[V>>2],n=C[N>>2],h=B(R+B(B(d[A+6>>1])/n));r:{if(n=B(B(B(B(B(d[A>>1])/n)+R)+h)*B(.5)),R=B(C[e>>2]-n),h=B(h-n),B(R*C[r>>2])>=B(0)&&B(m(R))>h||(n=B(B(B(o>>>0)/g)+c),c=B(c+B(B(_>>>0)/g)),n=B(B(n+c)*B(.5)),g=B(C[e+4>>2]-n),c=B(c-n),B(g*C[r+4>>2])>=B(0)&&B(m(g))>c||(n=B(B(B(u>>>0)/v)+k),k=B(k+B(B(l>>>0)/v)),n=B(B(n+k)*B(.5)),v=B(C[e+8>>2]-n),n=B(k-n),k=C[r+8>>2],B(v*k)>=B(0)&&B(m(v))>n||(p=C[r+4>>2],F=B(m(p)),Z=B(m(k)),B(m(B(B(v*p)-B(g*k))))>B(B(c*Z)+B(n*F))||(D=C[r>>2],Y=B(m(D)),B(m(B(B(R*k)-B(v*D))))>B(B(h*Z)+B(n*Y)))))))A=t[A+12>>2]>-1,u=0;else if(l=B(m(B(B(g*D)-B(R*p))))>B(B(h*F)+B(c*Y)),u=1^l,w=t[A+12>>2],A=(0|w)>-1,!((0|w)<0|l)){if(_=i+4|0,o=t[_>>2],E=i+8|0,(0|o)==t[E>>2]&&(Q=o?o<<1:1,!((0|o)>=(0|Q)))){e:{i:{a:{f:{if(Q){if(l=CA(Q<<2,16),s=t[y>>2],o=t[_>>2],(0|o)<1)break f;break a;}if(l=0,s=t[y>>2],(0|o)>=1)break a;}if(!s)break e;break i;}for(A=l,u=s;t[A>>2]=t[u>>2],A=A+4|0,u=u+4|0,o=o+-1|0,o;){}}b[i+16|0]&&gA(s),t[y>>2]=0,o=t[_>>2];}t[y>>2]=l,a[i+16|0]=1,t[E>>2]=Q;}t[t[y>>2]+(o<<2)>>2]=w,t[_>>2]=t[_>>2]+1;break r;}if(!(A|u)){if(G=G-t[12+(s+t[W>>2]|0)>>2]|0,(0|G)<(0|f))continue;break A;}}if(G=G+1|0,!((0|G)<(0|f)))break;}}(A+72|0,f+72|0,e,f+88|0);A:{i=t[f+92>>2];r:{if(i){for(s=t[A+176>>2],t[f+64>>2]=1008981770,e=(i<<2)-4|0,u=f+100|0;v=t[t[u>>2]+e>>2],l=0|yf[t[t[A>>2]+84>>2]](A),yf[t[t[l>>2]+20>>2]](l,v,f),yf[t[t[r>>2]+8>>2]](r,f,s,t[t[u>>2]+e>>2]),e=e+-4|0,i=i+-1|0,i;){}if(yf[t[t[A>>2]+116>>2]](A),e=t[f+100>>2],!e)break r;break A;}if(yf[t[t[A>>2]+116>>2]](A),e=t[f+100>>2],e)break A;}return void(E=f+112|0);}b[f+104|0]&&gA(e),t[f+100>>2]=0,E=f+112|0;},re,function(A){A|=0,gA(re(A));},function(A,r){A|=0,r|=0;var e=0,i=0,f=0,n=0;if(e=t[r+4>>2],t[A+56>>2]=t[r>>2],t[A+60>>2]=e,i=r+8|0,f=t[i+4>>2],e=A- -64|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,e=t[A+156>>2],e)for(i=(e<<2)-4|0,f=A+164|0;n=t[t[f>>2]+i>>2],yf[t[t[n>>2]+24>>2]](n,r),i=i+-4|0,e=e+-1|0,e;){}a[A+52|0]=1;},$r,function(A,r,e){A|=0,r=B(r),e|=0;var i,a,f=0,n=0,b=0,o=0;if(i=E-16|0,E=i,t[e>>2]=0,t[e+4>>2]=0,a=e+8|0,t[a>>2]=0,t[a+4>>2]=0,f=t[A+156>>2],f)for(r=B(r/B(0|f)),n=(f<<2)-4|0,o=A+164|0,A=e+4|0;b=t[t[o>>2]+n>>2],yf[t[t[b>>2]+32>>2]](b,r,i),C[e>>2]=C[i>>2]+C[e>>2],C[A>>2]=C[i+4>>2]+C[A>>2],C[a>>2]=C[i+8>>2]+C[a>>2],n=n+-4|0,f=f+-1|0,f;){}E=i+16|0;},function(A){return 11373;},function(A,r){A|=0,r=B(r);var e=0,i=0,f=0,n=0;if(C[A+16>>2]=r,e=t[A+156>>2],e)for(i=(e<<2)-4|0,n=A+164|0;f=t[t[n>>2]+i>>2],yf[t[t[f>>2]+44>>2]](f,r),i=i+-4|0,e=e+-1|0,e;){}a[A+52|0]=1;},function(A){return 64;},function(A,r,e){var i,a,f;return A|=0,r|=0,e|=0,hA(A,r,e),i=t[A+148>>2],yf[t[t[i>>2]+56>>2]](i,r+12|0,e),t[r+56>>2]=t[A+16>>2],t[r+40>>2]=t[A+56>>2],t[r+44>>2]=t[A+60>>2],t[r+48>>2]=t[A- -64>>2],t[r+52>>2]=t[A+68>>2],a=r,f=0|yf[t[t[A>>2]+80>>2]](A),t[a+60>>2]=f,10768;},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a=0,f=0,n=0;if(a=t[A+156>>2],a)for(f=(a<<2)-4|0,A=A+164|0;n=t[t[A>>2]+f>>2],yf[t[t[n>>2]+64>>2]](n,r,e,i),f=f+-4|0,a=a+-1|0,a;){}},function(A){A|=0;var r,e,i,f=0,n=0,o=0,k=B(0),c=B(0),u=B(0),l=0,s=0,d=0,v=0,g=B(0),_=B(0),m=B(0),R=B(0),G=0;if(t[A+20>>2]=2139095039,t[A+24>>2]=2139095039,e=A+44|0,t[e>>2]=-8388609,r=A+36|0,t[r>>2]=-8388609,t[r+4>>2]=-8388609,i=A+28|0,t[i>>2]=2139095039,o=t[A+156>>2],o)for(s=A+20|0,d=(o<<2)-4|0,G=A+164|0,v=t[G>>2],g=B(3.4028234663852886e38),_=B(-3.4028234663852886e38),m=B(-3.4028234663852886e38),k=B(-3.4028234663852886e38),R=B(3.4028234663852886e38),c=B(3.4028234663852886e38);o=o+-1|0,f=t[d+v>>2],b[f+52|0]&&(yf[t[t[f>>2]+68>>2]](f),a[f+52|0]=0,_=C[e>>2],m=C[A+40>>2],R=C[A+24>>2],v=t[G>>2],k=C[r>>2],c=C[s>>2],g=C[i>>2]),f=t[d+v>>2],u=C[f+20>>2],c=c>u?u:c,C[s>>2]=c,n=f+20|0,l=R>C[f+24>>2]?n:s,R=C[l+4>>2],t[A+24>>2]=t[l+4>>2],n=g>C[f+28>>2]?n:s,g=C[n+8>>2],t[i>>2]=t[n+8>>2],n=f+36|0,u=C[n>>2],k=k<u?u:k,C[r>>2]=k,l=m<C[f+40>>2]?n:r,m=C[l+4>>2],t[A+40>>2]=t[l+4>>2],f=_<C[f+44>>2]?n:r,_=C[f+8>>2],t[e>>2]=t[f+8>>2],d=d+-4|0,o;){}},function(A){A|=0;var r=0,e=0,i=0,f=0;if(r=t[A+156>>2],r)for(e=(r<<2)-4|0,f=A+164|0;i=t[t[f>>2]+e>>2],yf[t[t[i>>2]+72>>2]](i),e=e+-4|0,r=r+-1|0,r;){}a[A+52|0]=1;},wr,Zr,Zr,Zr,Zr,Zr,Yr,Yr,Ae,Ae,ee,kr,kr,Yr,Yr,or,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a=0,f=0,n=0;if(a=t[A+156>>2],a)for(f=(a<<2)-4|0,A=A+164|0;n=t[t[A>>2]+f>>2],yf[t[t[n>>2]+144>>2]](n,r,e,i),f=f+-4|0,a=a+-1|0,a;){}},qr,dA,function(A,r){A|=0,r|=0;var e,i=0;i=t[r+4>>2],t[A+56>>2]=t[r>>2],t[A+60>>2]=i,r=r+8|0,e=t[r+4>>2],i=A- -64|0,t[i>>2]=t[r>>2],t[i+4>>2]=e,yf[t[t[A>>2]+72>>2]](A);},function(A,r){A|=0,r=B(r);var e=0,i=0;if(C[A+16>>2]=r,e=0|yf[t[t[A>>2]+88>>2]](A),e)for(e=e+-1|0;i=0|yf[t[t[A>>2]+124>>2]](A,e),yf[t[t[i>>2]+44>>2]](i,r),e=e+-1|0,-1!=(0|e);){}a[A+52|0]=1;},or,Ae,Ae,or,sA,Cr,Fr,function(A){return A|=0,t[A+60>>2];},function(A,r,e){A|=0,r|=0,e|=0;var i,a=0,f=B(0),n=0,b=0,o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0);i=E-80|0,E=i,t[i+72>>2]=1008981770,yf[t[t[A>>2]+20>>2]](A,r,i+8|0),f=C[i+12>>2],A=i+40|0,r=i+24|0,o=C[i+28>>2],k=C[i+44>>2],a=o>k,n=f>C[(a?A:r)+4>>2]^1,b=n?4:36,s=C[(i+8|0)+(a?b:n?b:20)>>2],u=C[i+16>>2],c=C[i+32>>2],l=C[i+48>>2],a=c>l,n=u>C[(a?A:r)+8>>2]^1,b=n?8:40,d=C[(i+8|0)+(a?b:n?b:24)>>2],a=o<k,n=f<C[(a?A:r)+4>>2]^1,b=n?4:36,v=C[(i+8|0)+(a?b:n?b:20)>>2],a=A,A=c<l,r=u<C[(A?a:r)+8>>2]^1,a=r?8:40,u=C[(i+8|0)+(A?a:r?a:24)>>2],o=C[i+24>>2],k=C[i+40>>2],A=o>k,c=C[i+8>>2],r=c>(A?k:o),a=r<<5,l=C[(i+8|0)+(A?a:1^r?a:16)>>2],f=C[i+72>>2],A=o<k,r=c<(A?k:o),a=r<<5,C[e+16>>2]=f+C[(i+8|0)+(A?a:1^r?a:16)>>2],C[e>>2]=l-f,C[e+24>>2]=f+u,C[e+20>>2]=f+v,C[e+8>>2]=d-f,C[e+4>>2]=s-f,E=i+80|0;},function(A,r,e){A|=0,r|=0,e|=0;var i=B(0),a=0,f=0,n=0;r=t[A+52>>2]+_(t[A+56>>2],r)|0,a=t[A+36>>2],3!=t[A+64>>2]?(f=t[r+8>>2],n=t[r+4>>2],r=t[r>>2]):(f=d[r+4>>1],n=d[r+2>>1],r=d[r>>1]),r=a+_(r,t[A+48>>2])|0,a=e,1!=t[A+44>>2]?(C[e>>2]=C[r>>2]*C[A+12>>2],C[e+4>>2]=C[r+4>>2]*C[A+16>>2],i=B(C[r+8>>2]*C[A+20>>2])):(C[e>>2]=g[r>>3]*+C[A+12>>2],C[e+4>>2]=g[r+8>>3]*+C[A+16>>2],i=B(g[r+16>>3]*+C[A+20>>2])),C[a+8>>2]=i,r=t[A+36>>2]+_(t[A+48>>2],n)|0,a=e+24|0,1!=t[A+44>>2]?(C[e+16>>2]=C[r>>2]*C[A+12>>2],C[e+20>>2]=C[r+4>>2]*C[A+16>>2],i=B(C[r+8>>2]*C[A+20>>2])):(C[e+16>>2]=g[r>>3]*+C[A+12>>2],C[e+20>>2]=g[r+8>>3]*+C[A+16>>2],i=B(g[r+16>>3]*+C[A+20>>2])),C[a>>2]=i,r=t[A+36>>2]+_(t[A+48>>2],f)|0,a=e+40|0,1!=t[A+44>>2]?(C[e+32>>2]=C[r>>2]*C[A+12>>2],C[e+36>>2]=C[r+4>>2]*C[A+16>>2],i=B(C[r+8>>2]*C[A+20>>2])):(C[e+32>>2]=g[r>>3]*+C[A+12>>2],C[e+36>>2]=g[r+8>>3]*+C[A+16>>2],i=B(g[r+16>>3]*+C[A+20>>2])),C[a>>2]=i,t[e+64>>2]=t[A+4>>2];},function(A){A|=0;var r,e=0;return t[A>>2]=14280,e=t[A+68>>2],e&&(ae(e),gA(t[A+68>>2])),e=A+28|0,r=t[e>>2],r&&(b[A+32|0]&&gA(r),t[A+28>>2]=0),t[e>>2]=0,a[A+32|0]=1,e=A+20|0,t[e>>2]=0,t[e+4>>2]=0,0|A;},function(A){A|=0;var r,e=0;t[A>>2]=14280,e=t[A+68>>2],e&&(ae(e),gA(t[A+68>>2])),e=A+28|0,r=t[e>>2],r&&(b[A+32|0]&&gA(r),t[A+28>>2]=0),t[e>>2]=0,a[A+32|0]=1,e=A+20|0,t[e>>2]=0,t[e+4>>2]=0,gA(A);},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0);f=C[A+44>>2],o=C[A+60>>2],a=t[A+20>>2],n=C[A+40>>2],k=C[A+56>>2],b=C[A+36>>2],c=C[A+52>>2],D=B(yf[t[t[A>>2]+48>>2]](A)),w=B(yf[t[t[A>>2]+48>>2]](A)),W=B(yf[t[t[A>>2]+48>>2]](A)),F=C[r+52>>2],u=C[r+24>>2],g=C[r+20>>2],l=C[r+56>>2],_=C[r+40>>2],R=C[r+36>>2],Z=C[r+48>>2],G=C[r+8>>2],h=C[r>>2],y=C[r+4>>2],Q=C[r+16>>2],p=C[r+32>>2],t[e+12>>2]=0,s=l,l=B(a?B(c+b)*B(.5):0),d=B(a?B(k+n)*B(.5):0),v=B(a?B(o+f)*B(.5):0),s=B(s+B(B(B(p*l)+B(R*d))+B(_*v))),b=B(D+B(a?B(c-b)*B(.5):0)),n=B(w+B(a?B(k-n)*B(.5):0)),f=B(W+B(a?B(o-f)*B(.5):0)),o=B(B(B(b*B(m(p)))+B(n*B(m(R))))+B(f*B(m(_)))),C[e+8>>2]=s-o,k=B(F+B(B(B(l*Q)+B(d*g))+B(v*u))),c=B(B(B(b*B(m(Q)))+B(n*B(m(g))))+B(f*B(m(u)))),C[e+4>>2]=k-c,u=B(Z+B(B(B(l*h)+B(d*y))+B(v*G))),f=B(B(B(b*B(m(h)))+B(n*B(m(y))))+B(f*B(m(G)))),C[e>>2]=u-f,t[i+12>>2]=0,C[i+8>>2]=o+s,C[i+4>>2]=c+k,C[i>>2]=f+u;},function(A,r){A|=0,r|=0;var e,i,a=0,f=0,n=0,b=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,g=0,_=0,m=0,R=0,G=0,h=0,y=0,Q=0,p=0,D=0,w=0,W=B(0);if(e=E-144|0,E=e,i=A+20|0,t[i>>2]>=1)for(g=e+96|0,c=e- -64|0,s=e+48|0,d=e+32|0,v=A+28|0,D=e+12|0,m=A+88|0,R=r+4|0,G=A+84|0,h=A+80|0,w=e+76|0,y=e+68|0,Q=A+68|0;a=t[v>>2]+l|0,o=a+8|0,b=t[o+4>>2],f=e+24|0,t[f>>2]=t[o>>2],t[f+4>>2]=b,k=t[a+4>>2],t[e+16>>2]=t[a>>2],t[e+20>>2]=k,b=a+24|0,n=t[b+4>>2],k=d+8|0,o=k,t[o>>2]=t[b>>2],t[o+4>>2]=n,o=a+16|0,b=t[o+4>>2],t[d>>2]=t[o>>2],t[d+4>>2]=b,o=a+32|0,b=t[o+4>>2],t[s>>2]=t[o>>2],t[s+4>>2]=b,n=a+40|0,u=t[n+4>>2],o=s+8|0,b=o,t[b>>2]=t[n>>2],t[b+4>>2]=u,b=a+48|0,n=t[b+4>>2],t[c>>2]=t[b>>2],t[c+4>>2]=n,u=a+56|0,_=t[u+4>>2],b=c+8|0,n=b,t[n>>2]=t[u>>2],t[n+4>>2]=_,n=e+8|0,a=t[a- -64>>2],a=0|yf[t[t[a>>2]+28>>2]](a),t[n>>2]=t[a+8>>2],u=t[a+4>>2],a=t[a>>2],t[D>>2]=0,_=n,W=C[n>>2],n=r+8|0,C[_>>2]=B(W*C[n>>2])/C[m>>2],t[e>>2]=a,t[e+4>>2]=u,C[e+4>>2]=B(C[e+4>>2]*C[R>>2])/C[G>>2],C[e>>2]=B(C[e>>2]*C[r>>2])/C[h>>2],a=t[(t[v>>2]+l|0)- -64>>2],yf[t[t[a>>2]+24>>2]](a,e),t[w>>2]=0,a=e+72|0,C[a>>2]=B(C[a>>2]*C[n>>2])/C[m>>2],C[y>>2]=B(C[y>>2]*C[R>>2])/C[G>>2],C[c>>2]=B(C[c>>2]*C[r>>2])/C[h>>2],u=t[f+4>>2],a=t[v>>2]+l|0,n=a+8|0,t[n>>2]=t[f>>2],t[n+4>>2]=u,f=t[e+20>>2],t[a>>2]=t[e+16>>2],t[a+4>>2]=f,n=t[d+4>>2],f=a+16|0,t[f>>2]=t[d>>2],t[f+4>>2]=n,n=t[k+4>>2],f=a+24|0,t[f>>2]=t[k>>2],t[f+4>>2]=n,k=t[o+4>>2],f=a+40|0,t[f>>2]=t[o>>2],t[f+4>>2]=k,k=t[s+4>>2],f=a+32|0,t[f>>2]=t[s>>2],t[f+4>>2]=k,k=t[c+4>>2],f=a+48|0,t[f>>2]=t[c>>2],t[f+4>>2]=k,f=t[b+4>>2],a=a+56|0,t[a>>2]=t[b>>2],t[a+4>>2]=f,t[Q>>2]&&(a=t[(t[v>>2]+l|0)- -64>>2],yf[t[t[a>>2]+8>>2]](a,e+16|0,e+128|0,e+112|0),f=e+120|0,k=t[f+4>>2],a=g+8|0,t[a>>2]=t[f>>2],t[a+4>>2]=k,a=t[e+116>>2],t[g>>2]=t[e+112>>2],t[g+4>>2]=a,f=e+136|0,k=t[f+4>>2],a=e+88|0,t[a>>2]=t[f>>2],t[a+4>>2]=k,a=t[e+132>>2],t[e+80>>2]=t[e+128>>2],t[e+84>>2]=a,ce(t[Q>>2],t[76+(t[v>>2]+l|0)>>2],e+80|0)),l=l+80|0,p=p+1|0,(0|p)<t[i>>2];){}a=t[r+4>>2],t[A+80>>2]=t[r>>2],t[A+84>>2]=a,r=r+8|0,c=t[r+4>>2],a=A+88|0,t[a>>2]=t[r>>2],t[a+4>>2]=c,yf[t[t[A>>2]+68>>2]](A),E=e+144|0;},function(A){return A|=0,A+80|0;},function(A,r,e){A|=0,r=B(r),e|=0;var i,a=B(0),f=0,n=B(0),b=B(0);i=E-96|0,E=i,f=i+44|0,t[f>>2]=0,t[f+4>>2]=0,t[i+52>>2]=1065353216,f=i+56|0,t[f>>2]=0,t[f+4>>2]=0,t[i+72>>2]=1065353216,t[i+92>>2]=0,f=i+84|0,t[f>>2]=0,t[f+4>>2]=0,f=i+76|0,t[f>>2]=0,t[f+4>>2]=0,t[i+36>>2]=0,t[i+40>>2]=0,t[i+32>>2]=1065353216,t[i+64>>2]=0,t[i+68>>2]=0,yf[t[t[A>>2]+8>>2]](A,i+32|0,i+16|0,i),r=B(r/B(12)),a=B(B(C[i>>2]-C[i+16>>2])*B(.5)),a=B(a+a),a=B(a*a),n=B(B(C[i+4>>2]-C[i+20>>2])*B(.5)),n=B(n+n),n=B(n*n),C[e+8>>2]=r*B(a+n),b=a,a=B(B(C[i+8>>2]-C[i+24>>2])*B(.5)),a=B(a+a),a=B(a*a),C[e+4>>2]=r*B(b+a),C[e>>2]=r*B(n+a),E=i+96|0;},function(A){return 14428;},function(A,r){A|=0,r=B(r),C[A+76>>2]=r;},function(A){return A|=0,B(C[A+76>>2]);},function(A){return 24;},function(A,r,e){A|=0,r|=0,e|=0;var i=0,a=0,f=0,n=0,b=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0;if(hA(A,r,e),t[r+12>>2]=0,t[r+20>>2]=t[A+76>>2],i=t[A+20>>2],t[r+16>>2]=i,i){if(f=0|yf[t[t[e>>2]+16>>2]](e,76,i),a=t[f+8>>2],k=r+12|0,c=0|yf[t[t[e>>2]+28>>2]](e,a),t[k>>2]=c,n=r+16|0,t[n>>2]>0)for(i=72,r=a+72|0,a=A+28|0;A=t[a>>2]+i|0,t[r>>2]=t[A>>2],k=r+-8|0,c=0|yf[t[t[e>>2]+28>>2]](e,t[A+-8>>2]),t[k>>2]=c,yf[t[t[e>>2]+24>>2]](e,t[(t[a>>2]+i|0)-8>>2])||(A=t[(t[a>>2]+i|0)-8>>2],c=e,u=0|yf[t[t[A>>2]+52>>2]](A),l=1,k=t[t[e>>2]+16>>2],A=0|yf[k](0|c,0|u,0|l),b=t[(t[a>>2]+i|0)-8>>2],l=e,u=A,c=0|yf[t[t[b>>2]+56>>2]](b,t[A+8>>2],e),s=1346455635,d=t[(t[a>>2]+i|0)-8>>2],k=t[t[e>>2]+20>>2],yf[k](0|l,0|u,0|c,0|s,0|d)),A=t[a>>2]+i|0,t[r+-72>>2]=t[A+-72>>2],t[r+-68>>2]=t[A+-68>>2],t[r+-64>>2]=t[A+-64>>2],t[r+-60>>2]=t[A+-60>>2],t[r+-56>>2]=t[A+-56>>2],t[r+-52>>2]=t[A+-52>>2],t[r+-48>>2]=t[A+-48>>2],t[r+-44>>2]=t[A+-44>>2],t[r+-40>>2]=t[A+-40>>2],t[r+-36>>2]=t[A+-36>>2],t[r+-32>>2]=t[A+-32>>2],t[r+-28>>2]=t[A+-28>>2],t[r+-24>>2]=t[A+-24>>2],t[r+-20>>2]=t[A+-20>>2],t[r+-16>>2]=t[A+-16>>2],t[r+-4>>2]=t[A+-4>>2],t[r+-12>>2]=t[A+-12>>2],i=i+80|0,r=r+76|0,o=o+1|0,(0|o)<t[n>>2];){}yf[t[t[e>>2]+20>>2]](e,f,14352,1497453121,t[f+8>>2]);}return 14377;},function(A,r){A|=0,r|=0;var e=0,i=0,a=0;t[A+72>>2]=t[A+72>>2]+1,e=t[A+20>>2];A:if(!((0|e)<1))for(i=_(e,80)+-16|0,a=A+28|0;;){if(e=e+-1|0,(0|r)!=t[t[a>>2]+i>>2]){if(i=i+-80|0,(0|e)>0)continue;break A;}if(me(A,e),i=i+-80|0,!((0|e)>0))break;}yf[t[t[A>>2]+68>>2]](A);},function(A){A|=0;var r,e,i,a,f=B(0),n=0,b=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0;if(r=E-32|0,E=r,t[A+52>>2]=-581039253,t[A+56>>2]=-581039253,t[A+36>>2]=1566444395,t[A+40>>2]=1566444395,e=A+60|0,n=e,t[n>>2]=-581039253,t[n+4>>2]=0,i=A+44|0,n=i,t[n>>2]=1566444395,t[n+4>>2]=0,a=A+20|0,t[a>>2]>=1)for(n=64,s=A+28|0,b=A+36|0,o=A+52|0,k=A+40|0,A=A+56|0,d=r+24|0;c=t[s>>2]+n|0,u=t[c>>2],yf[t[t[u>>2]+8>>2]](u,c+-64|0,r+16|0,r),f=C[r+16>>2],C[b>>2]>f&&(C[b>>2]=f),f=C[r>>2],C[o>>2]<f&&(C[o>>2]=f),f=C[r+20>>2],C[k>>2]>f&&(C[k>>2]=f),f=C[r+4>>2],C[A>>2]<f&&(C[A>>2]=f),f=C[d>>2],C[i>>2]>f&&(C[i>>2]=f),f=C[r+8>>2],C[e>>2]<f&&(C[e>>2]=f),n=n+80|0,l=l+1|0,(0|l)<t[a>>2];){}E=r+32|0;},Re,function(A){A|=0;var r,e=0;t[A>>2]=14628,e=A+32|0,r=t[e>>2],r&&(b[A+36|0]&&gA(r),t[A+32>>2]=0),t[e>>2]=0,a[A+36|0]=1,e=A+24|0,t[e>>2]=0,t[e+4>>2]=0,gA(A);},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f=0,n=0,o=0,k=0,c=B(0),u=B(0),l=B(0),s=B(0),v=B(0),m=B(0),R=0,G=0,h=0,y=0,Q=0,p=0,D=0,w=0,W=0,F=0,Z=0,Y=0;if(e=E-80|0,E=e,a=0|yf[t[t[A>>2]+28>>2]](A),(0|a)>=1)for(c=C[A+12>>2],u=C[A+8>>2],l=C[A+4>>2],G=e+28|0,h=e+24|0,y=e+20|0,Q=e+16|0,p=e+44|0,D=e+40|0,w=e+36|0,W=e+32|0;;){yf[t[t[A>>2]+16>>2]](A,e+76|0,e+52|0,e- -64|0,e+56|0,e+72|0,e+68|0,e+48|0,e+60|0,R);A:{r:{e:{i:{a:{if(i=t[e+64>>2],1!=(0|i)){if(i)break A;if(i=t[e+60>>2],2==(0|i))break a;if(3==(0|i))break i;if(5!=(0|i)|t[e+48>>2]<1)break A;for(i=0;k=t[e+76>>2],o=t[e+56>>2],n=t[e+72>>2]+_(t[e+68>>2],i)|0,f=k+_(o,b[0|n])|0,s=C[f>>2],v=C[f+4>>2],m=C[f+8>>2],t[e+12>>2]=0,C[e+8>>2]=c*m,C[e+4>>2]=u*v,C[e>>2]=l*s,f=k+_(o,b[n+1|0])|0,s=C[f>>2],v=C[f+4>>2],m=C[f+8>>2],t[G>>2]=0,C[h>>2]=c*m,C[y>>2]=u*v,C[Q>>2]=l*s,n=k+_(o,b[n+2|0])|0,s=C[n>>2],v=C[n+4>>2],m=C[n+8>>2],t[p>>2]=0,C[D>>2]=c*m,C[w>>2]=u*v,C[W>>2]=l*s,yf[t[t[r>>2]+8>>2]](r,e,R,i),i=i+1|0,(0|i)<t[e+48>>2];){}break A;}if(i=t[e+60>>2],2==(0|i))break e;if(3==(0|i))break r;if(5!=(0|i)|t[e+48>>2]<1)break A;for(i=0;n=t[e+72>>2]+_(t[e+68>>2],i)|0,o=b[0|n],t[e+12>>2]=0,k=t[e+76>>2],f=o,o=t[e+56>>2],f=k+_(f,o)|0,C[e+8>>2]=c*B(g[f+16>>3]),C[e+4>>2]=u*B(g[f+8>>3]),C[e>>2]=l*B(g[f>>3]),f=b[n+1|0],t[G>>2]=0,f=k+_(f,o)|0,C[h>>2]=c*B(g[f+16>>3]),C[y>>2]=u*B(g[f+8>>3]),C[Q>>2]=l*B(g[f>>3]),n=k+_(o,b[n+2|0])|0,F=g[n>>3],Z=g[n+8>>3],Y=g[n+16>>3],t[p>>2]=0,C[D>>2]=c*B(Y),C[w>>2]=u*B(Z),C[W>>2]=l*B(F),yf[t[t[r>>2]+8>>2]](r,e,R,i),i=i+1|0,(0|i)<t[e+48>>2];){}break A;}if(t[e+48>>2]<1)break A;for(i=0;k=t[e+76>>2],o=t[e+56>>2],n=t[e+72>>2]+_(t[e+68>>2],i)|0,f=k+_(o,t[n>>2])|0,s=C[f>>2],v=C[f+4>>2],m=C[f+8>>2],t[e+12>>2]=0,C[e+8>>2]=c*m,C[e+4>>2]=u*v,C[e>>2]=l*s,f=k+_(o,t[n+4>>2])|0,s=C[f>>2],v=C[f+4>>2],m=C[f+8>>2],t[G>>2]=0,C[h>>2]=c*m,C[y>>2]=u*v,C[Q>>2]=l*s,n=k+_(o,t[n+8>>2])|0,s=C[n>>2],v=C[n+4>>2],m=C[n+8>>2],t[p>>2]=0,C[D>>2]=c*m,C[w>>2]=u*v,C[W>>2]=l*s,yf[t[t[r>>2]+8>>2]](r,e,R,i),i=i+1|0,(0|i)<t[e+48>>2];){}break A;}if(t[e+48>>2]<1)break A;for(i=0;k=t[e+76>>2],o=t[e+56>>2],n=t[e+72>>2]+_(t[e+68>>2],i)|0,f=k+_(o,d[n>>1])|0,s=C[f>>2],v=C[f+4>>2],m=C[f+8>>2],t[e+12>>2]=0,C[e+8>>2]=c*m,C[e+4>>2]=u*v,C[e>>2]=l*s,f=k+_(o,d[n+2>>1])|0,s=C[f>>2],v=C[f+4>>2],m=C[f+8>>2],t[G>>2]=0,C[h>>2]=c*m,C[y>>2]=u*v,C[Q>>2]=l*s,n=k+_(o,d[n+4>>1])|0,s=C[n>>2],v=C[n+4>>2],m=C[n+8>>2],t[p>>2]=0,C[D>>2]=c*m,C[w>>2]=u*v,C[W>>2]=l*s,yf[t[t[r>>2]+8>>2]](r,e,R,i),i=i+1|0,(0|i)<t[e+48>>2];){}break A;}if(t[e+48>>2]<1)break A;for(i=0;t[G>>2]=0,k=t[e+76>>2],o=t[e+56>>2],n=t[e+72>>2]+_(t[e+68>>2],i)|0,f=k+_(o,t[n+4>>2])|0,C[h>>2]=c*B(g[f+16>>3]),C[y>>2]=u*B(g[f+8>>3]),C[Q>>2]=l*B(g[f>>3]),t[e+12>>2]=0,f=k+_(o,t[n>>2])|0,C[e+8>>2]=c*B(g[f+16>>3]),C[e+4>>2]=u*B(g[f+8>>3]),C[e>>2]=l*B(g[f>>3]),t[p>>2]=0,n=k+_(o,t[n+8>>2])|0,C[D>>2]=c*B(g[n+16>>3]),C[w>>2]=u*B(g[n+8>>3]),C[W>>2]=l*B(g[n>>3]),yf[t[t[r>>2]+8>>2]](r,e,R,i),i=i+1|0,(0|i)<t[e+48>>2];){}break A;}if(!(t[e+48>>2]<1))for(i=0;t[G>>2]=0,k=t[e+76>>2],o=t[e+56>>2],n=t[e+72>>2]+_(t[e+68>>2],i)|0,f=k+_(o,d[n+2>>1])|0,C[h>>2]=c*B(g[f+16>>3]),C[y>>2]=u*B(g[f+8>>3]),C[Q>>2]=l*B(g[f>>3]),t[e+12>>2]=0,f=k+_(o,d[n>>1])|0,C[e+8>>2]=c*B(g[f+16>>3]),C[e+4>>2]=u*B(g[f+8>>3]),C[e>>2]=l*B(g[f>>3]),t[p>>2]=0,n=k+_(o,d[n+4>>1])|0,C[D>>2]=c*B(g[n+16>>3]),C[w>>2]=u*B(g[n+8>>3]),C[W>>2]=l*B(g[n>>3]),yf[t[t[r>>2]+8>>2]](r,e,R,i),i=i+1|0,(0|i)<t[e+48>>2];){}}if(yf[t[t[A>>2]+24>>2]](A,R),R=R+1|0,(0|R)==(0|a))break;}E=e+80|0;},Ge,Ge,he,he,function(A){return A|=0,t[A+24>>2];},he,he,function(A){return A|=0,1==t[A+48>>2]|0;},function(A,r,e){A|=0,r|=0,e|=0;var i=0,a=0;i=t[r+4>>2],t[A+52>>2]=t[r>>2],t[A+56>>2]=i,r=r+8|0,a=t[r+4>>2],i=A+60|0,t[i>>2]=t[r>>2],t[i+4>>2]=a,i=e+8|0,a=t[i+4>>2],r=A+76|0,t[r>>2]=t[i>>2],t[r+4>>2]=a,r=t[e+4>>2],t[A+68>>2]=t[e>>2],t[A+72>>2]=r,t[A+48>>2]=1;},function(A,r,e){A|=0,r|=0,e|=0;var i=0,a=0;i=t[A+56>>2],t[r>>2]=t[A+52>>2],t[r+4>>2]=i,i=A+60|0,a=t[i+4>>2],r=r+8|0,t[r>>2]=t[i>>2],t[r+4>>2]=a,i=A+76|0,a=t[i+4>>2],r=e+8|0,t[r>>2]=t[i>>2],t[r+4>>2]=a,r=t[A+72>>2],t[e>>2]=t[A+68>>2],t[e+4>>2]=r;},function(A){return 28;},function(A,r,e){A|=0,r|=0,e|=0;var i,n=0,o=0,k=0,c=0,u=0,l=0,s=0,v=0,C=0,g=0,B=0,m=0,R=0,G=0,h=0;if(i=E-32|0,E=i,n=0|yf[t[t[A>>2]+28>>2]](A),t[r>>2]=0,t[r+20>>2]=n,n){if(g=0|yf[t[t[e>>2]+16>>2]](e,32,n),u=t[g+8>>2],G=r,h=0|yf[t[t[e>>2]+28>>2]](e,u),t[G>>2]=h,R=0|yf[t[t[A>>2]+28>>2]](A),(0|R)>0)for(;;){yf[t[t[A>>2]+16>>2]](A,i+28|0,i+4|0,i+16|0,i+8|0,i+24|0,i+20|0,i,i+12|0,C),o=u+16|0,t[o>>2]=0,t[o+4>>2]=0,c=u+8|0,t[c>>2]=0,t[c+4>>2]=0,t[u>>2]=0,t[u+4>>2]=0,n=t[i>>2],t[u+24>>2]=n,t[u+28>>2]=t[i+4>>2];A:{r:{k=t[i+12>>2];e:{i:{if(5!=(0|k)){if(3!=(0|k)){if(!n|2!=(0|k))break i;if(o=c,c=0|yf[t[t[e>>2]+16>>2]](e,4,_(n,3)),n=t[c+8>>2],G=o,h=0|yf[t[t[e>>2]+28>>2]](e,n),t[G>>2]=h,t[i>>2]>=1)for(o=0,l=t[i+24>>2];k=l+_(t[i+20>>2],o)|0,t[n>>2]=t[k>>2],t[n+4>>2]=t[k+4>>2],t[n+8>>2]=t[k+8>>2],n=n+12|0,o=o+1|0,(0|o)<t[i>>2];){}if(yf[t[t[e>>2]+20>>2]](e,c,14437,1497453121,t[c+8>>2]),n=t[i+16>>2],1!=(0|n))break e;break r;}if(!n)break i;if(c=0|yf[t[t[e>>2]+16>>2]](e,8,n),n=t[c+8>>2],G=u+12|0,h=0|yf[t[t[e>>2]+28>>2]](e,n),t[G>>2]=h,t[i>>2]>=1)for(o=0;k=t[i+24>>2]+_(t[i+20>>2],o)|0,f[n>>1]=d[k>>1],f[n+2>>1]=d[k+2>>1],k=d[k+4>>1],f[n+6>>1]=0,f[n+4>>1]=k,n=n+8|0,o=o+1|0,(0|o)<t[i>>2];){}if(yf[t[t[e>>2]+20>>2]](e,c,14452,1497453121,t[c+8>>2]),n=t[i+16>>2],1!=(0|n))break e;break r;}if(n){if(c=0|yf[t[t[e>>2]+16>>2]](e,4,n),n=t[c+8>>2],G=o,h=0|yf[t[t[e>>2]+28>>2]](e,n),t[G>>2]=h,t[i>>2]>=1)for(o=0;k=t[i+24>>2]+_(t[i+20>>2],o)|0,a[0|n]=b[0|k],a[n+1|0]=b[k+1|0],a[n+2|0]=b[k+2|0],a[n+3|0]=0,n=n+4|0,o=o+1|0,(0|o)<t[i>>2];){}yf[t[t[e>>2]+20>>2]](e,c,14479,1497453121,t[c+8>>2]);}}if(n=t[i+16>>2],1==(0|n))break r;}if(n)break A;if(n=t[i+4>>2],!n)break A;if(k=0|yf[t[t[e>>2]+16>>2]](e,16,n),n=t[k+8>>2],G=u,h=0|yf[t[t[e>>2]+28>>2]](e,n),t[G>>2]=h,l=t[i+4>>2],(0|l)>=1)for(c=0,B=t[i+8>>2],o=t[i+28>>2];t[n>>2]=t[o>>2],t[n+4>>2]=t[o+4>>2],t[n+8>>2]=t[o+8>>2],o=o+B|0,n=n+16|0,c=c+1|0,(0|c)<(0|l);){}yf[t[t[e>>2]+20>>2]](e,k,14502,1497453121,t[k+8>>2]);break A;}if(n=t[i+4>>2],n){if(k=0|yf[t[t[e>>2]+16>>2]](e,32,n),n=t[k+8>>2],G=u+4|0,h=0|yf[t[t[e>>2]+28>>2]](e,n),t[G>>2]=h,l=t[i+4>>2],(0|l)>=1)for(c=0,B=t[i+8>>2],o=t[i+28>>2];s=t[o+4>>2],t[n>>2]=t[o>>2],t[n+4>>2]=s,v=o+8|0,m=t[v+4>>2],s=n+8|0,t[s>>2]=t[v>>2],t[s+4>>2]=m,v=o+16|0,m=t[v+4>>2],s=n+16|0,t[s>>2]=t[v>>2],t[s+4>>2]=m,o=o+B|0,n=n+32|0,c=c+1|0,(0|c)<(0|l);){}yf[t[t[e>>2]+20>>2]](e,k,14521,1497453121,t[k+8>>2]);}}if(yf[t[t[A>>2]+24>>2]](A,C),u=u+32|0,C=C+1|0,(0|C)==(0|R))break;}yf[t[t[e>>2]+20>>2]](e,g,14541,1497453121,t[g+8>>2]);}return t[r+24>>2]=0,t[r+4>>2]=t[A+4>>2],t[r+8>>2]=t[A+8>>2],t[r+12>>2]=t[A+12>>2],t[r+16>>2]=t[A+16>>2],E=i+32|0,14556;},pe,function(A){A|=0,gA(pe(A));},function(A,r){A|=0,r|=0;var e=0,i=0,f=0,n=0,o=0,k=0,c=0;A:{r:{e:{i:{a:{if(b[A+165|0]){if(t[A+92>>2]>=(0|r))break A;if(!r)break a;k=CA(r<<4,16);break i;}if(t[A+112>>2]>=(0|r))break A;if(!r)break e;e=CA(r<<2,16);break r;}k=0;}if(n=t[A+88>>2],(0|n)>=1)for(c=A+96|0;e=t[c>>2]+o|0,f=t[e+4>>2],i=o+k|0,t[i>>2]=t[e>>2],t[i+4>>2]=f,e=e+8|0,f=t[e+4>>2],i=i+8|0,t[i>>2]=t[e>>2],t[i+4>>2]=f,o=o+16|0,n=n+-1|0,n;){}return e=A+96|0,f=t[e>>2],f&&(b[A+100|0]&&gA(f),t[A+96>>2]=0),t[e>>2]=k,a[A+100|0]=1,void(t[A+92>>2]=r);}e=0;}f=t[A+116>>2],i=t[A+108>>2];r:{if((0|i)>=1)for(o=e,n=f;t[o>>2]=t[n>>2],o=o+4|0,n=n+4|0,i=i+-1|0,i;){}else if(!f)break r;b[A+120|0]&&gA(f),t[A+116>>2]=0;}t[A+116>>2]=e,a[A+120|0]=1,t[A+112>>2]=r;}},function(A,r){A|=0,r|=0;var e=0,i=0,n=0,o=0,k=0;A:{r:{e:{i:{a:{if(b[A+164|0]){if(t[A+132>>2]>=(0|r))break A;if(!r)break a;i=CA(r<<2,16);break i;}if(t[A+152>>2]>=(0|r))break A;if(!r)break e;i=CA(r<<1,16);break r;}i=0;}n=t[A+136>>2],e=t[A+128>>2];i:{if((0|e)>=1)for(o=i,k=n;t[o>>2]=t[k>>2],o=o+4|0,k=k+4|0,e=e+-1|0,e;){}else if(!n)break i;b[A+140|0]&&gA(n),t[A+136>>2]=0;}return t[A+136>>2]=i,a[A+140|0]=1,void(t[A+132>>2]=r);}i=0;}n=t[A+156>>2],e=t[A+148>>2];r:{if((0|e)>=1)for(o=i,k=n;f[o>>1]=d[k>>1],o=o+2|0,k=k+2|0,e=e+-1|0,e;){}else if(!n)break r;b[A+160|0]&&gA(n),t[A+156>>2]=0;}t[A+156>>2]=i,a[A+160|0]=1,t[A+152>>2]=r;}},yA,function(A,r,e){A|=0,r|=0,e|=0;var i,a,f,n=B(0),b=B(0),o=B(0),k=0,c=B(0);i=E-32|0,E=i,k=e+8|0,f=t[k+4>>2],a=i+24|0,t[a>>2]=t[k>>2],t[a+4>>2]=f,k=t[e+4>>2],t[i+16>>2]=t[e>>2],t[i+20>>2]=k,n=C[i+16>>2],o=C[i+20>>2],b=C[a>>2],B(B(B(n*n)+B(o*o))+B(b*b))<B(1.4210854715202004e-14)&&(t[a>>2]=-1082130432,t[a+4>>2]=0,t[i+16>>2]=-1082130432,t[i+20>>2]=-1082130432,b=B(-1),o=B(-1),n=B(-1)),c=b,b=B(B(1)/B(Q(B(B(B(n*n)+B(o*o))+B(b*b))))),C[a>>2]=c*b,C[i+20>>2]=o*b,C[i+16>>2]=n*b,yA(i,r,i+16|0);A:{r:{e:if(e=t[r+4>>2],!(e>>>0>13)){switch(e-2|0){case 6:break r;case 0:case 1:case 4:case 5:case 7:case 10:break e;}n=C[r+48>>2];break A;}n=B(yf[t[t[r>>2]+48>>2]](r));break A;}n=B(C[r+32>>2]*C[r+16>>2]);}t[A+12>>2]=0,C[A+4>>2]=B(n*C[i+20>>2])+C[i+4>>2],C[A>>2]=B(n*C[i+16>>2])+C[i>>2],C[A+8>>2]=B(n*C[i+24>>2])+C[i+8>>2],E=i+32|0;},sA,Cr,function(A,r,e,i,a,f,n,b,o,k){return A|=0,r|=0,e|=0,i|=0,a|=0,f|=0,n|=0,b|=0,o|=0,A=E-80|0,E=A,t[A+76>>2]=0,C[A+64>>2]=C[f+48>>2]-C[a+48>>2],C[A+72>>2]=C[f+56>>2]-C[a+56>>2],C[A+68>>2]=C[f+52>>2]-C[a+52>>2],Ze(e,a,i,f,A- -64|0,A+8|0)?(r=t[A+16>>2],t[b>>2]=t[A+12>>2],t[b+4>>2]=r,e=A+20|0,i=t[e+4>>2],r=b+8|0,t[r>>2]=t[e>>2],t[r+4>>2]=i,e=A+36|0,i=t[e+4>>2],r=o+8|0,t[r>>2]=t[e>>2],t[r+4>>2]=i,r=A+28|0,e=t[r+4>>2],t[o>>2]=t[r>>2],t[o+4>>2]=e,r=t[A+48>>2],t[n>>2]=t[A+44>>2],t[n+4>>2]=r,e=A+52|0,i=t[e+4>>2],r=n+8|0,t[r>>2]=t[e>>2],t[r+4>>2]=i,E=A+80|0,1):(function(A,r,e,i,a,f){var n,b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=0,s=B(0),d=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=0,Z=0,Y=0,N=0,V=B(0),I=B(0),J=0,X=0,M=0,x=B(0),S=B(0),T=B(0),U=B(0),j=0,O=0,H=0,z=0,P=0,L=0,K=0,q=0,$=0,AA=0,rA=0,eA=0,iA=0,aA=0,fA=0,nA=0;if(n=E-544|0,E=n,t[f>>2]=0,t[f+4>>2]=0,t[f+32>>2]=0,l=f+24|0,t[l>>2]=0,t[l+4>>2]=0,l=f+16|0,t[l>>2]=0,t[l+4>>2]=0,l=f+8|0,t[l>>2]=0,t[l+4>>2]=0,t[n+388>>2]=e,t[n+384>>2]=A,b=C[i+20>>2],o=C[i+36>>2],A=r+20|0,k=C[A>>2],e=r+36|0,g=C[e>>2],l=r+24|0,m=C[l>>2],_=C[i+24>>2],F=r+40|0,c=C[F>>2],u=C[i+40>>2],s=C[i+32>>2],d=C[i>>2],R=C[i+16>>2],G=C[i+4>>2],h=C[r+32>>2],p=C[r>>2],D=C[r+16>>2],w=C[r+4>>2],W=C[r+8>>2],y=C[i+8>>2],t[n+436>>2]=0,t[n+420>>2]=0,t[n+404>>2]=0,V=B(B(B(W*y)+B(m*_))+B(c*u)),C[n+432>>2]=V,I=B(B(B(w*y)+B(k*_))+B(g*u)),C[n+428>>2]=I,_=B(B(B(p*y)+B(D*_))+B(h*u)),C[n+424>>2]=_,u=B(B(B(W*G)+B(m*b))+B(c*o)),C[n+416>>2]=u,y=B(B(B(w*G)+B(k*b))+B(g*o)),C[n+412>>2]=y,b=B(B(B(p*G)+B(D*b))+B(h*o)),C[n+408>>2]=b,o=B(B(B(d*W)+B(R*m))+B(s*c)),C[n+400>>2]=o,k=B(B(B(d*w)+B(R*k))+B(s*g)),C[n+396>>2]=k,g=B(B(B(d*p)+B(R*D))+B(s*h)),C[n+392>>2]=g,m=C[A>>2],c=C[e>>2],s=C[l>>2],d=C[i+52>>2],R=C[r+52>>2],G=C[F>>2],h=C[i+56>>2],p=C[r+56>>2],D=C[r>>2],w=C[r+16>>2],W=C[r+32>>2],x=C[r+4>>2],S=C[r+8>>2],T=C[i+48>>2],U=C[r+48>>2],t[n+508>>2]=0,t[n+500>>2]=0,t[n+484>>2]=0,C[n+480>>2]=V,C[n+476>>2]=u,C[n+472>>2]=o,t[n+468>>2]=0,C[n+464>>2]=I,C[n+460>>2]=y,C[n+456>>2]=k,t[n+452>>2]=0,C[n+448>>2]=_,C[n+444>>2]=b,b=B(T-U),o=B(d-R),k=B(h-p),C[n+496>>2]=B(B(S*b)+B(s*o))+B(G*k),C[n+492>>2]=B(B(b*x)+B(o*m))+B(k*c),C[n+488>>2]=B(B(b*D)+B(o*w))+B(k*W),t[n+504>>2]=350,C[n+440>>2]=g,A=n+136|0,t[A>>2]=0,t[A+4>>2]=0,t[n+128>>2]=0,t[n+132>>2]=0,t[n+364>>2]=0,t[n+368>>2]=0,t[n+376>>2]=2,t[n+144>>2]=0,A=De(n,n+384|0,a),A)return t[f>>2]=1==(0|A)?1:2,E=n+544|0,0;if(a=t[n+372>>2],t[a+32>>2])for(b=B(0),A=n+508|0,e=n+504|0,l=n+536|0,F=n+372|0,J=n+428|0,X=n+424|0,M=n+432|0,j=n+412|0,O=n+408|0,H=n+416|0,z=n+476|0,P=n+472|0,L=n+480|0,K=n+496|0,q=n+460|0,$=n+456|0,AA=n+464|0,rA=n+492|0,eA=n+444|0,iA=n+440|0,aA=n+448|0,fA=n+488|0,i=0,o=B(0),k=B(0),g=B(0),m=B(0),_=B(0);a=i+a|0,c=C[a+16>>2],nA=t[a>>2],a=t[e>>2],Y=t[A>>2],Z=t[n+384>>2]+(Y>>1)|0,yf[1&Y?t[t[Z>>2]+a>>2]:a](n+528|0,Z,nA),R=B(c*C[l>>2]),G=B(c*C[n+532>>2]),h=B(c*C[n+528>>2]),Y=t[A>>2],Z=t[n+388>>2]+(Y>>1)|0,a=t[t[F>>2]+i>>2],u=B(-C[a+8>>2]),s=B(-C[a+4>>2]),d=B(-C[a>>2]),a=t[e>>2],a=1&Y?t[t[Z>>2]+a>>2]:a,b=B(b+R),o=B(o+G),k=B(k+h),t[n+524>>2]=0,C[n+520>>2]=B(B(C[X>>2]*d)+B(C[J>>2]*s))+B(C[M>>2]*u),C[n+516>>2]=B(B(C[O>>2]*d)+B(C[j>>2]*s))+B(C[H>>2]*u),C[n+512>>2]=B(B(C[n+392>>2]*d)+B(C[n+396>>2]*s))+B(C[n+400>>2]*u),yf[a](n+528|0,Z,n+512|0),u=C[n+528>>2],s=C[n+532>>2],d=C[l>>2],g=B(g+B(c*B(B(B(B(u*C[P>>2])+B(s*C[z>>2]))+B(d*C[L>>2]))+C[K>>2]))),m=B(m+B(c*B(B(B(B(u*C[$>>2])+B(s*C[q>>2]))+B(d*C[AA>>2]))+C[rA>>2]))),_=B(_+B(c*B(B(B(B(u*C[iA>>2])+B(s*C[eA>>2]))+B(d*C[aA>>2]))+C[fA>>2]))),i=i+4|0,N=N+1|0,a=t[F>>2],N>>>0<v[a+32>>2];){}else _=B(0),m=B(0),g=B(0),k=B(0),o=B(0),b=B(0);return A=r+48|0,c=C[A>>2],e=r+8|0,u=C[e>>2],i=r+4|0,s=C[i>>2],a=r+52|0,d=C[a>>2],l=r+24|0,R=C[l>>2],F=r+16|0,G=C[F>>2],N=r+20|0,h=C[N>>2],Z=r+56|0,p=C[Z>>2],J=r+40|0,D=C[J>>2],X=r+32|0,w=C[X>>2],M=r+36|0,W=C[M>>2],y=C[r>>2],t[f+16>>2]=0,C[f+12>>2]=p+B(B(B(k*w)+B(o*W))+B(b*D)),C[f+8>>2]=d+B(B(B(k*G)+B(o*h))+B(b*R)),C[f+4>>2]=c+B(B(B(k*y)+B(o*s))+B(b*u)),u=C[A>>2],s=C[e>>2],d=C[i>>2],R=C[a>>2],G=C[l>>2],h=C[F>>2],p=C[N>>2],D=C[Z>>2],w=C[J>>2],W=C[X>>2],y=C[M>>2],V=C[r>>2],k=B(k-_),o=B(o-m),b=B(b-g),c=B(Q(B(B(B(k*k)+B(o*o))+B(b*b)))),C[f+52>>2]=c,t[f+48>>2]=0,t[f+32>>2]=0,I=b,b=c>B(9999999747378752e-20)?B(B(1)/c):B(1),C[f+44>>2]=I*b,C[f+40>>2]=o*b,C[f+36>>2]=k*b,C[f+28>>2]=D+B(B(B(_*W)+B(m*y))+B(g*w)),C[f+24>>2]=R+B(B(B(_*h)+B(m*p))+B(g*G)),C[f+20>>2]=u+B(B(B(_*V)+B(m*d))+B(g*s)),E=n+544|0,1;}(e,a,i,f,A- -64|0,A+8|0)&&(r=t[A+16>>2],t[b>>2]=t[A+12>>2],t[b+4>>2]=r,e=A+20|0,i=t[e+4>>2],r=b+8|0,t[r>>2]=t[e>>2],t[r+4>>2]=i,e=A+36|0,i=t[e+4>>2],r=o+8|0,t[r>>2]=t[e>>2],t[r+4>>2]=i,r=A+28|0,e=t[r+4>>2],t[o>>2]=t[r>>2],t[o+4>>2]=e,r=t[A+48>>2],t[n>>2]=t[A+44>>2],t[n+4>>2]=r,e=A+52|0,i=t[e+4>>2],r=n+8|0,t[r>>2]=t[e>>2],t[r+4>>2]=i),E=A+80|0,0);},sA,Cr,Ue,Cr,function(A,r,e,i,f,n,o,k,c,u){A|=0,r|=0,e|=0,i|=0,f|=0,n|=0,o|=0,k|=0,c|=0,u|=0;var l,s,d,v=0,g=B(0),_=B(0),m=B(0),R=0,G=B(0),h=0,y=0,Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),N=0,V=0,I=0,J=0,X=0,M=0,x=0,S=0,T=0,U=0,j=0,O=B(0),H=0,z=0,P=B(0),L=0,K=0,q=0;for(A=E-4240|0,E=A,z=t[e+4>>2]+-17>>>0<=1?t[i+4>>2]+-17>>>0<2:z;je(),R=(A+1264|0)+v|0,t[R+12>>2]=0,G=C[v+1760>>2],m=B(-G),g=C[v+1764>>2],_=C[v+1768>>2],C[R+8>>2]=B(B(C[f+8>>2]*m)-B(C[f+24>>2]*g))-B(C[f+40>>2]*_),C[R+4>>2]=B(B(C[f+4>>2]*m)-B(g*C[f+20>>2]))-B(_*C[f+36>>2]),C[R>>2]=B(B(C[f>>2]*m)-B(g*C[f+16>>2]))-B(_*C[f+32>>2]),m=C[n+16>>2],Q=C[n+32>>2],p=C[n+36>>2],w=C[n+4>>2],D=C[n+20>>2],W=C[n+40>>2],F=C[n+8>>2],Z=C[n+24>>2],Y=C[n>>2],R=(A+272|0)+v|0,t[R+12>>2]=0,C[R+8>>2]=B(B(G*F)+B(g*Z))+B(_*W),C[R+4>>2]=B(B(G*w)+B(g*D))+B(_*p),C[R>>2]=B(B(G*Y)+B(g*m))+B(_*Q),v=v+16|0,672!=(0|v);){}if(N=0|yf[t[t[e>>2]+84>>2]](e),(0|N)>=1){for(X=A+3260|0,v=0;yf[t[t[e>>2]+88>>2]](e,y,A+3248|0),t[X>>2]=0,R=A+3256|0,g=C[R>>2],_=C[A+3248>>2],V=f+32|0,G=C[A+3252>>2],I=f+36|0,M=f+40|0,C[R>>2]=B(B(_*C[V>>2])+B(G*C[I>>2]))+B(g*C[M>>2]),x=f+16|0,S=f+20|0,T=f+24|0,C[A+3252>>2]=B(B(_*C[x>>2])+B(G*C[S>>2]))+B(g*C[T>>2]),U=f+4|0,j=f+8|0,C[A+3248>>2]=B(B(_*C[f>>2])+B(G*C[U>>2]))+B(g*C[j>>2]),je(),J=t[R+4>>2],h=v+2440|0,t[h>>2]=t[R>>2],t[h+4>>2]=J,J=t[A+3252>>2],h=v+2432|0,t[h>>2]=t[A+3248>>2],t[h+4>>2]=J,h=(A+1264|0)+v|0,t[h+684>>2]=0,G=C[A+3248>>2],m=B(-G),g=C[A+3252>>2],_=C[R>>2],C[h+680>>2]=B(B(C[j>>2]*m)-B(C[T>>2]*g))-B(C[M>>2]*_),C[h+676>>2]=B(B(C[U>>2]*m)-B(g*C[S>>2]))-B(_*C[I>>2]),C[h+672>>2]=B(B(C[f>>2]*m)-B(g*C[x>>2]))-B(_*C[V>>2]),R=(A+272|0)+v|0,t[R+684>>2]=0,C[R+680>>2]=B(B(G*C[n+8>>2])+B(g*C[n+24>>2]))+B(_*C[n+40>>2]),C[R+676>>2]=B(B(G*C[n+4>>2])+B(g*C[n+20>>2]))+B(_*C[n+36>>2]),C[R+672>>2]=B(B(G*C[n>>2])+B(g*C[n+16>>2]))+B(_*C[n+32>>2]),v=v+16|0,y=y+1|0,(0|N)!=(0|y);){}R=y+42|0;}else R=42;if(l=e,s=A+1264|0,d=A+3248|0,M=0|yf[t[t[i>>2]+84>>2]](i),(0|M)>=1){for(N=R<<4,y=1760,X=A+1264|0,V=A+272|0,v=0;yf[t[t[i>>2]+88>>2]](i,v,A+3248|0),t[A+3260>>2]=0,h=A+3256|0,g=C[h>>2],_=C[A+3248>>2],x=n+32|0,G=C[A+3252>>2],S=n+36|0,T=n+40|0,C[h>>2]=B(B(_*C[x>>2])+B(G*C[S>>2]))+B(g*C[T>>2]),U=n+16|0,j=n+20|0,J=n+24|0,C[A+3252>>2]=B(B(_*C[U>>2])+B(G*C[j>>2]))+B(g*C[J>>2]),L=n+4|0,K=n+8|0,C[A+3248>>2]=B(B(_*C[n>>2])+B(G*C[L>>2]))+B(g*C[K>>2]),je(),q=t[h+4>>2],I=y+N|0,H=I+8|0,t[H>>2]=t[h>>2],t[H+4>>2]=q,H=t[A+3252>>2],t[I>>2]=t[A+3248>>2],t[I+4>>2]=H,Q=C[f+32>>2],p=C[f+16>>2],w=C[f+36>>2],D=C[f+4>>2],W=C[f+20>>2],F=C[f+40>>2],m=C[f+8>>2],Z=C[f+24>>2],Y=C[f>>2],g=C[h>>2],G=C[A+3248>>2],_=C[A+3252>>2],h=N+X|0,t[h+12>>2]=0,O=m,m=B(-G),C[h+8>>2]=B(B(O*m)-B(Z*_))-B(F*g),C[h+4>>2]=B(B(D*m)-B(W*_))-B(w*g),C[h>>2]=B(B(Y*m)-B(p*_))-B(Q*g),m=C[x>>2],Q=C[U>>2],p=C[S>>2],w=C[L>>2],D=C[j>>2],W=C[T>>2],F=C[K>>2],Z=C[J>>2],Y=C[n>>2],h=N+V|0,t[h+12>>2]=0,C[h+8>>2]=B(B(G*F)+B(_*Z))+B(g*W),C[h+4>>2]=B(B(G*w)+B(_*D))+B(g*p),C[h>>2]=B(B(G*Y)+B(_*Q))+B(g*m),V=V+16|0,X=X+16|0,y=y+16|0,v=v+1|0,(0|M)!=(0|v);){}R=v+R|0;}if(yf[t[t[e>>2]+76>>2]](l,s,d,R),yf[t[t[i>>2]+76>>2]](i,A+272|0,A+2256|0,R),(0|R)>=1)for(m=B(0xde0b6b000000000),v=0,W=B(0),g=B(0),_=B(0),G=B(0);je(),Q=C[v+1760>>2],p=C[v+1764>>2],w=z?B(0):C[v+1768>>2],+B(B(B(Q*Q)+B(p*p))+B(w*w))>.01&&(y=(A+2256|0)+v|0,D=C[y>>2],F=C[y+4>>2],Z=C[y+8>>2],y=(A+3248|0)+v|0,Y=C[y>>2],O=C[y+4>>2],P=C[y+8>>2],D=B(B(B(Q*B(B(B(B(B(D*C[n>>2])+B(F*C[n+4>>2]))+B(Z*C[n+8>>2]))+C[n+48>>2])-B(B(B(B(Y*C[f>>2])+B(O*C[f+4>>2]))+B(P*C[f+8>>2]))+C[f+48>>2])))+B(p*B(B(B(B(B(D*C[n+16>>2])+B(F*C[n+20>>2]))+B(Z*C[n+24>>2]))+C[n+52>>2])-B(B(B(B(Y*C[f+16>>2])+B(O*C[f+20>>2]))+B(P*C[f+24>>2]))+C[f+52>>2]))))+B(w*B(z?0:B(B(B(B(D*C[n+32>>2])+B(F*C[n+36>>2]))+B(Z*C[n+40>>2]))+C[n+56>>2])-B(B(B(B(Y*C[f+32>>2])+B(O*C[f+36>>2]))+B(P*C[f+40>>2]))+C[f+56>>2])))),D<m&&(W=C[v+1772>>2],G=Q,_=p,g=w,m=D)),v=v+16|0,R=R+-1|0,R;){}else m=B(0xde0b6b000000000),G=B(0),_=B(0),g=B(0),W=B(0);return QA(e),QA(i),v=0,m<B(0)||(Q=QA(e),p=QA(i),r=Te(A+192|0,e,i,r,0),t[A+116>>2]=0,i=f+8|0,v=t[i+4>>2],e=A- -64|0,t[e>>2]=t[i>>2],t[e+4>>2]=v,i=f+24|0,v=t[i+4>>2],e=A+80|0,t[e>>2]=t[i>>2],t[e+4>>2]=v,i=f+40|0,v=t[i+4>>2],e=A+96|0,t[e>>2]=t[i>>2],t[e+4>>2]=v,m=B(m+B(B(Q+p)+B(.5))),C[A+112>>2]=B(g*m)+C[f+56>>2],C[A+108>>2]=B(_*m)+C[f+52>>2],e=t[f+4>>2],t[A+56>>2]=t[f>>2],t[A+60>>2]=e,e=t[f+20>>2],t[A+72>>2]=t[f+16>>2],t[A+76>>2]=e,e=t[f+36>>2],t[A+88>>2]=t[f+32>>2],t[A+92>>2]=e,C[A+104>>2]=B(G*m)+C[f+48>>2],i=n+8|0,f=t[i+4>>2],e=A+128|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,i=t[n+20>>2],e=A+136|0,t[e>>2]=t[n+16>>2],t[e+4>>2]=i,i=n+24|0,f=t[i+4>>2],e=A+144|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,i=t[n+36>>2],e=A+152|0,t[e>>2]=t[n+32>>2],t[e+4>>2]=i,i=n+40|0,f=t[i+4>>2],e=A+160|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,i=t[n+52>>2],e=A+168|0,t[e>>2]=t[n+48>>2],t[e+4>>2]=i,i=n+56|0,f=t[i+4>>2],e=A+176|0,t[e>>2]=t[i>>2],t[e+4>>2]=f,t[A+184>>2]=1566444395,e=t[n+4>>2],t[A+120>>2]=t[n>>2],t[A+124>>2]=e,t[r+16>>2]=0,C[r+12>>2]=-g,C[r+8>>2]=-_,C[r+4>>2]=-G,a[A+48|0]=0,t[A+8>>2]=15140,Ue(r,A+56|0,A+8|0,u),e=b[A+48|0],e&&(Q=C[A+44>>2],t[k+12>>2]=0,m=B(m-Q),C[k>>2]=C[A+28>>2]-B(G*m),r=A+36|0,C[k+8>>2]=C[r>>2]-B(g*m),C[k+4>>2]=C[A+32>>2]-B(_*m),f=t[r+4>>2],i=c+8|0,t[i>>2]=t[r>>2],t[i+4>>2]=f,r=t[A+32>>2],t[c>>2]=t[A+28>>2],t[c+4>>2]=r,C[o+12>>2]=W,C[o+8>>2]=g,C[o+4>>2]=_,C[o>>2]=G),v=0!=(0|e)),E=A+4240|0,0|v;},Cr,Yr,Yr,function(A,r,e,i){A|=0,r|=0,e|=0,i=B(i);var f=0,n=0;f=t[r+4>>2],t[A+4>>2]=t[r>>2],t[A+8>>2]=f,r=r+8|0,n=t[r+4>>2],f=A+12|0,t[f>>2]=t[r>>2],t[f+4>>2]=n,f=e+8|0,n=t[f+4>>2],r=A+28|0,t[r>>2]=t[f>>2],t[r+4>>2]=n,r=t[e+4>>2],t[A+20>>2]=t[e>>2],t[A+24>>2]=r,a[A+40|0]=1,C[A+36>>2]=i;},sA,Cr,Le,Cr,Yr,Yr,function(A,r,e,i){A|=0,r|=0,e|=0,i=B(i);var f=0,n=0,b=0;C[A+36>>2]>i&&(a[A+40|0]=1,n=r+8|0,b=t[n+4>>2],f=A+12|0,t[f>>2]=t[n>>2],t[f+4>>2]=b,f=t[r+4>>2],t[A+4>>2]=t[r>>2],t[A+8>>2]=f,f=e+8|0,n=t[f+4>>2],r=A+28|0,t[r>>2]=t[f>>2],t[r+4>>2]=n,r=t[e+4>>2],t[A+20>>2]=t[e>>2],t[A+24>>2]=r,C[A+36>>2]=i);},sA,Cr,function(A,r,e,i){var f,n;return A|=0,r|=0,e|=0,i|=0,e=t[r>>2],e=0|yf[t[t[e>>2]+56>>2]](e,72),i=t[r+4>>2],f=t[A+12>>2],n=t[A+16>>2],A=t[A+8>>2],vA(e,r),a[e+28|0]=1,t[e+8>>2]=A,t[e>>2]=15508,t[e+24>>2]=0,a[e+48|0]=1,t[e+16>>2]=0,t[e+20>>2]=0,t[e+44>>2]=0,t[e+64>>2]=f,t[e+68>>2]=n,a[e+60|0]=0,t[e+56>>2]=i,a[e+52|0]=0,t[e+36>>2]=0,t[e+40>>2]=0,0|e;},function(A){A|=0;var r=0,e=0;return t[A>>2]=15508,b[A+52|0]&&(r=t[A+56>>2],r&&(e=t[A+4>>2],yf[t[t[e>>2]+16>>2]](e,r))),r=A+44|0,e=t[r>>2],e&&(b[A+48|0]&&gA(e),t[A+44>>2]=0),t[r>>2]=0,a[A+48|0]=1,r=A+36|0,t[r>>2]=0,t[r+4>>2]=0,r=A+24|0,e=t[r>>2],e&&(b[A+28|0]&&gA(e),t[A+24>>2]=0),t[r>>2]=0,a[A+28|0]=1,r=A+16|0,t[r>>2]=0,t[r+4>>2]=0,0|A;},function(A){A|=0;var r=0,e=0;t[A>>2]=15508,b[A+52|0]&&(r=t[A+56>>2],r&&(e=t[A+4>>2],yf[t[t[e>>2]+16>>2]](e,r))),r=A+44|0,e=t[r>>2],e&&(b[A+48|0]&&gA(e),t[A+44>>2]=0),t[r>>2]=0,a[A+48|0]=1,r=A+36|0,t[r>>2]=0,t[r+4>>2]=0,r=A+24|0,e=t[r>>2],e&&(b[A+28|0]&&gA(e),t[A+24>>2]=0),t[r>>2]=0,a[A+28|0]=1,r=A+16|0,t[r>>2]=0,t[r+4>>2]=0,rA(A);},function(A,r,e,i,f){A|=0,r|=0,e|=0,i|=0,f|=0;var n,o=0,k=0,c=B(0),u=B(0),l=B(0),s=0,d=B(0),v=0,g=0,R=0,h=0,y=0,p=0,D=0,w=0,W=0,F=0,Z=B(0),Y=0,N=0,V=B(0),I=B(0),J=B(0),X=B(0),M=B(0),x=B(0),S=B(0),T=B(0),U=B(0),j=B(0),O=B(0),H=B(0),z=B(0),P=B(0),L=B(0),K=B(0),q=0,$=B(0),AA=B(0),rA=B(0),eA=B(0),iA=B(0),aA=B(0),fA=B(0),nA=0,tA=B(0),bA=B(0),oA=0,kA=0,cA=0,uA=0,lA=0,sA=0,dA=0,vA=0,_A=0,BA=0,mA=0,RA=0,GA=0,hA=0,yA=0,QA=B(0),pA=B(0),DA=0,wA=0,WA=0,FA=0,ZA=0,YA=0,EA=0,NA=0,VA=0,IA=0,XA=0,MA=0;n=E-928|0,E=n,k=t[A+56>>2],k||(o=t[A+4>>2],k=0|yf[t[t[o>>2]+12>>2]](o,t[r+8>>2],t[e+8>>2]),a[A+52|0]=1,t[A+56>>2]=k),t[f+4>>2]=k,o=t[e+4>>2];A:{r:{e:{i:{a:{f:{n:{t:{b:{o:{k:{c:{u:{l:{if(W=t[r+4>>2],w=t[W+4>>2],8!=(0|w)){if(10!=(0|w))break l;if(w=t[o+4>>2],8==(0|w))break u;if(10!=(0|w))break l;if(i=W+32|0,A=t[W+56>>2],c=C[i+(A<<2)>>2],d=C[i+((A+2|0)%3<<2)>>2],W=o+32|0,i=t[o+56>>2],u=C[k+784>>2],c=Ke(n+432|0,n+8|0,c,d,C[W+(i<<2)>>2],C[W+((i+2|0)%3<<2)>>2],A,i,t[r+12>>2],t[e+12>>2],u),c<u&&yf[t[t[f>>2]+16>>2]](f,n+432|0,n+8|0,c),A=t[f+4>>2],!t[A+780>>2])break e;if(r=t[A+772>>2],e=t[t[f+8>>2]+8>>2],(0|r)==(0|e))break A;break r;}if(10==t[o+4>>2]){if(i=o+32|0,A=t[o+56>>2],u=C[k+784>>2],c=Ke(n+432|0,n+8|0,B(0),B(C[W+32>>2]*C[W+16>>2]),C[i+(A<<2)>>2],C[i+((A+2|0)%3<<2)>>2],1,A,t[r+12>>2],t[e+12>>2],u),c<u&&yf[t[t[f>>2]+16>>2]](f,n+432|0,n+8|0,c),A=t[f+4>>2],!t[A+780>>2])break e;if(r=t[A+772>>2],e=t[t[f+8>>2]+8>>2],(0|r)==(0|e))break A;break r;}}if(t[n+920>>2]=1566444395,a[n+764|0]=0,t[n+740>>2]=953267991,w=Te(n+352|0,W,o,n+432|0,t[A+8>>2]),t[w+32>>2]=o,t[w+28>>2]=W,u=B(B(B(B(yf[t[t[W>>2]+48>>2]](W))+B(yf[t[t[o>>2]+48>>2]](o)))+C[t[A+56>>2]+784>>2])+C[f+32>>2]),C[n+920>>2]=u*u,k=t[r+12>>2],y=k+8|0,p=t[y+4>>2],v=n+800|0,t[v>>2]=t[y>>2],t[v+4>>2]=p,y=t[k>>2],p=t[k+4>>2],v=k+24|0,D=t[v+4>>2],Y=n+816|0,t[Y>>2]=t[v>>2],t[Y+4>>2]=D,v=t[k+16>>2],D=t[k+20>>2],Y=k+40|0,N=t[Y+4>>2],R=n+832|0,t[R>>2]=t[Y>>2],t[R+4>>2]=N,Y=t[k+32>>2],N=t[k+36>>2],R=k+56|0,F=t[R+4>>2],nA=n+848|0,t[nA>>2]=t[R>>2],t[nA+4>>2]=F,t[n+792>>2]=y,t[n+796>>2]=p,t[n+808>>2]=v,t[n+812>>2]=D,t[n+824>>2]=Y,t[n+828>>2]=N,y=t[k+52>>2],t[n+840>>2]=t[k+48>>2],t[n+844>>2]=y,k=t[e+12>>2],y=k+8|0,p=t[y+4>>2],v=n+864|0,t[v>>2]=t[y>>2],t[v+4>>2]=p,y=t[k+4>>2],t[n+856>>2]=t[k>>2],t[n+860>>2]=y,y=k+24|0,p=t[y+4>>2],v=n+880|0,t[v>>2]=t[y>>2],t[v+4>>2]=p,p=t[k+20>>2],y=n+872|0,v=y,t[v>>2]=t[k+16>>2],t[v+4>>2]=p,p=k+40|0,v=t[p+4>>2],D=n+896|0,t[D>>2]=t[p>>2],t[D+4>>2]=v,v=t[k+36>>2],p=n+888|0,t[p>>2]=t[k+32>>2],t[p+4>>2]=v,v=k+56|0,D=t[v+4>>2],Y=n+912|0,t[Y>>2]=t[v>>2],t[Y+4>>2]=D,D=t[k+52>>2],v=n+904|0,t[v>>2]=t[k+48>>2],t[v+4>>2]=D,k=t[W+4>>2],(0|k)>6)break k;if(D=t[o+4>>2],(0|D)>6)break k;if(t[n+344>>2]=15628,u=B(0),k&&(u=B(yf[t[t[W>>2]+48>>2]](W)),D=t[o+4>>2]),D&&(c=B(yf[t[t[o>>2]+48>>2]](o))),a[n+44|0]=0,C[n+36>>2]=c,C[n+32>>2]=u,t[n+12>>2]=f,t[n+8>>2]=15804,!t[W+56>>2])break k;if(!t[o+56>>2])break c;if(c=C[t[A+56>>2]+784>>2],!b[i+24|0])break o;if(u=B(-1.0000000150474662e30),function(A,r,e,i,a,f){var n,o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=0,v=0,g=B(0),_=B(0),R=B(0),G=B(0),h=0,y=0,p=0,D=0,w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=B(0),M=B(0),x=0,S=B(0),T=B(0),U=B(0),j=B(0),O=B(0),H=B(0),z=B(0),P=B(0),L=B(0),K=B(0),q=0,$=0,AA=0,rA=0,eA=0,iA=0,aA=0,fA=B(0),nA=B(0),tA=0,bA=0,oA=0,kA=0,cA=B(0),uA=B(0),lA=B(0),sA=B(0),dA=B(0);n=E-112|0,E=n,t[691]=t[691]+1,u=C[e+52>>2],y=20,p=e+20|0,l=C[p>>2],x=e+24|0,G=C[x>>2],T=C[i+52>>2],U=C[i+20>>2],R=C[i+24>>2],j=C[e+56>>2],o=C[A+68>>2],D=e+36|0,g=C[D>>2],s=C[A+72>>2],q=e+40|0,w=C[q>>2],W=C[i+56>>2],I=C[r+68>>2],k=C[i+36>>2],J=C[r+72>>2],_=C[i+40>>2],F=C[e+48>>2],X=C[e+8>>2],O=C[e+4>>2],H=C[e>>2],z=C[i+48>>2],P=C[i+8>>2],Z=C[i+4>>2],V=C[i>>2],Y=C[e+16>>2],L=C[i+16>>2],N=C[A+64>>2],M=C[e+32>>2],c=C[r+64>>2],K=C[i+32>>2],t[n+28>>2]=0,j=B(B(j+B(B(B(N*M)+B(o*g))+B(s*w)))-B(W+B(B(B(c*K)+B(I*k))+B(J*_)))),C[n+24>>2]=j,T=B(B(u+B(B(B(N*Y)+B(o*l))+B(s*G)))-B(T+B(B(B(c*L)+B(I*U))+B(J*R)))),C[n+20>>2]=T,U=B(B(F+B(B(B(N*H)+B(o*O))+B(s*X)))-B(z+B(B(B(c*V)+B(I*Z))+B(J*P)))),C[n+16>>2]=U,o=B(3.4028234663852886e38);l:{s:if($=t[A+28>>2],!((0|$)<1))for(AA=A+36|0,rA=n+12|0,eA=e+32|0,iA=e+16|0,h=1;;){if(d=t[AA>>2]+y|0,s=C[d+8>>2],I=C[d+4>>2],J=C[d>>2],t[rA>>2]=0,d=n+8|0,g=B(B(B(J*M)+B(I*g))+B(s*w)),C[d>>2]=g,l=B(B(B(J*Y)+B(I*l))+B(s*G)),C[n+4>>2]=l,s=B(B(B(J*C[e>>2])+B(I*C[e+4>>2]))+B(s*X)),C[n>>2]=s,B(B(B(s*U)+B(l*T))+B(g*j))<B(0)&&(C[d>>2]=-g,C[n+4>>2]=-l,C[n>>2]=-s),t[689]=t[689]+1,!b[3188]||He(e,i,n+16|0,n,A,r,o)){if(v=0,t[690]=t[690]+1,JA(A,e,n,n+108|0,n+104|0,n+80|0,n- -64|0),JA(r,i,n,n+100|0,n+96|0,n+48|0,n+32|0),l=C[n+104>>2],g=C[n+100>>2],l<g||(s=C[n+96>>2],w=C[n+108>>2],s<w||(c=B(l-g),l=B(s-w),c=c<l?c:l,v=1)),!v)break l;c<o&&(v=t[n+4>>2],t[a>>2]=t[n>>2],t[a+4>>2]=v,aA=t[d+4>>2],v=a+8|0,t[v>>2]=t[d>>2],t[v+4>>2]=aA,o=c);}if((0|h)>=(0|$))break s;y=y+36|0,h=h+1|0,w=C[q>>2],g=C[D>>2],M=C[eA>>2],G=C[x>>2],l=C[p>>2],Y=C[iA>>2],X=C[e+8>>2];}if(p=t[r+28>>2],(0|p)>=1)for(x=n+12|0,y=i+32|0,q=i+40|0,$=i+16|0,AA=i+24|0,D=20,h=0;;){if(d=t[r+36>>2]+D|0,c=C[d+8>>2],l=C[d>>2],g=C[d+4>>2],t[x>>2]=0,d=n+8|0,s=B(B(B(l*C[y>>2])+B(g*C[i+36>>2]))+B(c*C[q>>2])),C[d>>2]=s,w=B(B(B(l*C[$>>2])+B(g*C[i+20>>2]))+B(c*C[AA>>2])),C[n+4>>2]=w,c=B(B(B(l*C[i>>2])+B(g*C[i+4>>2]))+B(c*C[i+8>>2])),C[n>>2]=c,B(B(B(c*U)+B(w*T))+B(s*j))<B(0)&&(C[d>>2]=-s,C[n+4>>2]=-w,C[n>>2]=-c),t[689]=t[689]+1,!b[3188]||He(e,i,n+16|0,n,A,r,o)){if(v=0,t[690]=t[690]+1,JA(A,e,n,n+108|0,n+104|0,n+80|0,n- -64|0),JA(r,i,n,n+100|0,n+96|0,n+48|0,n+32|0),c=C[n+104>>2],l=C[n+100>>2],c<l||(g=C[n+96>>2],s=C[n+108>>2],g<s||(G=B(c-l),c=B(g-s),G=G<c?G:c,v=1)),!v)break l;G<o&&(v=t[n+4>>2],t[a>>2]=t[n>>2],t[a+4>>2]=v,rA=t[d+4>>2],v=a+8|0,t[v>>2]=t[d>>2],t[v+4>>2]=rA,o=G);}if(D=D+36|0,h=h+1|0,!((0|h)<(0|p)))break;}if(q=A+48|0,D=t[q>>2],(0|D)>=1)for($=r+48|0,y=t[$>>2],p=-1,AA=A+56|0,rA=e+36|0,eA=e+32|0,iA=e+40|0,aA=e+20|0,tA=e+16|0,bA=e+24|0,oA=e+8|0,kA=n+12|0,d=0,x=-1,g=B(0),s=B(0),w=B(0),G=B(0),c=B(0),l=B(0);;){if((0|y)>=1){for(h=t[AA>>2]+(d<<4)|0,X=C[h>>2],Y=C[h+4>>2],N=C[h+8>>2],I=B(B(B(X*C[eA>>2])+B(Y*C[rA>>2]))+B(N*C[iA>>2])),J=B(B(B(X*C[tA>>2])+B(Y*C[aA>>2]))+B(N*C[bA>>2])),X=B(B(B(X*C[e>>2])+B(Y*C[e+4>>2]))+B(N*C[oA>>2])),h=0,D=4;;){if(S=C[i+40>>2],cA=C[i+32>>2],uA=C[i+36>>2],Y=C[i+24>>2],N=C[i+16>>2],u=C[i+20>>2],v=t[r+56>>2]+D|0,M=C[v+-4>>2],lA=C[i+4>>2],R=C[v>>2],sA=C[i+8>>2],W=C[v+4>>2],dA=C[i>>2],t[kA>>2]=0,y=n+8|0,Y=B(B(B(M*N)+B(R*u))+B(W*Y)),N=B(B(B(M*dA)+B(R*lA))+B(W*sA)),u=B(B(X*Y)-B(J*N)),C[y>>2]=u,M=B(B(B(M*cA)+B(R*uA))+B(W*S)),R=B(B(I*N)-B(X*M)),C[n+4>>2]=R,W=B(B(J*M)-B(I*Y)),C[n>>2]=W,(!(+B(m(u))>1e-6^1)||+B(m(W))>1e-6|+B(m(R))>1e-6)&&(S=u,u=B(B(1)/B(Q(B(B(u*u)+B(B(W*W)+B(R*R)))))),S=B(S*u),C[y>>2]=S,R=B(R*u),C[n+4>>2]=R,u=B(W*u),C[n>>2]=u,B(B(B(u*U)+B(R*T))+B(j*S))<B(0)&&(C[y>>2]=-S,C[n+4>>2]=-R,C[n>>2]=-u),t[689]=t[689]+1,!b[3188]||He(e,i,n+16|0,n,A,r,o))){v=0,t[690]=t[690]+1,JA(A,e,n,n+108|0,n+104|0,n+80|0,n- -64|0),JA(r,i,n,n+100|0,n+96|0,n+48|0,n+32|0);s:{d:{v:{if(u=C[n+104>>2],R=C[n+100>>2],!(u<R||(W=C[n+96>>2],S=C[n+108>>2],W<S))){if(k=B(u-R),u=B(W-S),!(k<u))break v;H=C[n+56>>2],_=C[n+72>>2],v=1,z=C[n+52>>2],P=C[n+48>>2],F=C[n+68>>2],O=C[n+64>>2];}if(!v)break d;break s;}H=C[n+40>>2],_=C[n+88>>2],z=C[n+36>>2],P=C[n+32>>2],F=C[n+84>>2],O=C[n+80>>2],k=u;break s;}return E=n+112|0,0;}k<o&&(p=t[n+4>>2],t[a>>2]=t[n>>2],t[a+4>>2]=p,x=t[y+4>>2],p=a+8|0,t[p>>2]=t[y>>2],t[p+4>>2]=x,l=P,c=z,G=H,w=O,s=F,g=_,fA=N,nA=Y,K=M,L=X,V=J,Z=I,x=d,p=h,o=k);}if(D=D+16|0,h=h+1|0,y=t[$>>2],!((0|h)<(0|y)))break;}D=t[q>>2];}if(d=d+1|0,!((0|d)<(0|D)))break;}else x=-1,l=B(0),c=B(0),G=B(0),w=B(0),s=B(0),g=B(0),p=-1;if(!((p|x)<0)){H=B(l-w),z=B(c-s),P=B(G-g),_=B(B(B(H*fA)+B(z*nA))+B(P*K)),O=B(B(B(H*L)+B(z*V))+B(P*Z)),o=B(0),F=B(B(B(fA*L)+B(nA*V))+B(K*Z)),k=B(B(1)-B(F*F)),k!=B(0)&&(o=B(-1.0000000150474662e30),k=B(B(O-B(_*F))/k),k<B(-1.0000000150474662e30)||(o=k,o>B(1.0000000150474662e30)&&(o=B(1.0000000150474662e30))));s:{d:{if(_=B(B(F*o)-_),_<B(-1.0000000150474662e30)){if(k=B(O+B(F*B(-1.0000000150474662e30))),!(k<B(-1.0000000150474662e30)))break d;_=B(-1.0000000150474662e30),o=B(-1.0000000150474662e30);break s;}if(!(_>B(1.0000000150474662e30)))break s;if(o=B(-1.0000000150474662e30),_=B(1.0000000150474662e30),k=B(O+B(F*B(1.0000000150474662e30))),k<B(-1.0000000150474662e30))break s;if(o=k,!(o>B(1.0000000150474662e30)))break s;o=B(1.0000000150474662e30);break s;}o=B(1.0000000150474662e30),k>B(1.0000000150474662e30)?_=B(-1.0000000150474662e30):(_=B(-1.0000000150474662e30),o=k);}t[n+92>>2]=0,K=B(K*_),k=B(K+B(P-B(Z*o))),C[n+88>>2]=k,F=B(nA*_),Z=B(F+B(z-B(V*o))),C[n+84>>2]=Z,_=B(fA*_),o=B(_+B(H-B(L*o))),C[n+80>>2]=o,V=B(B(k*k)+B(B(o*o)+B(Z*Z))),V>B(1.1920928955078125e-7)&&(A=n+88|0,u=k,L=B(Q(V)),k=B(B(1)/L),V=B(u*k),C[A>>2]=V,Z=B(Z*k),C[n+84>>2]=Z,o=B(o*k),C[n+80>>2]=o,B(B(B(o*U)+B(Z*T))+B(V*j))<B(0)&&(C[A>>2]=-V,C[n+84>>2]=-Z,C[n+80>>2]=-o),t[n+76>>2]=0,C[n+72>>2]=G+K,C[n+68>>2]=c+F,C[n+64>>2]=l+_,yf[t[t[f>>2]+16>>2]](f,n+80|0,n- -64|0,B(-L)));}return o=C[a>>2],k=C[a+4>>2],G=C[a+8>>2],B(B(B(U*o)+B(T*k))+B(j*G))<B(0)&&(t[a+12>>2]=0,C[a+8>>2]=-G,C[a+4>>2]=-k,C[a>>2]=-o),E=n+112|0,1;}return E=n+112|0,0;}(t[W+56>>2],t[o+56>>2],t[r+12>>2],t[e+12>>2],n+248|0,f))break b;break t;}if(i=W+32|0,A=t[W+56>>2],u=C[k+784>>2],c=Ke(n+432|0,n+8|0,C[i+(A<<2)>>2],C[i+((A+2|0)%3<<2)>>2],B(0),B(C[o+32>>2]*C[o+16>>2]),A,1,t[r+12>>2],t[e+12>>2],u),c<u&&yf[t[t[f>>2]+16>>2]](f,n+432|0,n+8|0,c),A=t[f+4>>2],!t[A+780>>2])break e;if(r=t[A+772>>2],e=t[t[f+8>>2]+8>>2],(0|r)==(0|e))break A;break r;}if(1==t[o+4>>2]){if(t[n+252>>2]=0,v=e+12|0,e=t[v>>2],d=C[e+56>>2],I=C[e+40>>2],S=C[e+36>>2],T=C[e+32>>2],j=C[e+52>>2],O=C[e+24>>2],K=C[e+20>>2],H=C[e+16>>2],Z=C[e+48>>2],u=C[o+68>>2],V=C[e+8>>2],c=C[o+60>>2],z=C[e>>2],l=C[o- -64>>2],P=C[e+4>>2],e=CA(16,16),t[n+256>>2]=1,t[n+260>>2]=e,a[n+264|0]=1,C[e>>2]=Z+B(B(B(c*z)+B(l*P))+B(u*V)),C[e+4>>2]=j+B(B(B(c*H)+B(l*K))+B(u*O)),t[e+12>>2]=0,C[e+8>>2]=d+B(B(B(c*T)+B(l*S))+B(u*I)),e=t[n+252>>2]+1|0,t[n+252>>2]=e,u=C[o+76>>2],k=t[v>>2],c=C[o+80>>2],l=C[o+84>>2],d=B(B(B(B(u*C[k>>2])+B(c*C[k+4>>2]))+B(l*C[k+8>>2]))+C[k+48>>2]),I=B(B(B(B(u*C[k+32>>2])+B(c*C[k+36>>2]))+B(l*C[k+40>>2]))+C[k+56>>2]),u=B(B(B(B(u*C[k+16>>2])+B(c*C[k+20>>2]))+B(l*C[k+24>>2]))+C[k+52>>2]),t[n+256>>2]!=(0|e))break i;if(p=e?e<<1:1,(0|e)>=(0|p))break i;if(!p)break n;if(y=CA(p<<4,16),e=t[n+252>>2],(0|e)>=1)break f;break a;}}if(Ue(w,n+792|0,f,t[i+20>>2]),!(!t[A+64>>2]|t[t[f+4>>2]+780>>2]>=t[A+68>>2])&&(u=C[w+4>>2],c=C[w+8>>2],l=C[w+12>>2],d=B(B(B(u*u)+B(c*c))+B(l*l)),d>B(1.1920928955078125e-7)&&(Z=c,c=B(B(1)/d),I=B(Z*c),K=B(u*c),H=B(l*c),B(m(H))>B(.7071067690849304)?(u=B(B(1)/B(Q(B(B(H*H)+B(I*I))))),c=B(I*u),u=B(-B(H*u)),l=B(0)):(c=B(B(1)/B(Q(B(B(K*K)+B(I*I))))),u=B(K*c),l=B(-B(I*c)),c=B(0)),k=n+856|0,D=n+840|0,Y=n+824|0,N=n+808|0,d=B(yf[t[t[W>>2]+16>>2]](W)),S=B(yf[t[t[o>>2]+16>>2]](o)),T=C[794],W=d<S,W?(o=n+800|0,R=t[o+4>>2],F=n+256|0,t[F>>2]=t[o>>2],t[F+4>>2]=R,o=N+8|0,R=t[o+4>>2],F=n+272|0,t[F>>2]=t[o>>2],t[F+4>>2]=R,o=Y+8|0,R=t[o+4>>2],F=n+288|0,t[F>>2]=t[o>>2],t[F+4>>2]=R,o=D+8|0,R=t[o+4>>2],F=n+304|0,t[F>>2]=t[o>>2],t[F+4>>2]=R,o=t[n+796>>2],t[n+248>>2]=t[n+792>>2],t[n+252>>2]=o,o=t[N+4>>2],t[n+264>>2]=t[N>>2],t[n+268>>2]=o,o=t[Y+4>>2],t[n+280>>2]=t[Y>>2],t[n+284>>2]=o,o=t[D+4>>2],t[n+296>>2]=t[D>>2]):(o=k+8|0,R=t[o+4>>2],F=n+256|0,t[F>>2]=t[o>>2],t[F+4>>2]=R,o=y+8|0,R=t[o+4>>2],F=n+272|0,t[F>>2]=t[o>>2],t[F+4>>2]=R,o=p+8|0,R=t[o+4>>2],F=n+288|0,t[F>>2]=t[o>>2],t[F+4>>2]=R,o=v+8|0,R=t[o+4>>2],F=n+304|0,t[F>>2]=t[o>>2],t[F+4>>2]=R,o=t[k+4>>2],t[n+248>>2]=t[k>>2],t[n+252>>2]=o,o=t[y+4>>2],t[n+264>>2]=t[y>>2],t[n+268>>2]=o,o=t[p+4>>2],t[n+280>>2]=t[p>>2],t[n+284>>2]=o,o=t[v+4>>2],t[n+296>>2]=t[v>>2]),t[n+300>>2]=o,yA=A- -64|0,o=t[yA>>2],!((0|o)<1))))for(Z=c,d=B(B(G(B(T/(W?d:S)),B(.39269909262657166)))*B(.5)),QA=B(B(B(l*l)+B(u*u))+B(c*c)),c=B(ge(d)/B(Q(QA))),S=B(Z*c),T=B(u*c),j=B(l*c),O=_e(d),pA=B(Q(B(B(H*H)+B(B(K*K)+B(I*I))))),F=n+296|0,nA=n+224|0,kA=n+208|0,cA=n+280|0,uA=n+192|0,lA=n+264|0,sA=n+176|0,dA=n+160|0,vA=n+144|0,_A=n+128|0,BA=n+112|0,mA=n+96|0,RA=n+80|0,GA=n- -64|0,hA=n+48|0,DA=n+836|0,wA=n+820|0,WA=n+244|0,FA=n+240|0,ZA=n+900|0,YA=n+884|0,EA=n+868|0,NA=n+892|0,VA=n+888|0,IA=n+876|0,XA=n+872|0,MA=n+860|0,R=0;QA>B(1.1920928955078125e-7)&&(d=B(B(B(B(6.2831854820251465)/B(0|o))*B(0|R))*B(.5)),l=B(ge(d)/pA),u=B(H*l),c=B(I*l),l=B(K*l),d=_e(d),W?(o=t[r+12>>2],z=C[o>>2],P=C[o+4>>2],$=C[o+8>>2],t[n+804>>2]=0,AA=C[o+32>>2],rA=C[o+16>>2],eA=C[o+36>>2],iA=C[o+20>>2],aA=C[o+40>>2],fA=C[o+24>>2],t[DA>>2]=0,t[wA>>2]=0,J=B(B(B(B(T*d)-B(O*c))-B(j*u))+B(S*l)),X=B(B(B(B(O*d)+B(j*l))+B(T*c))+B(S*u)),M=B(B(B(B(j*d)-B(O*l))-B(S*c))+B(T*u)),x=B(B(B(B(S*d)-B(O*u))-B(T*l))+B(j*c)),Z=B(B(B(u*J)+B(B(l*X)+B(d*M)))-B(c*x)),V=B(B(B(B(d*X)-B(l*M))-B(c*J))-B(u*x)),L=B(B(B(c*M)+B(B(u*X)+B(d*x)))-B(l*J)),u=B(B(B(l*x)+B(B(d*J)+B(c*X)))-B(u*M)),c=B(B(2)/B(B(V*V)+B(B(L*L)+B(B(Z*Z)+B(u*u))))),l=B(L*c),X=B(Z*l),d=B(u*c),M=B(V*d),J=B(X-M),x=B(u*l),U=B(Z*c),tA=B(V*U),c=B(x+tA),U=B(Z*U),bA=B(u*d),u=B(B(1)-B(U+bA)),C[n+832>>2]=B(B($*J)+B(fA*c))+B(aA*u),C[n+828>>2]=B(B(J*P)+B(c*iA))+B(u*eA),C[n+824>>2]=B(B(J*z)+B(c*rA))+B(u*AA),d=B(Z*d),Z=B(V*l),u=B(d+Z),V=B(L*l),c=B(B(1)-B(U+V)),l=B(x-tA),C[n+816>>2]=B(B($*u)+B(fA*c))+B(aA*l),C[n+812>>2]=B(B(u*P)+B(c*iA))+B(l*eA),C[n+808>>2]=B(B(u*z)+B(c*rA))+B(l*AA),u=B(B(1)-B(bA+V)),c=B(d-Z),l=B(X+M),C[n+800>>2]=B(B($*u)+B(fA*c))+B(aA*l),C[n+796>>2]=B(B(u*P)+B(c*iA))+B(l*eA),C[n+792>>2]=B(B(u*z)+B(c*rA))+B(l*AA),o=t[e+12>>2],h=t[o+4>>2],t[k>>2]=t[o>>2],t[k+4>>2]=h,s=o+8|0,h=t[s+4>>2],g=k+8|0,t[g>>2]=t[s>>2],t[g+4>>2]=h,s=o+24|0,h=t[s+4>>2],g=y+8|0,t[g>>2]=t[s>>2],t[g+4>>2]=h,s=t[o+20>>2],t[y>>2]=t[o+16>>2],t[y+4>>2]=s,s=o+40|0,h=t[s+4>>2],g=p+8|0,t[g>>2]=t[s>>2],t[g+4>>2]=h,s=t[o+36>>2],t[p>>2]=t[o+32>>2],t[p+4>>2]=s,s=o+56|0,h=t[s+4>>2],g=v+8|0,t[g>>2]=t[s>>2],t[g+4>>2]=h,s=t[o+52>>2],t[v>>2]=t[o+48>>2],t[v+4>>2]=s):(o=t[r+12>>2],s=o+8|0,h=t[s+4>>2],g=n+800|0,t[g>>2]=t[s>>2],t[g+4>>2]=h,s=t[o>>2],h=t[o+4>>2],g=t[o+20>>2],t[N>>2]=t[o+16>>2],t[N+4>>2]=g,g=o+24|0,oA=t[g+4>>2],q=N+8|0,t[q>>2]=t[g>>2],t[q+4>>2]=oA,g=t[o+36>>2],t[Y>>2]=t[o+32>>2],t[Y+4>>2]=g,g=o+40|0,oA=t[g+4>>2],q=Y+8|0,t[q>>2]=t[g>>2],t[q+4>>2]=oA,g=o+56|0,oA=t[g+4>>2],q=D+8|0,t[q>>2]=t[g>>2],t[q+4>>2]=oA,g=t[o+52>>2],t[D>>2]=t[o+48>>2],t[D+4>>2]=g,t[n+792>>2]=s,t[n+796>>2]=h,o=t[e+12>>2],z=C[o+32>>2],P=C[o>>2],$=C[o+16>>2],AA=C[o+36>>2],rA=C[o+4>>2],eA=C[o+20>>2],iA=C[o+40>>2],aA=C[o+8>>2],fA=C[o+24>>2],t[ZA>>2]=0,t[YA>>2]=0,t[EA>>2]=0,J=B(B(B(B(T*d)-B(O*c))-B(j*u))+B(S*l)),X=B(B(B(B(O*d)+B(j*l))+B(T*c))+B(S*u)),M=B(B(B(B(j*d)-B(O*l))-B(S*c))+B(T*u)),x=B(B(B(B(S*d)-B(O*u))-B(T*l))+B(j*c)),Z=B(B(B(u*J)+B(B(l*X)+B(d*M)))-B(c*x)),V=B(B(B(B(d*X)-B(l*M))-B(c*J))-B(u*x)),L=B(B(B(c*M)+B(B(u*X)+B(d*x)))-B(l*J)),u=B(B(B(l*x)+B(B(d*J)+B(c*X)))-B(u*M)),c=B(B(2)/B(B(V*V)+B(B(L*L)+B(B(Z*Z)+B(u*u))))),l=B(L*c),X=B(Z*l),d=B(u*c),M=B(V*d),J=B(X-M),x=B(u*l),U=B(Z*c),tA=B(V*U),c=B(x+tA),U=B(Z*U),bA=B(u*d),u=B(B(1)-B(U+bA)),C[n+896>>2]=B(B(aA*J)+B(fA*c))+B(iA*u),C[NA>>2]=B(B(J*rA)+B(c*eA))+B(u*AA),C[VA>>2]=B(B(J*P)+B(c*$))+B(u*z),d=B(Z*d),Z=B(V*l),u=B(d+Z),V=B(L*l),c=B(B(1)-B(U+V)),l=B(x-tA),C[n+880>>2]=B(B(aA*u)+B(fA*c))+B(iA*l),C[IA>>2]=B(B(u*rA)+B(c*eA))+B(l*AA),C[XA>>2]=B(B(u*P)+B(c*$))+B(l*z),u=B(B(1)-B(bA+V)),c=B(d-Z),l=B(X+M),C[n+864>>2]=B(B(aA*u)+B(fA*c))+B(iA*l),C[MA>>2]=B(B(u*rA)+B(c*eA))+B(l*AA),C[n+856>>2]=B(B(u*P)+B(c*$))+B(l*z)),t[n+40>>2]=0,t[n+44>>2]=f,o=t[n+796>>2],t[hA>>2]=t[n+792>>2],t[hA+4>>2]=o,o=t[N+4>>2],t[GA>>2]=t[N>>2],t[GA+4>>2]=o,o=t[Y+4>>2],t[RA>>2]=t[Y>>2],t[RA+4>>2]=o,o=t[D+4>>2],t[mA>>2]=t[D>>2],t[mA+4>>2]=o,o=n+800|0,s=t[o+4>>2],h=hA+8|0,t[h>>2]=t[o>>2],t[h+4>>2]=s,o=N+8|0,s=t[o+4>>2],h=GA+8|0,t[h>>2]=t[o>>2],t[h+4>>2]=s,o=Y+8|0,s=t[o+4>>2],h=RA+8|0,t[h>>2]=t[o>>2],t[h+4>>2]=s,o=D+8|0,s=t[o+4>>2],h=mA+8|0,t[h>>2]=t[o>>2],t[h+4>>2]=s,t[n+8>>2]=15988,o=t[i+20>>2],s=k+8|0,h=t[s+4>>2],g=BA+8|0,t[g>>2]=t[s>>2],t[g+4>>2]=h,s=t[k+4>>2],t[BA>>2]=t[k>>2],t[BA+4>>2]=s,s=y+8|0,h=t[s+4>>2],g=_A+8|0,t[g>>2]=t[s>>2],t[g+4>>2]=h,s=t[y+4>>2],t[_A>>2]=t[y>>2],t[_A+4>>2]=s,s=p+8|0,h=t[s+4>>2],g=vA+8|0,t[g>>2]=t[s>>2],t[g+4>>2]=h,s=t[p+4>>2],t[vA>>2]=t[p>>2],t[vA+4>>2]=s,s=v+8|0,h=t[s+4>>2],g=dA+8|0,t[g>>2]=t[s>>2],t[g+4>>2]=h,s=t[v+4>>2],t[dA>>2]=t[v>>2],t[dA+4>>2]=s,s=n+256|0,h=t[s+4>>2],g=sA+8|0,t[g>>2]=t[s>>2],t[g+4>>2]=h,s=t[n+252>>2],t[sA>>2]=t[n+248>>2],t[sA+4>>2]=s,s=lA+8|0,h=t[s+4>>2],g=uA+8|0,t[g>>2]=t[s>>2],t[g+4>>2]=h,s=t[lA+4>>2],t[uA>>2]=t[lA>>2],t[uA+4>>2]=s,s=cA+8|0,h=t[s+4>>2],g=kA+8|0,t[g>>2]=t[s>>2],t[g+4>>2]=h,s=t[cA+4>>2],t[kA>>2]=t[cA>>2],t[kA+4>>2]=s,s=F+8|0,h=t[s+4>>2],g=nA+8|0,t[g>>2]=t[s>>2],t[g+4>>2]=h,s=t[F+4>>2],t[nA>>2]=t[F>>2],t[nA+4>>2]=s,t[WA>>2]=o,a[0|FA]=W,Ue(w,n+792|0,n+8|0,o),o=t[yA>>2]),R=R+1|0,(0|R)<(0|o);){}if(!b[A+52|0])break e;if(A=t[f+4>>2],!t[A+780>>2])break e;if(r=t[A+772>>2],e=t[t[f+8>>2]+8>>2],(0|r)!=(0|e))break r;break A;}if(Ue(w,n+792|0,n+8|0,t[i+20>>2]),i=n+24|0,k=t[i+4>>2],w=n+256|0,t[w>>2]=t[i>>2],t[w+4>>2]=k,i=t[n+20>>2],t[n+248>>2]=t[n+16>>2],t[n+252>>2]=i,u=C[n+40>>2],!b[n+44|0]|u<B(0)^1)break t;}if(w=A+16|0,i=t[w>>2],(0|i)<=-1)for(t[A+20>>2]<=-1&&(k=t[A+24>>2],k&&(b[A+28|0]&&gA(k),t[A+24>>2]=0),a[A+28|0]=1,k=A+20|0,t[k>>2]=0,t[k+4>>2]=0),k=i<<4,y=A+24|0;p=t[n+332>>2],v=t[y>>2]+k|0,t[v>>2]=t[n+328>>2],t[v+4>>2]=p,p=n+336|0,D=t[p+4>>2],v=v+8|0,t[v>>2]=t[p>>2],t[v+4>>2]=D,k=k+16|0,i=i+1|0,i;){}t[w>>2]=0,function(A,r,e,i,f,n,o,k,c,u){var l,s,d=0,v=0,g=B(0),m=B(0),R=B(0),G=0,h=B(0),y=0,p=0,D=0,w=0,W=B(0),F=0,Z=0,Y=B(0),N=B(0),V=0,I=B(0),J=B(0),X=B(0),M=B(0),x=B(0),S=B(0),T=B(0),U=B(0),j=B(0),O=0,H=0,z=0,P=0,L=0,K=0,q=0,$=0;if(l=E-32|0,E=l,t[l+28>>2]=t[A+12>>2],g=C[A>>2],R=C[A+4>>2],h=C[A+8>>2],m=B(B(1)/B(Q(B(B(B(g*g)+B(R*R))+B(h*h))))),W=B(h*m),C[l+24>>2]=W,Y=B(R*m),C[l+20>>2]=Y,N=B(g*m),C[l+16>>2]=N,F=-1,v=t[e+28>>2],(0|v)>=1)for(A=t[e+36>>2]+20|0,I=C[f+40>>2],J=C[f+36>>2],X=C[f+24>>2],M=C[f+20>>2],x=C[f+32>>2],S=C[f+16>>2],T=C[f+8>>2],U=C[f+4>>2],j=C[f>>2],m=B(-3.4028234663852886e38);g=C[A>>2],R=C[A+4>>2],h=C[A+8>>2],g=B(B(B(N*B(B(B(g*j)+B(R*U))+B(h*T)))+B(Y*B(B(B(g*S)+B(R*M))+B(h*X))))+B(W*B(B(B(g*x)+B(R*J))+B(h*I)))),G=g>m,m=G?g:m,F=G?d:F,A=A+36|0,d=d+1|0,(0|d)<(0|v);){}if(d=t[k+4>>2],(0|d)<=-1)for(t[k+8>>2]<=-1&&(A=t[k+12>>2],A&&(b[k+16|0]&&gA(A),t[k+12>>2]=0),a[k+16|0]=1,A=k+8|0,t[A>>2]=0,t[A+4>>2]=0),A=d<<4,G=k+12|0;y=t[l+4>>2],v=t[G>>2]+A|0,t[v>>2]=t[l>>2],t[v+4>>2]=y,p=l+8|0,y=t[p+4>>2],v=v+8|0,t[v>>2]=t[p>>2],t[v+4>>2]=y,A=A+16|0,d=d+1|0,d;){}if(G=k+4|0,t[G>>2]=0,A=t[e+36>>2]+_(F,36)|0,s=t[A+4>>2],(0|s)>=1)for(O=A+12|0,H=f+32|0,z=f+40|0,P=f+56|0,L=f+20|0,K=f+24|0,q=f+52|0,$=f+48|0,d=0,v=0;;){if(A=t[e+16>>2]+(t[t[O>>2]+(v<<2)>>2]<<4)|0,m=C[A>>2],g=C[A+4>>2],R=C[A+8>>2],h=B(B(B(B(m*C[H>>2])+B(g*C[f+36>>2]))+B(R*C[z>>2]))+C[P>>2]),W=B(B(B(B(m*C[f+16>>2])+B(g*C[L>>2]))+B(R*C[K>>2]))+C[q>>2]),m=B(B(B(B(m*C[f>>2])+B(g*C[f+4>>2]))+B(R*C[f+8>>2]))+C[$>>2]),V=k+8|0,t[V>>2]==(0|d)&&(p=d?d<<1:1,!((0|d)>=(0|p)))){b:{o:{if(p){if(y=CA(p<<4,16),d=t[G>>2],(0|d)>=1)break o;break b;}if(y=0,(0|d)<1)break b;}for(A=0;w=t[k+12>>2]+A|0,Z=t[w+4>>2],D=A+y|0,t[D>>2]=t[w>>2],t[D+4>>2]=Z,w=w+8|0,Z=t[w+4>>2],D=D+8|0,t[D>>2]=t[w>>2],t[D+4>>2]=Z,A=A+16|0,d=d+-1|0,d;){}}A=k+12|0,d=t[A>>2],d&&(b[k+16|0]&&gA(d),t[A>>2]=0),t[A>>2]=y,a[k+16|0]=1,t[V>>2]=p,d=t[G>>2];}if(A=t[k+12>>2]+(d<<4)|0,t[A+12>>2]=0,C[A+8>>2]=h,C[A+4>>2]=W,C[A>>2]=m,d=t[G>>2]+1|0,t[G>>2]=d,v=v+1|0,(0|v)==(0|s))break;}(0|F)>-1&&ze(l+16|0,r,i,k,c,n,o,u),E=l+32|0;}(n+248|0,t[W+56>>2],t[o+56>>2],t[r+12>>2],t[e+12>>2],B(u-c),c,A+12|0,A+32|0,f);}if(!b[A+52|0])break e;if(A=t[f+4>>2],!t[A+780>>2])break e;if(r=t[A+772>>2],e=t[t[f+8>>2]+8>>2],(0|r)!=(0|e))break r;break A;}if(y=0,(0|e)<1)break a;}for(k=0,Y=n+260|0;D=t[Y>>2]+k|0,N=t[D+4>>2],R=k+y|0,t[R>>2]=t[D>>2],t[R+4>>2]=N,D=D+8|0,N=t[D+4>>2],R=R+8|0,t[R>>2]=t[D>>2],t[R+4>>2]=N,k=k+16|0,e=e+-1|0,e;){}}e=n+260|0,k=t[e>>2],k&&(b[n+264|0]&&gA(k),t[n+260>>2]=0),t[e>>2]=y,a[n+264|0]=1,t[n+256>>2]=p,e=t[n+252>>2];}if(e=t[n+260>>2]+(e<<4)|0,t[e+12>>2]=0,C[e+8>>2]=I,C[e+4>>2]=u,C[e>>2]=d,e=t[n+252>>2]+1|0,t[n+252>>2]=e,u=C[o+92>>2],k=t[v>>2],c=C[o+96>>2],l=C[o+100>>2],d=B(B(B(B(u*C[k>>2])+B(c*C[k+4>>2]))+B(l*C[k+8>>2]))+C[k+48>>2]),I=B(B(B(B(u*C[k+32>>2])+B(c*C[k+36>>2]))+B(l*C[k+40>>2]))+C[k+56>>2]),u=B(B(B(B(u*C[k+16>>2])+B(c*C[k+20>>2]))+B(l*C[k+24>>2]))+C[k+52>>2]),t[n+256>>2]==(0|e)&&(p=e?e<<1:1,!((0|e)>=(0|p)))){i:{a:{if(p){if(y=CA(p<<4,16),e=t[n+252>>2],(0|e)>=1)break a;break i;}if(y=0,(0|e)<1)break i;}for(k=0,D=n+260|0;v=t[D>>2]+k|0,Y=t[v+4>>2],N=k+y|0,R=N,t[R>>2]=t[v>>2],t[R+4>>2]=Y,v=v+8|0,Y=t[v+4>>2],N=R+8|0,t[N>>2]=t[v>>2],t[N+4>>2]=Y,k=k+16|0,e=e+-1|0,e;){}}e=n+260|0,k=t[e>>2],k&&(b[n+264|0]&&gA(k),t[n+260>>2]=0),t[e>>2]=y,a[n+264|0]=1,t[n+256>>2]=p,e=t[n+252>>2];}if(e=t[n+260>>2]+(e<<4)|0,t[e+12>>2]=0,C[e+8>>2]=I,C[e+4>>2]=u,C[e>>2]=d,t[n+252>>2]=t[n+252>>2]+1,u=C[t[A+56>>2]+784>>2],Ue(w,n+792|0,n+344|0,t[i+20>>2]),c=C[w+4>>2],l=C[w+8>>2],d=C[w+12>>2],I=B(B(B(c*c)+B(l*l))+B(d*d)),I>B(1.1920928955078125e-7)){if(t[n+340>>2]=0,Z=d,d=B(B(1)/I),C[n+336>>2]=Z*d,C[n+332>>2]=l*d,C[n+328>>2]=c*d,c=B(B(C[w+56>>2]-B(yf[t[t[W>>2]+48>>2]](W)))-B(yf[t[t[o>>2]+48>>2]](o))),e=A+36|0,k=t[e>>2],(0|k)<=-1)for(t[A+40>>2]<=-1&&(i=t[A+44>>2],i&&(b[A+48|0]&&gA(i),t[A+44>>2]=0),a[A+48|0]=1,i=A+40|0,t[i>>2]=0,t[i+4>>2]=0),R=k<<4,i=A+44|0;o=t[n+316>>2],w=t[i>>2]+R|0,y=w,t[y>>2]=t[n+312>>2],t[y+4>>2]=o,o=n+320|0,y=t[o+4>>2],w=w+8|0,t[w>>2]=t[o>>2],t[w+4>>2]=y,R=R+16|0,k=k+1|0,k;){}t[e>>2]=0,ze(n+328|0,t[W+56>>2],t[r+12>>2],n+248|0,A+32|0,B(c-u),u,f);}i:{if(b[A+52|0]&&(A=t[f+4>>2],t[A+780>>2])){if(r=t[A+772>>2],e=t[t[f+8>>2]+8>>2],(0|r)!=(0|e)){if(dr(A,t[t[f+12>>2]+8>>2]+4|0,e+4|0),f=t[n+260>>2],f)break i;break e;}dr(A,r+4|0,t[t[f+12>>2]+8>>2]+4|0);}if(f=t[n+260>>2],!f)break e;}b[n+264|0]&&gA(f),t[n+260>>2]=0;}return void(E=n+928|0);}return dr(A,t[t[f+12>>2]+8>>2]+4|0,e+4|0),void(E=n+928|0);}dr(A,r+4|0,t[t[f+12>>2]+8>>2]+4|0),E=n+928|0;},function(A,r,e,i,f){A|=0,r|=0,e|=0,i|=0,f|=0;var n,o,k,c,u,l,s,d=B(0),v=B(0),g=0,_=0;if(A=E-608|0,E=A,d=B(C[r+116>>2]-C[r+52>>2]),v=B(d*d),d=B(C[r+120>>2]-C[r+56>>2]),v=B(v+B(d*d)),d=B(C[r+124>>2]-C[r+60>>2]),v=B(v+B(d*d)),d=C[r+276>>2],v<B(d*d)&&(d=B(C[e+116>>2]-C[e+52>>2]),v=B(d*d),d=B(C[e+120>>2]-C[e+56>>2]),v=B(v+B(d*d)),d=B(C[e+124>>2]-C[e+60>>2]),v=B(v+B(d*d)),d=C[e+276>>2],v<B(d*d))||b[2768])return E=A+608|0,B(B(1));_=t[r+192>>2],g=t[e+272>>2],ZA(A+552|0),f=A+580|0,i=f,t[i>>2]=0,t[i+4>>2]=0,o=A+576|0,t[o>>2]=1065353216,k=A+596|0,t[k>>2]=0,n=A+588|0,i=n,t[i>>2]=0,t[i+4>>2]=0,t[A+568>>2]=1065353216,t[A+572>>2]=1065353216,t[A+556>>2]=8,t[A+552>>2]=9912,t[A+604>>2]=0,t[A+600>>2]=g,t[A+584>>2]=g,t[A+548>>2]=0,t[A+540>>2]=1566444395,t[A+544>>2]=0,t[A+376>>2]=16056,c=A+348|0,a[0|c]=0,t[A+324>>2]=953267991,i=Pe(A,_,A+552|0,A+16|0),u=r+4|0,l=r+68|0,g=e+4|0,_=e+68|0,v=B(1),Le(i,u,l,g,_,A+376|0)&&(d=C[A+540>>2],C[r+268>>2]>d&&(C[r+268>>2]=d),C[e+268>>2]>d&&(C[e+268>>2]=d),v=B(1),d<B(1)&&(v=d)),d=v,i=t[e+192>>2],s=t[r+272>>2],ZA(A+552|0),t[f>>2]=0,t[f+4>>2]=0,t[o>>2]=1065353216,t[k>>2]=0,t[n>>2]=0,t[n+4>>2]=0,t[A+568>>2]=1065353216,t[A+572>>2]=1065353216,t[A+556>>2]=8,t[A+552>>2]=9912,t[A+604>>2]=0,t[A+600>>2]=s,t[A+584>>2]=s,t[A+548>>2]=0,t[A+540>>2]=1566444395,t[A+544>>2]=0,t[A+376>>2]=16056,a[0|c]=0,t[A+324>>2]=953267991;A:if(Le(Pe(A,A+552|0,i,A+16|0),u,l,g,_,A+376|0)){r:{e:{v=C[A+540>>2];i:{if(!(C[r+268>>2]>v)){if(C[e+268>>2]>v)break i;break e;}if(C[r+268>>2]=v,!(C[e+268>>2]>v))break e;}if(C[e+268>>2]=v,d>v)break r;break A;}if(!(d>v))break A;}d=v;}return E=A+608|0,B(d);},function(A,r){A|=0,r|=0;var e=0,i=0,f=0,n=0,o=0,k=0;if(i=t[A+56>>2],!(!i|!b[A+52|0])){if(e=t[r+4>>2],(0|e)==t[r+8>>2]&&(n=e?e<<1:1,!((0|e)>=(0|n)))){A:{r:{if(n){if(o=CA(n<<2,16),e=t[r+4>>2],(0|e)>=1)break r;break A;}if((0|e)<1)break A;}for(i=0,k=r+12|0,f=e;t[i+o>>2]=t[t[k>>2]+i>>2],i=i+4|0,f=f+-1|0,f;){}}f=t[r+12>>2],f&&(b[r+16|0]&&(gA(f),e=t[r+4>>2]),t[r+12>>2]=0),t[r+12>>2]=o,a[r+16|0]=1,t[r+8>>2]=n,i=t[A+56>>2];}t[r+4>>2]=e+1,t[t[r+12>>2]+(e<<2)>>2]=i;}},Cr,Yr,Yr,qe,Cr,Yr,Yr,function(A,r,e,i){A|=0,r|=0,e|=0,i=B(i);var f,n,b,o=0,k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0);f=E-16|0,E=f,C[A+32>>2]=i,n=r+8|0,b=t[n+4>>2],o=A+16|0,t[o>>2]=t[n>>2],t[o+4>>2]=b,o=t[r+4>>2],t[A+8>>2]=t[r>>2],t[A+12>>2]=o,c=C[n>>2],u=C[e>>2],l=C[r>>2],s=C[e+4>>2],d=C[r+4>>2],v=C[e+8>>2],k=C[A+28>>2],i=B(B(k+C[A+24>>2])+i),C[A+32>>2]=i,t[f+12>>2]=0,C[f+8>>2]=v-B(k*c),C[f+4>>2]=s-B(k*d),C[f>>2]=u-B(l*k),i<B(0)&&(a[A+36|0]=1),A=t[A+4>>2],yf[t[t[A>>2]+16>>2]](A,r,f,i),E=f+16|0;},Cr,function(A,r,e,i){A|=0,r|=0,e|=0,i=B(i);var a,f=B(0),n=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=B(0),M=B(0);a=E-16|0,E=a,F=C[r+8>>2],w=C[e+8>>2],l=B(B(F*i)+w),Z=C[r+4>>2],W=C[e+4>>2],Y=B(B(Z*i)+W),N=C[r>>2],f=B(N*i),i=C[e>>2],V=B(f+i),b[A+232|0]?(g=C[A+40>>2],s=B(-C[A+88>>2]),_=C[A+56>>2],u=C[A+92>>2],c=C[A+72>>2],f=C[A+96>>2],h=B(B(B(g*s)-B(_*u))-B(c*f)),n=C[A+200>>2],m=C[A+44>>2],R=C[A+60>>2],d=C[A+76>>2],p=B(B(B(m*s)-B(R*u))-B(d*f)),o=C[A+204>>2],G=C[A+48>>2],k=B(G*s),s=C[A- -64>>2],k=B(k-B(s*u)),u=C[A+80>>2],y=B(k-B(u*f)),f=C[A+208>>2],k=B(B(B(B(B(h*n)+B(p*o))+B(y*f))+C[A+224>>2])+B(B(l*B(B(B(c*n)+B(d*o))+B(u*f)))+B(B(V*B(B(B(g*n)+B(m*o))+B(G*f)))+B(Y*B(B(B(_*n)+B(R*o))+B(s*f)))))),n=C[A+168>>2],o=C[A+172>>2],f=C[A+176>>2],n=B(B(B(l*B(B(B(c*n)+B(d*o))+B(u*f)))+B(B(V*B(B(B(g*n)+B(m*o))+B(G*f)))+B(Y*B(B(B(_*n)+B(R*o))+B(s*f)))))+B(B(B(B(n*h)+B(p*o))+B(y*f))+C[A+216>>2])),o=B(N*B(n-i)),f=l,i=C[A+184>>2],l=C[A+188>>2],d=B(B(c*i)+B(d*l)),c=C[A+192>>2],l=B(B(B(f*B(d+B(u*c)))+B(B(V*B(B(B(g*i)+B(m*l))+B(G*c)))+B(Y*B(B(B(_*i)+B(R*l))+B(s*c)))))+B(B(B(B(h*i)+B(p*l))+B(y*c))+C[A+220>>2])),i=B(B(o+B(Z*B(l-W)))+B(F*B(k-w))),C[a+8>>2]=k+B(F*i),C[a+4>>2]=l+B(Z*i),C[a>>2]=n+B(N*i)):(X=C[A+224>>2],g=C[A+208>>2],_=C[A+200>>2],c=C[A+204>>2],M=C[A+216>>2],n=C[A+176>>2],m=C[A+168>>2],R=C[A+172>>2],d=C[A+104>>2],k=B(-C[A+152>>2]),o=C[A+120>>2],Q=C[A+156>>2],G=C[A+136>>2],D=C[A+160>>2],s=B(B(B(d*k)-B(o*Q))-B(G*D)),u=C[A+108>>2],f=C[A+124>>2],h=C[A+140>>2],p=B(B(B(u*k)-B(f*Q))-B(h*D)),y=C[A+112>>2],v=B(y*k),k=C[A+128>>2],v=B(v-B(k*Q)),Q=C[A+144>>2],D=B(v-B(Q*D)),v=C[A+184>>2],I=C[A+188>>2],J=C[A+192>>2],v=B(B(B(w*B(B(B(G*v)+B(h*I))+B(Q*J)))+B(B(i*B(B(B(d*v)+B(u*I))+B(y*J)))+B(W*B(B(B(o*v)+B(f*I))+B(k*J)))))+B(B(B(B(s*v)+B(p*I))+B(D*J))+C[A+220>>2])),C[a+4>>2]=v,n=B(B(B(w*B(B(B(G*m)+B(h*R))+B(Q*n)))+B(B(i*B(B(B(d*m)+B(u*R))+B(y*n)))+B(W*B(B(B(o*m)+B(f*R))+B(k*n)))))+B(M+B(B(B(m*s)+B(p*R))+B(D*n)))),C[a>>2]=n,i=B(B(X+B(B(B(s*_)+B(p*c))+B(D*g)))+B(B(w*B(B(B(G*_)+B(h*c))+B(Q*g)))+B(B(i*B(B(B(d*_)+B(u*c))+B(y*g)))+B(W*B(B(B(o*_)+B(f*c))+B(k*g)))))),C[a+8>>2]=i,i=B(B(B(N*B(V-n))+B(Z*B(Y-v)))+B(F*B(l-i)))),t[a+12>>2]=0,A=t[A+36>>2],yf[t[t[A>>2]+16>>2]](A,r,a,i),E=a+16|0;},WA,he,Yr,sA,Cr,Ae,function(){},Cr,ei,function(A){A|=0;var r,e,i=0;return t[A+8>>2]=16212,t[A>>2]=16184,i=A+56|0,r=t[i>>2],e=A+72|0,yf[t[t[r>>2]+20>>2]](r,t[e>>2]),i=t[i>>2],yf[t[t[i>>2]+16>>2]](i,t[e>>2]),0|A;},function(A){A|=0;var r,e,i=0;t[A+8>>2]=16212,t[A>>2]=16184,i=A+56|0,r=t[i>>2],e=A+72|0,yf[t[t[r>>2]+20>>2]](r,t[e>>2]),i=t[i>>2],yf[t[t[i>>2]+16>>2]](i,t[e>>2]),gA(A);},function(A,r,e,i,a){A|=0,r|=0,e|=0,i|=0,a|=0;var f,n,o,k=0,c=B(0);n=E-16|0,E=n,$e(n+8|0,16266),k=b[A+76|0],o=k?r:e,f=t[o+4>>2],t[f+4>>2]+-21>>>0>8||(r=k?e:r,t[t[r+4>>2]+4>>2]>19||(c=B(yf[t[t[f>>2]+48>>2]](f)),e=A+72|0,t[a+4>>2]=t[e>>2],k=A+8|0,function(A,r,e,i,a,f){var n,b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0);n=E+-64|0,E=n,C[A+56>>2]=r,t[A+52>>2]=e,t[A+40>>2]=a,t[A+36>>2]=i,t[A+44>>2]=f,e=t[a+12>>2],_=C[e+52>>2],m=C[e+56>>2],a=t[i+12>>2],R=C[a+52>>2],G=C[a+56>>2],b=C[e+20>>2],o=C[e+36>>2],h=C[a+20>>2],y=C[a+36>>2],Q=C[a+24>>2],k=C[e+24>>2],p=C[a+40>>2],c=C[e+40>>2],D=C[a+32>>2],u=C[e+32>>2],w=C[a>>2],l=C[e>>2],W=C[a+16>>2],s=C[e+16>>2],d=C[e+48>>2],F=C[a+48>>2],v=C[e+4>>2],Z=C[a+4>>2],Y=C[a+8>>2],g=C[e+8>>2],t[n+60>>2]=0,t[n+44>>2]=0,t[n+28>>2]=0,C[n+40>>2]=B(B(g*Y)+B(k*Q))+B(c*p),C[n+36>>2]=B(B(g*Z)+B(k*h))+B(c*y),C[n+24>>2]=B(B(v*Y)+B(b*Q))+B(o*p),C[n+20>>2]=B(B(v*Z)+B(b*h))+B(o*y),d=B(-d),C[n+56>>2]=B(B(B(g*d)-B(k*_))-B(c*m))+B(B(B(g*F)+B(k*R))+B(c*G)),C[n+52>>2]=B(B(B(v*d)-B(b*_))-B(o*m))+B(B(B(v*F)+B(b*R))+B(o*G)),t[n+12>>2]=0,C[n>>2]=B(B(l*w)+B(s*W))+B(u*D),C[n+32>>2]=B(B(g*w)+B(k*W))+B(c*D),C[n+16>>2]=B(B(v*w)+B(b*W))+B(o*D),C[n+8>>2]=B(B(l*Y)+B(s*Q))+B(u*p),C[n+4>>2]=B(B(l*Z)+B(s*h))+B(u*y),C[n+48>>2]=B(B(B(l*d)-B(s*_))-B(u*m))+B(B(B(l*F)+B(s*R))+B(u*G)),e=t[i+4>>2],yf[t[t[e>>2]+8>>2]](e,n,A+4|0,A+20|0),r=B(C[f+32>>2]+r),C[A+20>>2]=r+C[A+20>>2],e=A+24|0,C[e>>2]=r+C[e>>2],e=A+28|0,C[e>>2]=r+C[e>>2],C[A+4>>2]=C[A+4>>2]-r,e=A+8|0,C[e>>2]=C[e>>2]-r,A=A+12|0,C[A>>2]=C[A>>2]-r,E=n- -64|0;}(k,c,i,r,o,a),e=t[e>>2],t[e+776>>2]=t[o+8>>2],t[e+772>>2]=t[r+8>>2],yf[t[t[f>>2]+64>>2]](f,k,A+12|0,A+28|0),r=t[a+4>>2],t[r+780>>2]&&(e=t[r+772>>2],i=t[t[a+8>>2]+8>>2],(0|e)==(0|i)?dr(r,e+4|0,t[t[a+12>>2]+8>>2]+4|0):dr(r,t[t[a+12>>2]+8>>2]+4|0,i+4|0)),A=A+44|0,t[A>>2]=0,t[A+4>>2]=0)),Ai(),E=n+16|0;},function(A,r,e,i,a){A|=0,r|=0,e|=0,i|=0,a|=0;var f=B(0),n=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=B(0),M=B(0),x=B(0),S=B(0),T=B(0),U=B(0),j=B(0),O=B(0),H=B(0),z=B(0),P=B(0),L=0,K=0,q=0,$=0,AA=0,rA=0,eA=B(0);i=E-240|0,E=i,o=B(1);A:{if(a=b[A+76|0],A=a?e:r,L=A+116|0,K=A+52|0,n=B(C[L>>2]-C[K>>2]),f=B(n*n),q=A+120|0,$=A+56|0,n=B(C[q>>2]-C[$>>2]),f=B(f+B(n*n)),AA=A+124|0,rA=A+60|0,n=B(C[AA>>2]-C[rA>>2]),f=B(f+B(n*n)),n=C[A+276>>2],!(f<B(n*n)||(r=a?r:e,e=t[r+192>>2],t[e+4>>2]+-21>>>0>8))){if(d=C[r+12>>2],Q=C[L>>2],v=C[r+28>>2],f=C[q>>2],g=C[r+44>>2],p=C[AA>>2],eA=B(B(B(d*Q)+B(v*f))+B(g*p)),_=C[r+8>>2],k=B(-C[r+52>>2]),m=C[r+24>>2],D=C[r+56>>2],R=C[r+40>>2],l=C[r+60>>2],s=B(B(B(_*k)-B(m*D))-B(R*l)),n=B(s+B(B(B(_*Q)+B(m*f))+B(R*p))),G=C[r+36>>2],h=C[r+20>>2],y=C[r+4>>2],o=C[$>>2],c=C[K>>2],u=C[rA>>2],F=C[A+92>>2],Z=C[A+76>>2],Y=C[A+108>>2],N=C[A+88>>2],V=C[A+72>>2],I=C[A+104>>2],J=C[A+100>>2],X=C[A+84>>2],M=C[A+68>>2],x=C[A+28>>2],S=C[A+12>>2],T=C[A+44>>2],U=C[A+24>>2],j=C[A+8>>2],O=C[A+40>>2],H=C[A+36>>2],z=C[A+20>>2],P=C[A+4>>2],t[i+236>>2]=0,W=B(B(B(d*k)-B(v*D))-B(g*l)),w=B(W+B(B(B(d*c)+B(v*o))+B(g*u))),C[i+232>>2]=w,s=B(s+B(B(B(_*c)+B(m*o))+B(R*u))),C[i+228>>2]=s,l=B(B(B(y*k)-B(h*D))-B(G*l)),k=B(l+B(B(B(y*c)+B(h*o))+B(G*u))),C[i+224>>2]=k,D=k,c=B(l+B(B(B(y*Q)+B(h*f))+B(G*p))),c<k&&(C[i+224>>2]=c,D=c),Q=s,n<s&&(C[i+228>>2]=n,Q=n),u=B(W+eA),f=w,u<f&&(C[i+232>>2]=u,f=u),t[i+220>>2]=0,C[i+216>>2]=w,C[i+212>>2]=s,C[i+208>>2]=k,o=k,k<c&&(C[i+208>>2]=c,o=c),p=s,s<n&&(C[i+212>>2]=n,p=n),l=w,l<u&&(C[i+216>>2]=u,l=u),W=f,f=C[A+272>>2],C[i+232>>2]=W-f,C[i+216>>2]=f+l,C[i+228>>2]=Q-f,C[i+224>>2]=D-f,C[i+212>>2]=f+p,C[i+208>>2]=f+o,t[i+128>>2]=0,C[i+124>>2]=u,C[i+120>>2]=n,C[i+116>>2]=c,t[i+112>>2]=0,C[i+108>>2]=B(B(d*Z)+B(v*F))+B(g*Y),C[i+104>>2]=B(B(d*V)+B(v*N))+B(g*I),C[i+100>>2]=B(B(d*M)+B(v*X))+B(g*J),t[i+96>>2]=0,C[i+92>>2]=B(B(_*Z)+B(m*F))+B(R*Y),C[i+88>>2]=B(B(_*V)+B(m*N))+B(R*I),C[i+84>>2]=B(B(_*M)+B(m*X))+B(R*J),t[i+80>>2]=0,C[i+76>>2]=B(B(y*Z)+B(h*F))+B(G*Y),C[i+72>>2]=B(B(y*V)+B(h*N))+B(G*I),t[i- -64>>2]=0,C[i+60>>2]=w,C[i+56>>2]=s,C[i+52>>2]=k,t[i+48>>2]=0,C[i+44>>2]=B(B(d*S)+B(v*x))+B(g*T),C[i+40>>2]=B(B(d*j)+B(v*U))+B(g*O),C[i+36>>2]=B(B(d*P)+B(v*z))+B(g*H),t[i+32>>2]=0,C[i+28>>2]=B(B(_*S)+B(m*x))+B(R*T),C[i+24>>2]=B(B(_*j)+B(m*U))+B(R*O),C[i+20>>2]=B(B(_*P)+B(m*z))+B(R*H),t[i+16>>2]=0,C[i+12>>2]=B(B(y*S)+B(h*x))+B(G*T),C[i+8>>2]=B(B(y*j)+B(h*U))+B(G*O),C[i+196>>2]=f,C[i+68>>2]=B(B(y*M)+B(h*X))+B(G*J),C[i+4>>2]=B(B(y*P)+B(h*z))+B(G*H),t[i>>2]=16552,t[i+200>>2]=t[A+268>>2],!e)break A;if(yf[t[t[e>>2]+64>>2]](e,i,i+224|0,i+208|0),o=C[i+200>>2],A=A+268|0,!(o<C[A>>2]))break A;C[A>>2]=o;}return E=i+240|0,B(o);}return E=i+240|0,B(B(1));},function(A,r){A|=0,r|=0;var e=0,i=0,f=0,n=0,o=0,k=0;if(i=t[A+72>>2],i){if(e=t[r+4>>2],(0|e)==t[r+8>>2]&&(n=e?e<<1:1,!((0|e)>=(0|n)))){A:{r:{if(n){if(o=CA(n<<2,16),e=t[r+4>>2],(0|e)>=1)break r;break A;}if((0|e)<1)break A;}for(i=0,k=r+12|0,f=e;t[i+o>>2]=t[t[k>>2]+i>>2],i=i+4|0,f=f+-1|0,f;){}}f=t[r+12>>2],f&&(b[r+16|0]&&(gA(f),e=t[r+4>>2]),t[r+12>>2]=0),t[r+12>>2]=o,a[r+16|0]=1,t[r+8>>2]=n,i=t[A+72>>2];}t[r+4>>2]=e+1,t[t[r+12>>2]+(e<<2)>>2]=i;}},function(A){A|=0;var r=0;return t[A>>2]=16212,r=t[A+48>>2],yf[t[t[r>>2]+20>>2]](r,t[A+64>>2]),r=t[A+48>>2],yf[t[t[r>>2]+16>>2]](r,t[A+64>>2]),0|A;},function(A){A|=0;var r=0;t[A>>2]=16212,r=t[A+48>>2],yf[t[t[r>>2]+20>>2]](r,t[A+64>>2]),r=t[A+48>>2],yf[t[t[r>>2]+16>>2]](r,t[A+64>>2]),gA(A);},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f=0,n=0,b=B(0),o=0,k=B(0),c=B(0),u=B(0),l=0,s=0;a=E-144|0,E=a,$e(a+136|0,16224),b=C[r>>2],k=C[r+16>>2],u=b<k?b:k,c=C[r+32>>2],(u<c?u:c)>C[A+20>>2]||(f=(b>k^1)<<4,C[(C[r+f>>2]>c?f:32)+r>>2]<C[A+4>>2]||(b=C[r+8>>2],f=r+24|0,k=C[f>>2],u=b<k?b:k,o=r+40|0,c=C[o>>2],(u<c?u:c)>C[A+28>>2]||(f=b>k?r+8|0:f,C[(C[f>>2]>c?f:o)>>2]<C[A+12>>2]||(b=C[r+4>>2],f=r+20|0,k=C[f>>2],u=b<k?b:k,o=r+36|0,c=C[o>>2],(u<c?u:c)>C[A+24>>2]||(f=b>k?r+4|0:f,t[t[t[A+36>>2]+4>>2]+4>>2]>19|C[(C[f>>2]>c?f:o)>>2]<C[A+8>>2]||(o=t[A+48>>2],s=LA(a+24|0),n=r+8|0,l=t[n+4>>2],f=a+92|0,t[f>>2]=t[n>>2],t[f+4>>2]=l,n=t[r+20>>2],f=a+100|0,t[f>>2]=t[r+16>>2],t[f+4>>2]=n,n=r+24|0,l=t[n+4>>2],f=a+108|0,t[f>>2]=t[n>>2],t[f+4>>2]=l,n=t[r+36>>2],f=a+116|0,t[f>>2]=t[r+32>>2],t[f+4>>2]=n,n=r+40|0,l=t[n+4>>2],f=a+124|0,t[f>>2]=t[n>>2],t[f+4>>2]=l,t[a+24>>2]=16416,f=t[r+4>>2],t[a+84>>2]=t[r>>2],t[a+88>>2]=f,t[a+72>>2]=t[A+56>>2],t[a+28>>2]=1,t[a+20>>2]=i,t[a+16>>2]=e,r=t[A+40>>2],t[a>>2]=r,f=t[r+8>>2],t[a+12>>2]=t[r+12>>2],t[a+8>>2]=f,b=C[t[A+44>>2]+32>>2],r=t[A+36>>2],t[a+4>>2]=a+24,r=b>B(0)?0|yf[t[t[o>>2]+8>>2]](o,r,a,0,2):0|yf[t[t[o>>2]+8>>2]](o,r,a,t[A+64>>2],1),f=t[A+44>>2],n=t[f+8>>2],t[n+8>>2]==t[t[A+40>>2]+8>>2]?(t[f+8>>2]=a,yf[t[t[f>>2]+8>>2]](f,e,i)):(n=t[f+12>>2],t[f+12>>2]=a,yf[t[t[f>>2]+12>>2]](f,e,i)),e=A+44|0,yf[t[t[r>>2]+8>>2]](r,t[A+36>>2],a,t[A+52>>2],t[e>>2]),e=t[e>>2],t[(t[t[e+8>>2]+8>>2]==t[t[A+40>>2]+8>>2]?8:12)+e>>2]=n,yf[t[t[r>>2]>>2]](r),yf[t[t[o>>2]+60>>2]](o,r),er(s))))))),Ai(),E=a+144|0;},cr,rr,Cr,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var f=0,n=0,b=0,o=B(0);e=E-800|0,E=e,$e(e+792|0,16736),i=e+740|0,t[i>>2]=0,t[i+4>>2]=0,t[e+748>>2]=1065353216,i=e+752|0,t[i>>2]=0,t[i+4>>2]=0,t[e+768>>2]=1065353216,t[e+788>>2]=0,i=e+780|0,t[i>>2]=0,t[i+4>>2]=0,i=e+772|0,t[i>>2]=0,t[i+4>>2]=0,t[e+732>>2]=0,t[e+736>>2]=0,t[e+728>>2]=1065353216,t[e+760>>2]=0,t[e+764>>2]=0,t[e+720>>2]=0,t[e+724>>2]=0,t[e+552>>2]=16056,t[e+716>>2]=t[A+200>>2],i=t[A+196>>2],ZA(e+496|0),f=e+524|0,t[f>>2]=0,t[f+4>>2]=0,t[e+520>>2]=1065353216,t[e+540>>2]=0,f=e+532|0,t[f>>2]=0,t[f+4>>2]=0,t[e+512>>2]=1065353216,t[e+516>>2]=1065353216,t[e+496>>2]=9912,t[e+548>>2]=0,t[e+544>>2]=i,t[e+528>>2]=i,t[e+500>>2]=8,i=LA(e+384|0),f=r+8|0,n=t[f+4>>2],b=e+452|0,t[b>>2]=t[f>>2],t[b+4>>2]=n,f=t[r+20>>2],n=e+460|0,t[n>>2]=t[r+16>>2],t[n+4>>2]=f,f=r+24|0,n=t[f+4>>2],b=e+468|0,t[b>>2]=t[f>>2],t[b+4>>2]=n,f=t[r+36>>2],n=e+476|0,t[n>>2]=t[r+32>>2],t[n+4>>2]=f,f=r+40|0,n=t[f+4>>2],b=e+484|0,t[b>>2]=t[f>>2],t[b+4>>2]=n,t[e+388>>2]=1,t[e+384>>2]=16416,f=t[r+4>>2],t[e+444>>2]=t[r>>2],t[e+448>>2]=f,a[e+356|0]=0,t[e+332>>2]=953267991,ei(ri(e+8|0,e+496|0,e+384|0,e+24|0),A+4|0,A+68|0,e+728|0,e+728|0,e+552|0)&&(A=A+200|0,o=C[e+716>>2],C[A>>2]>o&&(C[A>>2]=o)),er(i),Ai(),E=e+800|0;},ni,function(A){A|=0,rA(ni(A));},ti,function(A,r,e,i,a){A|=0,r|=0,e|=0,i|=0,a|=0;var f=0,n=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=0,m=B(0),R=0,G=0,h=0,y=0,Q=0,p=0,D=0,w=0,W=0,F=0,Z=0,Y=0,E=0,N=0,V=0,I=0,J=B(0),X=B(0),M=B(0),x=B(0),S=B(0),T=B(0),U=B(0),j=B(0),O=B(0),H=B(0),z=B(0),P=B(0),L=B(0),K=B(0),q=0,$=0,AA=0,rA=0,eA=0,iA=0,aA=0,fA=0;if(_=t[A+52>>2],(0|_)>=1){for(f=b[A+68|0],AA=f?r:e,f=f?e:r,R=f- -64|0,rA=t[R>>2],G=f+60|0,P=C[G>>2],h=f+56|0,L=C[h>>2],y=f+52|0,K=C[y>>2],Q=f+48|0,eA=t[Q>>2],p=f+44|0,o=C[p>>2],D=f+40|0,k=C[D>>2],w=f+36|0,c=C[w>>2],e=32,W=f+32|0,iA=t[W>>2],F=f+28|0,u=C[F>>2],Z=f+24|0,l=C[Z>>2],Y=f+20|0,s=C[Y>>2],E=f+16|0,aA=t[E>>2],N=f+12|0,d=C[N>>2],V=f+8|0,v=C[V>>2],r=t[f+304>>2],g=C[f+4>>2],m=B(1),I=f+304|0,fA=t[f+192>>2]+28|0;t[I>>2]=r+1,r=t[fA>>2]+e|0,n=C[r+24>>2],J=C[r+16>>2],X=C[r+20>>2],M=C[r>>2],x=C[r+-32>>2],S=C[r+-16>>2],T=C[r+4>>2],U=C[r+-28>>2],j=C[r+-12>>2],O=C[r+8>>2],H=C[r+-24>>2],z=C[r+-8>>2],t[R>>2]=0,t[Q>>2]=0,t[W>>2]=0,t[E>>2]=0,C[p>>2]=B(B(c*H)+B(k*z))+B(o*O),C[D>>2]=B(B(c*U)+B(k*j))+B(o*T),C[w>>2]=B(B(c*x)+B(k*S))+B(o*M),C[F>>2]=B(B(s*H)+B(l*z))+B(u*O),C[Z>>2]=B(B(s*U)+B(l*j))+B(u*T),C[Y>>2]=B(B(s*x)+B(l*S))+B(u*M),C[N>>2]=B(B(g*H)+B(v*z))+B(d*O),C[V>>2]=B(B(g*U)+B(v*j))+B(d*T),r=f+4|0,C[r>>2]=B(B(g*x)+B(v*S))+B(d*M),C[G>>2]=P+B(B(B(c*J)+B(k*X))+B(o*n)),C[h>>2]=L+B(B(B(s*J)+B(l*X))+B(u*n)),C[y>>2]=K+B(B(B(g*J)+B(v*X))+B(d*n)),$=t[t[A+60>>2]+q>>2],n=B(yf[t[t[$>>2]+12>>2]]($,f,AA,i,a)),t[R>>2]=rA,C[G>>2]=P,C[h>>2]=L,C[y>>2]=K,t[Q>>2]=eA,C[p>>2]=o,C[D>>2]=k,C[w>>2]=c,t[W>>2]=iA,C[F>>2]=u,C[Z>>2]=l,C[Y>>2]=s,t[E>>2]=aA,C[N>>2]=d,C[V>>2]=v,C[r>>2]=g,r=t[I>>2]+1|0,t[I>>2]=r,m=n<m?n:m,e=e+80|0,q=q+4|0,_=_+-1|0,_;){}return B(m);}return B(B(1));},function(A,r){A|=0,r|=0;var e,i=0,a=0,f=0,n=0;if(e=A+52|0,i=t[e>>2],(0|i)>=1)for(n=A+60|0,A=0;a=t[t[n>>2]+f>>2],a&&(yf[t[t[a>>2]+16>>2]](a,r),i=t[e>>2]),f=f+4|0,A=A+1|0,(0|A)<(0|i);){}},sA,Cr,Yr,function(A,r){var e,i;A|=0,r|=0,e=A,i=t[t[t[A+4>>2]+4>>2]+28>>2],A=t[r+36>>2],bi(e,t[64+(i+_(A,80)|0)>>2],A);},function(A,r,e){A|=0,r|=0,e=B(e),yf[t[t[A>>2]+12>>2]](A,r);},le,le,function(A){A|=0;var r=0,e=0;return t[A>>2]=16908,r=A+56|0,e=t[r>>2],e&&(b[A+60|0]&&gA(e),t[A+56>>2]=0),t[r>>2]=0,a[A+60|0]=1,r=A+48|0,t[r>>2]=0,t[r+4>>2]=0,r=A+36|0,e=t[r>>2],e&&(b[A+40|0]&&gA(e),t[A+36>>2]=0),t[r>>2]=0,a[A+40|0]=1,r=A+28|0,t[r>>2]=0,t[r+4>>2]=0,r=A+16|0,e=t[r>>2],e&&(b[A+20|0]&&gA(e),t[A+16>>2]=0),t[r>>2]=0,a[A+20|0]=1,r=A+8|0,t[r>>2]=0,t[r+4>>2]=0,0|A;},function(A){A|=0;var r=0,e=0;t[A>>2]=16908,r=A+56|0,e=t[r>>2],e&&(b[A+60|0]&&gA(e),t[A+56>>2]=0),t[r>>2]=0,a[A+60|0]=1,r=A+48|0,t[r>>2]=0,t[r+4>>2]=0,r=A+36|0,e=t[r>>2],e&&(b[A+40|0]&&gA(e),t[A+36>>2]=0),t[r>>2]=0,a[A+40|0]=1,r=A+28|0,t[r>>2]=0,t[r+4>>2]=0,r=t[A+16>>2],!r|!b[A+20|0]||gA(r),rA(A);},function(A,r,e){A|=0,r|=0,e|=0;var i=0,a=0,f=0,n=0,b=0,o=0,k=0,c=0;t[694]=t[694]+1,o=t[A+36>>2],i=e<<16|r,i=(i<<15^-1)+i|0,i=_(i>>>10^i,9),i^=i>>>6,i=(i<<11^-1)+i|0,k=o+((t[A+12>>2]+-1&(i>>>16^i))<<2)|0,i=t[k>>2];A:if(-1!=(0|i)){for(n=t[A+16>>2],f=A+56|0,a=i;;){if(b=n+_(a,12)|0,t[b+4>>2]!=(0|e)||(0|r)!=t[b>>2]){if(a=t[t[f>>2]+(a<<2)>>2],-1!=(0|a))continue;break A;}break;}if(b){f=t[A+56>>2],r=_(a,12),c=t[8+(r+n|0)>>2];r:{if(a=(0|r)/12|0,(0|i)!=(0|a)){for(;r=i,i=t[f+(r<<2)>>2],(0|a)!=(0|i);){}if(i=t[f+(a<<2)>>2],-1!=(0|r)){t[f+(r<<2)>>2]=i;break r;}}else i=t[f+(a<<2)>>2];t[k>>2]=i;}if(r=A+8|0,i=t[r>>2]+-1|0,(0|a)==(0|i))return t[r>>2]=a,0|c;r:{if(n=n+_(i,12)|0,r=t[n+4>>2]<<16|t[n>>2],r=(r<<15^-1)+r|0,r=_(r>>>10^r,9),r^=r>>>6,r=(r<<11^-1)+r|0,k=t[A+12>>2]+-1&(r>>>16^r),o=o+(k<<2)|0,r=t[o>>2],(0|r)!=(0|i)){for(;e=r,r=t[f+(r<<2)>>2],(0|i)!=(0|r);){}if(r=t[f+(i<<2)>>2],-1!=(0|e)){t[f+(e<<2)>>2]=r;break r;}}else r=t[f+(i<<2)>>2];t[o>>2]=r;}r=t[n+4>>2],t[b>>2]=t[n>>2],t[b+4>>2]=r,t[b+8>>2]=t[n+8>>2],r=t[A+36>>2]+(k<<2)|0,t[t[A+56>>2]+(a<<2)>>2]=t[r>>2],t[r>>2]=a,A=A+8|0,t[A>>2]=t[A>>2]+-1;}}return 0|c;},function(A,r,e){return A|=0,r|=0,e|=0,t[695]=t[695]+1,0|function(A,r,e){var i=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0;A:if(i=e<<16|r,i=(i<<15^-1)+i|0,i=_(i>>>10^i,9),i^=i>>>6,i=(i<<11^-1)+i|0,C=i>>>16^i,i=t[A+12>>2],l=C&i+-1,f=t[t[A+36>>2]+(l<<2)>>2],-1!=(0|f)){for(s=t[A+16>>2],n=A+56|0;;){if(o=s+_(f,12)|0,t[o+4>>2]!=(0|e)||(0|r)!=t[o>>2]){if(f=t[t[n>>2]+(f<<2)>>2],-1!=(0|f))continue;break A;}break;}if(o)return o;}A:{r:{e:{i:{if(n=A+8|0,k=t[n>>2],f=k,(0|i)==(0|f)){if(u=i?i<<1:1,o=(0|i)>=(0|u),!o){if(!u)break i;if(c=CA(_(u,12),16),i=t[A+8>>2],(0|i)>=1)break e;break r;}f=i;}t[n>>2]=f+1,c=t[A+16>>2],f=c+_(k,12)|0;break A;}if((0|i)<1)break r;}for(f=0,s=A+16|0;d=t[s>>2]+f|0,n=t[d+4>>2],v=f+c|0,t[v>>2]=t[d>>2],t[v+4>>2]=n,t[v+8>>2]=t[d+8>>2],f=f+12|0,i=i+-1|0,i;){}}f=A+16|0,i=t[f>>2],i&&(b[A+20|0]&&gA(i),t[A+16>>2]=0),t[f>>2]=c,a[A+20|0]=1,n=A+12|0,t[n>>2]=u,i=A+8|0,t[i>>2]=t[i>>2]+1,f=_(k,12)+c|0,o||(oi(A),l=t[n>>2]+-1&C);}return t[f>>2]=r,r=_(k,12)+c|0,t[r+8>>2]=0,t[r+4>>2]=e,r=t[A+56>>2]+(k<<2)|0,A=t[A+36>>2]+(l<<2)|0,t[r>>2]=t[A>>2],t[A>>2]=k,f;}(A,r,e);},ci,li,function(A){A|=0,rA(li(A));},function(A,r,e,i,f){A|=0,r|=0,e|=0,i|=0,f|=0;var n,o=0,k=0,c=0,u=0,l=0,s=B(0),d=0,v=B(0),g=B(0),R=B(0),G=B(0),h=B(0),y=0,Q=0,p=B(0),D=0,w=B(0),W=B(0),F=0,Z=B(0),Y=0,N=0,V=B(0),I=B(0),J=B(0),X=B(0),M=B(0),x=B(0),S=B(0),T=B(0),U=B(0),j=B(0),O=B(0),H=B(0),z=B(0),P=0,L=0,K=0,q=B(0),$=0,AA=0,rA=B(0),eA=0,iA=0,aA=B(0),fA=0,nA=0,tA=0,bA=0,oA=0,kA=0,cA=0,uA=0,lA=0,sA=0,dA=0,vA=0,_A=0,BA=0,mA=0,RA=0,GA=0,hA=0,yA=0,QA=0,pA=0,DA=0,wA=0,WA=0,FA=0,ZA=0,YA=0,EA=B(0),NA=B(0),VA=B(0),IA=B(0),JA=B(0),XA=B(0),MA=B(0),xA=B(0),SA=B(0),TA=0,UA=0,jA=0,OA=0,HA=0,zA=0,PA=0,LA=0,KA=0,qA=0,$A=0,Ar=0,rr=0,er=0,ir=0,ar=0,fr=0,nr=0,tr=0,br=0,or=0,kr=0,cr=0,lr=0,sr=0,vr=0,Cr=B(0),gr=B(0),_r=B(0),Br=B(0),mr=B(0),Rr=B(0),Gr=B(0),hr=B(0),yr=B(0),Qr=B(0),pr=B(0),Dr=B(0),wr=0,Wr=0,Fr=0,Zr=0,Yr=0,Er=0,Nr=0,Vr=0,Ir=0,Jr=B(0);n=E-3328|0,E=n;A:{r:{e:{if(dA=t[r+4>>2],wA=t[dA+68>>2],wA&&(vA=t[e+4>>2],WA=t[vA+68>>2],WA)){if(t[vA+72>>2]!=t[A+112>>2]||t[dA+72>>2]!=t[A+108>>2]){if(k=8,c=t[A+84>>2],l=t[c+8>>2],(0|l)>=1){for(c=c+16|0,d=A+4|0;o=t[t[c>>2]+k>>2],o&&(yf[t[t[o>>2]>>2]](o),y=t[d>>2],yf[t[t[y>>2]+60>>2]](y,o)),k=k+12|0,l=l+-1|0,l;){}c=t[A+84>>2];}ki(c),t[A+108>>2]=t[dA+72>>2],t[A+112>>2]=t[vA+72>>2];}if(t[n+84>>2]=0,a[n+88|0]=1,t[n+76>>2]=0,t[n+80>>2]=0,ur(n+112|0),ur(n+916|0),ur(n+1720|0),ur(n+2524|0),o=t[n+84>>2],o&&(b[n+88|0]&&gA(o),t[n+84>>2]=0),mA=n+88|0,a[0|mA]=0,t[n+76>>2]=0,t[n+80>>2]=4,eA=n+84|0,t[eA>>2]=n+112,o=t[A+84>>2],FA=o+8|0,RA=t[FA>>2],(0|RA)<=0)break e;lr=o+16|0,iA=1,N=4,sr=f+8|0,ZA=-1,vr=2;break r;}return ti(A,r,e,i,f),void(E=n+3328|0);}if(GA=n+112|0,k=1,!b[n+88|0])break A;k=0;break A;}k=2;}for(;;){A:{r:{e:{i:{a:{f:{n:{t:{b:{o:{k:{c:{u:{l:{s:{d:{v:{C:{g:{_:{switch(0|k){case 0:gA(GA),k=1;continue;case 1:t[n+84>>2]=0;break _;}B:switch(0|D){case 1:break g;case 0:break B;default:break v;}if(o=t[8+(t[lr>>2]+_(hA,12)|0)>>2],o){if(yf[t[t[o>>2]+16>>2]](o,n+72|0),c=t[n+76>>2],(0|c)>=(0|iA))for(k=0,l=0;o=t[t[eA>>2]+k>>2],t[o+780>>2]&&(c=f+N|0,t[c>>2]=o,d=t[o+772>>2],y=t[t[sr>>2]+8>>2],(0|d)==(0|y)?dr(o,d+N|0,t[t[f+12>>2]+8>>2]+N|0):dr(o,t[t[f+12>>2]+8>>2]+N|0,y+N|0),t[c>>2]=0,c=t[n+76>>2]),k=k+N|0,l=l+iA|0,(0|l)<(0|c);){}if((0|c)<=(0|ZA))for(o=n+80|0,t[o>>2]<=(0|ZA)&&(k=t[eA>>2],k&&(b[0|mA]&&gA(k),t[eA>>2]=0),a[0|mA]=iA,t[o>>2]=0,t[o+4>>2]=0),k=c<<vr;t[t[eA>>2]+k>>2]=0,k=k+N|0,c=c+iA|0,c;){}t[n+76>>2]=0,RA=t[FA>>2];}if(hA=iA+hA|0,(0|hA)<(0|RA))break s;if(GA=t[n+84>>2],GA){if(!b[n+88|0])break b;k=0;continue;}}if(t[n+92>>2]=i,t[n+76>>2]=0,t[n+72>>2]=17052,t[n+88>>2]=t[A+4>>2],t[n+104>>2]=t[A+72>>2],YA=A+84|0,t[n+100>>2]=t[YA>>2],t[n+84>>2]=e,o=t[e+12>>2],Z=C[o+56>>2],t[n+80>>2]=r,k=t[r+12>>2],s=C[k+40>>2],V=C[o+52>>2],v=C[k+24>>2],I=C[o+48>>2],p=C[k+8>>2],J=C[k+56>>2],X=C[k+52>>2],aA=C[k+48>>2],g=C[k+36>>2],R=C[k+20>>2],G=C[k+4>>2],M=C[o+40>>2],x=C[o+24>>2],S=C[o+8>>2],T=C[o+36>>2],U=C[o+20>>2],j=C[o+4>>2],h=C[k>>2],w=C[k+16>>2],W=C[k+32>>2],O=C[o+16>>2],z=C[o>>2],q=C[o+32>>2],t[n+96>>2]=f,o=t[wA>>2],!o)break C;if(k=t[WA>>2],!k)break C;H=B(-aA),Cr=B(B(B(B(p*H)-B(v*X))-B(s*J))+B(B(B(p*I)+B(v*V))+B(s*Z))),gr=B(B(B(B(G*H)-B(R*X))-B(g*J))+B(B(B(G*I)+B(R*V))+B(g*Z))),_r=B(B(B(B(h*H)-B(w*X))-B(W*J))+B(B(B(h*I)+B(w*V))+B(W*Z))),H=C[f+32>>2],t[n+116>>2]=k,t[n+112>>2]=o,EA=B(B(B(p*S)+B(v*x))+B(s*M)),Br=B(m(EA)),NA=B(B(B(p*j)+B(v*U))+B(s*T)),mr=B(m(NA)),VA=B(B(B(p*z)+B(v*O))+B(s*q)),Rr=B(m(VA)),IA=B(B(B(G*S)+B(R*x))+B(g*M)),Gr=B(m(IA)),JA=B(B(B(G*j)+B(R*U))+B(g*T)),hr=B(m(JA)),XA=B(B(B(G*z)+B(R*O))+B(g*q)),yr=B(m(XA)),MA=B(B(B(h*S)+B(w*x))+B(W*M)),Qr=B(m(MA)),xA=B(B(B(h*j)+B(w*U))+B(W*T)),pr=B(m(xA)),SA=B(B(B(h*z)+B(w*O))+B(W*q)),Dr=B(m(SA)),P=1,TA=124,F=0,Q=128,u=n+112|0,UA=-1,fA=3,rA=B(.5),yA=20,jA=24,OA=255,wr=4,HA=16,QA=8,Wr=-4,zA=40,Fr=36,Zr=12,nA=128,Y=1,D=1;break n;}g:if(l=Y+UA|0,L=l<<fA,o=L+u|0,y=t[o>>2],d=t[o+4>>2],g=C[d+16>>2],R=C[d>>2],s=B(B(B(g-R)*rA)+B(0)),G=C[d+yA>>2],h=C[d+4>>2],v=B(B(B(G-h)*rA)+B(0)),w=C[d+jA>>2],W=C[d+8>>2],p=B(B(B(w-W)*rA)+B(0)),Z=B(B(B(Dr*s)+B(pr*v))+B(Qr*p)),g=B(B(g+R)*rA),R=B(B(G+h)*rA),G=B(B(w+W)*rA),h=B(_r+B(B(B(SA*g)+B(xA*R))+B(MA*G))),C[y>>2]<=B(H+B(Z+h))^P|C[y+16>>2]>=B(B(h-Z)-H)^P||(h=B(B(B(yr*s)+B(hr*v))+B(Gr*p)),w=B(gr+B(B(B(XA*g)+B(JA*R))+B(IA*G))),C[y+4>>2]<=B(H+B(h+w))^P|C[y+yA>>2]>=B(B(w-h)-H)^P||(s=B(B(B(Rr*s)+B(mr*v))+B(Br*p)),v=B(Cr+B(B(B(VA*g)+B(NA*R))+B(EA*G))),C[y+8>>2]<=B(H+B(s+v))^P||C[y+jA>>2]>=B(B(v-s)-H)^P))){if(Y=l,l)break l;}else {_:{B:{m:{R:{G:{h:{y:{Q:{if((0|l)>(0|TA)){if(c=Q<<P,(0|Q)>=(0|c)|(0|nA)>=(0|c))break Q;if(!Q)break y;if(k=CA(Q<<wr,HA),o=k,(0|Q)<(0|P))break h;for(o=k,D=u;nA=t[D+4>>2],t[o>>2]=t[D>>2],t[o+4>>2]=nA,o=o+QA|0,D=D+QA|0,Q=Q+UA|0,Q;){}if(F&OA)break G;break R;}c=Q,k=u,o=F;break _;}k=u,o=F;break B;}o=0;}if(k=o,o=1,Q=o,!u)break m;if(nA=c,!(F&OA))break B;}gA(u);}Q=1;}o=Q,nA=c;}TA=c+Wr|0;}F=d+zA|0,u=t[F>>2];_:{B:{m:{if(Q=y+zA|0,t[Q>>2]){if(l=t[y+36>>2],!u)break m;if(u=k+L|0,t[u+4>>2]=t[d+36>>2],t[u>>2]=l,l=t[Q>>2],u=(Y<<fA)+k|0,t[u+4>>2]=t[d+36>>2],t[u>>2]=l,l=t[y+Fr>>2],t[u+Zr>>2]=t[F>>2],t[u+QA>>2]=l,Q=t[Q>>2],t[u+yA>>2]=t[F>>2],t[u+HA>>2]=Q,Q=c,u=k,F=o,Y=Y+fA|0,Y)break k;break g;}if(!u)break _;u=k+L|0,t[u+4>>2]=t[d+36>>2],t[u>>2]=y,u=(Y<<fA)+k|0,t[u+4>>2]=t[F>>2],t[u>>2]=y;break B;}u=k+L|0,t[u+4>>2]=d,t[u>>2]=l,u=t[Q>>2],F=(Y<<fA)+k|0,t[F+4>>2]=d,t[F>>2]=u;}if(Q=c,u=k,F=o,Y=Y+P|0,Y)break c;break g;}if(yf[t[t[n+72>>2]+8>>2]](n+72|0,y,d),Q=c,u=k,F=o,Y=l,l)break u;}!u|!(255&F)||gA(u);}if($=8,K=1,o=t[YA>>2],PA=o+8|0,t[PA>>2]<1)break d;AA=12,LA=16,pA=o+16|0,KA=80,DA=28,tA=56,bA=52,oA=36,kA=20,cA=40,uA=24,Yr=172,Er=156,qA=32,Nr=160,Vr=A+4|0,$A=A+96|0,lA=A+92|0,sA=A+100|0,Ir=-1,Ar=A+104|0,_A=0,D=2;break r;}if(c=_(AA,_A),o=c+t[pA>>2]|0,k=t[o+8>>2],k&&(o=t[dA+DA>>2]+_(t[o>>2],KA)|0,l=t[o+64>>2],Z=C[o+tA>>2],V=C[o+bA>>2],I=C[o+48>>2],J=C[o+oA>>2],X=C[o+kA>>2],M=C[o+4>>2],x=C[o+cA>>2],S=C[o+uA>>2],T=C[o+8>>2],U=C[o+32>>2],j=C[o>>2],O=C[o+16>>2],o=t[r+AA>>2],z=C[o+48>>2],q=C[o+bA>>2],aA=C[o+tA>>2],s=C[o+8>>2],v=C[o+4>>2],p=C[o>>2],g=C[o+uA>>2],R=C[o+16>>2],G=C[o+kA>>2],h=C[o+cA>>2],w=C[o+32>>2],W=C[o+oA>>2],y=n+Yr|0,t[y>>2]=0,L=n+Er|0,t[L>>2]=0,BA=(n+112|0)+DA|0,t[BA>>2]=0,rr=(n+112|0)+AA|0,t[rr>>2]=0,er=(n+112|0)+qA|0,C[er>>2]=B(B(w*j)+B(W*O))+B(h*U),ir=(n+112|0)+LA|0,C[ir>>2]=B(B(R*j)+B(G*O))+B(g*U),ar=(n+112|0)+cA|0,C[ar>>2]=B(B(w*T)+B(W*S))+B(h*x),fr=(n+112|0)+oA|0,C[fr>>2]=B(B(w*M)+B(W*X))+B(h*J),nr=(n+112|0)+uA|0,C[nr>>2]=B(B(R*T)+B(G*S))+B(g*x),tr=(n+112|0)+kA|0,C[tr>>2]=B(B(R*M)+B(G*X))+B(g*J),br=(n+112|0)+$|0,C[br>>2]=B(B(p*T)+B(v*S))+B(s*x),or=(n+112|0)+tA|0,C[or>>2]=aA+B(B(B(w*I)+B(W*V))+B(h*Z)),kr=(n+112|0)+bA|0,C[kr>>2]=q+B(B(B(R*I)+B(G*V))+B(g*Z)),cr=n+Nr|0,C[cr>>2]=z+B(B(B(p*I)+B(v*V))+B(s*Z)),C[n+112>>2]=B(B(p*j)+B(v*O))+B(s*U),C[n+116>>2]=B(B(p*M)+B(v*X))+B(s*J),yf[t[t[l>>2]+8>>2]](l,n+112|0,n+56|0,n+40|0),l=(n+56|0)+$|0,s=C[f+qA>>2],C[l>>2]=C[l>>2]-s,D=(n+40|0)+$|0,C[D>>2]=s+C[D>>2],C[n+56>>2]=C[n+56>>2]-s,C[n+60>>2]=C[n+60>>2]-s,C[n+40>>2]=s+C[n+40>>2],C[n+44>>2]=s+C[n+44>>2],o=t[vA+DA>>2]+_(t[4+(c+t[pA>>2]|0)>>2],KA)|0,d=t[o+64>>2],V=C[o+tA>>2],I=C[o+bA>>2],J=C[o+48>>2],X=C[o+oA>>2],M=C[o+kA>>2],x=C[o+4>>2],S=C[o+cA>>2],T=C[o+uA>>2],U=C[o+8>>2],j=C[o+32>>2],O=C[o>>2],z=C[o+16>>2],o=t[e+AA>>2],q=C[o+48>>2],aA=C[o+bA>>2],Jr=C[o+tA>>2],v=C[o+8>>2],p=C[o+4>>2],g=C[o>>2],R=C[o+uA>>2],G=C[o+16>>2],h=C[o+kA>>2],w=C[o+cA>>2],W=C[o+32>>2],Z=C[o+oA>>2],t[y>>2]=0,t[L>>2]=0,t[BA>>2]=0,t[rr>>2]=0,C[er>>2]=B(B(W*O)+B(Z*z))+B(w*j),C[ir>>2]=B(B(G*O)+B(h*z))+B(R*j),C[ar>>2]=B(B(W*U)+B(Z*T))+B(w*S),C[fr>>2]=B(B(W*x)+B(Z*M))+B(w*X),C[nr>>2]=B(B(G*U)+B(h*T))+B(R*S),C[tr>>2]=B(B(G*x)+B(h*M))+B(R*X),C[br>>2]=B(B(g*U)+B(p*T))+B(v*S),C[or>>2]=Jr+B(B(B(W*J)+B(Z*I))+B(w*V)),C[kr>>2]=aA+B(B(B(G*J)+B(h*I))+B(R*V)),C[cr>>2]=q+B(B(B(g*J)+B(p*I))+B(v*V)),C[n+112>>2]=B(B(g*O)+B(p*z))+B(v*j),C[n+116>>2]=B(B(g*x)+B(p*M))+B(v*X),yf[t[t[d>>2]+8>>2]](d,n+112|0,n+24|0,n+8|0),o=(n+24|0)+$|0,v=B(C[o>>2]-s),C[o>>2]=v,o=(n+8|0)+$|0,p=B(s+C[o>>2]),C[o>>2]=p,g=B(C[n+24>>2]-s),C[n+24>>2]=g,R=B(C[n+28>>2]-s),C[n+28>>2]=R,G=B(s+C[n+8>>2]),C[n+8>>2]=G,s=B(s+C[n+12>>2]),C[n+12>>2]=s,C[n+44>>2]<R|C[n+60>>2]>s|C[n+40>>2]<g|C[n+56>>2]>G||C[l>>2]>p||!(C[D>>2]<v^K))){if(yf[t[t[k>>2]>>2]](k),o=t[Vr>>2],yf[t[t[o>>2]+60>>2]](o,k),o=c+t[pA>>2]|0,y=t[o+4>>2],L=t[o>>2],c=t[lA>>2],(0|c)==t[$A>>2]&&(l=c?c<<K:K,!((0|c)>=(0|l)))){v:{C:{if(l){if(o=CA(_(l,AA),LA),c=t[lA>>2],(0|c)>=(0|K))break C;break v;}if(o=0,(0|c)<(0|K))break v;}for(k=0;d=t[sA>>2]+k|0,BA=t[d+4>>2],D=o+k|0,t[D>>2]=t[d>>2],t[D+4>>2]=BA,t[D+$>>2]=t[d+$>>2],k=k+AA|0,c=c+Ir|0,c;){}}k=t[sA>>2],k&&(b[0|Ar]&&gA(k),t[sA>>2]=0),t[sA>>2]=o,a[0|Ar]=K,t[$A>>2]=l,c=t[lA>>2];}o=t[sA>>2]+_(c,AA)|0,t[o+8>>2]=0,t[o+4>>2]=y,t[o>>2]=L,t[lA>>2]=t[lA>>2]+K;}if(_A=K+_A|0,(0|_A)<t[PA>>2])break o;}if(r=A+92|0,t[r>>2]>=(0|K))for(k=0,N=4,e=A+84|0,i=A+100|0;f=t[e>>2],o=t[i>>2]+N|0,yf[t[t[f>>2]+8>>2]](f,t[o+-4>>2],t[o>>2]),N=N+12|0,k=k+1|0,(0|k)<t[r>>2];){}return r=A+100|0,e=t[r>>2],e&&(b[A+104|0]&&gA(e),t[A+100>>2]=0),t[r>>2]=0,a[A+104|0]=1,A=A+92|0,t[A>>2]=0,t[A+4>>2]=0,void(E=n+3328|0);}D=0;break t;}D=1;break f;}D=1;break a;}D=1;break i;}D=1;break e;}D=2;break A;}k=1;continue;}k=2;continue;}k=2;continue;}k=2;continue;}k=2;continue;}k=2;continue;}k=2;continue;}k=2;continue;}k=2;}},function(A,r,e,i,a){return B(B(0));},function(A,r){A|=0,r|=0;var e,i=0,a=0,f=0,n=0;if(a=8,i=t[A+84>>2],e=i+8|0,A=t[e>>2],(0|A)>=1)for(n=i+16|0;i=t[t[n>>2]+a>>2],i&&(yf[t[t[i>>2]+16>>2]](i,r),A=t[e>>2]),a=a+12|0,f=f+1|0,(0|f)<(0|A);){}},Cr,function(A,r,e){A|=0,r|=0,e|=0;var i,a,f,n,b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=0,d=B(0),v=B(0),g=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=0,Y=0,N=0,V=B(0),I=B(0),J=0,X=0;i=E-256|0,E=i,$e(i+248|0,17128),t[A+4>>2]=t[A+4>>2]+1,a=t[e+36>>2],Y=_(a,80),N=t[A+12>>2],n=t[N+4>>2]+28|0,s=t[64+(Y+t[n>>2]|0)>>2],e=t[A+8>>2],f=t[r+36>>2],r=t[t[e+4>>2]+28>>2]+_(f,80)|0,Z=t[r+64>>2],e=t[e+12>>2],R=C[e+52>>2],l=C[e+56>>2],c=C[e+24>>2],u=C[e+20>>2],b=C[e+40>>2],o=C[e+36>>2],V=C[e+48>>2],d=C[e+8>>2],v=C[e>>2],g=C[e+4>>2],m=C[e+16>>2],k=C[e+32>>2],e=0,t[i+244>>2]=0,t[i+228>>2]=0,t[i+212>>2]=0,G=C[r+8>>2],h=C[r+24>>2],y=C[r+40>>2],C[i+224>>2]=B(B(k*G)+B(o*h))+B(b*y),Q=C[r+4>>2],p=C[r+20>>2],D=C[r+36>>2],C[i+220>>2]=B(B(k*Q)+B(o*p))+B(b*D),C[i+208>>2]=B(B(m*G)+B(u*h))+B(c*y),C[i+204>>2]=B(B(m*Q)+B(u*p))+B(c*D),w=l,l=C[r+48>>2],W=C[r+52>>2],F=C[r+56>>2],C[i+240>>2]=w+B(B(B(k*l)+B(o*W))+B(b*F)),C[i+236>>2]=R+B(B(B(m*l)+B(u*W))+B(c*F)),t[i+196>>2]=0,w=k,k=C[r>>2],R=o,o=C[r+16>>2],I=b,b=C[r+32>>2],C[i+216>>2]=B(B(w*k)+B(R*o))+B(I*b),C[i+200>>2]=B(B(m*k)+B(u*o))+B(c*b),C[i+192>>2]=B(B(v*G)+B(g*h))+B(d*y),C[i+188>>2]=B(B(v*Q)+B(g*p))+B(d*D),C[i+184>>2]=B(B(v*k)+B(g*o))+B(d*b),C[i+232>>2]=V+B(B(B(v*l)+B(g*W))+B(d*F)),r=t[N+12>>2],R=C[r+52>>2],l=C[r+56>>2],c=C[r+24>>2],u=C[r+20>>2],b=C[r+40>>2],o=C[r+36>>2],N=t[n>>2],V=C[r+48>>2],d=C[r+8>>2],v=C[r>>2],g=C[r+4>>2],m=C[r+16>>2],k=C[r+32>>2],t[i+180>>2]=0,t[i+164>>2]=0,t[i+148>>2]=0,r=Y+N|0,G=C[r+8>>2],h=C[r+24>>2],y=C[r+40>>2],C[i+160>>2]=B(B(k*G)+B(o*h))+B(b*y),Q=C[r+4>>2],p=C[r+20>>2],D=C[r+36>>2],C[i+156>>2]=B(B(k*Q)+B(o*p))+B(b*D),C[i+144>>2]=B(B(m*G)+B(u*h))+B(c*y),C[i+140>>2]=B(B(m*Q)+B(u*p))+B(c*D),w=l,l=C[r+48>>2],W=C[r+52>>2],F=C[r+56>>2],C[i+176>>2]=w+B(B(B(k*l)+B(o*W))+B(b*F)),C[i+172>>2]=R+B(B(B(m*l)+B(u*W))+B(c*F)),t[i+132>>2]=0,w=k,k=C[r>>2],R=o,o=C[r+16>>2],I=b,b=C[r+32>>2],C[i+152>>2]=B(B(w*k)+B(R*o))+B(I*b),C[i+136>>2]=B(B(m*k)+B(u*o))+B(c*b),C[i+128>>2]=B(B(v*G)+B(g*h))+B(d*y),C[i+124>>2]=B(B(v*Q)+B(g*p))+B(d*D),C[i+120>>2]=B(B(v*k)+B(g*o))+B(d*b),C[i+168>>2]=V+B(B(B(v*l)+B(g*W))+B(d*F)),yf[t[t[Z>>2]+8>>2]](Z,i+184|0,i+104|0,i+88|0),yf[t[t[s>>2]+8>>2]](s,i+120|0,i+72|0,i+56|0),c=C[t[A+24>>2]+32>>2],u=B(C[i+104>>2]-c),C[i+104>>2]=u,C[i+108>>2]=C[i+108>>2]-c,C[i+112>>2]=C[i+112>>2]-c,C[i+88>>2]=c+C[i+88>>2],C[i+92>>2]=c+C[i+92>>2],C[i+96>>2]=c+C[i+96>>2],r=t[697];A:{if(r){if(!yf[r](Z,s))break A;u=C[i+104>>2];}u>C[i+56>>2]|C[i+88>>2]<C[i+72>>2]||(e=1),r=0,r=C[i+96>>2]<C[i+80>>2]|C[i+112>>2]>C[i+64>>2]?r:e,C[i+92>>2]<C[i+76>>2]|C[i+108>>2]>C[i+60>>2]|1^r||(t[i+48>>2]=-1,t[i+36>>2]=Z,r=t[A+8>>2],t[i+32>>2]=r,t[i+40>>2]=t[r+8>>2],t[i+44>>2]=i+184,t[i+52>>2]=f,t[i+24>>2]=-1,t[i+12>>2]=s,r=t[A+12>>2],t[i+8>>2]=r,t[i+16>>2]=t[r+8>>2],t[i+20>>2]=i+120,t[i+28>>2]=a,r=function(A,r,e){var i=0,a=0,f=0;t[696]=t[696]+1,i=e<<16|r,i=(i<<15^-1)+i|0,i=_(i>>>10^i,9),i^=i>>>6,i=(i<<11^-1)+i|0,i=t[A+12>>2]+-1&(i>>>16^i);r:{if(!((0|i)>=t[A+28>>2])&&(i=t[t[A+36>>2]+(i<<2)>>2],-1!=(0|i)))for(a=t[A+16>>2],f=A+56|0;;){if(A=_(i,12)+a|0,t[A+4>>2]==(0|e)&&(0|r)==t[A>>2])break r;if(i=t[t[f>>2]+(i<<2)>>2],-1==(0|i))break;}A=0;}return A;}(t[A+28>>2],f,a),C[t[A+24>>2]+32>>2]>B(0)?(r=t[A+16>>2],r=0|yf[t[t[r>>2]+8>>2]](r,i+32|0,i+8|0,0,2)):r?r=t[r+8>>2]:(r=t[A+16>>2],r=0|yf[t[t[r>>2]+8>>2]](r,i+32|0,i+8|0,t[A+32>>2],1),e=t[A+28>>2],J=0|yf[t[t[e>>2]+12>>2]](e,f,a),X=r,t[J+8>>2]=X),s=A+24|0,e=t[s>>2],Z=t[e+12>>2],Y=t[e+8>>2],t[e+12>>2]=i+8,t[e+8>>2]=i+32,yf[t[t[e>>2]+8>>2]](e,-1,f),e=t[s>>2],yf[t[t[e>>2]+12>>2]](e,-1,a),yf[t[t[r>>2]+8>>2]](r,i+32|0,i+8|0,t[A+20>>2],t[s>>2]),A=t[s>>2],t[A+8>>2]=Y,t[A+12>>2]=Z);}Ai(),E=i+256|0;},he,Cr,ee,hr,he,function(A){A|=0;var r=0,e=0;return t[A>>2]=17236,b[A+8|0]&&(r=t[A+12>>2],r&&(e=t[A+4>>2],yf[t[t[e>>2]+16>>2]](e,r))),0|A;},function(A){A|=0;var r=0,e=0;t[A>>2]=17236,b[A+8|0]&&(r=t[A+12>>2],r&&(e=t[A+4>>2],yf[t[t[e>>2]+16>>2]](e,r))),rA(A);},function(A,r,e,i,a){A|=0,r|=0,e|=0,i|=0,a|=0;var f,n=B(0),b=0,o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=0;if(i=E-32|0,E=i,f=t[A+12>>2],f){if(t[a+4>>2]=f,A=t[r+12>>2],b=t[e+12>>2],l=B(C[A+48>>2]-C[b+48>>2]),k=B(C[A+52>>2]-C[b+52>>2]),c=B(C[A+56>>2]-C[b+56>>2]),n=B(B(B(l*l)+B(k*k))+B(c*c)),A=t[e+4>>2],u=C[A+16>>2],o=C[A+32>>2],A=t[r+4>>2],s=C[A+16>>2],d=C[A+32>>2],b=t[f+780>>2],(0|b)>=1)for(r=f+4|0,A=0,v=f+780|0;lr(r),r=r+192|0,A=A+1|0,b=t[v>>2],(0|A)<(0|b);){}n=B(Q(n)),u=B(o*u),o=B(d*s),b&&(A=t[428],A&&(t[i+16>>2]=f,yf[A](i+16|0))),t[f+780>>2]=0,o=B(o+u),n>B(o+C[a+32>>2])||(t[i+24>>2]=0,t[i+28>>2]=0,t[i+16>>2]=1065353216,t[i+20>>2]=0,o=B(n-o),n>B(1.1920928955078125e-7)?(t[i+28>>2]=0,n=B(B(1)/n),c=B(c*n),C[i+24>>2]=c,k=B(k*n),C[i+20>>2]=k,n=B(l*n),C[i+16>>2]=n):(n=B(1),c=B(0),k=B(0)),t[i+12>>2]=0,A=t[e+12>>2],C[i>>2]=B(u*n)+C[A+48>>2],C[i+8>>2]=B(u*c)+C[A+56>>2],C[i+4>>2]=B(u*k)+C[A+52>>2],yf[t[t[a>>2]+16>>2]](a,i+16|0,i,o));}E=i+32|0;},hr,si,Cr,di,function(A){A|=0;var r=0,e=0;return t[A>>2]=17372,b[A+8|0]&&(r=t[A+12>>2],r&&(e=t[A+4>>2],yf[t[t[e>>2]+16>>2]](e,r))),0|A;},function(A){A|=0;var r=0,e=0;t[A>>2]=17372,b[A+8|0]&&(r=t[A+12>>2],r&&(e=t[A+4>>2],yf[t[t[e>>2]+16>>2]](e,r))),rA(A);},function(A,r,e,i,a){A|=0,r|=0,e|=0,i|=0,a|=0;var f,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0;f=E-160|0,E=f;A:{if(u=t[A+12>>2],u&&(t[a+4>>2]=u,n=b[A+16|0],o=n?e:r,k=t[o+4>>2],e=n?r:e,n=t[e+4>>2],r=f+144|0,C[r+12>>2]=C[u+784>>2]+C[a+32>>2],t[r+8>>2]=n,t[r+4>>2]=k,t[r>>2]=17312,u=r,t[f+136>>2]=1566444395,r=t[o+12>>2],n=r+8|0,o=t[n+4>>2],k=f+16|0,t[k>>2]=t[n>>2],t[k+4>>2]=o,n=t[r>>2],o=t[r+4>>2],k=r+24|0,l=t[k+4>>2],c=f+32|0,t[c>>2]=t[k>>2],t[c+4>>2]=l,k=t[r+16>>2],l=t[r+20>>2],c=r+40|0,d=t[c+4>>2],s=f+48|0,t[s>>2]=t[c>>2],t[s+4>>2]=d,t[f+8>>2]=n,t[f+12>>2]=o,t[f+24>>2]=k,t[f+28>>2]=l,n=t[r+32>>2],o=t[r+36>>2],k=r+56|0,l=t[k+4>>2],c=f- -64|0,t[c>>2]=t[k>>2],t[c+4>>2]=l,t[f+40>>2]=n,t[f+44>>2]=o,n=t[r+52>>2],t[f+56>>2]=t[r+48>>2],t[f+60>>2]=n,r=t[e+12>>2],e=r+8|0,n=t[e+4>>2],o=f+80|0,t[o>>2]=t[e>>2],t[o+4>>2]=n,e=t[r+4>>2],t[f+72>>2]=t[r>>2],t[f+76>>2]=e,e=r+24|0,n=t[e+4>>2],o=f+96|0,t[o>>2]=t[e>>2],t[o+4>>2]=n,e=t[r+20>>2],n=f+88|0,t[n>>2]=t[r+16>>2],t[n+4>>2]=e,e=r+40|0,n=t[e+4>>2],o=f+112|0,t[o>>2]=t[e>>2],t[o+4>>2]=n,e=t[r+36>>2],n=f+104|0,t[n>>2]=t[r+32>>2],t[n+4>>2]=e,e=r+56|0,n=t[e+4>>2],o=f+128|0,t[o>>2]=t[e>>2],t[o+4>>2]=n,e=t[r+52>>2],n=f+120|0,t[n>>2]=t[r+48>>2],t[n+4>>2]=e,di(u,f+8|0,a,t[i+20>>2],b[A+16|0]),b[A+8|0]&&(A=t[a+4>>2],t[A+780>>2]))){if(r=t[A+772>>2],e=t[t[a+8>>2]+8>>2],(0|r)==(0|e))break A;dr(A,t[t[a+12>>2]+8>>2]+4|0,e+4|0);}return void(E=f+160|0);}dr(A,r+4|0,t[t[a+12>>2]+8>>2]+4|0),E=f+160|0;},hr,si,Cr,_i,function(A){A|=0;var r=0,e=0;return t[A>>2]=17580,b[A+8|0]&&(r=t[A+12>>2],r&&(e=t[A+4>>2],yf[t[t[e>>2]+16>>2]](e,r))),0|A;},function(A){A|=0;var r=0,e=0;t[A>>2]=17580,b[A+8|0]&&(r=t[A+12>>2],r&&(e=t[A+4>>2],yf[t[t[e>>2]+16>>2]](e,r))),rA(A);},function(A,r,e,i,a){A|=0,r|=0,e|=0,i|=0,a|=0;var f,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0;f=E-160|0,E=f;A:{if(l=t[A+12>>2],l&&(t[a+4>>2]=l,l=t[e+4>>2],d=t[r+4>>2],t[f+152>>2]=1566444395,r=t[r+12>>2],n=r+8|0,o=t[n+4>>2],k=f+32|0,t[k>>2]=t[n>>2],t[k+4>>2]=o,n=t[r>>2],o=t[r+4>>2],k=r+24|0,u=t[k+4>>2],c=f+48|0,t[c>>2]=t[k>>2],t[c+4>>2]=u,k=t[r+16>>2],u=t[r+20>>2],c=r+40|0,v=t[c+4>>2],s=f- -64|0,t[s>>2]=t[c>>2],t[s+4>>2]=v,t[f+24>>2]=n,t[f+28>>2]=o,t[f+40>>2]=k,t[f+44>>2]=u,n=t[r+32>>2],o=t[r+36>>2],k=r+56|0,u=t[k+4>>2],c=f+80|0,t[c>>2]=t[k>>2],t[c+4>>2]=u,t[f+56>>2]=n,t[f+60>>2]=o,n=t[r+52>>2],t[f+72>>2]=t[r+48>>2],t[f+76>>2]=n,r=t[e+12>>2],e=r+8|0,n=t[e+4>>2],o=f+96|0,t[o>>2]=t[e>>2],t[o+4>>2]=n,e=t[r+4>>2],t[f+88>>2]=t[r>>2],t[f+92>>2]=e,e=r+24|0,n=t[e+4>>2],o=f+112|0,t[o>>2]=t[e>>2],t[o+4>>2]=n,e=t[r+20>>2],n=f+104|0,t[n>>2]=t[r+16>>2],t[n+4>>2]=e,e=r+40|0,n=t[e+4>>2],o=f+128|0,t[o>>2]=t[e>>2],t[o+4>>2]=n,e=t[r+36>>2],n=f+120|0,t[n>>2]=t[r+32>>2],t[n+4>>2]=e,e=r+56|0,n=t[e+4>>2],o=f+144|0,t[o>>2]=t[e>>2],t[o+4>>2]=n,e=t[r+52>>2],n=f+136|0,t[n>>2]=t[r+48>>2],t[n+4>>2]=e,r=f+8|0,t[r+8>>2]=l,t[r+4>>2]=d,t[r>>2]=17528,_i(r,f+24|0,a,t[i+20>>2],0),b[A+8|0]&&(A=t[a+4>>2],t[A+780>>2]))){if(r=t[A+772>>2],e=t[t[a+8>>2]+8>>2],(0|r)==(0|e))break A;dr(A,t[t[a+12>>2]+8>>2]+4|0,e+4|0);}return void(E=f+160|0);}dr(A,r+4|0,t[t[a+12>>2]+8>>2]+4|0),E=f+160|0;},hr,si,function(A){A|=0;var r=0,e=0;return t[A>>2]=17652,b[A+8|0]&&(r=t[A+12>>2],r&&(e=t[A+4>>2],yf[t[t[e>>2]+16>>2]](e,r))),0|A;},function(A){A|=0;var r=0,e=0;t[A>>2]=17652,b[A+8|0]&&(r=t[A+12>>2],r&&(e=t[A+4>>2],yf[t[t[e>>2]+16>>2]](e,r))),rA(A);},function(A,r,e,i,a){A|=0,r|=0,e|=0,i|=0,a|=0;var f=0,n=B(0),o=B(0),k=B(0),c=B(0),u=0,l=0,s=B(0),d=B(0),v=B(0),g=B(0),_=0,R=B(0),h=B(0),y=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=0,Y=B(0),N=B(0),V=B(0),I=B(0),J=B(0),X=B(0),M=B(0),x=0,S=B(0),T=B(0),U=B(0),j=B(0),O=B(0),H=B(0),z=B(0),P=B(0),L=B(0),K=B(0),q=B(0),$=B(0),AA=B(0),rA=B(0),eA=B(0),iA=B(0),aA=B(0),fA=B(0),nA=B(0),tA=B(0),bA=B(0),oA=B(0),kA=B(0),cA=0,uA=0;i=E-48|0,E=i;A:{if(t[A+12>>2]){if(l=b[A+16|0],_=l?e:r,f=t[_+12>>2],y=C[f+56>>2],p=C[f+52>>2],D=C[f+48>>2],Z=l?r:e,u=t[Z+12>>2],T=C[u+56>>2],K=C[u+48>>2],U=C[u+52>>2],_=t[_+4>>2],w=C[f+32>>2],W=C[f+16>>2],F=C[f>>2],Y=C[f+36>>2],N=C[f+20>>2],V=C[f+4>>2],o=C[u+40>>2],k=C[u+24>>2],n=C[u+8>>2],c=C[u+32>>2],v=C[u+16>>2],s=C[u>>2],l=t[Z+4>>2],R=C[u+36>>2],g=C[f+40>>2],h=C[u+20>>2],I=C[f+24>>2],d=C[u+4>>2],J=C[f+8>>2],t[i+28>>2]=0,O=B(B(B(J*s)+B(I*v))+B(g*c)),X=B(-C[l+52>>2]),H=B(B(B(J*d)+B(I*h))+B(g*R)),u=l+56|0,M=C[u>>2],I=B(B(B(J*n)+B(I*k))+B(g*o)),x=l+60|0,g=C[x>>2],C[i+24>>2]=B(B(O*X)-B(H*M))-B(I*g),J=B(B(B(V*s)+B(N*v))+B(Y*c)),z=B(B(B(V*d)+B(N*h))+B(Y*R)),P=B(B(B(V*n)+B(N*k))+B(Y*o)),C[i+20>>2]=B(B(J*X)-B(M*z))-B(g*P),L=B(B(B(F*s)+B(W*v))+B(w*c)),j=B(L*X),X=B(B(B(F*d)+B(W*h))+B(w*R)),S=g,g=B(B(B(F*n)+B(W*k))+B(w*o)),C[i+16>>2]=B(j-B(M*X))-B(S*g),yf[t[t[_>>2]+64>>2]](i+32|0,_,i+16|0),f=t[Z+12>>2],M=C[f+48>>2],q=C[f+32>>2],$=C[f+16>>2],AA=C[f+8>>2],rA=C[f+4>>2],eA=C[f>>2],iA=C[f+56>>2],aA=C[f+52>>2],fA=C[f+40>>2],nA=C[f+36>>2],tA=C[f+24>>2],bA=C[f+20>>2],oA=C[l+68>>2],Y=C[x>>2],N=C[l+52>>2],V=C[u>>2],w=C[i+40>>2],W=C[i+32>>2],F=C[i+36>>2],f=A+12|0,kA=C[t[f>>2]+784>>2],t[a+4>>2]=t[f>>2],j=B(B(B(D*n)+B(p*k))+B(y*o)),S=n,n=B(-K),g=B(B(j+B(B(B(S*n)-B(k*U))-B(o*T)))+B(B(B(g*W)+B(P*F))+B(I*w))),v=B(B(B(B(B(D*s)+B(p*v))+B(y*c))+B(B(B(s*n)-B(v*U))-B(c*T)))+B(B(B(L*W)+B(J*F))+B(O*w))),s=B(B(B(B(B(D*d)+B(p*h))+B(y*R))+B(B(B(d*n)-B(h*U))-B(R*T)))+B(B(B(X*W)+B(z*F))+B(H*w))),o=B(B(B(Y*g)+B(B(N*v)+B(V*s)))-oA),o<kA&&(t[i+28>>2]=0,f=t[Z+12>>2],k=C[l+52>>2],n=C[u>>2],c=C[x>>2],C[i+16>>2]=B(B(C[f>>2]*k)+B(C[f+4>>2]*n))+B(C[f+8>>2]*c),C[i+24>>2]=B(B(k*C[f+32>>2])+B(n*C[f+36>>2]))+B(c*C[f+40>>2]),C[i+20>>2]=B(B(k*C[f+16>>2])+B(n*C[f+20>>2]))+B(c*C[f+24>>2]),t[i+12>>2]=0,k=B(v-B(N*o)),n=B(s-B(V*o)),c=B(g-B(Y*o)),C[i+8>>2]=B(B(B(k*q)+B(n*nA))+B(c*fA))+iA,C[i+4>>2]=B(B(B(k*$)+B(n*bA))+B(c*tA))+aA,C[i>>2]=B(B(AA*c)+B(B(eA*k)+B(rA*n)))+M,yf[t[t[a>>2]+16>>2]](a,i+16|0,i,o)),!(t[_+4>>2]>6|t[t[a+4>>2]+780>>2]>=t[A+24>>2]||(k=C[l+60>>2],B(m(k))>B(.7071067690849304)?(o=C[l+56>>2],n=B(B(1)/B(Q(B(B(k*k)+B(o*o))))),o=B(o*n),k=B(-B(k*n)),n=B(0)):(o=C[l+52>>2],n=C[l+56>>2],c=B(B(1)/B(Q(B(B(o*o)+B(n*n))))),k=B(o*c),o=B(0),n=B(-B(n*c))),c=B(yf[t[t[_>>2]+16>>2]](_)),f=0,c=B(B(G(B(C[794]/c),B(.39269909262657166)))*B(.5)),s=ge(c),u=t[A+20>>2],v=_e(c),(0|u)<1)))for(S=o,o=B(s/B(Q(B(B(B(n*n)+B(k*k))+B(o*o))))),s=B(S*o),R=B(k*o),h=B(n*o),_=l+56|0,Z=l+52|0,l=l+60|0,x=i+28|0,cA=i+24|0,uA=A+20|0;n=C[_>>2],c=C[l>>2],o=C[Z>>2],k=B(B(B(B(6.2831854820251465)/B(0|u))*B(0|f))*B(.5)),d=B(ge(k)/B(Q(B(B(B(o*o)+B(n*n))+B(c*c))))),o=B(o*d),k=_e(k),n=B(n*d),c=B(c*d),d=B(B(B(B(v*k)+B(h*o))+B(R*n))+B(s*c)),y=B(B(B(B(h*k)-B(v*o))-B(s*n))+B(R*c)),p=B(B(B(B(R*k)-B(v*n))-B(h*c))+B(s*o)),D=B(B(B(B(s*k)-B(v*c))-B(R*o))+B(h*n)),C[x>>2]=B(B(B(k*d)-B(o*y))-B(n*p))-B(c*D),C[cA>>2]=B(B(n*y)+B(B(c*d)+B(k*D)))-B(o*p),C[i+20>>2]=B(B(o*D)+B(B(k*p)+B(n*d)))-B(c*y),C[i+16>>2]=B(B(c*p)+B(B(o*d)+B(k*y)))-B(n*D),mi(A,i+16|0,r,e,a),f=f+1|0,u=t[uA>>2],(0|f)<(0|u);){}if(!(!b[A+8|0]|!t[t[A+12>>2]+780>>2])&&(A=t[a+4>>2],t[A+780>>2])){if(r=t[A+772>>2],e=t[t[a+8>>2]+8>>2],(0|r)==(0|e))break A;dr(A,t[t[a+12>>2]+8>>2]+4|0,e+4|0);}}return void(E=i+48|0);}dr(A,r+4|0,t[t[a+12>>2]+8>>2]+4|0),E=i+48|0;},hr,si,Gi,function(A){A|=0,rA(Gi(A));},hi,function(A){return A|=0,t[A+16>>2];},function(A,r,e){var i;if(A|=0,r|=0,e|=0,i=8!=(0|r),!(i|8!=(0|e)))return t[A+56>>2];if(!(1!=(0|e)|i))return t[A+72>>2];if(!(1!=(0|r)|8!=(0|e)))return t[A+76>>2];A:{if(r|e){if(28!=(0|e)|(0|r)>19)break A;return t[A+84>>2];}return t[A+68>>2];}if(!(28!=(0|r)|(0|e)>19))return t[A+80>>2];A:{r:{e:{if((0|r)<=19){if((0|e)>19)break e;return t[A+28>>2];}if(!((0|e)>19|r+-21>>>0>8))return t[A+36>>2];if(31!=(0|r))break r;if(31!=(0|e))break A;return t[A+44>>2];}if(!(e+-21>>>0>8))return t[A+32>>2];}return 31==(0|e)?t[A+48>>2]:t[A+52>>2];}return t[A+40>>2];},function(A,r,e){var i;if(A|=0,r|=0,e|=0,i=8!=(0|r),!(i|8!=(0|e)))return t[A+56>>2];if(!(1!=(0|e)|i))return t[A+72>>2];if(!(1!=(0|r)|8!=(0|e)))return t[A+76>>2];if(!(28!=(0|e)|(0|r)>19))return t[A+84>>2];if(!(28!=(0|r)|(0|e)>19))return t[A+80>>2];A:{r:{e:{if((0|r)<=19){if((0|e)>19)break e;return t[A+28>>2];}if(!((0|e)>19|r+-21>>>0>8))return t[A+36>>2];if(31!=(0|r))break r;if(31!=(0|e))break A;return t[A+44>>2];}if(!(e+-21>>>0>8))return t[A+32>>2];}return 31==(0|e)?t[A+48>>2]:t[A+52>>2];}return t[A+40>>2];},Cr,function(A,r,e,i){return A|=0,r|=0,e|=0,i|=0,A=t[r>>2],A=0|yf[t[t[A>>2]+56>>2]](A,80),ii(A,r,e,i,0),0|A;},Cr,function(A,r,e,i){return A|=0,r|=0,e|=0,i|=0,A=t[r>>2],A=0|yf[t[t[A>>2]+56>>2]](A,80),ii(A,r,e,i,1),0|A;},Cr,function(A,r,e,i){return A|=0,r|=0,e|=0,i|=0,A=t[r>>2],A=0|yf[t[t[A>>2]+56>>2]](A,84),ai(A,r,e,i,0),0|A;},Cr,function(A,r,e,i){return A|=0,r|=0,e|=0,i|=0,A=t[r>>2],A=0|yf[t[t[A>>2]+56>>2]](A,116),ui(A,r,e,i),0|A;},Cr,function(A,r,e,i){return A|=0,r|=0,e|=0,i|=0,A=t[r>>2],A=0|yf[t[t[A>>2]+56>>2]](A,84),ai(A,r,e,i,1),0|A;},Cr,function(A,r,e,i){return A|=0,r|=0,A=t[r>>2],A=0|yf[t[t[A>>2]+56>>2]](A,8),lA(A,r),t[A>>2]=17176,0|A;},Cr,function(A,r,e,i){return A|=0,r|=0,e|=0,i|=0,A=t[r>>2],A=0|yf[t[t[A>>2]+56>>2]](A,16),function(A,r,e,i){vA(A,r),t[A+12>>2]=0,a[A+8|0]=0,t[A>>2]=17236,r=t[A+4>>2],r=0|yf[t[t[r>>2]+12>>2]](r,t[e+8>>2],t[i+8>>2]),a[A+8|0]=1,t[A+12>>2]=r;}(A,r,e,i),0|A;},Cr,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var f=0;return f=t[r>>2],f=0|yf[t[t[f>>2]+56>>2]](f,20),function(A,r,e,i,f,n){vA(A,e),a[A+16|0]=n,t[A+12>>2]=r,a[A+8|0]=0,t[A>>2]=17372,r||(r=t[A+4>>2],r=0|yf[t[t[r>>2]+12>>2]](r,t[i+8>>2],t[f+8>>2]),a[A+8|0]=1,t[A+12>>2]=r);}(f,t[r+4>>2],r,e,i,b[A+4|0]),0|f;},Cr,function(A,r,e,i){return A|=0,r|=0,e|=0,i|=0,A=t[r>>2],A=0|yf[t[t[A>>2]+56>>2]](A,16),function(A,r,e,i){vA(A,r),t[A+12>>2]=0,a[A+8|0]=0,t[A>>2]=17580,r=t[A+4>>2],yf[t[t[r>>2]+24>>2]](r,t[e+8>>2],t[i+8>>2])&&(r=t[A+4>>2],r=0|yf[t[t[r>>2]+12>>2]](r,t[e+8>>2],t[i+8>>2]),a[A+8|0]=1,t[A+12>>2]=r);}(A,r,e,i),0|A;},Cr,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f,n=0;return n=t[r>>2],n=0|yf[t[t[n>>2]+56>>2]](n,28),a=t[A+12>>2],f=t[A+8>>2],b[A+4|0]?(Bi(n,r,e,i,1,f,a),0|n):(Bi(n,r,e,i,0,f,a),0|n);},function(A){A|=0;var r=0,e=0;return t[A>>2]=18664,r=A+60|0,e=t[r>>2],e&&(b[A- -64|0]&&gA(e),t[A+60>>2]=0),t[r>>2]=0,a[A- -64|0]=1,r=A+52|0,t[r>>2]=0,t[r+4>>2]=0,r=A+40|0,e=t[r>>2],e&&(b[A+44|0]&&gA(e),t[A+40>>2]=0),t[r>>2]=0,a[A+44|0]=1,r=A+32|0,t[r>>2]=0,t[r+4>>2]=0,r=A+16|0,e=t[r>>2],e&&(b[A+20|0]&&gA(e),t[A+16>>2]=0),t[r>>2]=0,a[A+20|0]=1,r=A+8|0,t[r>>2]=0,t[r+4>>2]=0,0|A;},function(A){A|=0;var r=0,e=0;t[A>>2]=18664,r=A+60|0,e=t[r>>2],e&&(b[A- -64|0]&&gA(e),t[A+60>>2]=0),t[r>>2]=0,a[A- -64|0]=1,r=A+52|0,t[r>>2]=0,t[r+4>>2]=0,r=A+40|0,e=t[r>>2],e&&(b[A+44|0]&&gA(e),t[A+40>>2]=0),t[r>>2]=0,a[A+44|0]=1,r=A+32|0,t[r>>2]=0,t[r+4>>2]=0,r=A+16|0,e=t[r>>2],e&&(b[A+20|0]&&gA(e),t[A+16>>2]=0),t[r>>2]=0,a[A+20|0]=1,r=A+8|0,t[r>>2]=0,t[r+4>>2]=0,gA(A);},function(A,r,e){A|=0,r|=0,e|=0;var i,f=0;t[700]=t[700]+1,i=t[A+24>>2];A:{r:{if(i){if(yf[t[t[i>>2]+8>>2]](i,r,e))break r;break A;}if(!(t[e+8>>2]&t[r+4>>2])|!(t[r+8>>2]&t[e+4>>2]))break A;}f=function(A,r,e){var i,f,n,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0,g=0,B=0;k=t[r+12>>2]>t[e+12>>2],i=k?r:e,u=t[i+12>>2],f=k?e:r,c=t[f+12>>2],r=u<<16|c,r=(r<<15^-1)+r|0,r=_(r>>>10^r,9),r^=r>>>6,r=(r<<11^-1)+r|0,n=r>>>16^r,k=t[A+12>>2],d=n&k+-1,r=t[t[A+40>>2]+(d<<2)>>2];r:{if(-1!=(0|r))for(o=t[A+16>>2],s=A+60|0;;){if(l=r<<4,e=l+o|0,(0|u)==t[t[4+(o+l|0)>>2]+12>>2]&&t[t[e>>2]+12>>2]==(0|c))break r;if(r=t[t[s>>2]+(r<<2)>>2],-1==(0|r))break;}if(r=k,v=A+8|0,u=t[v>>2],e=u,(0|r)==(0|e)&&(e=k,o=r?r<<1:1,!((0|r)>=(0|o)))){e:{i:{if(o){if(c=CA(o<<4,16),e=t[A+8>>2],(0|e)>=1)break i;break e;}if(c=0,e=k,(0|e)<1)break e;}for(r=12;s=r+c|0,l=t[A+16>>2]+r|0,t[s+-12>>2]=t[l+-12>>2],C=l+-8|0,B=t[C+4>>2],g=s+-8|0,t[g>>2]=t[C>>2],t[g+4>>2]=B,t[s>>2]=t[l>>2],r=r+16|0,e=e+-1|0,e;){}}r=A+16|0,e=t[r>>2],e&&(b[A+20|0]&&gA(e),t[A+16>>2]=0),t[r>>2]=c,a[A+20|0]=1,t[A+12>>2]=o,e=t[A+8>>2],r=o;}t[v>>2]=e+1,c=u<<4,o=t[A+16>>2],e=t[A+68>>2],e&&(yf[t[t[e>>2]+8>>2]](e,f,i),r=t[A+12>>2]),e=o+c|0,(0|k)<(0|r)&&(Qi(A),d=t[A+12>>2]+-1&n),k=t[i+12>>2],c=t[f+12>>2],r=o+(u<<4)|0,t[r+8>>2]=0,t[r+12>>2]=0,o=r,r=(0|c)<(0|k),t[o+4>>2]=r?i:f,k=t[A+60>>2]+(u<<2)|0,A=t[A+40>>2]+(d<<2)|0,t[k>>2]=t[A>>2],t[e>>2]=r?f:i,t[A>>2]=u;}return e;}(A,r,e);}return 0|f;},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a=0,f=0,n=0,b=0,o=0,k=0,c=0;t[699]=t[699]+1;A:{if(a=t[r+12>>2]>t[e+12>>2],n=a?r:e,f=t[n+12>>2],o=a?e:r,k=t[o+12>>2],r=f<<16|k,r=(r<<15^-1)+r|0,r=_(r>>>10^r,9),r^=r>>>6,r=(r<<11^-1)+r|0,b=t[A+12>>2]+-1&(r>>>16^r),r=t[t[A+40>>2]+(b<<2)>>2],-1!=(0|r))for(a=t[A+16>>2],c=A+60|0;;){if(e=a+(r<<4)|0,(0|f)==t[t[e+4>>2]+12>>2]&&t[t[e>>2]+12>>2]==(0|k))break A;if(r=t[t[c>>2]+(r<<2)>>2],-1==(0|r))break;}return 0;}yf[t[t[A>>2]+32>>2]](A,e,i),f=t[A+60>>2],k=t[12+(a+(r<<4)|0)>>2];A:{if(b=t[A+40>>2]+(b<<2)|0,r=t[b>>2],a=e-t[A+16>>2]>>4,(0|r)!=(0|a)){for(;e=r,r=t[f+(r<<2)>>2],(0|a)!=(0|r);){}if(r=t[f+(a<<2)>>2],-1!=(0|e)){t[f+(e<<2)>>2]=r;break A;}}else r=t[f+(a<<2)>>2];t[b>>2]=r;}if(f=t[A+8>>2]+-1|0,r=t[A+68>>2],r&&yf[t[t[r>>2]+12>>2]](r,o,n,i),(0|f)==(0|a))return A=A+8|0,t[A>>2]=t[A>>2]+-1,0|k;i=t[A+60>>2];A:{if(o=t[A+16>>2],n=o+(f<<4)|0,r=t[t[n+4>>2]+12>>2]<<16|t[t[n>>2]+12>>2],r=(r<<15^-1)+r|0,r=_(r>>>10^r,9),r^=r>>>6,r=(r<<11^-1)+r|0,b=t[A+12>>2]+-1&(r>>>16^r),c=t[A+40>>2]+(b<<2)|0,r=t[c>>2],(0|r)!=(0|f)){for(;e=r,r=t[i+(r<<2)>>2],(0|f)!=(0|r);){}if(r=t[i+(f<<2)>>2],-1!=(0|e)){t[i+(e<<2)>>2]=r;break A;}}else r=t[i+(f<<2)>>2];t[c>>2]=r;}return e=t[n+4>>2],r=o+(a<<4)|0,t[r>>2]=t[n>>2],t[r+4>>2]=e,e=n+8|0,i=t[e+4>>2],r=r+8|0,t[r>>2]=t[e>>2],t[r+4>>2]=i,r=t[A+40>>2]+(b<<2)|0,t[t[A+60>>2]+(a<<2)>>2]=t[r>>2],t[r>>2]=a,A=A+8|0,t[A>>2]=t[A>>2]+-1,0|k;},function(A,r,e){var i;A|=0,r|=0,e|=0,i=E-16|0,E=i,t[i+12>>2]=r,t[i+8>>2]=19024,yf[t[t[A>>2]+48>>2]](A,i+8|0,e),E=i+16|0;},ci,ci,pi,function(A,r,e){A|=0,r|=0,e|=0,e&&(A=t[r+8>>2],A&&(yf[t[t[A>>2]>>2]](A),A=r+8|0,yf[t[t[e>>2]+60>>2]](e,t[A>>2]),t[A>>2]=0));},function(A){return A|=0,t[A+8>>2];},function(A,r,e){var i;A|=0,r|=0,e|=0,i=E-16|0,E=i,t[i+12>>2]=e,t[i+8>>2]=A,t[i+4>>2]=r,t[i>>2]=18880,yf[t[t[A>>2]+48>>2]](A,i,e),E=i+16|0;},Di,function(A,r,e){A|=0,r|=0,e|=0;var i,a,f=0,n=0,b=0;i=E-16|0,E=i,$e(i+8|0,18732),a=A+8|0;A:if(!(t[a>>2]<1))for(b=A+16|0;;){if(n=t[b>>2]+(f<<4)|0,yf[t[t[r>>2]+8>>2]](r,n)){if(yf[t[t[A>>2]+12>>2]](A,t[n>>2],t[n+4>>2],e),t[698]=t[698]+-1,(0|f)<t[a>>2])continue;break A;}if(f=f+1|0,!((0|f)<t[a>>2]))break;}Ai(),E=i+16|0;},function(A,r,e){A|=0,r|=0,e|=0;var i,a=0,f=0,n=0;t[701]=t[701]+1,a=t[r+12>>2]>t[e+12>>2],i=t[(a?r:e)+12>>2],a=t[(a?e:r)+12>>2],r=a|i<<16,r=(r<<15^-1)+r|0,r=_(r>>>10^r,9),r^=r>>>6,r=(r<<11^-1)+r|0,r=t[A+12>>2]+-1&(r>>>16^r);A:{if(!((0|r)>=t[A+32>>2])&&(r=t[t[A+40>>2]+(r<<2)>>2],-1!=(0|r)))for(e=t[A+16>>2],n=A+60|0;;){if(f=r<<4,A=f+e|0,t[t[4+(e+f|0)>>2]+12>>2]==(0|i)&&(0|a)==t[t[A>>2]+12>>2])break A;if(r=t[t[n>>2]+(r<<2)>>2],-1==(0|r))break;}A=0;}return 0|A;},Zr,function(A,r){A|=0,r|=0,t[A+68>>2]=r;},function(A,r){A|=0,r|=0;var e,i,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0,g=0,_=0,B=0;if(e=E-32|0,E=e,t[e+20>>2]=0,t[e+12>>2]=0,t[e+16>>2]=0,i=A+8|0,n=t[i>>2],a[e+24|0]=1,!((0|n)<1)){for(B=A+16|0,c=e+20|0,g=e+16|0,n=0;;){u=t[B>>2]+(s<<4)|0;A:if((0|f)==(0|n)){r:{e:{i:{if(l=n?n<<1:1,(0|n)<(0|l)){if(!l)break i;if(d=CA(l<<4,16),(0|n)>=1)break e;break r;}f=n;break A;}if(d=0,(0|n)<1)break r;}for(f=12;v=f+d|0,C=t[c>>2]+f|0,t[v+-12>>2]=t[C+-12>>2],o=C+-8|0,k=t[o+4>>2],_=v+-8|0,t[_>>2]=t[o>>2],t[_+4>>2]=k,t[v>>2]=t[C>>2],f=f+16|0,n=n+-1|0,n;){}}n=t[c>>2],n&&(b[e+24|0]&&gA(n),t[c>>2]=0),t[c>>2]=d,a[e+24|0]=1,t[g>>2]=l,f=t[e+12>>2];}if(f=t[c>>2]+(f<<4)|0,t[f>>2]=t[u>>2],n=t[u+8>>2],t[f+4>>2]=t[u+4>>2],t[f+8>>2]=n,t[f+12>>2]=t[u+12>>2],k=t[e+12>>2],f=k+1|0,t[e+12>>2]=f,s=s+1|0,!((0|s)<t[i>>2]))break;n=t[g>>2];}if(!((0|k)<0))for(o=t[e+20>>2],n=-1;yf[t[t[A>>2]+12>>2]](A,t[o>>2],t[o+4>>2],r),o=o+16|0,n=n+1|0,(0|n)<(0|k);){}}if(r=A+52|0,t[r>>2]>=1){for(f=t[A+60>>2],o=0;t[f>>2]=-1,f=f+4|0,o=o+1|0,(0|o)<t[r>>2];){}f=t[e+12>>2];}if((0|f)>=2&&(Ni(e+8|0,e,0,f+-1|0),f=t[e+12>>2]),n=e+20|0,o=t[n>>2],(0|f)>=1)for(k=0,f=4;r=f+o|0,yf[t[t[A>>2]+8>>2]](A,t[r+-4>>2],t[r>>2]),f=f+16|0,o=t[n>>2],k=k+1|0,(0|k)<t[e+12>>2];){}o&&(b[e+24|0]&&gA(o),t[e+20>>2]=0),E=e+32|0;},Cr,function(A,r){A|=0,r|=0;var e=0;return e=t[A+4>>2],(0|e)==t[r>>2]|(0|e)==t[r+4>>2]?(e=t[A+8>>2],yf[t[t[e>>2]+32>>2]](e,r,t[A+12>>2]),0):0;},Cr,function(A,r){return A|=0,r|=0,A=t[A+4>>2],(0|A)==t[r>>2]|(0|A)==t[r+4>>2];},Fi,function(A){A|=0,rA(Fi(A));},function(A,r,e,i,a,f,n,o){A|=0,r|=0,e|=0,i|=0,a|=0,f|=0,n|=0,o|=0;var k=0;return o=E-48|0,E=o,i=CA(64,16),t[i+8>>2]=n,t[i+4>>2]=f,t[i>>2]=a,a=r+8|0,n=a,k=t[n+4>>2],f=i+24|0,t[f>>2]=t[n>>2],t[f+4>>2]=k,f=t[r+4>>2],t[i+16>>2]=t[r>>2],t[i+20>>2]=f,f=e+8|0,k=t[f+4>>2],n=i+40|0,t[n>>2]=t[f>>2],t[n+4>>2]=k,n=t[e+4>>2],t[i+32>>2]=t[e>>2],t[i+36>>2]=n,t[i+52>>2]=0,t[i+56>>2]=0,k=t[f+4>>2],n=o+40|0,t[n>>2]=t[f>>2],t[n+4>>2]=k,n=t[a+4>>2],f=o+24|0,t[f>>2]=t[a>>2],t[f+4>>2]=n,a=t[r>>2],r=t[r+4>>2],f=t[e+4>>2],e=t[e>>2],t[i+60>>2]=t[A+104>>2],n=t[A+148>>2]+1|0,t[A+148>>2]=n,t[o+32>>2]=e,t[o+36>>2]=f,t[i+12>>2]=n,t[o+16>>2]=a,t[o+20>>2]=r,e=A+4|0,r=ke(e,o+16|0,i),t[i+52>>2]=0,t[i+48>>2]=r,r=84+((t[A+104>>2]<<2)+A|0)|0,t[i+56>>2]=t[r>>2],a=t[r>>2],a&&(t[a+52>>2]=i),t[r>>2]=i,b[A+153|0]?(E=o+48|0,0|i):(t[o+8>>2]=i,t[o>>2]=19316,t[o+4>>2]=A,Zi(e,t[A+4>>2],o+16|0,o),A=A+44|0,Zi(A,t[A>>2],o+16|0,o),E=o+48|0,0|i);},function(A,r,e){A|=0,r|=0,e|=0;var i,f=0;2!=t[r+60>>2]?ue(A+4|0,t[r+48>>2]):ue(A+44|0,t[r+48>>2]),i=t[r+56>>2],f=t[r+52>>2],f=f?f+56|0:84+((t[r+60>>2]<<2)+A|0)|0,t[f>>2]=i,f=t[r+56>>2],f&&(t[f+52>>2]=t[r+52>>2]),f=t[A+96>>2],yf[t[t[f>>2]+16>>2]](f,r,e),gA(r),a[A+154|0]=1;},function(A,r,e,i,f){A|=0,r|=0,e|=0,i|=0,f|=0;var n=0,o=0,k=0,c=B(0),u=B(0),l=B(0),s=0,d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=0,h=0;f=E-48|0,E=f,k=e+8|0,o=t[k+4>>2],n=f+24|0,t[n>>2]=t[k>>2],t[n+4>>2]=o,k=i+8|0,o=t[k+4>>2],n=f+40|0,t[n>>2]=t[k>>2],t[n+4>>2]=o,n=t[e+4>>2],t[f+16>>2]=t[e>>2],t[f+20>>2]=n,n=t[i+4>>2],t[f+32>>2]=t[i>>2],t[f+36>>2]=n,2!=t[r+60>>2]?(k=1,t[A+128>>2]=t[A+128>>2]+1,n=t[r+48>>2],!(C[n>>2]<=C[f+32>>2]^1|C[n+16>>2]>=C[f+16>>2]^1|C[n+4>>2]<=C[f+36>>2]^1|C[n+20>>2]>=C[f+20>>2]^1)&&C[n+8>>2]<=C[f+40>>2]&&C[n+24>>2]>=C[f+24>>2]?(u=C[r+20>>2],l=C[r+24>>2],_=C[e>>2],m=C[e+4>>2],R=C[e+8>>2],d=C[r+16>>2],t[f+12>>2]=0,c=C[A+100>>2],v=B(c*B(B(C[r+40>>2]-l)*B(.5))),C[f+8>>2]=v,g=B(c*B(B(C[r+36>>2]-u)*B(.5))),C[f+4>>2]=g,c=B(c*B(B(C[r+32>>2]-d)*B(.5))),C[f>>2]=c,u=B(m-u),B(_-d)<B(0)&&(C[f>>2]=-c),l=B(R-l),u<B(0)&&(C[f+4>>2]=-g),l<B(0)&&(C[f+8>>2]=-v),k=0,function(A,r,e,i){var a=0,f=B(0),n=0,b=0,o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=0;o=C[e>>2];A:{if(C[r>>2]<=o){if(f=C[e+4>>2],!(C[r+4>>2]<=f^1|C[r+8>>2]<=C[e+8>>2]^1|C[r+16>>2]>=C[e+16>>2]^1|C[r+20>>2]>=C[e+20>>2]^1)&&(a=0,C[r+24>>2]>=C[e+24>>2]))break A;}else f=C[e+4>>2];c=B(f-B(.05000000074505806)),C[e+4>>2]=c,k=B(o-B(.05000000074505806)),C[e>>2]=k,u=B(C[e+8>>2]-B(.05000000074505806)),C[e+8>>2]=u,l=B(C[e+16>>2]+B(.05000000074505806)),C[e+16>>2]=l,a=e+20|0,f=B(C[a>>2]+B(.05000000074505806)),C[a>>2]=f,n=e+24|0,o=B(C[n>>2]+B(.05000000074505806)),C[n>>2]=o,s=C[i>>2],a=s>B(0),C[(a<<4)+e>>2]=(a?l:k)+s,k=C[i+4>>2],a=k>B(0),C[(a?20:4)+e>>2]=(a?f:c)+k,f=C[i+8>>2],i=f>B(0),C[(i?24:8)+e>>2]=(i?o:u)+f;r:{e:{if(i=be(A,r),i){if(b=t[A+8>>2],(0|b)<0)break e;if(!b)break r;for(;;){if(a=t[i+32>>2],!a)break r;if(i=a,d=d+1|0,!((0|d)<(0|b)))break;}break r;}i=0;break r;}i=t[A>>2];}a=t[e+4>>2],t[r>>2]=t[e>>2],t[r+4>>2]=a,a=t[n+4>>2],b=r+24|0,t[b>>2]=t[n>>2],t[b+4>>2]=a,a=e+16|0,n=t[a+4>>2],b=r+16|0,t[b>>2]=t[a>>2],t[b+4>>2]=n,e=e+8|0,a=t[e+4>>2],n=r+8|0,t[n>>2]=t[e>>2],t[n+4>>2]=a,oe(A,i,r),a=1;}return a;}(A+4|0,n,f+16|0,f)&&(k=1,t[A+132>>2]=t[A+132>>2]+1)):(ce(A+4|0,n,f+16|0),t[A+132>>2]=t[A+132>>2]+1)):(ue(A+44|0,t[r+48>>2]),G=r,h=ke(A+4|0,f+16|0,r),t[G+48>>2]=h,k=1),o=t[r+56>>2],n=t[r+52>>2],n=n?n+56|0:84+((t[r+60>>2]<<2)+A|0)|0,t[n>>2]=o,n=r+56|0,o=t[n>>2],o&&(t[o+52>>2]=t[r+52>>2]),o=t[e+4>>2],t[r+16>>2]=t[e>>2],t[r+20>>2]=o,e=e+8|0,s=t[e+4>>2],o=r+24|0,t[o>>2]=t[e>>2],t[o+4>>2]=s,o=i+8|0,s=t[o+4>>2],e=r+40|0,t[e>>2]=t[o>>2],t[e+4>>2]=s,e=t[i+4>>2],t[r+32>>2]=t[i>>2],t[r+36>>2]=e,t[r+52>>2]=0,i=t[A+104>>2],e=84+((i<<2)+A|0)|0,t[n>>2]=t[e>>2],t[r+60>>2]=i,i=t[e>>2],i&&(t[i+52>>2]=r),t[e>>2]=r,k&&(a[A+154|0]=1,!b[A+153|0])?(t[f>>2]=19316,t[f+4>>2]=A,e=A+44|0,Ei(e,t[e>>2],t[r+48>>2],f),Ei(A+4|0,t[A+4>>2],t[r+48>>2],f),E=f+48|0):E=f+48|0;},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a=0;A=t[r+20>>2],t[e>>2]=t[r+16>>2],t[e+4>>2]=A,A=e+8|0,e=r+24|0,a=t[e+4>>2],t[A>>2]=t[e>>2],t[A+4>>2]=a,e=r+40|0,a=t[e+4>>2],A=i+8|0,t[A>>2]=t[e>>2],t[A+4>>2]=a,A=t[r+36>>2],t[i>>2]=t[r+32>>2],t[i+4>>2]=A;},function(A,r,e,i,a,f){var n,b,o;A|=0,r|=0,e|=0,i|=0,a|=0,f|=0,e=E-16|0,E=e,t[e+8>>2]=19388,t[e+12>>2]=i,n=i+4|0,b=i+20|0,o=t[A+168>>2],Yi(A+4|0,t[A+4>>2],r,n,b,C[i+32>>2],a,f,o,e+8|0),A=A+44|0,Yi(A,t[A>>2],r,n,b,C[i+32>>2],a,f,o,e+8|0),E=e+16|0;},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f=0,n=0;a=E-48|0,E=a,t[a+44>>2]=i,t[a+40>>2]=19460,f=r+8|0,n=t[f+4>>2],i=a+16|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,f=e+8|0,n=t[f+4>>2],i=a+32|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,i=t[r+4>>2],t[a+8>>2]=t[r>>2],t[a+12>>2]=i,r=t[e+4>>2],t[a+24>>2]=t[e>>2],t[a+28>>2]=r,Zi(A+4|0,t[A+4>>2],a+8|0,a+40|0),A=A+44|0,Zi(A,t[A>>2],a+8|0,a+40|0),E=a+48|0;},function(A,r){A|=0,r|=0,function(A,r){var e=0,i=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,g=B(0);if(o=E-32|0,E=o,s=A+4|0,te(s,1+((0|_(t[A+112>>2],t[A+16>>2]))/100|0)|0),t[A+124>>2]&&(e=1+((0|_(t[A+108>>2],t[A+56>>2]))/100|0)|0,te(A+44|0,e),i=A+124|0,e=t[i>>2]-e|0,t[i>>2]=(0|e)>0?e:0),i=(t[A+104>>2]+1|0)%2|0,t[A+104>>2]=i,e=t[84+((i<<2)+A|0)>>2],e){for(u=A+44|0,k=o+16|0,c=A+92|0;;){n=e+56|0,i=t[n>>2],f=t[e+52>>2];A:{r:{if(!f){if(t[84+((t[e+60>>2]<<2)+A|0)>>2]=i,f=t[n>>2],f)break r;break A;}if(t[f+56>>2]=i,f=t[n>>2],!f)break A;}t[f+52>>2]=t[e+52>>2];}if(t[e+52>>2]=0,t[n>>2]=t[c>>2],f=t[c>>2],f&&(t[f+52>>2]=e),t[c>>2]=e,ue(s,t[e+48>>2]),n=e+24|0,f=t[n+4>>2],l=o+8|0,t[l>>2]=t[n>>2],t[l+4>>2]=f,d=t[e+16>>2],v=t[e+20>>2],f=t[e+36>>2],t[k>>2]=t[e+32>>2],t[k+4>>2]=f,n=e+40|0,f=t[n+4>>2],l=k+8|0,t[l>>2]=t[n>>2],t[l+4>>2]=f,t[o>>2]=d,t[o+4>>2]=v,f=ke(u,o,e),t[e+60>>2]=2,t[e+48>>2]=f,e=i,!e)break;}a[A+154|0]=1,t[A+124>>2]=t[A+56>>2];}if(t[o>>2]=19316,t[o+4>>2]=A,b[A+153|0]&&(Ei(s,t[A+4>>2],t[A+44>>2],o),b[A+153|0]&&(i=t[s>>2],Ei(s,i,i,o))),b[A+154|0]&&(i=t[A+96>>2],d=0|yf[t[t[i>>2]+28>>2]](i),f=t[d+4>>2],!((0|f)<1))){c=A+144|0,e=t[A+120>>2],i=(0|_(t[A+116>>2],f))/100|0,i=(0|e)>(0|i)?e:i,u=(0|f)<(0|i)?f:i;A:{if((0|u)>=1){for(e=0,v=d+12|0,l=A+96|0;i=t[v>>2]+((t[c>>2]+e|0)%(0|f)<<4)|0,n=t[i>>2],k=t[n+48>>2],f=t[i+4>>2],i=t[f+48>>2],!(C[k>>2]<=C[i+16>>2]^1|C[k+16>>2]>=C[i>>2]^1|C[k+4>>2]<=C[i+20>>2]^1|C[k+20>>2]>=C[i+4>>2]^1)&&C[k+8>>2]<=C[i+24>>2]&&C[k+24>>2]>=C[i+8>>2]||(i=t[l>>2],yf[t[t[i>>2]+12>>2]](i,n,f,r),e=e+-1|0,u=u+-1|0),f=t[d+4>>2],e=e+1|0,(0|e)<(0|u);){}if(c=A+144|0,e=0,(0|f)<=0)break A;}e=(t[c>>2]+u|0)%(0|f)|0;}t[c>>2]=e;}t[A+120>>2]=1,a[A+154|0]=0,t[A+140>>2]=t[A+140>>2]+1,i=t[A+132>>2],e=A,r=t[A+128>>2],g=B(r?B(i>>>0)/B(r>>>0):0),C[e+136>>2]=g,t[A+132>>2]=i>>>1,t[A+128>>2]=r>>>1,E=o+32|0;}(A,r),function(A,r){var e=0,i=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,g=0;if(s=E-16|0,E=s,e=t[A+96>>2],yf[t[t[e>>2]+56>>2]](e)){if(e=t[A+96>>2],i=0|yf[t[t[e>>2]+28>>2]](e),f=t[i+4>>2],(0|f)>=2&&(Ni(i,s+8|0,0,f+-1|0),f=t[i+4>>2]),(0|f)>=1){for(v=i+12|0,g=A+96|0,e=0;;){k=t[v>>2]+d|0,A=t[k+4>>2],n=c,c=t[k>>2];A:{r:if((0|A)!=(0|e)||(0|n)!=(0|c)){if(n=t[c+48>>2],o=t[A+48>>2],!(C[n>>2]<=C[o+16>>2]^1|C[n+16>>2]>=C[o>>2]^1|C[n+4>>2]<=C[o+20>>2]^1|C[n+20>>2]>=C[o+4>>2]^1)&&C[n+8>>2]<=C[o+24>>2]){if(e=A,!(C[n+24>>2]>=C[o+8>>2]))break r;break A;}e=A;}A=t[g>>2],yf[t[t[A>>2]+32>>2]](A,k,r),t[k>>2]=0,t[k+4>>2]=0,u=u+1|0,f=t[i+4>>2];}if(d=d+16|0,l=l+1|0,!((0|l)<(0|f)))break;}if((0|f)>=2&&(Ni(i,s,0,f+-1|0),f=t[i+4>>2]),r=f-u|0,(0|u)<=-1){if(t[i+8>>2]<(0|r)){A:{r:{if(r){if(l=CA(r<<4,16),e=t[i+4>>2],(0|e)>=1)break r;break A;}if(l=0,e=f,(0|e)<1)break A;}for(A=12;c=A+l|0,n=t[i+12>>2]+A|0,t[c+-12>>2]=t[n+-12>>2],k=n+-8|0,d=t[k+4>>2],o=c+-8|0,t[o>>2]=t[k>>2],t[o+4>>2]=d,t[c>>2]=t[n>>2],A=A+16|0,e=e+-1|0,e;){}}A=t[i+12>>2],A&&(b[i+16|0]&&gA(A),t[i+12>>2]=0),a[i+16|0]=1,t[i+12>>2]=l,t[i+8>>2]=r;}for(A=f<<4,f=i+12|0;e=t[f>>2]+A|0,t[e>>2]=0,t[e+4>>2]=0,e=e+8|0,t[e>>2]=0,t[e+4>>2]=0,A=A+16|0,u=u+1|0,u;){}}f=r;}t[i+4>>2]=f;}E=s+16|0;}(A,r);},br,br,function(A,r,e){A|=0,r|=0,e|=0;var i,a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0);i=t[A+44>>2];A:r:{e:{i:{if(A=t[A+4>>2],A){if(n=C[A>>2],!i)break i;if(a=C[A+20>>2],f=C[i+20>>2],b=a>f?a:f,a=C[A+8>>2],f=C[i+8>>2],o=a<f?a:f,a=C[A+4>>2],f=C[i+4>>2],k=a<f?a:f,a=C[A+16>>2],f=C[i+16>>2],c=a>f?a:f,a=C[i>>2],n=n<a?n:a,a=C[A+24>>2],f=C[i+24>>2],!(a>f))break e;break A;}if(!i)break r;f=C[i+28>>2],a=C[i+24>>2],b=C[i+20>>2],c=C[i+16>>2],u=C[i+12>>2],o=C[i+8>>2],k=C[i+4>>2],n=C[i>>2];break A;}f=C[A+28>>2],a=C[A+24>>2],b=C[A+20>>2],c=C[A+16>>2],u=C[A+12>>2],o=C[A+8>>2],k=C[A+4>>2];break A;}a=f;break A;}C[r+12>>2]=u,C[r+8>>2]=o,C[r+4>>2]=k,C[r>>2]=n,C[e+12>>2]=f,C[e+8>>2]=a,C[e+4>>2]=b,C[e>>2]=c;},function(A,r){A|=0,r|=0,t[A+16>>2]==(0-t[A+56>>2]|0)&&(ne(A+4|0),ne(A+44|0),a[A+153|0]=256,a[A+154|0]=1,t[A+124>>2]=0,t[A+104>>2]=0,t[A+116>>2]=10,t[A+120>>2]=1,t[A+108>>2]=1,t[A+112>>2]=0,t[A+92>>2]=0,r=A+84|0,t[r>>2]=0,t[r+4>>2]=0,r=A+144|0,t[r>>2]=0,t[r+4>>2]=0,r=A+136|0,t[r>>2]=0,t[r+4>>2]=0,t[A+128>>2]=0,t[A+132>>2]=0);},Ae,Cr,function(A,r,e){A|=0,r|=0,e|=0;var i=0;(0|r)!=(0|e)&&(i=t[t[A+4>>2]+96>>2],yf[t[t[i>>2]+8>>2]](i,t[r+36>>2],t[e+36>>2]),A=t[A+4>>2],t[A+120>>2]=t[A+120>>2]+1);},function(A,r){A|=0,r|=0,yf[t[t[A>>2]+8>>2]](A,r,t[t[A+8>>2]+48>>2]);},Cr,Vi,Cr,Vi,function(A){A|=0;var r,e=0;return t[A>>2]=19556,e=A+556|0,r=t[e>>2],r&&(b[A+560|0]&&gA(r),t[A+556>>2]=0),t[e>>2]=0,a[A+560|0]=1,e=A+548|0,t[e>>2]=0,t[e+4>>2]=0,Nr(A),0|A;},function(A){A|=0;var r,e=0;t[A>>2]=19556,e=A+556|0,r=t[e>>2],r&&(b[A+560|0]&&gA(r),t[A+556>>2]=0),t[e>>2]=0,a[A+560|0]=1,e=A+548|0,t[e>>2]=0,t[e+4>>2]=0,Nr(A),gA(A);},function(A){return 496;},function(A,r,e){return A|=0,r|=0,e|=0,Jr(A,r,e),t[r+264>>2]=t[A+324>>2],t[r+268>>2]=t[A+328>>2],t[r+272>>2]=t[A+332>>2],t[r+276>>2]=t[A+336>>2],t[r+280>>2]=t[A+340>>2],t[r+284>>2]=t[A+344>>2],t[r+288>>2]=t[A+348>>2],t[r+292>>2]=t[A+352>>2],t[r+296>>2]=t[A+356>>2],t[r+300>>2]=t[A+360>>2],t[r+304>>2]=t[A+364>>2],t[r+308>>2]=t[A+368>>2],t[r+312>>2]=t[A+372>>2],t[r+316>>2]=t[A+376>>2],t[r+320>>2]=t[A+380>>2],t[r+324>>2]=t[A+384>>2],t[r+328>>2]=t[A+388>>2],t[r+332>>2]=t[A+392>>2],t[r+336>>2]=t[A+396>>2],t[r+340>>2]=t[A+400>>2],t[r+456>>2]=t[A+404>>2],t[r+344>>2]=t[A+604>>2],t[r+348>>2]=t[A+608>>2],t[r+352>>2]=t[A+612>>2],t[r+356>>2]=t[A+616>>2],t[r+360>>2]=t[A+408>>2],t[r+364>>2]=t[A+412>>2],t[r+368>>2]=t[A+416>>2],t[r+372>>2]=t[A+420>>2],t[r+376>>2]=t[A+424>>2],t[r+380>>2]=t[A+428>>2],t[r+384>>2]=t[A+432>>2],t[r+388>>2]=t[A+436>>2],t[r+392>>2]=t[A+440>>2],t[r+396>>2]=t[A+444>>2],t[r+400>>2]=t[A+448>>2],t[r+404>>2]=t[A+452>>2],t[r+408>>2]=t[A+456>>2],t[r+412>>2]=t[A+460>>2],t[r+416>>2]=t[A+464>>2],t[r+420>>2]=t[A+468>>2],t[r+424>>2]=t[A+472>>2],t[r+428>>2]=t[A+476>>2],t[r+432>>2]=t[A+480>>2],t[r+436>>2]=t[A+484>>2],t[r+440>>2]=t[A+488>>2],t[r+444>>2]=t[A+492>>2],t[r+448>>2]=t[A+496>>2],t[r+452>>2]=t[A+500>>2],e=t[A+508>>2],t[r+460>>2]=t[A+504>>2],t[r+464>>2]=e,e=t[A+520>>2],t[r+468>>2]=t[A+516>>2],t[r+472>>2]=e,e=t[A+528>>2],t[r+476>>2]=t[A+524>>2],t[r+480>>2]=e,e=t[A+536>>2],t[r+484>>2]=t[A+532>>2],t[r+488>>2]=e,t[r+492>>2]=b[A+512|0],19584;},function(A,r){A|=0,r|=0;var e,i=0,a=0,f=0,n=0,b=0;f=r,n=0|yf[t[t[A>>2]+16>>2]](A),b=1,a=t[t[r>>2]+16>>2],i=0|yf[a](0|f,0|n,0|b),b=r,n=i,f=0|yf[t[t[A>>2]+20>>2]](A,t[i+8>>2],r),e=A,a=t[t[r>>2]+20>>2],yf[a](0|b,0|n,0|f,1497645650,0|e);},function(A,r,e){A|=0,r|=0,e|=0;var i=B(0),a=B(0),f=B(0),n=B(0),b=0,o=0,k=0,c=0,u=0,l=B(0),s=B(0),d=B(0);return a=C[e+128>>2],a!=B(0)&&(t[704]=t[704]+1,i=C[e+96>>2],f=B(a-B(i*C[e+116>>2])),n=C[e+16>>2],l=C[e+20>>2],b=A+148|0,s=C[e+24>>2],k=A+152|0,c=A+164|0,u=A+168|0,a=C[e+108>>2],a=B(B(f-B(B(B(B(B(n*C[A+144>>2])+B(l*C[b>>2]))+B(s*C[k>>2]))+B(B(B(C[e>>2]*C[A+160>>2])+B(C[e+4>>2]*C[c>>2]))+B(C[e+8>>2]*C[u>>2])))*a))-B(a*B(B(B(B(C[e+48>>2]*C[r+144>>2])+B(C[e+52>>2]*C[r+148>>2]))+B(C[e+56>>2]*C[r+152>>2]))+B(B(B(C[e+32>>2]*C[r+160>>2])+B(C[e+36>>2]*C[r+164>>2]))+B(C[e+40>>2]*C[r+168>>2]))))),d=B(i+a),f=C[e+120>>2],o=d<f,C[e+96>>2]=o?f:d,i=o?B(f-i):a,t[A+240>>2]&&(o=A+144|0,C[o>>2]=B(C[A+112>>2]*B(i*B(n*C[A+128>>2])))+C[o>>2],C[b>>2]=B(B(i*B(l*C[A+132>>2]))*C[A+116>>2])+C[b>>2],C[k>>2]=B(B(i*B(s*C[A+136>>2]))*C[A+120>>2])+C[k>>2],a=C[e+72>>2],f=C[e+68>>2],b=A+160|0,C[b>>2]=B(B(i*C[A+96>>2])*C[e+64>>2])+C[b>>2],n=C[A+104>>2],C[c>>2]=B(f*B(i*C[A+100>>2]))+C[c>>2],C[u>>2]=B(a*B(i*n))+C[u>>2]),t[r+240>>2]&&(a=C[e+56>>2],f=C[e+52>>2],A=r+144|0,C[A>>2]=B(C[r+112>>2]*B(i*B(C[e+48>>2]*C[r+128>>2])))+C[A>>2],A=r+148|0,C[A>>2]=B(B(i*B(f*C[r+132>>2]))*C[r+116>>2])+C[A>>2],A=r+152|0,C[A>>2]=B(B(i*B(a*C[r+136>>2]))*C[r+120>>2])+C[A>>2],a=C[e+88>>2],f=C[e+84>>2],A=r+160|0,C[A>>2]=B(B(i*C[r+96>>2])*C[e+80>>2])+C[A>>2],n=C[r+104>>2],A=r+164|0,C[A>>2]=B(f*B(i*C[r+100>>2]))+C[A>>2],A=r+168|0,C[A>>2]=B(a*B(i*n))+C[A>>2])),B(i);},function(A,r,e){A|=0,r|=0,e|=0;var i,a,f,n=B(0),b=B(0),o=B(0),k=B(0),c=0,u=0,l=B(0),s=B(0),d=B(0);return n=C[e+100>>2],k=C[e+16>>2],l=C[e+20>>2],c=A+68|0,s=C[e+24>>2],i=A+72|0,a=A+84|0,f=A+88|0,b=C[e+108>>2],b=B(B(B(C[e+112>>2]-B(n*C[e+116>>2]))-B(B(B(B(B(k*C[A+64>>2])+B(l*C[c>>2]))+B(s*C[i>>2]))+B(B(B(C[e>>2]*C[A+80>>2])+B(C[e+4>>2]*C[a>>2]))+B(C[e+8>>2]*C[f>>2])))*b))-B(b*B(B(B(B(C[e+48>>2]*C[r+64>>2])+B(C[e+52>>2]*C[r+68>>2]))+B(C[e+56>>2]*C[r+72>>2]))+B(B(B(C[e+32>>2]*C[r+80>>2])+B(C[e+36>>2]*C[r+84>>2]))+B(C[e+40>>2]*C[r+88>>2]))))),d=B(n+b),o=C[e+120>>2],u=d<o,C[e+100>>2]=u?o:d,n=u?B(o-n):b,t[A+240>>2]&&(u=A- -64|0,C[u>>2]=B(C[A+112>>2]*B(n*B(k*C[A+128>>2])))+C[u>>2],C[c>>2]=B(B(n*B(l*C[A+132>>2]))*C[A+116>>2])+C[c>>2],C[i>>2]=B(B(n*B(s*C[A+136>>2]))*C[A+120>>2])+C[i>>2],b=C[e+72>>2],o=C[e+68>>2],c=A+80|0,C[c>>2]=B(B(n*C[A+96>>2])*C[e+64>>2])+C[c>>2],k=C[A+104>>2],C[a>>2]=B(o*B(n*C[A+100>>2]))+C[a>>2],C[f>>2]=B(b*B(n*k))+C[f>>2]),t[r+240>>2]&&(b=C[e+56>>2],o=C[e+52>>2],A=r- -64|0,C[A>>2]=B(C[r+112>>2]*B(n*B(C[e+48>>2]*C[r+128>>2])))+C[A>>2],A=r+68|0,C[A>>2]=B(B(n*B(o*C[r+132>>2]))*C[r+116>>2])+C[A>>2],A=r+72|0,C[A>>2]=B(B(n*B(b*C[r+136>>2]))*C[r+120>>2])+C[A>>2],b=C[e+88>>2],o=C[e+84>>2],A=r+80|0,C[A>>2]=B(B(n*C[r+96>>2])*C[e+80>>2])+C[A>>2],k=C[r+104>>2],A=r+84|0,C[A>>2]=B(o*B(n*C[r+100>>2]))+C[A>>2],A=r+88|0,C[A>>2]=B(b*B(n*k))+C[A>>2]),B(n);},function(A,r,e){A|=0,r|=0,e|=0;var i=B(0),a=B(0),f=0,n=B(0),b=B(0),o=B(0),k=B(0),c=B(0);return b=C[e+100>>2],o=C[e+16>>2],k=C[e+20>>2],c=C[e+24>>2],a=C[e+108>>2],i=B(B(B(C[e+112>>2]-B(b*C[e+116>>2]))-B(B(B(B(B(o*C[A+64>>2])+B(k*C[A+68>>2]))+B(c*C[A+72>>2]))+B(B(B(C[e>>2]*C[A+80>>2])+B(C[e+4>>2]*C[A+84>>2]))+B(C[e+8>>2]*C[A+88>>2])))*a))-B(a*B(B(B(B(C[e+48>>2]*C[r+64>>2])+B(C[e+52>>2]*C[r+68>>2]))+B(C[e+56>>2]*C[r+72>>2]))+B(B(B(C[e+32>>2]*C[r+80>>2])+B(C[e+36>>2]*C[r+84>>2]))+B(C[e+40>>2]*C[r+88>>2]))))),a=B(b+i),n=C[e+120>>2],a<n?(i=B(n-b),a=n):(n=C[e+124>>2],a>n&&(i=B(n-b),a=n)),C[e+100>>2]=a,t[A+240>>2]&&(f=A- -64|0,C[f>>2]=B(C[A+112>>2]*B(i*B(o*C[A+128>>2])))+C[f>>2],f=A+68|0,C[f>>2]=B(B(i*B(k*C[A+132>>2]))*C[A+116>>2])+C[f>>2],f=A+72|0,C[f>>2]=B(B(i*B(c*C[A+136>>2]))*C[A+120>>2])+C[f>>2],a=C[e+72>>2],n=C[e+68>>2],f=A+80|0,C[f>>2]=B(B(i*C[A+96>>2])*C[e+64>>2])+C[f>>2],b=C[A+104>>2],f=A+84|0,C[f>>2]=B(n*B(i*C[A+100>>2]))+C[f>>2],A=A+88|0,C[A>>2]=B(a*B(i*b))+C[A>>2]),t[r+240>>2]&&(a=C[e+56>>2],n=C[e+52>>2],A=r- -64|0,C[A>>2]=B(C[r+112>>2]*B(i*B(C[e+48>>2]*C[r+128>>2])))+C[A>>2],A=r+68|0,C[A>>2]=B(B(i*B(n*C[r+132>>2]))*C[r+116>>2])+C[A>>2],A=r+72|0,C[A>>2]=B(B(i*B(a*C[r+136>>2]))*C[r+120>>2])+C[A>>2],a=C[e+88>>2],n=C[e+84>>2],A=r+80|0,C[A>>2]=B(B(i*C[r+96>>2])*C[e+80>>2])+C[A>>2],b=C[r+104>>2],A=r+84|0,C[A>>2]=B(n*B(i*C[r+100>>2]))+C[A>>2],A=r+88|0,C[A>>2]=B(a*B(i*b))+C[A>>2]),B(i);},Aa,function(A){A|=0,gA(Aa(A));},Yr,function(A,r,e,i,a,f,n,b,o,k){return A|=0,r|=0,e|=0,i|=0,a|=0,f|=0,n|=0,b|=0,o|=0,k|=0,k=E-16|0,E=k,$e(k+8|0,19755),B(yf[t[t[A>>2]+44>>2]](A,r,e,i,a,f,n,b,o)),B(yf[t[t[A>>2]+48>>2]](A,r,e,i,a,f,n,b,o)),B(yf[t[t[A>>2]+36>>2]](A,r,e,b)),Ai(),E=k+16|0,B(B(0));},Yr,function(A){A|=0,t[A+232>>2]=0;},Fr,function(A,r,e,i){if(A|=0,r|=0,e|=0,i|=0,(0|e)>=1)for(;ta(A,t[r>>2],i),r=r+4|0,e=e+-1|0,e;){}},function(A,r,e,i,a,f,n,b,o){A|=0,r|=0,e|=0,i|=0,a|=0,f|=0,n|=0,b|=0,o|=0;var k=B(0),c=0,u=0,l=0,s=B(0);A:if(!(!t[b+52>>2]|t[b+20>>2]<1))for(r=0,i=A+28|0,a=A+116|0,f=A+36|0,n=A+16|0,o=A+220|0,u=b+92|0,l=b+20|0;;){if(k=B(0),A=t[i>>2],(0|A)>=1)for(b=0;s=k,c=t[n>>2],e=t[f>>2]+_(t[t[a>>2]+b>>2],152)|0,k=B(yf[t[o>>2]](c+_(t[e+144>>2],244)|0,_(t[e+148>>2],244)+c|0,e)),k=B(s+B(k*k)),b=b+4|0,A=A+-1|0,A;){}if(k<=C[u>>2])break A;if(A=t[l>>2],(0|r)>=(A+-1|0))break A;if(r=r+1|0,!((0|r)<(0|A)))break;}},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var f=0,n=0,o=0,k=0,c=B(0),u=B(0),l=0,s=0,d=B(0),v=B(0),g=B(0),R=B(0),G=0,h=0;if(l=t[i+72>>2],4&l&&(n=t[A+28>>2],!((0|n)<1)))if(e=t[A+76>>2],r=t[A+36>>2],16&l)for(r=r+140|0;l=t[r+-8>>2],t[l+124>>2]=t[r+-40>>2],k=e+_(t[r>>2],152)|0,t[l+128>>2]=t[k+100>>2],t[l+132>>2]=t[k+252>>2],r=r+152|0,n=n+-1|0,n;){}else for(r=r+140|0;l=t[r+-8>>2],t[l+124>>2]=t[r+-40>>2],t[l+128>>2]=t[100+(e+_(t[r>>2],152)|0)>>2],r=r+152|0,n=n+-1|0,n;){}if(G=t[A+48>>2],(0|G)>=1)for(l=100,h=A+56|0,f=i+12|0;e=t[h>>2]+l|0,n=t[e+32>>2],r=t[n+44>>2],r&&(k=t[n+28>>2],d=C[k+416>>2],v=C[e+-76>>2],g=C[k+412>>2],R=C[e+-80>>2],c=C[e>>2],u=B(B(1)/C[f>>2]),C[r>>2]=C[r>>2]+B(B(B(C[e+-84>>2]*c)*C[k+408>>2])*u),C[r+4>>2]=B(B(g*B(c*R))*u)+C[r+4>>2],C[r+8>>2]=B(B(d*B(c*v))*u)+C[r+8>>2],o=t[n+32>>2],d=C[o+416>>2],v=C[e+-44>>2],g=C[o+412>>2],R=C[e+-48>>2],c=C[e>>2],u=B(B(1)/C[f>>2]),C[r+32>>2]=C[r+32>>2]+B(B(B(C[e+-52>>2]*c)*C[o+408>>2])*u),s=r+36|0,C[s>>2]=B(B(g*B(c*R))*u)+C[s>>2],s=r+40|0,C[s>>2]=B(B(d*B(c*v))*u)+C[s>>2],d=C[k+612>>2],v=C[e+-92>>2],g=C[k+608>>2],R=C[e+-96>>2],c=C[e>>2],u=B(B(1)/C[f>>2]),C[r+16>>2]=C[r+16>>2]+B(B(B(C[e+-100>>2]*C[k+604>>2])*c)*u),k=r+20|0,C[k>>2]=B(B(c*B(R*g))*u)+C[k>>2],k=r+24|0,C[k>>2]=B(B(c*B(v*d))*u)+C[k>>2],d=C[o+612>>2],v=C[e+-60>>2],g=C[o+608>>2],R=C[e+-64>>2],c=C[e>>2],u=B(B(1)/C[f>>2]),C[r+48>>2]=C[r+48>>2]+B(B(B(C[e+-68>>2]*C[o+604>>2])*c)*u),k=r+52|0,C[k>>2]=B(B(c*B(R*g))*u)+C[k>>2],r=r+56|0,C[r>>2]=B(B(c*B(v*d))*u)+C[r>>2]),c=C[e>>2],C[n+36>>2]=c,B(m(c))>=C[n+16>>2]&&(a[n+20|0]=0),l=l+152|0,G=G+-1|0,G;){}if(h=A+8|0,f=t[h>>2],(0|f)>=1)for(k=A+16|0,o=t[k>>2],r=176,G=i+52|0,l=0;e=r+o|0,n=t[e- -64>>2],n&&(t[G>>2]?(ba(e+-176|0,C[i+12>>2],C[i+60>>2]),o=t[k>>2],e=o+r|0,d=C[e>>2],c=C[e+8>>2],u=C[e+4>>2],n=t[e- -64>>2]):(d=B(C[e+-112>>2]+C[e>>2]),C[e>>2]=d,f=e+4|0,u=B(C[e+-108>>2]+C[f>>2]),C[f>>2]=u,f=e+8|0,c=B(C[e+-104>>2]+C[f>>2]),C[f>>2]=c,f=e+16|0,C[f>>2]=C[e+-96>>2]+C[f>>2],f=e+20|0,C[f>>2]=C[e+-92>>2]+C[f>>2],f=e+24|0,C[f>>2]=C[e+-88>>2]+C[f>>2]),e=r+o|0,v=C[e+32>>2],g=C[e+36>>2],R=C[e+40>>2],t[n+384>>2]=0,C[n+380>>2]=c+R,C[n+376>>2]=u+g,C[n+372>>2]=d+v,t[n+304>>2]=t[n+304>>2]+1,e=t[k>>2]+r|0,c=C[e+16>>2],u=C[e+48>>2],d=C[e+20>>2],v=C[e+52>>2],g=C[e+24>>2],R=C[e+56>>2],e=t[e- -64>>2],t[e+400>>2]=0,C[e+396>>2]=g+R,C[e+392>>2]=d+v,C[e+388>>2]=c+u,t[e+304>>2]=t[e+304>>2]+1,t[G>>2]&&(n=t[k>>2]+r|0,e=t[n- -64>>2],t[e+304>>2]=t[e+304>>2]+1,f=n+-168|0,s=t[f+4>>2],o=e+12|0,t[o>>2]=t[f>>2],t[o+4>>2]=s,o=n+-176|0,f=t[o+4>>2],t[e+4>>2]=t[o>>2],t[e+8>>2]=f,f=n+-152|0,s=t[f+4>>2],o=e+28|0,t[o>>2]=t[f>>2],t[o+4>>2]=s,f=n+-160|0,s=t[f+4>>2],o=e+20|0,t[o>>2]=t[f>>2],t[o+4>>2]=s,f=n+-136|0,s=t[f+4>>2],o=e+44|0,t[o>>2]=t[f>>2],t[o+4>>2]=s,f=n+-144|0,s=t[f+4>>2],o=e+36|0,t[o>>2]=t[f>>2],t[o+4>>2]=s,f=n+-128|0,s=t[f+4>>2],o=e+52|0,t[o>>2]=t[f>>2],t[o+4>>2]=s,n=n+-120|0,o=t[n+4>>2],e=e+60|0,t[e>>2]=t[n>>2],t[e+4>>2]=o),o=t[k>>2],t[t[(o+r|0)- -64>>2]+212>>2]=-1,f=t[h>>2]),r=r+244|0,l=l+1|0,(0|l)<(0|f);){}return r=A+28|0,t[r>>2]>-1|t[A+32>>2]>-1||(e=t[A+36>>2],e&&(b[A+40|0]&&gA(e),t[A+36>>2]=0),a[A+40|0]=1,e=A+32|0,t[e>>2]=0,t[e+4>>2]=0),t[r>>2]=0,r=A+48|0,t[r>>2]>-1|t[A+52>>2]>-1||(e=t[A+56>>2],e&&(b[A+60|0]&&gA(e),t[A+56>>2]=0),a[A+60|0]=1,e=A+52|0,t[e>>2]=0,t[e+4>>2]=0),t[r>>2]=0,r=A+68|0,t[r>>2]>-1|t[A+72>>2]>-1||(e=t[A+76>>2],e&&(b[A+80|0]&&gA(e),t[A+76>>2]=0),a[A+80|0]=1,e=A+72|0,t[e>>2]=0,t[e+4>>2]=0),t[r>>2]=0,r=A+88|0,t[r>>2]>-1|t[A+92>>2]>-1||(e=t[A+96>>2],e&&(b[A+100|0]&&gA(e),t[A+96>>2]=0),a[A+100|0]=1,e=A+92|0,t[e>>2]=0,t[e+4>>2]=0),t[r>>2]=0,r=A+8|0,t[A+12>>2]<=-1&&t[r>>2]<=-1?(e=t[A+16>>2],e&&(b[A+20|0]&&gA(e),t[A+16>>2]=0),a[A+20|0]=1,A=A+12|0,t[A>>2]=0,t[A+4>>2]=0,t[r>>2]=0,B(B(0))):(t[r>>2]=0,B(B(0)));},function(A,r,e,i,f,n,o,k,c,u){A|=0,r|=0,e|=0,i|=0,f|=0,n|=0,o|=0,k|=0,c|=0,u|=0;var l=B(0),s=B(0),d=0,v=0,g=0,m=0,R=0,G=B(0),h=0,y=0,Q=0;if(h=A+48|0,1&a[c+72|0]){if(m=t[A+68>>2],v=t[A+28>>2],g=t[h>>2],(0|g)>=1){if(e=_(t[A+232>>2],1664525)+1013904223|0,1!=(0|g)&&(u=t[A+136>>2],i=t[u+4>>2],e=_(e,1664525)+1013904223|0,f=e^e>>>16,f^=f>>>8,f^=f>>>4,f^=f>>>2,f=u+((1&(f>>>1^f))<<2)|0,t[u+4>>2]=t[f>>2],t[f>>2]=i,2!=(0|g)&&(i=t[u+8>>2],e=_(e,1664525)+1013904223|0,f=e^e>>>16,f^=f>>>8,f^=f>>>4,f=u+(((f>>>2^f)>>>0)%3<<2)|0,t[u+8>>2]=t[f>>2],t[f>>2]=i,3!=(0|g)&&(i=t[u+12>>2],e=_(e,1664525)+1013904223|0,f=e^e>>>16,f^=f>>>8,f^=f>>>4,f=u+((3&(f>>>2^f))<<2)|0,t[u+12>>2]=t[f>>2],t[f>>2]=i,4!=(0|g)))))for(n=u+16|0,i=4;R=t[n>>2],y=n,Q=u,e=_(e,1664525)+1013904223|0,i=i+1|0,d=e,i>>>0>65536||(f=e>>>16^e,d=f,i>>>0>256||(f^=f>>>8,d=f,i>>>0>16||(d=f>>>4^f))),f=Q+((d>>>0)%(i>>>0)<<2)|0,t[y>>2]=t[f>>2],t[f>>2]=R,n=n+4|0,(0|i)!=(0|g);){}t[A+232>>2]=e;}if(!(t[c+20>>2]<=(0|r))){if((0|v)>=1){if(e=_(t[A+232>>2],1664525)+1013904223|0,1!=(0|v)&&(u=t[A+116>>2],i=t[u+4>>2],e=_(e,1664525)+1013904223|0,f=e^e>>>16,f^=f>>>8,f^=f>>>4,f^=f>>>2,f=u+((1&(f>>>1^f))<<2)|0,t[u+4>>2]=t[f>>2],t[f>>2]=i,2!=(0|v)&&(i=t[u+8>>2],e=_(e,1664525)+1013904223|0,f=e^e>>>16,f^=f>>>8,f^=f>>>4,f=u+(((f>>>2^f)>>>0)%3<<2)|0,t[u+8>>2]=t[f>>2],t[f>>2]=i,3!=(0|v)&&(i=t[u+12>>2],e=_(e,1664525)+1013904223|0,f=e^e>>>16,f^=f>>>8,f^=f>>>4,f=u+((3&(f>>>2^f))<<2)|0,t[u+12>>2]=t[f>>2],t[f>>2]=i,4!=(0|v)))))for(n=u+16|0,i=4;g=t[n>>2],y=n,Q=u,e=_(e,1664525)+1013904223|0,i=i+1|0,d=e,i>>>0>65536||(f=e>>>16^e,d=f,i>>>0>256||(f^=f>>>8,d=f,i>>>0>16||(d=f>>>4^f))),f=Q+((d>>>0)%(i>>>0)<<2)|0,t[y>>2]=t[f>>2],t[f>>2]=g,n=n+4|0,(0|i)!=(0|v);){}t[A+232>>2]=e;}if(!((0|m)<1)){if(e=_(t[A+232>>2],1664525)+1013904223|0,1!=(0|m)&&(u=t[A+156>>2],i=t[u+4>>2],e=_(e,1664525)+1013904223|0,f=e^e>>>16,f^=f>>>8,f^=f>>>4,f^=f>>>2,f=u+((1&(f>>>1^f))<<2)|0,t[u+4>>2]=t[f>>2],t[f>>2]=i,2!=(0|m)&&(i=t[u+8>>2],e=_(e,1664525)+1013904223|0,f=e^e>>>16,f^=f>>>8,f^=f>>>4,f=u+(((f>>>2^f)>>>0)%3<<2)|0,t[u+8>>2]=t[f>>2],t[f>>2]=i,3!=(0|m)&&(i=t[u+12>>2],e=_(e,1664525)+1013904223|0,f=e^e>>>16,f^=f>>>8,f^=f>>>4,f=u+((3&(f>>>2^f))<<2)|0,t[u+12>>2]=t[f>>2],t[f>>2]=i,4!=(0|m)))))for(n=u+16|0,i=4;v=t[n>>2],y=n,Q=u,e=_(e,1664525)+1013904223|0,i=i+1|0,d=e,i>>>0>65536||(f=e>>>16^e,d=f,i>>>0>256||(f^=f>>>8,d=f,i>>>0>16||(d=f>>>4^f))),f=Q+((d>>>0)%(i>>>0)<<2)|0,t[y>>2]=t[f>>2],t[f>>2]=v,n=n+4|0,(0|i)!=(0|m);){}t[A+232>>2]=e;}}}if(f=t[h>>2],(0|f)>=1)for(e=0,u=A+136|0,m=A+56|0,v=A+16|0,g=A+212|0,h=A+48|0,n=0;i=t[m>>2]+_(t[t[u>>2]+e>>2],152)|0,t[i+136>>2]>(0|r)&&(s=l,f=t[v>>2],l=B(yf[t[g>>2]](f+_(t[i+144>>2],244)|0,f+_(t[i+148>>2],244)|0,i)),l=B(s+B(l*l)),f=t[h>>2]),e=e+4|0,n=n+1|0,(0|n)<(0|f);){}if(!(t[c+20>>2]<=(0|r))){if((0|k)>=1)for(r=c+12|0,e=A+16|0;i=t[o>>2],b[i+20|0]&&(i=ia(A,t[i+28>>2],C[r>>2]),f=ia(A,t[t[o>>2]+32>>2],C[r>>2]),n=t[o>>2],u=_(i,244),i=t[e>>2],yf[t[t[n>>2]+24>>2]](n,u+i|0,i+_(f,244)|0,C[r>>2])),o=o+4|0,k=k+-1|0,k;){}e=t[A+28>>2],r=t[c+72>>2];A:if(512&r){if(!((0|e)<1))for(m=(16&r?2:1)<<2,n=0,v=A+116|0,g=A+36|0,i=A+16|0,h=A+216|0,f=A+76|0,k=A+156|0,u=A+212|0,c=c+72|0,o=0;s=l,R=t[i>>2],r=t[g>>2]+_(t[t[v>>2]+o>>2],152)|0,l=B(yf[t[h>>2]](R+_(t[r+144>>2],244)|0,R+_(t[r+148>>2],244)|0,r)),l=B(s+B(l*l)),s=C[r+100>>2],R=s>B(0)^1,R||(r=t[f>>2]+_(t[t[k>>2]+n>>2],152)|0,G=B(s*C[r+104>>2]),C[r+124>>2]=G,C[r+120>>2]=-G,G=l,d=t[i>>2],l=B(yf[t[u>>2]](d+_(t[r+144>>2],244)|0,d+_(t[r+148>>2],244)|0,r)),l=B(G+B(l*l))),R|!(16&b[0|c])||(r=t[f>>2]+_(t[4+(t[k>>2]+n|0)>>2],152)|0,s=B(s*C[r+104>>2]),C[r+124>>2]=s,C[r+120>>2]=-s,s=l,R=t[i>>2],l=B(yf[t[u>>2]](R+_(t[r+144>>2],244)|0,R+_(t[r+148>>2],244)|0,r)),l=B(s+B(l*l))),n=n+m|0,o=o+4|0,e=e+-1|0,e;){}}else {if((0|e)>=1)for(i=0,f=A+116|0,n=A+36|0,o=A+16|0,k=A+216|0;s=l,c=t[o>>2],r=t[n>>2]+_(t[t[f>>2]+i>>2],152)|0,l=B(yf[t[k>>2]](c+_(t[r+144>>2],244)|0,c+_(t[r+148>>2],244)|0,r)),l=B(s+B(l*l)),i=i+4|0,e=e+-1|0,e;){}if(o=t[A+68>>2],(0|o)<1)break A;for(i=0,e=A+156|0,f=A+76|0,n=A+36|0,k=A+16|0,c=A+212|0;r=t[f>>2]+_(t[t[e>>2]+i>>2],152)|0,s=C[100+(t[n>>2]+_(t[r+140>>2],152)|0)>>2],s>B(0)&&(s=B(s*C[r+104>>2]),C[r+124>>2]=s,C[r+120>>2]=-s,s=l,u=t[k>>2],l=B(yf[t[c>>2]](u+_(t[r+144>>2],244)|0,u+_(t[r+148>>2],244)|0,r)),l=B(s+B(l*l))),i=i+4|0,o=o+-1|0,o;){}}if(o=t[A+88>>2],!((0|o)<1))for(i=0,r=A+96|0,e=A+36|0,f=A+16|0,n=A+212|0;A=t[r>>2]+i|0,s=C[100+(t[e>>2]+_(t[A+140>>2],152)|0)>>2],s>B(0)&&(G=s,s=C[A+104>>2],G=B(G*s),s=G>s?s:G,C[A+124>>2]=s,C[A+120>>2]=-s,s=l,k=t[f>>2],l=B(yf[t[n>>2]](k+_(t[A+144>>2],244)|0,k+_(t[A+148>>2],244)|0,A)),l=B(s+B(l*l))),i=i+152|0,o=o+-1|0,o;){}}return B(l);},function(A,r,e,i,f,n,o,k,c){A|=0,r|=0,e|=0,i|=0,f|=0,n|=0,o|=0,k|=0,c|=0;var u=0,l=0,s=0,d=0,v=0,g=0,R=0,G=0,h=0,y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=0,Y=B(0),N=0,V=B(0),I=B(0),X=B(0),M=B(0),S=B(0),T=B(0),U=B(0),j=0,O=0,H=B(0),z=B(0),P=0,L=0,K=B(0),q=0,$=0,AA=0,rA=0,eA=B(0),iA=B(0),aA=B(0),fA=B(0),nA=B(0),tA=B(0),bA=B(0),oA=0,kA=0,cA=0,uA=0,lA=0,sA=0,dA=0,vA=0,_A=0,BA=0,mA=0,RA=0,GA=0,hA=0,yA=0,QA=0,pA=0,DA=B(0),wA=B(0),WA=B(0),FA=B(0),ZA=B(0),YA=B(0),EA=B(0),NA=B(0),VA=B(0),IA=B(0),JA=B(0),XA=B(0);if(g=E-256|0,E=g,t[A+188>>2]=-1,$e(g+248|0,19692),c=t[k+72>>2],(0|c)!=t[A+224>>2]&&(t[A+220>>2]=536,t[A+216>>2]=537,t[A+212>>2]=538,t[A+224>>2]=c),t[A+184>>2]=0,(0|e)>=1)for(c=r,u=e;t[t[c>>2]+212>>2]=-1,c=c+4|0,u=u+-1|0,u;){}if(h=t[A+12>>2],(0|h)<=(0|e)){if(h=e+1|0,v=h?CA(_(h,244),16):0,l=t[A+8>>2],(0|l)>=1)for(s=64,Z=A+16|0;u=t[Z>>2]+s|0,R=u+-56|0,d=t[R+4>>2],c=s+v|0,G=c+-56|0,t[G>>2]=t[R>>2],t[G+4>>2]=d,R=u+-64|0,d=t[R+4>>2],G=c+-64|0,t[G>>2]=t[R>>2],t[G+4>>2]=d,R=u+-40|0,d=t[R+4>>2],G=c+-40|0,t[G>>2]=t[R>>2],t[G+4>>2]=d,R=u+-48|0,d=t[R+4>>2],G=c+-48|0,t[G>>2]=t[R>>2],t[G+4>>2]=d,R=u+-32|0,d=t[R+4>>2],G=c+-32|0,t[G>>2]=t[R>>2],t[G+4>>2]=d,R=u+-24|0,d=t[R+4>>2],G=c+-24|0,t[G>>2]=t[R>>2],t[G+4>>2]=d,R=u+-8|0,d=t[R+4>>2],G=c+-8|0,t[G>>2]=t[R>>2],t[G+4>>2]=d,R=u+-16|0,d=t[R+4>>2],G=c+-16|0,t[G>>2]=t[R>>2],t[G+4>>2]=d,J(c,u,180),s=s+244|0,l=l+-1|0,l;){}c=A+16|0,u=t[c>>2],u&&(b[A+20|0]&&gA(u),t[A+16>>2]=0),t[c>>2]=v,a[A+20|0]=1,t[A+12>>2]=h;}if(g=x(g,0,244),G=A+8|0,s=t[G>>2],(0|s)<=-1)for((0|h)<=-1&&(c=t[A+16>>2],c&&(b[A+20|0]&&gA(c),t[A+16>>2]=0),a[A+20|0]=1,c=A+12|0,t[c>>2]=0,t[c+4>>2]=0),u=_(s,244)- -64|0,R=g- -64|0,h=g+48|0,Z=g+32|0,l=g+16|0;d=g+8|0,N=t[d+4>>2],v=t[A+16>>2]+u|0,c=v+-56|0,t[c>>2]=t[d>>2],t[c+4>>2]=N,d=t[g+4>>2],c=v+-64|0,t[c>>2]=t[g>>2],t[c+4>>2]=d,c=l,N=t[c+4>>2],d=v+-48|0,t[d>>2]=t[c>>2],t[d+4>>2]=N,c=c+8|0,N=t[c+4>>2],d=v+-40|0,t[d>>2]=t[c>>2],t[d+4>>2]=N,d=t[Z+4>>2],c=v+-32|0,t[c>>2]=t[Z>>2],t[c+4>>2]=d,d=Z+8|0,N=t[d+4>>2],c=v+-24|0,t[c>>2]=t[d>>2],t[c+4>>2]=N,d=t[h+4>>2],c=v+-16|0,t[c>>2]=t[h>>2],t[c+4>>2]=d,d=h+8|0,N=t[d+4>>2],c=v+-8|0,t[c>>2]=t[d>>2],t[c+4>>2]=N,J(v,R,180),u=u+244|0,s=s+1|0,s;){}if(t[G>>2]=0,(0|e)>=1)for(u=k+12|0,Z=A+16|0,G=k+84|0;;){l=ia(A,t[r>>2],C[u>>2]),c=t[r>>2];A:if(!(!c|!(2&t[c+252>>2])|C[c+404>>2]==B(0))){s=t[Z>>2];r:{e:{if(h=c+564|0,v=t[h>>2],2&v){if(zi(g,c,C[G>>2]),D=C[c+364>>2],w=C[c+332>>2],X=C[c+348>>2],V=C[c+360>>2],Y=C[c+328>>2],I=C[c+344>>2],v=s+_(l,244)|0,y=C[g>>2],Q=C[g+4>>2],W=C[g+8>>2],p=C[u>>2],C[v+224>>2]=C[v+224>>2]-B(B(B(B(y*C[c+324>>2])+B(Q*C[c+340>>2]))+B(W*C[c+356>>2]))*p),R=v+228|0,C[R>>2]=C[R>>2]-B(p*B(B(B(y*Y)+B(Q*I))+B(W*V))),v=v+232|0,C[v>>2]=C[v>>2]-B(p*B(B(B(y*w)+B(Q*X))+B(W*D))),v=t[h>>2],!(4&v))break e;}else if(!(4&v))break e;if(Li(g,c,C[u>>2]),y=C[g+8>>2],Q=C[g+4>>2],v=s+_(l,244)|0,C[v+224>>2]=C[g>>2]+C[v+224>>2],R=v+228|0,C[R>>2]=Q+C[R>>2],v=v+232|0,C[v>>2]=y+C[v>>2],8&t[h>>2])break r;break A;}if(!(8&v))break A;}Pi(g,c,C[u>>2]),y=C[g+8>>2],Q=C[g+4>>2],c=s+_(l,244)|0,C[c+224>>2]=C[g>>2]+C[c+224>>2],l=c+228|0,C[l>>2]=Q+C[l>>2],c=c+232|0,C[c>>2]=y+C[c>>2];}if(r=r+4|0,e=e+-1|0,!e)break;}if((0|o)>=1)for(c=n,r=o;e=t[c>>2],yf[t[t[e>>2]+8>>2]](e),t[e+36>>2]=0,c=c+4|0,r=r+-1|0,r;){}if(e=A+168|0,u=t[e>>2],!((0|u)>=(0|o)|t[A+172>>2]>=(0|o))){A:{r:{if(o){if(r=CA(o<<3,16),u=t[A+168>>2],(0|u)>=1)break r;break A;}if(r=0,(0|u)<1)break A;}for(c=0,l=A+176|0;v=t[l>>2]+c|0,h=t[v+4>>2],s=r+c|0,t[s>>2]=t[v>>2],t[s+4>>2]=h,c=c+8|0,u=u+-1|0,u;){}}c=A+176|0,u=t[c>>2],u&&(b[A+180|0]&&gA(u),t[A+176>>2]=0),t[c>>2]=r,a[A+180|0]=1,t[A+172>>2]=o;}if(t[e>>2]=o,(0|o)>=1)for(e=0,v=A+176|0,r=n,l=o,s=0;h=t[v>>2],u=t[r>>2],c=t[u+44>>2],c&&(t[c>>2]=0,t[c+4>>2]=0,u=c+56|0,t[u>>2]=0,t[u+4>>2]=0,u=c+48|0,t[u>>2]=0,t[u+4>>2]=0,u=c+40|0,t[u>>2]=0,t[u+4>>2]=0,u=c+32|0,t[u>>2]=0,t[u+4>>2]=0,u=c+24|0,t[u>>2]=0,t[u+4>>2]=0,u=c+16|0,t[u>>2]=0,t[u+4>>2]=0,c=c+8|0,t[c>>2]=0,t[c+4>>2]=0,u=t[r>>2]),c=e+h|0,e=e+8|0,r=r+4|0,b[u+20|0]?(yf[t[t[u>>2]+16>>2]](u,c),c=t[c>>2]):(t[c>>2]=0,t[c+4>>2]=0,c=0),s=c+s|0,l=l+-1|0,l;){}else s=0;if(e=A+48|0,u=t[e>>2],!((0|u)>=(0|s)|t[A+52>>2]>=(0|s))){A:{r:{if(s){if(r=CA(_(s,152),16),u=t[A+48>>2],(0|u)>=1)break r;break A;}if(r=0,(0|u)<1)break A;}for(c=0,l=A+56|0;J(r+c|0,t[l>>2]+c|0,152),c=c+152|0,u=u+-1|0,u;){}}c=A+56|0,u=t[c>>2],u&&(b[A+60|0]&&gA(u),t[A+56>>2]=0),t[c>>2]=r,a[A+60|0]=1,t[A+52>>2]=s;}if(t[e>>2]=s,(0|o)>=1)for($=A+176|0,c=t[$>>2],oA=A+56|0,R=k+12|0,N=k+20|0,AA=A+184|0,kA=A+16|0,cA=g+28|0,uA=g+24|0,lA=g+8|0,sA=g+36|0,dA=k+4|0,vA=g+44|0,Z=0,d=0;;){if(_A=d,rA=Z<<3,G=rA+c|0,t[G>>2]){if(v=t[oA>>2],q=(Z<<2)+n|0,h=t[q>>2],u=t[h+32>>2],l=t[h+28>>2],s=ia(A,l,C[R>>2]),j=ia(A,u,C[R>>2]),P=_(d,152),L=t[kA>>2],r=t[h+24>>2],O=(0|r)>0?r:t[N>>2],(0|O)>t[AA>>2]&&(t[AA>>2]=O),r=v+P|0,t[G>>2]>=1)for(e=0,c=r;c=x(c,0,152),d=c+120|0,t[d>>2]=-8388609,t[d+4>>2]=2139095039,t[c+148>>2]=j,t[c+144>>2]=s,d=c+96|0,t[d>>2]=0,t[d+4>>2]=0,t[c+136>>2]=O,c=c+152|0,e=e+1|0,(0|e)<t[G>>2];){}if(s=L+_(s,244)|0,e=s,t[e+64>>2]=0,t[e+68>>2]=0,e=e+88|0,t[e>>2]=0,t[e+4>>2]=0,e=s+80|0,t[e>>2]=0,t[e+4>>2]=0,e=s+72|0,t[e>>2]=0,t[e+4>>2]=0,t[s+144>>2]=0,t[s+148>>2]=0,e=s+168|0,t[e>>2]=0,t[e+4>>2]=0,e=s+160|0,t[e>>2]=0,t[e+4>>2]=0,e=s+152|0,t[e>>2]=0,t[e+4>>2]=0,e=L+_(j,244)|0,c=e+88|0,t[c>>2]=0,t[c+4>>2]=0,c=e+80|0,t[c>>2]=0,t[c+4>>2]=0,c=e+72|0,t[c>>2]=0,t[c+4>>2]=0,t[e+64>>2]=0,t[e+68>>2]=0,c=e+168|0,t[c>>2]=0,t[c+4>>2]=0,c=e+160|0,t[c>>2]=0,t[c+4>>2]=0,c=e+152|0,t[c>>2]=0,t[c+4>>2]=0,t[e+144>>2]=0,t[e+148>>2]=0,t[cA>>2]=r+112,t[uA>>2]=38,t[g+20>>2]=r+32,t[g+16>>2]=r+48,t[g+12>>2]=r,t[lA>>2]=r+16,t[g+40>>2]=r+124,t[sA>>2]=r+120,t[g+32>>2]=r+116,t[r+116>>2]=t[k+40>>2],j=g+48|0,t[j>>2]=t[dA>>2],t[vA>>2]=t[N>>2],t[g+4>>2]=t[k+32>>2],C[g>>2]=B(1)/C[R>>2],r=t[q>>2],yf[t[t[r>>2]+20>>2]](r,g),t[G>>2]>=1)for(c=132+(v+P|0)|0,P=e+232|0,L=e+228|0,O=e+224|0,d=e+216|0,BA=e+212|0,mA=e+208|0,e=e+240|0,RA=s+232|0,GA=s+228|0,hA=s+224|0,yA=s+216|0,QA=s+212|0,pA=s+208|0,s=s+240|0,v=0;r=c+-8|0,y=C[t[q>>2]+16>>2],C[r>>2]>=y&&(C[r>>2]=y),r=c+-12|0,y=B(-y),C[r>>2]<=y&&(C[r>>2]=y),t[c>>2]=h,r=t[h+28>>2],p=C[r+604>>2],D=C[r+332>>2],w=C[r+328>>2],X=C[r+324>>2],V=C[r+608>>2],Y=C[r+348>>2],I=C[r+340>>2],S=C[r+344>>2],y=C[r+612>>2],W=C[r+364>>2],Q=C[r+356>>2],F=C[r+360>>2],t[c+-56>>2]=0,M=y,y=C[c+-132>>2],T=B(Q*y),Q=C[c+-128>>2],U=W,W=C[c+-124>>2],C[c+-60>>2]=M*B(B(T+B(F*Q))+B(U*W)),C[c+-64>>2]=V*B(B(B(y*I)+B(Q*S))+B(W*Y)),C[c+-68>>2]=p*B(B(B(X*y)+B(w*Q))+B(D*W)),r=t[h+32>>2],X=C[r+604>>2],V=C[r+332>>2],Y=C[r+328>>2],I=C[r+324>>2],S=C[r+608>>2],F=C[r+348>>2],H=C[r+340>>2],z=C[r+344>>2],p=C[r+612>>2],w=C[r+364>>2],D=C[r+356>>2],T=C[r+360>>2],t[c+-40>>2]=0,M=p,p=C[c+-100>>2],K=B(D*p),D=C[c+-96>>2],U=w,w=C[c+-92>>2],C[c+-44>>2]=M*B(B(K+B(T*D))+B(U*w)),C[c+-48>>2]=S*B(B(B(p*H)+B(D*z))+B(w*F)),C[c+-52>>2]=X*B(B(B(I*p)+B(Y*D))+B(V*w)),X=B(0),V=C[c+-116>>2],Y=C[l+404>>2],I=C[c+-112>>2],S=C[c+-108>>2],M=B(B(B(B(V*B(V*Y))+B(I*B(Y*I)))+B(S*B(Y*S)))+B(B(B(y*B(B(B(y*C[l+324>>2])+B(Q*C[l+328>>2]))+B(W*C[l+332>>2])))+B(Q*B(B(B(y*C[l+340>>2])+B(Q*C[l+344>>2]))+B(W*C[l+348>>2]))))+B(W*B(B(B(y*C[l+356>>2])+B(Q*C[l+360>>2]))+B(W*C[l+364>>2]))))),Y=C[c+-84>>2],F=C[u+404>>2],H=C[c+-80>>2],z=C[c+-76>>2],F=B(B(M+B(B(B(Y*B(Y*F))+B(H*B(F*H)))+B(z*B(F*z))))+B(B(B(p*B(B(B(p*C[u+324>>2])+B(D*C[u+328>>2]))+B(w*C[u+332>>2])))+B(D*B(B(B(p*C[u+340>>2])+B(D*C[u+344>>2]))+B(w*C[u+348>>2]))))+B(w*B(B(B(p*C[u+356>>2])+B(D*C[u+360>>2]))+B(w*C[u+364>>2]))))),F=B(m(F))>B(1.1920928955078125e-7)?B(B(1)/F):B(0),C[c+-24>>2]=F,T=B(0),M=B(0),U=B(0),K=B(0),eA=B(0),iA=B(0),t[s>>2]&&(iA=C[RA>>2],eA=C[GA>>2],K=C[hA>>2],M=C[QA>>2],U=C[pA>>2],T=C[yA>>2]),aA=B(0),fA=B(0),nA=B(0),tA=B(0),bA=B(0),t[e>>2]&&(bA=C[P>>2],tA=C[L>>2],nA=C[O>>2],aA=C[BA>>2],fA=C[mA>>2],X=C[d>>2]),DA=C[l+380>>2],wA=C[l+372>>2],WA=C[l+376>>2],FA=C[l+396>>2],ZA=C[l+388>>2],YA=C[l+392>>2],EA=C[u+380>>2],NA=C[u+372>>2],VA=C[u+376>>2],IA=C[u+396>>2],JA=C[u+388>>2],XA=C[u+392>>2],t[c+-32>>2]=0,r=c+-20|0,C[r>>2]=B(F*C[r>>2])+B(F*B(B(0)-B(C[j>>2]*B(B(B(B(B(V*B(U+wA))+B(I*B(M+WA)))+B(S*B(T+DA)))+B(B(B(y*B(K+ZA))+B(Q*B(eA+YA)))+B(W*B(iA+FA))))+B(B(B(B(Y*B(fA+NA))+B(H*B(aA+VA)))+B(z*B(X+EA)))+B(B(B(p*B(nA+JA))+B(D*B(tA+XA)))+B(w*B(bA+IA)))))))),c=c+152|0,v=v+1|0,(0|v)<t[G>>2];){}c=t[$>>2];}if(d=_A+t[c+rA>>2]|0,Z=Z+1|0,(0|Z)==(0|o))break;}if(yf[t[t[A>>2]+28>>2]](A,i,f,k),f=t[A+68>>2],i=t[A+28>>2],o=A+128|0,l=t[o>>2],n=t[A+48>>2],!((0|l)>=(0|n)|t[A+132>>2]>=(0|n))){n?(r=CA(n<<2,16),l=t[A+128>>2]):r=0,e=t[A+136>>2];A:{if((0|l)>=1)for(c=r,u=e;t[c>>2]=t[u>>2],c=c+4|0,u=u+4|0,l=l+-1|0,l;){}else if(!e)break A;b[A+140|0]&&gA(e),t[A+136>>2]=0;}t[A+136>>2]=r,a[A+140|0]=1,t[A+132>>2]=n;}t[o>>2]=n;A:{r:{e:{i:{a:{f:{n:{t:{b:{o:{k:{c:{u:{if(!(16&b[k+72|0])){if(o=A+108|0,l=t[o>>2],(0|l)>=(0|i)|t[A+112>>2]>=(0|i))break f;if(!i)break u;r=CA(i<<2,16),l=t[A+108>>2];break c;}if(k=A+108|0,l=t[k>>2],o=i<<1,(0|l)>=(0|o)|t[A+112>>2]>=(0|o))break r;if(!i)break k;r=CA(i<<3,16),l=t[A+108>>2];break o;}r=0;}if(e=t[A+116>>2],(0|l)<1)break b;for(c=r,u=e;t[c>>2]=t[u>>2],c=c+4|0,u=u+4|0,l=l+-1|0,l;){}break t;}r=0;}if(e=t[A+116>>2],(0|l)<1)break a;for(c=r,u=e;t[c>>2]=t[u>>2],c=c+4|0,u=u+4|0,l=l+-1|0,l;){}break i;}if(!e)break n;}b[A+120|0]&&gA(e),t[A+116>>2]=0;}t[A+116>>2]=r,a[A+120|0]=1,t[A+112>>2]=i;}t[o>>2]=i;break A;}if(!e)break e;}b[A+120|0]&&gA(e),t[A+116>>2]=0;}t[A+116>>2]=r,a[A+120|0]=1,t[A+112>>2]=o;}t[k>>2]=o;}if(o=A+148|0,l=t[o>>2],!((0|l)>=(0|f)|t[A+152>>2]>=(0|f))){f?(r=CA(f<<2,16),l=t[A+148>>2]):r=0,e=t[A+156>>2];A:{if((0|l)>=1)for(c=r,u=e;t[c>>2]=t[u>>2],c=c+4|0,u=u+4|0,l=l+-1|0,l;){}else if(!e)break A;b[A+160|0]&&gA(e),t[A+156>>2]=0;}t[A+156>>2]=r,a[A+160|0]=1,t[A+152>>2]=f;}if(t[o>>2]=f,(0|n)>=1)for(c=t[A+136>>2],u=0;t[c>>2]=u,c=c+4|0,u=u+1|0,(0|n)!=(0|u);){}if((0|i)>=1)for(c=t[A+116>>2],u=0;t[c>>2]=u,c=c+4|0,u=u+1|0,(0|i)!=(0|u);){}if((0|f)>=1)for(c=t[A+156>>2],u=0;t[c>>2]=u,c=c+4|0,u=u+1|0,(0|f)!=(0|u);){}return Ai(),E=g+256|0,B(B(0));},function(A,r,e,i,a,f,n,b,o){A|=0,r|=0,e|=0,i|=0,a|=0,f|=0,n|=0,b|=0,o|=0;var k,c=0,u=0,l=B(0),s=0,d=0,v=0;k=E-16|0,E=k,$e(k+8|0,19721),yf[t[t[A>>2]+32>>2]](A,r,e,i,a,f,n,b,o),c=t[A+184>>2],u=t[b+20>>2],u=(0|c)>(0|u)?c:u;A:if(!((0|u)<1))for(s=u+-1|0,c=0,d=A+228|0,v=b+92|0;;){if(l=B(yf[t[t[A>>2]+40>>2]](A,c,r,e,i,a,f,n,b,o)),C[d>>2]=l,(0|c)>=(0|s)|l<=C[v>>2])break A;if(c=c+1|0,!((0|c)<(0|u)))break;}return Ai(),E=k+16|0,B(B(0));},Cr,ca,dA,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),p=B(0),D=B(0),w=B(0),W=0,F=B(0);if(a=E-32|0,E=a,g=C[r+24>>2],D=C[r+40>>2],_=C[r+36>>2],o=C[r+20>>2],u=C[r+8>>2],m=C[r+16>>2],s=C[r+4>>2],R=C[r+32>>2],d=C[r>>2],t[a+28>>2]=0,n=B(m-d),k=B(_-s),b=B(o-s),l=B(R-d),f=B(B(n*k)-B(b*l)),C[a+24>>2]=f,c=B(g-u),y=B(c*l),l=B(D-u),n=B(y-B(n*l)),C[a+20>>2]=n,k=B(B(b*l)-B(c*k)),C[a+16>>2]=k,v=C[A+4>>2],c=C[A+8>>2],G=C[A+12>>2],b=B(B(u*f)+B(B(d*k)+B(s*n))),l=B(B(B(B(k*v)+B(n*c))+B(f*G))-b),p=C[A+20>>2],h=C[A+24>>2],w=C[A+28>>2],b=B(B(B(B(k*p)+B(n*h))+B(f*w))-b),!(B(l*b)>=B(0))&&(r=t[A+36>>2],!(1&r&&l<=B(0))&&(b=B(l/B(l-b)),b<C[A+40>>2]&&(y=c,c=B(B(1)-b),h=B(B(h*b)+B(y*c)),o=B(o-h),v=B(B(p*b)+B(v*c)),d=B(d-v),s=B(s-h),m=B(m-v),c=B(B(w*b)+B(G*c)),g=B(g-c),u=B(u-c),p=B(B(f*f)+B(B(k*k)+B(n*n))),G=B(p*B(-9999999747378752e-20)),B(B(f*B(B(o*d)-B(s*m)))+B(B(k*B(B(s*g)-B(u*o)))+B(n*B(B(u*m)-B(g*d)))))>=G&&(_=B(_-h),R=B(R-v),v=B(f*B(B(_*m)-B(o*R))),y=o,o=B(D-c),!(B(v+B(B(k*B(B(y*o)-B(g*_)))+B(n*B(B(g*R)-B(o*m)))))>=G^1|B(B(f*B(B(s*R)-B(_*d)))+B(B(k*B(B(_*u)-B(o*s)))+B(n*B(B(o*d)-B(u*R)))))>=G^1)))))){if(o=f,f=B(B(1)/B(Q(p))),u=B(o*f),C[a+24>>2]=u,n=B(n*f),C[a+20>>2]=n,f=B(k*f),C[a+16>>2]=f,!(2&r|l<=B(0)^1))return t[a+12>>2]=0,C[a+8>>2]=-u,C[a+4>>2]=-n,C[a>>2]=-f,W=A+40|0,F=B(yf[t[t[A>>2]+12>>2]](A,a,b,e,i)),C[W>>2]=F,void(E=a+32|0);W=A+40|0,F=B(yf[t[t[A>>2]+12>>2]](A,a+16|0,b,e,i)),C[W>>2]=F;}E=a+32|0;},dA,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var f,n,b=0,o=0,k=0,c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0);f=E-688|0,E=f,n=LA(f+576|0),b=r+8|0,o=t[b+4>>2],k=f+644|0,t[k>>2]=t[b>>2],t[k+4>>2]=o,b=t[r+20>>2],o=f+652|0,t[o>>2]=t[r+16>>2],t[o+4>>2]=b,b=r+24|0,o=t[b+4>>2],k=f+660|0,t[k>>2]=t[b>>2],t[k+4>>2]=o,b=t[r+36>>2],o=f+668|0,t[o>>2]=t[r+32>>2],t[o+4>>2]=b,b=r+40|0,o=t[b+4>>2],k=f+676|0,t[k>>2]=t[b>>2],t[k+4>>2]=o,t[f+580>>2]=1,t[f+576>>2]=16416,b=t[r+4>>2],t[f+636>>2]=t[r>>2],t[f+640>>2]=b,t[f+624>>2]=t[A+204>>2],a[f+548|0]=0,t[f+524>>2]=953267991,t[f+208>>2]=14864,r=oa(f+184|0,t[A+4>>2],f+576|0,f+216|0,f+208|0),t[f+8>>2]=16056,t[f+172>>2]=1065353216,t[f+176>>2]=0,t[f+180>>2]=t[A+208>>2],b=r,r=A+136|0,ca(b,A+8|0,A+72|0,r,r,f+8|0)&&(u=C[f+140>>2],l=C[f+144>>2],c=C[f+148>>2],s=B(B(B(u*u)+B(l*l))+B(c*c)),s>B(9999999747378752e-20)&&(d=C[f+172>>2],d<C[A+200>>2]&&(v=c,c=B(B(1)/B(Q(s))),C[f+148>>2]=v*c,C[f+144>>2]=l*c,C[f+140>>2]=u*c,B(yf[t[t[A>>2]+12>>2]](A,f+140|0,f+156|0,d,e,i))))),er(n),E=f+688|0;},sa,function(A){A|=0;var r,e,i=0,a=0,f=0,n=0,o=0,k=0,c=0,u=0;if(t[A>>2]=20052,r=A+16|0,i=t[r>>2],e=A+8|0,a=t[e>>2],(0|a)>=1)for(n=A+68|0,o=A+24|0;c=t[i+k>>2],f=t[c+188>>2],f&&(i=t[n>>2],i=0|yf[t[t[i>>2]+36>>2]](i),yf[t[t[i>>2]+40>>2]](i,f,t[o>>2]),i=t[n>>2],yf[t[t[i>>2]+12>>2]](i,f,t[o>>2]),t[c+188>>2]=0,a=t[e>>2],i=t[r>>2]),k=k+4|0,u=u+1|0,(0|u)<(0|a);){}!i|!b[A+20|0]||gA(i),rA(A);},function(A){A|=0;var r,e,i=0,a=0,f=0,n=0,o=0,k=0,c=0;if(r=E-16|0,E=r,$e(r+8|0,20295),e=A+8|0,i=t[e>>2],(0|i)>=1)for(k=A+16|0,c=A+76|0;f=t[t[k>>2]+a>>2],!b[0|c]&&(n=t[f+220>>2],2==(0|n)|5==(0|n))||(va(A,f),i=t[e>>2]),a=a+4|0,o=o+1|0,(0|o)<(0|i);){}Ai(),E=r+16|0;},function(A){var r,e;A|=0,r=E-16|0,E=r,$e(r+8|0,20307),e=t[A+68>>2],yf[t[t[e>>2]+32>>2]](e,t[A+24>>2]),Ai(),E=r+16|0;},function(A,r){A|=0,r|=0,t[A+72>>2]=r;},_r,Ra,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f=0,n=B(0),b=0,o=B(0),k=B(0),c=0,u=B(0),l=B(0),s=B(0),d=0,v=B(0),g=0,m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=0,D=B(0),w=0,W=B(0),F=B(0),Z=0,Y=B(0),N=B(0),V=B(0),I=0,J=0,X=B(0),M=0,x=0,S=B(0),T=0,U=0,j=0,O=0,H=0,z=0,P=0,L=0,K=0,q=0,$=0,AA=B(0);a=E-144|0,E=a,yf[t[t[A>>2]+20>>2]](A)&&(f=0|yf[t[t[A>>2]+20>>2]](A),32768&yf[t[t[f>>2]+56>>2]](f)&&(f=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[f>>2]+64>>2]](f,r,B(.10000000149011612))));A:{r:{e:{i:{a:{f:{n:{t:{b:{o:{k:{c:if(f=t[e+4>>2],!(f>>>0>31)){switch(f-1|0){case 8:break o;case 7:break k;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 28:case 29:break c;case 30:break a;case 27:break f;case 12:break n;case 10:break t;case 9:break b;}c=e+40|0,b=t[c+4>>2],g=a+8|0,f=g,t[f>>2]=t[c>>2],t[f+4>>2]=b,f=t[e+36>>2],t[a>>2]=t[e+32>>2],t[a+4>>2]=f,o=B(yf[t[t[e>>2]+48>>2]](e)),n=B(yf[t[t[e>>2]+48>>2]](e)),l=B(B(yf[t[t[e>>2]+48>>2]](e))+C[g>>2]),C[g>>2]=l,o=B(o+C[a>>2]),C[a>>2]=o,n=B(n+C[a+4>>2]),C[a+4>>2]=n,A=0|yf[t[t[A>>2]+20>>2]](A),t[a+140>>2]=0,C[a+136>>2]=-l,C[a+132>>2]=-n,C[a+128>>2]=-o,yf[t[t[A>>2]+80>>2]](A,a+128|0,a,r,i);break A;}if((0|f)>6)break e;if(T=t[e+56>>2],!T)break i;if(d=T+28|0,t[d>>2]<1)break e;for(H=r+32|0,z=r+40|0,P=r+56|0,L=r+20|0,K=r+16|0,q=r+52|0,U=r+4|0,j=r+48|0;;){W=B(0),x=_(M,36),w=T+36|0,f=x+t[w>>2]|0,O=t[f+4>>2];c:{if(O){if(X=B(0),k=B(0),(0|O)<1)break c;for(Z=t[f+12>>2],b=t[(Z+(O<<2)|0)-4>>2],J=1,I=0,v=B(0);;){if(f=t[Z+I>>2],g=f<<4,c=T+16|0,p=g+t[c>>2]|0,Y=C[p>>2],N=C[p+4>>2],V=C[p+8>>2],p=0|yf[t[t[A>>2]+20>>2]](A),t[a+12>>2]=0,c=t[c>>2],b=c+(b<<4)|0,l=C[b>>2],k=C[H>>2],o=C[b+4>>2],s=C[r+36>>2],n=C[b+8>>2],Q=C[z>>2],u=C[P>>2],C[a+8>>2]=B(B(B(l*k)+B(o*s))+B(n*Q))+u,m=C[K>>2],R=C[L>>2],G=C[r+24>>2],h=C[q>>2],C[a+4>>2]=B(B(B(l*m)+B(o*R))+B(n*G))+h,y=C[r>>2],D=B(l*y),l=C[U>>2],D=B(D+B(o*l)),o=C[r+8>>2],D=B(D+B(n*o)),n=C[j>>2],C[a>>2]=D+n,t[a+140>>2]=0,D=u,S=k,b=c+g|0,k=C[b>>2],F=s,s=C[b+4>>2],u=C[b+8>>2],C[a+136>>2]=D+B(B(B(S*k)+B(F*s))+B(Q*u)),C[a+132>>2]=h+B(B(B(m*k)+B(R*s))+B(G*u)),C[a+128>>2]=n+B(B(B(y*k)+B(l*s))+B(o*u)),yf[t[t[p>>2]+16>>2]](p,a,a+128|0,i),X=B(X+V),W=B(W+Y),v=B(v+N),b=x+t[w>>2]|0,k=v,(0|J)>=t[b+4>>2])break c;I=I+4|0,J=J+1|0,Z=t[b+12>>2],b=f;}}X=B(0),k=B(0);}if(n=k,f=0|yf[t[t[A>>2]+20>>2]](A),16384&yf[t[t[f>>2]+56>>2]](f)&&(f=a+8|0,t[f>>2]=0,t[f+4>>2]=0,t[a>>2]=1065353216,t[a+4>>2]=1065353216,f=x+t[w>>2]|0,Y=C[f+28>>2],N=C[f+20>>2],V=C[f+24>>2],f=0|yf[t[t[A>>2]+20>>2]](A),t[a+140>>2]=0,o=B(B(1)/B(0|O)),F=B(o*W),k=C[H>>2],W=B(o*n),s=C[r+36>>2],v=B(o*X),Q=C[z>>2],u=C[P>>2],C[a+136>>2]=B(B(B(F*k)+B(W*s))+B(v*Q))+u,m=C[K>>2],R=C[L>>2],G=C[r+24>>2],h=C[q>>2],C[a+132>>2]=B(B(B(F*m)+B(W*R))+B(v*G))+h,y=C[r>>2],l=C[U>>2],o=C[r+8>>2],n=C[j>>2],C[a+128>>2]=B(B(B(F*y)+B(W*l))+B(v*o))+n,t[a+124>>2]=0,D=u,S=k,k=B(F+N),F=s,s=B(W+V),u=B(v+Y),C[a+120>>2]=D+B(B(B(S*k)+B(F*s))+B(Q*u)),C[a+116>>2]=h+B(B(B(k*m)+B(s*R))+B(u*G)),C[a+112>>2]=n+B(B(B(k*y)+B(s*l))+B(u*o)),yf[t[t[f>>2]+16>>2]](f,a+128|0,a+112|0,a)),M=M+1|0,!((0|M)<t[d>>2]))break;}break e;}n=B(yf[t[t[e>>2]+48>>2]](e)),A=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[A>>2]+24>>2]](A,n,r,i);break A;}if(I=t[e+96>>2],(0|I)<1)break r;for(Z=(I<<2)-4|0,w=(I<<4)-8|0,d=e+104|0,g=e+124|0,c=a+60|0,b=a+44|0,f=a+28|0,e=a+12|0;p=t[d>>2]+w|0,Y=C[p>>2],N=C[p+-8>>2],V=C[p+-4>>2],p=0|yf[t[t[A>>2]+20>>2]](A),l=C[t[g>>2]+Z>>2],t[c>>2]=0,t[b>>2]=0,t[f>>2]=0,t[e>>2]=0,k=C[r+40>>2],s=C[r+32>>2],n=B(s*B(0)),Q=C[r+36>>2],o=B(Q*B(0)),C[a+40>>2]=k+B(n+o),u=B(n+Q),n=B(k*B(0)),C[a+36>>2]=u+n,C[a+32>>2]=B(s+o)+n,u=C[r+24>>2],m=C[r+16>>2],n=B(m*B(0)),R=C[r+20>>2],o=B(R*B(0)),C[a+24>>2]=u+B(n+o),v=B(n+R),n=B(u*B(0)),C[a+20>>2]=v+n,C[a+16>>2]=B(m+o)+n,G=C[r+8>>2],h=C[r>>2],n=B(h*B(0)),y=C[r+4>>2],o=B(y*B(0)),C[a+8>>2]=G+B(n+o),C[a+56>>2]=B(B(B(N*s)+B(V*Q))+B(Y*k))+C[r+56>>2],C[a+52>>2]=B(B(B(N*m)+B(V*R))+B(Y*u))+C[r+52>>2],C[a+48>>2]=B(B(B(N*h)+B(V*y))+B(Y*G))+C[r+48>>2],k=B(n+y),n=B(G*B(0)),C[a+4>>2]=k+n,C[a>>2]=B(h+o)+n,yf[t[t[p>>2]+24>>2]](p,l,a,i),Z=Z+-4|0,w=w+-16|0,I=I+-1|0,(0|I)>0;){}break r;}f=e+32|0,e=t[e+56>>2],o=C[f+(e<<2)>>2],n=C[f+((e+2|0)%3<<2)>>2],A=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[A>>2]+84>>2]](A,n,o,e,r,i);break A;}f=t[e+72>>2],o=C[e+60>>2],n=C[e+64>>2],A=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[A>>2]+92>>2]](A,o,n,f,r,i);break A;}d=t[e+56>>2],l=B(yf[t[t[e>>2]+92>>2]](e)),c=e+40|0,b=t[c+4>>2],g=a+8|0,f=g,t[f>>2]=t[c>>2],t[f+4>>2]=b,f=t[e+36>>2],t[a>>2]=t[e+32>>2],t[a+4>>2]=f,o=B(yf[t[t[e>>2]+48>>2]](e)),n=B(yf[t[t[e>>2]+48>>2]](e)),$=g,AA=B(B(yf[t[t[e>>2]+48>>2]](e))+C[g>>2]),C[$>>2]=AA,C[a>>2]=o+C[a>>2],C[a+4>>2]=n+C[a+4>>2],n=C[(d<<2)+a>>2],A=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[A>>2]+88>>2]](A,l,n,d,r,i);break A;}n=C[e+68>>2],A=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[A>>2]+96>>2]](A,e+52|0,n,r,i);break A;}if(J=t[e+20>>2],(0|J)<1)break r;for(w=_(J,80)+-80|0,g=a+60|0,c=a+44|0,b=a+12|0;d=t[e+28>>2]+w|0,f=t[d- -64>>2],X=C[d+56>>2],F=C[d+48>>2],W=C[d+52>>2],v=C[d+32>>2],Y=C[d>>2],N=C[d+16>>2],V=C[d+36>>2],k=C[d+4>>2],s=C[d+20>>2],Q=C[d+40>>2],o=C[d+8>>2],n=C[d+24>>2],t[g>>2]=0,t[c>>2]=0,t[a+28>>2]=0,t[b>>2]=0,u=C[r+32>>2],m=C[r+36>>2],R=C[r+40>>2],C[a+40>>2]=B(B(o*u)+B(n*m))+B(Q*R),C[a+36>>2]=B(B(k*u)+B(s*m))+B(V*R),C[a+32>>2]=B(B(Y*u)+B(N*m))+B(v*R),G=C[r+16>>2],h=C[r+20>>2],y=C[r+24>>2],C[a+24>>2]=B(B(o*G)+B(n*h))+B(Q*y),C[a+20>>2]=B(B(k*G)+B(s*h))+B(V*y),C[a+16>>2]=B(B(Y*G)+B(N*h))+B(v*y),l=C[r>>2],D=B(o*l),o=C[r+4>>2],D=B(D+B(n*o)),n=C[r+8>>2],C[a+8>>2]=D+B(Q*n),C[a+56>>2]=B(B(B(F*u)+B(W*m))+B(X*R))+C[r+56>>2],C[a+52>>2]=B(B(B(F*G)+B(W*h))+B(X*y))+C[r+52>>2],C[a+48>>2]=B(B(B(F*l)+B(W*o))+B(X*n))+C[r+48>>2],C[a+4>>2]=B(B(k*l)+B(s*o))+B(V*n),C[a>>2]=B(B(Y*l)+B(N*o))+B(v*n),yf[t[t[A>>2]+28>>2]](A,a,f,i),w=w+-80|0,J=J+-1|0,(0|J)>0;){}break r;}if(!((0|yf[t[t[e>>2]+100>>2]](e))<1))for(U=r+36|0,j=r+32|0,M=r+40|0,x=r+56|0,w=r+20|0,p=r+16|0,d=r+24|0,g=r+52|0,c=r+4|0,b=r+48|0;yf[t[t[e>>2]+104>>2]](e,Z,a,a+128|0),t[a+124>>2]=0,l=C[a>>2],k=C[j>>2],o=C[a+4>>2],s=C[U>>2],n=C[a+8>>2],Q=C[M>>2],u=C[x>>2],C[a+120>>2]=B(B(B(l*k)+B(o*s))+B(n*Q))+u,m=C[p>>2],R=C[w>>2],G=C[d>>2],h=C[g>>2],C[a+116>>2]=B(B(B(l*m)+B(o*R))+B(n*G))+h,y=C[r>>2],v=B(l*y),l=C[c>>2],v=B(v+B(o*l)),o=C[r+8>>2],v=B(v+B(n*o)),n=C[b>>2],C[a+112>>2]=v+n,t[a+108>>2]=0,v=u,D=k,k=C[a+128>>2],S=s,s=C[a+132>>2],u=C[a+136>>2],C[a+104>>2]=v+B(B(B(D*k)+B(S*s))+B(Q*u)),C[a+100>>2]=h+B(B(B(m*k)+B(R*s))+B(G*u)),C[a+96>>2]=n+B(B(B(y*k)+B(l*s))+B(o*u)),f=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[f>>2]+16>>2]](f,a+112|0,a+96|0,i),Z=Z+1|0,(0|Z)<(0|yf[t[t[e>>2]+100>>2]](e));){}}d=e+4|0,f=t[d>>2],f+-21>>>0<=8&&(t[a+136>>2]=1566444395,t[a+140>>2]=0,t[a+128>>2]=1566444395,t[a+132>>2]=1566444395,t[a+120>>2]=-581039253,t[a+124>>2]=0,t[a+112>>2]=-581039253,t[a+116>>2]=-581039253,g=0|yf[t[t[A>>2]+20>>2]](A),c=i+8|0,b=t[c+4>>2],f=a+20|0,t[f>>2]=t[c>>2],t[f+4>>2]=b,c=r+8|0,b=t[c+4>>2],f=a+36|0,t[f>>2]=t[c>>2],t[f+4>>2]=b,b=t[r+20>>2],f=a+44|0,t[f>>2]=t[r+16>>2],t[f+4>>2]=b,c=r+24|0,b=t[c+4>>2],f=a+52|0,t[f>>2]=t[c>>2],t[f+4>>2]=b,b=t[r+36>>2],f=a+60|0,t[f>>2]=t[r+32>>2],t[f+4>>2]=b,c=r+40|0,b=t[c+4>>2],f=a+68|0,t[f>>2]=t[c>>2],t[f+4>>2]=b,t[a+8>>2]=g,t[a+4>>2]=22296,t[a>>2]=22272,f=t[i+4>>2],t[a+12>>2]=t[i>>2],t[a+16>>2]=f,f=t[r+4>>2],t[a+28>>2]=t[r>>2],t[a+32>>2]=f,c=r+56|0,b=t[c+4>>2],f=a+84|0,t[f>>2]=t[c>>2],t[f+4>>2]=b,b=t[r+52>>2],f=a+76|0,t[f>>2]=t[r+48>>2],t[f+4>>2]=b,yf[t[t[e>>2]+64>>2]](e,a,a+112|0,a+128|0),f=t[d>>2]),3==(0|f)&&(t[a+136>>2]=1566444395,t[a+140>>2]=0,t[a+128>>2]=1566444395,t[a+132>>2]=1566444395,t[a+120>>2]=-581039253,t[a+124>>2]=0,t[a+112>>2]=-581039253,t[a+116>>2]=-581039253,c=0|yf[t[t[A>>2]+20>>2]](A),b=i+8|0,f=t[b+4>>2],A=a+20|0,t[A>>2]=t[b>>2],t[A+4>>2]=f,b=r+8|0,f=t[b+4>>2],A=a+36|0,t[A>>2]=t[b>>2],t[A+4>>2]=f,f=t[r+20>>2],A=a+44|0,t[A>>2]=t[r+16>>2],t[A+4>>2]=f,b=r+24|0,f=t[b+4>>2],A=a+52|0,t[A>>2]=t[b>>2],t[A+4>>2]=f,f=t[r+36>>2],A=a+60|0,t[A>>2]=t[r+32>>2],t[A+4>>2]=f,b=r+40|0,f=t[b+4>>2],A=a+68|0,t[A>>2]=t[b>>2],t[A+4>>2]=f,t[a+8>>2]=c,t[a+4>>2]=22296,t[a>>2]=22272,A=t[i+4>>2],t[a+12>>2]=t[i>>2],t[a+16>>2]=A,A=t[r+4>>2],t[a+28>>2]=t[r>>2],t[a+32>>2]=A,f=r+56|0,i=t[f+4>>2],A=a+84|0,t[A>>2]=t[f>>2],t[A+4>>2]=i,i=t[r+52>>2],A=a+76|0,t[A>>2]=t[r+48>>2],t[A+4>>2]=i,A=t[e+96>>2],yf[t[t[A>>2]+8>>2]](A,4|a,a+112|0,a+128|0));}return void(E=a+144|0);}E=a+144|0;},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f,n,b,o=0,k=0,c=B(0),u=B(0),l=B(0),s=B(0),d=0,v=B(0),g=B(0);a=E-256|0,E=a,o=a+112|0,t[o>>2]=0,t[o+4>>2]=0,o=a+104|0,t[o>>2]=0,t[o+4>>2]=0,t[a+120>>2]=1065353216,o=a+132|0,t[o>>2]=0,t[o+4>>2]=0,o=a+124|0,t[o>>2]=0,t[o+4>>2]=0,n=r+8|0,d=n,k=t[d+4>>2],o=a+76|0,t[o>>2]=t[d>>2],t[o+4>>2]=k,f=e+8|0,b=t[f+4>>2],d=a+92|0,k=d,t[k>>2]=t[f>>2],t[k+4>>2]=b,t[a+32>>2]=22088,t[a+248>>2]=i,t[a+100>>2]=1065353216,i=t[r+4>>2],t[a+68>>2]=t[r>>2],t[a+72>>2]=i,i=t[e+4>>2],t[a+84>>2]=t[e>>2],t[a+88>>2]=i,t[a+244>>2]=A,i=a+140|0,t[i>>2]=1065353216,t[i+4>>2]=0,k=t[o+4>>2],i=a+156|0,t[i>>2]=t[o>>2],t[i+4>>2]=k,k=t[a+72>>2],i=a+148|0,t[i>>2]=t[a+68>>2],t[i+4>>2]=k,i=a+176|0,t[i>>2]=0,t[i+4>>2]=0,i=a+168|0,t[i>>2]=0,t[i+4>>2]=0,t[a+184>>2]=1065353216,i=a+196|0,t[i>>2]=0,t[i+4>>2]=0,i=a+188|0,t[i>>2]=0,t[i+4>>2]=0,i=a+204|0,t[i>>2]=1065353216,t[i+4>>2]=0,k=t[f+4>>2],i=a+220|0,t[i>>2]=t[f>>2],t[i+4>>2]=k,k=t[e+4>>2],i=a+212|0,t[i>>2]=t[e>>2],t[i+4>>2]=k,t[a+164>>2]=1065353216,s=B(C[e>>2]-C[r>>2]),c=B(C[e+4>>2]-C[r+4>>2]),u=B(C[f>>2]-C[n>>2]),l=B(B(1)/B(Q(B(B(B(s*s)+B(c*c))+B(u*u))))),u=B(u*l),v=u==B(0)?B(0xde0b6b000000000):B(B(1)/u),C[a+44>>2]=v,c=B(c*l),g=c==B(0)?B(0xde0b6b000000000):B(B(1)/c),C[a+40>>2]=g,t[a+60>>2]=v<B(0),t[a+56>>2]=g<B(0),l=B(s*l),s=l==B(0)?B(0xde0b6b000000000):B(B(1)/l),C[a+36>>2]=s,t[a+52>>2]=s<B(0),C[a+64>>2]=B(B(l*B(C[a+84>>2]-C[a+68>>2]))+B(c*B(C[a+88>>2]-C[a+72>>2])))+B(u*B(C[d>>2]-C[o>>2])),A=t[A+68>>2],i=a+24|0,t[i>>2]=0,t[i+4>>2]=0,t[a+16>>2]=0,t[a+20>>2]=0,i=a+8|0,t[i>>2]=0,t[i+4>>2]=0,t[a>>2]=0,t[a+4>>2]=0,yf[t[t[A>>2]+24>>2]](A,r,e,a+32|0,a+16|0,a),E=a+256|0;},da,Ca,function(A){A|=0;var r,e,i=0,a=0,f=0,n=0,b=0,o=0;r=E-16|0,E=r,$e(r+8|0,20333),yf[t[t[A>>2]+8>>2]](A),yf[t[t[A>>2]+12>>2]](A),e=t[A+24>>2],$e(r,20367),e&&(i=t[A+68>>2],f=e,n=0|yf[t[t[i>>2]+36>>2]](i),b=A+28|0,o=t[A+24>>2],a=t[t[e>>2]+32>>2],yf[a](0|f,0|n,0|b,0|o)),Ai(),Ai(),E=r+16|0;},function(A,r){A|=0,r|=0,yf[t[t[r>>2]+32>>2]](r),Ga(A,r),yf[t[t[r>>2]+36>>2]](r);},Cr,ya,Cr,ya,Cr,function(A,r){A|=0,r|=0;var e,i,a,f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0);e=E-128|0,E=e,i=t[r+36>>2],r=t[t[A+8>>2]+28>>2]+_(i,80)|0,a=t[r+64>>2],d=C[r+32>>2],v=C[r>>2],g=C[r+16>>2],m=C[r+56>>2],R=C[r+52>>2],G=C[r+48>>2],h=C[r+36>>2],y=C[r+20>>2],Q=C[r+4>>2],p=C[r+40>>2],D=C[r+24>>2],w=C[r+8>>2],r=t[A+12>>2],W=C[r+52>>2],F=C[r+56>>2],f=C[r+24>>2],n=C[r+20>>2],b=C[r+40>>2],o=C[r+36>>2],Z=C[r+48>>2],k=C[r+8>>2],c=C[r>>2],u=C[r+4>>2],l=C[r+16>>2],s=C[r+32>>2],t[e+124>>2]=0,t[e+108>>2]=0,t[e+92>>2]=0,C[e+104>>2]=B(B(w*s)+B(D*o))+B(p*b),C[e+100>>2]=B(B(Q*s)+B(y*o))+B(h*b),C[e+88>>2]=B(B(w*l)+B(D*n))+B(p*f),C[e+84>>2]=B(B(Q*l)+B(y*n))+B(h*f),C[e+120>>2]=F+B(B(B(s*G)+B(o*R))+B(b*m)),C[e+116>>2]=W+B(B(B(l*G)+B(n*R))+B(f*m)),t[e+76>>2]=0,C[e+72>>2]=B(B(c*w)+B(u*D))+B(k*p),C[e+68>>2]=B(B(c*Q)+B(u*y))+B(k*h),C[e+64>>2]=B(B(v*c)+B(g*u))+B(d*k),C[e+112>>2]=Z+B(B(B(c*G)+B(u*R))+B(k*m)),C[e+96>>2]=B(B(v*s)+B(g*o))+B(d*b),C[e+80>>2]=B(B(v*l)+B(g*n))+B(d*f),t[e+60>>2]=i,t[e+56>>2]=-1,t[e+44>>2]=a,t[e+40>>2]=0,t[e+48>>2]=t[A+4>>2],t[e+52>>2]=e- -64,t[e+12>>2]=1065353216,t[e+24>>2]=-1,t[e+28>>2]=0,t[e+16>>2]=0,t[e+20>>2]=1,t[e+36>>2]=i,t[e+8>>2]=21012,r=t[A+24>>2],t[e+32>>2]=r,t[e+12>>2]=t[r+4>>2],t[e+28>>2]=t[r+20>>2],ga(t[A+16>>2],t[A+20>>2],e+40|0,e+8|0),E=e+128|0;},sA,Cr,function(A,r){return A|=0,r|=0,A=t[A+24>>2],0|yf[t[t[A>>2]+8>>2]](A,r);},function(A,r,e){A|=0,r|=0,e|=0;var i,a,f=B(0);return i=E-16|0,E=i,t[i+8>>2]=-1,t[i+12>>2]=t[A+28>>2],t[r+4>>2]||(t[r+4>>2]=i+8),a=t[A+24>>2],f=B(yf[t[t[a>>2]+12>>2]](a,r,e)),t[A+4>>2]=t[t[A+24>>2]+4>>2],E=i+16|0,B(f);},Cr,Qa,Cr,Qa,Cr,function(A,r){A|=0,r|=0;var e,i,a,f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),Q=B(0),p=B(0),D=B(0),w=B(0);e=E-112|0,E=e,i=t[r+36>>2],r=t[t[A+24>>2]+28>>2]+_(i,80)|0,a=t[r+64>>2],d=C[r+32>>2],v=C[r>>2],g=C[r+16>>2],m=C[r+56>>2],R=C[r+52>>2],G=C[r+48>>2],h=C[r+36>>2],y=C[r+20>>2],Q=C[r+4>>2],f=C[r+40>>2],n=C[r+24>>2],b=C[r+8>>2],t[e+108>>2]=0,t[e+92>>2]=0,t[e+76>>2]=0,r=t[A+28>>2],o=C[r+32>>2],k=C[r+36>>2],c=C[r+40>>2],C[e+88>>2]=B(B(b*o)+B(n*k))+B(f*c),C[e+84>>2]=B(B(Q*o)+B(y*k))+B(h*c),u=C[r+16>>2],l=C[r+20>>2],s=C[r+24>>2],C[e+72>>2]=B(B(b*u)+B(n*l))+B(f*s),C[e+68>>2]=B(B(Q*u)+B(y*l))+B(h*s),C[e+104>>2]=B(B(B(G*o)+B(R*k))+B(m*c))+C[r+56>>2],C[e+100>>2]=B(B(B(G*u)+B(R*l))+B(m*s))+C[r+52>>2],t[e+60>>2]=0,p=b,b=C[r>>2],D=n,n=C[r+4>>2],w=f,f=C[r+8>>2],C[e+56>>2]=B(B(p*b)+B(D*n))+B(w*f),C[e+52>>2]=B(B(Q*b)+B(y*n))+B(h*f),C[e+48>>2]=B(B(v*b)+B(g*n))+B(d*f),C[e+96>>2]=B(B(B(G*b)+B(R*n))+B(m*f))+C[r+48>>2],C[e+80>>2]=B(B(v*o)+B(g*k))+B(d*c),C[e+64>>2]=B(B(v*u)+B(g*l))+B(d*s),t[e+28>>2]=1065353216,t[e+32>>2]=1,t[e+36>>2]=-1,t[e+44>>2]=i,t[e+24>>2]=21828,r=t[A+32>>2],t[e+40>>2]=r,t[e+28>>2]=t[r+4>>2],t[e+20>>2]=i,t[e+16>>2]=-1,t[e+4>>2]=a,r=t[A+4>>2],t[e>>2]=r,t[e+8>>2]=t[r+8>>2],t[e+12>>2]=e+48,Ba(t[A+8>>2],t[A+12>>2],t[A+16>>2],e,e+24|0,C[A+20>>2]),E=e+112|0;},sA,Cr,function(A,r){return A|=0,r|=0,A=t[A+16>>2],0|yf[t[t[A>>2]+8>>2]](A,r);},function(A,r,e){A|=0,r|=0,e|=0;var i,a,f=B(0);return i=E-16|0,E=i,t[i+8>>2]=-1,t[i+12>>2]=t[A+20>>2],t[r+4>>2]||(t[r+4>>2]=i+8),a=t[A+16>>2],f=B(yf[t[t[a>>2]+12>>2]](a,r,e)),t[A+4>>2]=t[t[A+16>>2]+4>>2],E=i+16|0,B(f);},sA,Cr,function(A,r){A|=0,r|=0;var e,i=0,a=0,f=0;return e=E-32|0,E=e,i=t[A+216>>2],C[i+4>>2]!=B(0)&&(a=1,r=t[r>>2],yf[t[t[i>>2]+8>>2]](i,t[r+188>>2])&&(i=t[A+216>>2],f=t[r+192>>2],t[e+24>>2]=-1,t[e+28>>2]=-1,t[e+20>>2]=r+4,t[e+16>>2]=r,t[e+12>>2]=f,t[e+8>>2]=0,ga(A+68|0,A+132|0,e+8|0,i))),E=e+32|0,0|a;},Cr,function(A,r){A|=0,r|=0;var e,i=0,a=0,f=B(0),n=0,b=0;return e=E-32|0,E=e,i=t[A+184>>2],C[i+4>>2]!=B(0)&&(a=1,r=t[r>>2],yf[t[t[i>>2]+8>>2]](i,t[r+188>>2])&&(i=t[A+184>>2],f=C[A+188>>2],n=t[A+192>>2],b=t[r+192>>2],t[e+24>>2]=-1,t[e+28>>2]=-1,t[e+20>>2]=r+4,t[e+16>>2]=r,t[e+12>>2]=b,t[e+8>>2]=0,Ba(n,A+36|0,A+100|0,e+8|0,i,f))),E=e+32|0,0|a;},sA,Cr,function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),p=B(0),D=B(0);e=E-96|0,E=e,t[e+92>>2]=0,a=C[r>>2],n=C[A+60>>2],b=C[r+4>>2],o=C[A- -64>>2],k=C[r+8>>2],c=C[A+68>>2],v=C[A+84>>2],d=B(B(B(B(a*n)+B(b*o))+B(k*c))+v),C[e+88>>2]=d,u=C[A+44>>2],_=C[A+48>>2],m=C[A+52>>2],R=C[A+80>>2],f=B(B(B(B(a*u)+B(b*_))+B(k*m))+R),C[e+84>>2]=f,G=a,a=C[A+28>>2],l=b,b=C[A+32>>2],s=k,k=C[A+36>>2],h=C[A+76>>2],D=B(B(B(B(G*a)+B(l*b))+B(s*k))+h),C[e+80>>2]=D,t[e+76>>2]=0,t[e+60>>2]=0,g=C[r+16>>2],l=C[r+20>>2],s=C[r+24>>2],y=B(v+B(B(B(n*g)+B(o*l))+B(c*s))),C[e+72>>2]=y,p=B(R+B(B(B(u*g)+B(_*l))+B(m*s))),C[e+68>>2]=p,g=B(h+B(B(B(a*g)+B(b*l))+B(k*s))),C[e+64>>2]=g,G=n,n=C[r+32>>2],l=o,o=C[r+36>>2],s=c,c=C[r+40>>2],v=B(v+B(B(B(G*n)+B(l*o))+B(s*c))),C[e+56>>2]=v,u=B(R+B(B(B(u*n)+B(_*o))+B(m*c))),C[e+52>>2]=u,a=B(h+B(B(B(a*n)+B(b*o))+B(k*c))),C[e+48>>2]=a,t[e+44>>2]=0,b=B(B(B(d+y)+v)*B(.3333333432674408)),C[e+40>>2]=b,o=B(B(B(f+p)+u)*B(.3333333432674408)),C[e+36>>2]=o,k=B(B(B(D+g)+a)*B(.3333333432674408)),C[e+32>>2]=k,r=t[A+8>>2],16384&yf[t[t[r>>2]+56>>2]](r)&&(n=C[e+80>>2],t[e+24>>2]=0,t[e+28>>2]=0,t[e+16>>2]=1065353216,t[e+20>>2]=1065353216,r=t[A+8>>2],t[e+12>>2]=0,c=B(g-n),u=B(u-f),_=B(p-f),a=B(a-n),f=B(B(c*u)-B(_*a)),s=f,l=B(f*f),f=B(v-d),n=B(y-d),d=B(B(_*f)-B(n*u)),f=B(B(n*a)-B(c*f)),a=B(B(1)/B(Q(B(l+B(B(d*d)+B(f*f)))))),C[e+8>>2]=B(s*a)+b,C[e+4>>2]=o+B(f*a),C[e>>2]=k+B(d*a),yf[t[t[r>>2]+16>>2]](r,e+32|0,e,e+16|0)),r=A+8|0,i=t[r>>2],A=A+12|0,yf[t[t[i>>2]+16>>2]](i,e+80|0,e- -64|0,A),i=t[r>>2],yf[t[t[i>>2]+16>>2]](i,e- -64|0,e+48|0,A),r=t[r>>2],yf[t[t[r>>2]+16>>2]](r,e+48|0,e+80|0,A),E=e+96|0;},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0,yf[t[t[A>>2]+8>>2]](A,r,e,i);},function(A){return A|=0,A+-4|0;},function(A){A|=0,rA(A+-4|0);},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0,A=A+-4|0,yf[t[t[A>>2]+8>>2]](A,r,e,i);},function(A){A|=0;var r=0,e=0;return t[A>>2]=22368,r=A+56|0,e=t[r>>2],e&&(b[A+60|0]&&gA(e),t[A+56>>2]=0),t[r>>2]=0,a[A+60|0]=1,r=A+48|0,t[r>>2]=0,t[r+4>>2]=0,r=A+36|0,e=t[r>>2],e&&(b[A+40|0]&&gA(e),t[A+36>>2]=0),t[r>>2]=0,a[A+40|0]=1,r=A+28|0,t[r>>2]=0,t[r+4>>2]=0,pa(A+4|0),0|A;},function(A){A|=0;var r=0,e=0;t[A>>2]=22368,r=A+56|0,e=t[r>>2],e&&(b[A+60|0]&&gA(e),t[A+56>>2]=0),t[r>>2]=0,a[A+60|0]=1,r=A+48|0,t[r>>2]=0,t[r+4>>2]=0,r=A+36|0,e=t[r>>2],e&&(b[A+40|0]&&gA(e),t[A+36>>2]=0),t[r>>2]=0,a[A+40|0]=1,r=A+28|0,t[r>>2]=0,t[r+4>>2]=0,pa(A+4|0),rA(A);},function(A,r,e){A|=0,r|=0,e|=0;var i,f=0,n=0,o=0;if(i=t[r+8>>2],(0|i)>=1)for(n=t[r+16>>2],e=0;f=t[n>>2],3&b[f+204|0]||(t[f+208>>2]=e,e=e+1|0),t[f+268>>2]=1065353216,t[f+212>>2]=-1,n=n+4|0,o=o+1|0,(0|o)<(0|i);){}else e=0;!function(A,r){var e=0,i=0,f=0,n=0,o=0,k=0,c=0,u=0;if(f=t[A+4>>2],(0|f)<(0|r)){if(t[A+8>>2]<(0|r)){A:{r:{if(r){if(n=CA(r<<3,16),e=t[A+4>>2],(0|e)>=1)break r;break A;}if(e=f,(0|e)<1)break A;}for(c=A+12|0;o=t[c>>2]+i|0,u=t[o+4>>2],k=i+n|0,t[k>>2]=t[o>>2],t[k+4>>2]=u,i=i+8|0,e=e+-1|0,e;){}}e=t[A+12>>2],e&&(b[A+16|0]&&gA(e),t[A+12>>2]=0),a[A+16|0]=1,t[A+12>>2]=n,t[A+8>>2]=r;}for(i=f<<3,e=r-f|0,f=A+12|0;n=t[f>>2]+i|0,t[n>>2]=0,t[n+4>>2]=0,i=i+8|0,e=e+-1|0,e;){}}if(t[A+4>>2]=r,(0|r)>=1)for(i=t[A+12>>2],e=0;t[i>>2]=e,t[i+4>>2]=1,i=i+8|0,e=e+1|0,(0|e)!=(0|r);){}}(A+4|0,e),function(A,r){var e,i=0,a=0,f=0,n=0,o=0,k=0;if(r=t[r+68>>2],r=0|yf[t[t[r>>2]+36>>2]](r),e=0|yf[t[t[r>>2]+36>>2]](r),e&&(o=0|yf[t[t[r>>2]+20>>2]](r),!((0|e)<1)))for(k=A+16|0;;){if(A=(n<<4)+o|0,r=t[t[A>>2]>>2],r&&(A=t[t[A+4>>2]>>2],!(!A|7&t[r+204>>2]|7&b[A+204|0]))){if(A=t[A+208>>2],a=t[k>>2],f=t[r+208>>2],i=a+(f<<3)|0,r=t[i>>2],(0|r)!=(0|f))for(;r=a+(r<<3)|0,t[i>>2]=t[r>>2],f=t[r>>2],i=a+(f<<3)|0,r=t[i>>2],(0|r)!=(0|f);){}if(i=a+(A<<3)|0,r=t[i>>2],(0|A)!=(0|r))for(;A=a+(r<<3)|0,t[i>>2]=t[A>>2],A=t[A>>2],i=a+(A<<3)|0,r=t[i>>2],(0|A)!=(0|r);){}(0|A)!=(0|f)&&(r=a+(f<<3)|0,t[r>>2]=A,A=a+(A<<3)|0,t[A+4>>2]=t[A+4>>2]+t[r+4>>2]);}if(n=n+1|0,(0|n)==(0|e))break;}}(A,r);},function(A,r){A|=0,r|=0;var e,i=0,a=0,f=0,n=0,o=0,k=0,c=0,u=0;e=t[r+8>>2];A:if(!((0|e)<1))for(c=t[r+16>>2],r=0,u=A+16|0;;){if(a=t[(i<<2)+c>>2],3&b[a+204|0]){if(t[a+208>>2]=-1,t[a+212>>2]=-2,i=i+1|0,(0|i)<(0|e))continue;break A;}if(A=r,k=A<<3,f=t[u>>2],n=k+f|0,o=t[n>>2],(0|A)!=(0|o))for(;A=f+(o<<3)|0,t[n>>2]=t[A>>2],A=t[A>>2],n=f+(A<<3)|0,o=t[n>>2],(0|A)!=(0|o);){}if(t[a+208>>2]=A,t[a+212>>2]=-1,t[4+(f+k|0)>>2]=i,r=r+1|0,i=i+1|0,!((0|i)<(0|e)))break;}},Va,dA,Ae,function(A,r,e,i,a){a=B(a);},qe,Dr,Ya,Ja,function(A){A|=0,gA(Ja(A));},function(A){A|=0;var r,e=0,i=0,a=0,f=0,n=0,b=0,o=0,k=0,c=0;if(r=E-16|0,E=r,$e(r+8|0,22808),Ra(A),yf[t[t[A>>2]+20>>2]](A)&&(e=0|yf[t[t[A>>2]+20>>2]](A),6144&yf[t[t[e>>2]+56>>2]](e)&&(e=0|yf[t[t[A>>2]+104>>2]](A),!((0|e)<1))))for(;e=e+-1|0,k=A,c=0|yf[t[t[A>>2]+108>>2]](A,e),o=t[t[A>>2]+172>>2],yf[o](0|k,0|c),(0|e)>0;){}if(yf[t[t[A>>2]+20>>2]](A)&&(e=0|yf[t[t[A>>2]+20>>2]](A),16387&yf[t[t[e>>2]+56>>2]](e)&&yf[t[t[A>>2]+20>>2]](A)&&(e=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[e>>2]+56>>2]](e)&&(i=A+296|0,!(t[i>>2]<1)))))for(e=0,n=A+72|0,b=A+304|0;a=t[t[b>>2]+e>>2],yf[t[t[a>>2]+12>>2]](a,t[n>>2]),e=e+4|0,f=f+1|0,(0|f)<t[i>>2];){}yf[t[t[A>>2]+20>>2]](A)&&(A=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[A>>2]+104>>2]](A)),Ai(),E=r+16|0;},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0,da(A,r,e,i);},function(A,r){A|=0,r|=0,!r|!(2&t[r+252>>2])?Ca(A,r):yf[t[t[A>>2]+92>>2]](A,r);},function(A,r){A|=0,r|=0;var e,i,a=0,f=0;yf[t[t[r>>2]+32>>2]](r),i=0|yf[t[t[r>>2]+16>>2]](r,104,1),e=x(t[i+8>>2],0,104),t[e+88>>2]=t[A+264>>2],t[e+92>>2]=t[A+268>>2],t[e+96>>2]=t[A+272>>2],t[e+100>>2]=t[A+276>>2],a=A+116|0,f=t[a+4>>2],t[e+20>>2]=t[a>>2],t[e+24>>2]=f,a=A+124|0,f=t[a+4>>2],t[e+28>>2]=t[a>>2],t[e+32>>2]=f,a=A+104|0,f=t[a+4>>2],t[e+12>>2]=t[a>>2],t[e+16>>2]=f,a=A+96|0,f=t[a+4>>2],t[e+4>>2]=t[a>>2],t[e+8>>2]=f,t[e>>2]=t[A+92>>2],t[e+36>>2]=t[A+132>>2],t[e+40>>2]=t[A+148>>2],t[e+44>>2]=t[A+152>>2],t[e+48>>2]=t[A+156>>2],t[e+52>>2]=t[A+160>>2],t[e+56>>2]=t[A+176>>2],t[e+60>>2]=t[A+180>>2],t[e+64>>2]=t[A+112>>2],t[e+68>>2]=t[A+164>>2],t[e+72>>2]=t[A+168>>2],t[e+76>>2]=t[A+172>>2],a=t[A+144>>2],t[e+84>>2]=0,t[e+80>>2]=a,yf[t[t[r>>2]+20>>2]](r,i,23125,1145853764,e),Ga(A,r),function(A,r){var e=0,i=0,a=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0;if(n=A+8|0,i=t[n>>2],(0|i)>=1)for(o=A+16|0;e=t[t[o>>2]+a>>2],2&b[e+252|0]&&(c=r,u=0|yf[t[t[e>>2]+16>>2]](e),l=1,k=t[t[r>>2]+16>>2],i=0|yf[k](0|c,0|u,0|l),l=r,u=i,c=0|yf[t[t[e>>2]+20>>2]](e,t[i+8>>2],r),s=1497645650,d=e,k=t[t[r>>2]+20>>2],yf[k](0|l,0|u,0|c,0|s,0|d),i=t[n>>2]),a=a+4|0,f=f+1|0,(0|f)<(0|i);){}if(e=A+228|0,t[e>>2]>=1)for(a=0,i=A+236|0,f=0;A=t[t[i>>2]+a>>2],d=r,s=0|yf[t[t[A>>2]+36>>2]](A),c=1,k=t[t[r>>2]+16>>2],n=0|yf[k](0|d,0|s,0|c),c=r,s=n,d=0|yf[t[t[A>>2]+40>>2]](A,t[n+8>>2],r),u=1397641027,l=A,k=t[t[r>>2]+20>>2],yf[k](0|c,0|s,0|d,0|u,0|l),a=a+4|0,f=f+1|0,(0|f)<t[e>>2];){}}(A,r),yf[t[t[r>>2]+36>>2]](r);},function(A,r,e,i){A|=0,r=B(r),e|=0,i=B(i);var f=0,n=0,o=B(0),k=0,c=0;A:{r:{e:{if(e){if(C[A+284>>2]=i,r=B(C[A+280>>2]+r),C[A+280>>2]=r,!(r>=i))break A;if(n=A+280|0,o=B(r/i),B(m(o))<B(2147483648))break e;f=-2147483648;break r;}t[A+284>>2]=0,C[A+280>>2]=b[A+316|0]?B(0):r,i=r,f=B(m(r))<B(1.1920928955078125e-7)^1,e=f;break A;}f=~~o;}C[n>>2]=r-B(B(0|f)*i);}if(yf[t[t[A>>2]+20>>2]](A)&&(n=0|yf[t[t[A>>2]+20>>2]](A),k=2808,c=yf[t[t[n>>2]+56>>2]](n)>>>4&1,a[0|k]=c),f){if(n=(0|f)>(0|e)?e:f,yf[t[t[A>>2]+168>>2]](A,B(i*B(0|n))),yf[t[t[A>>2]+176>>2]](A),(0|n)>=1)for(e=0;yf[t[t[A>>2]+160>>2]](A,i),yf[t[t[A>>2]+80>>2]](A),e=e+1|0,(0|e)<(0|n);){}return yf[t[t[A>>2]+120>>2]](A),0|f;}return yf[t[t[A>>2]+80>>2]](A),yf[t[t[A>>2]+120>>2]](A),0|f;},function(A,r,e){A|=0,r|=0,e|=0;var i,f=0,n=0,o=0,k=0,c=0,u=0;if(i=A+228|0,f=t[i>>2],(0|f)==t[A+232>>2]&&(o=f?f<<1:1,!((0|f)>=(0|o)))){A:{r:{if(o){if(u=CA(o<<2,16),f=t[A+228>>2],(0|f)>=1)break r;break A;}if((0|f)<1)break A;}for(k=A+236|0,n=f;t[c+u>>2]=t[t[k>>2]+c>>2],c=c+4|0,n=n+-1|0,n;){}}k=A+236|0,n=t[k>>2],n&&(b[A+240|0]&&(gA(n),f=t[A+228>>2]),t[A+236>>2]=0),t[k>>2]=u,a[A+240|0]=1,t[A+232>>2]=o;}t[i>>2]=f+1,t[t[A+236>>2]+(f<<2)>>2]=r,e&&(Ki(t[r+28>>2],r),Ki(t[r+32>>2],r));},function(A,r){A|=0,r|=0;var e=0,i=0,a=0,f=0;e=t[A+228>>2];A:if(!((0|e)<1)){for(f=t[A+236>>2],i=f;;){if((0|r)!=t[i>>2]){if(i=i+4|0,a=a+1|0,(0|a)<(0|e))continue;break A;}break;}(0|e)<=(0|a)||(a=i,i=e+-1|0,e=i<<2,t[a>>2]=t[e+f>>2],t[A+228>>2]=i,t[e+t[A+236>>2]>>2]=r);}qi(t[r+28>>2],r),qi(t[r+32>>2],r);},function(A,r){A|=0,r|=0;var e,i=0,f=0,n=0,o=0,k=0,c=0;if(e=A+296|0,i=t[e>>2],(0|i)==t[A+300>>2]&&(n=i?i<<1:1,!((0|i)>=(0|n)))){A:{r:{if(n){if(c=CA(n<<2,16),i=t[A+296>>2],(0|i)>=1)break r;break A;}if((0|i)<1)break A;}for(o=A+304|0,f=i;t[k+c>>2]=t[t[o>>2]+k>>2],k=k+4|0,f=f+-1|0,f;){}}o=A+304|0,f=t[o>>2],f&&(b[A+308|0]&&(gA(f),i=t[A+296>>2]),t[A+304>>2]=0),t[o>>2]=c,a[A+308|0]=1,t[A+300>>2]=n;}t[e>>2]=i+1,t[t[A+304>>2]+(i<<2)>>2]=r;},function(A,r){A|=0,r|=0;var e=0,i=0,a=0,f=0;e=t[A+296>>2];A:if(!((0|e)<1)){for(f=t[A+304>>2],i=f;;){if((0|r)!=t[i>>2]){if(i=i+4|0,a=a+1|0,(0|a)<(0|e))continue;break A;}break;}(0|e)<=(0|a)||(a=i,i=e+-1|0,e=i<<2,t[a>>2]=t[e+f>>2],t[A+296>>2]=i,t[e+t[A+304>>2]>>2]=r);}},function(A,r){A|=0,r|=0;var e,i=0,f=0,n=0,b=0,o=0;if(i=t[r+4>>2],t[A+264>>2]=t[r>>2],t[A+268>>2]=i,f=r+8|0,n=t[f+4>>2],i=A+272|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,e=A+248|0,f=t[e>>2],(0|f)>=1)for(i=0,o=A+256|0,A=0;n=t[t[o>>2]+i>>2],b=t[n+220>>2],2==(0|b)|5==(0|b)|1&a[n+564|0]||(Ui(n,r),f=t[e>>2]),i=i+4|0,A=A+1|0,(0|A)<(0|f);){}},function(A,r){A|=0,r|=0;var e=0;e=t[r+268>>2],t[A>>2]=t[r+264>>2],t[A+4>>2]=e,r=r+272|0,e=t[r+4>>2],A=A+8|0,t[A>>2]=t[r>>2],t[A+4>>2]=e;},function(A){A|=0;var r,e=0,i=B(0),a=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0;r=E+-64|0,E=r;A:if(b[A+290|0]){if(o=A+8|0,e=t[o>>2],(0|e)<1)break A;for(c=A+16|0,u=A+316|0,a=A+280|0,l=A+284|0;A=t[t[c>>2]+f>>2],!A|!(2&t[A+252>>2])||(n=A+540|0,!t[n>>2]|3&b[A+204|0]||(e=A+68|0,s=A+132|0,d=A+148|0,i=b[0|u]&&(i=C[l>>2],i!=B(0))?B(C[a>>2]-i):B(C[a>>2]*C[A+268>>2]),xi(e,s,d,i,r),A=t[n>>2],yf[t[t[A>>2]+12>>2]](A,r),e=t[o>>2])),f=f+4|0,k=k+1|0,(0|k)<(0|e);){}}else if(o=A+248|0,a=t[o>>2],!((0|a)<1))for(c=A+256|0,u=A+316|0,k=A+280|0,l=A+284|0,A=0;;){if(e=t[t[c>>2]+f>>2],n=t[e+220>>2],2==(0|n)|5==(0|n)|!t[e+540>>2]||3&b[e+204|0]){if(f=f+4|0,A=A+1|0,(0|A)<(0|a))continue;break A;}if(a=e+68|0,n=e+132|0,s=e+148|0,i=b[0|u]&&(i=C[l>>2],i!=B(0))?B(C[k>>2]-i):B(C[k>>2]*C[e+268>>2]),xi(a,n,s,i,r),e=t[e+540>>2],yf[t[t[e>>2]+12>>2]](e,r),f=f+4|0,A=A+1|0,a=t[o>>2],!((0|A)<(0|a)))break;}E=r- -64|0;},function(A,r){A|=0,r|=0;var e=0,i=0,f=0,n=0,o=0,k=0,c=0;if(3&b[r+204|0]|1&a[r+564|0]||Ui(r,A+264|0),t[r+192>>2]){A:{r:{e:{i:{a:{if(!(1&a[r+204|0])){if(k=A+248|0,e=t[k>>2],(0|e)!=t[A+252>>2])break r;if(f=e?e<<1:1,(0|e)>=(0|f))break r;if(!f)break a;if(c=CA(f<<2,16),e=t[A+248>>2],(0|e)>=1)break i;break e;}Vr(r,2);break A;}if((0|e)<1)break e;}for(n=A+256|0,i=e;t[o+c>>2]=t[t[n>>2]+o>>2],o=o+4|0,i=i+-1|0,i;){}}n=A+256|0,i=t[n>>2],i&&(b[A+260|0]&&(gA(i),e=t[A+248>>2]),t[A+256>>2]=0),t[n>>2]=c,a[A+260|0]=1,t[A+252>>2]=f;}t[k>>2]=e+1,t[t[A+256>>2]+(e<<2)>>2]=r;}e=r,r=3&t[r+204>>2],yf[t[t[A>>2]+36>>2]](A,e,r?2:1,r?-3:-1);}},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var f=0,n=0,o=0,k=0,c=0,u=0,l=0;if(3&b[r+204|0]|1&a[r+564|0]||Ui(r,A+264|0),t[r+192>>2]){A:{r:{e:{i:{a:{if(!(1&a[r+204|0])){if(u=A+248|0,f=t[u>>2],(0|f)!=t[A+252>>2])break r;if(o=f?f<<1:1,(0|f)>=(0|o))break r;if(!o)break a;if(l=CA(o<<2,16),f=t[A+248>>2],(0|f)>=1)break i;break e;}Vr(r,2);break A;}if((0|f)<1)break e;}for(k=A+256|0,n=f;t[c+l>>2]=t[t[k>>2]+c>>2],c=c+4|0,n=n+-1|0,n;){}}k=A+256|0,n=t[k>>2],n&&(b[A+260|0]&&(gA(n),f=t[A+248>>2]),t[A+256>>2]=0),t[k>>2]=l,a[A+260|0]=1,t[A+252>>2]=o;}t[u>>2]=f+1,t[t[A+256>>2]+(f<<2)>>2]=r;}yf[t[t[A>>2]+36>>2]](A,r,e,i);}},function(A,r){A|=0,r|=0;var e=0,i=0,a=0,f=0;e=t[A+248>>2];A:if(!((0|e)<1)){for(f=t[A+256>>2],i=f;;){if((0|r)!=t[i>>2]){if(i=i+4|0,a=a+1|0,(0|a)<(0|e))continue;break A;}break;}(0|e)<=(0|a)||(a=i,i=e+-1|0,e=i<<2,t[a>>2]=t[e+f>>2],t[A+248>>2]=i,t[e+t[A+256>>2]>>2]=r);}Ca(A,r);},function(A,r){A|=0,r|=0,b[A+289|0]&&gA(t[A+216>>2]),t[A+216>>2]=r,a[A+289|0]=0,t[t[A+212>>2]+8>>2]=r;},function(A){return A|=0,t[A+216>>2];},function(A){return A|=0,t[A+228>>2];},Sa,Sa,wr,function(A){A|=0;var r,e=0,i=0,a=0,f=0;if(r=A+248|0,t[r>>2]>=1)for(f=A+256|0,A=0;i=t[t[f>>2]+a>>2],e=i,t[e+472>>2]=0,t[e+476>>2]=0,e=e+496|0,t[e>>2]=0,t[e+4>>2]=0,e=i+488|0,t[e>>2]=0,t[e+4>>2]=0,i=i+480|0,t[i>>2]=0,t[i+4>>2]=0,a=a+4|0,A=A+1|0,(0|A)<t[r>>2];){}},Xa,Ma,Xa,Ma,function(A,r){A|=0,r=B(r);var e,i,a=0,f=0,n=0,o=0;e=E-16|0,E=e,$e(e+8|0,23099),i=A+248|0,a=t[i>>2];A:if(!((0|a)<1))for(o=A+256|0,A=0;;){if(n=t[t[o>>2]+f>>2],3&b[n+204|0]){if(f=f+4|0,A=A+1|0,(0|A)<(0|a))continue;break A;}if(ji(n,r),Mi(n,r,n+68|0),f=f+4|0,A=A+1|0,a=t[i>>2],!((0|A)<(0|a)))break;}Ai(),E=e+16|0;},function(A,r){A|=0,r=B(r);var e,i=0,a=0,f=B(0),n=0,o=0,k=B(0),c=B(0),u=0,l=B(0),s=0,d=0,v=0;if(e=E-80|0,E=e,$e(e+72|0,23041),i=t[A+248>>2],(0|i)>=1&&function(A,r,e,i){var a,f=0,n=0,o=0,k=0,c=B(0),u=0,l=0,s=0,d=0,v=0,g=0,_=0,m=0,R=0,G=B(0),h=0,y=0,Q=0,p=0,D=0,w=0,W=0,F=0,Z=0,Y=0,N=B(0),V=0;a=E-304|0,E=a;A:if(!((0|e)<1))for(_=a+56|0,d=a+40|0,Q=a+272|0,v=a+24|0,p=a+256|0,g=a+100|0,m=a+160|0,R=a+144|0,s=a+288|0,D=A+44|0,w=A+68|0,h=a+140|0,W=a+208|0,F=a+224|0,Z=a+220|0,y=a+216|0,Y=a+212|0;;){k=t[r>>2],t[k+268>>2]=1065353216;r:{if(f=t[k+220>>2],!(3&b[k+204|0]|2==(0|f)|5==(0|f))){if(Mi(k,i,a+240|0),!b[0|D])break r;if(c=C[k+276>>2],c=B(c*c),c==B(0))break r;if(N=c,f=k+52|0,c=B(C[s>>2]-C[f>>2]),G=B(c*c),c=B(C[a+292>>2]-C[k+56>>2]),G=B(G+B(c*c)),c=B(C[a+296>>2]-C[k+60>>2]),!(N<B(G+B(c*c))))break r;if($e(a+232|0,23021),t[t[k+192>>2]+4>>2]>19||(t[706]=t[706]+1,n=t[w>>2],n=0|yf[t[t[n>>2]+36>>2]](n),t[h>>2]=-1,o=f+8|0,u=t[o+4>>2],l=R+8|0,t[l>>2]=t[o>>2],t[l+4>>2]=u,o=t[f+4>>2],t[R>>2]=t[f>>2],t[R+4>>2]=o,t[W>>2]=0,t[F>>2]=t[A+24>>2],t[Z>>2]=n,t[y>>2]=0,t[Y>>2]=k,f=t[s+4>>2],t[m>>2]=t[s>>2],t[m+4>>2]=f,f=s+8|0,n=t[f+4>>2],o=m+8|0,t[o>>2]=t[f>>2],t[o+4>>2]=n,t[a+132>>2]=1065353216,t[a+136>>2]=1,t[a+128>>2]=23344,n=t[k+272>>2],ZA(a+72|0),t[g+16>>2]=0,o=g+8|0,t[o>>2]=0,t[o+4>>2]=0,t[g>>2]=0,t[g+4>>2]=0,o=a+88|0,t[o>>2]=1065353216,t[o+4>>2]=1065353216,t[a+96>>2]=1065353216,t[a+124>>2]=0,t[a+120>>2]=n,t[a+104>>2]=n,t[y>>2]=t[A+56>>2],n=t[k+188>>2],t[a+136>>2]=t[n+4>>2],t[a+76>>2]=8,t[a+72>>2]=9912,t[h>>2]=t[n+8>>2],n=t[f+4>>2],o=_+8|0,t[o>>2]=t[f>>2],t[o+4>>2]=n,f=t[s+4>>2],t[_>>2]=t[s>>2],t[_+4>>2]=f,f=a+248|0,o=t[f+4>>2],n=a+16|0,t[n>>2]=t[f>>2],t[n+4>>2]=o,f=p,o=t[f+4>>2],t[v>>2]=t[f>>2],t[v+4>>2]=o,f=f+8|0,u=t[f+4>>2],o=v+8|0,t[o>>2]=t[f>>2],t[o+4>>2]=u,f=Q,u=t[f+4>>2],t[d>>2]=t[f>>2],t[d+4>>2]=u,f=f+8|0,l=t[f+4>>2],u=d+8|0,t[u>>2]=t[f>>2],t[u+4>>2]=l,f=t[a+244>>2],t[a+8>>2]=t[a+240>>2],t[a+12>>2]=f,f=k+4|0,l=f+8|0,V=t[l+4>>2],t[n>>2]=t[l>>2],t[n+4>>2]=V,n=t[f+4>>2],t[a+8>>2]=t[f>>2],t[a+12>>2]=n,n=k+28|0,l=t[n+4>>2],t[o>>2]=t[n>>2],t[o+4>>2]=l,n=k+20|0,o=t[n+4>>2],t[v>>2]=t[n>>2],t[v+4>>2]=o,n=k+44|0,o=t[n+4>>2],t[u>>2]=t[n>>2],t[u+4>>2]=o,n=k+36|0,o=t[n+4>>2],t[d>>2]=t[n>>2],t[d+4>>2]=o,ma(A,a+72|0,f,a+8|0,a+128|0,B(0)),c=C[a+132>>2],!(c<B(1)))){Ai();break r;}f=k+268|0,C[f>>2]=c,Mi(k,B(c*i),a+240|0),t[f>>2]=0,Hi(k,a+240|0),Ai();}if(r=r+4|0,e=e+-1|0,e)continue;break A;}if(Hi(k,a+240|0),r=r+4|0,e=e+-1|0,!e)break;}E=a+304|0;}(A,t[A+256>>2],i,r),b[A+291|0]){if($e(e- -64|0,23061),s=A+324|0,t[s>>2]>=1)for(v=A+332|0;;){if(n=t[t[v>>2]+(u<<2)>>2],!(t[n+780>>2]<1))if(A=t[n+776>>2],i=t[A+252>>2]<<30>>31&A,A=t[n+772>>2],a=t[A+252>>2]<<30>>31&A,a)for(A=n+128|0,o=0;r=vr(a,i),r>B(0)&&(f=C[A>>2],f!=B(0)&&(l=C[A+-60>>2],k=C[A+-56>>2],c=C[A+-52>>2],t[e+60>>2]=0,d=e+56|0,C[d>>2]=-B(r*B(c*f)),C[e+52>>2]=-B(r*B(k*f)),C[e+48>>2]=-B(r*B(l*f)),t[e+44>>2]=0,C[e+40>>2]=C[A+-68>>2]-C[a+60>>2],C[e+36>>2]=C[A+-72>>2]-C[a+56>>2],C[e+32>>2]=C[A+-76>>2]-C[a+52>>2],t[e+28>>2]=0,C[e+24>>2]=C[A+-84>>2]-C[i+60>>2],C[e+20>>2]=C[A+-88>>2]-C[i+56>>2],C[e+16>>2]=C[A+-92>>2]-C[i+52>>2],gf(a,e+48|0,e+32|0),t[e+12>>2]=0,C[e+8>>2]=-C[d>>2],C[e+4>>2]=-C[e+52>>2],C[e>>2]=-C[e+48>>2],gf(i,e,e+16|0))),A=A+192|0,o=o+1|0,(0|o)<t[n+780>>2];){}else for(A=n+68|0,o=0;r=vr(a,i),r>B(0)&&(f=C[A+60>>2],f!=B(0)&&(l=C[A+4>>2],k=C[A+8>>2],c=C[A>>2],t[e+60>>2]=0,k=B(r*B(k*f)),C[e+56>>2]=-k,c=B(r*B(c*f)),C[e+48>>2]=-c,r=B(r*B(l*f)),C[e+52>>2]=-r,t[e+44>>2]=0,C[e+40>>2]=C[A+-8>>2]-C[a+60>>2],C[e+36>>2]=C[A+-12>>2]-C[a+56>>2],C[e+32>>2]=C[A+-16>>2]-C[a+52>>2],t[e+28>>2]=0,C[e+24>>2]=C[A+-24>>2]-C[i+60>>2],C[e+20>>2]=C[A+-28>>2]-C[i+56>>2],C[e+16>>2]=C[A+-32>>2]-C[i+52>>2],t[e+12>>2]=0,C[e+8>>2]=k,C[e+4>>2]=r,C[e>>2]=c,gf(i,e,e+16|0))),A=A+192|0,o=o+1|0,(0|o)<t[n+780>>2];){}if(u=u+1|0,!((0|u)<t[s>>2]))break;}Ai();}Ai(),E=e+80|0;},function(A){A|=0;var r,e=0,i=0,a=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0,g=0,_=0,B=0,m=0,R=0,G=0,h=0,y=0;for(r=E-16|0,E=r,$e(r+8|0,22905),e=t[A+220>>2],yf[t[t[e>>2]+8>>2]](e,A,t[A+24>>2]),d=t[A+324>>2],(0|d)>=1?(C=t[A+332>>2],g=2,o=3,_=A+220|0,B=16,e=1):e=0;;){A:{r:{e:{i:{a:{f:{if(!e){if(v=t[A+228>>2],(0|v)<1)break f;m=t[A+236>>2],u=0,R=2,G=1,k=3,h=A+220|0,y=16,n=1;break r;}if(!n){if(i=t[(l<<g)+C>>2],e=t[i+772>>2],e&&(i=t[i+776>>2],!(!i|t[e+204>>2]&o|b[i+204|0]&o))){if(i=t[i+208>>2],c=t[t[_>>2]+B>>2],f=t[e+208>>2],e=c+(f<<o)|0,a=t[e>>2],(0|a)!=(0|f))for(;s=e,e=c+(a<<o)|0,t[s>>2]=t[e>>2],f=t[e>>2],e=c+(f<<o)|0,a=t[e>>2],(0|a)!=(0|f);){}if(e=c+(i<<o)|0,a=t[e>>2],(0|i)!=(0|a))for(;s=e,e=c+(a<<o)|0,t[s>>2]=t[e>>2],i=t[e>>2],e=c+(i<<o)|0,a=t[e>>2],(0|i)!=(0|a);){}(0|i)!=(0|f)&&(e=c+(f<<o)|0,t[e>>2]=i,i=c+(i<<o)|0,t[i+4>>2]=t[i+4>>2]+t[e+4>>2]);}if(l=l+1|0,(0|l)<(0|d))break a;e=0;continue;}if(e=t[(u<<R)+m>>2],b[e+20|0]&&(i=t[e+28>>2],!(b[i+204|0]&k||(e=t[e+32>>2],b[e+204|0]&k)))){if(n=t[e+208>>2],a=t[t[h>>2]+y>>2],i=t[i+208>>2],f=a+(i<<k)|0,e=t[f>>2],(0|e)!=(0|i))for(;e=a+(e<<k)|0,t[f>>2]=t[e>>2],i=t[e>>2],f=a+(i<<k)|0,e=t[f>>2],(0|e)!=(0|i);){}if(f=a+(n<<k)|0,e=t[f>>2],(0|n)!=(0|e))for(;e=a+(e<<k)|0,t[f>>2]=t[e>>2],n=t[e>>2],f=a+(n<<k)|0,e=t[f>>2],(0|e)!=(0|n);){}(0|i)!=(0|n)&&(e=a+(i<<k)|0,t[e>>2]=n,i=a+(n<<k)|0,t[i+4>>2]=t[i+4>>2]+t[e+4>>2]);}if(u=u+G|0,(0|u)!=(0|v))break i;}return e=t[A+220>>2],yf[t[t[e>>2]+12>>2]](e,A),Ai(),void(E=r+16|0);}n=0;break e;}n=1;break A;}e=1;continue;}e=1;continue;}e=1;}},function(A,r){A|=0,r|=0;var e,i,f,n,o,k,c=0,u=0,l=0,s=0,d=0,v=0;if(e=E-16|0,E=e,$e(e+8|0,22888),i=A+196|0,l=t[i>>2],s=t[A+228>>2],(0|l)<(0|s)){if(t[A+200>>2]<(0|s)){A:{r:{if(s){if(d=CA(s<<2,16),c=t[A+196>>2],(0|c)>=1)break r;break A;}if(c=l,(0|c)<1)break A;}for(v=A+204|0;t[u+d>>2]=t[t[v>>2]+u>>2],u=u+4|0,c=c+-1|0,c;){}}c=A+204|0,u=t[c>>2],u&&(b[A+208|0]&&gA(u),t[A+204>>2]=0),t[c>>2]=d,a[A+208|0]=1,t[A+200>>2]=s;}for(u=l<<2,c=s-l|0,l=A+204|0;t[t[l>>2]+u>>2]=0,u=u+4|0,c=c+-1|0,c;){}}if(t[i>>2]=s,(0|yf[t[t[A>>2]+104>>2]](A))>=1)for(u=0,l=A+204|0,s=A+236|0,c=0;t[t[l>>2]+u>>2]=t[t[s>>2]+u>>2],u=u+4|0,c=c+1|0,(0|c)<(0|yf[t[t[A>>2]+104>>2]](A));){}c=t[A+196>>2],(0|c)>=2&&function A(r,e,i,a){var f=0,n=0,b=0,o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0;for(l=r+12|0;;){for(d=i,b=t[l>>2],s=t[b+((i+a|0)/2<<2)>>2],n=a;;){k=t[t[s+28>>2]+208>>2],c=(0|k)<0;A:if(c)for(o=i+-1|0,i=((i<<2)+b|0)-4|0,f=t[t[s+32>>2]+208>>2];;){if(i=i+4|0,u=t[i>>2],v=t[t[u+28>>2]+208>>2],(0|v)>-1){if(o=o+1|0,(0|v)<(0|f))continue;break A;}if(o=o+1|0,!(t[t[u+32>>2]+208>>2]<(0|f)))break;}else for(o=i+-1|0,i=((i<<2)+b|0)-4|0;;){if(i=i+4|0,f=t[i>>2],u=t[t[f+28>>2]+208>>2],(0|u)>-1){if(o=o+1|0,(0|u)<(0|k))continue;break A;}if(o=o+1|0,!(t[t[f+32>>2]+208>>2]<(0|k)))break;}A:if(c)for(f=n+1|0,n=4+((n<<2)+b|0)|0,b=t[t[s+32>>2]+208>>2];;){if(n=n+-4|0,k=t[n>>2],c=t[t[k+28>>2]+208>>2],(0|c)>-1){if(f=f+-1|0,(0|b)<(0|c))continue;break A;}if(f=f+-1|0,!((0|b)<t[t[k+32>>2]+208>>2]))break;}else for(f=n+1|0,n=4+((n<<2)+b|0)|0;;){if(n=n+-4|0,b=t[n>>2],c=t[t[b+28>>2]+208>>2],(0|c)>-1){if(f=f+-1|0,(0|k)<(0|c))continue;break A;}if(f=f+-1|0,!((0|k)<t[t[b+32>>2]+208>>2]))break;}A:{r:{if((0|o)>(0|f)){if(n=f,i=o,(0|i)<=(0|f))break r;break A;}if(b=t[i>>2],t[i>>2]=t[n>>2],t[t[l>>2]+(f<<2)>>2]=b,i=o+1|0,n=f+-1|0,(0|i)>(0|n))break A;}b=t[l>>2];continue;}break;}if((0|n)>(0|d)&&A(r,e,d,n),!((0|i)<(0|a)))break;}}(A+192|0,e,0,c+-1|0),u=yf[t[t[A>>2]+104>>2]](A)?t[A+204>>2]:0,function(A,r,e,i,f){if(t[A+20>>2]=f,t[A+16>>2]=i,t[A+12>>2]=e,t[A+4>>2]=r,i=A+32|0,e=t[i>>2],(0|e)<=-1)for(t[A+36>>2]<=-1&&(r=t[A+40>>2],r&&(b[A+44|0]&&gA(r),t[A+40>>2]=0),a[A+44|0]=1,r=A+36|0,t[r>>2]=0,t[r+4>>2]=0),r=e<<2,f=A+40|0;t[t[f>>2]+r>>2]=0,r=r+4|0,e=e+1|0,e;){}if(t[i>>2]=0,i=A+52|0,e=t[i>>2],(0|e)<=-1)for(t[A+56>>2]<=-1&&(r=t[A+60>>2],r&&(b[A- -64|0]&&gA(r),t[A+60>>2]=0),a[A- -64|0]=1,r=A+56|0,t[r>>2]=0,t[r+4>>2]=0),r=e<<2,f=A+60|0;t[t[f>>2]+r>>2]=0,r=r+4|0,e=e+1|0,e;){}if(t[i>>2]=0,i=A+72|0,e=t[i>>2],(0|e)<=-1)for(t[A+76>>2]<=-1&&(r=t[A+80>>2],r&&(b[A+84|0]&&gA(r),t[A+80>>2]=0),a[A+84|0]=1,r=A+76|0,t[r>>2]=0,t[r+4>>2]=0),r=e<<2,A=A+80|0;t[t[A>>2]+r>>2]=0,r=r+4|0,e=e+1|0,e;){}t[i>>2]=0;}(t[A+212>>2],r,u,t[A+196>>2],0|yf[t[t[A>>2]+20>>2]](A)),c=t[A+216>>2],l=t[A+24>>2],n=c,o=t[A+8>>2],k=0|yf[t[t[l>>2]+36>>2]](l),f=t[t[c>>2]+8>>2],yf[f](0|n,0|o,0|k),wa(t[A+220>>2],t[A+24>>2],A,t[A+212>>2]),xa(t[A+212>>2]),c=t[A+216>>2],yf[t[t[c>>2]+16>>2]](c,r,t[A+72>>2]),Ai(),E=e+16|0;},function(A,r){A|=0,r=B(r);var e,i,a=B(0),f=0,n=B(0),o=0,k=0,c=0;if(e=E-16|0,E=e,$e(e+8|0,22866),i=A+248|0,t[i>>2]>=1)for(c=A+256|0;;){A=t[t[c>>2]+o>>2];A:if(A){r:{f=t[A+220>>2];e:{if(!(2==(0|f)|4==(0|f))){if(a=C[A+372>>2],n=B(a*a),a=C[A+376>>2],n=B(n+B(a*a)),a=C[A+380>>2],n=B(n+B(a*a)),a=C[A+532>>2],n<B(a*a)&&(a=C[A+388>>2],n=B(a*a),a=C[A+392>>2],n=B(n+B(a*a)),a=C[A+396>>2],n=B(n+B(a*a)),a=C[A+536>>2],n<B(a*a))){if(C[A+224>>2]=C[A+224>>2]+r,!b[2808])break e;break r;}t[A+224>>2]=0,Vr(A,0),f=t[A+220>>2];}if(4==(0|f))break A;if(b[2808])break r;}if(a=C[800],!(a==B(0)|(C[A+224>>2]>a^1?2!=(-2&f):0))){if(!(3&b[A+204|0])){if(1==(0|f)&&(Vr(A,3),f=t[A+220>>2]),2!=(0|f))break A;t[A+388>>2]=0,t[A+392>>2]=0,t[A+372>>2]=0,t[A+376>>2]=0,f=A+396|0,t[f>>2]=0,t[f+4>>2]=0,f=A+380|0,t[f>>2]=0,t[f+4>>2]=0,t[A+304>>2]=t[A+304>>2]+2;break A;}Vr(A,2);break A;}}Vr(A,1);}if(o=o+4|0,k=k+1|0,!((0|k)<t[i>>2]))break;}Ai(),E=e+16|0;},function(A,r){A|=0,r=B(r);var e,i,a,f,n=0,b=0,o=0,k=0;if(e=E-16|0,E=e,$e(e,22823),n=t[A+84>>2],n&&yf[n](A,r),yf[t[t[A>>2]+140>>2]](A,r),n=0,t[A+32>>2]=0,C[A+28>>2]=r,a=A+48|0,f=0|yf[t[t[A>>2]+20>>2]](A),t[a>>2]=f,yf[t[t[A>>2]+164>>2]](A,r),yf[t[t[A>>2]+44>>2]](A),yf[t[t[A>>2]+148>>2]](A),C[A+104>>2]=r,yf[t[t[A>>2]+152>>2]](A,A+92|0),yf[t[t[A>>2]+144>>2]](A,r),$e(e+8|0,22852),i=A+296|0,t[i>>2]>=1)for(k=A+304|0;b=t[t[k>>2]+n>>2],yf[t[t[b>>2]+8>>2]](b,A,r),n=n+4|0,o=o+1|0,(0|o)<t[i>>2];){}Ai(),yf[t[t[A>>2]+156>>2]](A,r),n=t[A+80>>2],n&&yf[n](A,r),Ai(),E=e+16|0;},function(A,r){A|=0,r=B(r);var e,i,f,n=0,o=0,k=0,c=0,u=0;if(e=E-16|0,E=e,$e(e,22996),$e(e+8|0,22959),i=A+332|0,n=t[i>>2],f=A+324|0,t[f>>2]>=1)for(u=A+24|0;o=t[u>>2],yf[t[t[o>>2]+16>>2]](o,t[n+k>>2]),k=k+4|0,n=t[i>>2],c=c+1|0,(0|c)<t[f>>2];){}n&&(b[A+336|0]&&gA(n),t[A+332>>2]=0),t[A+332>>2]=0,a[A+336|0]=1,n=A+324|0,t[n>>2]=0,t[n+4>>2]=0,Ai(),n=t[A+248>>2],(0|n)>=1&&function(A,r,e,i){var f,n=0,o=0,k=0,c=0,u=B(0),l=0,s=B(0),d=B(0),v=B(0),g=0,m=B(0),R=0,y=0,Q=B(0),p=0,D=0,w=0,W=0,F=0,Z=0,Y=0,N=B(0),V=0,I=0,J=0,X=0,M=B(0),x=B(0),S=B(0),T=B(0),U=B(0),j=0,O=0,H=0,z=0,P=0,L=0,K=0,q=0,$=B(0),AA=0,rA=0,eA=0,iA=0,aA=0,fA=B(0),nA=B(0),tA=B(0),bA=B(0),oA=0,kA=0,cA=0,uA=0,lA=0,sA=0,dA=0,vA=B(0),_A=B(0);f=E-496|0,E=f;A:if(!((0|e)<1))for(R=f+124|0,j=f+92|0,O=f+72|0,V=f+368|0,H=f+248|0,F=f+232|0,oA=f+464|0,Z=f+216|0,kA=f+448|0,I=f+292|0,z=f+352|0,P=f+336|0,y=f+480|0,cA=A+44|0,uA=A+68|0,AA=f+332|0,J=f+400|0,lA=f+416|0,sA=f+412|0,rA=f+408|0,eA=A+328|0,X=A+324|0,Y=A+332|0,iA=A+336|0;;){if(c=t[(D<<2)+r>>2],t[c+268>>2]=1065353216,n=t[c+220>>2],!(3&b[c+204|0]|2==(0|n)|5==(0|n))&&(Mi(c,i,f+432|0),b[0|cA]&&(u=C[c+276>>2],u=B(u*u),u!=B(0)&&(Q=u,g=c+52|0,u=B(C[y>>2]-C[g>>2]),s=B(u*u),p=f+484|0,L=c+56|0,u=B(C[p>>2]-C[L>>2]),s=B(s+B(u*u)),w=f+488|0,K=c+60|0,u=B(C[w>>2]-C[K>>2]),Q<B(s+B(u*u)))))){if($e(f+424|0,22932),t[t[c+192>>2]+4>>2]<=19&&(t[706]=t[706]+1,n=t[uA>>2],n=0|yf[t[t[n>>2]+36>>2]](n),t[AA>>2]=-1,q=g+8|0,o=q,k=t[o+4>>2],l=P+8|0,t[l>>2]=t[o>>2],t[l+4>>2]=k,o=t[g+4>>2],t[P>>2]=t[g>>2],t[P+4>>2]=o,t[J>>2]=0,aA=A+24|0,t[lA>>2]=t[aA>>2],t[sA>>2]=n,t[rA>>2]=0,t[f+404>>2]=c,n=t[y+4>>2],t[z>>2]=t[y>>2],t[z+4>>2]=n,n=y+8|0,o=t[n+4>>2],k=z+8|0,t[k>>2]=t[n>>2],t[k+4>>2]=o,t[f+324>>2]=1065353216,t[f+328>>2]=1,t[f+320>>2]=23344,o=t[c+272>>2],ZA(f+264|0),t[I+16>>2]=0,k=I+8|0,t[k>>2]=0,t[k+4>>2]=0,t[I>>2]=0,t[I+4>>2]=0,k=f+280|0,t[k>>2]=1065353216,t[k+4>>2]=1065353216,t[f+288>>2]=1065353216,t[f+316>>2]=0,t[f+312>>2]=o,t[f+296>>2]=o,t[rA>>2]=t[A+56>>2],o=t[c+188>>2],t[f+328>>2]=t[o+4>>2],t[f+268>>2]=8,t[f+264>>2]=9912,t[AA>>2]=t[o+8>>2],o=t[n+4>>2],k=H+8|0,t[k>>2]=t[n>>2],t[k+4>>2]=o,n=t[y+4>>2],t[H>>2]=t[y>>2],t[H+4>>2]=n,n=f+440|0,k=t[n+4>>2],o=f+208|0,t[o>>2]=t[n>>2],t[o+4>>2]=k,n=kA,k=t[n+4>>2],t[Z>>2]=t[n>>2],t[Z+4>>2]=k,n=n+8|0,l=t[n+4>>2],k=Z+8|0,t[k>>2]=t[n>>2],t[k+4>>2]=l,n=oA,l=t[n+4>>2],t[F>>2]=t[n>>2],t[F+4>>2]=l,n=n+8|0,W=t[n+4>>2],l=F+8|0,t[l>>2]=t[n>>2],t[l+4>>2]=W,n=t[f+436>>2],t[f+200>>2]=t[f+432>>2],t[f+204>>2]=n,n=c+4|0,W=n+8|0,dA=t[W+4>>2],t[o>>2]=t[W>>2],t[o+4>>2]=dA,o=t[n+4>>2],t[f+200>>2]=t[n>>2],t[f+204>>2]=o,o=c+28|0,W=t[o+4>>2],t[k>>2]=t[o>>2],t[k+4>>2]=W,o=c+20|0,k=t[o+4>>2],t[Z>>2]=t[o>>2],t[Z+4>>2]=k,o=c+44|0,k=t[o+4>>2],t[l>>2]=t[o>>2],t[l+4>>2]=k,o=c+36|0,k=t[o+4>>2],t[F>>2]=t[o>>2],t[F+4>>2]=k,ma(A,f+264|0,n,f+200|0,f+320|0,B(0)),u=C[f+324>>2],u<B(1))){if(N=C[K>>2],d=C[L>>2],m=C[g>>2],v=C[f+376>>2],M=C[w>>2],x=C[f+372>>2],S=C[p>>2],T=C[V>>2],U=C[y>>2],n=t[aA>>2],l=0|yf[t[t[n>>2]+12>>2]](n,c,t[J>>2]),fA=B(u*B(S-d)),d=B(u*B(U-m)),Q=v,v=B(u*B(M-N)),m=B(B(B(-B(x*fA))-B(T*d))-B(Q*v)),n=t[X>>2],(0|n)==t[eA>>2]&&(p=n?n<<1:1,!((0|n)>=(0|p)))){r:{e:{if(p){if(w=CA(p<<2,16),n=t[X>>2],(0|n)>=1)break e;break r;}if(w=0,(0|n)<1)break r;}for(k=0,o=n;t[k+w>>2]=t[t[Y>>2]+k>>2],k=k+4|0,o=o+-1|0,o;){}}o=t[Y>>2],o&&(b[0|iA]&&(gA(o),n=t[X>>2]),t[Y>>2]=0),t[Y>>2]=w,a[0|iA]=1,t[eA>>2]=p;}t[t[Y>>2]+(n<<2)>>2]=l,t[X>>2]=n+1,n=t[J>>2],M=C[n+20>>2],x=C[n+36>>2],S=C[n+40>>2],T=C[n+8>>2],U=C[n+24>>2],u=C[n+60>>2],vA=C[n+52>>2],N=C[n+56>>2],nA=C[n+44>>2],_A=C[K>>2],s=C[n+12>>2],$=C[g>>2],tA=C[n+28>>2],Q=C[L>>2],bA=C[n+4>>2],n=f+16|0,t[n>>2]=0,t[n+4>>2]=0,t[f+36>>2]=0,C[f+88>>2]=m,n=j+8|0,t[n>>2]=0,t[n+4>>2]=0,t[j>>2]=0,t[j+4>>2]=0,t[R+40>>2]=0,n=R+32|0,t[n>>2]=0,t[n+4>>2]=0,n=R+24|0,t[n>>2]=0,t[n+4>>2]=0,n=R+16|0,t[n>>2]=0,t[n+4>>2]=0,n=R+8|0,t[n>>2]=0,t[n+4>>2]=0,t[R>>2]=0,t[R+4>>2]=0,n=t[V+4>>2],t[O>>2]=t[V>>2],t[O+4>>2]=n,n=V+8|0,o=t[n+4>>2],k=O+8|0,t[k>>2]=t[n>>2],t[k+4>>2]=o,d=B(d+$),m=B(fA+Q),v=B(v+_A),$=B(B(B(s*d)+B(tA*m))+B(nA*v)),Q=s,s=B(-vA),C[f+32>>2]=$+B(B(B(Q*s)-B(tA*N))-B(nA*u)),C[f+28>>2]=B(B(B(d*T)+B(m*U))+B(v*S))+B(B(B(T*s)-B(U*N))-B(S*u)),C[f+24>>2]=B(B(B(d*bA)+B(m*M))+B(v*x))+B(B(B(bA*s)-B(M*N))-B(x*u)),t[f+8>>2]=0,t[f+12>>2]=0,n=l+_(sr(l,f+8|0),192)|0,t[n+100>>2]=0,C[n+88>>2]=G(B(h(B(C[c+228>>2]*C[t[J>>2]+228>>2]),B(-10))),B(10)),o=t[q+4>>2],c=n+60|0,t[c>>2]=t[q>>2],t[c+4>>2]=o,o=t[g+4>>2],c=n+52|0,t[c>>2]=t[g>>2],t[c+4>>2]=o,t[n+48>>2]=0,C[n+44>>2]=v,C[n+40>>2]=m,C[n+36>>2]=d;}if(Ai(),D=D+1|0,(0|D)!=(0|e))continue;break A;}if(D=D+1|0,(0|D)==(0|e))break;}E=f+496|0;}(A,t[A+256>>2],n,r),Ai(),E=e+16|0;},function(A,r){A|=0,r=B(r);var e,i=0,a=0,f=0,n=0;if(e=A+8|0,i=t[e>>2],(0|i)>=1)for(n=A+16|0;A=t[t[n>>2]+a>>2],!A|!(2&t[A+252>>2])|!(2&b[A+204|0])|2==t[A+220>>2]||(Si(A,r),i=t[e>>2]),a=a+4|0,f=f+1|0,(0|f)<(0|i);){}},function(A,r){A|=0,r|=0;var e,i=0,a=0,f=0,n=0,o=0,k=0,c=B(0),u=B(0),l=B(0),s=0,d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=0,y=0,Q=0,p=0,D=B(0),w=B(0),W=B(0),F=B(0),Z=B(0),Y=B(0),N=0,V=B(0),I=B(0),J=B(0),X=0,M=B(0),x=B(0),S=B(0),T=B(0),U=B(0),j=B(0),O=0,H=B(0),z=B(0),P=B(0),L=0;e=E-176|0,E=e,i=0|yf[t[t[A>>2]+20>>2]](A),i=0|yf[t[t[i>>2]+56>>2]](i),f=0|yf[t[t[A>>2]+20>>2]](A),f=0|yf[t[t[f>>2]+56>>2]](f);A:if(Y=C[r+40>>2],!(Y<=B(0)||(n=t[r+4>>2]+-3|0,n>>>0>9))){a=2048&i,k=4096&f;r:{e:{i:{a:{f:{n:{t:{b:{o:{k:{c:{u:{l:{s:{d:{v:{switch(n-1|0){case 2:case 5:if(f=r+1072|0,n=t[f+4>>2],o=e+120|0,i=o,t[i>>2]=t[f>>2],t[i+4>>2]=n,f=r+1088|0,n=t[f+4>>2],i=e+136|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,f=r+1104|0,n=t[f+4>>2],i=e+152|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,f=r+1120|0,n=t[f+4>>2],i=e+168|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,y=r+1064|0,i=y,f=t[i+4>>2],t[e+112>>2]=t[i>>2],t[e+116>>2]=f,N=r+1080|0,i=N,f=t[i+4>>2],t[e+128>>2]=t[i>>2],t[e+132>>2]=f,p=r+1096|0,i=p,f=t[i+4>>2],t[e+144>>2]=t[i>>2],t[e+148>>2]=f,X=r+1112|0,i=X,f=t[i+4>>2],t[e+160>>2]=t[i>>2],t[e+164>>2]=f,i=e+160|0,f=e+144|0,n=e+128|0,!a)break v;if(a=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[a>>2]+64>>2]](a,e+112|0,Y),s=r+1184|0,h=t[s+4>>2],a=i+8|0,t[a>>2]=t[s>>2],t[a+4>>2]=h,a=r+1176|0,s=t[a+4>>2],t[i>>2]=t[a>>2],t[i+4>>2]=s,a=r+1144|0,s=t[a+4>>2],t[n>>2]=t[a>>2],t[n+4>>2]=s,s=r+1152|0,h=t[s+4>>2],a=n+8|0,t[a>>2]=t[s>>2],t[a+4>>2]=h,a=r+1160|0,s=t[a+4>>2],t[f>>2]=t[a>>2],t[f+4>>2]=s,s=r+1168|0,h=t[s+4>>2],a=f+8|0,t[a>>2]=t[s>>2],t[a+4>>2]=h,a=r+1136|0,s=t[a+4>>2],t[o>>2]=t[a>>2],t[o+4>>2]=s,a=r+1128|0,o=t[a+4>>2],t[e+112>>2]=t[a>>2],t[e+116>>2]=o,a=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[a>>2]+64>>2]](a,e+112|0,Y),k)break d;break A;default:if(f=e+172|0,t[f>>2]=0,n=e+164|0,i=n,t[i>>2]=0,t[i+4>>2]=0,i=e+156|0,t[i>>2]=0,t[i+4>>2]=0,i=e+124|0,t[i>>2]=0,t[i+4>>2]=0,t[e+132>>2]=1065353216,i=e+136|0,t[i>>2]=0,t[i+4>>2]=0,t[e+152>>2]=1065353216,t[e+116>>2]=0,t[e+120>>2]=0,t[e+144>>2]=0,t[e+148>>2]=0,t[e+112>>2]=1065353216,i=t[r+28>>2],d=C[i+52>>2],g=C[i+8>>2],_=C[i+12>>2],v=C[i+56>>2],m=C[i+28>>2],R=C[i+20>>2],D=C[i+24>>2],c=C[i+60>>2],l=C[i+44>>2],u=C[i+36>>2],w=C[i+40>>2],W=C[i+4>>2],t[f>>2]=0,k=e+168|0,G=c,c=C[r+300>>2],F=B(u*c),u=C[r+304>>2],Z=l,l=C[r+308>>2],C[k>>2]=G+B(B(F+B(w*u))+B(Z*l)),C[n>>2]=v+B(B(B(c*R)+B(u*D))+B(l*m)),C[e+160>>2]=d+B(B(B(c*W)+B(u*g))+B(l*_)),i=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[i>>2]+64>>2]](i,e+112|0,Y),i=t[r+32>>2],d=C[i+52>>2],g=C[i+8>>2],_=C[i+12>>2],v=C[i+56>>2],m=C[i+28>>2],R=C[i+20>>2],D=C[i+24>>2],c=C[i+60>>2],l=C[i+44>>2],u=C[i+36>>2],w=C[i+40>>2],W=C[i+4>>2],t[f>>2]=0,G=c,c=C[r+316>>2],F=B(u*c),u=C[r+320>>2],Z=l,l=C[r+324>>2],C[k>>2]=G+B(B(F+B(w*u))+B(Z*l)),C[n>>2]=v+B(B(B(c*R)+B(u*D))+B(l*m)),C[e+160>>2]=d+B(B(B(c*W)+B(u*g))+B(l*_)),!a)break A;A=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[A>>2]+64>>2]](A,e+112|0,Y);break A;case 0:if(i=t[r+28>>2],T=C[i+52>>2],c=C[i+8>>2],u=C[i+12>>2],D=C[r+584>>2],w=C[r+552>>2],W=C[r+568>>2],U=C[i+56>>2],j=C[i+60>>2],J=C[r+608>>2],Z=C[r+600>>2],M=C[r+604>>2],l=C[i+28>>2],d=C[i+20>>2],g=C[i+24>>2],x=C[r+588>>2],G=C[r+556>>2],F=C[r+572>>2],V=C[r+592>>2],_=C[i+44>>2],S=C[r+560>>2],v=C[i+36>>2],I=C[r+576>>2],m=C[i+40>>2],R=C[i+4>>2],f=e+172|0,t[f>>2]=0,n=e+156|0,t[n>>2]=0,y=e+140|0,t[y>>2]=0,N=e+152|0,C[N>>2]=B(B(S*v)+B(I*m))+B(V*_),p=e+148|0,C[p>>2]=B(B(G*v)+B(F*m))+B(x*_),X=e+136|0,C[X>>2]=B(B(S*d)+B(I*g))+B(V*l),o=e+132|0,C[o>>2]=B(B(G*d)+B(F*g))+B(x*l),s=e+168|0,C[s>>2]=j+B(B(B(v*Z)+B(m*M))+B(_*J)),h=e+164|0,C[h>>2]=U+B(B(B(d*Z)+B(g*M))+B(l*J)),t[e+124>>2]=0,C[e+144>>2]=B(B(w*v)+B(W*m))+B(D*_),C[e+128>>2]=B(B(w*d)+B(W*g))+B(D*l),C[e+120>>2]=B(B(R*S)+B(c*I))+B(u*V),C[e+116>>2]=B(B(R*G)+B(c*F))+B(u*x),C[e+112>>2]=B(B(w*R)+B(W*c))+B(D*u),C[e+160>>2]=T+B(B(B(R*Z)+B(c*M))+B(u*J)),!a)break s;i=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[i>>2]+64>>2]](i,e+112|0,Y),i=t[r+32>>2],T=C[i+52>>2],c=C[i+8>>2],u=C[i+12>>2],U=C[i+56>>2],j=C[i+60>>2],D=C[r+672>>2],w=C[r+664>>2],W=C[r+668>>2],l=C[i+28>>2],d=C[i+20>>2],g=C[i+24>>2],J=C[r+648>>2],Z=C[r+616>>2],M=C[r+632>>2],x=C[r+652>>2],G=C[r+620>>2],F=C[r+636>>2],V=C[r+656>>2],_=C[i+44>>2],S=C[r+624>>2],v=C[i+36>>2],I=C[r+640>>2],m=C[i+40>>2],R=C[i+4>>2],t[f>>2]=0,t[n>>2]=0,t[y>>2]=0,C[N>>2]=B(B(S*v)+B(I*m))+B(V*_),C[p>>2]=B(B(G*v)+B(F*m))+B(x*_),C[e+144>>2]=B(B(Z*v)+B(M*m))+B(J*_),C[X>>2]=B(B(S*d)+B(I*g))+B(V*l),C[o>>2]=B(B(G*d)+B(F*g))+B(x*l),C[s>>2]=j+B(B(B(v*w)+B(m*W))+B(_*D)),C[h>>2]=U+B(B(B(d*w)+B(g*W))+B(l*D)),C[e+160>>2]=T+B(B(B(R*w)+B(c*W))+B(u*D)),t[e+124>>2]=0,C[e+128>>2]=B(B(Z*d)+B(M*g))+B(J*l),C[e+120>>2]=B(B(R*S)+B(c*I))+B(u*V),C[e+116>>2]=B(B(R*G)+B(c*F))+B(u*x),C[e+112>>2]=B(B(Z*R)+B(M*c))+B(J*u),i=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[i>>2]+64>>2]](i,e+112|0,Y);break l;case 3:if(f=r+832|0,n=t[f+4>>2],y=e+120|0,i=y,t[i>>2]=t[f>>2],t[i+4>>2]=n,f=r+848|0,n=t[f+4>>2],i=e+136|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,f=r+864|0,n=t[f+4>>2],i=e+152|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,f=r+880|0,n=t[f+4>>2],i=e+168|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,N=r+824|0,i=N,f=t[i+4>>2],t[e+112>>2]=t[i>>2],t[e+116>>2]=f,i=r+840|0,f=t[i+4>>2],t[e+128>>2]=t[i>>2],t[e+132>>2]=f,i=r+856|0,f=t[i+4>>2],t[e+144>>2]=t[i>>2],t[e+148>>2]=f,i=r+872|0,f=t[i+4>>2],t[e+160>>2]=t[i>>2],t[e+164>>2]=f,i=e+160|0,f=e+144|0,n=e+128|0,!a)break u;if(a=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[a>>2]+64>>2]](a,e+112|0,Y),p=r+944|0,X=t[p+4>>2],a=i+8|0,t[a>>2]=t[p>>2],t[a+4>>2]=X,a=r+936|0,p=t[a+4>>2],t[i>>2]=t[a>>2],t[i+4>>2]=p,i=r+904|0,a=t[i+4>>2],t[n>>2]=t[i>>2],t[n+4>>2]=a,i=n+8|0,n=r+912|0,a=t[n+4>>2],t[i>>2]=t[n>>2],t[i+4>>2]=a,i=r+920|0,n=t[i+4>>2],t[f>>2]=t[i>>2],t[f+4>>2]=n,i=f+8|0,f=r+928|0,n=t[f+4>>2],t[i>>2]=t[f>>2],t[i+4>>2]=n,i=r+896|0,f=t[i+4>>2],t[y>>2]=t[i>>2],t[y+4>>2]=f,i=r+888|0,f=t[i+4>>2],t[e+112>>2]=t[i>>2],t[e+116>>2]=f,i=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[i>>2]+64>>2]](i,e+112|0,Y),k)break c;break A;case 8:if(f=r+1244|0,n=t[f+4>>2],o=e+120|0,i=o,t[i>>2]=t[f>>2],t[i+4>>2]=n,f=r+1260|0,n=t[f+4>>2],i=e+136|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,f=r+1276|0,n=t[f+4>>2],i=e+152|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,f=r+1292|0,n=t[f+4>>2],i=e+168|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,y=r+1236|0,i=y,f=t[i+4>>2],t[e+112>>2]=t[i>>2],t[e+116>>2]=f,N=r+1252|0,i=N,f=t[i+4>>2],t[e+128>>2]=t[i>>2],t[e+132>>2]=f,p=r+1268|0,i=p,f=t[i+4>>2],t[e+144>>2]=t[i>>2],t[e+148>>2]=f,X=r+1284|0,i=X,f=t[i+4>>2],t[e+160>>2]=t[i>>2],t[e+164>>2]=f,i=e+160|0,f=e+144|0,n=e+128|0,!a)break k;if(a=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[a>>2]+64>>2]](a,e+112|0,Y),s=r+1356|0,h=t[s+4>>2],a=i+8|0,t[a>>2]=t[s>>2],t[a+4>>2]=h,a=r+1348|0,s=t[a+4>>2],t[i>>2]=t[a>>2],t[i+4>>2]=s,a=r+1316|0,s=t[a+4>>2],t[n>>2]=t[a>>2],t[n+4>>2]=s,s=r+1324|0,h=t[s+4>>2],a=n+8|0,t[a>>2]=t[s>>2],t[a+4>>2]=h,a=r+1332|0,s=t[a+4>>2],t[f>>2]=t[a>>2],t[f+4>>2]=s,s=r+1340|0,h=t[s+4>>2],a=f+8|0,t[a>>2]=t[s>>2],t[a+4>>2]=h,a=r+1308|0,s=t[a+4>>2],t[o>>2]=t[a>>2],t[o+4>>2]=s,a=r+1300|0,o=t[a+4>>2],t[e+112>>2]=t[a>>2],t[e+116>>2]=o,a=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[a>>2]+64>>2]](a,e+112|0,Y),k)break o;break A;case 4:case 6:case 7:break A;case 1:}if(i=t[r+28>>2],T=C[i+52>>2],c=C[i+8>>2],u=C[i+12>>2],D=C[r+332>>2],w=C[r+300>>2],W=C[r+316>>2],U=C[i+56>>2],j=C[i+60>>2],J=C[r+356>>2],Z=C[r+348>>2],M=C[r+352>>2],l=C[i+28>>2],d=C[i+20>>2],g=C[i+24>>2],x=C[r+336>>2],G=C[r+304>>2],F=C[r+320>>2],V=C[r+340>>2],_=C[i+44>>2],S=C[r+308>>2],v=C[i+36>>2],I=C[r+324>>2],m=C[i+40>>2],R=C[i+4>>2],f=e+172|0,t[f>>2]=0,n=e+156|0,t[n>>2]=0,y=e+140|0,t[y>>2]=0,N=e+152|0,C[N>>2]=B(B(S*v)+B(I*m))+B(V*_),p=e+148|0,C[p>>2]=B(B(G*v)+B(F*m))+B(x*_),X=e+136|0,C[X>>2]=B(B(S*d)+B(I*g))+B(V*l),o=e+132|0,C[o>>2]=B(B(G*d)+B(F*g))+B(x*l),s=e+168|0,C[s>>2]=j+B(B(B(v*Z)+B(m*M))+B(_*J)),h=e+164|0,C[h>>2]=U+B(B(B(d*Z)+B(g*M))+B(l*J)),t[e+124>>2]=0,C[e+144>>2]=B(B(w*v)+B(W*m))+B(D*_),C[e+128>>2]=B(B(w*d)+B(W*g))+B(D*l),C[e+120>>2]=B(B(R*S)+B(c*I))+B(u*V),C[e+116>>2]=B(B(R*G)+B(c*F))+B(u*x),C[e+112>>2]=B(B(w*R)+B(W*c))+B(D*u),C[e+160>>2]=T+B(B(B(R*Z)+B(c*M))+B(u*J)),!a)break b;if(i=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[i>>2]+64>>2]](i,e+112|0,Y),i=t[r+32>>2],T=C[i+52>>2],c=C[i+8>>2],u=C[i+12>>2],U=C[i+56>>2],j=C[i+60>>2],D=C[r+420>>2],w=C[r+412>>2],W=C[r+416>>2],l=C[i+28>>2],d=C[i+20>>2],g=C[i+24>>2],J=C[r+396>>2],Z=C[r+364>>2],M=C[r+380>>2],x=C[r+400>>2],G=C[r+368>>2],F=C[r+384>>2],V=C[r+404>>2],_=C[i+44>>2],S=C[r+372>>2],v=C[i+36>>2],I=C[r+388>>2],m=C[i+40>>2],R=C[i+4>>2],t[f>>2]=0,t[n>>2]=0,t[y>>2]=0,C[N>>2]=B(B(S*v)+B(I*m))+B(V*_),C[p>>2]=B(B(G*v)+B(F*m))+B(x*_),C[e+144>>2]=B(B(Z*v)+B(M*m))+B(J*_),C[X>>2]=B(B(S*d)+B(I*g))+B(V*l),C[o>>2]=B(B(G*d)+B(F*g))+B(x*l),C[s>>2]=j+B(B(B(v*w)+B(m*W))+B(_*D)),C[h>>2]=U+B(B(B(d*w)+B(g*W))+B(l*D)),C[e+160>>2]=T+B(B(B(R*w)+B(c*W))+B(u*D)),t[e+124>>2]=0,C[e+128>>2]=B(B(Z*d)+B(M*g))+B(J*l),C[e+120>>2]=B(B(R*S)+B(c*I))+B(u*V),C[e+116>>2]=B(B(R*G)+B(c*F))+B(u*x),C[e+112>>2]=B(B(Z*R)+B(M*c))+B(J*u),i=0|yf[t[t[A>>2]+20>>2]](A),yf[t[t[i>>2]+64>>2]](i,e+112|0,Y),k)break t;break A;}if(a=r+1136|0,s=t[a+4>>2],t[o>>2]=t[a>>2],t[o+4>>2]=s,a=r+1144|0,o=t[a+4>>2],t[n>>2]=t[a>>2],t[n+4>>2]=o,o=r+1152|0,s=t[o+4>>2],a=n+8|0,t[a>>2]=t[o>>2],t[a+4>>2]=s,a=r+1160|0,o=t[a+4>>2],t[f>>2]=t[a>>2],t[f+4>>2]=o,o=r+1168|0,s=t[o+4>>2],a=f+8|0,t[a>>2]=t[o>>2],t[a+4>>2]=s,a=r+1176|0,o=t[a+4>>2],t[i>>2]=t[a>>2],t[i+4>>2]=o,o=r+1184|0,s=t[o+4>>2],a=i+8|0,t[a>>2]=t[o>>2],t[a+4>>2]=s,a=r+1128|0,o=t[a+4>>2],t[e+112>>2]=t[a>>2],t[e+116>>2]=o,!k)break A;}if(k=t[N+4>>2],t[n>>2]=t[N>>2],t[n+4>>2]=k,k=t[p+4>>2],t[f>>2]=t[p>>2],t[f+4>>2]=k,k=t[X+4>>2],t[i>>2]=t[X>>2],t[i+4>>2]=k,o=y+8|0,s=t[o+4>>2],a=e+120|0,t[a>>2]=t[o>>2],t[a+4>>2]=s,s=N+8|0,h=t[s+4>>2],o=n+8|0,k=o,t[k>>2]=t[s>>2],t[k+4>>2]=h,h=p+8|0,Q=t[h+4>>2],s=f+8|0,k=s,t[k>>2]=t[h>>2],t[k+4>>2]=Q,Q=X+8|0,O=t[Q+4>>2],h=i+8|0,k=h,t[k>>2]=t[Q>>2],t[k+4>>2]=O,k=t[y+4>>2],t[e+112>>2]=t[y>>2],t[e+116>>2]=k,t[e+108>>2]=0,t[e+96>>2]=t[a>>2],t[e+100>>2]=t[e+136>>2],t[e+104>>2]=t[e+152>>2],t[e+92>>2]=0,t[e+80>>2]=t[e+112>>2],t[e+84>>2]=t[e+128>>2],t[e+88>>2]=t[e+144>>2],c=C[r+932>>2],u=C[r+936>>2],l=C[r+996>>2],d=C[r+1e3>>2],Q=0|yf[t[t[A>>2]+20>>2]](A),k=e+72|0,t[k>>2]=0,t[k+4>>2]=0,t[e+64>>2]=0,t[e+68>>2]=0,k=r+1176|0,yf[t[t[Q>>2]+72>>2]](Q,k,e+96|0,e+80|0,B(Y*B(.8999999761581421)),c,u,l,d,e- -64|0,B(10),1),t[e+92>>2]=0,t[e+88>>2]=t[e+148>>2],t[e+84>>2]=t[e+132>>2],t[e+80>>2]=t[e+116>>2],l=Na(r,1),d=Na(r,2),Q=r+1136|0,O=t[Q+4>>2],t[a>>2]=t[Q>>2],t[a+4>>2]=O,a=r+1144|0,Q=t[a+4>>2],t[n>>2]=t[a>>2],t[n+4>>2]=Q,a=r+1152|0,Q=t[a+4>>2],t[o>>2]=t[a>>2],t[o+4>>2]=Q,a=r+1160|0,o=t[a+4>>2],t[f>>2]=t[a>>2],t[f+4>>2]=o,a=r+1168|0,o=t[a+4>>2],t[s>>2]=t[a>>2],t[s+4>>2]=o,a=r+1128|0,o=t[a+4>>2],t[e+112>>2]=t[a>>2],t[e+116>>2]=o,c=ge(d),u=C[e+80>>2],d=_e(d),g=C[e+84>>2],C[e+68>>2]=B(d*g)-B(c*u),_=ge(l),l=_e(l),v=C[e+88>>2],C[e+72>>2]=B(B(u*B(d*_))+B(g*B(_*c)))+B(l*v),C[e+64>>2]=B(B(u*B(l*d))+B(g*B(l*c)))-B(_*v),a=r+1184|0,o=t[a+4>>2],t[h>>2]=t[a>>2],t[h+4>>2]=o,a=t[k+4>>2],t[i>>2]=t[k>>2],t[i+4>>2]=a,t[e+60>>2]=0,C[e+56>>2]=-C[e+144>>2],C[e+52>>2]=-C[e+128>>2],C[e+48>>2]=-C[e+112>>2],c=C[r+868>>2],u=C[r+872>>2],!(c>u))break n;a=0|yf[t[t[A>>2]+20>>2]](A),o=e+40|0,t[o>>2]=0,t[o+4>>2]=0,t[e+32>>2]=0,t[e+36>>2]=0,yf[t[t[a>>2]+68>>2]](a,k,e+48|0,e- -64|0,Y,Y,B(-3.1415927410125732),B(3.1415927410125732),e+32|0,0,B(10));break f;}i=t[r+32>>2],T=C[i+52>>2],U=C[i+56>>2],j=C[i+60>>2],D=C[r+672>>2],w=C[r+664>>2],W=C[r+668>>2],c=C[i+8>>2],u=C[i+12>>2],l=C[i+28>>2],d=C[i+20>>2],g=C[i+24>>2],J=C[r+648>>2],Z=C[r+616>>2],M=C[r+632>>2],x=C[r+652>>2],G=C[r+620>>2],F=C[r+636>>2],V=C[r+656>>2],_=C[i+44>>2],S=C[r+624>>2],v=C[i+36>>2],I=C[r+640>>2],m=C[i+40>>2],R=C[i+4>>2],t[f>>2]=0,t[n>>2]=0,t[y>>2]=0,t[e+124>>2]=0,C[N>>2]=B(B(S*v)+B(I*m))+B(V*_),C[p>>2]=B(B(G*v)+B(F*m))+B(x*_),C[e+144>>2]=B(B(Z*v)+B(M*m))+B(J*_),C[X>>2]=B(B(S*d)+B(I*g))+B(V*l),C[o>>2]=B(B(G*d)+B(F*g))+B(x*l),C[e+128>>2]=B(B(Z*d)+B(M*g))+B(J*l),C[e+120>>2]=B(B(R*S)+B(c*I))+B(u*V),C[s>>2]=j+B(B(B(v*w)+B(m*W))+B(_*D)),C[h>>2]=U+B(B(B(d*w)+B(g*W))+B(l*D)),C[e+160>>2]=T+B(B(B(R*w)+B(c*W))+B(u*D)),C[e+116>>2]=B(B(R*G)+B(c*F))+B(u*x),C[e+112>>2]=B(B(Z*R)+B(M*c))+B(J*u);}if(i=r+688|0,c=function(A){var r=B(0);return r=Wa(B(C[A>>2]-C[A+4>>2])),r<B(-3.1415927410125732)?B(r+B(6.2831854820251465)):r>B(3.1415927410125732)^1?r:B(r+B(-6.2831854820251465));}(i),u=function(A){var r=B(0);return r=Wa(B(C[A>>2]+C[A+4>>2])),r<B(-3.1415927410125732)?B(r+B(6.2831854820251465)):r>B(3.1415927410125732)^1?r:B(r+B(-6.2831854820251465));}(i),!k|c==u)break A;l=C[r+692>>2],t[e+108>>2]=0,t[e+96>>2]=t[e+120>>2],t[e+100>>2]=t[e+136>>2],t[e+104>>2]=t[e+152>>2],t[e+92>>2]=0,t[e+80>>2]=t[e+112>>2],t[e+84>>2]=t[e+128>>2],t[e+88>>2]=t[e+144>>2],A=0|yf[t[t[A>>2]+20>>2]](A),r=e+72|0,t[r>>2]=0,t[r+4>>2]=0,t[e+64>>2]=0,t[e+68>>2]=0,r=l>B(0),yf[t[t[A>>2]+68>>2]](A,e+160|0,e+96|0,e+80|0,Y,Y,r?c:B(0),r?u:B(6.2831854820251465),e- -64|0,r,B(10));break A;}if(a=r+896|0,p=t[a+4>>2],t[y>>2]=t[a>>2],t[y+4>>2]=p,a=r+904|0,y=t[a+4>>2],t[n>>2]=t[a>>2],t[n+4>>2]=y,a=r+912|0,y=t[a+4>>2],n=n+8|0,t[n>>2]=t[a>>2],t[n+4>>2]=y,n=r+920|0,a=t[n+4>>2],t[f>>2]=t[n>>2],t[f+4>>2]=a,n=r+928|0,a=t[n+4>>2],f=f+8|0,t[f>>2]=t[n>>2],t[f+4>>2]=a,f=r+936|0,n=t[f+4>>2],t[i>>2]=t[f>>2],t[i+4>>2]=n,f=r+944|0,n=t[f+4>>2],i=i+8|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,i=r+888|0,f=t[i+4>>2],t[e+112>>2]=t[i>>2],t[e+116>>2]=f,!k)break A;}f=b[r+180|0],i=f?N:r+888|0,c=C[i+48>>2],m=C[i+8>>2],R=C[i+4>>2],n=t[i+4>>2],u=C[i+52>>2],D=C[i+24>>2],l=C[i+16>>2],k=t[i+16>>2],w=C[i+20>>2],a=t[i+20>>2],d=C[i+56>>2],v=C[i+40>>2],g=C[i+32>>2],y=t[i+32>>2],W=C[i+36>>2],N=t[i+36>>2],i=(f?824:888)+r|0,_=C[i>>2],f=t[i>>2],t[e+108>>2]=0,J=B(v*B(0)),W=B(W*B(0)),v=C[r+184>>2],C[e+104>>2]=d+B(J+B(W+B(v*g))),D=B(D*B(0)),w=B(w*B(0)),C[e+100>>2]=u+B(D+B(w+B(v*l))),m=B(m*B(0)),R=B(R*B(0)),C[e+96>>2]=c+B(m+B(R+B(v*_))),t[e+92>>2]=0,G=d,d=C[r+188>>2],C[e+88>>2]=G+B(J+B(W+B(d*g))),C[e+84>>2]=u+B(D+B(w+B(d*l))),C[e+80>>2]=c+B(m+B(R+B(d*_))),i=0|yf[t[t[A>>2]+20>>2]](A),p=e+72|0,t[p>>2]=0,t[p+4>>2]=0,t[e+64>>2]=0,t[e+68>>2]=0,yf[t[t[i>>2]+16>>2]](i,e+96|0,e+80|0,e- -64|0),t[e+76>>2]=0,t[e+72>>2]=y,t[e+68>>2]=k,t[e+64>>2]=f,t[e+60>>2]=0,t[e+56>>2]=N,t[e+52>>2]=a,t[e+48>>2]=n,c=C[r+196>>2],u=C[r+192>>2],A=0|yf[t[t[A>>2]+20>>2]](A),i=e+40|0,t[i>>2]=0,t[i+4>>2]=0,t[e+32>>2]=0,t[e+36>>2]=0,yf[t[t[A>>2]+68>>2]](A,r+936|0,e- -64|0,e+48|0,Y,Y,u,c,e+32|0,1,B(10));break A;}if(a=r+1308|0,s=t[a+4>>2],t[o>>2]=t[a>>2],t[o+4>>2]=s,a=r+1316|0,o=t[a+4>>2],t[n>>2]=t[a>>2],t[n+4>>2]=o,o=r+1324|0,s=t[o+4>>2],a=n+8|0,t[a>>2]=t[o>>2],t[a+4>>2]=s,a=r+1332|0,o=t[a+4>>2],t[f>>2]=t[a>>2],t[f+4>>2]=o,o=r+1340|0,s=t[o+4>>2],a=f+8|0,t[a>>2]=t[o>>2],t[a+4>>2]=s,a=r+1348|0,o=t[a+4>>2],t[i>>2]=t[a>>2],t[i+4>>2]=o,o=r+1356|0,s=t[o+4>>2],a=i+8|0,t[a>>2]=t[o>>2],t[a+4>>2]=s,a=r+1300|0,o=t[a+4>>2],t[e+112>>2]=t[a>>2],t[e+116>>2]=o,!k)break A;}if(k=t[N+4>>2],t[n>>2]=t[N>>2],t[n+4>>2]=k,k=t[p+4>>2],t[f>>2]=t[p>>2],t[f+4>>2]=k,k=t[X+4>>2],t[i>>2]=t[X>>2],t[i+4>>2]=k,o=y+8|0,s=t[o+4>>2],a=e+120|0,t[a>>2]=t[o>>2],t[a+4>>2]=s,s=N+8|0,h=t[s+4>>2],o=n+8|0,t[o>>2]=t[s>>2],t[o+4>>2]=h,h=p+8|0,Q=t[h+4>>2],s=f+8|0,k=s,t[k>>2]=t[h>>2],t[k+4>>2]=Q,Q=X+8|0,O=t[Q+4>>2],h=i+8|0,k=h,t[k>>2]=t[Q>>2],t[k+4>>2]=O,k=t[y+4>>2],t[e+112>>2]=t[y>>2],t[e+116>>2]=k,t[e+108>>2]=0,t[e+96>>2]=t[a>>2],t[e+100>>2]=t[e+136>>2],t[e+104>>2]=t[e+152>>2],t[e+92>>2]=0,t[e+80>>2]=t[e+112>>2],t[e+84>>2]=t[e+128>>2],t[e+88>>2]=t[e+144>>2],c=C[r+1060>>2],u=C[r+1144>>2],l=C[r+1148>>2],d=C[r+1056>>2],Q=0|yf[t[t[A>>2]+20>>2]](A),k=e+72|0,t[k>>2]=0,t[k+4>>2]=0,t[e+64>>2]=0,t[e+68>>2]=0,k=r+1348|0,yf[t[t[Q>>2]+72>>2]](Q,k,e+96|0,e+80|0,B(Y*B(.8999999761581421)),d,c,u,l,e- -64|0,B(10),1),t[e+92>>2]=0,Q=e+148|0,d=C[Q>>2],t[e+88>>2]=t[Q>>2],Q=e+132|0,c=C[Q>>2],t[e+84>>2]=t[Q>>2],u=C[e+116>>2],t[e+80>>2]=t[e+116>>2],g=C[r+1368>>2],_=C[r+1372>>2],Q=r+1308|0,O=t[Q+4>>2],t[a>>2]=t[Q>>2],t[a+4>>2]=O,a=r+1316|0,Q=t[a+4>>2],t[n>>2]=t[a>>2],t[n+4>>2]=Q,a=r+1324|0,Q=t[a+4>>2],t[o>>2]=t[a>>2],t[o+4>>2]=Q,a=r+1332|0,o=t[a+4>>2],t[f>>2]=t[a>>2],t[f+4>>2]=o,a=r+1340|0,o=t[a+4>>2],t[s>>2]=t[a>>2],t[s+4>>2]=o,a=t[k+4>>2],t[i>>2]=t[k>>2],t[i+4>>2]=a,a=r+1356|0,o=t[a+4>>2],t[h>>2]=t[a>>2],t[h+4>>2]=o,l=ge(_),_=_e(_),C[e+68>>2]=B(_*c)-B(l*u),a=r+1300|0,o=t[a+4>>2],t[e+112>>2]=t[a>>2],t[e+116>>2]=o,v=ge(g),g=_e(g),C[e+72>>2]=B(B(B(_*v)*u)+B(B(v*l)*c))+B(g*d),C[e+64>>2]=B(B(B(g*_)*u)+B(B(g*l)*c))-B(v*d),t[e+60>>2]=0,C[e+56>>2]=-C[e+144>>2],C[e+52>>2]=-C[e+128>>2],C[e+48>>2]=-C[e+112>>2],c=C[r+968>>2],u=C[r+972>>2],!(c>u))break a;a=0|yf[t[t[A>>2]+20>>2]](A),o=e+40|0,t[o>>2]=0,t[o+4>>2]=0,t[e+32>>2]=0,t[e+36>>2]=0,yf[t[t[a>>2]+68>>2]](a,k,e+48|0,e- -64|0,Y,Y,B(-3.1415927410125732),B(3.1415927410125732),e+32|0,0,B(10));break i;}if(i=t[r+32>>2],T=C[i+52>>2],U=C[i+56>>2],j=C[i+60>>2],D=C[r+420>>2],w=C[r+412>>2],W=C[r+416>>2],c=C[i+8>>2],u=C[i+12>>2],l=C[i+28>>2],d=C[i+20>>2],g=C[i+24>>2],J=C[r+396>>2],Z=C[r+364>>2],M=C[r+380>>2],x=C[r+400>>2],G=C[r+368>>2],F=C[r+384>>2],V=C[r+404>>2],_=C[i+44>>2],S=C[r+372>>2],v=C[i+36>>2],I=C[r+388>>2],m=C[i+40>>2],R=C[i+4>>2],t[f>>2]=0,t[n>>2]=0,t[y>>2]=0,t[e+124>>2]=0,C[N>>2]=B(B(S*v)+B(I*m))+B(V*_),C[p>>2]=B(B(G*v)+B(F*m))+B(x*_),C[e+144>>2]=B(B(Z*v)+B(M*m))+B(J*_),C[X>>2]=B(B(S*d)+B(I*g))+B(V*l),C[o>>2]=B(B(G*d)+B(F*g))+B(x*l),C[e+128>>2]=B(B(Z*d)+B(M*g))+B(J*l),C[e+120>>2]=B(B(R*S)+B(c*I))+B(u*V),C[s>>2]=j+B(B(B(v*w)+B(m*W))+B(_*D)),C[h>>2]=U+B(B(B(d*w)+B(g*W))+B(l*D)),C[e+160>>2]=T+B(B(B(R*w)+B(c*W))+B(u*D)),C[e+116>>2]=B(B(R*G)+B(c*F))+B(u*x),C[e+112>>2]=B(B(Z*R)+B(M*c))+B(J*u),!k)break A;}for(Fa(e+96|0,r,B(6.0868353843688965),Y),t[e+108>>2]=0,c=C[e+96>>2],y=e+144|0,u=C[e+100>>2],N=e+148|0,l=C[e+104>>2],p=e+152|0,X=e+168|0,C[e+104>>2]=B(B(B(c*C[y>>2])+B(u*C[N>>2]))+B(l*C[p>>2]))+C[X>>2],o=e+128|0,s=e+132|0,h=e+136|0,Q=e+164|0,C[e+100>>2]=B(B(B(c*C[o>>2])+B(u*C[s>>2]))+B(l*C[h>>2]))+C[Q>>2],O=e+120|0,f=e+160|0,C[e+96>>2]=B(B(B(c*C[e+112>>2])+B(u*C[e+116>>2]))+B(l*C[O>>2]))+C[f>>2],L=e+92|0,i=0;Fa(e+80|0,r,B(B(B(0|i)*B(6.283185005187988))*B(.03125)),Y),t[L>>2]=0,n=e+88|0,c=C[n>>2],u=C[e+80>>2],l=C[e+84>>2],C[n>>2]=B(B(B(u*C[y>>2])+B(l*C[N>>2]))+B(c*C[p>>2]))+C[X>>2],C[e+84>>2]=B(B(B(u*C[o>>2])+B(l*C[s>>2]))+B(c*C[h>>2]))+C[Q>>2],C[e+80>>2]=B(B(B(u*C[e+112>>2])+B(l*C[e+116>>2]))+B(c*C[O>>2]))+C[f>>2],k=0|yf[t[t[A>>2]+20>>2]](A),a=e+72|0,t[a>>2]=0,t[a+4>>2]=0,t[e+64>>2]=0,t[e+68>>2]=0,yf[t[t[k>>2]+16>>2]](k,e+96|0,e+80|0,e- -64|0),3&i||(k=0|yf[t[t[A>>2]+20>>2]](A),t[a>>2]=0,t[a+4>>2]=0,t[e+64>>2]=0,t[e+68>>2]=0,yf[t[t[k>>2]+16>>2]](k,f,e+80|0,e- -64|0)),a=t[n+4>>2],k=e+104|0,t[k>>2]=t[n>>2],t[k+4>>2]=a,n=t[e+84>>2],t[e+96>>2]=t[e+80>>2],t[e+100>>2]=n,i=i+1|0,32!=(0|i);){}if(w=C[r+512>>2],W=C[r+452>>2],i=t[r+32>>2],!(C[i+404>>2]>B(0)))break e;c=C[i+36>>2],v=C[r+412>>2],u=C[i+40>>2],m=C[r+416>>2],J=B(B(c*v)+B(u*m)),l=C[i+20>>2],d=C[i+24>>2],g=C[i+28>>2],Z=C[r+420>>2],M=B(B(B(l*v)+B(d*m))+B(g*Z)),_=C[i+4>>2],G=B(_*v),v=C[i+8>>2],G=B(G+B(v*m)),m=C[i+12>>2],x=B(G+B(m*Z)),G=C[r+372>>2],F=C[r+388>>2],V=C[r+404>>2],R=C[i+44>>2],S=B(B(B(G*c)+B(F*u))+B(V*R)),I=C[r+368>>2],T=C[r+384>>2],U=C[r+400>>2],D=B(B(B(I*c)+B(T*u))+B(U*R)),j=C[r+364>>2],H=C[r+380>>2],z=C[r+396>>2],c=B(B(B(j*c)+B(H*u))+B(z*R)),P=B(B(B(G*l)+B(F*d))+B(V*g)),u=B(B(B(I*l)+B(T*d))+B(U*g)),l=B(B(B(j*l)+B(H*d))+B(z*g)),G=B(B(B(_*G)+B(v*F))+B(m*V)),d=B(B(B(_*I)+B(v*T))+B(m*U)),g=B(B(B(j*_)+B(H*v))+B(z*m)),_=B(R*Z);break r;}c<u&&(a=0|yf[t[t[A>>2]+20>>2]](A),o=e+40|0,t[o>>2]=0,t[o+4>>2]=0,t[e+32>>2]=0,t[e+36>>2]=0,yf[t[t[a>>2]+68>>2]](a,k,e+48|0,e- -64|0,Y,Y,c,u,e+32|0,1,B(10)));}k=t[N+4>>2],t[n>>2]=t[N>>2],t[n+4>>2]=k,k=t[p+4>>2],t[f>>2]=t[p>>2],t[f+4>>2]=k,k=t[X+4>>2],t[i>>2]=t[X>>2],t[i+4>>2]=k,a=y+8|0,o=t[a+4>>2],k=e+120|0,t[k>>2]=t[a>>2],t[k+4>>2]=o,k=N+8|0,a=t[k+4>>2],n=n+8|0,t[n>>2]=t[k>>2],t[n+4>>2]=a,n=p+8|0,k=t[n+4>>2],f=f+8|0,t[f>>2]=t[n>>2],t[f+4>>2]=k,f=X+8|0,n=t[f+4>>2],i=i+8|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,i=t[y+4>>2],t[e+112>>2]=t[y>>2],t[e+116>>2]=i,f=r+688|0,n=t[f+4>>2],i=e+40|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,i=r+680|0,f=t[i+4>>2],t[e+32>>2]=t[i>>2],t[e+36>>2]=f,f=r+704|0,n=t[f+4>>2],i=e+24|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,r=r+696|0,i=t[r+4>>2],t[e+16>>2]=t[r>>2],t[e+20>>2]=i,A=0|yf[t[t[A>>2]+20>>2]](A),r=e+8|0,t[r>>2]=0,t[r+4>>2]=0,t[e>>2]=0,t[e+4>>2]=0,yf[t[t[A>>2]+80>>2]](A,e+32|0,e+16|0,e+112|0,e);break A;}c<u&&(a=0|yf[t[t[A>>2]+20>>2]](A),o=e+40|0,t[o>>2]=0,t[o+4>>2]=0,t[e+32>>2]=0,t[e+36>>2]=0,yf[t[t[a>>2]+68>>2]](a,k,e+48|0,e- -64|0,Y,Y,c,u,e+32|0,1,B(10)));}k=t[N+4>>2],t[n>>2]=t[N>>2],t[n+4>>2]=k,k=t[p+4>>2],t[f>>2]=t[p>>2],t[f+4>>2]=k,k=t[X+4>>2],t[i>>2]=t[X>>2],t[i+4>>2]=k,a=y+8|0,o=t[a+4>>2],k=e+120|0,t[k>>2]=t[a>>2],t[k+4>>2]=o,k=N+8|0,a=t[k+4>>2],n=n+8|0,t[n>>2]=t[k>>2],t[n+4>>2]=a,n=p+8|0,k=t[n+4>>2],f=f+8|0,t[f>>2]=t[n>>2],t[f+4>>2]=k,f=X+8|0,n=t[f+4>>2],i=i+8|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,i=t[y+4>>2],t[e+112>>2]=t[y>>2],t[e+116>>2]=i,f=r+688|0,n=t[f+4>>2],i=e+40|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,i=r+680|0,f=t[i+4>>2],t[e+32>>2]=t[i>>2],t[e+36>>2]=f,f=r+704|0,n=t[f+4>>2],i=e+24|0,t[i>>2]=t[f>>2],t[i+4>>2]=n,r=r+696|0,i=t[r+4>>2],t[e+16>>2]=t[r>>2],t[e+20>>2]=i,A=0|yf[t[t[A>>2]+20>>2]](A),r=e+8|0,t[r>>2]=0,t[r+4>>2]=0,t[e>>2]=0,t[e+4>>2]=0,yf[t[t[A>>2]+80>>2]](A,e+32|0,e+16|0,e+112|0,e);break A;}i=t[r+28>>2],c=C[i+36>>2],v=C[r+348>>2],u=C[i+40>>2],m=C[r+352>>2],J=B(B(c*v)+B(u*m)),l=C[i+20>>2],d=C[i+24>>2],g=C[i+28>>2],Z=C[r+356>>2],M=B(B(B(l*v)+B(d*m))+B(g*Z)),_=C[i+4>>2],G=B(_*v),v=C[i+8>>2],G=B(G+B(v*m)),m=C[i+12>>2],x=B(G+B(m*Z)),G=C[r+308>>2],F=C[r+324>>2],V=C[r+340>>2],R=C[i+44>>2],S=B(B(B(G*c)+B(F*u))+B(V*R)),I=C[r+304>>2],T=C[r+320>>2],U=C[r+336>>2],D=B(B(B(I*c)+B(T*u))+B(U*R)),j=C[r+300>>2],H=C[r+316>>2],z=C[r+332>>2],c=B(B(B(j*c)+B(H*u))+B(z*R)),P=B(B(B(G*l)+B(F*d))+B(V*g)),u=B(B(B(I*l)+B(T*d))+B(U*g)),l=B(B(B(j*l)+B(H*d))+B(z*g)),G=B(B(B(_*G)+B(v*F))+B(m*V)),d=B(B(B(_*I)+B(v*T))+B(m*U)),g=B(B(B(j*_)+B(H*v))+B(z*m)),_=B(R*Z);}return t[e+156>>2]=0,C[e+152>>2]=S,C[e+148>>2]=D,C[e+144>>2]=c,t[e+140>>2]=0,C[e+136>>2]=P,C[e+132>>2]=u,C[e+128>>2]=l,t[e+124>>2]=0,C[e+120>>2]=G,v=C[i+52>>2],m=C[i+56>>2],R=C[i+60>>2],t[e+172>>2]=0,C[e+168>>2]=R+B(J+_),C[e+164>>2]=M+m,C[e+160>>2]=v+x,C[e+116>>2]=d,C[e+112>>2]=g,i=f+8|0,n=t[i+4>>2],r=e+88|0,t[r>>2]=t[i>>2],t[r+4>>2]=n,r=t[f+4>>2],t[e+80>>2]=t[f>>2],t[e+84>>2]=r,t[e+76>>2]=0,C[e+72>>2]=c,C[e+68>>2]=l,C[e+64>>2]=g,t[e+60>>2]=0,C[e+56>>2]=D,C[e+52>>2]=u,C[e+48>>2]=d,A=0|yf[t[t[A>>2]+20>>2]](A),r=e+40|0,t[r>>2]=0,t[r+4>>2]=0,t[e+32>>2]=0,t[e+36>>2]=0,yf[t[t[A>>2]+68>>2]](A,e+80|0,e- -64|0,e+48|0,Y,Y,B(B(-w)-W),B(W-w),e+32|0,1,B(10)),void(E=e+176|0);}E=e+176|0;},function(A){A|=0;var r,e=0,i=0,a=0,f=0,n=0;r=A+248|0,e=t[r>>2];A:if(!((0|e)<1))for(n=A+256|0,A=0;;){if(a=t[t[n>>2]+i>>2],f=t[a+220>>2],5==(0|f)||2==(0|f)){if(i=i+4|0,A=A+1|0,(0|A)<(0|e))continue;break A;}if(Oi(a),i=i+4|0,A=A+1|0,e=t[r>>2],!((0|A)<(0|e)))break;}},he,function(A,r){A|=0,r=B(r);var e,i,a=0,f=0,n=0,b=0;if(e=E-16|0,E=e,$e(e+8|0,22852),i=A+296|0,t[i>>2]>=1)for(b=A+304|0;f=t[t[b>>2]+a>>2],yf[t[t[f>>2]+8>>2]](f,A,r),a=a+4|0,n=n+1|0,(0|n)<t[i>>2];){}Ai(),E=e+16|0;},function(A){A|=0;var r=0,e=0;return t[A>>2]=23228,r=A+80|0,e=t[r>>2],e&&(b[A+84|0]&&gA(e),t[A+80>>2]=0),t[r>>2]=0,a[A+84|0]=1,r=A+72|0,t[r>>2]=0,t[r+4>>2]=0,r=A+60|0,e=t[r>>2],e&&(b[A- -64|0]&&gA(e),t[A+60>>2]=0),t[r>>2]=0,a[A- -64|0]=1,r=A+52|0,t[r>>2]=0,t[r+4>>2]=0,r=A+40|0,e=t[r>>2],e&&(b[A+44|0]&&gA(e),t[A+40>>2]=0),t[r>>2]=0,a[A+44|0]=1,r=A+32|0,t[r>>2]=0,t[r+4>>2]=0,0|A;},function(A){A|=0;var r=0,e=0;t[A>>2]=23228,r=A+80|0,e=t[r>>2],e&&(b[A+84|0]&&gA(e),t[A+80>>2]=0),t[r>>2]=0,a[A+84|0]=1,r=A+72|0,t[r>>2]=0,t[r+4>>2]=0,r=A+60|0,e=t[r>>2],e&&(b[A- -64|0]&&gA(e),t[A+60>>2]=0),t[r>>2]=0,a[A- -64|0]=1,r=A+52|0,t[r>>2]=0,t[r+4>>2]=0,r=t[A+40>>2],!r|!b[A+44|0]||gA(r),rA(A);},function(A,r,e,i,f,n){A|=0,r|=0,e|=0,i|=0,f|=0,n|=0;var o=0,k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0,g=0,_=0,m=0,R=0,G=0,h=0,y=0,Q=0,p=0,D=0,w=0,W=0,F=0,Z=0,Y=0,E=0,N=0,V=0,I=0,J=0,X=0,M=0,x=0,S=0,T=0,U=0,j=0,O=0,H=0,z=0,P=0,L=0,K=0;A:{if((0|n)>=0){c=t[A+16>>2];r:{if((0|c)>=1)for(R=t[A+12>>2];;){if(l=t[R>>2],o=t[t[l+28>>2]+208>>2],(0|o)<=-1&&(o=t[t[l+32>>2]+208>>2]),(0|o)==(0|n))break r;if(R=R+4|0,k=k+1|0,!((0|k)<(0|c)))break;}R=0;}if((0|k)<(0|c))for(c=c-k|0,o=t[A+12>>2]+(k<<2)|0;l=t[o>>2],k=t[t[l+28>>2]+208>>2],(0|k)<=-1&&(k=t[t[l+32>>2]+208>>2]),o=o+4|0,p=((0|n)==(0|k))+p|0,c=c+-1|0,c;){}if(k=t[A+4>>2],t[k+80>>2]>=2)break A;return n=t[A+8>>2],void B(yf[t[t[n>>2]+12>>2]](n,r,e,i,f,R,p,k,t[A+20>>2],t[A+24>>2]));}return n=t[A+8>>2],void B(yf[t[t[n>>2]+12>>2]](n,r,e,i,f,t[A+12>>2],t[A+16>>2],t[A+4>>2],t[A+20>>2],t[A+24>>2]));}for((0|e)>=1?(I=A+36|0,s=t[I>>2],D=A+32|0,d=t[D>>2],Y=2,G=A+40|0,T=4,U=-1,J=A+44|0,j=16,o=1):o=0;;){A:{r:{e:{i:{a:{f:{n:{t:{b:{o:{k:{c:{if(!o){if((0|f)<1)break c;X=A+56|0,v=t[X>>2],w=A+52|0,C=t[w>>2],E=2,_=1,h=A+60|0,O=4,H=-1,M=A- -64|0,z=16,W=0,y=1;break i;}u:switch(0|y){case 0:l=(N<<Y)+r|0;l:{s:{d:{v:{C:{if((0|s)==(0|d)){if(d=s?s<<1:1,(0|s)>=(0|d))break C;if(!d)break v;if(c=CA(d<<Y,j),n=t[D>>2],(0|n)>=1)break d;break s;}n=d;break l;}n=s;break l;}if(c=0,n=s,(0|n)<1)break s;}for(o=0,k=n;t[o+c>>2]=t[t[G>>2]+o>>2],o=o+T|0,k=k+U|0,k;){}}s=t[G>>2],s&&(b[0|J]&&(gA(s),n=t[D>>2]),t[G>>2]=0),t[G>>2]=c,a[0|J]=1,t[I>>2]=d,s=d;}if(d=n+1|0,t[D>>2]=d,t[t[G>>2]+(n<<Y)>>2]=t[l>>2],N=N+1|0,(0|N)!=(0|e))break t;o=0;continue;case 1:break u;default:break k;}l=(W<<E)+i|0;u:{l:{s:{d:{v:{if((0|v)==(0|C)){if(C=v?v<<_:_,(0|v)>=(0|C))break v;if(!C)break d;if(c=CA(C<<E,z),n=t[w>>2],(0|n)>=(0|_))break s;break l;}n=C;break u;}n=v;break u;}if(c=0,n=v,(0|n)<(0|_))break l;}for(o=0,k=n;t[o+c>>2]=t[t[h>>2]+o>>2],o=o+O|0,k=k+H|0,k;){}}v=t[h>>2],v&&(b[0|M]&&(gA(v),n=t[w>>2]),t[h>>2]=0),t[h>>2]=c,a[0|M]=_,t[X>>2]=C,v=C;}if(C=n+_|0,t[w>>2]=C,t[t[h>>2]+(n<<E)>>2]=t[l>>2],W=_+W|0,(0|W)!=(0|f))break n;}if(!p)break o;x=A+76|0,g=t[x>>2],F=A+72|0,u=t[F>>2],V=2,m=1,Q=A+80|0,P=4,L=-1,S=A+84|0,K=16,Z=0,y=2;break r;}l=(Z<<V)+R|0;k:{c:{u:{l:{s:{if((0|u)==(0|g)){if(u=g?g<<m:m,(0|g)>=(0|u))break s;if(!u)break l;if(c=CA(u<<V,K),n=t[F>>2],(0|n)>=(0|m))break u;break c;}n=u;break k;}n=g;break k;}if(c=0,n=g,(0|n)<(0|m))break c;}for(o=0,k=n;t[o+c>>2]=t[t[Q>>2]+o>>2],o=o+P|0,k=k+L|0,k;){}}g=t[Q>>2],g&&(b[0|S]&&(gA(g),n=t[F>>2]),t[Q>>2]=0),t[Q>>2]=c,a[0|S]=m,t[x>>2]=u,g=u;}if(u=n+m|0,t[F>>2]=u,t[t[Q>>2]+(n<<V)>>2]=t[l>>2],Z=m+Z|0,(0|Z)!=(0|p))break f;break b;}u=t[A+72>>2];}return void((t[A+52>>2]+u|0)>t[t[A+4>>2]+80>>2]&&xa(A));}y=0;break a;}y=1;break e;}y=2;break A;}o=1;continue;}o=1;continue;}o=1;continue;}o=1;continue;}o=1;}},Cr,function(A,r){A|=0,r|=0;var e,i,a=0;return e=t[r>>2],i=t[A+84>>2],!(t[r+8>>2]&t[A+8>>2])|!(t[A+12>>2]&t[r+4>>2])|(0|e)==(0|i)||(A=t[A+96>>2],a=0|yf[t[t[A>>2]+28>>2]](A,i,e)),0|a;},function(A,r,e){A|=0,r|=0,e|=0;var i=0,a=B(0),f=B(0),n=B(0),o=0,k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0);return a=B(1),i=t[r>>2],(0|i)==t[A+84>>2]|4&b[i+204|0]|B(B(B(B(C[A+32>>2]-C[A+16>>2])*C[r+8>>2])+B(B(C[A+36>>2]-C[A+20>>2])*C[r+12>>2]))+B(B(C[A+40>>2]-C[A+24>>2])*C[r+16>>2]))>=B(-C[A+88>>2])||(t[A+80>>2]=i,t[A+4>>2]=t[r+40>>2],e?(e=r+8|0,i=t[e+4>>2],t[A+48>>2]=t[e>>2],t[A+52>>2]=i,e=e+8|0,o=t[e+4>>2],i=A+56|0,t[i>>2]=t[e>>2],t[i+4>>2]=o):(k=C[i+8>>2],c=C[i+12>>2],u=C[i+20>>2],l=C[i+24>>2],s=C[i+28>>2],d=C[i+36>>2],v=C[i+40>>2],a=C[r+12>>2],g=C[i+44>>2],f=C[r+16>>2],_=C[i+4>>2],n=C[r+8>>2],t[A+60>>2]=0,C[A+56>>2]=B(B(n*d)+B(a*v))+B(f*g),C[A+52>>2]=B(B(n*u)+B(a*l))+B(f*s),C[A+48>>2]=B(B(_*n)+B(k*a))+B(c*f)),e=t[r+28>>2],t[A+64>>2]=t[r+24>>2],t[A+68>>2]=e,e=r+32|0,i=t[e+4>>2],A=A+72|0,t[A>>2]=t[e>>2],t[A+4>>2]=i,a=C[r+40>>2]),B(a);},function(A){A|=0;var r,e=0;return t[A>>2]=23420,e=A+336|0,r=t[e>>2],r&&(b[A+340|0]&&gA(r),t[A+336>>2]=0),t[e>>2]=0,a[A+340|0]=1,e=A+328|0,t[e>>2]=0,t[e+4>>2]=0,Nr(A),0|A;},function(A){A|=0;var r,e=0;t[A>>2]=23420,e=A+336|0,r=t[e>>2],r&&(b[A+340|0]&&gA(r),t[A+336>>2]=0),t[e>>2]=0,a[A+340|0]=1,e=A+328|0,t[e>>2]=0,t[e+4>>2]=0,Nr(A),gA(A);},function(A,r,e){A|=0,r|=0,e|=0;var i,f=0,n=0,o=0,k=0;i=t[r>>2],e=t[A+328>>2];A:{r:if(!((0|e)<1)){for(r=t[A+336>>2];;){if((0|i)!=t[r>>2]){if(r=r+4|0,f=f+1|0,(0|f)<(0|e))continue;break r;}break;}if((0|e)!=(0|f))break A;}if(t[A+332>>2]==(0|e)&&(n=e?e<<1:1,!((0|e)>=(0|n)))){r:{e:{if(n){if(o=CA(n<<2,16),e=t[A+328>>2],(0|e)>=1)break e;break r;}if((0|e)<1)break r;}for(r=0,k=A+336|0,f=e;t[r+o>>2]=t[t[k>>2]+r>>2],r=r+4|0,f=f+-1|0,f;){}}r=A+336|0,f=t[r>>2],f&&(b[A+340|0]&&(gA(f),e=t[A+328>>2]),t[A+336>>2]=0),t[r>>2]=o,a[A+340|0]=1,t[A+332>>2]=n;}t[A+328>>2]=e+1,t[t[A+336>>2]+(e<<2)>>2]=i;}},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a=0,f=0;e=t[A+328>>2];A:if(!((0|e)<1)){for(f=t[r>>2],i=0,a=t[A+336>>2],r=a;;){if((0|f)!=t[r>>2]){if(r=r+4|0,i=i+1|0,(0|i)<(0|e))continue;break A;}break;}(0|i)>=(0|e)||(i=A+328|0,A=e+-1|0,t[i>>2]=A,t[r>>2]=t[(A<<2)+a>>2]);}},function(A){A|=0;var r,e=0;return t[A>>2]=23464,e=t[A+344>>2],yf[t[t[e>>2]>>2]](e),gA(t[A+344>>2]),t[A>>2]=23420,e=A+336|0,r=t[e>>2],r&&(b[A+340|0]&&gA(r),t[A+336>>2]=0),t[e>>2]=0,a[A+340|0]=1,e=A+328|0,t[e>>2]=0,t[e+4>>2]=0,Nr(A),0|A;},function(A){A|=0;var r,e=0;t[A>>2]=23464,e=t[A+344>>2],yf[t[t[e>>2]>>2]](e),gA(t[A+344>>2]),t[A>>2]=23420,e=A+336|0,r=t[e>>2],r&&(b[A+340|0]&&gA(r),t[A+336>>2]=0),t[e>>2]=0,a[A+340|0]=1,e=A+328|0,t[e>>2]=0,t[e+4>>2]=0,Nr(A),gA(A);},function(A,r,e){A|=0,r|=0,e|=0;var i,f=0,n=0,o=0,k=0,c=0,u=0;e=e||t[A+188>>2],i=t[r>>2],f=t[A+328>>2];A:{r:if(!((0|f)<1)){for(o=t[A+336>>2];;){if((0|i)!=t[o>>2]){if(o=o+4|0,n=n+1|0,(0|n)<(0|f))continue;break r;}break;}if((0|f)!=(0|n))break A;}if(t[A+332>>2]==(0|f)&&(k=f?f<<1:1,!((0|f)>=(0|k)))){r:{e:{if(k){if(u=CA(k<<2,16),f=t[A+328>>2],(0|f)>=1)break e;break r;}if((0|f)<1)break r;}for(o=0,c=A+336|0,n=f;t[o+u>>2]=t[t[c>>2]+o>>2],o=o+4|0,n=n+-1|0,n;){}}c=A+336|0,n=t[c>>2],n&&(b[A+340|0]&&(gA(n),f=t[A+328>>2]),t[A+336>>2]=0),t[c>>2]=u,a[A+340|0]=1,t[A+332>>2]=k;}t[t[A+336>>2]+(f<<2)>>2]=i,t[A+328>>2]=f+1,A=t[A+344>>2],yf[t[t[A>>2]+8>>2]](A,e,r);}},function(A,r,e,i){A|=0,r|=0,e|=0,i|=0;var a,f,n=0,b=0,o=0;f=t[r>>2],i=i||t[A+188>>2],a=t[A+328>>2];A:if(!((0|a)<1)){for(o=t[A+336>>2],n=o;;){if((0|f)!=t[n>>2]){if(n=n+4|0,b=b+1|0,(0|b)<(0|a))continue;break A;}break;}(0|b)>=(0|a)||(b=n,n=a+-1|0,t[b>>2]=t[(n<<2)+o>>2],t[A+328>>2]=n,A=t[A+344>>2],yf[t[t[A>>2]+12>>2]](A,i,r,e));}},function(A){A|=0;var r,e=0;return t[A>>2]=23576,e=A+212|0,r=t[e>>2],r&&(b[A+216|0]&&gA(r),t[A+212>>2]=0),t[e>>2]=0,a[A+216|0]=1,e=A+204|0,t[e>>2]=0,t[e+4>>2]=0,0|A;},function(A){A|=0;var r,e=0;t[A>>2]=23576,e=A+212|0,r=t[e>>2],r&&(b[A+216|0]&&gA(r),t[A+212>>2]=0),t[e>>2]=0,a[A+216|0]=1,e=A+204|0,t[e>>2]=0,t[e+4>>2]=0,gA(A);},function(A,r,e){A|=0,r|=0,e=B(e),yf[t[t[A>>2]+32>>2]](A,r),yf[t[t[A>>2]+36>>2]](A,r,e);},he,function(A,r){A|=0,r|=0;var e,i=B(0),f=B(0),n=B(0),b=0,o=B(0),k=B(0);a[A+251|0]=1,b=t[r+4>>2],t[A+68>>2]=t[r>>2],t[A+72>>2]=b,r=r+8|0,e=t[r+4>>2],b=A+76|0,t[b>>2]=t[r>>2],t[b+4>>2]=e,f=C[A+68>>2],n=C[A+72>>2],i=C[b>>2],o=B(Q(B(B(B(f*f)+B(n*n))+B(i*i)))),o>B(1.1920928955078125e-7)?(k=i,i=B(B(1)/o),o=B(k*i),n=B(n*i),f=B(f*i),r=t[A+80>>2]):(o=B(0),n=B(0),f=B(0),r=0),C[A+84>>2]=f,t[A+96>>2]=r,C[A+92>>2]=o,C[A+88>>2]=n;},function(A,r,e){A|=0,r|=0,e=B(e);var i,f=0,n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=0;a[A+251|0]=0,f=t[r+4>>2],t[A+68>>2]=t[r>>2],t[A+72>>2]=f,r=r+8|0,i=t[r+4>>2],f=A+76|0,t[f>>2]=t[r>>2],t[f+4>>2]=i,b=C[A+68>>2],o=C[A+72>>2],k=C[f>>2],c=B(Q(B(B(B(b*b)+B(o*o))+B(k*k)))),c>B(1.1920928955078125e-7)&&(n=B(B(1)/c),u=B(k*n),l=B(o*n),n=B(b*n),s=t[A+80>>2]),C[A+84>>2]=n,t[A+96>>2]=s,C[A+92>>2]=u,C[A+88>>2]=l,C[A+252>>2]=C[A+252>>2]+e;},function(A,r){A|=0,r|=0;var e,i=0,a=0,n=0,b=0,o=0;if(t[A+68>>2]=0,t[A+72>>2]=0,f[A+248>>1]=0,t[A+20>>2]=0,t[A+24>>2]=0,e=A+76|0,t[e>>2]=0,t[e+4>>2]=0,t[A+252>>2]=0,A=t[t[A+8>>2]+344>>2],t[4+(0|yf[t[t[A>>2]+28>>2]](A))>>2]>=1)for(r=r+24|0;a=A,n=t[t[12+(0|yf[t[t[A>>2]+28>>2]](A))>>2]>>2],b=t[t[12+(0|yf[t[t[A>>2]+28>>2]](A))>>2]+4>>2],o=t[r>>2],i=t[t[A>>2]+12>>2],yf[i](0|a,0|n,0|b,0|o),t[4+(0|yf[t[t[A>>2]+28>>2]](A))>>2]>0;){}},function(A,r){A|=0,r|=0;var e,i,a=0,f=0,n=0;a=r+8|0,f=t[a>>2],n=t[a+4>>2],e=t[r>>2],i=t[r+4>>2],A=t[A+8>>2],t[A+4>>2]=1065353216,r=A+16|0,t[r>>2]=0,t[r+4>>2]=0,r=A+8|0,t[r>>2]=0,t[r+4>>2]=0,t[A+24>>2]=1065353216,r=A+36|0,t[r>>2]=0,t[r+4>>2]=0,r=A+28|0,t[r>>2]=0,t[r+4>>2]=0,r=A+44|0,t[r>>2]=1065353216,t[r+4>>2]=0,r=E-32|0,a=r+24|0,t[a>>2]=f,t[a+4>>2]=n,t[A+304>>2]=t[A+304>>2]+1,t[r+12>>2]=0,t[r+16>>2]=e,t[r+20>>2]=i,n=t[a+4>>2],f=A+60|0,t[f>>2]=t[a>>2],t[f+4>>2]=n,a=t[r+20>>2],A=A+52|0,t[A>>2]=t[r+16>>2],t[A+4>>2]=a;},function(A,r){A|=0,r|=0;var e,i=0,a=0,f=0,n=0,b=0;r=E-16|0,E=r,f=t[A+8>>2],a=f+60|0,b=t[a+4>>2],i=A+140|0,t[i>>2]=t[a>>2],t[i+4>>2]=b,i=f+52|0,n=t[i+4>>2],t[A+132>>2]=t[i>>2],t[A+136>>2]=n,n=t[i>>2],i=t[i+4>>2],e=t[a+4>>2],b=A+160|0,t[b>>2]=t[a>>2],t[b+4>>2]=e,t[A+152>>2]=n,t[A+156>>2]=i,tf(f+4|0,r),a=r+8|0,n=t[a+4>>2],i=A+176|0,t[i>>2]=t[a>>2],t[i+4>>2]=n,f=t[r+4>>2],t[A+168>>2]=t[r>>2],t[A+172>>2]=f,a=t[i+4>>2],f=A+192|0,t[f>>2]=t[i>>2],t[f+4>>2]=a,i=t[A+172>>2],t[A+184>>2]=t[A+168>>2],t[A+188>>2]=i,E=r+16|0;},function(A,r,e){A|=0,r|=0,e=B(e);var i,f=0,n=0,o=0,k=B(0),c=0,u=B(0),l=B(0),s=B(0),d=0,v=0,g=0,_=B(0),R=B(0),G=B(0),h=B(0),y=B(0),p=B(0),D=0,w=B(0),W=0,F=0,Z=0,Y=0,N=0,V=0,I=0,J=0,X=0,M=0;i=E-80|0,E=i;A:{r:{e:{i:{k=C[A+100>>2],f=A+104|0,u=C[f>>2],o=A+108|0,s=C[o>>2],l=B(B(B(k*k)+B(u*u))+B(s*s));a:{if(!(l>B(0))){if(l>B(0))break a;break i;}if(l=Ii(B(B(1)-C[A+244>>2]),e),s=B(s*l),C[o>>2]=s,u=B(u*l),C[f>>2]=u,k=B(k*l),C[A+100>>2]=k,l=B(B(B(k*k)+B(u*u))+B(s*s)),!(l>B(0)))break i;}if(f=t[A+8>>2],o=f+20|0,v=t[o>>2],g=t[o+4>>2],o=f+12|0,D=t[o>>2],Z=t[o+4>>2],o=f+28|0,c=t[o>>2],Y=t[o+4>>2],N=t[f+4>>2],V=t[f+8>>2],d=f+44|0,W=t[d+4>>2],o=i+56|0,n=o,t[n>>2]=t[d>>2],t[n+4>>2]=W,n=f+36|0,W=t[n>>2],I=t[n+4>>2],F=f+60|0,J=t[F+4>>2],d=i+72|0,n=d,t[n>>2]=t[F>>2],t[n+4>>2]=J,n=i+40|0,t[n>>2]=c,t[n+4>>2]=Y,c=i+24|0,t[c>>2]=D,t[c+4>>2]=Z,f=f+52|0,D=t[f+4>>2],t[i+64>>2]=t[f>>2],t[i+68>>2]=D,t[i+48>>2]=W,t[i+52>>2]=I,t[i+32>>2]=v,t[i+36>>2]=g,t[i+16>>2]=N,t[i+20>>2]=V,_=B(Q(l)),R=B(B(_*e)*B(.5)),y=ge(R),tf(i+16|0,i),l=C[i+12>>2],p=C[i>>2],R=_e(R),G=k,k=B(B(1)/_),_=B(G*k),h=B(s*k),k=B(u*k),u=B(y/B(Q(B(B(h*h)+B(B(_*_)+B(k*k)))))),s=B(_*u),_=B(k*u),y=C[i+8>>2],h=B(h*u),G=C[i+4>>2],k=B(B(B(B(p*R)+B(l*s))+B(_*y))-B(h*G)),u=B(B(B(B(R*l)-B(s*p))-B(_*G))-B(h*y)),w=B(B(B(B(h*l)+B(R*y))+B(s*G))-B(_*p)),s=B(B(B(h*p)+B(B(_*l)+B(R*G)))-B(s*y)),l=B(B(2)/B(B(u*u)+B(B(w*w)+B(B(k*k)+B(s*s))))),p=B(w*l),_=B(k*p),R=B(s*l),y=B(u*R),C[c>>2]=_+y,t[i+60>>2]=0,t[i+44>>2]=0,h=B(s*p),l=B(k*l),G=B(u*l),C[i+52>>2]=h+G,C[n>>2]=h-G,l=B(k*l),s=B(s*R),C[o>>2]=B(1)-B(l+s),G=l,l=B(w*p),C[i+36>>2]=B(1)-B(G+l),t[i+28>>2]=0,C[i+48>>2]=_-y,k=B(k*R),u=B(u*p),C[i+32>>2]=k+u,C[i+20>>2]=k-u,g=t[c+4>>2],f=t[A+8>>2],v=f+12|0,t[v>>2]=t[c>>2],t[v+4>>2]=g,C[i+16>>2]=B(1)-B(s+l),c=t[i+20>>2],t[f+4>>2]=t[i+16>>2],t[f+8>>2]=c,v=t[n+4>>2],c=f+28|0,t[c>>2]=t[n>>2],t[c+4>>2]=v,c=t[i+36>>2],n=f+20|0,t[n>>2]=t[i+32>>2],t[n+4>>2]=c,t[f+304>>2]=t[f+304>>2]+1,c=t[i+52>>2],n=f+36|0,t[n>>2]=t[i+48>>2],t[n+4>>2]=c,c=t[o+4>>2],n=f+44|0,t[n>>2]=t[o>>2],t[n+4>>2]=c,n=t[d+4>>2],o=f+60|0,t[o>>2]=t[d>>2],t[o+4>>2]=n,o=t[i+68>>2],f=f+52|0,t[f>>2]=t[i+64>>2],t[f+4>>2]=o,f=t[A+8>>2],o=f+60|0,d=t[o+4>>2],n=A+140|0,t[n>>2]=t[o>>2],t[n+4>>2]=d,n=f+52|0,d=t[n+4>>2],t[A+132>>2]=t[n>>2],t[A+136>>2]=d,c=t[o>>2],o=t[o+4>>2],d=t[n+4>>2],t[A+152>>2]=t[n>>2],t[A+156>>2]=d,n=A+160|0,t[n>>2]=c,t[n+4>>2]=o,tf(f+4|0,i),n=i+8|0,c=t[n+4>>2],f=A+176|0,t[f>>2]=t[n>>2],t[f+4>>2]=c,o=t[i+4>>2],t[A+168>>2]=t[i>>2],t[A+172>>2]=o,n=t[f+4>>2],o=A+192|0,t[o>>2]=t[f>>2],t[o+4>>2]=n,f=t[A+172>>2],t[A+184>>2]=t[A+168>>2],t[A+188>>2]=f,!b[A+251|0])break e;break r;}if(b[A+251|0])break r;}if(C[A+252>>2]<=B(0))break A;}X=A,M=0|yf[t[t[A>>2]+48>>2]](A),a[X+248|0]=M,f=A+72|0,u=C[f>>2],s=C[A+68>>2],n=A+76|0,l=C[n>>2],o=A+68|0,k=Ii(B(B(1)-C[A+240>>2]),e),B(B(B(s*s)+B(u*u))+B(l*l))>B(0)&&(C[n>>2]=l*k,C[f>>2]=u*k,C[o>>2]=s*k),k=B(B(C[A+20>>2]*k)-B(C[A+52>>2]*e)),C[A+20>>2]=k,k>B(0)&&(u=C[A+32>>2],k>u&&(C[A+20>>2]=u,k=u)),k<B(0)&&(u=B(m(C[A+28>>2])),B(m(k))>u&&(k=B(-u),C[A+20>>2]=k)),C[A+24>>2]=k*e,f=t[A+8>>2],c=f+12|0,d=t[c+4>>2],n=i+24|0,t[n>>2]=t[c>>2],t[n+4>>2]=d,c=f+28|0,d=t[c+4>>2],n=i+40|0,t[n>>2]=t[c>>2],t[n+4>>2]=d,c=f+44|0,d=t[c+4>>2],n=i+56|0,t[n>>2]=t[c>>2],t[n+4>>2]=d,c=f+60|0,d=t[c+4>>2],n=i+72|0,t[n>>2]=t[c>>2],t[n+4>>2]=d,n=t[f+8>>2],t[i+16>>2]=t[f+4>>2],t[i+20>>2]=n,n=f+20|0,c=t[n+4>>2],t[i+32>>2]=t[n>>2],t[i+36>>2]=c,n=f+36|0,c=t[n+4>>2],t[i+48>>2]=t[n>>2],t[i+52>>2]=c,f=f+52|0,n=t[f+4>>2],t[i+64>>2]=t[f>>2],t[i+68>>2]=n,function(A,r){var e,i=0,f=0,n=B(0),o=0,k=0,c=B(0),u=0,l=B(0),s=B(0),d=B(0),v=0,g=B(0),_=B(0),m=B(0),R=0,G=0,h=0,y=B(0),Q=B(0),p=0,D=0,w=B(0),W=B(0),F=B(0);e=E-240|0,E=e,_=C[A+20>>2]<B(0)^1?_:C[A+60>>2],o=e+196|0,t[o>>2]=1065353216,R=e+200|0,f=R,t[f>>2]=0,t[f+4>>2]=0,p=e+216|0,f=p,t[f>>2]=1065353216,t[f+4>>2]=0,D=e+132|0,t[D>>2]=1065353216,h=e+136|0,f=h,t[f>>2]=0,t[f+4>>2]=0,k=e+152|0,f=k,t[f>>2]=1065353216,t[f+4>>2]=0,f=A+140|0,u=t[f+4>>2],i=e+232|0,t[i>>2]=t[f>>2],t[i+4>>2]=u,t[e+188>>2]=0,t[e+192>>2]=0,t[e+180>>2]=0,t[e+184>>2]=0,t[e+176>>2]=1065353216,t[e+208>>2]=0,t[e+212>>2]=0,t[e+112>>2]=1065353216,t[e+124>>2]=0,t[e+128>>2]=0,t[e+116>>2]=0,t[e+120>>2]=0,t[e+144>>2]=0,t[e+148>>2]=0,i=t[A+136>>2],t[e+224>>2]=t[A+132>>2],t[e+228>>2]=i,w=C[A+260>>2],n=C[A+24>>2],n=n>B(0)?n:B(0),C[A+156>>2]=B(B(_*w)+C[A+136>>2])+B(n*C[A+276>>2]),W=C[A+256>>2],C[A+152>>2]=B(B(_*W)+C[A+132>>2])+B(C[A+272>>2]*n),t[A+164>>2]=0,i=A+160|0,F=C[A+264>>2],C[i>>2]=B(B(_*F)+C[f>>2])+B(n*C[A+280>>2]),v=t[i+4>>2],i=t[i>>2],t[f>>2]=i,t[f+4>>2]=v,f=t[A+156>>2],u=t[A+152>>2],t[A+132>>2]=u,t[A+136>>2]=f,G=e+168|0,t[G>>2]=i,t[G+4>>2]=v,t[e+160>>2]=u,t[e+164>>2]=f,l=C[A+180>>2],d=C[A+176>>2],c=C[A+172>>2],n=C[A+168>>2],t[e+220>>2]=0,t[e+204>>2]=0,g=B(B(2)/B(B(B(B(n*n)+B(c*c))+B(d*d))+B(l*l))),y=B(d*g),s=B(c*y),m=B(n*g),Q=B(l*m),C[e+212>>2]=s+Q,C[R>>2]=s-Q,s=B(n*m),Q=c,c=B(c*g),g=B(Q*c),C[p>>2]=B(1)-B(s+g),d=B(d*y),C[o>>2]=B(1)-B(s+d),t[e+188>>2]=0,s=B(n*y),m=B(l*c),C[e+208>>2]=s-m,n=B(n*c),l=B(l*y),C[e+192>>2]=n+l,C[e+184>>2]=s+m,C[e+180>>2]=n-l,C[e+176>>2]=B(1)-B(g+d),l=C[A+196>>2],d=C[A+192>>2],c=C[A+188>>2],n=C[A+184>>2],t[e+156>>2]=0,t[e+140>>2]=0,g=B(B(2)/B(B(B(B(n*n)+B(c*c))+B(d*d))+B(l*l))),y=B(d*g),s=B(c*y),m=B(n*g),Q=B(l*m),C[e+148>>2]=s+Q,C[h>>2]=s-Q,s=B(n*m),Q=c,c=B(c*g),g=B(Q*c),C[k>>2]=B(1)-B(s+g),d=B(d*y),C[D>>2]=B(1)-B(s+d),t[e+124>>2]=0,s=B(n*y),m=B(l*c),C[e+144>>2]=s-m,n=B(n*c),l=B(l*y),C[e+128>>2]=n+l,C[e+120>>2]=s+m,C[e+116>>2]=n-l,C[e+112>>2]=B(1)-B(g+d),f=e+40|0,t[f>>2]=0,t[f+4>>2]=0,f=e+32|0,t[f>>2]=0,t[f+4>>2]=0,f=e+24|0,t[f>>2]=0,t[f+4>>2]=0,t[e+100>>2]=0,C[e+96>>2]=-F,C[e+92>>2]=-w,t[e+16>>2]=0,t[e+20>>2]=0,C[e+88>>2]=-W,t[e+80>>2]=0,t[e+4>>2]=1065353216,t[e>>2]=23780,f=t[A+8>>2],t[e+84>>2]=f,t[e+104>>2]=t[A+48>>2],i=t[f+188>>2],t[e+8>>2]=t[i+4>>2],t[e+12>>2]=t[i+8>>2],b[A+250|0]?Ta(f,t[A+12>>2],e+176|0,e+112|0,e,C[r+56>>2]):ma(r,t[A+12>>2],e+176|0,e+112|0,e,C[r+56>>2]),v=A+152|0,f=A+132|0;r:{e:{i:{if(C[e+4>>2]<B(1)&&(i=t[A+8>>2],!(4&b[i+204|0])&&yf[t[t[A>>2]+56>>2]](A,i,t[e+80>>2]))){if(!(B(B(B(C[e+48>>2]*C[A+256>>2])+B(C[e+52>>2]*C[A+260>>2]))+B(C[e+56>>2]*C[A+264>>2]))>B(0)))break e;if(c=_,_=C[e+4>>2],C[A+148>>2]=c*_,!b[A+288|0])break i;i=A+132|0,n=B(B(1)-_),C[i>>2]=B(n*C[i>>2])+B(_*C[A+152>>2]),i=A+136|0,C[i>>2]=B(n*C[i>>2])+B(_*C[A+156>>2]),i=A+140|0,C[i>>2]=B(n*C[i>>2])+B(_*C[A+160>>2]);break e;}C[A+148>>2]=_,A=t[v+4>>2],t[f>>2]=t[v>>2],t[f+4>>2]=A,A=f+8|0,r=v+8|0,f=t[r+4>>2],t[A>>2]=t[r>>2],t[A+4>>2]=f;break r;}i=t[v+4>>2],t[f>>2]=t[v>>2],t[f+4>>2]=i,o=v+8|0,R=t[o+4>>2],i=f+8|0,t[i>>2]=t[o>>2],t[i+4>>2]=R;}if(D=f+8|0,h=D,k=t[h+4>>2],R=A+8|0,o=t[R>>2],p=o+60|0,i=p,t[i>>2]=t[h>>2],t[i+4>>2]=k,k=t[f+4>>2],h=o+52|0,i=h,t[i>>2]=t[f>>2],t[i+4>>2]=k,i=t[R>>2],t[i+304>>2]=t[i+304>>2]+1,u=o+12|0,G=t[u+4>>2],k=i+12|0,t[k>>2]=t[u>>2],t[k+4>>2]=G,k=t[o+8>>2],t[i+4>>2]=t[o+4>>2],t[i+8>>2]=k,u=o+28|0,G=t[u+4>>2],k=i+28|0,t[k>>2]=t[u>>2],t[k+4>>2]=G,u=o+20|0,G=t[u+4>>2],k=i+20|0,t[k>>2]=t[u>>2],t[k+4>>2]=G,u=o+44|0,G=t[u+4>>2],k=i+44|0,t[k>>2]=t[u>>2],t[k+4>>2]=G,o=o+36|0,u=t[o+4>>2],k=i+36|0,t[k>>2]=t[o>>2],t[k+4>>2]=u,k=t[h+4>>2],o=i+52|0,t[o>>2]=t[h>>2],t[o+4>>2]=k,o=t[p+4>>2],i=i+60|0,t[i>>2]=t[p>>2],t[i+4>>2]=o,a[A+220|0]=0,Oa(A,r)&&(i=A+220|0,a[0|i]=1,Oa(A,r)&&(a[0|i]=1,Oa(A,r)&&(i=A+220|0,a[0|i]=1,Oa(A,r)&&(a[0|i]=1,Oa(A,r)&&(a[A+220|0]=1))))),o=t[R>>2],r=o+60|0,p=t[r+4>>2],i=v+8|0,t[i>>2]=t[r>>2],t[i+4>>2]=p,i=o+52|0,R=t[i+4>>2],t[v>>2]=t[i>>2],t[v+4>>2]=R,v=t[r>>2],r=t[r+4>>2],o=t[i+4>>2],t[f>>2]=t[i>>2],t[f+4>>2]=o,t[D>>2]=v,t[D+4>>2]=r,C[A+24>>2]>B(0))return r=A+20|0,t[r>>2]=0,t[r+4>>2]=0,t[A+148>>2]=t[A+60>>2],void(E=e+240|0);}E=e+240|0;}(A,r),n=i- -64|0,c=i+48|0,f=i+32|0,b[A+251|0]?za(A,r,o):(k=C[A+252>>2],C[A+252>>2]=k-e,t[i+12>>2]=0,k=k>e?e:k,C[i+8>>2]=k*C[A+76>>2],C[i+4>>2]=k*C[A+72>>2],C[i>>2]=k*C[A+68>>2],za(A,r,i)),function(A,r,e){var i,f=B(0),n=B(0),o=0,k=0,c=0,u=0,l=B(0),s=0,d=0,v=B(0),g=B(0),_=0,m=0,R=B(0),G=B(0),h=B(0),y=0,Q=0,p=0,D=0,w=B(0),W=0,F=B(0),Z=0,Y=B(0),N=B(0),V=B(0),I=B(0),J=0,X=0,M=0,x=0,S=0,T=0,U=0,j=0,O=0,H=0,z=0,P=0,L=0,K=0,q=0,$=0,AA=0,rA=0,eA=0,iA=0,aA=0,fA=0,nA=0,tA=0;if(i=E-432|0,E=i,o=A+160|0,y=t[o+4>>2],d=i+232|0,t[d>>2]=t[o>>2],t[d+4>>2]=y,d=t[A+156>>2],t[i+224>>2]=t[A+152>>2],t[i+228>>2]=d,f=C[A+20>>2],!(f>B(0))){f=B((f<B(0)?B(-f):B(0))*e),f>B(0)&&(n=C[A+28>>2],f>n^1|(b[A+249|0]?!b[A+248|0]:0)||(f=n)),d=A+152|0,D=A+152|0,f=B(f+C[A+148>>2]),w=B(C[A+256>>2]*f),C[D>>2]=C[D>>2]-w,W=A+156|0,T=A+260|0,F=B(f*C[T>>2]),C[W>>2]=C[W>>2]-F,Z=A+160|0,y=A+264|0,Y=B(f*C[y>>2]),C[Z>>2]=C[Z>>2]-Y,o=i+152|0,t[o>>2]=0,t[o+4>>2]=0,o=i+144|0,t[o>>2]=0,t[o+4>>2]=0,o=i+136|0,t[o>>2]=0,t[o+4>>2]=0,c=t[y+4>>2],o=i+208|0,t[o>>2]=t[y>>2],t[o+4>>2]=c,t[i+128>>2]=0,t[i+132>>2]=0,o=t[A+260>>2],t[i+200>>2]=t[A+256>>2],t[i+204>>2]=o,t[i+192>>2]=0,t[i+116>>2]=1065353216,t[i+112>>2]=23780,c=t[A+8>>2],t[i+196>>2]=c,Q=t[A+48>>2],t[i+216>>2]=Q,o=t[c+188>>2],t[i+120>>2]=t[o+4>>2],t[i+124>>2]=t[o+8>>2],s=i+40|0,t[s>>2]=0,t[s+4>>2]=0,s=i+32|0,t[s>>2]=0,t[s+4>>2]=0,s=i+24|0,t[s>>2]=0,t[s+4>>2]=0,u=t[y+4>>2],s=i+96|0,t[s>>2]=t[y>>2],t[s+4>>2]=u,t[i+84>>2]=c,t[i+16>>2]=0,t[i+20>>2]=0,t[i+80>>2]=0,t[i+4>>2]=1065353216,c=t[A+260>>2],t[i+88>>2]=t[A+256>>2],t[i+92>>2]=c,t[i>>2]=23780,t[i+104>>2]=Q,c=t[o+8>>2],t[i+8>>2]=t[o+4>>2],t[i+12>>2]=c,o=A+132|0,J=i+352|0,X=i+416|0,Q=i+284|0,M=i+264|0,x=i+240|4,s=i+328|0,U=A+172|0,j=A+168|0,O=A+176|0,H=A+180|0,z=A+196|0,P=A+192|0,L=A+184|0,K=A+188|0,q=i+300|0,$=i+296|0,AA=i+292|0,rA=A+250|0,eA=A+290|0,iA=i+80|0,aA=A+248|0,fA=A+249|0,nA=A+148|0,tA=A+256|0,c=0;r:{for(;;){t[s>>2]=0,t[s+4>>2]=0,t[x>>2]=0,t[x+4>>2]=0,t[M>>2]=0,t[M+4>>2]=0,t[Q>>2]=0,t[Q+4>>2]=0,u=i+324|0,t[u>>2]=1065353216,_=i+316|0,k=_,t[k>>2]=0,t[k+4>>2]=0,k=s+8|0,t[k>>2]=0,t[k+4>>2]=0,m=i+344|0,k=m,t[k>>2]=1065353216,t[k+4>>2]=0,k=x+8|0,t[k>>2]=0,t[k+4>>2]=0,t[i+260>>2]=1065353216,k=M+8|0,t[k>>2]=0,t[k+4>>2]=0,t[i+280>>2]=1065353216,t[Q+16>>2]=0,k=Q+8|0,t[k>>2]=0,t[k+4>>2]=0,k=t[o+4>>2],t[X>>2]=t[o>>2],t[X+4>>2]=k,p=o+8|0,S=t[p+4>>2],k=X+8|0,t[k>>2]=t[p>>2],t[k+4>>2]=S,t[i+240>>2]=1065353216,k=d+8|0,S=t[k+4>>2],p=J+8|0,t[p>>2]=t[k>>2],t[p+4>>2]=S,p=t[d+4>>2],t[J>>2]=t[d>>2],t[J+4>>2]=p,t[i+412>>2]=0,t[i+396>>2]=0,t[i+380>>2]=0,f=C[j>>2],n=C[U>>2],G=C[O>>2],l=C[H>>2],v=B(B(2)/B(B(B(B(f*f)+B(n*n))+B(G*G))+B(l*l))),g=B(G*v),R=B(n*g),h=B(f*v),N=B(l*h),C[i+404>>2]=R+N,V=B(f*g),v=B(n*v),I=B(l*v),C[i+400>>2]=V-I,C[i+392>>2]=R-N,R=B(f*v),l=B(l*g),C[i+384>>2]=R+l,C[i+376>>2]=V+I,f=B(f*h),n=B(n*v),C[i+408>>2]=B(1)-B(f+n),h=f,f=B(G*g),C[i+388>>2]=B(1)-B(h+f),C[i+372>>2]=R-l,C[i+368>>2]=B(1)-B(n+f),n=C[z>>2],G=C[P>>2],f=C[L>>2],l=C[K>>2],t[i+348>>2]=0,t[i+332>>2]=0,t[_>>2]=0,g=B(B(2)/B(B(B(B(f*f)+B(l*l))+B(G*G))+B(n*n))),v=B(G*g),R=B(l*v),h=B(f*g),N=B(n*h),C[i+340>>2]=R+N,V=B(f*v),g=B(l*g),I=B(n*g),C[i+336>>2]=V-I,C[s>>2]=R-N,R=B(f*g),n=B(n*v),C[i+320>>2]=R+n,C[i+312>>2]=V+I,f=B(f*h),l=B(l*g),C[m>>2]=B(1)-B(f+l),h=f,f=B(G*v),C[u>>2]=B(1)-B(h+f),C[i+308>>2]=R-n,C[i+304>>2]=B(1)-B(l+f),f=C[D>>2],n=C[W>>2],l=C[Z>>2],t[q>>2]=0,C[$>>2]=l-Y,C[AA>>2]=n-F,C[i+288>>2]=f-w;e:if(b[0|rA]){if(u=A+8|0,_=A+12|0,m=r+56|0,Ta(t[u>>2],t[_>>2],i+368|0,i+304|0,i+112|0,C[m>>2]),C[i+116>>2]<B(1))break e;if(u=t[u>>2],4&b[u+204|0])break e;Ta(u,t[_>>2],i+368|0,i+240|0,i,C[m>>2]);}else u=A+12|0,_=r+56|0,ma(r,t[u>>2],i+368|0,i+304|0,i+112|0,C[_>>2]),4&b[t[A+8>>2]+204|0]|C[i+116>>2]<B(1)||ma(r,t[u>>2],i+368|0,i+240|0,i,C[_>>2]);_=A+20|0,f=C[_>>2],f=f<B(0)?B(-f):B(0);e:if(b[0|eA]){if(u=0,C[i+4>>2]<B(1)^1&&!(C[i+116>>2]<B(1)))break e;if(m=t[A+8>>2],4&b[m+204|0])break e;u=0|yf[t[t[A>>2]+56>>2]](A,m,t[i+192>>2]);}else u=0,C[i+4>>2]<B(1)&&(m=t[A+8>>2],4&b[m+204|0]||(u=0|yf[t[t[A>>2]+56>>2]](A,m,t[iA>>2])));if(n=B(f*e),f=B(0),f=C[_>>2]<B(0)^1?f:C[A+60>>2],1&(n>B(0)^-1|n<f^-1|-1^u|c))break r;if(b[0|fA]&&!b[0|aA])break;c=t[i+228>>2],t[d>>2]=t[i+224>>2],t[d+4>>2]=c,c=i+232|0,u=t[c+4>>2],t[k>>2]=t[c>>2],t[k+4>>2]=u,f=B(f+C[nA>>2]),w=B(C[tA>>2]*f),C[D>>2]=C[D>>2]-w,F=B(f*C[T>>2]),C[W>>2]=C[W>>2]-F,Y=B(f*C[y>>2]),C[Z>>2]=C[Z>>2]-Y,c=1;}c=0;}r:{r=t[A+8>>2];e:{if(!(4&t[r+204>>2]|C[i+116>>2]<B(1)^1)){if(1&(yf[t[t[A>>2]+56>>2]](A,r,t[i+192>>2])|c))break e;break r;}if(!c)break r;}return e=C[A+136>>2],f=b[A+290|0]?b[A+289|0]?C[i+116>>2]:B(B(e-C[i+180>>2])*B(.5)):C[i+116>>2],a[A+289|0]=0,a[A+249|0]=0,r=A+20|0,t[r>>2]=0,t[r+4>>2]=0,r=A+132|0,n=B(B(1)-f),C[r>>2]=B(n*C[r>>2])+B(f*C[A+152>>2]),C[A+136>>2]=B(e*n)+B(f*C[A+156>>2]),r=A+140|0,C[r>>2]=B(n*C[r>>2])+B(f*C[A+160>>2]),void(E=i+432|0);}a[A+289|0]=1,b[A+290|0]&&(f=C[A+20>>2],f=B((f<B(0)?B(-f):B(0))*e),e=C[A+28>>2],f>e^1|(b[A+249|0]?!b[A+248|0]:0)||(r=A+160|0,e=B(e+C[A+148>>2]),C[r>>2]=B(Y+C[r>>2])-B(e*C[A+264>>2]),r=A+156|0,C[r>>2]=B(F+C[r>>2])-B(e*C[A+260>>2]),r=A+152|0,C[r>>2]=B(w+C[r>>2])-B(C[A+256>>2]*e))),A=t[d+4>>2],t[o>>2]=t[d>>2],t[o+4>>2]=A,r=d+8|0,d=t[r+4>>2],A=o+8|0,t[A>>2]=t[r>>2],t[A+4>>2]=d;}E=i+432|0;}(A,r,e),v=A+140|0,g=t[v+4>>2],d=n+8|0,o=d,t[o>>2]=t[v>>2],t[o+4>>2]=g,o=t[A+136>>2],t[n>>2]=t[A+132>>2],t[n+4>>2]=o,g=t[i+20>>2],o=t[A+8>>2],t[o+4>>2]=t[i+16>>2],t[o+8>>2]=g,g=i+24|0,D=t[g+4>>2],v=o+12|0,t[v>>2]=t[g>>2],t[v+4>>2]=D,g=t[f+4>>2],v=o+20|0,t[v>>2]=t[f>>2],t[v+4>>2]=g,f=f+8|0,g=t[f+4>>2],v=o+28|0,t[v>>2]=t[f>>2],t[v+4>>2]=g,v=c+8|0,g=t[v+4>>2],f=o+44|0,t[f>>2]=t[v>>2],t[f+4>>2]=g,v=t[c+4>>2],f=o+36|0,t[f>>2]=t[c>>2],t[f+4>>2]=v,t[o+304>>2]=t[o+304>>2]+1,c=t[d+4>>2],f=o+60|0,t[f>>2]=t[d>>2],t[f+4>>2]=c,f=o+52|0,o=t[n+4>>2],t[f>>2]=t[n>>2],t[f+4>>2]=o,a[A+220|0]=0,Oa(A,r)&&(f=A+220|0,a[0|f]=1,Oa(A,r)&&(a[0|f]=1,Oa(A,r)&&(f=A+220|0,a[0|f]=1,Oa(A,r)&&(a[0|f]=1,Oa(A,r)&&(a[A+220|0]=1)))));}E=i+80|0;},Pa,function(A,r){A|=0,r|=0;var e=B(0),i=B(0),f=B(0),n=B(0),b=0,o=0;b=A,e=C[r>>2],i=B(e*e),e=C[r+4>>2],i=B(i+B(e*e)),e=C[r+8>>2],e=B(i+B(e*e)),i=C[A+36>>2],e!=B(0)&&(i=B(Q(e))),e=i,C[b+20>>2]=e,C[A+32>>2]=e,a[A+249|0]=1,b=A+284|0,e=C[r>>2],f=C[r+4>>2],n=C[r+8>>2],i=B(B(B(e*e)+B(f*f))+B(n*n)),i!=B(0)?(i=B(B(1)/B(Q(i))),n=B(n*i),f=B(f*i),e=B(e*i),r=r+12|0):(n=C[A+264>>2],f=C[A+260>>2],e=C[A+256>>2],r=A+268|0),t[b>>2]=t[r>>2],C[A+280>>2]=n,C[A+276>>2]=f,C[A+272>>2]=e,r=t[A+8>>2],o=r+52|0,b=t[o+4>>2],t[A+116>>2]=t[o>>2],t[A+120>>2]=b,r=r+60|0,o=t[r+4>>2],A=A+124|0,t[A>>2]=t[r>>2],t[A+4>>2]=o;},function(A){return A|=0,0|(B(m(C[A+20>>2]))<B(1.1920928955078125e-7)^1?0:B(m(C[A+24>>2]))<B(1.1920928955078125e-7));},function(A,r){A|=0,r|=0,a[A+288|0]=r;},function(A,r,e){return A|=0,r|=0,e|=0,A=t[e+188>>2],r=t[r+188>>2],t[A+8>>2]&t[r+4>>2]?0!=(t[r+8>>2]&t[A+4>>2])|0:0;},function(A,r){A|=0,r|=0;var e=0;e=t[r+4>>2],t[A+100>>2]=t[r>>2],t[A+104>>2]=e,r=r+8|0,e=t[r+4>>2],A=A+108|0,t[A>>2]=t[r>>2],t[A+4>>2]=e;},function(A){return A|=0,A+100|0;},function(A,r){A|=0,r|=0;var e,i=0,f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=0,s=B(0),d=B(0),v=B(0),g=B(0);i=t[r+4>>2],t[A+68>>2]=t[r>>2],t[A+72>>2]=i,l=r+8|0,e=t[l+4>>2],i=A+76|0,t[i>>2]=t[l>>2],t[i+4>>2]=e,b=C[A+68>>2],o=C[A+72>>2],k=C[i>>2],s=B(B(B(b*b)+B(o*o))+B(k*k));A:{if(s>B(0)){if(c=C[r>>2],f=C[r+4>>2],u=C[r+8>>2],n=B(B(1)/B(Q(B(B(B(c*c)+B(f*f))+B(u*u))))),d=C[A+264>>2],g=B(d*B(u*n)),u=C[A+256>>2],v=C[A+260>>2],n=B(g+B(B(u*B(c*n))+B(v*B(f*n)))),n==B(0))break A;if(f=k,k=B(B(Q(s))*ge(B(B(1.5707963705062866)-Ji(B(G(B(h(n,B(-1))),B(1))))))),c=B(d*k),C[A+76>>2]=f-c,f=o,o=B(v*k),C[A+72>>2]=f-o,f=b,b=B(u*k),C[A+68>>2]=f-b,C[A+20>>2]=(n<B(0)?B(-1):B(1))*B(Q(B(B(c*c)+B(B(b*b)+B(o*o))))),!(n>B(0)))break A;return a[A+249|0]=1,r=t[A+8>>2],i=r+52|0,l=t[i+4>>2],t[A+116>>2]=t[i>>2],t[A+120>>2]=l,r=r+60|0,i=t[r+4>>2],A=A+124|0,t[A>>2]=t[r>>2],void(t[A+4>>2]=i);}t[A+20>>2]=0;}},function(A,r){A|=0,r|=0;var e=B(0);t[A+12>>2]=0,e=C[r+20>>2],C[A>>2]=B(C[r+256>>2]*e)+C[r+68>>2],C[A+8>>2]=B(e*C[r+264>>2])+C[r+76>>2],C[A+4>>2]=B(e*C[r+260>>2])+C[r+72>>2];},Cr,function(A,r){return A|=0,r|=0,t[A+12>>2]&t[r+4>>2]?0!=(t[r+8>>2]&t[A+8>>2])|0:0;},function(A,r,e){A|=0,r|=0,e|=0;var i=0,a=B(0),f=B(0),n=B(0),o=B(0),k=B(0),c=B(0),u=0,l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0);return f=B(1),i=t[r>>2],(0|i)==t[A+84>>2]|4&b[i+204|0]||(e?(n=C[r+16>>2],o=C[r+12>>2],a=C[r+8>>2]):(a=C[r+8>>2],k=C[r+12>>2],c=C[r+16>>2],n=B(B(B(a*C[i+36>>2])+B(k*C[i+40>>2]))+B(c*C[i+44>>2])),o=B(B(B(a*C[i+20>>2])+B(k*C[i+24>>2]))+B(c*C[i+28>>2])),a=B(B(B(C[i+4>>2]*a)+B(C[i+8>>2]*k))+B(C[i+12>>2]*c))),B(B(B(a*C[A+88>>2])+B(o*C[A+92>>2]))+B(n*C[A+96>>2]))<C[A+104>>2]||(t[A+80>>2]=i,t[A+4>>2]=t[r+40>>2],e?(e=t[r+12>>2],t[A+48>>2]=t[r+8>>2],t[A+52>>2]=e,i=r+16|0,u=t[i+4>>2],e=A+56|0,t[e>>2]=t[i>>2],t[e+4>>2]=u):(a=C[i+8>>2],k=C[i+12>>2],c=C[i+20>>2],l=C[i+24>>2],s=C[i+28>>2],d=C[i+36>>2],v=C[i+40>>2],f=C[r+12>>2],g=C[i+44>>2],n=C[r+16>>2],_=C[i+4>>2],o=C[r+8>>2],t[A+60>>2]=0,C[A+56>>2]=B(B(o*d)+B(f*v))+B(n*g),C[A+52>>2]=B(B(o*c)+B(f*l))+B(n*s),C[A+48>>2]=B(B(_*o)+B(a*f))+B(k*n)),e=t[r+28>>2],t[A+64>>2]=t[r+24>>2],t[A+68>>2]=e,e=r+32|0,i=t[e+4>>2],A=A+72|0,t[A>>2]=t[e>>2],t[A+4>>2]=i,f=C[r+40>>2])),B(f);},rf,Ae,function(A,r){A|=0,r|=0;var e=0,i=0,a=0;Ka(A,t[A+28>>2]+4|0,t[A+32>>2]+4|0),t[r>>2]=0,t[r+4>>2]=0,i=t[A+956>>2],i?(e=2,e=4!=(0|i)?1:e,t[r>>2]=e):e=i,b[A+792|0]&&(e=e+1|0,t[r>>2]=e),b[A+798|0]&&(e=e+1|0,t[r>>2]=e),i=t[A+960>>2],i&&(a=r,e=4==(0|i)?e+2|0:e+1|0,t[a>>2]=e),b[A+793|0]&&(e=e+1|0,t[r>>2]=e),b[A+799|0]&&(e=e+1|0,t[r>>2]=e),i=t[A+964>>2],i&&(a=r,e=4==(0|i)?e+2|0:e+1|0,t[a>>2]=e),b[A+794|0]&&(e=e+1|0,t[r>>2]=e),b[A+800|0]&&(t[r>>2]=e+1),qa(A,0),i=t[A+1052>>2],i&&(e=2,t[r>>2]=t[r>>2]+(4!=(0|i)?1:e)),b[A+996|0]&&(t[r>>2]=t[r>>2]+1),b[A+1016|0]&&(t[r>>2]=t[r>>2]+1),qa(A,1),i=t[A+1140>>2],i&&(e=2,t[r>>2]=t[r>>2]+(4!=(0|i)?1:e)),b[A+1084|0]&&(t[r>>2]=t[r>>2]+1),b[A+1104|0]&&(t[r>>2]=t[r>>2]+1),e=2,qa(A,2),i=t[A+1228>>2],i&&(t[r>>2]=t[r>>2]+(4!=(0|i)?1:e)),b[A+1172|0]&&(t[r>>2]=t[r>>2]+1),b[A+1192|0]&&(t[r>>2]=t[r>>2]+1);},function(A,r){var e,i,f,n,o,k;A|=0,r|=0,e=A,i=r,r=t[A+28>>2],f=r+4|0,A=t[A+32>>2],n=A+4|0,o=r+372|0,k=A+372|0,r=r+388|0,A=A+388|0,function(A,r,e,i,f,n,o,k,c){var u=0,l=0,s=0,d=0,v=0,g=0,B=0,m=0,R=0,G=0,h=0,y=0,Q=0,p=0,D=0,w=0,W=0,F=0,Z=0,Y=0,N=0,V=0,I=0,J=0,X=0,M=0,x=0,S=0,T=0;for(u=E-112|0,E=u,G=u+108|0,t[G>>2]=0,h=u+100|0,s=h,t[s>>2]=0,t[s+4>>2]=0,a[u+88|0]=0,t[u+84>>2]=0,a[u+80|0]=0,t[u+76>>2]=0,a[u+72|0]=0,t[u+68>>2]=0,a[u+64|0]=0,t[u+56>>2]=0,t[u+60>>2]=1036831949,a[u+52|0]=0,t[u+48>>2]=0,t[u+40>>2]=0,t[u+44>>2]=1063675494,t[u+32>>2]=0,t[u+36>>2]=1045220557,t[u+24>>2]=1065353216,t[u+28>>2]=-1082130432,t[u+92>>2]=0,t[u+96>>2]=0,y=r+4|0,Q=u+52|0,p=u+104|0,D=u+96|0,w=u- -64|0,W=u+68|0,F=u+72|0,Z=u+76|0,Y=u+80|0,N=u+84|0,V=u+88|0,I=u+92|0,J=u+60|0,X=u+56|0,M=A+1456|0,x=u+40|0,S=u+48|0,T=u+44|0;;){if(g=A+m|0,s=b[g+792|0],l=A+R|0,d=t[l+956>>2],d||(v=s,s=1,v||(s=0,b[g+798|0]))){t[G>>2]=d,a[0|Q]=s,t[u+32>>2]=t[l+712>>2],t[p>>2]=t[l+940>>2],t[D>>2]=t[l+908>>2],t[h>>2]=t[l+924>>2],a[0|w]=b[g+795|0],t[W>>2]=t[l+804>>2],a[0|F]=b[g+798|0],t[Z>>2]=t[l+820>>2],a[0|Y]=b[g+836|0],t[N>>2]=t[l+840>>2],a[0|V]=b[g+856|0],t[I>>2]=t[l+860>>2],t[J>>2]=t[l+892>>2],t[X>>2]=t[l+876>>2],t[u+28>>2]=t[l+696>>2],t[u+24>>2]=t[l+680>>2],t[u+20>>2]=0,t[u+16>>2]=t[l+1268>>2],t[u+8>>2]=t[l+1236>>2],t[u+12>>2]=t[l+1252>>2],v=x,s=t[M>>2]>>R,d=t[r+32>>2],1&s&&(d=l+744|0),t[v>>2]=t[d>>2],t[u+36>>2]=t[(2&s?l+728|0:y)>>2],t[S>>2]=t[(4&s?l+776|0:t[r+32>>2])>>2],t[T>>2]=t[(8&s?l+760|0:y)>>2],g=((m+2&255)>>>0)%3|0,s=1,v=_(((m+1&255)>>>0)%3|0,88)+A|0,l=t[v+1052>>2],d=1;A:if(!(l+-1>>>0<2)){r:{if(4!=(0|l)){if(3!=(0|l))break r;B=+C[v+1040>>2],d=B<-.001|B>.001;break A;}if(d=1,+C[v+1040>>2]<-.001)break A;d=+C[v+1044>>2]>.001;break A;}d=0;}v=_(g,88)+A|0,l=t[v+1052>>2];A:{r:if(!(l+-1>>>0<2))if(4==(0|l)){if(!(+C[v+1040>>2]<-.001||+C[v+1044>>2]>.001))break A;}else {if(3!=(0|l))break A;if(B=+C[v+1040>>2],B<-.001)break r;if(!(B>.001))break A;}s=0;}e=$a(A,u+24|0,i,f,n,o,k,c,r,e,u+8|0,0,d?s:1)+e|0;}if(m=m+1|0,R=R+4|0,12==(0|R))break;}E=u+112|0;}(e,i,function(A,r,e,i,a,f,n,o){var k=0,c=0,u=0,l=0,s=0,d=0,v=0,C=0;if(u=E-32|0,E=u,t[u+24>>2]=t[5979],c=t[5978],t[u+16>>2]=t[5977],t[u+20>>2]=c,c=1,l=t[A+1232>>2],l>>>0<=5&&(k=l<<2,t[u+24>>2]=t[k+23968>>2],c=t[k+23992>>2],t[u+20>>2]=c,k=t[k+24016>>2],t[u+16>>2]=k),l=_(k,88)+A|0,b[1016+(_(k,88)+A|0)|0]||t[l+1052>>2]|b[l+996|0]){c=(k<<4)+A|0,s=c+1388|0,d=t[s+4>>2],v=u+8|0,t[v>>2]=t[s>>2],t[v+4>>2]=d,c=c+1380|0,s=t[c+4>>2],t[u>>2]=t[c>>2],t[u+4>>2]=s;A:{r:{e:{c=t[A+1456>>2]>>12+(k<<2);i:{if(1&c){if(!(2&c))break i;break e;}if(t[984+(_(k,88)+A|0)>>2]=t[t[r+32>>2]>>2],2&c)break e;}if(t[980+(_(k,88)+A|0)>>2]=t[r+4>>2],4&c)break A;break r;}if(4&c)break A;}t[992+(_(k,88)+A|0)>>2]=t[t[r+32>>2]>>2];}8&c||(t[988+(_(k,88)+A|0)>>2]=t[r+4>>2]),s=$a(A,l+968|0,e,i,a,f,n,o,r,0,u,1,0),c=t[u+20>>2];}if(l=_(c,88)+A|0,b[1016+(_(c,88)+A|0)|0]||t[l+1052>>2]|b[l+996|0]){k=(c<<4)+A|0,d=k+1388|0,v=t[d+4>>2],C=u+8|0,t[C>>2]=t[d>>2],t[C+4>>2]=v,k=k+1380|0,d=t[k+4>>2],t[u>>2]=t[k>>2],t[u+4>>2]=d;A:{r:{e:{k=t[A+1456>>2]>>12+(c<<2);i:{if(1&k){if(!(2&k))break i;break e;}if(t[984+(_(c,88)+A|0)>>2]=t[t[r+32>>2]>>2],2&k)break e;}if(t[980+(_(c,88)+A|0)>>2]=t[r+4>>2],4&k)break A;break r;}if(4&k)break A;}t[992+(_(c,88)+A|0)>>2]=t[t[r+32>>2]>>2];}8&k||(t[988+(_(c,88)+A|0)>>2]=t[r+4>>2]),s=$a(A,l+968|0,e,i,a,f,n,o,r,s,u,1,0)+s|0;}if(c=t[u+24>>2],l=_(c,88)+A|0,b[1016+(_(c,88)+A|0)|0]||t[l+1052>>2]|b[l+996|0]){k=(c<<4)+A|0,d=k+1388|0,v=t[d+4>>2],C=u+8|0,t[C>>2]=t[d>>2],t[C+4>>2]=v,k=k+1380|0,d=t[k+4>>2],t[u>>2]=t[k>>2],t[u+4>>2]=d;A:{r:{e:{k=t[A+1456>>2]>>12+(c<<2);i:{if(1&k){if(!(2&k))break i;break e;}if(t[984+(_(c,88)+A|0)>>2]=t[t[r+32>>2]>>2],2&k)break e;}if(t[980+(_(c,88)+A|0)>>2]=t[r+4>>2],4&k)break A;break r;}if(4&k)break A;}t[992+(_(c,88)+A|0)>>2]=t[t[r+32>>2]>>2];}8&k||(t[988+(_(c,88)+A|0)>>2]=t[r+4>>2]),s=$a(A,l+968|0,e,i,a,f,n,o,r,s,u,1,0)+s|0;}return E=u+32|0,s;}(e,i,f,n,o,k,r,A),f,n,o,k,r,A);},function(A,r,e,i){A|=0,r|=0,e=B(e),i|=0;var a=0;A:{r:{e:{i:{a:{f:{n:{if(i>>>0<=2){if(r=r+-1|0,r>>>0>3)break r;switch(r-1|0){case 0:break a;case 2:break f;case 1:break n;}return r=i<<2,C[760+(r+A|0)>>2]=e,void(t[A+1456>>2]=t[A+1456>>2]|8<<r);}if(a=i+-3|0,a>>>0>2)break r;if(r=r+-1|0,r>>>0>3)break r;switch(r-1|0){case 2:break A;case 1:break e;case 0:break i;}return C[988+(_(a,88)+A|0)>>2]=e,void(t[A+1456>>2]=t[A+1456>>2]|8<<(i<<2));}return r=i<<2,C[776+(r+A|0)>>2]=e,void(t[A+1456>>2]=t[A+1456>>2]|4<<r);}return r=i<<2,C[744+(r+A|0)>>2]=e,void(t[A+1456>>2]=t[A+1456>>2]|1<<r);}return r=i<<2,C[728+(r+A|0)>>2]=e,void(t[A+1456>>2]=t[A+1456>>2]|2<<r);}return C[980+(_(a,88)+A|0)>>2]=e,void(t[A+1456>>2]=t[A+1456>>2]|2<<(i<<2));}C[992+(_(a,88)+A|0)>>2]=e,t[A+1456>>2]=t[A+1456>>2]|4<<(i<<2);}return;}C[984+(_(a,88)+A|0)>>2]=e,t[A+1456>>2]=t[A+1456>>2]|1<<(i<<2);},function(A,r,e){A|=0,r|=0,e|=0;var i=B(0);A:{r:{e:{i:{a:{f:{n:{t:{if(e>>>0<=2){if(r=r+-1|0,r>>>0>3)break f;switch(r-1|0){case 0:break a;case 2:break n;case 1:break t;}return B(C[760+((e<<2)+A|0)>>2]);}if(e=e+-3|0,e>>>0>2)break r;if(r=r+-1|0,r>>>0>3)break r;switch(r-1|0){case 2:break A;case 1:break e;case 0:break i;}return B(C[988+(_(e,88)+A|0)>>2]);}return B(C[776+((e<<2)+A|0)>>2]);}return B(C[744+((e<<2)+A|0)>>2]);}return B(B(0));}return B(C[728+((e<<2)+A|0)>>2]);}return B(C[980+(_(e,88)+A|0)>>2]);}i=C[992+(_(e,88)+A|0)>>2];}return B(i);}return B(C[984+(_(e,88)+A|0)>>2]);},function(A){return 644;},function(A,r,e){return A|=0,r|=0,e|=0,Ya(A,r,e),t[r+52>>2]=t[A+48>>2],t[r+56>>2]=t[A+52>>2],t[r+60>>2]=t[A+56>>2],t[r+64>>2]=t[A+60>>2],t[r+68>>2]=t[A- -64>>2],t[r+72>>2]=t[A+68>>2],t[r+76>>2]=t[A+72>>2],t[r+80>>2]=t[A+76>>2],t[r+84>>2]=t[A+80>>2],t[r+88>>2]=t[A+84>>2],t[r+92>>2]=t[A+88>>2],t[r+96>>2]=t[A+92>>2],t[r+100>>2]=t[A+96>>2],t[r+104>>2]=t[A+100>>2],t[r+108>>2]=t[A+104>>2],t[r+112>>2]=t[A+108>>2],t[r+116>>2]=t[A+112>>2],t[r+120>>2]=t[A+116>>2],t[r+124>>2]=t[A+120>>2],t[r+128>>2]=t[A+124>>2],t[r+132>>2]=t[A+128>>2],t[r+136>>2]=t[A+132>>2],t[r+140>>2]=t[A+136>>2],t[r+144>>2]=t[A+140>>2],t[r+148>>2]=t[A+144>>2],t[r+152>>2]=t[A+148>>2],t[r+156>>2]=t[A+152>>2],t[r+160>>2]=t[A+156>>2],t[r+164>>2]=t[A+160>>2],t[r+168>>2]=t[A+164>>2],t[r+172>>2]=t[A+168>>2],t[r+176>>2]=t[A+172>>2],t[r+428>>2]=t[A+968>>2],t[r+412>>2]=t[A+972>>2],t[r+444>>2]=t[A+976>>2],t[r+460>>2]=t[A+980>>2],t[r+476>>2]=t[A+984>>2],t[r+492>>2]=t[A+988>>2],t[r+508>>2]=t[A+992>>2],t[r+524>>2]=t[A+1e3>>2],t[r+540>>2]=t[A+1004>>2],t[r+556>>2]=t[A+1012>>2],t[r+572>>2]=t[A+1020>>2],t[r+588>>2]=t[A+1028>>2],t[r+604>>2]=t[A+1036>>2],t[r+432>>2]=t[A+1056>>2],t[r+416>>2]=t[A+1060>>2],t[r+448>>2]=t[A+1064>>2],t[r+464>>2]=t[A+1068>>2],t[r+480>>2]=t[A+1072>>2],t[r+496>>2]=t[A+1076>>2],t[r+512>>2]=t[A+1080>>2],t[r+528>>2]=t[A+1088>>2],t[r+544>>2]=t[A+1092>>2],t[r+560>>2]=t[A+1100>>2],t[r+576>>2]=t[A+1108>>2],t[r+592>>2]=t[A+1116>>2],t[r+608>>2]=t[A+1124>>2],t[r+436>>2]=t[A+1144>>2],t[r+420>>2]=t[A+1148>>2],t[r+452>>2]=t[A+1152>>2],t[r+468>>2]=t[A+1156>>2],t[r+484>>2]=t[A+1160>>2],t[r+500>>2]=t[A+1164>>2],t[r+516>>2]=t[A+1168>>2],t[r+532>>2]=t[A+1176>>2],t[r+548>>2]=t[A+1180>>2],t[r+564>>2]=t[A+1188>>2],t[r+580>>2]=t[A+1196>>2],t[r+596>>2]=t[A+1204>>2],e=t[A+1212>>2],t[r+440>>2]=0,t[r+612>>2]=e,t[r+616>>2]=0,t[r+600>>2]=0,t[r+584>>2]=0,t[r+568>>2]=0,t[r+552>>2]=0,t[r+536>>2]=0,t[r+520>>2]=0,t[r+504>>2]=0,t[r+488>>2]=0,t[r+472>>2]=0,t[r+456>>2]=0,t[r+424>>2]=0,a[r+620|0]=b[A+996|0],a[r+624|0]=b[A+1008|0],a[r+628|0]=b[A+1016|0],a[r+632|0]=b[A+1024|0],a[r+636|0]=b[A+1032|0],a[r+621|0]=b[A+1084|0],a[r+625|0]=b[A+1096|0],a[r+629|0]=b[A+1104|0],a[r+633|0]=b[A+1112|0],a[r+637|0]=b[A+1120|0],a[r+622|0]=b[A+1172|0],a[r+626|0]=b[A+1184|0],a[r+630|0]=b[A+1192|0],a[r+634|0]=b[A+1200|0],e=b[A+1208|0],a[r+639|0]=0,a[r+635|0]=0,a[r+631|0]=0,a[r+627|0]=0,a[r+623|0]=0,a[r+638|0]=e,t[r+196>>2]=t[A+680>>2],t[r+200>>2]=t[A+684>>2],t[r+204>>2]=t[A+688>>2],t[r+208>>2]=t[A+692>>2],t[r+180>>2]=t[A+696>>2],t[r+184>>2]=t[A+700>>2],t[r+188>>2]=t[A+704>>2],t[r+192>>2]=t[A+708>>2],t[r+212>>2]=t[A+712>>2],t[r+216>>2]=t[A+716>>2],t[r+220>>2]=t[A+720>>2],t[r+224>>2]=t[A+724>>2],t[r+228>>2]=t[A+728>>2],t[r+232>>2]=t[A+732>>2],t[r+236>>2]=t[A+736>>2],t[r+240>>2]=t[A+740>>2],t[r+244>>2]=t[A+744>>2],t[r+248>>2]=t[A+748>>2],t[r+252>>2]=t[A+752>>2],t[r+256>>2]=t[A+756>>2],t[r+260>>2]=t[A+760>>2],t[r+264>>2]=t[A+764>>2],t[r+268>>2]=t[A+768>>2],t[r+272>>2]=t[A+772>>2],t[r+276>>2]=t[A+776>>2],t[r+280>>2]=t[A+780>>2],t[r+284>>2]=t[A+784>>2],t[r+288>>2]=t[A+788>>2],t[r+292>>2]=t[A+876>>2],t[r+296>>2]=t[A+880>>2],t[r+300>>2]=t[A+884>>2],t[r+304>>2]=t[A+888>>2],t[r+308>>2]=t[A+892>>2],t[r+312>>2]=t[A+896>>2],t[r+316>>2]=t[A+900>>2],t[r+320>>2]=t[A+904>>2],t[r+324>>2]=t[A+804>>2],t[r+328>>2]=t[A+808>>2],t[r+332>>2]=t[A+812>>2],t[r+336>>2]=t[A+816>>2],t[r+340>>2]=t[A+820>>2],t[r+344>>2]=t[A+824>>2],t[r+348>>2]=t[A+828>>2],t[r+352>>2]=t[A+832>>2],t[r+356>>2]=t[A+840>>2],t[r+360>>2]=t[A+844>>2],t[r+364>>2]=t[A+848>>2],t[r+368>>2]=t[A+852>>2],t[r+372>>2]=t[A+860>>2],t[r+376>>2]=t[A+864>>2],t[r+380>>2]=t[A+868>>2],t[r+384>>2]=t[A+872>>2],a[r+388|0]=b[A+792|0],a[r+392|0]=b[A+795|0],a[r+396|0]=b[A+798|0],a[r+400|0]=b[A+836|0],a[r+404|0]=b[A+856|0],a[r+389|0]=b[A+793|0],a[r+393|0]=b[A+796|0],a[r+397|0]=b[A+799|0],a[r+401|0]=b[A+837|0],a[r+405|0]=b[A+857|0],a[r+390|0]=b[A+794|0],a[r+394|0]=b[A+797|0],a[r+398|0]=b[A+800|0],a[r+402|0]=b[A+838|0],e=b[A+858|0],a[r+407|0]=0,a[r+403|0]=0,a[r+399|0]=0,a[r+395|0]=0,a[r+391|0]=0,a[r+406|0]=e,A=t[A+1232>>2],t[r+408>>2]=0,t[r+640>>2]=A,24124;},Va,rf,sA,Cr,function(A,r){A|=0,r|=0,F(t[A+4>>2],0|r);},function(A,r){A|=0,r|=0,Z(t[A+4>>2],0|r);},Cr,function(A,r){return A|=0,r|=0,t[A+16>>2]&t[r+4>>2]?0!=(t[r+8>>2]&t[A+12>>2])|0:0;},function(A,r,e){A|=0,r|=0,e|=0;var i=0,a=B(0),f=B(0),n=B(0),b=0,o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0);return t[A+4>>2]=t[r+24>>2],i=t[r>>2],t[A+8>>2]=i,e?(e=t[r+12>>2],t[A+56>>2]=t[r+8>>2],t[A+60>>2]=e,i=r+16|0,b=t[i+4>>2],e=A- -64|0,t[e>>2]=t[i>>2],t[e+4>>2]=b):(o=C[i+8>>2],k=C[i+12>>2],c=C[i+20>>2],u=C[i+24>>2],l=C[i+28>>2],s=C[i+36>>2],d=C[i+40>>2],a=C[r+12>>2],v=C[i+44>>2],f=C[r+16>>2],g=C[i+4>>2],n=C[r+8>>2],t[A+68>>2]=0,C[A- -64>>2]=B(B(n*s)+B(a*d))+B(f*v),C[A+60>>2]=B(B(n*c)+B(a*u))+B(f*l),C[A+56>>2]=B(B(g*n)+B(o*a))+B(k*f)),r=r+24|0,a=C[r>>2],f=B(B(1)-a),C[A+72>>2]=B(f*C[A+24>>2])+B(a*C[A+40>>2]),C[A+76>>2]=B(f*C[A+28>>2])+B(a*C[A+44>>2]),C[A+80>>2]=B(f*C[A+32>>2])+B(a*C[A+48>>2]),B(C[r>>2]);},_f,function(A){A|=0,rA(_f(A));},function(A,r,e){A|=0,r|=0,e|=0;var i=0,f=0,n=0,o=0,k=0,c=0,u=B(0),l=0,s=B(0),d=0,v=B(0),g=B(0),_=B(0);if(t[A+8>>2]=t[r>>2],l=A+28|0,n=t[l>>2],(0|n)==t[A+32>>2]&&(o=n?n<<1:1,!((0|n)>=(0|o)))){A:{r:{if(o){if(c=CA(o<<2,16),n=t[A+28>>2],(0|n)>=1)break r;break A;}if((0|n)<1)break A;}for(k=A+36|0,i=n;t[f+c>>2]=t[t[k>>2]+f>>2],f=f+4|0,i=i+-1|0,i;){}}i=A+36|0,f=t[i>>2],f&&(b[A+40|0]&&(gA(f),n=t[A+28>>2]),t[A+36>>2]=0),t[i>>2]=c,a[A+40|0]=1,t[A+32>>2]=o;}if(t[l>>2]=n+1,t[t[A+36>>2]+(n<<2)>>2]=t[r>>2],e?(v=C[r+16>>2],g=C[r+12>>2],s=C[r+8>>2],u=C[r+20>>2]):(u=C[r+8>>2],e=t[A+8>>2],s=C[r+12>>2],_=C[r+16>>2],v=B(B(B(u*C[e+36>>2])+B(s*C[e+40>>2]))+B(_*C[e+44>>2])),g=B(B(B(u*C[e+20>>2])+B(s*C[e+24>>2]))+B(_*C[e+28>>2])),s=B(B(B(C[e+4>>2]*u)+B(C[e+8>>2]*s))+B(C[e+12>>2]*_)),u=B(0)),c=A+80|0,i=t[c>>2],(0|i)==t[A+84>>2]&&(e=i?i<<1:1,!((0|i)>=(0|e)))){A:{r:{if(e){if(n=CA(e<<4,16),i=t[A+80>>2],(0|i)>=1)break r;break A;}if(n=0,(0|i)<1)break A;}for(f=0,l=A+88|0;o=t[l>>2]+f|0,d=t[o+4>>2],k=f+n|0,t[k>>2]=t[o>>2],t[k+4>>2]=d,o=o+8|0,d=t[o+4>>2],k=k+8|0,t[k>>2]=t[o>>2],t[k+4>>2]=d,f=f+16|0,i=i+-1|0,i;){}}i=A+88|0,f=t[i>>2],f&&(b[A+92|0]&&gA(f),t[A+88>>2]=0),t[i>>2]=n,a[A+92|0]=1,t[A+84>>2]=e,i=t[A+80>>2];}if(e=t[A+88>>2]+(i<<4)|0,C[e+12>>2]=u,C[e+8>>2]=v,C[e+4>>2]=g,C[e>>2]=s,t[c>>2]=t[c>>2]+1,u=C[r+24>>2],v=B(B(1)-u),g=B(B(v*C[A+52>>2])+B(u*C[A+68>>2])),s=B(B(v*C[A+48>>2])+B(u*C[A- -64>>2])),u=B(B(v*C[A+44>>2])+B(u*C[A+60>>2])),c=A+100|0,i=t[c>>2],(0|i)==t[A+104>>2]&&(e=i?i<<1:1,!((0|i)>=(0|e)))){A:{r:{if(e){if(n=CA(e<<4,16),i=t[A+100>>2],(0|i)>=1)break r;break A;}if(n=0,(0|i)<1)break A;}for(f=0,l=A+108|0;o=t[l>>2]+f|0,d=t[o+4>>2],k=f+n|0,t[k>>2]=t[o>>2],t[k+4>>2]=d,o=o+8|0,d=t[o+4>>2],k=k+8|0,t[k>>2]=t[o>>2],t[k+4>>2]=d,f=f+16|0,i=i+-1|0,i;){}}i=A+108|0,f=t[i>>2],f&&(b[A+112|0]&&gA(f),t[A+108>>2]=0),t[i>>2]=n,a[A+112|0]=1,t[A+104>>2]=e,i=t[A+100>>2];}if(e=t[A+108>>2]+(i<<4)|0,C[e+8>>2]=g,C[e+4>>2]=s,C[e>>2]=u,t[c>>2]=t[c>>2]+1,k=A+120|0,e=t[k>>2],(0|e)==t[A+124>>2]&&(l=e?e<<1:1,!((0|e)>=(0|l)))){l?(n=CA(l<<2,16),e=t[A+120>>2]):n=0,o=t[A+128>>2];A:{if((0|e)>=1)for(f=n,i=o,c=e;t[f>>2]=t[i>>2],f=f+4|0,i=i+4|0,c=c+-1|0,c;){}else if(!o)break A;b[A+132|0]&&(gA(o),e=t[A+120>>2]),t[A+128>>2]=0;}t[A+128>>2]=n,a[A+132|0]=1,t[A+124>>2]=l;}return t[t[A+128>>2]+(e<<2)>>2]=t[r+24>>2],t[k>>2]=e+1,B(C[A+4>>2]);},Cr,function(A,r,e){A|=0,r|=0,e|=0;var i=0,a=B(0),f=B(0),n=B(0),b=0,o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0);return t[A+4>>2]=t[r+40>>2],i=t[r>>2],t[A+80>>2]=i,e?(e=t[r+12>>2],t[A+48>>2]=t[r+8>>2],t[A+52>>2]=e,i=r+16|0,b=t[i+4>>2],e=A+56|0,t[e>>2]=t[i>>2],t[e+4>>2]=b):(o=C[i+8>>2],k=C[i+12>>2],c=C[i+20>>2],u=C[i+24>>2],l=C[i+28>>2],s=C[i+36>>2],d=C[i+40>>2],a=C[r+12>>2],v=C[i+44>>2],f=C[r+16>>2],g=C[i+4>>2],n=C[r+8>>2],t[A+60>>2]=0,C[A+56>>2]=B(B(n*s)+B(a*d))+B(f*v),C[A+52>>2]=B(B(n*c)+B(a*u))+B(f*l),C[A+48>>2]=B(B(g*n)+B(o*a))+B(k*f)),e=t[r+28>>2],t[A+64>>2]=t[r+24>>2],t[A+68>>2]=e,e=r+32|0,i=t[e+4>>2],A=A+72|0,t[A>>2]=t[e>>2],t[A+4>>2]=i,B(C[r+40>>2]);},Bf,function(A){A|=0,rA(Bf(A));},function(A,r,e){A|=0,r|=0,e|=0;var i=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=B(0),d=B(0),v=0,g=B(0),_=B(0),m=B(0);if(k=A+20|0,n=t[k>>2],(0|n)==t[A+24>>2]&&(o=n?n<<1:1,!((0|n)>=(0|o)))){A:{r:{if(o){if(c=CA(o<<2,16),n=t[A+20>>2],(0|n)>=1)break r;break A;}if((0|n)<1)break A;}for(u=A+28|0,i=n;t[f+c>>2]=t[t[u>>2]+f>>2],f=f+4|0,i=i+-1|0,i;){}}i=A+28|0,f=t[i>>2],f&&(b[A+32|0]&&(gA(f),n=t[A+20>>2]),t[A+28>>2]=0),t[i>>2]=c,a[A+32|0]=1,t[A+24>>2]=o;}if(t[k>>2]=n+1,t[t[A+28>>2]+(n<<2)>>2]=t[r>>2],e?(_=C[r+16>>2],m=C[r+12>>2],s=C[r+8>>2],d=C[r+20>>2]):(d=C[r+8>>2],e=t[r>>2],s=C[r+12>>2],g=C[r+16>>2],_=B(B(B(d*C[e+36>>2])+B(s*C[e+40>>2]))+B(g*C[e+44>>2])),m=B(B(B(d*C[e+20>>2])+B(s*C[e+24>>2]))+B(g*C[e+28>>2])),s=B(B(B(C[e+4>>2]*d)+B(C[e+8>>2]*s))+B(C[e+12>>2]*g)),d=B(0)),c=A+72|0,i=t[c>>2],(0|i)==t[A+76>>2]&&(e=i?i<<1:1,!((0|i)>=(0|e)))){A:{r:{if(e){if(n=CA(e<<4,16),i=t[A+72>>2],(0|i)>=1)break r;break A;}if(n=0,(0|i)<1)break A;}for(f=0,k=A+80|0;o=t[k>>2]+f|0,v=t[o+4>>2],u=f+n|0,t[u>>2]=t[o>>2],t[u+4>>2]=v,o=o+8|0,l=t[o+4>>2],u=u+8|0,t[u>>2]=t[o>>2],t[u+4>>2]=l,f=f+16|0,i=i+-1|0,i;){}}i=A+80|0,f=t[i>>2],f&&(b[A+84|0]&&gA(f),t[A+80>>2]=0),t[i>>2]=n,a[A+84|0]=1,t[A+76>>2]=e,i=t[A+72>>2];}if(e=t[A+80>>2]+(i<<4)|0,C[e+12>>2]=d,C[e+8>>2]=_,C[e+4>>2]=m,C[e>>2]=s,t[c>>2]=t[c>>2]+1,e=r+24|0,o=A+92|0,i=t[o>>2],(0|i)==t[A+96>>2]&&(c=i?i<<1:1,!((0|i)>=(0|c)))){A:{r:{if(c){if(n=CA(c<<4,16),i=t[A+92>>2],(0|i)>=1)break r;break A;}if(n=0,(0|i)<1)break A;}for(f=0,u=A+100|0;k=t[u>>2]+f|0,v=t[k+4>>2],l=f+n|0,t[l>>2]=t[k>>2],t[l+4>>2]=v,k=k+8|0,v=t[k+4>>2],l=l+8|0,t[l>>2]=t[k>>2],t[l+4>>2]=v,f=f+16|0,i=i+-1|0,i;){}}i=A+100|0,f=t[i>>2],f&&(b[A+104|0]&&gA(f),t[A+100>>2]=0),t[i>>2]=n,a[A+104|0]=1,t[A+96>>2]=c,i=t[A+92>>2];}if(f=t[e+4>>2],i=t[A+100>>2]+(i<<4)|0,t[i>>2]=t[e>>2],t[i+4>>2]=f,e=e+8|0,f=t[e+4>>2],i=i+8|0,t[i>>2]=t[e>>2],t[i+4>>2]=f,t[o>>2]=t[o>>2]+1,u=A+112|0,e=t[u>>2],(0|e)==t[A+116>>2]&&(k=e?e<<1:1,!((0|e)>=(0|k)))){k?(n=CA(k<<2,16),e=t[A+112>>2]):n=0,o=t[A+120>>2];A:{if((0|e)>=1)for(f=n,i=o,c=e;t[f>>2]=t[i>>2],f=f+4|0,i=i+4|0,c=c+-1|0,c;){}else if(!o)break A;b[A+124|0]&&(gA(o),e=t[A+112>>2]),t[A+120>>2]=0;}t[A+120>>2]=n,a[A+124|0]=1,t[A+116>>2]=k;}return t[t[A+120>>2]+(e<<2)>>2]=t[r+40>>2],t[u>>2]=e+1,B(C[A+4>>2]);},sA,Cr,function(A,r,e){var i;return A|=0,r|=0,e|=0,A=t[e>>2],A=4==t[A+252>>2]?A:0,i=t[r>>2],!i|4!=t[i+252>>2]||yf[t[t[i>>2]+28>>2]](i,e,r),A&&yf[t[t[A>>2]+28>>2]](A,r,e),0;},function(A,r,e,i){var a;return A|=0,r|=0,e|=0,i|=0,A=t[e>>2],A=4==t[A+252>>2]?A:0,a=t[r>>2],!a|4!=t[a+252>>2]||yf[t[t[a>>2]+32>>2]](a,e,i,r),A&&yf[t[t[A>>2]+32>>2]](A,r,i,e),0;},Yr];return {btGImpactCollisionAlgorithm_RegisterAlgorithm:function btGImpactCollisionAlgorithm_RegisterAlgorithm(A){A|=0,function(A){b[1732]||(t[431]=8904,a[1732]=1,a[1728]=0),gr(A,25,0),gr(A,25,1),gr(A,25,2),gr(A,25,3),gr(A,25,4),gr(A,25,5),gr(A,25,6),gr(A,25,7),gr(A,25,8),gr(A,25,9),gr(A,25,10),gr(A,25,11),gr(A,25,12),gr(A,25,13),gr(A,25,14),gr(A,25,15),gr(A,25,16),gr(A,25,17),gr(A,25,18),gr(A,25,19),gr(A,25,20),gr(A,25,21),gr(A,25,22),gr(A,25,23),gr(A,25,24),gr(A,25,25),gr(A,25,26),gr(A,25,27),gr(A,25,28),gr(A,25,29),gr(A,25,30),gr(A,25,31),gr(A,25,32),gr(A,25,33),gr(A,25,34),gr(A,25,35),gr(A,0,25),gr(A,1,25),gr(A,2,25),gr(A,3,25),gr(A,4,25),gr(A,5,25),gr(A,6,25),gr(A,7,25),gr(A,8,25),gr(A,9,25),gr(A,10,25),gr(A,11,25),gr(A,12,25),gr(A,13,25),gr(A,14,25),gr(A,15,25),gr(A,16,25),gr(A,17,25),gr(A,18,25),gr(A,19,25),gr(A,20,25),gr(A,21,25),gr(A,22,25),gr(A,23,25),gr(A,24,25),gr(A,25,25),gr(A,26,25),gr(A,27,25),gr(A,28,25),gr(A,29,25),gr(A,30,25),gr(A,31,25),gr(A,32,25),gr(A,33,25),gr(A,34,25),gr(A,35,25);}(A);},btVector3_create:function btVector3_create(A,r,e){var i;return A=B(A),r=B(r),e=B(e),i=CA(16,16),t[i+12>>2]=0,C[i+8>>2]=e,C[i+4>>2]=r,C[i>>2]=A,0|i;},btVector3_setValue:function btVector3_setValue(A,r,e,i){A|=0,r=B(r),e=B(e),i=B(i),t[A+12>>2]=0,C[A+8>>2]=i,C[A+4>>2]=e,C[A>>2]=r;},btVector3_x:ef,btVector3_y:af,btVector3_z:ff,btQuaternion_create:function btQuaternion_create(A,r,e,i){var a;return A=B(A),r=B(r),e=B(e),i=B(i),a=AA(16),C[a+12>>2]=i,C[a+8>>2]=e,C[a+4>>2]=r,C[a>>2]=A,0|a;},btQuaternion_setValue:function btQuaternion_setValue(A,r,e,i,a){A|=0,r=B(r),e=B(e),i=B(i),a=B(a),C[A+12>>2]=a,C[A+8>>2]=i,C[A+4>>2]=e,C[A>>2]=r;},btQuaternion_x:ef,btQuaternion_y:af,btQuaternion_z:ff,btQuaternion_w:function btQuaternion_w(A){return A|=0,B(C[A+12>>2]);},btTransform_create:function btTransform_create(){return 0|AA(64);},btTransform_setOrigin:function btTransform_setOrigin(A,r){A|=0,r|=0;var e=0;e=t[r+4>>2],t[A+48>>2]=t[r>>2],t[A+52>>2]=e,r=r+8|0,e=t[r+4>>2],A=A+56|0,t[A>>2]=t[r>>2],t[A+4>>2]=e;},btTransform_setRotation:function btTransform_setRotation(A,r){A|=0,r|=0;var e=B(0),i=B(0),a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0);i=C[r+12>>2],b=C[r+8>>2],e=C[r>>2],f=C[r+4>>2],t[A+44>>2]=0,t[A+28>>2]=0,t[A+12>>2]=0,a=B(B(2)/B(B(B(B(e*e)+B(f*f))+B(b*b))+B(i*i))),o=B(b*a),n=B(f*o),c=B(e*a),u=B(i*c),C[A+36>>2]=n+u,l=B(e*o),a=B(f*a),k=B(i*a),C[A+32>>2]=l-k,C[A+24>>2]=n-u,n=B(e*a),i=B(i*o),C[A+16>>2]=n+i,C[A+8>>2]=l+k,C[A+4>>2]=n-i,e=B(e*c),i=B(f*a),C[A+40>>2]=B(1)-B(e+i),k=e,e=B(b*o),C[A+20>>2]=B(1)-B(k+e),C[A>>2]=B(1)-B(i+e);},btTransform_getOrigin:nf,btTransform_getRotation:function btTransform_getRotation(A){var r,e;return A|=0,r=E-16|0,E=r,tf(A,r),A=r+8|0,e=t[A+4>>2],t[713]=t[A>>2],t[714]=e,A=t[r+4>>2],t[711]=t[r>>2],t[712]=A,E=r+16|0,2844;},btTransform_setIdentity:function btTransform_setIdentity(A){A|=0;var r=0;t[A+4>>2]=0,t[A+8>>2]=0,t[A>>2]=1065353216,t[A+32>>2]=0,t[A+36>>2]=0,r=A+12|0,t[r>>2]=0,t[r+4>>2]=0,t[A+20>>2]=1065353216,r=A+24|0,t[r>>2]=0,t[r+4>>2]=0,t[A+40>>2]=1065353216,t[A+60>>2]=0,r=A+52|0,t[r>>2]=0,t[r+4>>2]=0,A=A+44|0,t[A>>2]=0,t[A+4>>2]=0;},btTransform_equal:he,btMotionState_destroy:bf,layaMotionState_create:function layaMotionState_create(){var A;return A=AA(8),t[A>>2]=0,t[A+4>>2]=0,t[A>>2]=24168,0|A;},layaMotionState_set_rigidBodyID:function layaMotionState_set_rigidBodyID(A,r){A|=0,r|=0,t[A+4>>2]=r;},btCollisionObject_create:function btCollisionObject_create(){var A;return A=CA(324,16),Er(A),0|A;},btCollisionObject_setContactProcessingThreshold:function btCollisionObject_setContactProcessingThreshold(A,r){A|=0,r=B(r),C[A+184>>2]=r;},btCollisionObject_setActivationState:function btCollisionObject_setActivationState(A,r){A|=0,r|=0,Vr(A,r);},btCollisionObject_forceActivationState:function btCollisionObject_forceActivationState(A,r){A|=0,r|=0,t[A+220>>2]=r;},btCollisionObject_activate:function btCollisionObject_activate(A,r){A|=0,r|=0,Ir(A,r);},btCollisionObject_isActive:function btCollisionObject_isActive(A){return A|=0,A=t[A+220>>2],2!=(0|A)&5!=(0|A);},btCollisionObject_setRestitution:function btCollisionObject_setRestitution(A,r){A|=0,r=B(r),C[A+232>>2]=r,t[A+304>>2]=t[A+304>>2]+1;},btCollisionObject_setFriction:function btCollisionObject_setFriction(A,r){A|=0,r=B(r),C[A+228>>2]=r,t[A+304>>2]=t[A+304>>2]+1;},btCollisionObject_setRollingFriction:function btCollisionObject_setRollingFriction(A,r){A|=0,r=B(r),C[A+236>>2]=r,t[A+304>>2]=t[A+304>>2]+1;},btCollisionObject_getCollisionFlags:function btCollisionObject_getCollisionFlags(A){return A|=0,t[A+204>>2];},btCollisionObject_setCollisionFlags:function btCollisionObject_setCollisionFlags(A,r){A|=0,r|=0,t[A+204>>2]=r;},btCollisionObject_getWorldTransform:pi,btCollisionObject_setWorldTransform:function btCollisionObject_setWorldTransform(A,r){A|=0,r|=0;var e=0,i=0,a=0;t[A+304>>2]=t[A+304>>2]+1,i=r+8|0,a=t[i+4>>2],e=A+12|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,e=t[r+4>>2],t[A+4>>2]=t[r>>2],t[A+8>>2]=e,i=r+24|0,a=t[i+4>>2],e=A+28|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,i=t[r+20>>2],e=A+20|0,t[e>>2]=t[r+16>>2],t[e+4>>2]=i,i=r+40|0,a=t[i+4>>2],e=A+44|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,i=t[r+36>>2],e=A+36|0,t[e>>2]=t[r+32>>2],t[e+4>>2]=i,i=r+56|0,a=t[i+4>>2],e=A+60|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,e=t[r+52>>2],A=A+52|0,t[A>>2]=t[r+48>>2],t[A+4>>2]=e;},btCollisionObject_setInterpolationWorldTransform:function btCollisionObject_setInterpolationWorldTransform(A,r){A|=0,r|=0;var e=0,i=0,a=0;t[A+304>>2]=t[A+304>>2]+1,i=r+8|0,a=t[i+4>>2],e=A+76|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,e=t[r+4>>2],t[A+68>>2]=t[r>>2],t[A+72>>2]=e,i=r+24|0,a=t[i+4>>2],e=A+92|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,i=t[r+20>>2],e=A+84|0,t[e>>2]=t[r+16>>2],t[e+4>>2]=i,i=r+40|0,a=t[i+4>>2],e=A+108|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,i=t[r+36>>2],e=A+100|0,t[e>>2]=t[r+32>>2],t[e+4>>2]=i,i=r+56|0,a=t[i+4>>2],e=A+124|0,t[e>>2]=t[i>>2],t[e+4>>2]=a,e=t[r+52>>2],A=A+116|0,t[A>>2]=t[r+48>>2],t[A+4>>2]=e;},btCollisionObject_setCollisionShape:function btCollisionObject_setCollisionShape(A,r){A|=0,r|=0,yf[t[t[A>>2]+8>>2]](A,r);},btCollisionObject_getCcdMotionThreshold:function btCollisionObject_getCcdMotionThreshold(A){return A|=0,B(C[A+276>>2]);},btCollisionObject_setCcdMotionThreshold:function btCollisionObject_setCcdMotionThreshold(A,r){A|=0,r=B(r),C[A+276>>2]=r;},btCollisionObject_getCcdSweptSphereRadius:function btCollisionObject_getCcdSweptSphereRadius(A){return A|=0,B(C[A+272>>2]);},btCollisionObject_setCcdSweptSphereRadius:function btCollisionObject_setCcdSweptSphereRadius(A,r){A|=0,r=B(r),C[A+272>>2]=r;},btCollisionObject_getUserIndex:function btCollisionObject_getUserIndex(A){return A|=0,t[A+264>>2];},btCollisionObject_setUserIndex:function btCollisionObject_setUserIndex(A,r){A|=0,r|=0,t[A+264>>2]=r;},btCollisionObject_getActivationState:function btCollisionObject_getActivationState(A){return A|=0,t[A+220>>2];},btCollisionObject_setInterpolationAngularVelocity:function btCollisionObject_setInterpolationAngularVelocity(A,r){A|=0,r|=0;var e,i,a=0;t[A+304>>2]=t[A+304>>2]+1,e=r+8|0,i=t[e+4>>2],a=A+156|0,t[a>>2]=t[e>>2],t[a+4>>2]=i,a=t[r+4>>2],t[A+148>>2]=t[r>>2],t[A+152>>2]=a;},btCollisionObject_setInterpolationLinearVelocity:function btCollisionObject_setInterpolationLinearVelocity(A,r){A|=0,r|=0;var e,i,a=0;t[A+304>>2]=t[A+304>>2]+1,e=r+8|0,i=t[e+4>>2],a=A+140|0,t[a>>2]=t[e>>2],t[a+4>>2]=i,a=t[r+4>>2],t[A+132>>2]=t[r>>2],t[A+136>>2]=a;},btCollisionObject_destroy:bf,RayResultCallback_hasHit:function RayResultCallback_hasHit(A){return A|=0,0!=t[A+8>>2]|0;},RayResultCallback_set_m_collisionFilterGroup:of,RayResultCallback_set_m_collisionFilterMask:function RayResultCallback_set_m_collisionFilterMask(A,r){A|=0,r|=0,t[A+16>>2]=r;},RayResultCallback_get_m_closestHitFraction:af,RayResultCallback_set_m_closestHitFraction:kf,RayResultCallback_get_m_collisionObject:hi,RayResultCallback_set_m_collisionObject:cf,ClosestRayResultCallback_create:function ClosestRayResultCallback_create(A,r){A|=0,r|=0;var e,i,a,f=0;return e=AA(88),t[e+20>>2]=0,t[e+12>>2]=1,t[e+16>>2]=-1,t[e+4>>2]=1065353216,t[e+8>>2]=0,t[e>>2]=24248,i=A+8|0,a=t[i+4>>2],f=e+32|0,t[f>>2]=t[i>>2],t[f+4>>2]=a,f=t[A+4>>2],t[e+24>>2]=t[A>>2],t[e+28>>2]=f,A=t[r+4>>2],t[e+40>>2]=t[r>>2],t[e+44>>2]=A,r=r+8|0,f=t[r+4>>2],A=e+48|0,t[A>>2]=t[r>>2],t[A+4>>2]=f,0|e;},ClosestRayResultCallback_get_m_rayFromWorld:uf,ClosestRayResultCallback_set_m_rayFromWorld:function ClosestRayResultCallback_set_m_rayFromWorld(A,r){A|=0,r|=0;var e=0;e=t[r+4>>2],t[A+24>>2]=t[r>>2],t[A+28>>2]=e,r=r+8|0,e=t[r+4>>2],A=A+32|0,t[A>>2]=t[r>>2],t[A+4>>2]=e;},ClosestRayResultCallback_get_m_rayToWorld:function ClosestRayResultCallback_get_m_rayToWorld(A){return A|=0,A+40|0;},ClosestRayResultCallback_set_m_rayToWorld:function ClosestRayResultCallback_set_m_rayToWorld(A,r){A|=0,r|=0;var e=0;e=t[r+4>>2],t[A+40>>2]=t[r>>2],t[A+44>>2]=e,r=r+8|0,e=t[r+4>>2],A=A+48|0,t[A>>2]=t[r>>2],t[A+4>>2]=e;},ClosestRayResultCallback_get_m_hitNormalWorld:$r,ClosestRayResultCallback_get_m_hitPointWorld:Lr,tBtCollisionObjectArray_size:function tBtCollisionObjectArray_size(A){return A|=0,t[A+4>>2];},tBtCollisionObjectArray_at:function tBtCollisionObjectArray_at(A,r){return A|=0,r|=0,t[t[A+12>>2]+(r<<2)>>2];},tBtCollisionObjectArray_clear:lf,tVector3Array_at:function tVector3Array_at(A,r){return A|=0,r|=0,t[A+12>>2]+(r<<4)|0;},tVector3Array_clear:lf,tScalarArray_at:function tScalarArray_at(A,r){return A|=0,r|=0,B(C[t[A+12>>2]+(r<<2)>>2]);},tScalarArray_clear:lf,AllHitsRayResultCallback_create:function AllHitsRayResultCallback_create(A,r){A|=0,r|=0;var e,i,f=0,n=0;return e=AA(136),t[e+28>>2]=0,t[e+32>>2]=0,t[e+20>>2]=0,t[e+12>>2]=1,t[e+16>>2]=-1,t[e+4>>2]=1065353216,t[e+8>>2]=0,a[e+40|0]=1,t[e>>2]=24380,t[e+36>>2]=0,n=A+8|0,f=t[n+4>>2],i=e+52|0,t[i>>2]=t[n>>2],t[i+4>>2]=f,f=t[A+4>>2],t[e+44>>2]=t[A>>2],t[e+48>>2]=f,f=r+8|0,A=t[f+4>>2],n=e+68|0,t[n>>2]=t[f>>2],t[n+4>>2]=A,A=t[r+4>>2],t[e+60>>2]=t[r>>2],t[e+64>>2]=A,a[e+92|0]=1,t[e+88>>2]=0,a[e+112|0]=1,t[e+80>>2]=0,t[e+84>>2]=0,a[e+132|0]=1,t[e+108>>2]=0,t[e+100>>2]=0,t[e+104>>2]=0,t[e+128>>2]=0,t[e+120>>2]=0,t[e+124>>2]=0,0|e;},AllHitsRayResultCallback_get_m_rayFromWorld:function AllHitsRayResultCallback_get_m_rayFromWorld(A){return A|=0,A+44|0;},AllHitsRayResultCallback_set_m_rayFromWorld:function AllHitsRayResultCallback_set_m_rayFromWorld(A,r){A|=0,r|=0;var e=0;e=t[r+4>>2],t[A+44>>2]=t[r>>2],t[A+48>>2]=e,r=r+8|0,e=t[r+4>>2],A=A+52|0,t[A>>2]=t[r>>2],t[A+4>>2]=e;},AllHitsRayResultCallback_get_m_rayToWorld:function AllHitsRayResultCallback_get_m_rayToWorld(A){return A|=0,A+60|0;},AllHitsRayResultCallback_set_m_rayToWorld:function AllHitsRayResultCallback_set_m_rayToWorld(A,r){A|=0,r|=0;var e=0;e=t[r+4>>2],t[A+60>>2]=t[r>>2],t[A+64>>2]=e,r=r+8|0,e=t[r+4>>2],A=A+68|0,t[A>>2]=t[r>>2],t[A+4>>2]=e;},AllHitsRayResultCallback_get_m_hitPointWorld:function AllHitsRayResultCallback_get_m_hitPointWorld(A){return A|=0,A+96|0;},AllHitsRayResultCallback_get_m_hitNormalWorld:function AllHitsRayResultCallback_get_m_hitNormalWorld(A){return A|=0,A+76|0;},AllHitsRayResultCallback_get_m_collisionObjects:uf,AllHitsRayResultCallback_get_m_hitFractions:function AllHitsRayResultCallback_get_m_hitFractions(A){return A|=0,A+116|0;},btManifoldPoint_get_m_positionWorldOnA:nf,btManifoldPoint_get_m_positionWorldOnB:sf,btManifoldPoint_get_m_normalWorldOnB:df,btManifoldPoint_getDistance:function btManifoldPoint_getDistance(A){return A|=0,B(C[A+80>>2]);},ConvexResultCallback_hasHit:function ConvexResultCallback_hasHit(A){return A|=0,C[A+4>>2]<B(1)|0;},ConvexResultCallback_set_m_collisionFilterGroup:cf,ConvexResultCallback_set_m_collisionFilterMask:of,ConvexResultCallback_get_m_closestHitFraction:af,ConvexResultCallback_set_m_closestHitFraction:kf,ClosestConvexResultCallback_create:function ClosestConvexResultCallback_create(A,r){A|=0,r|=0;var e,i,a=0,f=0;return e=AA(84),t[e+12>>2]=-1,t[e+4>>2]=1065353216,t[e+8>>2]=1,t[e>>2]=24464,f=A+8|0,i=t[f+4>>2],a=e+24|0,t[a>>2]=t[f>>2],t[a+4>>2]=i,a=t[A+4>>2],t[e+16>>2]=t[A>>2],t[e+20>>2]=a,a=r+8|0,f=t[a+4>>2],A=e+40|0,t[A>>2]=t[a>>2],t[A+4>>2]=f,A=t[r+4>>2],t[e+32>>2]=t[r>>2],t[e+36>>2]=A,t[e+80>>2]=0,0|e;},ClosestConvexResultCallback_get_m_hitNormalWorld:nf,ClosestConvexResultCallback_get_m_hitPointWorld:df,ClosestConvexResultCallback_get_m_hitCollisionObject:function ClosestConvexResultCallback_get_m_hitCollisionObject(A){return A|=0,t[A+80>>2];},ClosestConvexResultCallback_set_m_hitCollisionObject:function ClosestConvexResultCallback_set_m_hitCollisionObject(A,r){A|=0,r|=0,t[A+80>>2]=r;},AllConvexResultCallback_create:function AllConvexResultCallback_create(A,r){A|=0,r|=0;var e,i,f=0,n=0;return e=AA(128),t[e+20>>2]=0,t[e+24>>2]=0,t[e+12>>2]=-1,t[e+4>>2]=1065353216,t[e+8>>2]=1,a[e+32|0]=1,t[e>>2]=24604,t[e+28>>2]=0,n=A+8|0,i=t[n+4>>2],f=e+44|0,t[f>>2]=t[n>>2],t[f+4>>2]=i,f=t[A+4>>2],t[e+36>>2]=t[A>>2],t[e+40>>2]=f,f=r+8|0,n=t[f+4>>2],A=e+60|0,t[A>>2]=t[f>>2],t[A+4>>2]=n,A=t[r+4>>2],t[e+52>>2]=t[r>>2],t[e+56>>2]=A,a[e+84|0]=1,t[e+80>>2]=0,a[e+104|0]=1,t[e+72>>2]=0,t[e+76>>2]=0,t[e+100>>2]=0,a[e+124|0]=1,t[e+92>>2]=0,t[e+96>>2]=0,t[e+120>>2]=0,t[e+112>>2]=0,t[e+116>>2]=0,0|e;},AllConvexResultCallback_get_m_hitNormalWorld:function AllConvexResultCallback_get_m_hitNormalWorld(A){return A|=0,A+68|0;},AllConvexResultCallback_get_m_hitPointWorld:function AllConvexResultCallback_get_m_hitPointWorld(A){return A|=0,A+88|0;},AllConvexResultCallback_get_m_hitFractions:function AllConvexResultCallback_get_m_hitFractions(A){return A|=0,A+108|0;},AllConvexResultCallback_get_m_collisionObjects:yr,btCollisionShape_getLocalScaling:function btCollisionShape_getLocalScaling(A){return A|=0,0|yf[t[t[A>>2]+28>>2]](A);},btCollisionShape_setLocalScaling:function btCollisionShape_setLocalScaling(A,r){A|=0,r|=0,yf[t[t[A>>2]+24>>2]](A,r);},btCollisionShape_calculateLocalInertia:function btCollisionShape_calculateLocalInertia(A,r,e){A|=0,r=B(r),e|=0,yf[t[t[A>>2]+32>>2]](A,r,e);},btCollisionShape_destroy:bf,btBoxShape_create:function btBoxShape_create(A){var r;return A|=0,r=CA(60,16),function(A,r){var e=B(0),i=B(0),a=B(0),f=B(0);LA(A),e=C[r>>2],a=C[r+4>>2],i=C[r+8>>2],t[A+44>>2]=0,f=B(i*C[A+24>>2]),i=C[A+48>>2],C[A+40>>2]=f-i,C[A+36>>2]=B(a*C[A+20>>2])-i,C[A+32>>2]=B(e*C[A+16>>2])-i,t[A+4>>2]=0,t[A>>2]=9116,e=C[r>>2],a=C[r+8>>2],f=C[r+4>>2],e=B(C[((e<f?(e<a^1)<<1:f<a?1:2)<<2)+r>>2]*B(.10000000149011612)),e<i&&Xr(A,e);}(r,A),0|r;},btCapsuleShape_create:function btCapsuleShape_create(A,r){var e;return A=B(A),r=B(r),e=CA(60,16),function(A,r,e){ZA(A),C[A+48>>2]=r,t[A>>2]=6116,t[A+56>>2]=1,t[A+4>>2]=10,t[A+44>>2]=0,C[A+40>>2]=r,C[A+36>>2]=e*B(.5),C[A+32>>2]=r;}(e,A,r),0|e;},btCapsuleShapeX_create:function btCapsuleShapeX_create(A,r){var e;return A=B(A),r=B(r),e=CA(60,16),function(A,r,e){ZA(A),t[A+56>>2]=0,C[A+48>>2]=r,t[A>>2]=6216,t[A+4>>2]=10,t[A+44>>2]=0,C[A+40>>2]=r,C[A+36>>2]=r,C[A+32>>2]=e*B(.5);}(e,A,r),0|e;},btCapsuleShapeZ_create:function btCapsuleShapeZ_create(A,r){var e;return A=B(A),r=B(r),e=CA(60,16),function(A,r,e){ZA(A),t[A+56>>2]=2,C[A+48>>2]=r,t[A>>2]=6316,t[A+4>>2]=10,t[A+44>>2]=0,C[A+40>>2]=e*B(.5),C[A+36>>2]=r,C[A+32>>2]=r;}(e,A,r),0|e;},btCylinderShape_create:function btCylinderShape_create(A){var r;return A|=0,r=CA(60,16),function(A,r){var e=B(0),i=B(0),a=B(0),f=B(0);ZA(A),e=C[r>>2],a=C[r+4>>2],i=C[r+8>>2],t[A+44>>2]=0,f=B(i*C[A+24>>2]),i=C[A+48>>2],C[A+40>>2]=f-i,C[A+36>>2]=B(a*C[A+20>>2])-i,C[A+32>>2]=B(e*C[A+16>>2])-i,t[A+56>>2]=1,t[A>>2]=9452,e=C[r>>2],a=C[r+8>>2],f=C[r+4>>2],e=B(C[((e<f?(e<a^1)<<1:f<a?1:2)<<2)+r>>2]*B(.10000000149011612)),e<i&&Xr(A,e),t[A+4>>2]=13;}(r,A),0|r;},btCylinderShapeX_create:function btCylinderShapeX_create(A){var r;return A|=0,r=CA(60,16),function(A,r){var e=B(0),i=B(0),a=B(0),f=B(0);ZA(A),e=C[r>>2],a=C[r+4>>2],i=C[r+8>>2],t[A+44>>2]=0,f=B(i*C[A+24>>2]),i=C[A+48>>2],C[A+40>>2]=f-i,C[A+36>>2]=B(a*C[A+20>>2])-i,C[A+32>>2]=B(e*C[A+16>>2])-i,t[A+56>>2]=1,t[A>>2]=9452,e=C[r>>2],a=C[r+8>>2],f=C[r+4>>2],e=B(C[((e<f?(e<a^1)<<1:f<a?1:2)<<2)+r>>2]*B(.10000000149011612)),e<i&&Xr(A,e),t[A>>2]=9556,t[A+4>>2]=13,t[A+56>>2]=0;}(r,A),0|r;},btCylinderShapeZ_create:function btCylinderShapeZ_create(A){var r;return A|=0,r=CA(60,16),function(A,r){var e=B(0),i=B(0),a=B(0),f=B(0);ZA(A),e=C[r>>2],a=C[r+4>>2],i=C[r+8>>2],t[A+44>>2]=0,f=B(i*C[A+24>>2]),i=C[A+48>>2],C[A+40>>2]=f-i,C[A+36>>2]=B(a*C[A+20>>2])-i,C[A+32>>2]=B(e*C[A+16>>2])-i,t[A+56>>2]=1,t[A>>2]=9452,e=C[r>>2],a=C[r+8>>2],f=C[r+4>>2],e=B(C[((e<f?(e<a^1)<<1:f<a?1:2)<<2)+r>>2]*B(.10000000149011612)),e<i&&Xr(A,e),t[A>>2]=9660,t[A+4>>2]=13,t[A+56>>2]=2;}(r,A),0|r;},btSphereShape_create:function btSphereShape_create(A){var r,e;return A=B(A),r=CA(56,16),ZA(r),t[r+28>>2]=0,t[r+32>>2]=0,t[r+24>>2]=1065353216,t[r+16>>2]=1065353216,t[r+20>>2]=1065353216,t[r+4>>2]=8,t[r>>2]=9912,t[r+44>>2]=0,e=r+36|0,t[e>>2]=0,t[e+4>>2]=0,t[r+52>>2]=0,C[r+48>>2]=A,C[r+32>>2]=A,0|r;},btConeShape_create:function btConeShape_create(A,r){var e;return A=B(A),r=B(r),e=CA(80,16),function(A,r,e){ZA(A),C[A+64>>2]=e,C[A+60>>2]=r,t[A>>2]=6564,t[A+76>>2]=2,t[A+68>>2]=0,t[A+72>>2]=1,t[A+4>>2]=11,C[A+40>>2]=r,C[A+36>>2]=e,C[A+32>>2]=r,C[A+56>>2]=r/B(Q(B(B(r*r)+B(e*e))));}(e,A,r),0|e;},btConeShapeX_create:function btConeShapeX_create(A,r){var e;return A=B(A),r=B(r),e=CA(80,16),function(A,r,e){ZA(A),C[A+64>>2]=e,C[A+60>>2]=r,t[A+4>>2]=11,t[A+76>>2]=2,t[A+68>>2]=1,t[A+72>>2]=0,t[A>>2]=6764,C[A+36>>2]=r,C[A+40>>2]=r,C[A+32>>2]=e,C[A+56>>2]=r/B(Q(B(B(r*r)+B(e*e))));}(e,A,r),0|e;},btConeShapeZ_create:function btConeShapeZ_create(A,r){var e;return A=B(A),r=B(r),e=CA(80,16),function(A,r,e){ZA(A),C[A+64>>2]=e,C[A+60>>2]=r,t[A+4>>2]=11,t[A+76>>2]=1,t[A+68>>2]=0,t[A+72>>2]=2,t[A>>2]=6664,C[A+40>>2]=e,C[A+32>>2]=r,C[A+36>>2]=r,C[A+56>>2]=r/B(Q(B(B(r*r)+B(e*e))));}(e,A,r),0|e;},btStaticPlaneShape_create:function btStaticPlaneShape_create(A,r){var e;return A|=0,r=B(r),e=CA(88,16),function(A,r,e){var i,a=B(0),f=B(0),n=B(0);Pr(A),t[A>>2]=10472,a=C[r+8>>2],f=C[r>>2],n=C[r+4>>2],r=t[r+12>>2],i=A+80|0,t[i>>2]=1065353216,t[i+4>>2]=0,t[A+72>>2]=1065353216,t[A+76>>2]=1065353216,C[A+68>>2]=e,t[A- -64>>2]=r,t[A+4>>2]=28,e=B(B(1)/B(Q(B(B(B(f*f)+B(n*n))+B(a*a))))),C[A+60>>2]=a*e,C[A+56>>2]=n*e,C[A+52>>2]=f*e;}(e,A,r),0|e;},btGImpactShapeInterface_updateBound:function btGImpactShapeInterface_updateBound(A){A|=0,b[A+52|0]&&(yf[t[t[A>>2]+68>>2]](A),a[A+52|0]=0);},btGImpactMeshShape_create:function btGImpactMeshShape_create(A){var r;return A|=0,r=CA(172,16),function(A,r){var e=0,i=0,f=0,n=0,o=0,k=0,c=0,u=0,l=0,s=0;if(Pr(A),e=A- -64|0,t[e>>2]=1065353216,t[e+4>>2]=0,t[A+56>>2]=1065353216,t[A+60>>2]=1065353216,e=A+36|0,t[e>>2]=-8388609,t[e+4>>2]=-8388609,t[A+20>>2]=2139095039,t[A+24>>2]=2139095039,t[A>>2]=10880,t[A+88>>2]=0,a[A+92|0]=1,e=A+80|0,t[e>>2]=0,t[e+4>>2]=0,t[A+144>>2]=0,t[A+72>>2]=0,a[A+52|0]=1,t[A+44>>2]=-8388609,t[A+28>>2]=2139095039,t[A+4>>2]=25,k=A+168|0,a[0|k]=1,i=A+164|0,t[i>>2]=0,f=A+156|0,e=f,t[e>>2]=0,t[e+4>>2]=0,t[A+148>>2]=r,(0|yf[t[t[r>>2]+28>>2]](r))>=1)for(l=A+160|0;;){if(s=CA(216,16),Kr(s,r,c),A=t[f>>2],(0|A)==t[l>>2]&&(n=A?A<<1:1,!((0|A)>=(0|n)))){A:{r:{if(n){if(u=CA(n<<2,16),A=t[f>>2],(0|A)>=1)break r;break A;}if(u=0,(0|A)<1)break A;}for(o=0,e=A;t[o+u>>2]=t[t[i>>2]+o>>2],o=o+4|0,e=e+-1|0,e;){}}e=t[i>>2],e&&(b[0|k]&&(gA(e),A=t[f>>2]),t[i>>2]=0),t[i>>2]=u,a[0|k]=1,t[l>>2]=n;}if(t[f>>2]=A+1,t[t[i>>2]+(A<<2)>>2]=s,c=c+1|0,!((0|c)<(0|yf[t[t[r>>2]+28>>2]](r))))break;}}(r,A),0|r;},btCompoundShape_create:function btCompoundShape_create(){var A;return A=CA(96,16),function(A){var r=0,e=0,i=0,f=0,n=0,o=0,k=0;if(t[A+12>>2]=-1,t[A+4>>2]=31,t[A+8>>2]=0,t[A>>2]=14280,t[A+76>>2]=0,t[A+80>>2]=1065353216,t[A+68>>2]=0,t[A+72>>2]=1,t[A+52>>2]=-581039253,t[A+56>>2]=-581039253,t[A+36>>2]=1566444395,t[A+40>>2]=1566444395,a[A+32|0]=1,t[A+28>>2]=0,t[A+92>>2]=0,r=A+84|0,t[r>>2]=1065353216,t[r+4>>2]=1065353216,r=A+60|0,t[r>>2]=-581039253,t[r+4>>2]=0,r=A+44|0,t[r>>2]=1566444395,t[r+4>>2]=0,r=A+20|0,t[r>>2]=0,t[r+4>>2]=0,r=CA(40,16),ie(r),t[A+68>>2]=r,t[A+24>>2]<0){if(o=t[A+20>>2],(0|o)>=1)for(r=64,k=A+28|0;n=t[k>>2]+r|0,e=n+-56|0,f=t[e+4>>2],i=r+-56|0,t[i>>2]=t[e>>2],t[i+4>>2]=f,e=n+-64|0,f=t[e+4>>2],i=r+-64|0,t[i>>2]=t[e>>2],t[i+4>>2]=f,e=n+-40|0,f=t[e+4>>2],i=r+-40|0,t[i>>2]=t[e>>2],t[i+4>>2]=f,e=n+-48|0,f=t[e+4>>2],i=r+-48|0,t[i>>2]=t[e>>2],t[i+4>>2]=f,e=n+-24|0,f=t[e+4>>2],i=r+-24|0,t[i>>2]=t[e>>2],t[i+4>>2]=f,e=n+-32|0,f=t[e+4>>2],i=r+-32|0,t[i>>2]=t[e>>2],t[i+4>>2]=f,e=n+-8|0,f=t[e+4>>2],i=r+-8|0,t[i>>2]=t[e>>2],t[i+4>>2]=f,e=n+-16|0,f=t[e+4>>2],i=r+-16|0,t[i>>2]=t[e>>2],t[i+4>>2]=f,e=t[n+4>>2],t[r>>2]=t[n>>2],t[r+4>>2]=e,n=n+8|0,e=t[n+4>>2],f=r+8|0,t[f>>2]=t[n>>2],t[f+4>>2]=e,r=r+80|0,o=o+-1|0,o;){}r=A+28|0,n=t[r>>2],n&&(b[A+32|0]&&gA(n),t[A+28>>2]=0),t[r>>2]=0,a[A+32|0]=1,t[A+24>>2]=0;}}(A),0|A;},btCompoundShape_addChildShape:function btCompoundShape_addChildShape(A,r,e){A|=0,r|=0,e|=0,Be(A,r,e);},btCompoundShape_removeChildShapeByIndex:function btCompoundShape_removeChildShapeByIndex(A,r){A|=0,r|=0,me(A,r);},btCompoundShape_getChildShape:function btCompoundShape_getChildShape(A,r){return A|=0,r|=0,t[64+(t[A+28>>2]+_(r,80)|0)>>2];},btCompoundShape_updateChildTransform:function btCompoundShape_updateChildTransform(A,r,e,i){A|=0,r|=0,e|=0,i|=0,function(A,r,e,i){var a,f,n,b=0,o=0,k=0;a=E+-64|0,E=a,o=t[e+4>>2],f=_(r,80),n=A+28|0,r=f+t[n>>2]|0,t[r>>2]=t[e>>2],t[r+4>>2]=o,o=e+8|0,k=t[o+4>>2],b=r+8|0,t[b>>2]=t[o>>2],t[b+4>>2]=k,o=e+24|0,k=t[o+4>>2],b=r+24|0,t[b>>2]=t[o>>2],t[b+4>>2]=k,b=t[e+20>>2],t[r+16>>2]=t[e+16>>2],t[r+20>>2]=b,o=e+40|0,k=t[o+4>>2],b=r+40|0,t[b>>2]=t[o>>2],t[b+4>>2]=k,b=t[e+36>>2],t[r+32>>2]=t[e+32>>2],t[r+36>>2]=b,o=e+56|0,k=t[o+4>>2],b=r+56|0,t[b>>2]=t[o>>2],t[b+4>>2]=k,b=t[e+52>>2],t[r+48>>2]=t[e+48>>2],t[r+52>>2]=b,t[A+68>>2]&&(r=t[64+(t[n>>2]+f|0)>>2],yf[t[t[r>>2]+8>>2]](r,e,a+48|0,a+32|0),e=a+40|0,b=t[e+4>>2],r=a+24|0,t[r>>2]=t[e>>2],t[r+4>>2]=b,e=a+56|0,b=t[e+4>>2],r=a+8|0,t[r>>2]=t[e>>2],t[r+4>>2]=b,r=t[a+36>>2],t[a+16>>2]=t[a+32>>2],t[a+20>>2]=r,r=t[a+52>>2],t[a>>2]=t[a+48>>2],t[a+4>>2]=r,ce(t[A+68>>2],t[76+(t[n>>2]+f|0)>>2],a)),i&&yf[t[t[A>>2]+68>>2]](A),E=a- -64|0;}(A,r,e,i);},btStridingMeshInterface_destroy:bf,btTriangleMesh_create:function btTriangleMesh_create(){var A;return A=CA(172,16),function(A){var r,e=0,i=0,f=0,n=0,o=0,k=0,c=0,u=0;if(t[A+4>>2]=1065353216,t[A+8>>2]=1065353216,t[A+48>>2]=0,t[A>>2]=14740,a[A+36|0]=1,e=A+12|0,t[e>>2]=1065353216,t[e+4>>2]=0,r=A+32|0,t[r>>2]=0,e=A+24|0,t[e>>2]=0,t[e+4>>2]=0,a[A+100|0]=1,t[A+96>>2]=0,a[A+120|0]=1,i=A+88|0,t[i>>2]=0,t[i+4>>2]=0,t[A+116>>2]=0,a[A+140|0]=1,i=A+108|0,t[i>>2]=0,t[i+4>>2]=0,t[A+136>>2]=0,a[A+160|0]=1,i=A+128|0,t[i>>2]=0,t[i+4>>2]=0,a[A+165|0]=1,t[A+156>>2]=0,a[A+164|0]=1,t[A+168>>2]=0,i=A+148|0,t[i>>2]=0,t[i+4>>2]=0,i=CA(32,16),c=t[e>>2],(0|c)>=1)for(;e=t[r>>2]+f|0,o=t[e+4>>2],n=i+f|0,t[n>>2]=t[e>>2],t[n+4>>2]=o,o=e+24|0,u=t[o+4>>2],k=n+24|0,t[k>>2]=t[o>>2],t[k+4>>2]=u,o=e+16|0,u=t[o+4>>2],k=n+16|0,t[k>>2]=t[o>>2],t[k+4>>2]=u,e=e+8|0,o=t[e+4>>2],n=n+8|0,t[n>>2]=t[e>>2],t[n+4>>2]=o,f=f+32|0,c=c+-1|0,c;){}f=t[r>>2],f&&(b[A+36|0]&&gA(f),t[A+32>>2]=0),n=A+32|0,t[n>>2]=i,a[A+36|0]=1,t[A+28>>2]=1,e=A+24|0,f=i+(t[e>>2]<<5)|0,t[f+24>>2]=2,t[f+28>>2]=0,t[f+16>>2]=0,t[f+20>>2]=16,t[f+8>>2]=12,t[f+12>>2]=0,t[f>>2]=0,t[f+4>>2]=0,t[e>>2]=t[e>>2]+1,e=t[n>>2],t[e+4>>2]=0,i=b[A+164|0],t[e+24>>2]=i?2:3,n=t[(i?128:148)+A>>2],f=12,t[e+8>>2]=i?12:6,t[e>>2]=(0|n)/3,b[A+165|0]?(f=16,A=t[A+88>>2]):A=t[A+108>>2]/3|0,t[e+20>>2]=f,t[e+16>>2]=0,t[e+12>>2]=A;}(A),0|A;},btTriangleMesh_addTriangle:function btTriangleMesh_addTriangle(A,r,e,i,a){A|=0,r|=0,e|=0,i|=0,a|=0,function(A,r,e,i,a){var f;f=t[A+32>>2],t[f>>2]=t[f>>2]+1,ye(A,Qe(A,r,a)),ye(A,Qe(A,e,a)),ye(A,Qe(A,i,a));}(A,r,e,i,a);},btDefaultCollisionConfiguration_create:function btDefaultCollisionConfiguration_create(){var A,r;return A=E-32|0,E=A,r=AA(88),t[A+24>>2]=0,t[A+28>>2]=1,t[A+16>>2]=4096,t[A+20>>2]=4096,t[A+8>>2]=0,t[A+12>>2]=0,Ri(r,A+8|0),E=A+32|0,0|r;},btDefaultCollisionConfiguration_destroy:bf,btPersistentManifold_getBody0:function btPersistentManifold_getBody0(A){return A|=0,t[A+772>>2];},btPersistentManifold_getBody1:function btPersistentManifold_getBody1(A){return A|=0,t[A+776>>2];},btPersistentManifold_getNumContacts:function btPersistentManifold_getNumContacts(A){return A|=0,t[A+780>>2];},btPersistentManifold_getContactPoint:function btPersistentManifold_getContactPoint(A,r){return A|=0,r|=0,4+(_(r,192)+A|0)|0;},btDispatcher_getNumManifolds:vf,btDispatcher_getManifoldByIndexInternal:function btDispatcher_getManifoldByIndexInternal(A,r){return A|=0,r|=0,0|yf[t[t[A>>2]+40>>2]](A,r);},btCollisionDispatcher_create:function btCollisionDispatcher_create(A){var r;return A|=0,r=AA(10448),function(A,r){var e,i=0,f=0,n=0,b=0,o=0;for(t[A+28>>2]=7780,t[A>>2]=7920,t[A+4>>2]=2,t[A+10444>>2]=r,t[A+64>>2]=113,a[A+24|0]=1,t[A+20>>2]=0,t[A+60>>2]=0,i=A+12|0,t[i>>2]=0,t[i+4>>2]=0,b=A,o=0|yf[t[t[r>>2]+12>>2]](r),t[b+68>>2]=o,b=A,o=0|yf[t[t[r>>2]+8>>2]](r),t[b+72>>2]=o,i=A+5260|0,e=A+10444|0;;){for(r=i,A=0;f=t[e>>2],b=r+-5184|0,o=0|yf[t[t[f>>2]+16>>2]](f,n,A),t[b>>2]=o,f=t[e>>2],b=r,o=0|yf[t[t[f>>2]+20>>2]](f,n,A),t[b>>2]=o,r=r+4|0,A=A+1|0,36!=(0|A);){}if(i=i+144|0,n=n+1|0,36==(0|n))break;}}(r,A),0|r;},btCollisionDispatcher_destroy:bf,btOverlappingPairCache_setInternalGhostPairCallback:Cf,btDbvtBroadphase_create:function btDbvtBroadphase_create(){var A;return A=AA(176),wi(A),0|A;},btDbvtBroadphase_getOverlappingPairCache:vf,btDbvtBroadphase_destroy:bf,btRigidBodyConstructionInfo_create:function btRigidBodyConstructionInfo_create(A,r,e,i){var f,n;return A=B(A),r|=0,e|=0,i|=0,f=AA(144),t[f+72>>2]=e,t[f+4>>2]=r,C[f>>2]=A,e=i+8|0,r=t[e+4>>2],n=f+84|0,t[n>>2]=t[e>>2],t[n+4>>2]=r,r=t[i+4>>2],t[f+76>>2]=t[i>>2],t[f+80>>2]=r,t[f+136>>2]=1008981770,t[f+140>>2]=1008981770,t[f+128>>2]=1000593162,t[f+132>>2]=1008981770,a[f+124|0]=0,t[f+116>>2]=1061997773,t[f+120>>2]=1065353216,t[f+108>>2]=0,t[f+112>>2]=0,t[f+100>>2]=1056964608,t[f+104>>2]=0,t[f+92>>2]=0,t[f+96>>2]=0,t[f+8>>2]=1065353216,r=f+20|0,t[r>>2]=0,t[r+4>>2]=0,t[f+12>>2]=0,t[f+16>>2]=0,t[f+28>>2]=1065353216,r=f+40|0,t[r>>2]=0,t[r+4>>2]=0,t[f+32>>2]=0,t[f+36>>2]=0,t[f+48>>2]=1065353216,t[f+68>>2]=0,r=f+60|0,t[r>>2]=0,t[r+4>>2]=0,t[f+52>>2]=0,t[f+56>>2]=0,0|f;},btRigidBodyConstructionInfo_destroy:function btRigidBodyConstructionInfo_destroy(A){A|=0,A&&rA(A);},btRigidBody_create:function btRigidBody_create(A){var r;return A|=0,r=CA(676,16),Xi(r,A),0|r;},btRigidBody_setCenterOfMassTransform:Hi,btRigidBody_setSleepingThresholds:function btRigidBody_setSleepingThresholds(A,r,e){A|=0,r=B(r),e=B(e),C[A+536>>2]=e,C[A+532>>2]=r;},btRigidBody_getLinearSleepingThreshold:function btRigidBody_getLinearSleepingThreshold(A){return A|=0,B(C[A+532>>2]);},btRigidBody_getAngularSleepingThreshold:function btRigidBody_getAngularSleepingThreshold(A){return A|=0,B(C[A+536>>2]);},btRigidBody_setDamping:function btRigidBody_setDamping(A,r,e){A|=0,r=B(r),e=B(e),function(A,r,e){var i;i=E-16|0,C[i+8>>2]=e,C[i+12>>2]=r,t[i+4>>2]=0,t[i>>2]=1065353216,t[A+504>>2]=t[(r<B(0)?i+4|0:r>B(1)?i:i+12|0)>>2],t[i+4>>2]=0,t[i>>2]=1065353216,t[A+508>>2]=t[(e<B(0)?i+4|0:e>B(1)?i:i+8|0)>>2];}(A,r,e);},btRigidBody_setMassProps:function btRigidBody_setMassProps(A,r,e){A|=0,r=B(r),e|=0,function(A,r,e){var i,a=B(0),f=B(0),n=B(0);i=t[A+204>>2],r!=B(0)?(t[A+204>>2]=-2&i,a=B(B(1)/r)):t[A+204>>2]=1|i,C[A+404>>2]=a,t[A+436>>2]=0,C[A+424>>2]=C[A+440>>2]*r,C[A+432>>2]=C[A+448>>2]*r,C[A+428>>2]=C[A+444>>2]*r,r=C[e>>2],f=C[e+4>>2],n=C[e+8>>2],t[A+468>>2]=0,t[A+632>>2]=0,C[A+628>>2]=a*C[A+416>>2],C[A+624>>2]=a*C[A+412>>2],C[A+620>>2]=C[A+408>>2]*a,C[A+464>>2]=n!=B(0)?B(B(1)/n):B(0),C[A+460>>2]=f!=B(0)?B(B(1)/f):B(0),C[A+456>>2]=r!=B(0)?B(B(1)/r):B(0);}(A,r,e);},btRigidBody_setLinearFactor:function btRigidBody_setLinearFactor(A,r){A|=0,r|=0;var e,i=0,a=B(0);i=t[r+4>>2],t[A+408>>2]=t[r>>2],t[A+412>>2]=i,r=r+8|0,e=t[r+4>>2],i=A+416|0,t[i>>2]=t[r>>2],t[i+4>>2]=e,t[A+632>>2]=0,a=C[A+404>>2],C[A+624>>2]=a*C[A+412>>2],C[A+620>>2]=a*C[A+408>>2],C[A+628>>2]=a*C[i>>2];},btRigidBody_applyTorque:function btRigidBody_applyTorque(A,r){A|=0,r|=0;var e=B(0),i=B(0);e=C[r+8>>2],i=C[r+4>>2],C[A+488>>2]=B(C[r>>2]*C[A+604>>2])+C[A+488>>2],r=A+492|0,C[r>>2]=B(i*C[A+608>>2])+C[r>>2],r=A+496|0,C[r>>2]=B(e*C[A+612>>2])+C[r>>2];},btRigidBody_applyForce:function btRigidBody_applyForce(A,r,e){A|=0,r|=0,e|=0;var i=B(0),a=B(0),f=0,n=B(0),t=B(0),b=B(0),o=B(0),k=B(0),c=B(0);t=C[r+8>>2],i=C[r+4>>2],a=C[A+408>>2],C[A+472>>2]=B(C[r>>2]*a)+C[A+472>>2],f=A+476|0,b=i,i=C[A+412>>2],C[f>>2]=B(b*i)+C[f>>2],f=A+480|0,n=C[A+416>>2],C[f>>2]=B(t*n)+C[f>>2],c=C[r>>2],t=C[e>>2],o=C[e+4>>2],n=B(n*C[r+8>>2]),i=B(i*C[r+4>>2]),k=C[e+8>>2],C[A+488>>2]=B(B(B(o*n)-B(i*k))*C[A+604>>2])+C[A+488>>2],b=C[A+612>>2],r=A+492|0,a=B(a*c),C[r>>2]=B(B(B(k*a)-B(n*t))*C[A+608>>2])+C[r>>2],A=A+496|0,C[A>>2]=B(b*B(B(i*t)-B(a*o)))+C[A>>2];},btRigidBody_applyCentralForce:function btRigidBody_applyCentralForce(A,r){A|=0,r|=0;var e=B(0),i=B(0);e=C[r+8>>2],i=C[r+4>>2],C[A+472>>2]=B(C[r>>2]*C[A+408>>2])+C[A+472>>2],r=A+476|0,C[r>>2]=B(i*C[A+412>>2])+C[r>>2],r=A+480|0,C[r>>2]=B(e*C[A+416>>2])+C[r>>2];},btRigidBody_applyTorqueImpulse:function btRigidBody_applyTorqueImpulse(A,r){A|=0,r|=0;var e=B(0),i=B(0),a=B(0);e=C[r>>2],i=C[r+4>>2],a=C[r+8>>2],C[A+388>>2]=B(B(B(B(C[A+324>>2]*e)+B(C[A+328>>2]*i))+B(C[A+332>>2]*a))*C[A+604>>2])+C[A+388>>2],r=A+392|0,C[r>>2]=B(B(B(B(e*C[A+340>>2])+B(i*C[A+344>>2]))+B(a*C[A+348>>2]))*C[A+608>>2])+C[r>>2],r=A+396|0,C[r>>2]=B(B(B(B(e*C[A+356>>2])+B(i*C[A+360>>2]))+B(a*C[A+364>>2]))*C[A+612>>2])+C[r>>2];},btRigidBody_applyImpulse:function btRigidBody_applyImpulse(A,r,e){A|=0,r|=0,e|=0,gf(A,r,e);},btRigidBody_applyCentralImpulse:function btRigidBody_applyCentralImpulse(A,r){A|=0,r|=0;var e=B(0),i=B(0),a=B(0);i=C[r+8>>2],a=C[r+4>>2],e=C[A+404>>2],C[A+372>>2]=B(B(C[r>>2]*C[A+408>>2])*e)+C[A+372>>2],r=A+376|0,C[r>>2]=B(e*B(a*C[A+412>>2]))+C[r>>2],r=A+380|0,C[r>>2]=B(e*B(i*C[A+416>>2]))+C[r>>2];},btRigidBody_updateInertiaTensor:function btRigidBody_updateInertiaTensor(A){A|=0,function(A){var r=B(0),e=B(0),i=B(0),a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0);t[A+368>>2]=0,t[A+352>>2]=0,t[A+336>>2]=0,s=C[A+456>>2],r=C[A+36>>2],e=B(s*r),d=C[A+460>>2],i=C[A+40>>2],a=B(d*i),v=C[A+464>>2],f=C[A+44>>2],n=B(v*f),C[A+364>>2]=B(B(e*r)+B(a*i))+B(n*f),c=C[A+20>>2],u=C[A+24>>2],l=C[A+28>>2],C[A+360>>2]=B(B(e*c)+B(a*u))+B(n*l),b=e,e=C[A+4>>2],o=a,a=C[A+8>>2],k=n,n=C[A+12>>2],C[A+356>>2]=B(B(b*e)+B(o*a))+B(k*n),b=B(s*c),o=B(d*u),k=B(v*l),C[A+348>>2]=B(B(r*b)+B(i*o))+B(f*k),C[A+344>>2]=B(B(b*c)+B(o*u))+B(k*l),C[A+340>>2]=B(B(b*e)+B(o*a))+B(k*n),b=r,r=B(e*s),o=i,i=B(a*d),k=f,f=B(n*v),C[A+332>>2]=B(B(b*r)+B(o*i))+B(k*f),C[A+328>>2]=B(B(r*c)+B(i*u))+B(f*l),C[A+324>>2]=B(B(r*e)+B(i*a))+B(f*n);}(A);},btRigidBody_getLinearVelocity:function btRigidBody_getLinearVelocity(A){return A|=0,A+372|0;},btRigidBody_getAngularVelocity:function btRigidBody_getAngularVelocity(A){return A|=0,A+388|0;},btRigidBody_setLinearVelocity:function btRigidBody_setLinearVelocity(A,r){A|=0,r|=0;var e,i,a=0;t[A+304>>2]=t[A+304>>2]+1,e=r+8|0,i=t[e+4>>2],a=A+380|0,t[a>>2]=t[e>>2],t[a+4>>2]=i,a=t[r+4>>2],t[A+372>>2]=t[r>>2],t[A+376>>2]=a;},btRigidBody_setAngularVelocity:function btRigidBody_setAngularVelocity(A,r){A|=0,r|=0;var e,i,a=0;t[A+304>>2]=t[A+304>>2]+1,e=r+8|0,i=t[e+4>>2],a=A+396|0,t[a>>2]=t[e>>2],t[a+4>>2]=i,a=t[r+4>>2],t[A+388>>2]=t[r>>2],t[A+392>>2]=a;},btRigidBody_setAngularFactor:function btRigidBody_setAngularFactor(A,r){A|=0,r|=0;var e,i,a=0;t[A+304>>2]=t[A+304>>2]+1,e=r+8|0,i=t[e+4>>2],a=A+612|0,t[a>>2]=t[e>>2],t[a+4>>2]=i,a=t[r+4>>2],t[A+604>>2]=t[r>>2],t[A+608>>2]=a;},btRigidBody_getGravity:function btRigidBody_getGravity(A){return A|=0,A+440|0;},btRigidBody_setGravity:function btRigidBody_setGravity(A,r){A|=0,r|=0,Ui(A,r);},btRigidBody_getTotalForce:function btRigidBody_getTotalForce(A){return A|=0,A+472|0;},btRigidBody_getTotalTorque:function btRigidBody_getTotalTorque(A){return A|=0,A+488|0;},btRigidBody_getFlags:function btRigidBody_getFlags(A){return A|=0,t[A+564>>2];},btRigidBody_setFlags:function btRigidBody_setFlags(A,r){A|=0,r|=0,t[A+564>>2]=r;},btRigidBody_clearForces:function btRigidBody_clearForces(A){A|=0;var r=0;t[A+472>>2]=0,t[A+476>>2]=0,r=A+496|0,t[r>>2]=0,t[r+4>>2]=0,r=A+488|0,t[r>>2]=0,t[r+4>>2]=0,A=A+480|0,t[A>>2]=0,t[A+4>>2]=0;},btSequentialImpulseConstraintSolver_create:function btSequentialImpulseConstraintSolver_create(){var A;return A=CA(236,16),$i(A),0|A;},btCollisionWorld_get_m_useContinuous:function btCollisionWorld_get_m_useContinuous(A){return A|=0,b[A+16|0];},btCollisionWorld_set_m_useContinuous:function btCollisionWorld_set_m_useContinuous(A,r){A|=0,r|=0,a[A+16|0]=r;},btCollisionWorld_rayTest:function btCollisionWorld_rayTest(A,r,e,i){A|=0,r|=0,e|=0,i|=0,yf[t[t[A>>2]+32>>2]](A,r,e,i);},btCollisionWorld_getDispatchInfo:function btCollisionWorld_getDispatchInfo(A){return A|=0,A+28|0;},btCollisionWorld_addCollisionObject:function btCollisionWorld_addCollisionObject(A,r,e,i){A|=0,r|=0,e|=0,i|=0,yf[t[t[A>>2]+36>>2]](A,r,e,i);},btCollisionWorld_removeCollisionObject:function btCollisionWorld_removeCollisionObject(A,r){A|=0,r|=0,yf[t[t[A>>2]+40>>2]](A,r);},btCollisionWorld_convexSweepTest:function btCollisionWorld_convexSweepTest(A,r,e,i,a,f){A|=0,r|=0,e|=0,i|=0,a|=0,f=B(f),ma(A,r,e,i,a,f);},btCollisionWorld_destroy:bf,btDynamicsWorld_addAction:Xa,btDynamicsWorld_removeAction:Ma,btDynamicsWorld_getSolverInfo:function btDynamicsWorld_getSolverInfo(A){return A|=0,A+92|0;},btDiscreteDynamicsWorld_create:function btDiscreteDynamicsWorld_create(A,r,e,i){return A|=0,r|=0,e|=0,i|=0,i=CA(344,16),Ia(i,A,r,e),0|i;},btDiscreteDynamicsWorld_setGravity:function btDiscreteDynamicsWorld_setGravity(A,r){A|=0,r|=0,yf[t[t[A>>2]+72>>2]](A,r);},btDiscreteDynamicsWorld_getGravity:function btDiscreteDynamicsWorld_getGravity(A){var r,e;return A|=0,r=E-16|0,E=r,yf[t[t[A>>2]+76>>2]](r,A),A=r+8|0,e=t[A+4>>2],t[709]=t[A>>2],t[710]=e,A=t[r+4>>2],t[707]=t[r>>2],t[708]=A,E=r+16|0,2828;},btDiscreteDynamicsWorld_addRigidBody:function btDiscreteDynamicsWorld_addRigidBody(A,r,e,i){A|=0,r|=0,e|=0,i|=0,yf[t[t[A>>2]+88>>2]](A,r,e,i);},btDiscreteDynamicsWorld_removeRigidBody:function btDiscreteDynamicsWorld_removeRigidBody(A,r){A|=0,r|=0,yf[t[t[A>>2]+92>>2]](A,r);},btDiscreteDynamicsWorld_stepSimulation:function btDiscreteDynamicsWorld_stepSimulation(A,r,e,i){A|=0,r=B(r),e|=0,i=B(i),yf[t[t[A>>2]+52>>2]](A,r,e,i);},btDiscreteDynamicsWorld_clearForces:function btDiscreteDynamicsWorld_clearForces(A){A|=0,yf[t[t[A>>2]+120>>2]](A);},btDiscreteDynamicsWorld_setApplySpeculativeContactRestitution:function btDiscreteDynamicsWorld_setApplySpeculativeContactRestitution(A,r){A|=0,r|=0,a[A+291|0]=r;},btDiscreteDynamicsWorld_getApplySpeculativeContactRestitution:function btDiscreteDynamicsWorld_getApplySpeculativeContactRestitution(A){return A|=0,b[A+291|0];},btKinematicCharacterController_create:function btKinematicCharacterController_create(A,r,e,i){var n;return A|=0,r|=0,e=B(e),i|=0,n=CA(292,16),function(A,r,e,i,n){var b,o=B(0),k=B(0),c=B(0),u=B(0),l=B(0);b=E-16|0,E=b,t[A>>2]=23576,t[A+272>>2]=0,t[A+276>>2]=0,t[A+256>>2]=0,t[A+260>>2]=0,t[A+8>>2]=r,t[A+64>>2]=1017370378,t[A+68>>2]=0,t[A+72>>2]=0,t[A+100>>2]=0,t[A+104>>2]=0,f[A+250>>1]=257,t[A+56>>2]=0,t[A+252>>2]=0,t[A+12>>2]=e,a[A+216|0]=1,t[A+212>>2]=0,r=A+204|0,t[r>>2]=0,t[r+4>>2]=0,r=A+280|0,t[r>>2]=1065353216,t[r+4>>2]=0,r=A+264|0,t[r>>2]=1065353216,t[r+4>>2]=0,r=A+76|0,t[r>>2]=0,t[r+4>>2]=0,r=A+108|0,t[r>>2]=0,t[r+4>>2]=0,t[A+52>>2]=1105933107,t[A+20>>2]=0,t[A+24>>2]=0,a[A+288|0]=1,f[A+248>>1]=0,t[A+36>>2]=1092616192,t[A+28>>2]=1113325568,t[A+32>>2]=1092616192,t[A+148>>2]=0,a[A+289|0]=0,a[A+290|0]=0,t[A+16>>2]=1045220557,t[A+240>>2]=0,t[A+244>>2]=0,k=C[n>>2],c=C[n+4>>2],o=C[n+8>>2],u=B(B(B(k*k)+B(c*c))+B(o*o)),u>B(0)?(l=o,o=B(B(1)/B(Q(u))),u=B(B(l*o)*B(-29.399999618530273)),k=B(B(k*o)*B(-29.399999618530273)),c=B(B(c*o)*B(-29.399999618530273)),o=B(B(u*u)+B(B(k*k)+B(c*c))),o>B(0)&&(t[b+12>>2]=0,C[b+8>>2]=-u,C[b+4>>2]=-c,C[b>>2]=-k,ja(A,b)),C[A+52>>2]=Q(o)):ja(A,n),t[A+44>>2]=1061752795,t[A+48>>2]=1060439283,C[A+60>>2]=i,E=b+16|0;}(n,A,r,e,i),0|n;},btKinematicCharacterController_setWalkDirection:function btKinematicCharacterController_setWalkDirection(A,r){A|=0,r|=0,yf[t[t[A>>2]+16>>2]](A,r);},btKinematicCharacterController_setFallSpeed:function btKinematicCharacterController_setFallSpeed(A,r){A|=0,r=B(r),C[A+28>>2]=r;},btKinematicCharacterController_setJumpSpeed:function btKinematicCharacterController_setJumpSpeed(A,r){A|=0,r=B(r),C[A+36>>2]=r,C[A+32>>2]=r;},btKinematicCharacterController_setMaxSlope:function btKinematicCharacterController_setMaxSlope(A,r){A|=0,r=B(r);var e,i=B(0);C[A+44>>2]=r,e=A,i=_e(r),C[e+48>>2]=i;},btKinematicCharacterController_onGround:Pa,btKinematicCharacterController_jump:function btKinematicCharacterController_jump(A,r){A|=0,r|=0,yf[t[t[A>>2]+44>>2]](A,r);},btKinematicCharacterController_setGravity:function btKinematicCharacterController_setGravity(A,r){A|=0,r|=0,function(A,r){var e,i,a=B(0),f=B(0),n=B(0),b=B(0);e=E-16|0,E=e,i=A,a=C[r>>2],n=C[r+4>>2],b=C[r+8>>2],f=B(B(B(a*a)+B(n*n))+B(b*b)),f>B(0)&&(t[e+12>>2]=0,C[e+8>>2]=-b,C[e+4>>2]=-n,C[e>>2]=-a,ja(A,e),a=C[r>>2],f=B(a*a),a=C[r+4>>2],f=B(f+B(a*a)),a=C[r+8>>2],f=B(f+B(a*a))),C[i+52>>2]=Q(f),E=e+16|0;}(A,r);},btKinematicCharacterController_setUp:function btKinematicCharacterController_setUp(A,r){A|=0,r|=0,function(A,r){var e,i=B(0),a=B(0),f=B(0),n=B(0),b=B(0),o=B(0);if(e=E-16|0,E=e,a=C[r>>2],f=C[r+4>>2],i=C[r+8>>2],n=B(B(B(a*a)+B(f*f))+B(i*i)),n>B(0)&&(b=C[A+52>>2],b>B(0)))return o=i,i=B(B(1)/B(Q(n))),n=B(-b),b=B(B(o*i)*n),a=B(B(a*i)*n),f=B(B(f*i)*n),i=B(B(b*b)+B(B(a*a)+B(f*f))),i>B(0)&&(t[e+12>>2]=0,C[e+8>>2]=-b,C[e+4>>2]=-f,C[e>>2]=-a,ja(A,e)),C[A+52>>2]=Q(i),void(E=e+16|0);ja(A,r),E=e+16|0;}(A,r);},btKinematicCharacterController_setStepHeight:function btKinematicCharacterController_setStepHeight(A,r){A|=0,r=B(r),C[A+60>>2]=r;},btKinematicCharacterController_destroy:bf,btPairCachingGhostObject_create:function btPairCachingGhostObject_create(){var A;return A=CA(348,16),function(A){var r=0;Er(A),t[A+336>>2]=0,a[A+340|0]=1,r=A+328|0,t[r>>2]=0,t[r+4>>2]=0,t[A+252>>2]=4,t[A>>2]=23464,r=CA(72,16),yi(r),t[A+344>>2]=r;}(A),0|A;},btGhostPairCallback_create:function btGhostPairCallback_create(){var A;return A=AA(4),t[A>>2]=24688,0|A;},btTypedConstraint_setEnabled:function btTypedConstraint_setEnabled(A,r){A|=0,r|=0,a[A+20|0]=r;},btCollisionWorld_addConstraint:function btCollisionWorld_addConstraint(A,r,e){A|=0,r|=0,e|=0,yf[t[t[A>>2]+56>>2]](A,r,e);},btCollisionWorld_removeConstraint:Cf,btJointFeedback_create:function btJointFeedback_create(){var A,r=0;return A=CA(64,16),r=A,t[r>>2]=0,t[r+4>>2]=0,r=r+56|0,t[r>>2]=0,t[r+4>>2]=0,r=A+48|0,t[r>>2]=0,t[r+4>>2]=0,r=A+40|0,t[r>>2]=0,t[r+4>>2]=0,r=A+32|0,t[r>>2]=0,t[r+4>>2]=0,r=A+24|0,t[r>>2]=0,t[r+4>>2]=0,r=A+16|0,t[r>>2]=0,t[r+4>>2]=0,r=A+8|0,t[r>>2]=0,t[r+4>>2]=0,0|A;},btJointFeedback_destroy:function btJointFeedback_destroy(A){A|=0,A&&gA(A);},btTypedConstraint_setJointFeedback:function btTypedConstraint_setJointFeedback(A,r){A|=0,r|=0,t[A+44>>2]=r;},btTypedConstraint_getJointFeedback:function btTypedConstraint_getJointFeedback(A){return A|=0,t[A+44>>2];},btTypedConstraint_enableFeedback:function btTypedConstraint_enableFeedback(A,r){A|=0,r|=0,a[A+21|0]=r;},btTypedConstraint_setParam:function btTypedConstraint_setParam(A,r,e,i){A|=0,r|=0,e|=0,i=B(i),yf[t[t[A>>2]+28>>2]](A,e,i,r);},btTypedConstraint_setOverrideNumSolverIterations:Di,btTypedConstraint_destroy:bf,btJointFeedback_getAppliedForceBodyA:sA,btJointFeedback_getAppliedForceBodyB:sf,btJointFeedback_getAppliedTorqueBodyA:yr,btFixedConstraint_create:function btFixedConstraint_create(A,r,e,i){var a;return A|=0,r|=0,e|=0,i|=0,a=CA(1460,16),function(A,r,e,i,a){La(A,r,e,i,a,0),t[A>>2]=24048,r=A+1144|0,t[r>>2]=0,t[r+4>>2]=0,r=A+1056|0,t[r>>2]=0,t[r+4>>2]=0,t[A+968>>2]=0,t[A+972>>2]=0,r=A+704|0,t[r>>2]=0,t[r+4>>2]=0,r=A+696|0,t[r>>2]=0,t[r+4>>2]=0,r=A+688|0,t[r>>2]=0,t[r+4>>2]=0,t[A+680>>2]=0,t[A+684>>2]=0;}(a,A,e,r,i),0|a;},btGeneric6DofSpring2Constraint_create:function btGeneric6DofSpring2Constraint_create(A,r,e,i,a){var f;return A|=0,r|=0,e|=0,i|=0,a|=0,f=CA(1460,16),A=La(f,A,e,r,i,a),t[f+24>>2]=80,yf[t[t[f>>2]+28>>2]](A,2,B(.800000011920929),0),yf[t[t[f>>2]+28>>2]](A,4,B(0),0),yf[t[t[f>>2]+28>>2]](A,2,B(.800000011920929),1),yf[t[t[f>>2]+28>>2]](A,4,B(0),1),yf[t[t[f>>2]+28>>2]](A,2,B(.800000011920929),2),yf[t[t[f>>2]+28>>2]](A,4,B(0),2),yf[t[t[f>>2]+28>>2]](A,2,B(.800000011920929),3),yf[t[t[f>>2]+28>>2]](A,4,B(0),3),yf[t[t[f>>2]+28>>2]](A,2,B(.800000011920929),4),yf[t[t[f>>2]+28>>2]](A,4,B(0),4),yf[t[t[f>>2]+28>>2]](A,2,B(.800000011920929),5),yf[t[t[f>>2]+28>>2]](A,4,B(0),5),0|f;},btGeneric6DofSpring2Constraint_setAxis:function btGeneric6DofSpring2Constraint_setAxis(A,r,e){A|=0,r|=0,e|=0,function(A,r,e){var i,a=B(0),f=B(0),n=B(0),b=B(0),o=B(0),k=B(0),c=B(0),u=B(0),l=B(0),s=B(0),d=B(0),v=B(0),g=B(0),_=B(0),m=B(0),R=B(0),G=B(0),h=B(0),y=B(0),p=B(0),D=B(0);i=t[A+28>>2],v=C[i+20>>2],g=C[i+36>>2],_=C[i+40>>2],m=C[i+8>>2],R=C[i+24>>2],f=C[i+60>>2],b=C[i+44>>2],o=C[i+12>>2],n=C[i+52>>2],k=C[i+56>>2],c=C[i+28>>2],u=C[e+8>>2],l=C[e>>2],s=C[e+4>>2],d=C[r+8>>2],a=C[r>>2],G=C[r+4>>2],h=C[i+4>>2],t[A+108>>2]=0,t[A+92>>2]=0,t[A+76>>2]=0,t[A+60>>2]=0,n=B(-n),C[A+104>>2]=B(B(B(o*B(0))+B(c*B(0)))+B(b*B(0)))+B(B(B(o*n)-B(c*k))-B(b*f)),C[A+100>>2]=B(B(B(m*B(0))+B(R*B(0)))+B(_*B(0)))+B(B(B(m*n)-B(R*k))-B(_*f)),C[A+96>>2]=B(B(B(h*B(0))+B(v*B(0)))+B(g*B(0)))+B(B(B(h*n)-B(v*k))-B(g*f)),n=a,a=B(B(1)/B(Q(B(B(B(a*a)+B(G*G))+B(d*d))))),f=B(n*a),k=B(G*a),d=B(d*a),C[A+88>>2]=B(B(o*f)+B(c*k))+B(b*d),a=B(B(1)/B(Q(B(B(B(l*l)+B(s*s))+B(u*u))))),l=B(l*a),s=B(s*a),u=B(u*a),C[A+84>>2]=B(B(o*l)+B(c*s))+B(b*u),C[A+72>>2]=B(B(f*m)+B(k*R))+B(d*_),C[A+68>>2]=B(B(l*m)+B(s*R))+B(u*_),C[A+56>>2]=B(B(h*f)+B(k*v))+B(d*g),C[A+52>>2]=B(g*u)+B(B(h*l)+B(v*s)),a=o,o=B(B(d*s)-B(k*u)),n=c,c=B(B(f*u)-B(d*l)),G=b,b=B(B(k*l)-B(f*s)),C[A+80>>2]=B(B(a*o)+B(n*c))+B(G*b),C[A- -64>>2]=B(b*_)+B(B(m*o)+B(R*c)),C[A+48>>2]=B(g*b)+B(B(h*o)+B(v*c)),r=t[A+32>>2],y=C[r+60>>2],D=C[r+52>>2],p=C[r+56>>2],v=C[r+20>>2],g=C[r+36>>2],_=C[r+40>>2],m=C[r+8>>2],R=C[r+24>>2],h=C[r+44>>2],a=C[r+12>>2],G=C[r+28>>2],n=C[r+4>>2],t[A+172>>2]=0,t[A+156>>2]=0,t[A+140>>2]=0,t[A+124>>2]=0,C[A+152>>2]=B(B(f*a)+B(k*G))+B(d*h),C[A+148>>2]=B(B(l*a)+B(s*G))+B(u*h),C[A+144>>2]=B(B(o*a)+B(c*G))+B(b*h),C[A+136>>2]=B(B(f*m)+B(k*R))+B(d*_),C[A+132>>2]=B(B(l*m)+B(s*R))+B(u*_),C[A+128>>2]=B(B(o*m)+B(c*R))+B(b*_),C[A+120>>2]=B(B(f*n)+B(k*v))+B(d*g),C[A+116>>2]=B(B(l*n)+B(s*v))+B(u*g),C[A+112>>2]=B(B(o*n)+B(c*v))+B(b*g),f=B(-D),C[A+168>>2]=B(B(B(a*B(0))+B(G*B(0)))+B(h*B(0)))+B(B(B(a*f)-B(G*p))-B(h*y)),C[A+164>>2]=B(B(B(m*B(0))+B(R*B(0)))+B(_*B(0)))+B(B(B(m*f)-B(R*p))-B(_*y)),C[A+160>>2]=B(B(B(n*B(0))+B(v*B(0)))+B(g*B(0)))+B(B(B(n*f)-B(v*p))-B(g*y)),Ka(A,i+4|0,r+4|0);}(A,r,e);},btGeneric6DofSpring2Constraint_setLimit:function btGeneric6DofSpring2Constraint_setLimit(A,r,e,i){if(A|=0,r|=0,e=B(e),i=B(i),(0|r)<=2)return A=(r<<2)+A|0,C[A+696>>2]=i,void(C[A+680>>2]=e);e=Wa(e),e<B(-3.1415927410125732)?e=B(e+B(6.2831854820251465)):e>B(3.1415927410125732)&&(e=B(e+B(-6.2831854820251465))),i=Wa(i),i<B(-3.1415927410125732)?i=B(i+B(6.2831854820251465)):i>B(3.1415927410125732)&&(i=B(i+B(-6.2831854820251465))),A=_(r,88)+A|0,C[A+708>>2]=i,C[A+704>>2]=e;},btGeneric6DofSpring2Constraint_enableSpring:function btGeneric6DofSpring2Constraint_enableSpring(A,r,e){A|=0,r|=0,e|=0,function(A,r,e){(0|r)<=2?a[798+(A+r|0)|0]=e:a[752+(_(r,88)+A|0)|0]=e;}(A,r,e);},btGeneric6DofSpring2Constraint_setBounce:function btGeneric6DofSpring2Constraint_setBounce(A,r,e){A|=0,r|=0,e=B(e),function(A,r,e){C[((0|r)<3?712+((r<<2)+A|0)|0:712+(_(r,88)+A|0)|0)>>2]=e;}(A,r,e);},btGeneric6DofSpring2Constraint_setStiffness:function btGeneric6DofSpring2Constraint_setStiffness(A,r,e,i){A|=0,r|=0,e=B(e),i|=0,function(A,r,e,i){if((0|r)<=2)return A=A+680|0,a[156+(A+r|0)|0]=i,void(C[140+(A+(r<<2)|0)>>2]=e);A=_(r,88)+A|0,a[A+760|0]=i,C[A+756>>2]=e;}(A,r,e,i);},btGeneric6DofSpring2Constraint_setDamping:function btGeneric6DofSpring2Constraint_setDamping(A,r,e,i){A|=0,r|=0,e=B(e),i|=0,function(A,r,e,i){if((0|r)<=2)return A=A+680|0,a[176+(A+r|0)|0]=i,void(C[160+(A+(r<<2)|0)>>2]=e);A=_(r,88)+A|0,a[A+768|0]=i,C[A+764>>2]=e;}(A,r,e,i);},btGeneric6DofSpring2Constraint_setEquilibriumPoint:function btGeneric6DofSpring2Constraint_setEquilibriumPoint(A,r,e){A|=0,r|=0,e=B(e),function(A,r,e){C[((0|r)<3?860+((r<<2)+A|0)|0:772+(_(r,88)+A|0)|0)>>2]=e;}(A,r,e);},btGeneric6DofSpring2Constraint_enableMotor:function btGeneric6DofSpring2Constraint_enableMotor(A,r,e){A|=0,r|=0,e|=0,function(A,r,e){(0|r)<=2?a[792+(A+r|0)|0]=e:a[732+(_(r,88)+A|0)|0]=e;}(A,r,e);},btGeneric6DofSpring2Constraint_setServo:function btGeneric6DofSpring2Constraint_setServo(A,r,e){A|=0,r|=0,e|=0,function(A,r,e){(0|r)<=2?a[795+(A+r|0)|0]=e:a[744+(_(r,88)+A|0)|0]=e;}(A,r,e);},btGeneric6DofSpring2Constraint_setTargetVelocity:function btGeneric6DofSpring2Constraint_setTargetVelocity(A,r,e){A|=0,r|=0,e=B(e),function(A,r,e){C[((0|r)<3?876+((r<<2)+A|0)|0:736+(_(r,88)+A|0)|0)>>2]=e;}(A,r,e);},btGeneric6DofSpring2Constraint_setServoTarget:function btGeneric6DofSpring2Constraint_setServoTarget(A,r,e){A|=0,r|=0,e=B(e),function(A,r,e){var i=B(0);(0|r)<=2?C[804+((r<<2)+A|0)>>2]=e:(A=748+(_(r,88)+A|0)|0,e=B(e+B(3.1415927410125732)),e=B(e-B(B(y(B(e/B(6.2831854820251465))))*B(6.2831854820251465))),i=B(0),e>=B(6.2831854820251465)||(e<B(0)?(e=B(e+B(6.2831854820251465)),i=e==B(6.2831854820251465)?B(0):e):i=e),C[A>>2]=i+B(-3.1415927410125732));}(A,r,e);},btGeneric6DofSpring2Constraint_setMaxMotorForce:function btGeneric6DofSpring2Constraint_setMaxMotorForce(A,r,e){A|=0,r|=0,e=B(e),function(A,r,e){C[((0|r)<3?892+((r<<2)+A|0)|0:740+(_(r,88)+A|0)|0)>>2]=e;}(A,r,e);},btGeneric6DofSpring2Constraint_setFrames:function btGeneric6DofSpring2Constraint_setFrames(A,r,e){A|=0,r|=0,e|=0,function(A,r,e){var i=0,a=0,f=0;i=t[r+4>>2],t[A+48>>2]=t[r>>2],t[A+52>>2]=i,a=r+8|0,f=t[a+4>>2],i=A+56|0,t[i>>2]=t[a>>2],t[i+4>>2]=f,a=r+24|0,f=t[a+4>>2],i=A+72|0,t[i>>2]=t[a>>2],t[i+4>>2]=f,a=t[r+20>>2],i=A- -64|0,t[i>>2]=t[r+16>>2],t[i+4>>2]=a,a=r+40|0,f=t[a+4>>2],i=A+88|0,t[i>>2]=t[a>>2],t[i+4>>2]=f,a=t[r+36>>2],i=A+80|0,t[i>>2]=t[r+32>>2],t[i+4>>2]=a,a=r+56|0,f=t[a+4>>2],i=A+104|0,t[i>>2]=t[a>>2],t[i+4>>2]=f,a=t[r+52>>2],i=A+96|0,t[i>>2]=t[r+48>>2],t[i+4>>2]=a,i=e+8|0,a=t[i+4>>2],r=A+120|0,t[r>>2]=t[i>>2],t[r+4>>2]=a,r=t[e+4>>2],t[A+112>>2]=t[e>>2],t[A+116>>2]=r,i=e+24|0,a=t[i+4>>2],r=A+136|0,t[r>>2]=t[i>>2],t[r+4>>2]=a,i=t[e+20>>2],r=A+128|0,t[r>>2]=t[e+16>>2],t[r+4>>2]=i,i=t[e+36>>2],r=A+144|0,t[r>>2]=t[e+32>>2],t[r+4>>2]=i,i=e+40|0,a=t[i+4>>2],r=A+152|0,t[r>>2]=t[i>>2],t[r+4>>2]=a,i=t[e+52>>2],r=A+160|0,t[r>>2]=t[e+48>>2],t[r+4>>2]=i,e=e+56|0,i=t[e+4>>2],r=A+168|0,t[r>>2]=t[e>>2],t[r+4>>2]=i,yf[t[t[A>>2]+8>>2]](A),Ka(A,t[A+28>>2]+4|0,t[A+32>>2]+4|0);}(A,r,e);}};}({Math:Math,Int8Array:Int8Array,Uint8Array:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},{memory:{},abort:function abort(){throw new Error("abort");},fd_close:function fd_close(){console.log("fd_close");},fd_write:function fd_write(){console.log("fd_write");},getWorldTransform:i,setWorldTransform:a,fd_seek:function fd_seek(){console.log("fd_seek");}},d);e.btGImpactCollisionAlgorithm_RegisterAlgorithm=C.btGImpactCollisionAlgorithm_RegisterAlgorithm,e.btVector3_create=C.btVector3_create,e.btVector3_setValue=C.btVector3_setValue,e.btVector3_x=C.btVector3_x,e.btVector3_y=C.btVector3_y,e.btVector3_z=C.btVector3_z,e.btQuaternion_create=C.btQuaternion_create,e.btQuaternion_setValue=C.btQuaternion_setValue,e.btQuaternion_x=C.btQuaternion_x,e.btQuaternion_y=C.btQuaternion_y,e.btQuaternion_z=C.btQuaternion_z,e.btQuaternion_w=C.btQuaternion_w,e.btTransform_create=C.btTransform_create,e.btTransform_setOrigin=C.btTransform_setOrigin,e.btTransform_setRotation=C.btTransform_setRotation,e.btTransform_getOrigin=C.btTransform_getOrigin,e.btTransform_getRotation=C.btTransform_getRotation,e.btTransform_setIdentity=C.btTransform_setIdentity,e.btTransform_equal=C.btTransform_equal,e.btMotionState_destroy=C.btMotionState_destroy,e.layaMotionState_create=C.layaMotionState_create,e.layaMotionState_set_rigidBodyID=C.layaMotionState_set_rigidBodyID,e.btCollisionObject_create=C.btCollisionObject_create,e.btCollisionObject_setContactProcessingThreshold=C.btCollisionObject_setContactProcessingThreshold,e.btCollisionObject_setActivationState=C.btCollisionObject_setActivationState,e.btCollisionObject_forceActivationState=C.btCollisionObject_forceActivationState,e.btCollisionObject_activate=C.btCollisionObject_activate,e.btCollisionObject_isActive=C.btCollisionObject_isActive,e.btCollisionObject_setRestitution=C.btCollisionObject_setRestitution,e.btCollisionObject_setFriction=C.btCollisionObject_setFriction,e.btCollisionObject_setRollingFriction=C.btCollisionObject_setRollingFriction,e.btCollisionObject_getCollisionFlags=C.btCollisionObject_getCollisionFlags,e.btCollisionObject_setCollisionFlags=C.btCollisionObject_setCollisionFlags,e.btCollisionObject_getWorldTransform=C.btCollisionObject_getWorldTransform,e.btCollisionObject_setWorldTransform=C.btCollisionObject_setWorldTransform,e.btCollisionObject_setInterpolationWorldTransform=C.btCollisionObject_setInterpolationWorldTransform,e.btCollisionObject_setCollisionShape=C.btCollisionObject_setCollisionShape,e.btCollisionObject_getCcdMotionThreshold=C.btCollisionObject_getCcdMotionThreshold,e.btCollisionObject_setCcdMotionThreshold=C.btCollisionObject_setCcdMotionThreshold,e.btCollisionObject_getCcdSweptSphereRadius=C.btCollisionObject_getCcdSweptSphereRadius,e.btCollisionObject_setCcdSweptSphereRadius=C.btCollisionObject_setCcdSweptSphereRadius,e.btCollisionObject_getUserIndex=C.btCollisionObject_getUserIndex,e.btCollisionObject_setUserIndex=C.btCollisionObject_setUserIndex,e.btCollisionObject_getActivationState=C.btCollisionObject_getActivationState,e.btCollisionObject_setInterpolationAngularVelocity=C.btCollisionObject_setInterpolationAngularVelocity,e.btCollisionObject_setInterpolationLinearVelocity=C.btCollisionObject_setInterpolationLinearVelocity,e.btCollisionObject_destroy=C.btCollisionObject_destroy,e.RayResultCallback_hasHit=C.RayResultCallback_hasHit,e.RayResultCallback_set_m_collisionFilterGroup=C.RayResultCallback_set_m_collisionFilterGroup,e.RayResultCallback_set_m_collisionFilterMask=C.RayResultCallback_set_m_collisionFilterMask,e.RayResultCallback_get_m_closestHitFraction=C.RayResultCallback_get_m_closestHitFraction,e.RayResultCallback_set_m_closestHitFraction=C.RayResultCallback_set_m_closestHitFraction,e.RayResultCallback_get_m_collisionObject=C.RayResultCallback_get_m_collisionObject,e.RayResultCallback_set_m_collisionObject=C.RayResultCallback_set_m_collisionObject,e.ClosestRayResultCallback_create=C.ClosestRayResultCallback_create,e.ClosestRayResultCallback_get_m_rayFromWorld=C.ClosestRayResultCallback_get_m_rayFromWorld,e.ClosestRayResultCallback_set_m_rayFromWorld=C.ClosestRayResultCallback_set_m_rayFromWorld,e.ClosestRayResultCallback_get_m_rayToWorld=C.ClosestRayResultCallback_get_m_rayToWorld,e.ClosestRayResultCallback_set_m_rayToWorld=C.ClosestRayResultCallback_set_m_rayToWorld,e.ClosestRayResultCallback_get_m_hitNormalWorld=C.ClosestRayResultCallback_get_m_hitNormalWorld,e.ClosestRayResultCallback_get_m_hitPointWorld=C.ClosestRayResultCallback_get_m_hitPointWorld,e.tBtCollisionObjectArray_size=C.tBtCollisionObjectArray_size,e.tBtCollisionObjectArray_at=C.tBtCollisionObjectArray_at,e.tBtCollisionObjectArray_clear=C.tBtCollisionObjectArray_clear,e.tVector3Array_at=C.tVector3Array_at,e.tVector3Array_clear=C.tVector3Array_clear,e.tScalarArray_at=C.tScalarArray_at,e.tScalarArray_clear=C.tScalarArray_clear,e.AllHitsRayResultCallback_create=C.AllHitsRayResultCallback_create,e.AllHitsRayResultCallback_get_m_rayFromWorld=C.AllHitsRayResultCallback_get_m_rayFromWorld,e.AllHitsRayResultCallback_set_m_rayFromWorld=C.AllHitsRayResultCallback_set_m_rayFromWorld,e.AllHitsRayResultCallback_get_m_rayToWorld=C.AllHitsRayResultCallback_get_m_rayToWorld,e.AllHitsRayResultCallback_set_m_rayToWorld=C.AllHitsRayResultCallback_set_m_rayToWorld,e.AllHitsRayResultCallback_get_m_hitPointWorld=C.AllHitsRayResultCallback_get_m_hitPointWorld,e.AllHitsRayResultCallback_get_m_hitNormalWorld=C.AllHitsRayResultCallback_get_m_hitNormalWorld,e.AllHitsRayResultCallback_get_m_collisionObjects=C.AllHitsRayResultCallback_get_m_collisionObjects,e.AllHitsRayResultCallback_get_m_hitFractions=C.AllHitsRayResultCallback_get_m_hitFractions,e.btManifoldPoint_get_m_positionWorldOnA=C.btManifoldPoint_get_m_positionWorldOnA,e.btManifoldPoint_get_m_positionWorldOnB=C.btManifoldPoint_get_m_positionWorldOnB,e.btManifoldPoint_get_m_normalWorldOnB=C.btManifoldPoint_get_m_normalWorldOnB,e.btManifoldPoint_getDistance=C.btManifoldPoint_getDistance,e.ConvexResultCallback_hasHit=C.ConvexResultCallback_hasHit,e.ConvexResultCallback_set_m_collisionFilterGroup=C.ConvexResultCallback_set_m_collisionFilterGroup,e.ConvexResultCallback_set_m_collisionFilterMask=C.ConvexResultCallback_set_m_collisionFilterMask,e.ConvexResultCallback_get_m_closestHitFraction=C.ConvexResultCallback_get_m_closestHitFraction,e.ConvexResultCallback_set_m_closestHitFraction=C.ConvexResultCallback_set_m_closestHitFraction,e.ClosestConvexResultCallback_create=C.ClosestConvexResultCallback_create,e.ClosestConvexResultCallback_get_m_hitNormalWorld=C.ClosestConvexResultCallback_get_m_hitNormalWorld,e.ClosestConvexResultCallback_get_m_hitPointWorld=C.ClosestConvexResultCallback_get_m_hitPointWorld,e.ClosestConvexResultCallback_get_m_hitCollisionObject=C.ClosestConvexResultCallback_get_m_hitCollisionObject,e.ClosestConvexResultCallback_set_m_hitCollisionObject=C.ClosestConvexResultCallback_set_m_hitCollisionObject,e.AllConvexResultCallback_create=C.AllConvexResultCallback_create,e.AllConvexResultCallback_get_m_hitNormalWorld=C.AllConvexResultCallback_get_m_hitNormalWorld,e.AllConvexResultCallback_get_m_hitPointWorld=C.AllConvexResultCallback_get_m_hitPointWorld,e.AllConvexResultCallback_get_m_hitFractions=C.AllConvexResultCallback_get_m_hitFractions,e.AllConvexResultCallback_get_m_collisionObjects=C.AllConvexResultCallback_get_m_collisionObjects,e.btCollisionShape_getLocalScaling=C.btCollisionShape_getLocalScaling,e.btCollisionShape_setLocalScaling=C.btCollisionShape_setLocalScaling,e.btCollisionShape_calculateLocalInertia=C.btCollisionShape_calculateLocalInertia,e.btCollisionShape_destroy=C.btCollisionShape_destroy,e.btBoxShape_create=C.btBoxShape_create,e.btCapsuleShape_create=C.btCapsuleShape_create,e.btCapsuleShapeX_create=C.btCapsuleShapeX_create,e.btCapsuleShapeZ_create=C.btCapsuleShapeZ_create,e.btCylinderShape_create=C.btCylinderShape_create,e.btCylinderShapeX_create=C.btCylinderShapeX_create,e.btCylinderShapeZ_create=C.btCylinderShapeZ_create,e.btSphereShape_create=C.btSphereShape_create,e.btConeShape_create=C.btConeShape_create,e.btConeShapeX_create=C.btConeShapeX_create,e.btConeShapeZ_create=C.btConeShapeZ_create,e.btStaticPlaneShape_create=C.btStaticPlaneShape_create,e.btGImpactShapeInterface_updateBound=C.btGImpactShapeInterface_updateBound,e.btGImpactMeshShape_create=C.btGImpactMeshShape_create,e.btCompoundShape_create=C.btCompoundShape_create,e.btCompoundShape_addChildShape=C.btCompoundShape_addChildShape,e.btCompoundShape_removeChildShapeByIndex=C.btCompoundShape_removeChildShapeByIndex,e.btCompoundShape_getChildShape=C.btCompoundShape_getChildShape,e.btCompoundShape_updateChildTransform=C.btCompoundShape_updateChildTransform,e.btStridingMeshInterface_destroy=C.btStridingMeshInterface_destroy,e.btTriangleMesh_create=C.btTriangleMesh_create,e.btTriangleMesh_addTriangle=C.btTriangleMesh_addTriangle,e.btDefaultCollisionConfiguration_create=C.btDefaultCollisionConfiguration_create,e.btDefaultCollisionConfiguration_destroy=C.btDefaultCollisionConfiguration_destroy,e.btPersistentManifold_getBody0=C.btPersistentManifold_getBody0,e.btPersistentManifold_getBody1=C.btPersistentManifold_getBody1,e.btPersistentManifold_getNumContacts=C.btPersistentManifold_getNumContacts,e.btPersistentManifold_getContactPoint=C.btPersistentManifold_getContactPoint,e.btDispatcher_getNumManifolds=C.btDispatcher_getNumManifolds,e.btDispatcher_getManifoldByIndexInternal=C.btDispatcher_getManifoldByIndexInternal,e.btCollisionDispatcher_create=C.btCollisionDispatcher_create,e.btCollisionDispatcher_destroy=C.btCollisionDispatcher_destroy,e.btOverlappingPairCache_setInternalGhostPairCallback=C.btOverlappingPairCache_setInternalGhostPairCallback,e.btDbvtBroadphase_create=C.btDbvtBroadphase_create,e.btDbvtBroadphase_getOverlappingPairCache=C.btDbvtBroadphase_getOverlappingPairCache,e.btDbvtBroadphase_destroy=C.btDbvtBroadphase_destroy,e.btRigidBodyConstructionInfo_create=C.btRigidBodyConstructionInfo_create,e.btRigidBodyConstructionInfo_destroy=C.btRigidBodyConstructionInfo_destroy,e.btRigidBody_create=C.btRigidBody_create,e.btRigidBody_setCenterOfMassTransform=C.btRigidBody_setCenterOfMassTransform,e.btRigidBody_setSleepingThresholds=C.btRigidBody_setSleepingThresholds,e.btRigidBody_getLinearSleepingThreshold=C.btRigidBody_getLinearSleepingThreshold,e.btRigidBody_getAngularSleepingThreshold=C.btRigidBody_getAngularSleepingThreshold,e.btRigidBody_setDamping=C.btRigidBody_setDamping,e.btRigidBody_setMassProps=C.btRigidBody_setMassProps,e.btRigidBody_setLinearFactor=C.btRigidBody_setLinearFactor,e.btRigidBody_applyTorque=C.btRigidBody_applyTorque,e.btRigidBody_applyForce=C.btRigidBody_applyForce,e.btRigidBody_applyCentralForce=C.btRigidBody_applyCentralForce,e.btRigidBody_applyTorqueImpulse=C.btRigidBody_applyTorqueImpulse,e.btRigidBody_applyImpulse=C.btRigidBody_applyImpulse,e.btRigidBody_applyCentralImpulse=C.btRigidBody_applyCentralImpulse,e.btRigidBody_updateInertiaTensor=C.btRigidBody_updateInertiaTensor,e.btRigidBody_getLinearVelocity=C.btRigidBody_getLinearVelocity,e.btRigidBody_getAngularVelocity=C.btRigidBody_getAngularVelocity,e.btRigidBody_setLinearVelocity=C.btRigidBody_setLinearVelocity,e.btRigidBody_setAngularVelocity=C.btRigidBody_setAngularVelocity,e.btRigidBody_setAngularFactor=C.btRigidBody_setAngularFactor,e.btRigidBody_getGravity=C.btRigidBody_getGravity,e.btRigidBody_setGravity=C.btRigidBody_setGravity,e.btRigidBody_getTotalForce=C.btRigidBody_getTotalForce,e.btRigidBody_getTotalTorque=C.btRigidBody_getTotalTorque,e.btRigidBody_getFlags=C.btRigidBody_getFlags,e.btRigidBody_setFlags=C.btRigidBody_setFlags,e.btRigidBody_clearForces=C.btRigidBody_clearForces,e.btSequentialImpulseConstraintSolver_create=C.btSequentialImpulseConstraintSolver_create,e.btCollisionWorld_get_m_useContinuous=C.btCollisionWorld_get_m_useContinuous,e.btCollisionWorld_set_m_useContinuous=C.btCollisionWorld_set_m_useContinuous,e.btCollisionWorld_rayTest=C.btCollisionWorld_rayTest,e.btCollisionWorld_getDispatchInfo=C.btCollisionWorld_getDispatchInfo,e.btCollisionWorld_addCollisionObject=C.btCollisionWorld_addCollisionObject,e.btCollisionWorld_removeCollisionObject=C.btCollisionWorld_removeCollisionObject,e.btCollisionWorld_convexSweepTest=C.btCollisionWorld_convexSweepTest,e.btCollisionWorld_destroy=C.btCollisionWorld_destroy,e.btDynamicsWorld_addAction=C.btDynamicsWorld_addAction,e.btDynamicsWorld_removeAction=C.btDynamicsWorld_removeAction,e.btDynamicsWorld_getSolverInfo=C.btDynamicsWorld_getSolverInfo,e.btDiscreteDynamicsWorld_create=C.btDiscreteDynamicsWorld_create,e.btDiscreteDynamicsWorld_setGravity=C.btDiscreteDynamicsWorld_setGravity,e.btDiscreteDynamicsWorld_getGravity=C.btDiscreteDynamicsWorld_getGravity,e.btDiscreteDynamicsWorld_addRigidBody=C.btDiscreteDynamicsWorld_addRigidBody,e.btDiscreteDynamicsWorld_removeRigidBody=C.btDiscreteDynamicsWorld_removeRigidBody,e.btDiscreteDynamicsWorld_stepSimulation=C.btDiscreteDynamicsWorld_stepSimulation,e.btDiscreteDynamicsWorld_clearForces=C.btDiscreteDynamicsWorld_clearForces,e.btDiscreteDynamicsWorld_setApplySpeculativeContactRestitution=C.btDiscreteDynamicsWorld_setApplySpeculativeContactRestitution,e.btDiscreteDynamicsWorld_getApplySpeculativeContactRestitution=C.btDiscreteDynamicsWorld_getApplySpeculativeContactRestitution,e.btKinematicCharacterController_create=C.btKinematicCharacterController_create,e.btKinematicCharacterController_setWalkDirection=C.btKinematicCharacterController_setWalkDirection,e.btKinematicCharacterController_setFallSpeed=C.btKinematicCharacterController_setFallSpeed,e.btKinematicCharacterController_setJumpSpeed=C.btKinematicCharacterController_setJumpSpeed,e.btKinematicCharacterController_setMaxSlope=C.btKinematicCharacterController_setMaxSlope,e.btKinematicCharacterController_onGround=C.btKinematicCharacterController_onGround,e.btKinematicCharacterController_jump=C.btKinematicCharacterController_jump,e.btKinematicCharacterController_setGravity=C.btKinematicCharacterController_setGravity,e.btKinematicCharacterController_setUp=C.btKinematicCharacterController_setUp,e.btKinematicCharacterController_setStepHeight=C.btKinematicCharacterController_setStepHeight,e.btKinematicCharacterController_destroy=C.btKinematicCharacterController_destroy,e.btPairCachingGhostObject_create=C.btPairCachingGhostObject_create,e.btGhostPairCallback_create=C.btGhostPairCallback_create,e.btTypedConstraint_setEnabled=C.btTypedConstraint_setEnabled,e.btCollisionWorld_addConstraint=C.btCollisionWorld_addConstraint,e.btCollisionWorld_removeConstraint=C.btCollisionWorld_removeConstraint,e.btJointFeedback_create=C.btJointFeedback_create,e.btJointFeedback_destroy=C.btJointFeedback_destroy,e.btTypedConstraint_setJointFeedback=C.btTypedConstraint_setJointFeedback,e.btTypedConstraint_getJointFeedback=C.btTypedConstraint_getJointFeedback,e.btTypedConstraint_enableFeedback=C.btTypedConstraint_enableFeedback,e.btTypedConstraint_setParam=C.btTypedConstraint_setParam,e.btTypedConstraint_setOverrideNumSolverIterations=C.btTypedConstraint_setOverrideNumSolverIterations,e.btTypedConstraint_destroy=C.btTypedConstraint_destroy,e.btJointFeedback_getAppliedForceBodyA=C.btJointFeedback_getAppliedForceBodyA,e.btJointFeedback_getAppliedForceBodyB=C.btJointFeedback_getAppliedForceBodyB,e.btJointFeedback_getAppliedTorqueBodyA=C.btJointFeedback_getAppliedTorqueBodyA,e.btFixedConstraint_create=C.btFixedConstraint_create,e.btGeneric6DofSpring2Constraint_create=C.btGeneric6DofSpring2Constraint_create,e.btGeneric6DofSpring2Constraint_setAxis=C.btGeneric6DofSpring2Constraint_setAxis,e.btGeneric6DofSpring2Constraint_setLimit=C.btGeneric6DofSpring2Constraint_setLimit,e.btGeneric6DofSpring2Constraint_enableSpring=C.btGeneric6DofSpring2Constraint_enableSpring,e.btGeneric6DofSpring2Constraint_setBounce=C.btGeneric6DofSpring2Constraint_setBounce,e.btGeneric6DofSpring2Constraint_setStiffness=C.btGeneric6DofSpring2Constraint_setStiffness,e.btGeneric6DofSpring2Constraint_setDamping=C.btGeneric6DofSpring2Constraint_setDamping,e.btGeneric6DofSpring2Constraint_setEquilibriumPoint=C.btGeneric6DofSpring2Constraint_setEquilibriumPoint,e.btGeneric6DofSpring2Constraint_enableMotor=C.btGeneric6DofSpring2Constraint_enableMotor,e.btGeneric6DofSpring2Constraint_setServo=C.btGeneric6DofSpring2Constraint_setServo,e.btGeneric6DofSpring2Constraint_setTargetVelocity=C.btGeneric6DofSpring2Constraint_setTargetVelocity,e.btGeneric6DofSpring2Constraint_setServoTarget=C.btGeneric6DofSpring2Constraint_setServoTarget,e.btGeneric6DofSpring2Constraint_setMaxMotorForce=C.btGeneric6DofSpring2Constraint_setMaxMotorForce,e.btGeneric6DofSpring2Constraint_setFrames=C.btGeneric6DofSpring2Constraint_setFrames;}(64*A*1024,r,e),e;};

  /* eslint-disable no-undefined,no-param-reassign,no-shadow */

  /**
   * Throttle execution of a function. Especially useful for rate limiting
   * execution of handlers on events like resize and scroll.
   *
   * @param  {number}    delay -          A zero-or-greater delay in milliseconds. For event callbacks, values around 100 or 250 (or even higher) are most useful.
   * @param  {boolean}   [noTrailing] -   Optional, defaults to false. If noTrailing is true, callback will only execute every `delay` milliseconds while the
   *                                    throttled-function is being called. If noTrailing is false or unspecified, callback will be executed one final time
   *                                    after the last throttled-function call. (After the throttled-function has not been called for `delay` milliseconds,
   *                                    the internal counter is reset).
   * @param  {Function}  callback -       A function to be executed after delay milliseconds. The `this` context and all arguments are passed through, as-is,
   *                                    to `callback` when the throttled-function is executed.
   * @param  {boolean}   [debounceMode] - If `debounceMode` is true (at begin), schedule `clear` to execute after `delay` ms. If `debounceMode` is false (at end),
   *                                    schedule `callback` to execute after `delay` ms.
   *
   * @returns {Function}  A new, throttled, function.
   */
  function throttle(delay, noTrailing, callback, debounceMode) {
    /*
     * After wrapper has stopped being called, this timeout ensures that
     * `callback` is executed at the proper times in `throttle` and `end`
     * debounce modes.
     */
    var timeoutID;
    var cancelled = false; // Keep track of the last time `callback` was executed.

    var lastExec = 0; // Function to clear existing timeout

    function clearExistingTimeout() {
      if (timeoutID) {
        clearTimeout(timeoutID);
      }
    } // Function to cancel next exec


    function cancel() {
      clearExistingTimeout();
      cancelled = true;
    } // `noTrailing` defaults to falsy.


    if (typeof noTrailing !== 'boolean') {
      debounceMode = callback;
      callback = noTrailing;
      noTrailing = undefined;
    }
    /*
     * The `wrapper` function encapsulates all of the throttling / debouncing
     * functionality and when executed will limit the rate at which `callback`
     * is executed.
     */


    function wrapper() {
      for (var _len = arguments.length, arguments_ = new Array(_len), _key = 0; _key < _len; _key++) {
        arguments_[_key] = arguments[_key];
      }

      var self = this;
      var elapsed = Date.now() - lastExec;

      if (cancelled) {
        return;
      } // Execute `callback` and update the `lastExec` timestamp.


      function exec() {
        lastExec = Date.now();
        callback.apply(self, arguments_);
      }
      /*
       * If `debounceMode` is true (at begin) this is used to clear the flag
       * to allow future `callback` executions.
       */


      function clear() {
        timeoutID = undefined;
      }

      if (debounceMode && !timeoutID) {
        /*
         * Since `wrapper` is being called for the first time and
         * `debounceMode` is true (at begin), execute `callback`.
         */
        exec();
      }

      clearExistingTimeout();

      if (debounceMode === undefined && elapsed > delay) {
        /*
         * In throttle mode, if `delay` time has been exceeded, execute
         * `callback`.
         */
        exec();
      } else if (noTrailing !== true) {
        /*
         * In trailing throttle mode, since `delay` time has not been
         * exceeded, schedule `callback` to execute `delay` ms after most
         * recent execution.
         *
         * If `debounceMode` is true (at begin), schedule `clear` to execute
         * after `delay` ms.
         *
         * If `debounceMode` is false (at end), schedule `callback` to
         * execute after `delay` ms.
         */
        timeoutID = setTimeout(debounceMode ? clear : exec, debounceMode === undefined ? delay - elapsed : delay);
      }
    }

    wrapper.cancel = cancel; // Return the wrapper function.

    return wrapper;
  }

  var AnimationController = /*#__PURE__*/function () {
    function AnimationController(animator) {
      this.isPlaying = false;
      this.animationQueue = [];
      this.animator = animator;
    }

    var _proto = AnimationController.prototype;

    _proto.queue = function queue(actionName, timeout) {
      if (!this.isPlaying) {
        this.animationQueue.push({
          actionName: actionName,
          timeout: timeout || 0
        });
      }

      return this;
    };

    _proto.play = function play() {
      var _this = this;

      if (this.animationQueue.length === 0 || this.isPlaying) return;
      this.isPlaying = true;
      var action = this.animationQueue.shift();
      var promise = new Promise(function (resolve, reject) {
        laya_core.timer.once(action.timeout, _this, function () {
          console.log("\u64AD\u653E\u52A8\u4F5C====" + action.actionName);

          try {
            _this.animator.play(action.actionName);
          } catch (error) {}

          _this.checkFunc = _this.checkAnimationDone(resolve);
          laya_core.timer.frameLoop(1, _this, _this.checkFunc);
        });
      });

      var _loop = function _loop() {
        var _action = _this.animationQueue.shift();

        promise = promise.then(function () {
          return new Promise(function (resolve, reject) {
            laya_core.timer.once(_action.timeout, _this, function () {
              console.log("\u64AD\u653E\u52A8\u4F5C====" + _action.actionName);

              try {
                _this.animator.play(_action.actionName);
              } catch (error) {}

              _this.checkFunc = _this.checkAnimationDone(resolve);
              laya_core.timer.frameLoop(1, _this, _this.checkFunc);
            });
          });
        });
      };

      while (this.animationQueue.length !== 0) {
        _loop();
      }

      return promise.then(function () {
        _this.isPlaying = false;
      });
    };

    _proto.checkAnimationDone = function checkAnimationDone(resolve) {
      return function () {
        if (this.animator.getCurrentAnimatorPlayState().normalizedTime >= 1) {
          resolve();
          laya_core.timer.clear(this, this.checkFunc);
        }
      };
    };

    _proto.clear = function clear() {
      this.isPlaying = false;
      this.animationQueue = [];
      laya_core.timer.clearAll(this);
      return this;
    };

    return AnimationController;
  }();

  var BaseScene = /*#__PURE__*/function () {
    function BaseScene() {}

    var _proto2 = BaseScene.prototype;

    _proto2.setLoadingPage = function setLoadingPage(loadingPage) {
      if (this._loadingPage !== loadingPage) {
        console.log(' setLoadingPage ' + typeof loadingPage);
        this._loadingPage = loadingPage;
      }
    };

    _proto2._showLoading = function _showLoading(param) {
      this._loadingPage.onOpened(param);
    };

    _proto2._hideLoading = function _hideLoading() {
      this._loadingPage.onClosed();
    };

    _proto2.showLoadingPage = function showLoadingPage(param, delay) {
      if (param === void 0) {
        param = null;
      }

      if (delay === void 0) {
        delay = 0;
      }

      if (this._loadingPage) {
        laya_core.timer.clear(null, this._showLoading);
        laya_core.timer.clear(null, this._hideLoading);
        laya_core.timer.once(delay, this, this._showLoading, [param], false);
      }
    };

    _proto2.hideLoadingPage = function hideLoadingPage(delay) {
      if (delay === void 0) {
        delay = 0;
      }

      if (this._loadingPage) {
        laya_core.timer.clear(null, this._showLoading);
        laya_core.timer.clear(null, this._hideLoading);
        laya_core.timer.once(delay, this, this._hideLoading);
      }
    };

    _proto2.init = function init() {
      var _this2 = this;

      this.loadResource(this.resources).then(function () {
        _this2.loaded();
      })["catch"](function (err) {
        console.error('场景加载失败', err);
      });
    };

    _proto2.loadResource = function loadResource(resources) {
      var _this3 = this;

      var resource = resources[0],
          syncResources = resources.slice(1);
      var promises = [];

      if (resource) {
        this.showLoadingPage();
        promises.push(new Promise(function (resolve, reject) {
          console.log(' Laya.Scene.load resource ', resource);
          laya_core.Scene3D.load(resource, laya_core.Handler.create(_this3, resolve));
        }));
      }

      if (syncResources.length) {
        promises.push(new Promise(function (resolve, reject) {
          laya_core.loader.create(syncResources, laya_core.Handler.create(_this3, resolve));
        }));
      }

      return Promise.all(promises).then(function (_ref) {
        var scene = _ref[0];
        _this3.scene = scene;

        if (scene) {
          console.log(' THIS.scene ', scene);
          laya_core.stage.addChild(scene);
          console.log(' hideLoadingPage ');

          _this3.hideLoadingPage();
        }

        return Promise.resolve(_this3);
      });
    };

    return BaseScene;
  }();

  function setSpriteTransform(sprite, transform) {
    sprite.transform.position = transform.position;
    sprite.transform.rotation = transform.rotation;
    sprite.transform.scale = transform.scale;
  }

  var CommonScene = /*#__PURE__*/function (_BaseScene) {
    _inheritsLoose(CommonScene, _BaseScene);

    function CommonScene(props) {
      var _this4;

      _this4 = _BaseScene.call(this) || this;
      _this4.characters = {};
      _this4.events = [];

      _this4.trigger = function (actionName) {
        var action = _this4.sceneConfig.actions[actionName];

        if (action) {
          for (var _len = arguments.length, payload = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
            payload[_key - 1] = arguments[_key];
          }

          action.call.apply(action, [_assertThisInitialized(_this4), _this4.scene].concat(payload));
        }
      };

      _this4.update(props);

      return _this4;
    }

    var _proto3 = CommonScene.prototype;

    _proto3.update = function update(props) {
      this.sceneConfig = props.scene(props);
      this.componentProps = props;
      this.resources = this.sceneConfig.resources;
    };

    _proto3.loaded = function loaded() {
      this.sceneConfig.init.call(this, this.scene);
      this.initDeferred();
      this.initEvents();
    };

    _proto3.initCharacters = function initCharacters() {
      var _this5 = this;

      var characterDefs = this.componentProps.characters;
      var characters = this.sceneConfig.characters(characterDefs ? characterDefs.map(function (def) {
        return def.call(_this5, _this5.componentProps);
      }) : []);

      if (characters) {
        Promise.all(characters.map(function (character) {
          return new Promise(function (resolve, reject) {
            laya_core.Scene3D.load(character.resource, laya_core.Handler.create(_this5, function (charSprite) {
              charSprite.name = character.name;
              charSprite.active = false;
              setSpriteTransform(charSprite, character.transform);

              _this5.scene.addChild(charSprite);

              var charAniManager = new character.AnimationManager({
                scene: _this5,
                sprite: charSprite,
                controller: new AnimationController(charSprite.getComponent(laya_core.Animator))
              });

              if (character.scriptComponent) {
                charSprite.addComponent(character.scriptComponent);
              }

              _this5.characters[character.name] = _extends({}, character, {
                sprite: charSprite,
                animationManager: charAniManager,
                setState: charAniManager.setState.bind(charAniManager)
              });
              resolve();
            }));
          });
        })).then(function () {
          Object.keys(_this5.characters).forEach(function (name) {
            var character = _this5.characters[name];
            character.setState(character.enterAnimation);
          });
        })["catch"](function (err) {
          console.error('角色加载失败', err);
        });
      }
    };

    _proto3.initDeferred = function initDeferred() {
      var _this6 = this;

      var resourcesDeferred = this.sceneConfig.resourcesDeferred;
      laya_core.loader.create(Array.from(resourcesDeferred), laya_core.Handler.create(this, function () {
        resourcesDeferred.forEach(function (res) {
          _this6.scene.addChild(laya_core.Loader.getRes(res));
        });
      }));
    };

    _proto3.initEvents = function initEvents() {
      var _this7 = this;

      var events = this.sceneConfig.events;
      this.events = Object.keys(events).map(function (type) {
        return {
          type: type,
          handler: _this7.addMouseEvent(type, function () {
            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
              args[_key2] = arguments[_key2];
            }

            return _this7.sceneConfig.events[type].apply(_this7, args);
          })
        };
      });
    };

    _proto3.removeMouseEvent = function removeMouseEvent() {
      var canvasDom = document.getElementById('layaCanvas');
      this.events.forEach(function (event) {
        canvasDom.removeEventListener(event.type, event.handler);
      });
    };

    _proto3.addMouseEvent = function addMouseEvent(type, callback) {
      var THIS = this;
      var ray = new laya_core.Ray(new laya_core.Vector3(0, 0, 0), new laya_core.Vector3(0, 0, 0));
      var point = new laya_core.Vector2();
      var outHitResult = new laya_core.HitResult();
      var canvasDom = document.getElementById('layaCanvas');
      if (!canvasDom) return;
      var offsetX = canvasDom.getBoundingClientRect().left;
      var offsetY = canvasDom.getBoundingClientRect().top;

      function castRayToMouse() {
        point.x = laya_core.MouseManager.instance.mouseX - offsetX;
        point.y = laya_core.MouseManager.instance.mouseY - offsetY;
        THIS.camera.viewportPointToRay(point, ray);
        THIS.scene.physicsSimulation.rayCast(ray, outHitResult);

        if (outHitResult.succeeded) {
          return outHitResult.collider.owner;
        }
      }

      var eventHandler = throttle(60, function (event) {
        var hitObject = castRayToMouse();
        callback(event, hitObject);
      });
      document.getElementById('layaCanvas').addEventListener(type, eventHandler);
      return eventHandler;
    };

    return CommonScene;
  }(BaseScene);

  var SceneManager = /*#__PURE__*/function () {
    function SceneManager() {
      this.sceneMap = new Map();
    }

    var _proto4 = SceneManager.prototype;

    _proto4.openScene = function openScene(props) {
      if (props === void 0) {
        props = {};
      }

      var _props = props,
          scene = _props.scene;

      if (scene) {
        var sceneInstance = this.sceneMap.get(scene);

        if (!sceneInstance) {
          sceneInstance = new CommonScene(props);
          this.sceneMap.set(scene, sceneInstance);
        }

        this.currentScene = sceneInstance;
        sceneInstance.init();
      }
    };

    _createClass(SceneManager, null, [{
      key: "instance",
      get: function get() {
        if (!SceneManager._instance) {
          var instance = new SceneManager();
          SceneManager._instance = instance;
        }

        return SceneManager._instance;
      }
    }]);

    return SceneManager;
  }();

  function initLayaScene(props) {
    if (laya_core.Laya3D && laya_core.Laya3D._isInit) {
      document.getElementById('laya-container').append(laya_core.Render.canvas);
      var layaConfig = props.layaConfig || {};

      if (layaConfig.width && layaConfig.height) {
        laya_core.stage.width = layaConfig.width;
        laya_core.stage.height = layaConfig.height;
      } else {
        var containerDom = document.getElementById('laya-container').parentNode;
        var containerRect = containerDom.getBoundingClientRect();
        laya_core.stage.width = containerRect.width;
        laya_core.stage.height = containerRect.height;
        customDivResize(containerDom, function () {
          var containerRect = document.getElementById('div_resize_detector').parentNode.getBoundingClientRect();
          laya_core.stage.width = containerRect.width;
          laya_core.stage.height = containerRect.height;
        });
      }
    } else {
      var _layaConfig = props.layaConfig || {};

      var width, height;

      if (_layaConfig.width && _layaConfig.height) {
        width = _layaConfig.width;
        height = _layaConfig.height;
      } else {
        var _containerDom = document.getElementById('laya-container').parentNode;

        var _containerRect = _containerDom.getBoundingClientRect();

        width = _containerRect.width;
        height = _containerRect.height;
        customDivResize(_containerDom, function () {
          var containerRect = document.getElementById('div_resize_detector').parentNode.getBoundingClientRect();
          laya_core.stage.width = containerRect.width;
          laya_core.stage.height = containerRect.height;
        });
      }

      if (laya_core.Laya3D) {
        laya_core.Laya3D.init(width, height);
      } else {
        laya_core.init(width, height, laya_core.WebGL);
      }

      laya_core.stage.bgColor = 'white';
      laya_core.stage.scaleMode = 'noscale';
      laya_core.stage.screenMode = _layaConfig.screenMode || 'none';
      laya_core.stage.alignV = _layaConfig.alignV || 'top';
      laya_core.stage.alignH = _layaConfig.alignH || 'left';

      if (_layaConfig.stat) {
        laya_core.Stat.show();
      }

      laya_core.alertGlobalError = true;
      var container = document.getElementById('laya-container');
      var canvas = document.getElementById('layaCanvas');
      container.append(canvas);
    }

    SceneManager.instance.openScene(props);
    return SceneManager.instance.currentScene;
  }

  function customDivResize(el, cb) {
    var iframe = document.createElement('iframe');
    iframe.id = 'div_resize_detector';
    iframe.setAttribute('style', 'width: 100%; height: 100%; position: absolute; left:0; top:0; visibility:hidden; margin: 0; padding: 0; border: 0;');
    el.appendChild(iframe);
    var oldWidth = el.offsetWidth;
    var oldHeight = el.offsetHeight;

    function resizeHandler() {
      var width = el.offsetWidth;
      var height = el.offsetHeight;

      if (width !== oldWidth || height !== oldHeight) {
        cb({
          width: width,
          height: height
        }, {
          width: oldWidth,
          height: oldHeight
        });
        oldWidth = width;
        oldHeight = height;
      }
    }

    iframe.contentWindow.onresize = throttle(60, resizeHandler);
  }

  var CameraMove = /*#__PURE__*/function (_Laya$Script3D) {
    _inheritsLoose(CameraMove, _Laya$Script3D);

    function CameraMove() {
      var _this8;

      _this8 = _Laya$Script3D.call(this) || this;
      _this8.canMove = true;
      _this8.isMouseDown = false;
      _this8._tempVector3 = new laya_core.Vector3();
      _this8.yawPitchRoll = new laya_core.Vector3();
      _this8.tempRotationZ = new laya_core.Quaternion();
      _this8.rotaionSpeed = 0.00006;
      return _this8;
    }

    var _proto5 = CameraMove.prototype;

    _proto5.onEnable = function onEnable() {
      if (!this.inited) {
        laya_core.stage.on(laya_core.Event.MOUSE_DOWN, this, this.mouseDown);
        laya_core.stage.on(laya_core.Event.MOUSE_UP, this, this.mouseUp);
        this.camera = this.owner;
      }
    };

    _proto5.onDisable = function onDisable() {
      this.inited = false;
      laya_core.stage.off(laya_core.Event.MOUSE_DOWN, this, this.mouseDown);
      laya_core.stage.off(laya_core.Event.MOUSE_UP, this, this.mouseUp);
    };

    _proto5.onUpdate = function onUpdate() {
      if (this.canMove) {
        var elapsedTime = laya_core.timer.delta;
        laya_core.KeyBoardManager.hasKeyDown(87) && this.moveForward(-0.002 * elapsedTime);
        laya_core.KeyBoardManager.hasKeyDown(83) && this.moveForward(0.002 * elapsedTime);
        laya_core.KeyBoardManager.hasKeyDown(65) && this.moveRight(-0.002 * elapsedTime);
        laya_core.KeyBoardManager.hasKeyDown(68) && this.moveRight(0.002 * elapsedTime);
        laya_core.KeyBoardManager.hasKeyDown(81) && this.moveVertical(0.002 * elapsedTime);
        laya_core.KeyBoardManager.hasKeyDown(69) && this.moveVertical(-0.002 * elapsedTime);

        if (!isNaN(this.lastMouseX) && !isNaN(this.lastMouseY) && this.isMouseDown) {
          var offsetX = laya_core.stage.mouseX - this.lastMouseX;
          var offsetY = laya_core.stage.mouseY - this.lastMouseY;
          var yprElem = this.yawPitchRoll;
          yprElem.x -= offsetX * this.rotaionSpeed * elapsedTime;
          yprElem.y -= offsetY * this.rotaionSpeed * elapsedTime;
          this.updateRotation();
        }

        this.lastMouseX = laya_core.stage.mouseX;
        this.lastMouseY = laya_core.stage.mouseY;
      }
    };

    _proto5.mouseDown = function mouseDown(e) {
      this.camera.transform.localRotation.getYawPitchRoll(this.yawPitchRoll);
      this.lastMouseX = laya_core.stage.mouseX;
      this.lastMouseY = laya_core.stage.mouseY;
      this.isMouseDown = true;
    };

    _proto5.mouseUp = function mouseUp(e) {
      this.isMouseDown = false;
    };

    _proto5.moveForward = function moveForward(distance) {
      this._tempVector3.x = 0;
      this._tempVector3.y = 0;
      this._tempVector3.z = distance;
      this.camera.transform.translate(this._tempVector3);
    };

    _proto5.moveRight = function moveRight(distance) {
      this._tempVector3.y = 0;
      this._tempVector3.z = 0;
      this._tempVector3.x = distance;
      this.camera.transform.translate(this._tempVector3);
    };

    _proto5.moveVertical = function moveVertical(distance) {
      this._tempVector3.x = this._tempVector3.z = 0;
      this._tempVector3.y = distance;
      this.camera.transform.translate(this._tempVector3, false);
    };

    _proto5.updateRotation = function updateRotation() {
      if (Math.abs(this.yawPitchRoll.y) < 1.5) {
        laya_core.Quaternion.createFromYawPitchRoll(this.yawPitchRoll.x, this.yawPitchRoll.y, this.yawPitchRoll.z, this.tempRotationZ);
        this.camera.transform.localRotation = this.tempRotationZ;
      }
    };

    return CameraMove;
  }(laya_core.Script3D);

  function defineScene(getScene) {
    return function (props) {
      var res = getScene(props);
      return Object.assign({}, {
        resources: [],
        resourcesDeferred: [],
        camera: function camera() {},
        characters: function characters(_characters) {
          return _characters;
        },
        actions: {},
        events: {
          click: function click(event, target) {
            props.onClick && props.onClick(target);
          },
          mousemove: function mousemove(event, target) {
            props.onMousemove && props.onMousemove(target);
          }
        }
      }, res);
    };
  }

  function defineCharacter(getCharacter) {
    return function (props) {
      return getCharacter(props) || [];
    };
  }

  function getRandomInt(min, max) {
    var Range = max - min;
    var Rand = Math.random();
    return min + Math.round(Rand * Range);
  }

  var State = {
    Idle: 1,
    Dafeng: 2,
    Weifeng: 3
  };
  var treeArray = ['shu_skin', 'shu_skin (1)', 'shu_skin (2)', 'shu_skin (3)', 'shu_skin (4)', 'shu_skin (5)', 'shu_skin (6)'];

  var TreeAnimationManager = /*#__PURE__*/function () {
    function TreeAnimationManager(treeObject) {
      this.timeArray = [5 * 60 * 1000];
      this.treeAnimator = treeObject.getComponent(laya_core.Animator);
      this.treeAniController = new AnimationController(this.treeAnimator);
      this.PlayRamdonAnim();
    }

    var _proto = TreeAnimationManager.prototype;

    _proto.SetState = function SetState(state) {
      var _this = this;

      switch (state) {
        case State.Dafeng:
          this.currentState = State.Dafeng;
          this.treeAnimator.speed = 0.4;
          this.treeAniController.clear().queue('shu_dafeng').play().then(function () {
            _this.SetState(State.Weifeng);
          });
          break;

        case State.Weifeng:
          this.currentState = State.Weifeng;
          this.treeAnimator.speed = 0.4;
          this.treeAniController.clear().queue('shu_weifeng').play();
          break;
      }
    };

    _proto.PlayRamdonAnim = function PlayRamdonAnim() {
      var _this2 = this;

      var timeIndex = getRandomInt(0, this.timeArray.length - 1);
      var time = this.timeArray[timeIndex];

      var loopFunction = function loopFunction() {
        _this2.SetState(State.Dafeng);

        laya_core.timer.clear(window, loopFunction);

        _this2.PlayRamdonAnim();
      };

      laya_core.timer.loop(time, window, loopFunction);
    };

    return TreeAnimationManager;
  }();

  function initTreeAnimation(scene) {
    var playGround = scene.getChildByName('Sence');

    for (var i = 0; i < treeArray.length; i++) {
      var oneTree = playGround.getChildByName(treeArray[i]);
      var treeAniManager = new TreeAnimationManager(oneTree);
      treeAniManager.SetState(State.Weifeng);
    }
  }

  var CDNURL = 'https://cdncs.101.com/v0.1/static/bcs_app_3d/0805';
  var index = defineScene(function (props) {
    return {
      resources: [CDNURL + "/Scenes/Outdoor/OutDoorScene/Conventional/OutDoorScene.ls"],
      init: function init(scene) {
        var _this3 = this;

        var camera = this.camera = scene.getChildByName('Cam03');
        camera.enableHDR = false;
        camera.addComponent(CameraMove);
        initTreeAnimation(this.scene);
        var cameraAni = camera.getComponent(laya_core.Animator);
        var state1 = new laya_core.AnimatorState();
        state1.name = 'cameraAnimation';
        state1.clipStart = 20 / 100;
        state1.clipEnd = 100 / 100;
        state1.clip = cameraAni.getDefaultState().clip;
        cameraAni.addState(state1);
        cameraAni.play('cameraAnimation');

        var cameraAnimationCheck = function cameraAnimationCheck() {
          if (cameraAni.getCurrentAnimatorPlayState().normalizedTime >= 1) {
            cameraAni.speed = 0.0;
            laya_core.timer.clear(window, cameraAnimationCheck);

            _this3.initCharacters();
          }
        };

        laya_core.timer.frameLoop(1, window, cameraAnimationCheck);
      },
      characters: function characters(_characters) {
        return [_extends({}, _characters[0], {
          transform: {
            position: new laya_core.Vector3(2.208, 0.551, 1.811),
            rotation: new laya_core.Quaternion(0, -0.9461105, 0, 0.323844),
            scale: new laya_core.Vector3(0.5791469, 0.5791447, 0.5791469)
          }
        }), _extends({}, _characters[1], {
          transform: {
            position: new laya_core.Vector3(2.838, 0.548, 1.497),
            rotation: new laya_core.Quaternion(0, 0.9238796, 0, -0.3826833),
            scale: new laya_core.Vector3(0.58, 0.58, 0.58)
          }
        })];
      },
      actions: {
        hideTeaCup: function hideTeaCup(scene, name) {
          scene.getChildByName('Sence').getChildByName("3DSCK_chabei_LOD0" + (name === props.characters[0].name ? '' : '1')).active = false;
        },
        showTeaCup: function showTeaCup(scene, name) {
          scene.getChildByName('Sence').getChildByName("3DSCK_chabei_LOD0" + (name === props.characters[0].name ? '' : '1')).active = true;
        }
      }
    };
  });

  var CDNURL$1 = 'https://cdncs.101.com/v0.1/static/bcs_app_3d/0805';
  var NAME = 'dj';

  function getRandomInt$1(min, max) {
    var Range = max - min;
    var Rand = Math.random();
    return min + Math.round(Rand * Range);
  }

  var STATE = {
    None: 'sitIdle',
    StandIdle: 'standIdle',
    FiveMinutes: 'fiveMinutes',
    StartTalk: 'startTalk',
    EndTalk: 'endTalk',
    GoodBye: 'goodbye',
    MouseOver: 'standUp',
    ComeIn: 'walkInSitDown',
    DownTea: 'drinkTea',
    LookEachOther: 'lookOther',
    halfHourAction: 'halfHourAction',
    WalkMove: 'walkIn'
  };
  var ENTER_ANIMATION = STATE.ComeIn;
  var RANDOM_ANIMATION = [STATE.DownTea, STATE.LookEachOther];

  var DjAnimationManager = /*#__PURE__*/function () {
    function DjAnimationManager(_ref) {
      var sprite = _ref.sprite,
          controller = _ref.controller,
          scene = _ref.scene;
      this.currentState = STATE.None;
      this.timeArray = [1 * 6 * 1000, 2 * 6 * 1000];
      this.scene = scene;
      this.djRole3D = sprite;
      this.djAni = controller;
    }

    var _proto = DjAnimationManager.prototype;

    _proto.setState = function setState(state) {
      var _this = this;

      switch (state) {
        case STATE.WalkMove:
          this.djRole3D.active = true;
          this.currentState = STATE.WalkMove;
          this.djAni.queue('DjWalkMove').play().then(function () {
            _this.setState(STATE.StandIdle);
          });
          break;

        case STATE.ComeIn:
          this.djRole3D.active = true;
          console.log('Dj 入场');
          this.currentState = STATE.ComeIn;
          this.djAni.queue('DjWalkMove').queue('DjSitDown').play().then(function () {
            _this.setState(STATE.None);

            _this.playHalfHour();

            _this.playRamdonAnim();
          });
          break;

        case STATE.None:
          console.log('Dj 待机');
          this.currentState = STATE.None;
          this.djAni.queue('DjDownIdle').play();
          break;

        case STATE.StandIdle:
          console.log('Dj 站立待机');
          this.currentState = STATE.StandIdle;
          this.djAni.queue('DjStandIdle').play();
          break;

        case STATE.FiveMinutes:
          if (this.currentState === STATE.None) {
            console.log('议题最后5分钟，Dj 看手表');
            this.currentState = STATE.FiveMinutes;
            this.djAni.clear().queue('DjDownLookWatches').play().then(function () {
              _this.setState(STATE.None);
            });
          }

          break;

        case STATE.StartTalk:
          if (this.currentState === STATE.None) {
            console.log('开始讨论，Dj 磨拳擦掌');
            this.currentState = STATE.StartTalk;
            this.djAni.clear().queue('DjWipeHands').play().then(function () {
              _this.setState(STATE.None);
            });
          }

          break;

        case STATE.EndTalk:
          console.log('完成讨论，Dj 鼓掌');
          this.currentState = STATE.EndTalk;
          this.djAni.clear().queue('DjCheer').queue('DjSitDown').play().then(function () {
            _this.setState(STATE.None);
          });
          break;

        case STATE.GoodBye:
          console.log('完成全部议题');
          this.currentState = STATE.GoodBye;
          this.djAni.clear().queue('DjStand').queue('DjBye').queue('DjBye').play().then(function () {
            _this.setState(STATE.StandIdle);
          });
          break;

        case STATE.MouseOver:
          if (this.currentState === STATE.None) {
            this.currentState = STATE.MouseOver;
            this.djAni.clear().queue('DjStand').queue('DjStandIdle').queue('DjSitDown').play().then(function () {
              _this.setState(STATE.None);
            });
          }

          break;

        case STATE.halfHourAction:
          if (this.currentState === STATE.None) {
            this.currentState = STATE.halfHourAction;
            this.djAni.clear().queue('DjStandTwist').play().then(function () {
              _this.setState(STATE.None);
            });
          }

          break;

        case STATE.DownTea:
          if (this.currentState === STATE.None) {
            this.currentState = STATE.DownTea;
            laya_core.timer.once(300, window, function () {
              _this.scene.trigger('hideTeaCup', NAME);
            });
            this.djAni.clear().queue('DjDownTea').play().then(function () {
              _this.scene.trigger('showTeaCup', NAME);

              _this.setState(STATE.None);
            });
          }

          break;

        case STATE.LookEachOther:
          if (this.currentState === STATE.None) {
            this.currentState = STATE.LookEachOther;
            this.djAni.clear().queue('DjIsologue').play().then(function () {
              _this.setState(STATE.None);
            });
          }

          break;
      }
    };

    _proto.playRamdonAnim = function playRamdonAnim() {
      var _this2 = this;

      var timeIndex = getRandomInt$1(0, this.timeArray.length - 1);
      var time = this.timeArray[timeIndex];

      var loopFunction = function loopFunction() {
        var index = getRandomInt$1(0, RANDOM_ANIMATION.length - 1);

        _this2.setState(RANDOM_ANIMATION[index]);

        laya_core.timer.clear(window, loopFunction);

        _this2.playRamdonAnim();
      };

      laya_core.timer.loop(time, window, loopFunction);
    };

    _proto.playHalfHour = function playHalfHour() {
      var _this3 = this;

      laya_core.timer.loop(1800000, window, function () {
        _this3.setState(STATE.halfHourAction);
      });
    };

    return DjAnimationManager;
  }();

  function getDateByNumber(days) {
    var curTime = new Date().getTime();
    var newDate = new Date(curTime + days * 24 * 60 * 60 * 1000);
    var date = newDate.toISOString().substring(0, 10);
    return date;
  }

  function getActiveRoleName() {
    var curData = getDateByNumber(0);
    var month = parseInt(curData.substring(5, 7), 10);
    var day = parseInt(curData.substring(9, 11), 10);

    if (month > 4 && month < 10) {
      return day % 2 ? 'AIDJ_Cloth_C' : 'AIDJ_Cloth_D';
    } else {
      return day % 2 ? 'AIDJ' : 'AIDJ_Cloth_B';
    }
  }

  var index$1 = defineCharacter(function (props) {
    return {
      name: NAME,
      resource: CDNURL$1 + "/Characters/" + getActiveRoleName() + ".lh",
      AnimationManager: DjAnimationManager,
      enterAnimation: ENTER_ANIMATION
    };
  });

  var CDNURL$2 = 'https://cdncs.101.com/v0.1/static/bcs_app_3d/0805';
  var NAME$1 = 'weihua';

  function getRandomInt$2(min, max) {
    var Range = max - min;
    var Rand = Math.random();
    return min + Math.round(Rand * Range);
  }

  var STATE$1 = {
    None: 'sitIdle',
    StandIdle: 'standIdle',
    FiveMinutes: 'fiveMinutes',
    StartTalk: 'startTalk',
    EndTalk: 'endTalk',
    GoodBye: 'goodbye',
    MouseOver: 'standUp',
    ComeIn: 'walkInSitDown',
    DownTea: 'drinkTea',
    LookEachOther: 'lookOther',
    halfHourAction: 'halfHourAction',
    WalkMove: 'walkIn'
  };
  var ENTER_ANIMATION$1 = STATE$1.ComeIn;
  var RANDOM_ANIMATION$1 = [STATE$1.DownTea, STATE$1.LookEachOther];

  var WhAnimationManager = /*#__PURE__*/function () {
    function WhAnimationManager(_ref) {
      var sprite = _ref.sprite,
          controller = _ref.controller,
          scene = _ref.scene;
      this.currentState = STATE$1.None;
      this.timeArray = [1 * 6 * 1000, 2 * 6 * 1000];
      this.scene = scene;
      this.weihuaRole3D = sprite;
      this.whAni = controller;
    }

    var _proto = WhAnimationManager.prototype;

    _proto.setState = function setState(state) {
      var _this = this;

      switch (state) {
        case STATE$1.ComeIn:
          this.weihuaRole3D.active = true;
          console.log('Weihua 入场');
          this.currentState = STATE$1.ComeIn;
          this.whAni.queue('WeihuaWalkMove').queue('WeihuaSitDown').play().then(function () {
            _this.setState(STATE$1.None);

            _this.playHalfHour();

            _this.playRamdonAnim();
          });
          break;

        case STATE$1.None:
          console.log('weihua 待机');
          this.currentState = STATE$1.None;
          this.whAni.queue('WeihuaDownIdle').play();
          break;

        case STATE$1.StandIdle:
          console.log('weihua 站立待机');
          this.currentState = STATE$1.StandIdle;
          this.whAni.queue('WeihuaStandIdle').play();
          break;

        case STATE$1.FiveMinutes:
          if (this.currentState === STATE$1.None) {
            console.log('议题最后5分钟，Weihua 看手表');
            this.currentState = STATE$1.FiveMinutes;
            this.whAni.clear().queue('WeihuaDownTalk').play().then(function () {
              _this.setState(STATE$1.None);
            });
          }

          break;

        case STATE$1.StartTalk:
          if (this.currentState === STATE$1.None) {
            console.log('开始讨论，weihua 磨拳擦掌');
            this.currentState = STATE$1.StartTalk;
            this.whAni.clear().queue('WeihuaWipeHands').play().then(function () {
              _this.setState(STATE$1.None);
            });
          }

          break;

        case STATE$1.EndTalk:
          console.log('完成讨论，Weihua 鼓掌');
          this.currentState = STATE$1.EndTalk;
          this.whAni.clear().queue('WeihuaCheer').queue('WeihuaSitDown').play().then(function () {
            _this.setState(STATE$1.None);
          });
          break;

        case STATE$1.GoodBye:
          console.log('完成全部议题');
          this.currentState = STATE$1.GoodBye;
          this.whAni.clear().queue('WeihuaStand').queue('WeihuaBye').queue('WeihuaBye').play().then(function () {
            _this.setState(STATE$1.StandIdle);
          });
          break;

        case STATE$1.MouseOver:
          if (this.currentState === STATE$1.None) {
            this.currentState = STATE$1.MouseOver;
            this.whAni.clear().queue('WeihuaStand').queue('WeihuaStandIdle').queue('WeihuaSitDown').play().then(function () {
              _this.setState(STATE$1.None);
            });
          }

          break;

        case STATE$1.halfHourAction:
          if (this.currentState === STATE$1.None) {
            this.currentState = STATE$1.halfHourAction;
            this.whAni.clear().queue('WeihuaStandTwist').play().then(function () {
              _this.setState(STATE$1.None);
            });
          }

          break;

        case STATE$1.DownTea:
          if (this.currentState === STATE$1.None) {
            this.currentState = STATE$1.DownTea;
            laya_core.timer.once(300, window, function () {
              _this.scene.trigger('hideTeaCup', NAME$1);
            });
            this.whAni.clear().queue('WeihuaDownTea').play().then(function () {
              _this.scene.trigger('showTeaCup', NAME$1);

              _this.setState(STATE$1.None);
            });
          }

          break;

        case STATE$1.LookEachOther:
          if (this.currentState === STATE$1.None) {
            this.currentState = STATE$1.LookEachOther;
            this.whAni.clear().queue('WeihuaIsologue').play().then(function () {
              _this.setState(STATE$1.None);
            });
          }

          break;
      }
    };

    _proto.playRamdonAnim = function playRamdonAnim() {
      var _this2 = this;

      var timeIndex = getRandomInt$2(0, this.timeArray.length - 1);
      var time = this.timeArray[timeIndex];

      var loopFunction = function loopFunction() {
        var index = getRandomInt$2(0, RANDOM_ANIMATION$1.length - 1);

        _this2.setState(RANDOM_ANIMATION$1[index]);

        laya_core.timer.clear(window, loopFunction);

        _this2.playRamdonAnim();
      };

      laya_core.timer.loop(time, window, loopFunction);
    };

    _proto.playHalfHour = function playHalfHour() {
      var _this3 = this;

      laya_core.timer.loop(1800000, window, function () {
        _this3.setState(STATE$1.halfHourAction);
      });
    };

    return WhAnimationManager;
  }();

  var index$2 = defineCharacter(function (props) {
    return {
      name: NAME$1,
      resource: CDNURL$2 + "/Characters/weihua_Cloth_C.lh",
      AnimationManager: WhAnimationManager,
      enterAnimation: ENTER_ANIMATION$1
    };
  });

  var LayaScene = /*#__PURE__*/function (_Component) {
    _inheritsLoose(LayaScene, _Component);

    function LayaScene() {
      return _Component.apply(this, arguments) || this;
    }

    var _proto = LayaScene.prototype;

    _proto.componentDidMount = function componentDidMount() {
      this.initScene();
    };

    _proto.componentDidUpdate = function componentDidUpdate(prevProps) {
      if (this.props.scene !== prevProps.scene) {
        LayaScene.sceneInstance.removeMouseEvent();
        LayaScene.sceneInstance.scene.destroy();
        laya_core.timer.clearAll(window);
        laya_core.Resource.destroyUnusedResources();
        this.initScene();
      } else {
        LayaScene.sceneInstance.update(this.props);
      }
    };

    _proto.componentWillUnmount = function componentWillUnmount() {
      var iframe = document.getElementById('div_resize_detector');

      if (iframe) {
        iframe.contentWindow.onresize = null;
        iframe.remove();
      }

      LayaScene.sceneInstance.removeMouseEvent();
      laya_core.timer.clearAll(window);
      LayaScene.sceneInstance.scene && LayaScene.sceneInstance.scene.destroy();
      laya_core.Resource.destroyUnusedResources();
    };

    _proto.initScene = function initScene() {
      var sceneInstance = LayaScene.sceneInstance = initLayaScene(_extends({}, this.props));

      if (this.props.setScene) {
        this.props.setScene(sceneInstance);
      }
    };

    _proto.render = function render() {
      return /*#__PURE__*/React__default['default'].createElement("div", {
        id: "laya-container",
        style: _extends({
          position: 'relative'
        }, this.props.style)
      });
    };

    return LayaScene;
  }(React.Component);

  exports.AnimationController = AnimationController;
  exports.CameraMove = CameraMove;
  exports.Laya = laya_core;
  exports.LayaScene = LayaScene;
  exports.SceneManager = SceneManager;
  exports.characterDJ = index$1;
  exports.characterWeihua = index$2;
  exports.defineCharacter = defineCharacter;
  exports.defineScene = defineScene;
  exports.initLayaScene = initLayaScene;
  exports.sceneOutdoor = index;

  return exports;

}({}, React));
